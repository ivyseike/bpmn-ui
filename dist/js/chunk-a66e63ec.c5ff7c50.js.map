{"version":3,"sources":["webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerDetailProps.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/CallActivityProps.js","webpack:///./node_modules/lodash/_baseKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorInputOutputProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorDetailProps.js","webpack:///./node_modules/lodash/_isFlattenable.js","webpack:///./src/components/Search.vue?528b","webpack:///./node_modules/lodash/stubFalse.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Properties.js","webpack:///./node_modules/lodash/_arrayPush.js","webpack:///./node_modules/lodash/_isStrictComparable.js","webpack:///./node_modules/lodash/_strictIndexOf.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/CreateHelper.js","webpack:///./node_modules/lodash/_getNative.js","webpack:///./node_modules/lodash/isBuffer.js","webpack:///./node_modules/core-js/internals/native-url.js","webpack:///./node_modules/lodash/_baseRest.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps.js","webpack:///./node_modules/lodash/_getFuncName.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ElementHelper.js","webpack:///./node_modules/bpmnlint/rules/conditional-flows.js","webpack:///./node_modules/lodash/_createCtor.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/HistoryTimeToLiveProps.js","webpack:///./node_modules/lodash/_isKeyable.js","webpack:///./node_modules/lodash/_castFunction.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./node_modules/lodash/_isMasked.js","webpack:///./node_modules/lodash/isEmpty.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/util/ModelingUtil.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/CandidateStarter.js","webpack:///./node_modules/lodash/_baseMatchesProperty.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/LinkEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Callable.js","webpack:///./node_modules/lodash/_stringToPath.js","webpack:///./node_modules/lodash/isObject.js","webpack:///./node_modules/lodash/_equalByTag.js","webpack:///./node_modules/bpmn-js-properties-panel/index.js","webpack:///./node_modules/lodash/_Promise.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/CreateBusinessObjectListHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/TimerEventDefinition.js","webpack:///./node_modules/core-js/internals/array-method-has-species-support.js","webpack:///./node_modules/lodash/_hashDelete.js","webpack:///./node_modules/lodash/_mapCacheSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/External.js","webpack:///./node_modules/lodash/_matchesStrictComparable.js","webpack:///./node_modules/lodash/_overRest.js","webpack:///./node_modules/lodash/_memoizeCapped.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/CustomElementsPropertiesActivator.js","webpack:///./node_modules/lodash/_baseForOwn.js","webpack:///./node_modules/lodash/_baseAggregator.js","webpack:///./node_modules/lodash/_Uint8Array.js","webpack:///./node_modules/lodash/_mapCacheGet.js","webpack:///./node_modules/lodash/_hashSet.js","webpack:///./node_modules/lodash/_baseIsArguments.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerFieldInjectionProps.js","webpack:///./node_modules/lodash/_realNames.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps.js","webpack:///./node_modules/lodash/_baseValues.js","webpack:///./node_modules/lodash/bind.js","webpack:///./node_modules/lodash/_baseHasIn.js","webpack:///./node_modules/lodash/find.js","webpack:///./node_modules/lodash/_getData.js","webpack:///./node_modules/lodash/_listCacheClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/Name.js","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/wrapperLodash.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/ElementTemplates.js","webpack:///./node_modules/bpmnlint/lib/linter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/CmdHelper.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ExtensionElementsHelper.js","webpack:///./node_modules/lodash/_baseFindIndex.js","webpack:///./node_modules/core-js/modules/web.url.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/_baseUniq.js","webpack:///./node_modules/lodash/_arrayFilter.js","webpack:///./node_modules/lodash/_getPrototype.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/UserTaskProps.js","webpack:///./node_modules/lodash/_baseDifference.js","webpack:///./node_modules/lodash/_createAssigner.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerProps.js","webpack:///./node_modules/lodash/_stackDelete.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/Utils.js","webpack:///./node_modules/lodash/_composeArgsRight.js","webpack:///./node_modules/lodash/isArrayLike.js","webpack:///./node_modules/bpmnlint/rules/single-event-definition.js","webpack:///./node_modules/lodash/_assignValue.js","webpack:///./node_modules/lodash/_getSymbols.js","webpack:///./node_modules/lodash/_baseIsNative.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Validator.js","webpack:///./node_modules/lodash/_getValue.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/InputOutput.js","webpack:///./node_modules/lodash/_isLaziable.js","webpack:///./node_modules/bpmnlint/rules/end-event-required.js","webpack:///./node_modules/lodash/_WeakMap.js","webpack:///./node_modules/lodash/_defineProperty.js","webpack:///./node_modules/lodash/_getMatchData.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/HistoryTimeToLive.js","webpack:///./node_modules/core-js/modules/es.string.iterator.js","webpack:///./node_modules/lodash/values.js","webpack:///./node_modules/lodash/now.js","webpack:///./node_modules/bpmnlint/rules/sub-process-blank-start-event.js","webpack:///./node_modules/qs/lib/stringify.js","webpack:///./node_modules/lodash/keyBy.js","webpack:///./node_modules/lodash/xor.js","webpack:///./node_modules/lodash/_getMapData.js","webpack:///./node_modules/lodash/_arraySome.js","webpack:///./node_modules/lodash/_getTag.js","webpack:///./node_modules/qs/lib/index.js","webpack:///./node_modules/lodash/_copyArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ServiceTaskDelegateProps.js","webpack:///./node_modules/lodash/_baseLodash.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/parts/ChooserProps.js","webpack:///./node_modules/lodash/_createCurry.js","webpack:///./node_modules/lodash/_baseIndexOf.js","webpack:///./node_modules/lodash/_baseEach.js","webpack:///./src/views/Editor.vue?c506","webpack:///./node_modules/bpmn-js/lib/BaseModeler.js","webpack:///./node_modules/diagram-js/lib/features/touch/TouchInteractionEvents.js","webpack:///./node_modules/diagram-js/lib/features/touch/TouchFix.js","webpack:///./node_modules/diagram-js/lib/features/touch/index.js","webpack:///./node_modules/diagram-js/lib/navigation/touch/index.js","webpack:///./node_modules/diagram-js/lib/features/align-elements/AlignElements.js","webpack:///./node_modules/diagram-js/lib/features/align-elements/index.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlaceUtil.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlace.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlaceSelectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/index.js","webpack:///./node_modules/diagram-js/lib/command/CommandInterceptor.js","webpack:///./node_modules/diagram-js/lib/features/auto-resize/AutoResize.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/BpmnAutoResize.js","webpack:///./node_modules/diagram-js/lib/features/rules/RuleProvider.js","webpack:///./node_modules/diagram-js/lib/features/auto-resize/AutoResizeProvider.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/BpmnAutoResizeProvider.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/index.js","webpack:///./node_modules/diagram-js/lib/features/dragging/Dragging.js","webpack:///./node_modules/diagram-js/lib/features/dragging/HoverFix.js","webpack:///./node_modules/diagram-js/lib/features/dragging/index.js","webpack:///./node_modules/diagram-js/lib/features/auto-scroll/AutoScroll.js","webpack:///./node_modules/diagram-js/lib/features/auto-scroll/index.js","webpack:///./node_modules/diagram-js/lib/features/rules/Rules.js","webpack:///./node_modules/diagram-js/lib/features/rules/index.js","webpack:///./node_modules/diagram-js/lib/util/LineIntersection.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointUtil.js","webpack:///./node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/Bendpoints.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointMove.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointMovePreview.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/ConnectionSegmentMove.js","webpack:///./node_modules/diagram-js/lib/features/snapping/SnapUtil.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointSnapping.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/index.js","webpack:///./node_modules/diagram-js/lib/features/connect/Connect.js","webpack:///./node_modules/diagram-js/lib/features/connect/ConnectPreview.js","webpack:///./node_modules/diagram-js/lib/features/connect/index.js","webpack:///./node_modules/diagram-js/lib/features/connection-preview/ConnectionPreview.js","webpack:///./node_modules/diagram-js/lib/features/connection-preview/index.js","webpack:///./node_modules/diagram-js-direct-editing/lib/TextBox.js","webpack:///./node_modules/diagram-js-direct-editing/lib/DirectEditing.js","webpack:///./node_modules/diagram-js-direct-editing/index.js","webpack:///./node_modules/diagram-js/lib/features/context-pad/ContextPad.js","webpack:///./node_modules/diagram-js/lib/features/context-pad/index.js","webpack:///./node_modules/diagram-js/lib/features/preview-support/PreviewSupport.js","webpack:///./node_modules/diagram-js/lib/features/preview-support/index.js","webpack:///./node_modules/diagram-js/lib/features/create/Create.js","webpack:///./node_modules/diagram-js/lib/features/create/CreatePreview.js","webpack:///./node_modules/diagram-js/lib/features/create/index.js","webpack:///./node_modules/diagram-js/lib/features/popup-menu/PopupMenu.js","webpack:///./node_modules/diagram-js/lib/features/popup-menu/index.js","webpack:///./node_modules/diagram-js/lib/features/clipboard/Clipboard.js","webpack:///./node_modules/diagram-js/lib/features/clipboard/index.js","webpack:///./node_modules/diagram-js/lib/features/mouse/Mouse.js","webpack:///./node_modules/diagram-js/lib/features/mouse/index.js","webpack:///./node_modules/diagram-js/lib/features/copy-paste/CopyPaste.js","webpack:///./node_modules/diagram-js/lib/features/copy-paste/index.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/BpmnCopyPaste.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/ModdleCopy.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/index.js","webpack:///./node_modules/diagram-js/lib/features/replace/Replace.js","webpack:///./node_modules/diagram-js/lib/features/replace/index.js","webpack:///./node_modules/bpmn-js/lib/features/replace/BpmnReplace.js","webpack:///./node_modules/bpmn-js/lib/features/replace/index.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/util/TypeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/replace/ReplaceOptions.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/ReplaceMenuProvider.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/index.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/util/LaneUtil.js","webpack:///./node_modules/bpmn-js/lib/features/context-pad/ContextPadProvider.js","webpack:///./node_modules/bpmn-js/lib/features/context-pad/index.js","webpack:///./node_modules/diagram-js/lib/features/distribute-elements/DistributeElements.js","webpack:///./node_modules/diagram-js/lib/features/distribute-elements/index.js","webpack:///./node_modules/bpmn-js/lib/features/distribute-elements/BpmnDistributeElements.js","webpack:///./node_modules/bpmn-js/lib/features/distribute-elements/index.js","webpack:///./node_modules/diagram-js/lib/features/editor-actions/EditorActions.js","webpack:///./node_modules/diagram-js/lib/features/editor-actions/index.js","webpack:///./node_modules/bpmn-js/lib/features/editor-actions/BpmnEditorActions.js","webpack:///./node_modules/bpmn-js/lib/features/editor-actions/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/BpmnGridSnapping.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/GridUtil.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/GridSnapping.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/ResizeBehavior.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/SpaceToolBehavior.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/index.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/AutoPlaceBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/CreateParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/LayoutConnectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/interaction-events/BpmnInteractionEvents.js","webpack:///./node_modules/bpmn-js/lib/features/interaction-events/index.js","webpack:///./node_modules/bpmn-js/lib/features/keyboard/BpmnKeyboardBindings.js","webpack:///./node_modules/bpmn-js/lib/features/keyboard/index.js","webpack:///./node_modules/diagram-js/lib/features/keyboard-move-selection/KeyboardMoveSelection.js","webpack:///./node_modules/diagram-js/lib/features/keyboard-move-selection/index.js","webpack:///./node_modules/diagram-js/lib/features/change-support/ChangeSupport.js","webpack:///./node_modules/diagram-js/lib/features/change-support/index.js","webpack:///./node_modules/diagram-js/lib/features/resize/Resize.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizePreview.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizeHandles.js","webpack:///./node_modules/diagram-js/lib/features/resize/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/CategoryUtil.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/LabelEditingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/LabelEditingPreview.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AdaptiveLabelPositioningBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AppendBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AssociationBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AttachEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/BoundaryEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RootElementReferenceBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/FixHoverBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateDataObjectBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DataInputAssociationBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateSemanticParentHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DataStoreBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DeleteLaneBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DetachEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DropOnFlowBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/EventBasedGatewayBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/GroupBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LineIntersect.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ImportDockingFix.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/IsHorizontalFix.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/GeometricUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LineAttachmentUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LabelLayoutUtil.js","webpack:///./node_modules/diagram-js/lib/util/AttachUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/LabelBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ModelingFeedback.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ReplaceConnectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RemoveParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ReplaceElementBehaviour.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/ResizeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ResizeBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ResizeLaneBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RemoveElementBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/SpaceToolBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/SubProcessStartEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ToggleElementCollapseBehaviour.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UnclaimIdBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UpdateFlowNodeRefsBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UnsetDefaultFlowBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnSnappingUtil.js","webpack:///./node_modules/bpmn-js/lib/features/rules/BpmnRules.js","webpack:///./node_modules/bpmn-js/lib/features/rules/index.js","webpack:///./node_modules/diagram-js/lib/features/ordering/OrderingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/ordering/BpmnOrderingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/ordering/index.js","webpack:///./node_modules/diagram-js/lib/command/CommandStack.js","webpack:///./node_modules/diagram-js/lib/command/index.js","webpack:///./node_modules/diagram-js/lib/features/tooltips/Tooltips.js","webpack:///./node_modules/diagram-js/lib/features/tooltips/index.js","webpack:///./node_modules/diagram-js/lib/util/Removal.js","webpack:///./node_modules/diagram-js/lib/features/label-support/LabelSupport.js","webpack:///./node_modules/diagram-js/lib/features/label-support/index.js","webpack:///./node_modules/diagram-js/lib/features/attach-support/AttachSupport.js","webpack:///./node_modules/diagram-js/lib/features/attach-support/index.js","webpack:///./node_modules/diagram-js/lib/features/tool-manager/ToolManager.js","webpack:///./node_modules/diagram-js/lib/features/tool-manager/index.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceUtil.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceTool.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceToolPreview.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnFactory.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnUpdater.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/ElementFactory.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/AlignElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/AppendShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateLabelHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DistributeElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/LayoutConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/AnchorsHelper.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveClosure.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveHelper.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ReconnectConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ReplaceShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ResizeShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/SpaceToolHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ToggleShapeCollapseHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/UpdateAttachmentHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/UpdateWaypointsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdatePropertiesHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateCanvasRootHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/AddLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/SplitLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/ResizeLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateFlowNodeRefsHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/IdClaimHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/SetColorHandler.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/cmd/UpdateLabelHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/diagram-js/lib/layout/BaseLayouter.js","webpack:///./node_modules/diagram-js/lib/layout/ManhattanLayout.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnLayouter.js","webpack:///./node_modules/diagram-js/lib/layout/CroppingConnectionDocking.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/index.js","webpack:///./node_modules/diagram-js/lib/features/move/Move.js","webpack:///./node_modules/diagram-js/lib/features/move/MovePreview.js","webpack:///./node_modules/diagram-js/lib/features/move/index.js","webpack:///./node_modules/diagram-js/lib/features/palette/Palette.js","webpack:///./node_modules/diagram-js/lib/features/palette/index.js","webpack:///./node_modules/diagram-js/lib/features/lasso-tool/LassoTool.js","webpack:///./node_modules/diagram-js/lib/features/lasso-tool/index.js","webpack:///./node_modules/diagram-js/lib/features/hand-tool/HandTool.js","webpack:///./node_modules/diagram-js/lib/features/hand-tool/index.js","webpack:///./node_modules/diagram-js/lib/features/global-connect/GlobalConnect.js","webpack:///./node_modules/diagram-js/lib/features/global-connect/index.js","webpack:///./node_modules/bpmn-js/lib/features/palette/PaletteProvider.js","webpack:///./node_modules/bpmn-js/lib/features/palette/index.js","webpack:///./node_modules/bpmn-js/lib/features/replace-preview/BpmnReplacePreview.js","webpack:///./node_modules/bpmn-js/lib/features/replace-preview/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnConnectSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/SnapContext.js","webpack:///./node_modules/diagram-js/lib/features/snapping/CreateMoveSnapping.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnCreateMoveSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/ResizeSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/Snapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/index.js","webpack:///./node_modules/diagram-js/lib/features/search-pad/SearchPad.js","webpack:///./node_modules/diagram-js/lib/features/search-pad/index.js","webpack:///./node_modules/bpmn-js/lib/features/search/BpmnSearchProvider.js","webpack:///./node_modules/bpmn-js/lib/features/search/index.js","webpack:///./node_modules/bpmn-js/lib/Modeler.js","webpack:///./src/components/Search.vue?7c84","webpack:///src/components/Search.vue","webpack:///./src/components/Search.vue?329d","webpack:///./src/components/Search.vue","webpack:///./src/components/FileUpload.vue?7528","webpack:///src/components/FileUpload.vue","webpack:///./src/components/FileUpload.vue?cda3","webpack:///./src/components/FileUpload.vue","webpack:///./src/network/request.js","webpack:///./node_modules/bpmn-js-bpmnlint/node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/bpmn-js-bpmnlint/dist/index.esm.js","webpack:///./src/bpmn/lint/.bpmnlintrc","webpack:///src/views/Editor.vue","webpack:///./src/views/Editor.vue?4f20","webpack:///./src/views/Editor.vue","webpack:///./node_modules/lodash/_hashClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/cmd/ChangeElementTemplateHandler.js","webpack:///./node_modules/lodash/toInteger.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/MultiInstanceLoopProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TextBoxEntryFactory.js","webpack:///./node_modules/core-js/modules/es.array.filter.js","webpack:///./node_modules/core-js/internals/array-from.js","webpack:///./node_modules/lodash/_setWrapToString.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/AsyncCapableHelper.js","webpack:///./node_modules/lodash/_createAggregator.js","webpack:///./node_modules/lodash/transform.js","webpack:///./node_modules/lodash/_baseTimes.js","webpack:///./node_modules/lodash/findIndex.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/SignalEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/UpdateBusinessObjectListHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/InputOutputHelper.js","webpack:///./node_modules/lodash/_stackHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ErrorEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TableEntryFactory.js","webpack:///./node_modules/lodash/_nativeKeys.js","webpack:///./node_modules/lodash/_getHolder.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/FieldInjectionProps.js","webpack:///./node_modules/lodash/_baseFlatten.js","webpack:///./node_modules/lodash/_createFind.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ScriptTaskProps.js","webpack:///./node_modules/lodash/_ListCache.js","webpack:///./node_modules/lodash/_arrayIncludesWith.js","webpack:///./node_modules/core-js/internals/string-punycode-to-ascii.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/LabelFactory.js","webpack:///./node_modules/lodash/_nativeCreate.js","webpack:///./node_modules/lodash/_LazyWrapper.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/lodash/toFinite.js","webpack:///./node_modules/lodash/_baseMatches.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConditionalProps.js","webpack:///./node_modules/core-js/internals/string-multibyte.js","webpack:///./node_modules/lodash/_baseGet.js","webpack:///./node_modules/core-js/internals/array-species-create.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobPriority.js","webpack:///./node_modules/lodash/isArray.js","webpack:///./node_modules/lodash/_listCacheSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/index.js","webpack:///./node_modules/bpmnlint/rules/no-duplicate-sequence-flows.js","webpack:///./node_modules/bpmnlint/rules/event-sub-process-typed-start-event.js","webpack:///./node_modules/lodash/_listCacheDelete.js","webpack:///./node_modules/lodash/_createHybrid.js","webpack:///./node_modules/lodash/_metaMap.js","webpack:///./node_modules/lodash/forEach.js","webpack:///./node_modules/bpmnlint/lib/traverse.js","webpack:///./node_modules/lodash/_arrayLikeKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/TasklistProps.js","webpack:///./node_modules/lodash/_baseFor.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps.js","webpack:///./node_modules/lodash/constant.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/ElementTemplatesLoader.js","webpack:///./node_modules/lodash/isTypedArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/ComboEntryFactory.js","webpack:///./node_modules/lodash/_baseIsTypedArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ExternalTaskConfigurationProps.js","webpack:///./node_modules/lodash/_createSet.js","webpack:///./node_modules/lodash/_baseCreate.js","webpack:///./node_modules/lodash/toString.js","webpack:///./node_modules/lodash/_arrayMap.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExtensionElements.js","webpack:///./node_modules/lodash/_Map.js","webpack:///./node_modules/lodash/_hashHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Listener.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/cmd/index.js","webpack:///./node_modules/lodash/_MapCache.js","webpack:///./node_modules/bpmnlint-utils/dist/index.esm.js","webpack:///./node_modules/lodash/_baseIsEqualDeep.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/InputOutputProps.js","webpack:///./node_modules/lodash/_mapCacheClear.js","webpack:///./node_modules/selection-update/index.js","webpack:///./node_modules/lodash/_baseGetAllKeys.js","webpack:///./node_modules/lodash/_Stack.js","webpack:///./node_modules/lodash/_setCacheAdd.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/CamundaPropertiesProvider.js","webpack:///./node_modules/lodash/_stackGet.js","webpack:///./node_modules/lodash/_arrayEach.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/EntryFieldDescription.js","webpack:///./node_modules/core-js/internals/create-property.js","webpack:///./node_modules/lodash/_apply.js","webpack:///./node_modules/lodash/hasIn.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/MultiInstanceLoopCharacteristics.js","webpack:///./node_modules/lodash/_baseAssignValue.js","webpack:///./node_modules/lodash/_createBind.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ErrorEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/CheckboxEntryFactory.js","webpack:///./node_modules/bpmnlint/rules/no-gateway-join-fork.js","webpack:///./node_modules/lodash/_arrayIncludes.js","webpack:///./node_modules/lodash/_copyObject.js","webpack:///./node_modules/lodash/_overArg.js","webpack:///./node_modules/lodash/filter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/AsynchronousContinuationProps.js","webpack:///./node_modules/lodash/_mapCacheDelete.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/CategoryHelper.js","webpack:///./node_modules/lodash/_createBaseEach.js","webpack:///./node_modules/lodash/isFunction.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ImplementationType.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps.js","webpack:///./node_modules/lodash/eq.js","webpack:///./node_modules/lodash/_baseIsMatch.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/FormHelper.js","webpack:///./node_modules/lodash/_baseMap.js","webpack:///./node_modules/core-js/modules/web.url-search-params.js","webpack:///./node_modules/lodash/flattenDeep.js","webpack:///./node_modules/lodash/_createBaseFor.js","webpack:///./node_modules/lodash/_nodeUtil.js","webpack:///./node_modules/core-js/internals/get-iterator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/parts/CustomProps.js","webpack:///./node_modules/lodash/_isIterateeCall.js","webpack:///./node_modules/lodash/get.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobRetryTimeCycle.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/qs/lib/parse.js","webpack:///./node_modules/lodash/_baseFilter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Script.js","webpack:///./node_modules/lodash/_arrayAggregator.js","webpack:///./node_modules/bpmnlint/lib/test-rule.js","webpack:///./node_modules/lodash/_equalArrays.js","webpack:///./node_modules/lodash/_baseSetToString.js","webpack:///./node_modules/lodash/_mapCacheHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/CompensateEventDefinition.js","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Delegate.js","webpack:///./node_modules/lodash/_reorder.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ElementReferenceProperty.js","webpack:///./node_modules/lodash/_getAllKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/InputOutputParameter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/InputOutputParameterProps.js","webpack:///./node_modules/lodash/_mergeData.js","webpack:///./node_modules/lodash/_setToArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ResultVariable.js","webpack:///./node_modules/core-js/internals/array-method-uses-to-length.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/StartEventInitiator.js","webpack:///./node_modules/lodash/_baseUnary.js","webpack:///./node_modules/lodash/debounce.js","webpack:///./node_modules/lodash/_equalObjects.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ErrorEventProps.js","webpack:///./node_modules/lodash/isLength.js","webpack:///./node_modules/qs/lib/formats.js","webpack:///./node_modules/lodash/_baseSetData.js","webpack:///./node_modules/bpmnlint/rules/no-implicit-split.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/lodash/_listCacheGet.js","webpack:///./node_modules/lodash/_DataView.js","webpack:///./node_modules/core-js/internals/array-iteration.js","webpack:///./node_modules/lodash/_countHolders.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/VersionTagProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/PropertiesActivator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/PropertiesProps.js","webpack:///./node_modules/lodash/_getWrapDetails.js","webpack:///./node_modules/lodash/_baseIteratee.js","webpack:///./node_modules/lodash/_hashGet.js","webpack:///./node_modules/lodash/noop.js","webpack:///./node_modules/bpmnlint/rules/no-complex-gateway.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExternalTaskPriority.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TextInputEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/DocumentationProps.js","webpack:///./node_modules/lodash/_baseIsEqual.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ConditionalEventDefinition.js","webpack:///./node_modules/lodash/_isIndex.js","webpack:///./node_modules/bpmnlint/rules/helper.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/CreateAndReferenceHandler.js","webpack:///./node_modules/bpmnlint/rules/single-blank-start-event.js","webpack:///./node_modules/lodash/_setToString.js","webpack:///./src/views/Editor.vue?eeb7","webpack:///./node_modules/lodash/_wrapperClone.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/VariableMappingProps.js","webpack:///./node_modules/bpmnlint/rules/no-disconnected.js","webpack:///./node_modules/lodash/_cacheHas.js","webpack:///./node_modules/lodash/_Set.js","webpack:///./node_modules/hammerjs/hammer.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/bpmnlint/rules/label-required.js","webpack:///./node_modules/lodash/_assocIndexOf.js","webpack:///./node_modules/lodash/_composeArgs.js","webpack:///./node_modules/lodash/identity.js","webpack:///./node_modules/lodash/_baseToString.js","webpack:///./node_modules/lodash/_createPartial.js","webpack:///./node_modules/lodash/_stackSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/PropertiesPanel.js","webpack:///./node_modules/qs/lib/utils.js","webpack:///./node_modules/lodash/stubArray.js","webpack:///./node_modules/lodash/isArguments.js","webpack:///./node_modules/bpmnlint/rules/no-inclusive-gateway.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/MultiCommandHandler.js","webpack:///./node_modules/bpmnlint/rules/start-event-required.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/EventDefinitionHelper.js","webpack:///./node_modules/lodash/_SetCache.js","webpack:///./node_modules/lodash/_baseIsNaN.js","webpack:///./node_modules/lodash/_coreJsData.js","webpack:///./node_modules/lodash/_insertWrapDetails.js","webpack:///./node_modules/lodash/_setCacheHas.js","webpack:///./node_modules/lodash/_toSource.js","webpack:///./node_modules/lodash/isArrayLikeObject.js","webpack:///./node_modules/lodash/assign.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ParticipantHelper.js","webpack:///./node_modules/lodash/map.js","webpack:///./node_modules/core-js/modules/web.dom-collections.iterator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/SelectEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/UpdateBusinessObjectHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ImplementationTypeHelper.js","webpack:///./node_modules/lodash/_Hash.js","webpack:///./node_modules/lodash/_hasPath.js","webpack:///./node_modules/lodash/_castPath.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/AsyncContinuation.js","webpack:///./node_modules/bpmnlint/lib/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Helper.js","webpack:///./node_modules/lodash/memoize.js","webpack:///./node_modules/lodash/_basePropertyDeep.js","webpack:///./node_modules/lodash/_createRecurry.js","webpack:///./node_modules/css.escape/css.escape.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/EntryFactory.js","webpack:///./node_modules/lodash/_replaceHolders.js","webpack:///./node_modules/core-js/internals/is-array.js","webpack:///./node_modules/lodash/_createWrap.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorInputOutputParameterProps.js","webpack:///./node_modules/lodash/_LodashWrapper.js","webpack:///./node_modules/lodash/_isPrototype.js","webpack:///./node_modules/lodash/keys.js","webpack:///./node_modules/lodash/_baseXor.js","webpack:///./node_modules/lodash/_mapToArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/CandidateStarterProps.js","webpack:///./node_modules/lodash/_baseProperty.js","webpack:///./node_modules/lodash/_stackClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/FormProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Tasklist.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/ExecutableProps.js","webpack:///./node_modules/lodash/_shortOut.js","webpack:///./node_modules/lodash/_toKey.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/EscalationEventDefinition.js","webpack:///./node_modules/lodash/_isKey.js","webpack:///./node_modules/lodash/_setData.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/EventDefinitionReference.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/MessageEventDefinition.js","webpack:///./node_modules/lodash/property.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/JobConfigurationProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/FieldInjection.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/ValidationAwareTextInput.js","webpack:///./node_modules/lodash/_listCacheHas.js","webpack:///./src/components/FileUpload.vue?6704","webpack:///./node_modules/core-js/internals/dom-iterables.js","webpack:///./node_modules/lodash/_updateWrapDetails.js","webpack:///./node_modules/bpmnlint/rules/fake-join.js","webpack:///./node_modules/mitt/dist/mitt.es.js","webpack:///./node_modules/scroll-tabs/index.js","webpack:///./node_modules/lodash/isSymbol.js"],"names":["is","find","entryFactory","cmdHelper","ImplementationTypeHelper","scriptImplementation","timerImplementation","isTimeoutTaskListener","listener","eventType","event","getTimerEventDefinition","bo","eventDefinitions","module","exports","group","element","bpmnFactory","options","translate","LISTENER_TYPE_LABEL","class","expression","delegateExpression","script","getSelectedListener","classProp","expressionProp","delegateExpressionProp","scriptProp","executionListenerEventTypeOptions","isSequenceFlow","name","value","taskListenerEventTypeOptions","isSelected","node","entries","push","selectBox","id","label","modelProperty","emptyParameter","get","set","values","updateBusinessObject","selectOptions","eventTypeOptions","selectedListener","isTaskListener","isExecutionListener","hidden","textField","listenerId","undefined","update","validate","listenerType","getImplementationType","create","dataValueLabel","listenerValueLabel","listenerValue","html","template","isScript","timerEventDefinitionHandler","timerEventDefinition","createTimerEventDefinition","timerOptions","idPrefix","Symbol","objectProto","Object","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","getRawTag","isOwn","call","tag","unmasked","e","result","getBusinessObject","callable","flattenDeep","assign","getCallableType","boCalledElement","boCaseRef","callActivityType","DEFAULT_PROPS","calledElement","type","props","updateProperties","isPrototype","nativeKeys","baseKeys","object","key","__depends__","default","__init__","propertiesProvider","inputOutput","inputOutputEntry","insideConnector","concat","getSelectedParameter","InputOutputHelper","getServiceTaskLikeBusinessObject","getConnector","isConnector","connector","connectorId","isArguments","isArray","spreadableSymbol","isConcatSpreadable","isFlattenable","stubFalse","factory","elementHelper","extensionElementsHelper","utils","forEach","generatePropertyId","nextId","getPropertyValues","parent","properties","getPropertiesElement","isExtensionElements","getPropertiesElementInsideExtensionElements","extensionElements","elem","getParent","modelProperties","createParent","addLabel","getElements","addElement","commands","cmd","createElement","addAndRemoveElementsFromList","propertyProps","prop","indexOf","property","addElementsTolist","updateElement","idx","validationError","isIdValid","removeElement","propertyValues","currentProperty","removeElementsFromList","length","removeEntry","table","arrayPush","array","index","offset","isObject","isStrictComparable","strictIndexOf","fromIndex","createInputParameter","binding","parameterValue","parameterDefinition","scriptFormat","definition","createOutputParameter","source","createCamundaProperty","createCamundaIn","createCamundaInOutAttrs","createCamundaInWithBusinessKey","businessKey","createCamundaOut","createCamundaExecutionListenerScript","createCamundaFieldInjection","string","target","sourceExpression","variables","local","k","baseIsNative","getValue","getNative","freeExports","nodeType","freeModule","moduleExports","Buffer","root","nativeIsBuffer","isBuffer","fails","wellKnownSymbol","IS_PURE","ITERATOR","url","URL","searchParams","pathname","toJSON","sort","href","String","URLSearchParams","username","host","hash","identity","overRest","setToString","baseRest","func","start","isAny","eventDefinitionHelper","message","signal","error","escalation","timer","compensation","condition","elementRegistry","events","messageEventDefinition","getMessageEventDefinition","signalEventDefinition","getSignalEventDefinition","errorEvents","errorEventDefinition","getErrorEventDefinition","escalationEvents","showEscalationCodeVariable","escalationEventDefinition","getEscalationEventDefinition","timerEvents","compensationEvents","compensateEventDefinition","getCompensateEventDefinition","conditionalEvents","conditionalEventDefinition","getConditionalEventDefinition","realNames","getFuncName","data","otherFunc","ElementHelper","elementType","$parent","isConditionalForking","defaultFlow","outgoing","hasCondition","flow","conditionExpression","isDefaultFlow","check","reporter","missingCondition","report","baseCreate","createCtor","Ctor","args","arguments","thisBinding","apply","historyTimeToLive","businessObject","isKeyable","castFunction","isObjectLike","coreJsData","maskSrcKey","uid","exec","keys","IE_PROTO","isMasked","getTag","isArrayLike","isTypedArray","mapTag","setTag","isEmpty","splice","size","types","t","anyType","candidateStarterGroupsEntry","description","candidateStarterGroups","candidateStarterUsersEntry","candidateStarterUsers","baseIsEqual","hasIn","isKey","matchesStrictComparable","toKey","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","baseMatchesProperty","path","srcValue","objValue","escapeHTML","entryFieldDescription","bind","link","showLink","handleClick","Error","resource","cssClasses","resultVariable","attributeInfo","bpmn","version","versionTag","tenantId","cmmn","dmn","mapDecisionResultOptions","delegateVariableMappingOptions","getCamundaInWithBusinessKey","camundaIn","camundaInParams","getExtensionElements","param","setBusinessKey","text","camundaInWithBusinessKey","deleteBusinessKey","camundaInExtensions","isSupportedCallableType","bindingOptions","getAttribute","getCallActivityBindingValue","attr","getDelegateVariableMappingType","boVariableMappingClass","boVariableMappingDelegateExpression","delegateVariableMappingType","callableElementRef","callableElementLabel","newCallableElementRef","elementRef","filter","bindingOption","callableBinding","attrVer","attrVerTag","callableVersion","checkbox","callableBusinessKey","hideResultVariable","mapDecisionResult","delegateVariableMapping","delegateVariableMappingLabel","memoizeCapped","rePropName","reEscapeChar","stringToPath","charCodeAt","replace","match","number","quote","subString","Uint8Array","eq","equalArrays","mapToArray","setToArray","boolTag","dateTag","errorTag","numberTag","regexpTag","stringTag","symbolTag","arrayBufferTag","dataViewTag","symbolProto","symbolValueOf","valueOf","equalByTag","other","bitmask","customizer","equalFunc","stack","byteLength","byteOffset","buffer","convert","isPartial","stacked","Promise","CreateBusinessObjectListHandler","this","_elementRegistry","_bpmnFactory","ensureNotNull","ensureList","$inject","execute","context","currentObject","propertyName","newObjects","changed","childObjects","self","obj","childObject","previousChilds","revert","getTimerDefinitionType","timeDate","timeCycle","timeDuration","getTimerDefinition","timerOrFunction","createFormalExpression","body","TimerEventDefinition","prefix","timerDefinition","timerDefinitionType","newType","oldType","V8_VERSION","SPECIES","METHOD_NAME","constructor","foo","Boolean","hashDelete","has","__data__","getMapData","mapCacheSet","isExternal","topicEntry","externalTopic","nativeMax","Math","max","transform","Array","otherArgs","memoize","MAX_MEMOIZE_SIZE","cache","clear","inherits","getTemplate","PropertiesActivator","HIGHER_PRIORITY","CustomElementsPropertiesActivator","eventBus","elementTemplates","isEntryVisible","entry","isPropertyEditable","isEntryEditable","CUSTOM_PROPERTIES_PATTERN","DEFAULT_ENTRIES_VISIBLE","_all","isCustomEntry","test","entryId","entriesVisible","defaultVisible","entryVisible","getProperty","editable","indexes","split","scopeName","parseInt","isNaN","scopes","baseFor","baseForOwn","iteratee","baseEach","baseAggregator","collection","setter","accumulator","mapCacheGet","nativeCreate","HASH_UNDEFINED","hashSet","baseGetTag","argsTag","baseIsArguments","fieldInjection","insideListener","fieldInjectionEntry","nameEntryFactory","createCategoryValue","canvas","initializeCategory","semantic","rootElement","getRootElement","definitions","categoryValue","categoryValueRef","setGroupName","newLabel","getGroupName","arrayMap","baseValues","createWrap","getHolder","replaceHolders","WRAP_BIND_FLAG","WRAP_PARTIAL_FLAG","thisArg","partials","holders","placeholder","baseHasIn","createFind","findIndex","metaMap","noop","getData","listCacheClear","nameEntry","textBox","objectToString","LazyWrapper","LodashWrapper","baseLodash","wrapperClone","lodash","ElementTemplates","_templates","descriptors","templates","descriptor","getAll","testRule","categoryMap","0","1","2","Linter","config","resolver","cachedRules","cachedConfigs","prefixPackage","pkg","startsWith","unprefixPackage","substring","applyRule","moddleRoot","ruleDefinition","rule","category","reports","map","console","resolveRule","ruleName","parseRuleName","resolve","then","ruleFactory","resolveConfig","configName","parseConfigName","actualConfig","normalizeConfig","resolveRules","resolveConfiguredRules","rulesConfig","parsedRules","parseRuleValue","enabledRules","loaders","all","parents","extends","inheritedRules","overrideRules","rules","reduce","currentRules","lint","ruleDefinitions","allReports","toLowerCase","localPackage","_","ns","packageName","getSimplePackageName","validatedRules","normalizedRules","normalizedName","CmdHelper","newProperties","listPropertyName","objectsToAdd","referencePropertyName","objectsToRemove","setList","updatedObjectList","ExtensionElementsHelper","extensionValues","elements","addEntry","baseFindIndex","predicate","fromRight","EOF","$","DESCRIPTORS","USE_NATIVE_URL","global","defineProperties","redefine","anInstance","arrayFrom","codeAt","toASCII","setToStringTag","URLSearchParamsModule","InternalStateModule","NativeURL","getInternalSearchParamsState","getState","setInternalState","getInternalURLState","getterFor","floor","pow","INVALID_AUTHORITY","INVALID_SCHEME","INVALID_HOST","INVALID_PORT","ALPHA","ALPHANUMERIC","DIGIT","HEX_START","OCT","DEC","HEX","FORBIDDEN_HOST_CODE_POINT","FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT","LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE","TAB_AND_NEW_LINE","parseHost","input","codePoints","charAt","parseIPv6","slice","isSpecial","parseIPv4","percentEncode","C0ControlPercentEncodeSet","partsLength","numbers","part","radix","ipv4","parts","pop","numbersSeen","ipv4Piece","swaps","swap","address","pieceIndex","compress","pointer","char","findLongestZeroSequence","ipv6","maxIndex","maxLength","currStart","currLength","serializeHost","ignore0","unshift","join","fragmentPercentEncodeSet","pathPercentEncodeSet","userinfoPercentEncodeSet","code","encodeURIComponent","specialSchemes","ftp","file","http","https","ws","wss","scheme","includesCredentials","password","cannotHaveUsernamePasswordPort","cannotBeABaseURL","isWindowsDriveLetter","normalized","second","startsWithWindowsDriveLetter","third","shortenURLsPath","pathSize","isSingleDot","segment","isDoubleDot","SCHEME_START","SCHEME","NO_SCHEME","SPECIAL_RELATIVE_OR_AUTHORITY","PATH_OR_AUTHORITY","RELATIVE","RELATIVE_SLASH","SPECIAL_AUTHORITY_SLASHES","SPECIAL_AUTHORITY_IGNORE_SLASHES","AUTHORITY","HOST","HOSTNAME","PORT","FILE","FILE_SLASH","FILE_HOST","PATH_START","PATH","CANNOT_BE_A_BASE_URL_PATH","QUERY","FRAGMENT","parseURL","stateOverride","base","bufferCodePoints","failure","state","seenAt","seenBracket","seenPasswordToken","port","query","fragment","i","codePoint","encodedCodePoints","shift","URLConstructor","baseState","that","urlString","TypeError","searchParamsState","updateSearchParams","updateURL","serializeURL","origin","getOrigin","protocol","getProtocol","getUsername","getPassword","getHost","hostname","getHostname","getPort","getPathname","search","getSearch","getSearchParams","getHash","URLPrototype","output","accessorDescriptor","getter","configurable","enumerable","nativeCreateObjectURL","createObjectURL","nativeRevokeObjectURL","revokeObjectURL","blob","forced","sham","freeGlobal","freeSelf","Function","SetCache","arrayIncludes","arrayIncludesWith","cacheHas","createSet","LARGE_ARRAY_SIZE","baseUniq","comparator","includes","isCommon","seen","outer","computed","seenIndex","arrayFilter","resIndex","overArg","getPrototype","getPrototypeOf","baseUnary","baseDifference","valuesLength","valuesIndex","isIterateeCall","createAssigner","assigner","sources","guard","listenerEntry","stackDelete","validationAwareTextField","setProperty","labelTarget","idValue","idError","domQuery","domClear","domify","Ids","SPACE_REGEX","QNAME_REGEX","ID_REGEX","HTML_ESCAPE_MAP","'","selectedOption","selectedIndex","selectedType","elementSyntax","inputNode","typeSelect","getRoot","filterElementsByType","objectList","list","findRootElementsByType","referencedType","rootElements","removeAllChildren","domElement","firstChild","removeChild","addEmptyParameter","refreshOptionsModel","model","referableObjects","updateOptionsDropDown","domSelector","entryNode","option","optionEntry","appendChild","assigned","$model","ids","idExists","validateId","containsSpace","nextPrefixed","triggerClickEvent","evt","document","createEvent","MouseEvent","view","window","bubbles","cancelable","initEvent","dispatchEvent","createEventObject","fireEvent","str","composeArgsRight","isCurried","argsIndex","argsLength","holdersIndex","holdersLength","rightIndex","rightLength","rangeLength","isUncurried","isFunction","isLength","baseAssignValue","assignValue","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","getSymbols","symbol","toSource","reRegExpChar","reIsHostCtor","funcProto","funcToString","reIsNative","RegExp","pattern","DROPDOWN_TYPE","VALID_TYPES","PROPERTY_TYPE","CAMUNDA_PROPERTY_TYPE","CAMUNDA_INPUT_PARAMETER_TYPE","CAMUNDA_OUTPUT_PARAMETER_TYPE","CAMUNDA_IN_TYPE","CAMUNDA_OUT_TYPE","CAMUNDA_IN_BUSINESS_KEY_TYPE","CAMUNDA_EXECUTION_LISTENER","CAMUNDA_FIELD","VALID_BINDING_TYPES","Validator","_templatesById","_validTemplates","_errors","addAll","add","_logError","err","_validateTemplate","appliesTo","_validateProperties","_validateScopes","scope","validProperties","_validateProperty","bindingType","choices","every","isDropdownChoiceValid","getErrors","getValidTemplates","c","nullTag","undefinedTag","inputOutputHelper","extensionElementsEntry","getInputOutput","getInputParameters","getOutputParameters","getInputParameter","getOutputParameter","createInputOutput","createParameter","ensureInputOutputSupported","isInputOutputSupported","ensureOutparameterSupported","areOutputParametersSupported","TYPE_LABEL","getSelected","selection","inputEntry","parameter","outputEntry","newElement","inputParameters","outputParameters","newElem","otherProp","firstLength","secondLength","setOptionLabelValue","suffix","$type","resizable","createExtensionElement","removeExtensionElement","onSelectionChange","deselect","isLaziable","funcName","hasEndEvent","flowElements","some","WeakMap","defineProperty","getMatchData","historyTimeToLiveEntry","defineIterator","STRING_ITERATOR","getInternalState","iterated","point","done","now","Date","triggeredByEvent","flowElement","formats","arrayPrefixGenerators","brackets","indices","repeat","toISO","toISOString","defaults","delimiter","encode","encoder","encodeValuesOnly","serializeDate","date","skipNulls","strictNullHandling","stringify","generateArrayPrefix","allowDots","formatter","keyValue","objKeys","opts","format","formatters","arrayFormat","joined","addQueryPrefix","createAggregator","keyBy","baseXor","isArrayLikeObject","xor","arrays","arraySome","DataView","Map","Set","objectTag","promiseTag","weakMapTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","ArrayBuffer","ctorString","parse","copyArray","implementationType","delegate","external","domClosest","closest","domClasses","classes","isDmnCapable","isExternalCapable","isServiceTaskLike","getTabNode","el","containerEl","hasDmnSupport","hasExternalSupport","hasServiceTaskLikeSupport","connectorTabEl","textContent","remove","innerHTML","getTemplateId","TEMPLATE_ATTR","applyTemplate","newTemplateId","oldTemplate","newTemplate","getTemplateOptions","currentTemplateId","emptyOption","allOptions","isDefault","defaultOption","isDefaultTemplate","currentOption","unknownTemplate","templateId","elementTemplate","disabled","createHybrid","createRecurry","createCurry","arity","wrapper","fn","baseIsNaN","baseIndexOf","createBaseEach","render","_vm","_h","$createElement","_c","_self","attrs","staticClass","on","handleImportButton","_v","loadBpmnFromFile","slot","downloadBpmnToFile","downloadBpmnToSVG","textTransform","resetBPMN","checkBPMN","saveBPMN","recoBPMN","showWindow","showUploadWindow","directives","rawName","ref","staticRenderFns","BaseModeler","BaseViewer","_collectIds","_createModdle","moddle","elementsById","claim","MIN_ZOOM","MAX_ZOOM","mouseEvents","log","service","injector","stopEvent","preventDefault","stopPropagation","stopImmediatePropagation","createTouchRecognizer","stopMouse","allowMouse","setTimeout","unbind","recognizer","Manager","inputClass","TouchInput","recognizers","tap","Tap","pan","Pan","threshold","press","Press","pinch","Pinch","doubleTap","taps","requireFailure","reset","force","session","stopped","stop","r","curRecognizer","srcEvent","defaultPrevented","TouchInteractionEvents","interactionEvents","dragging","move","contextPad","palette","handler","fire","getGfx","initEvents","svg","startGrabCanvas","lx","ly","dx","deltaX","dy","deltaY","scroll","end","off","startGrab","gfx","startZoom","zoom","mid","center","ratio","scale","newZoom","min","originalEvent","position","elementFromPoint","x","y","hover","out","hoverGfx","pad","padRecognizer","trigger","container","TouchFix","addBBoxMarker","markerStyle","fill","rect1","width","height","rect2","touchInteractionEvents","touchFix","last","arr","sortTopOrMiddle","sortLeftOrCenter","ALIGNMENT_SORTING","left","right","top","middle","bottom","AlignElements","modeling","_modeling","_getOrientationDetails","vertical","axis","dimension","_isType","_alignmentPosition","sortedElements","centeredElements","firstElement","lastElement","orientation","alignment","centers","hasSharedCenters","getMiddleOrTop","first","round","filteredElements","waypoints","sortFn","alignElements","DEFAULT_HORIZONTAL_DISTANCE","MAX_HORIZONTAL_DISTANCE","PLACEMENT_DETECTION_PAD","getNewShapePosition","getTextAnnotationPosition","getDataElementPosition","getFlowNodePosition","getDefaultPosition","sourceTrbl","sourceMid","horizontalDistance","getFlowNodeDistance","rowSize","margin","getVerticalDistance","orient","escapeDirection","deconflictPosition","isReference","toTargetNode","weight","shape","distanceTo","shapeTrbl","toSourceNode","nodes","getTargets","getSources","distancesGrouped","currentDistance","currentDistanceCount","currentDistanceEntry","fav","count","getAutoPlaceClosure","allConnected","getConnected","attachers","shapes","attacher","getConnectedAtPosition","bounds","closure","escapeDelta","nextPosition","existingElement","newPosition","axisDelta","existingTarget","noneFilter","connectionFilter","incoming","AutoPlace","emit","payload","append","newShape","appendShape","AutoPlaceSelectionBehavior","select","autoPlace","autoPlaceSelectionBehavior","DEFAULT_PRIORITY","CommandInterceptor","_eventBus","unwrapEvent","command","hook","priority","handlerFn","unwrap","fullEvent","hooks","AutoResize","_rules","postExecuted","hints","newParent","autoResize","_expand","topLevel","expandings","parentId","collapsed","children","boundsChanged","newBounds","oldBounds","getResizeDirections","directions","BpmnAutoResize","invoke","RuleProvider","init","AutoResizeProvider","addRule","canResize","BpmnAutoResizeProvider","_getOptimalBounds","getOffset","padding","getPadding","elementsTrbl","targetTrbl","newTrbl","allowed","resizeDirections","resize","resizeShape","resizeLane","actions","action","canExecute","bpmnAutoResize","bpmnAutoResizeProvider","DRAG_ACTIVE_CLS","isTouchEvent","TouchEvent","getLength","sqrt","Dragging","defaultOptions","trapClick","toLocalPoint","globalPosition","viewbox","clientRect","_container","getBoundingClientRect","dragContext","isTouch","restoreSelection","previousSelection","existingSelection","activate","displacement","globalStart","globalCurrent","globalDelta","localStart","localCurrent","localDelta","active","cancel","keepSelection","cursor","addMarker","previousContext","returnValue","cleanup","checkCancel","which","trapClickAndEnd","untrap","trapTouch","restore","wasActive","endDrag","removeMarker","relativeTo","manual","autoActivate","setOptions","HIGH_PRIORITY","HoverFix","ensureHover","_findTargetGfx","once","setDragHover","unsetHover","ensureOut","hoverFix","AutoScroll","_canvas","_opts","scrollThresholdIn","scrollThresholdOut","scrollRepeatTimeout","scrollStep","_toBorderPoint","startScroll","stopScroll","between","val","getContainer","diff","_scrolling","clearTimeout","autoScroll","Rules","_commandStack","commandStack","circlePath","linePath","points","segments","p","INTERSECTION_THRESHOLD","getBendpointIntersection","reference","w","bendpoint","getPathIntersection","intersections","a","b","segment2","getApproxIntersection","BENDPOINT_CLS","SEGMENT_DRAGGER_CLS","toCanvasCoordinates","getConnectionIntersection","localPosition","intersection","addBendpoint","parentGfx","cls","groupGfx","visual","cx","cy","hit","createParallelDragger","segmentStart","segmentEnd","draggerGfx","hitWidth","calculateHitWidth","hitHeight","addSegmentDragger","calculateSegmentMoveRegion","segmentLength","abs","segmentLengthXAxis","segmentLengthYAxis","Bendpoints","bendpointMove","connectionSegmentMove","isIntersectionMiddle","treshold","p0","p1","aligned","xDelta","yDelta","calculateIntersectionThreshold","connection","relevantSegment","activateBendpointMove","bindInteractionEvents","eventName","triggerMouseEvent","getBendpointsContainer","layer","getLayer","getSegmentDragger","createBendpoints","createSegmentDraggers","segmentDraggerGfx","clearBendpoints","clearSegmentDraggers","addHandles","updateHandles","updateFloatingBendpointPosition","floating","updateSegmentDraggerPosition","draggerVisual","relativePosition","getDraggerVisual","bendpointsGfx","marker","newSelection","primary","registerEvent","unregisterEvent","newId","bendpointContainer","RECONNECT_START","RECONNECT_END","UPDATE_WAYPOINTS","BendpointMove","_injector","bendpointIndex","insert","getGraphics","connectionGfx","newWaypoints","docking","cropWaypoints","updateWaypoints","isReverse","reverse","reconnect","connectionDocking","getCroppedWaypoints","MARKER_OK","MARKER_NOT_OK","MARKER_CONNECT_HOVER","MARKER_CONNECT_UPDATING","MARKER_ELEMENT_HIDDEN","BendpointMovePreview","connectionPreview","connectionEnd","connectionStart","noCropping","noLayout","drawPreview","cleanUp","axisAdd","delta","axisSet","axisFenced","maxValue","minValue","fencedValue","flipAxis","getDocking","referenceElement","moveAxis","referenceMid","inverseAxis","original","ConnectionSegmentMove","graphicsFactory","cropConnection","croppedWaypoints","oldWaypoints","redrawConnection","updateDragger","segmentOffset","segmentStartIndex","segmentEndIndex","draggerPosition","filterRedundantWaypoints","filteredWaypoints","direction","dragPosition","originalWaypoints","sourceToSegmentOrientation","targetToSegmentOrientation","newSegmentStart","newSegmentEnd","waypointCount","newSegmentStartIndex","filtered","segmentMove","tolerance","snapValue","topLeft","bottomRight","defaultValue","isSnapped","snapped","setSnapped","previousValue","getChildren","TOLERANCE","BendpointSnapping","snapTo","rem","getConnectionSegmentSnaps","snapPoints","referenceWaypoints","horizontal","getBendpointSnaps","sx","sy","hoverMid","bendpoints","bendpointMovePreview","bendpointSnapping","Connect","canConnect","canConnectReverse","connect","LOW_PRIORITY","ConnectPreview","startPosition","connectPreview","MARKER_CONNECTION_PREVIEW","ConnectionPreview","elementFactory","_graphicsFactory","_elementFactory","_connectionDocking","_layouter","cacheReturnValues","returnValues","firstArgument","JSON","ensureConnectionAttrs","connectionPreviewGfx","getConnection","noNoop","createConnectionPreviewGfx","layoutConnection","drawConnection","drawNoopPreview","createNoopConnection","sourcePath","getShapePath","targetPath","connectionPath","getConnectionPath","createConnection","pointerEvents","getDefaultLayer","isTextNode","Node","TEXT_NODE","toArray","nodeList","TextBox","content","keyHandler","resizeHandler","handlePaste","DirectEditing","_providers","_textbox","_handleKey","_handleResize","style","parentStyle","maxWidth","maxHeight","minWidth","minHeight","backgroundColor","overflow","border","boxSizing","wordWrap","textAlign","outline","contentStyle","centerVertically","innerText","setSelection","lastChild","clipboardData","insertText","hasResized","success","execCommand","_insertTextIE","range","getSelection","startContainer","endContainer","startOffset","endOffset","commonAncestorContainer","childNodesArray","childNodes","containerTextContent","textNode","createTextNode","insertBefore","startContainerChildIndex","endContainerChildIndex","childNode","fontSize","scrollHeight","offsetHeight","resizeHandle","Infinity","startX","startY","startWidth","startHeight","onMouseDown","clientX","clientY","onMouseMove","onMouseUp","newWidth","newHeight","borderTop","borderRight","borderBottom","borderLeft","destroy","removeAttribute","trim","getRangeAt","createRange","selectNodeContents","setStart","setEnd","removeAllRanges","addRange","registerProvider","provider","isActive","_active","_fire","close","complete","containerBounds","previousBounds","$textbox","newText","previousText","keyCode","charCode","shiftKey","directEditing","entrySelector","ContextPad","overlays","_overlays","_overlaysConfig","_current","_init","addClasses","classNames","actualClassNames","open","isOpen","current","providers","getEntries","_getProviders","entriesOrUpdater","getContextPadEntries","button","delegateTarget","_updateAndOpen","getPad","grouping","control","className","title","imageUrl","overlaysConfig","_overlayId","MARKER_TYPES","NODES_CAN_HAVE_MARKER","PreviewSupport","styles","_styles","_clonedMarkers","clonedMarker","getMarker","markerType","parentNode","referenceToId","idToReference","canHaveMarker","nodeName","addDragger","dragger","bbox","_cloneMarkers","addFrame","frame","_cloneMarker","markerId","clonedMarkerId","defs","_svg","previewSupport","MARKER_ATTACH","MARKER_NEW_PARENT","PREFIX","Create","canCreate","isLabel","isConnection","attach","isSingleShape","targetParent","targetAttach","setMarker","m","ensureConstraints","createElements","waypoint","createConstraints","CreatePreview","createDragGroup","dragGroup","childrenGfx","_createContainer","drawShape","defaultLayer","createPreview","DATA_REF","CLOSE_EVENTS","PopupMenu","_config","setTransform","providerId","_getEntries","headerEntries","_getHeaderEntries","hasEntries","hasHeaderEntries","_emit","_createEntries","_attachContainer","_bindAutoClose","_unbindAutoClose","_getEntry","getPopupMenuEntries","getPopupMenuHeaderEntries","getHeaderEntries","visibility","_updateScale","_assureIsInbounds","minScale","maxScale","scaleConfig","containerX","offsetLeft","containerY","offsetTop","containerWidth","scrollWidth","containerHeight","overAxis","cursorPosition","entriesContainer","entryContainer","_createEntry","entryClasses","popupMenu","Clipboard","_data","clipboard","Mouse","setLastMoveEvent","mousemoveEvent","_lastMoveEvent","addEventListener","_lastMouseEvent","removeEventListener","createMoveEvent","screenX","screenY","initMouseEvent","getLastMoveEvent","mouse","CopyPaste","_create","_clipboard","_mouse","parentCopied","isAttacher","copyWaypoints","createElementsBehavior","copyWaypoint","copy","tree","createTree","paste","_createElements","_paste","branch","depth","createLabel","createShape","hasRelations","elementsData","canCopy","addElementData","foundElementData","removeElementData","elementData","_index","labels","addRelatedElements","copyPaste","copyProperties","removeProperties","BpmnCopyPaste","moddleCopy","references","resolveReferences","attachedToRef","oldBusinessObject","di","bpmnProcess","copyElement","newBusinessObject","DISALLOWED_PROPERTIES","ModdleCopy","_moddle","propertyNames","parentDescriptor","$descriptor","getPropertyNames","keepDefaultProperties","$instanceOf","sourceElement","targetElement","canCopyProperties","sourceProperty","copiedProperty","copyProperty","canSetProperty","propertyDescriptor","getPropertyDescriptor","isId","childProperties","childProperty","getElementDescriptor","isGeneric","bpmnCopyPaste","Replace","replaceElement","oldElement","newElementData","centerX","centerY","replaceShape","CUSTOM_PROPERTIES","toggeling","targetCollapsed","oldCollapsed","isExpanded","BpmnReplace","isSubProcess","toggleCollapse","elementProps","newElementProps","copyProps","hasEventDefinition","eventDefinitionType","moveChildren","processRef","_getDefaultSize","a1","a2","bpmnReplace","isDifferentType","eventDefinition","isTypeEqual","isEventDefinitionEqual","isTriggeredByEventEqual","isExpandedEqual","START_EVENT","actionName","INTERMEDIATE_EVENT","END_EVENT","GATEWAY","instantiate","eventGatewayType","SUBPROCESS_EXPANDED","TRANSACTION","EVENT_SUB_PROCESS","TASK","BOUNDARY_EVENT","cancelActivity","EVENT_SUB_PROCESS_START_EVENT","isInterrupting","SEQUENCE_FLOW","PARTICIPANT","ReplaceMenuProvider","_popupMenu","_bpmnReplace","_translate","register","differentType","isInterruptingEqual","isCancelActivityEqual","isTargetSubProcess","isTargetExpanded","_createSequenceFlowEntries","_getLoopEntries","_getAdHocEntry","replaceOptions","menuEntries","_createMenuEntry","sourceRef","replaceAction","menuEntry","toggleLoopEntry","loopCharacteristics","isSequential","isLoop","isParallel","loopEntries","isAdHoc","adHocEntry","replaceMenuProvider","DEFAULT_CHILD_BOX_PADDING","substractTRBL","trblA","trblB","resizeBounds","resizeTRBL","applyConstraints","trbl","resizeConstraints","currentBounds","currentTrbl","getMinResizeBounds","minDimensions","childrenBounds","currentBox","minBox","childrenBox","combinedBox","asPadding","mayBePadding","addPadding","isBBoxChild","computeChildrenBBox","shapeOrChildren","getTRBLResize","LANE_PARENTS","LANE_INDENTATION","collectLanes","collectedShapes","s","getChildLanes","getLanesRoot","computeLanesResize","initialShapes","allLanes","shapeNewTrbl","trblResize","resizeNeeded","topResize","rightResize","bottomResize","leftResize","otherTrbl","ContextPadProvider","_contextPad","_connect","_autoPlace","click","isEventType","eventBo","isType","isDefinition","def","startConnect","removeElements","getReplaceMenuPosition","Y_OFFSET","diagramContainer","diagramRect","padRect","pos","appendAction","appendStart","dragstart","splitLaneHandler","splitLane","childLanes","addLane","isForCompensation","deleteAllowed","contextPadProvider","AXIS_DIMENSIONS","THRESHOLD","DistributeElements","_filters","registerFilter","avgDimension","elementsSize","numOfShapes","filterFn","groups","distributableElements","_setOrientation","_filterElements","_createGroups","distributeElements","_axis","_dimension","filters","rangeGroups","elementRange","_findRange","previous","_hasIntersection","rangeA","rangeB","BpmnDistributeElements","cannotDistribute","bpmnDistributeElements","NOT_REGISTERED_ERROR","IS_REGISTERED_ERROR","EditorActions","_actions","_registerDefaultActions","editorActions","zoomScroll","keyboardMove","keyboardMoveSelection","undo","redo","selectedElements","stepZoom","removableElements","moveCanvas","moveSelection","accelerated","_registerAction","isRegistered","unregister","getActions","BpmnEditorActions","spaceTool","lassoTool","handTool","globalConnect","searchPad","toggle","currentSelection","aligneableElements","setColor","boundingBox","moveElements","BpmnGridSnapping","gridSnappingContext","snapLocation","SPACING","quantize","quantum","LOWER_PRIORITY","GridSnapping","setActive","snapOffset","getSnapOffset","snapConstraints","getSnapConstraints","snapEvent","isHorizontal","minResizeConstraints","maxResizeConstraints","isWest","isNorth","ResizeBehavior","gridSnapping","_gridSnapping","preExecute","snapComplex","snapSimple","snappedValue","getGridSpacing","toggleActive","snapHorizontally","snapVertically","west","east","snappedNewBounds","north","south","SpaceToolBehavior","initialized","gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior","AutoPlaceBehavior","CreateParticipantBehavior","LayoutConnectionBehavior","hasMiddleSegments","snapMiddleSegments","horizontallyAligned","verticallyAligned","snapSegment","gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior","bpmnGridSnapping","LABEL_WIDTH","LABEL_HEIGHT","BpmnInteractionEvents","_interactionEvents","createParticipantHit","createDefaultHit","createSubProcessHit","removeHits","createBoxHit","bpmnInteractionEvents","BpmnKeyboardBindings","KeyboardBindings","registerBindings","keyboard","addListener","keyEvent","isCmd","hasModifier","keyboardBindings","DEFAULT_CONFIG","moveSpeed","moveSpeedAccelerated","LEFT","UP","RIGHT","DOWN","KEY_TO_DIRECTION","ArrowLeft","Left","ArrowUp","Up","ArrowRight","Right","ArrowDown","Down","DIRECTIONS_DELTA","speed","up","down","KeyboardMoveSelection","isShift","canMove","ChangeSupport","updateContainments","changeSupport","DEFAULT_MIN_WIDTH","Resize","_dragging","handleMove","handleStart","minBounds","computeMinResizeBox","handleEnd","getReferencePoint","referencePoint","getCursor","ctx","contextOrDirection","childrenBoxPadding","MARKER_RESIZING","MARKER_RESIZE_NOT_OK","ResizePreview","updateFrame","removeFrame","HANDLE_OFFSET","HANDLE_SIZE","HANDLE_HIT_SIZE","CLS_RESIZER","ResizeHandles","_resize","removeResizers","addResizer","getHandleOffset","makeDraggable","startResize","_createResizer","resizersParent","_getResizersParent","createResizer","resizer","resizePreview","resizeHandles","LabelEditingProvider","textRenderer","activateDirectEdit","isCollapsedSubProcess","_textRenderer","isExpandedSubProcess","isCollapsedPool","isExpandedPool","isEmptyText","getEditingBBox","getAbsoluteBBox","defaultStyle","getDefaultStyle","externalStyle","getExternalStyle","externalFontSize","externalLineHeight","lineHeight","defaultFontSize","defaultLineHeight","fontFamily","fontWeight","paddingTop","paddingBottom","paddingLeft","paddingRight","externalLabelMid","absoluteBBox","activeContextText","updateLabel","MARKER_HIDDEN","MARKER_LABEL_HIDDEN","LabelEditingPreview","pathMap","absoluteElementBBox","activeProvider","textPathData","getScaledPath","xScaleFactor","yScaleFactor","mx","my","d","strokeWidth","stroke","getStrokeColor","newElementHeight","defaultColor","labelEditingProvider","labelEditingPreview","ALIGNMENTS","ELEMENT_LABEL_DISTANCE","AdaptiveLabelPositioningBehavior","checkLabelAdjustment","optimalPosition","getOptimalPosition","adjustLabelPosition","elementMid","labelMid","newLabelMid","elementTrbl","moveShape","getTakenHostAlignments","freeAlignments","hostElement","hostOrientation","takenAlignments","getTakenConnectionAlignments","getApproximateOrientation","labelOrientation","isAligned","takenHostAlignments","AppendBehavior","bpmnRules","AssociationBehavior","postExecute","associations","association","moveConnection","AttachEventBehavior","shouldReplace","newHost","getEventDefinition","BoundaryEventBehavior","getBoundaryEvents","boundaryEvents","oldSource","newSource","attachedboundaryEvents","boundaryEvent","RootElementReferenceBehavior","bpmnjs","canHaveRootElementReference","hasAnyEventDefinition","hasRootElement","getDefinitions","getRootElementReferencePropertyName","setRootElement","executed","addedRootElement","reverted","referencedRootElement","CreateBehavior","HIGHEST_PRIORITY","FixHoverBehavior","CreateDataObjectBehavior","dataObject","dataObjectRef","HORIZONTAL_PARTICIPANT_PADDING","VERTICAL_PARTICIPANT_PADDING","PARTICIPANT_BORDER_WIDTH","ensureCollaboration","collaboration","makeCollaboration","process","childrenBBox","participantBounds","getParticipantBounds","getParticipantCreateConstraints","rootElementGfx","ensureHoveringProcess","oldProcessRef","processChildren","participant","hasParticipants","findParticipant","TARGET_REF_PLACEHOLDER_NAME","DataInputAssociationBehavior","usesTargetRef","targetRef","removedConnection","inputAssociations","getTargetRef","targetRefProp","cleanupTargetRef","fixTargetRef","connectionBo","targetBo","newTarget","newTargetBo","oldTarget","oldTargetBo","dataAssociation","ifDataInputAssociation","UpdateSemanticParentHandler","bpmnUpdater","_bpmnUpdater","DataStoreBehavior","getFirstParticipant","getDataStores","child","updateDataStoreParent","dataStore","newDataStoreParent","dataStoreBo","newDataStoreParentBo","newSemanticParent","newDiParent","registerHandler","dataStoreReferences","oldParent","getAncestor","isDescendant","oldRoot","newRoot","dataStores","descendant","ancestor","descendantBo","ancestorBo","oldSemanticParent","oldDiParent","updateSemanticParent","updateDiParent","DeleteLaneBehavior","compensateLaneDelete","topAdjustments","bottomAdjustments","siblings","topAffected","bottomAffected","calculateAdjustments","makeSpace","movingShapes","resizingShapes","nested","DetachEventBehavior","item","DropOnFlowBehavior","insertShape","targetFlow","positionOrBounds","waypointsBefore","waypointsAfter","dockingPoint","incomingConnection","outgoingConnection","oldOutgoing","oldIncoming","isPointInsideBBox","reconnectEnd","reconnectStart","duplicateConnections","shapeMid","newShapeMid","canInsert","EventBasedGatewayBehavior","preExecuted","existingIncomingConnections","sequenceFlow","removeConnection","newShapeTargets","newShapeTargetsIncomingSequenceFlows","sequenceFlows","incomingSequenceFlows","intermediateEvent","GroupBehavior","removeReferencedCategoryValue","removeCategory","getGroupElements","isReferenced","groupElements","lineIntersect","l1s","l1e","l2s","l2e","denominator","numerator","ImportDockingFix","adjustDocking","startPoint","nextPoint","centerIntersect","elementTop","elementLeft","verticalIntersect","horizontalIntersect","getDistance","fixDockings","p2","IsHorizontalFix","elementTypesToUpdate","vectorLength","v","getAngle","line","atan","rotateVector","vector","angle","cos","sin","solveLambaSystem","system","n","lambda","l","perpendicularFoot","bd","getDistancePointLine","pfPoint","connectionVector","getDistancePointPoint","point1","point2","sq","getAttachment","segmentStartDistance","segmentEndDistance","attachmentPosition","minDistance","attachment","attachmentDistance","closestAttachmentDistance","closestAttachment","pointsEqual","getCircleSegmentIntersections","segmentIndex","relativeLocation","s1","s2","cc","cr","baX","baY","caX","caY","bBy2","pBy2","q","disc","tmpSqrt","abScalingFactor1","abScalingFactor2","i1","i2","isPointInSegment","fenced","rangeStart","rangeEnd","EQUAL_THRESHOLD","findNewLabelLineStartIndex","oldSegmentStartIndex","newIndex","rel","relativePositionMidWaypoint","getLabelAdjustment","labelPosition","getLabelMid","oldLabelLineIndex","newLabelLineIndex","oldLabelLine","getLine","newLabelLine","oldFoot","relativeFootPosition","getRelativeFootPosition","angleDelta","getAngleDelta","oldBendpointIndex","oldBendpoint","newBendpoint","newFoot","newLabelVector","distanceSegment1","distanceSegment2","l1","l2","foot","lengthToFoot","getNewAttachPoint","oldCenter","newCenter","oldDelta","newDelta","getNewAttachShapeDelta","shapeCenter","shapeDelta","oldCenterDelta","newCenterDelta","newShapeCenter","DEFAULT_LABEL_DIMENSIONS","NAME_PROPERTY","TEXT_PROPERTY","LabelBehavior","getVisibleLabelAdjustment","startChanged","endChanged","getTextAnnotationBounds","labelCenter","labelDimensions","getExternalLabelBounds","unsetLabel","removeShape","labelBehavior","labelAdjustment","oldShape","edges","asEdges","getReferencePointDelta","newReferencePoint","lines","nearestLine","getNearestLine","distances","distance","sorted","COLLAB_ERR_MSG","PROCESS_ERR_MSG","ModelingFeedback","tooltips","showError","timeout","ReplaceConnectionBehavior","fixConnection","replacementType","canConnectSequenceFlow","canConnectMessageFlow","canConnectAssociation","replaceReconnectedConnection","replacement","cleanDraggingSelection","oldConnection","newConnection","allConnections","RemoveParticipantBehavior","collaborationRoot","participants","makeProcess","ReplaceElementBehaviour","_selection","topLevelElements","canReplace","replaceElements","replacements","unclaimId","newElements","newElementType","oldElementId","addToTrbl","choice","addMin","addMax","LANE_MIN_HEIGHT","LANE_MIN_WIDTH","LANE_RIGHT_PADDING","LANE_LEFT_PADDING","LANE_TOP_PADDING","LANE_BOTTOM_PADDING","getParticipantResizeConstraints","laneShape","resizeDirection","balanced","lanesRoot","isFirst","isLast","laneTrbl","maxTrbl","minTrbl","flowElementTrbl","PARTICIPANT_MIN_DIMENSIONS","SUB_PROCESS_MIN_DIMENSIONS","TEXT_ANNOTATION_MIN_DIMENSIONS","SLIGHTLY_HIGHER_PRIORITY","ResizeLaneBehavior","RemoveElementBehavior","inConnection","outConnection","getNewWaypoints","inWaypoints","outWaypoints","SubProcessStartEventBehavior","getStartEventPosition","ToggleElementCollapseBehaviour","hideEmptyLabels","expandedBounds","defaultSize","visibleElements","visibleBBox","filterVisible","collapsedBounds","UnclaimIdBehavior","shapeBo","unclaim","rootElementBo","UpdateFlowNodeRefsBehavior","initContext","UpdateContext","enter","getContext","releaseContext","triggerUpdate","leave","updateLaneRefs","flowNodes","lanes","laneRefUpdateEvents","updateContext","addFlowNode","counter","lane","flowNode","DeleteSequenceFlowBehavior","sourceBo","adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","modelingFeedback","replaceConnectionBehavior","removeParticipantBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","removeElementBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","getBoundaryAttachment","targetBounds","BpmnRules","canStartConnection","nonExistingOrLabel","isSame","getOrganizationalParent","isTextAnnotation","isGroup","isCompensationBoundary","isSameOrganization","parentA","parentB","isMessageFlowSource","hasEventDefinitionOrNone","isMessageFlowTarget","getScopeParent","isSameScope","scopeParentA","scopeParentB","isSequenceFlowSource","isSequenceFlowTarget","isEventBasedTarget","getParents","isParent","possibleParent","allParents","connectDataAssociation","canConnectDataAssociation","associationDirection","canDrop","isDroppableBoundaryEvent","hasNoEventDefinition","hasCommonBoundaryIntermediateEventDefinition","isBoundaryEvent","isLane","isBoundaryCandidate","hasOneOfEventDefinitions","isReceiveTaskAfterEventBasedGateway","isOneTextAnnotation","sourceTextAnnotation","targetTextAnnotation","areOutgoingEventBasedGatewayConnections","isOutgoingEventBasedGatewayConnection","connections","canAttach","OrderingProvider","ordering","getOrdering","parentIndex","newParentIndex","BpmnOrderingProvider","orders","order","level","containers","computeOrder","o","getOrder","findActualParent","actualParent","elementOrder","currentIndex","insertIndex","bpmnOrderingProvider","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","dirty","_uid","_pushAction","_internalExecute","_popAction","_getHandler","next","_getUndoAction","_internalUndo","_getRedoAction","_setHandler","handlerCls","canUndo","canRedo","_atomicDo","_markDirty","_revertedAction","qualifier","names","cancelBubble","_createId","execution","atomic","_executedAction","baseAction","stackIdx","createRoot","setPosition","setVisible","visible","display","tooltipClass","tooltipSelector","Tooltips","_ids","_tooltipDefaults","show","minZoom","maxZoom","_tooltips","_tooltipRoot","tooltip","_addTooltip","removeTimer","htmlContainer","hide","_updateRoot","matrix","tooltipRoot","jquery","_updateTooltip","_updateTooltipVisibilty","updateViewbox","saveClear","removeFn","LabelSupport","movePreview","validatedShapes","removeLabels","enclosedElements","enclosedLabels","labelTargetIndex","labelSupport","AttachSupport","addAttached","removeAttached","getAttachers","updateAttachment","attachSupport","ToolManager","_tools","registerTool","tools","bindEvents","tool","eventsToRegister","reactivate","toolManager","getDirection","getWaypointsUpdatingConnections","waypointsUpdatingConnections","AXIS_TO_DIMENSION","CURSOR_CROSSHAIR","DIRECTION_TO_TRBL","DIRECTION_TO_OPPOSITE","PADDING","SpaceTool","_toolManager","activateMakeSpace","activateSelection","spaceToolConstraints","getSpaceToolConstraints","resizingShape","minOrMax","nonMovingResizingChildrenBBox","movingChildrenBBox","resizingShapeBBox","nonMovingResizingChildren","movingChildren","resizingShapeMinDimensions","createSpace","shapeStart","shapeEnd","MARKER_DRAGGING","SpaceToolPreview","addPreviewGfx","space","crosshairGroup","pathX","pathY","spaceLayer","movingConnections","sourceIsMoving","targetIsMoving","sourceIsResizing","targetIsResizing","frameGroup","frames","initialBounds","getBBox","opposite","spaceToolPreview","BpmnFactory","_model","_needsId","_ensureId","createDiLabel","createDiBounds","createDiShape","bpmnElement","createDiWaypoints","createDiWaypoint","createDiEdge","createDiPlane","BpmnUpdater","cropped","updateParent","reverseUpdateParent","updateRoot","updateBounds","updateConnection","updateConnectionWaypoints","ifBpmn","oldSourceBo","newSourceBo","oldConditionExpression","oldDefault","parentShape","parentBusinessObject","parentDi","updateFlowNodeRefs","_getLabel","newContainment","oldContainment","oldRefs","newRefs","updateDiConnection","planeElements","getLaneSet","laneSet","laneSets","childLaneSet","visualParent","containment","ioSpecification","diChildren","inverseSet","applyAttributes","attributeNames","applyAttribute","attributeName","AppendShapeHandler","existsConnection","CreateConnectionHandler","layouter","createBpmnElement","newEventDefinition","isFrame","isMarkerVisible","createParticipantShape","connectionParent","addConnection","CreateElementsHandler","createShapeHints","CreateShapeHandler","CreateLabelHandler","addShape","originalExecute","ensureValidDimensions","originalRevert","DeleteConnectionHandler","DeleteElementsHandler","DeleteShapeHandler","oldParentIndex","OFF_AXIS","LayoutConnectionHandler","MoveConnectionHandler","getResizedSourceAnchor","safeGetWaypoints","oldAnchor","getResizedTargetAnchor","getMovedSourceAnchor","moveDelta","substractPosition","getMovedTargetAnchor","MoveClosure","allShapes","enclosedConnections","MoveHelper","MoveElementsHandler","_helper","MoveShapeHandler","ReconnectConnectionHandler","ReplaceShapeHandler","ResizeShapeHandler","SpaceToolHandler","getAxisFromDirection","ToggleShapeCollapseHandler","getElementsVisibilityRecursive","setHiddenRecursive","newHidden","restoreVisibilityRecursive","lastState","UpdateAttachmentHandler","removeAttacher","addAttacher","UpdateWaypointsHandler","Modeling","registerHandlers","updateRange","lastIdx","rangeDiff","centerElement","refCenter","spaceInBetween","firstGroup","lastGroupIdx","lastGroup","groupsSize","refElem","groupIdx","prevGroup","isTopLevel","newClosure","moveRecursive","moveClosure","getClosure","primaryShape","keepParent","recurse","layout","sourceMoved","targetMoved","getNewParent","dockingOrPoints","layoutConnectionHints","newData","canReconnect","moveShapes","resizeShapes","isFirstWaypoint","isLastWaypoint","oldChildrenVisibility","oldHost","attacherIdx","getHandlers","DEFAULT_FLOW","ID","DI","NULL_DIMENSIONS","UpdatePropertiesHandler","isIdChange","getProperties","getDiProperties","setProperties","setDiProperties","unwrapBusinessObjects","oldProperties","updateId","newLabelBounds","referencePropertyNames","unwrappedProps","UpdateCanvasRootHandler","AddLaneHandler","_spaceTool","SplitLaneHandler","ResizeLaneHandler","newRootBusinessObject","oldRootBusinessObject","bpmnDefinitions","diPlane","location","isRoot","laneParent","existingChildLanes","allAffected","lanePosition","spacePos","adjustments","newLane","newLanesCount","existingLanesCount","laneY","laneHeight","laneBounds","newLaneAttrs","newLanesHeight","resizeBalanced","resizeSpace","change","trblDiff","FLOW_NODE_REFS_ATTR","LANES_ATTR","UpdateFlowNodeRefsHandler","IdClaimHandler","computeUpdates","flowNodeShapes","laneShapes","handledNodes","updates","participantCache","allFlowNodeShapes","isInLaneShape","addFlowNodeShape","flowNodeShape","getAllLaneShapes","getNewLanes","allLaneShapes","oldLane","claiming","DEFAULT_COLORS","SetColorHandler","colors","UpdateLabelHandler","setText","oldLabel","_bpmnRules","BaseLayouter","handlers","targetLaneShape","targetLane","collaborationElement","processElement","claimId","moddleElement","MIN_SEGMENT_LENGTH","POINT_ORIENTATION_PADDING","ORIENTATION_THRESHOLD","needsTurn","startDirection","h","canLayoutStraight","targetOrientation","getSegmentBendpoints","segmentDirections","xmid","ymid","layoutStraight","layoutHorizontal","layoutTurn","turnNextDirections","getBendpoints","getStartSegment","getEndSegment","invertedSegment","invertDirections","getMidSegment","startSegment","endSegment","endDirection","getSimpleBendpoints","isValidDirections","isExplicitDirections","midSegment","connectPoints","withoutRedundantPoints","connectRectangles","preferredLayouts","preferredLayout","getDirections","directionSplit","startDocking","getDockingPoint","invertOrientation","endDocking","repairConnection","repairedWaypoints","preferStraight","tryLayoutStraight","tryRepairConnectionEnd","tryRepairConnectionStart","inRange","isInRange","primaryAxis","preserveDocking","moved","newDocking","_tryRepairConnectionSide","needsRelayout","repairBendpoint","candidate","oldPeer","newPeer","removeOverlapping","slicedPoints","oldDocking","newPoints","defaultLayout","rectangle","dockingDirection","ATTACH_ORIENTATION_PADDING","BOUNDARY_TO_HOST_THRESHOLD","oppositeOrientationMapping","orientationDirectionMapping","BpmnLayouter","getAttachOrientation","attachedElement","getMessageFlowManhattanOptions","getMessageFlowPreserveDocking","getConnectionDocking","isCompensationAssociation","isAnyOrientation","orientations","getHorizontalOrientation","matches","getVerticalOrientation","isOppositeOrientation","isOppositeHorizontalOrientation","horizontalOrientation","oppositeHorizontalOrientation","isOppositeVerticalOrientation","verticalOrientation","oppositeVerticalOrientation","isHorizontalOrientation","getLoopPreferredLayout","getBoundaryEventPreferredLayouts","sourceLayout","targetLayout","targetMid","attachOrientation","attachedToSide","getBoundaryEventLoopLayout","getBoundaryEventSourceLayout","getBoundaryEventTargetLayout","shouldConnectToSameSide","areCloseOnAxis","dockingToPoint","actual","CroppingConnectionDocking","manhattanOptions","updatedWaypoints","sourceDocking","targetDocking","dockStart","dockingIdx","croppedPoint","_getIntersection","takeFirst","shapePath","_getShapePath","_getConnectionPath","_getGfx","MEDIUM_PRIORITY","MoveEvents","removeNested","isAttach","MovePreview","getVisualDragShapes","getAllDraggedElements","removeEdges","allDraggedElements","dragShapes","visuallyDraggedShapes","differentParents","haveDifferentParents","TOGGLE_SELECTOR","ENTRY_SELECTOR","ELEMENT_SELECTOR","PALETTE_OPEN_CLS","PALETTE_TWO_COLUMN_CLS","Palette","updateToolHighlight","_update","_diagramInitialized","_rebuild","addPaletteEntries","getPaletteEntries","parentContainer","_getParentContainer","HTML_MARKUP","_layoutChanged","_toggleState","twoColumn","_needsCollapse","clientHeight","_entries","separator","availableHeight","entriesHeight","isActiveTool","_activeTool","toolsContainer","_toolsContainer","toolClasses","contains","LASSO_TOOL_CURSOR","LassoTool","visuals","SVGElement","activateLasso","toBBox","HAND_CURSOR","HandTool","activateMove","deactivateMove","isSpace","removeListener","activateHand","GlobalConnect","startTarget","canStartConnect","PaletteProvider","_palette","_lassoTool","_handTool","_globalConnect","createAction","createListener","shortType","createSubprocess","subProcess","startEvent","autoSelect","createParticipant","paletteProvider","BpmnReplacePreview","replaceVisual","visualReplacements","tempShape","restoreVisual","originalGfx","bpmnReplacePreview","TARGET_BOUNDS_PADDING","TASK_BOUNDS_PADDING","TARGET_CENTER_PADDING","AXES","BpmnConnectSnapping","initialConnectionStart","snapToShape","getTargetBoundsPadding","isAnyType","snapToPosition","snapToTargetMid","snapBoundaryEventLoop","dimensionForAxis","getDimensionForAxis","isMid","axes","newCoordinate","coordinate","SnapContext","_targets","_snapOrigins","_snapLocations","_defaultSnaps","SnapPoints","defaultSnaps","_snapValues","getSnapOrigin","setSnapOrigin","initialValue","addDefaultSnap","snapValues","getSnapLocations","setSnapLocations","snapLocations","pointsForTarget","targetId","initDefaults","snap","snappingValues","CreateMoveSnapping","snapping","initSnap","snapContext","addSnapTargetPoints","isHidden","shapeTopLeft","shapeBottomRight","snapTargets","getSnapTargets","snapTarget","BpmnCreateMoveSnapping","setSnappedIfConstrained","snapBoundaryEvent","targetTRBL","areAll","isContainer","getDockingSnapOrigin","isMove","ResizeSnapping","isVertical","snapOrigin","isAttached","SNAP_TOLERANCE","SNAP_LINE_HIDE_DELAY","Snapping","_asyncHide","snapCurrent","locationSnapping","originValue","showSnapLine","axisSnapping","_createLine","_createSnapLines","_snapLines","getSnapLine","snapLine","createMoveSnapping","resizeSnapping","connectSnapping","SearchPad","_open","_results","_eventMaps","BOX_HTML","_searchInput","INPUT_SELECTOR","_resultsContainer","RESULTS_CONTAINER_SELECTOR","constructOverlay","box","OVERLAY_CLASS","createInnerTextNode","tokens","createHtmlText","htmlText","matched","RESULT_HIGHLIGHT_CLASS","normal","_bindEvents","listen","selector","focus","RESULT_SELECTOR","_scrollToNode","_preselect","_select","selected","_getCurrentResult","_scrollToDirection","_search","_unbindEvents","_clearResults","searchResults","_searchProvider","_createResultNode","previousElementSibling","nextElementSibling","nodeOffset","containerScroll","scrollTop","bottomScroll","_resetOverlay","RESULT_SELECTED_SELECTOR","RESULT_HTML","primaryTokens","RESULT_PRIMARY_HTML","secondaryTokens","RESULT_SECONDARY_HTML","RESULT_ID_ATTRIBUTE","blur","selectedNode","RESULT_SELECTED_CLASS","_centerViewbox","newViewbox","overlay","CONTAINER_SELECTOR","BpmnSearchProvider","hasMatched","matchAndSplit","originalText","substr","bpmnSearch","initialDiagram","Modeler","Viewer","NavigatedViewer","createDiagram","importXML","_interactionModules","_modelingModules","_modules","querySearchAsync","handleSelect","nativeOn","$event","_k","scopedSlots","_u","_s","callback","$$v","component","uploadSectionFile","fileList","staticStyle","submitUpload","request","instance","axios","baseURL","linting","toggleLinting","ErrorSvg","WarningSvg","SuccessSvg","OFFSET_TOP","OFFSET_RIGHT","emptyConfig","stateToIcon","warning","inactive","Linting","_bpmnjs","_issues","_linterConfig","_overlayIds","_clearIssues","_updateButton","linterConfig","bpmnlint","getLinterConfig","setLinterConfig","_createButton","_formatIssues","issues","ruleReports","newActive","_setActive","lintStart","_lintStart","random","newIssues","id1","id2","_clearOverlays","_createIssues","_fireComplete","_createElementIssues","elementId","elementIssues","menuPosition","issuesByType","elementIssue","errors","warnings","warn","$html","$icon","$dropdown","$dropdownContent","$issues","$issueList","_addErrors","_addWarnings","$ul","_addEntry","icon","$entry","_setButtonState","_button","classList","issue","linter","lintingEditorActions","Resolver","bundle","xmlStr","$store","BpmnXml","isCollapse","bpmnModeler","isShowSearchWindow","isShowUploadWindow","components","fileLoader","Search","methods","showSearch","initBpmn","propertiesPanel","additionalModules","bpmnFile","saveXML","saveSVG","download","setAttribute","filename","bjslButton","$msgbox","showInput","inputType","confirmButtonText","beforeClose","confirmButtonLoading","_param","method","mounted","activated","hashClear","findExtension","findExtensions","CAMUNDA_SERVICE_TASK_LIKE","ChangeElementTemplateHandler","getOrCreateExtensionElements","updateModelerTemplate","updateIoMappings","oldMappings","newMappings","createInputOutputMappings","updateCamundaField","createCamundaFieldInjections","field","updateCamundaProperties","createCamundaProperties","createBpmnPropertyUpdates","newPropertiesCount","updateInOut","oldInOut","newInOut","createCamundaInOut","inout","updateExecutionListener","oldExecutionsListeners","newExecutionListeners","createCamundaExecutionListeners","executionListener","updateScopeElements","scopeDefinition","scopeElement","oldScope","propertyUpdates","propertyValue","bindingTarget","language","injections","inOuts","toFinite","toInteger","remainder","multiInstanceLoopCharacteristics","jobRetryTimeCycle","asyncContinuation","getLoopCharacteristics","ensureMultiInstanceSupported","labelPrefix","defaultParameters","canBeShown","isShown","$filter","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","proto","callbackfn","toObject","callWithSafeIterationClosing","isArrayIteratorMethod","toLength","createProperty","getIteratorMethod","arrayLike","step","iterator","O","C","argumentsLength","mapfn","mapping","iteratorMethod","getWrapDetails","insertWrapDetails","updateWrapDetails","setWrapToString","isAsyncBefore","isAsyncAfter","isExclusive","getFailedJobRetryTimeCycle","removeFailedJobRetryTimeCycle","retryTimeCycles","cycle","arrayAggregator","baseIteratee","initializer","arrayEach","isArr","isArrLike","baseTimes","eventDefinitionReference","elementReferenceProperty","elementName","referenceProperty","newElementIdPrefix","shouldValidate","UpdateBusinessObjectListHandler","previousList","listCopy","parentObject","ModelUtil","implementationTypeHelper","elems","getParameters","stackHas","showErrorCodeVariable","showErrorMessageVariable","modelPropertyValue","setValue","domAttr","updateSelection","TABLE_ROW_DIV_SNIPPET","DELETE_ROW_BUTTON_SNIPPET","createInputRowTemplate","canRemove","createInputTemplate","columns","createLabelRowTemplate","createLabelTemplate","pick","oldValues","valueEqual","oldValue","allKeys","getEntryNode","selectionStart","selectionEnd","labelRow","canAdd","canUpdate","setControlValue","boElements","__invalidValues","invalidValues","__action","valuesToValidate","createListEntryTemplate","scopeNode","deleteElement","rowToDelete","rowNode","showTable","validateListItem","isReadOnly","activeElement","baseFlatten","isStrict","findIndexFunc","iterable","containerElement","boResultVariable","scriptResultVariable","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","ListCache","maxInt","tMin","tMax","skew","damp","initialBias","initialN","regexNonASCII","regexSeparators","OVERFLOW_ERROR","baseMinusTMin","stringFromCharCode","fromCharCode","ucs2decode","extra","digitToBasic","digit","adapt","numPoints","firstTime","currentValue","inputLength","bias","basicLength","handledCPCount","handledCPCountPlusOne","RangeError","qMinusT","baseMinusT","encoded","divider","labelText","showLabel","MAX_ARRAY_LENGTH","__wrapped__","__actions__","__dir__","__filtered__","__iteratees__","__takeCount__","__views__","webpackPolyfill","deprecate","paths","toNumber","INFINITY","MAX_INTEGER","sign","baseIsMatch","baseMatches","matchData","isConditionalSource","conditionType","conditionLanguage","conditionOrConditionExpression","conditionProps","validationResult","isExpression","canClear","CONDITIONAL_SOURCES","requireObjectCoercible","createMethod","CONVERT_TO_STRING","$this","S","castPath","baseGet","originalArray","jobPriorityEntry","jobPriority","assocIndexOf","customElementsPropertiesActivator","elementTemplatesLoader","flowKey","keyed","outgoingReported","incomingReported","sourceId","arrayProto","lastIndex","composeArgs","countHolders","reorder","WRAP_BIND_KEY_FLAG","WRAP_CURRY_FLAG","WRAP_CURRY_RIGHT_FLAG","WRAP_ARY_FLAG","WRAP_FLIP_FLAG","partialsRight","holdersRight","argPos","ary","isAry","isBind","isBindKey","isFlip","holdersCount","newHolders","traverse","containedProperties","isAttr","isMany","isIndex","arrayLikeKeys","inherited","isArg","isBuff","skipIndexes","tasklist","createBaseFor","getLinkEventDefinition","linkEventDefinition","linkEvents","constant","ElementTemplatesLoader","loadTemplates","_loadTemplates","_elementTemplates","reload","templateErrors","setTemplates","validator","validTemplates","templatesChanged","baseIsTypedArray","nodeUtil","nodeIsTypedArray","selectEntryFactory","comboBox","customValue","customName","isCustomValue","isCustom","comboOptions","showCustomInput","modifiedValues","comboBoxEntry","arrayTag","funcTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","typedArrayTags","externalTaskPriority","objectCreate","baseToString","getSelectBox","currentTab","generateElementId","CREATE_EXTENSION_ELEMENT_ACTION","REMOVE_EXTENSION_ELEMENT_ACTION","idGeneration","hideElements","hideExtensionElements","canBeHidden","selectionChanged","createOption","initSelectionSize","optionsLength","extensionElementValue","generatedId","disableRemove","selectElement","hashHas","getListeners","CAMUNDA_EXECUTION_LISTENER_ELEMENT","CAMUNDA_TASK_LISTENER_ELEMENT","executionListenerEntry","taskListenerEntry","listeners","initialEvent","getDefaultTemplate","applyDefaultTemplate","commandContext","mapCacheClear","mapCacheDelete","mapCacheHas","MapCache","Stack","equalObjects","baseIsEqualDeep","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","Hash","calculateUpdate","newValue","currentCursor","newCursor","currentTail","lastIndexOf","createDiff","newStart","newEnd","l_str","l_char","s_str","s_char","l_idx","s_idx","l_start","s_start","l_end","s_end","baseGetAllKeys","keysFunc","symbolsFunc","stackClear","stackGet","stackSet","setCacheAdd","asyncCapableHelper","processProps","eventProps","linkProps","documentationProps","idProps","nameProps","executableProps","serviceTaskDelegateProps","userTaskProps","asynchronousContinuationProps","callActivityProps","multiInstanceProps","conditionalProps","scriptProps","errorProps","formProps","startEventInitiator","variableMapping","listenerProps","listenerDetails","listenerFields","elementTemplateChooserProps","elementTemplateCustomProps","inputOutputParameter","connectorDetails","connectorInputOutput","connectorInputOutputParameter","jobConfiguration","candidateStarter","externalTaskConfiguration","fieldInjections","isExternalTaskPriorityEnabled","externalBo","isExternalTask","isJobConfigEnabled","getInputOutputParameterLabel","getListenerLabel","PROCESS_KEY_HINT","TASK_KEY_HINT","createGeneralTabGroups","idOptions","processOptions","generalGroup","processIdDescription","customFieldsGroups","detailsGroup","multiInstanceGroup","asyncGroup","jobConfigurationGroup","enabled","externalTaskGroup","candidateStarterGroup","historyTimeToLiveGroup","tasklistGroup","documentationGroup","createVariablesTabGroups","variablesGroup","createFormsTabGroups","formGroup","createListenersTabGroups","listenersGroup","listenerDetailsGroup","listenerFieldsGroup","createInputOutputTabGroups","inputOutputGroup","inputOutputParameterGroup","createConnectorTabGroups","connectorDetailsGroup","connectorInputOutputGroup","connectorInputOutputParameterGroup","createFieldInjectionsTabGroups","fieldGroup","createExtensionElementsGroups","propertiesGroup","CamundaPropertiesProvider","getTabs","generalTab","variablesTab","formsTab","listenersTab","inputOutputTab","connectorTab","fieldInjectionsTab","extensionsTab","HANDLERS","CommandInitializer","escapeText","escaped","encodeURI","toPrimitive","definePropertyModule","createPropertyDescriptor","propertyKey","f","hasPath","getBody","getLoopCardinality","getLoopCardinalityValue","loopCardinality","getCompletionCondition","getCompletionConditionValue","completionCondition","getCollection","getElementVariable","updateFormalExpression","expressionProps","existingExpression","isValid","notification","elementVariable","createBind","canBeDisabled","res","isDisabled","copyObject","isNew","arg","baseFilter","collectionAdd","CategoryHelper","eachFunc","asyncTag","genTag","proxyTag","DEFAULT_DELEGATE_PROPS","DELEGATE_PROPS","DMN_CAPABLE_PROPS","EXTERNAL_CAPABLE_PROPS","DEFAULT_OPTIONS","DMN_OPTION","EXTERNAL_OPTION","CONNECTOR_OPTION","SCRIPT_OPTION","getType","hasScriptSupport","implType","connectors","participantHelper","idEntry","getProcessBusinessObject","processId","modifyProcessBusinessObject","processIdError","processNameEntry","noCustomizer","FormHelper","getFormData","formData","getFormFields","fields","getFormField","formFields","getConstraints","formField","validation","constraints","getEnumValues","baseMap","getBuiltIn","redefineAll","createIteratorConstructor","hasOwn","classof","anObject","getIterator","$fetch","Headers","URL_SEARCH_PARAMS","URL_SEARCH_PARAMS_ITERATOR","getInternalParamsState","getInternalIteratorState","plus","sequences","percentSequence","bytes","percentDecode","sequence","decodeURIComponent","deserialize","it","replacer","serialize","parseSearchParams","attribute","attributes","validateArgumentsLength","passed","required","URLSearchParamsIterator","params","kind","URLSearchParamsConstructor","entryIterator","entryNext","URLSearchParamsPrototype","found","entriesIndex","sliceIndex","boundFunction","fetch","headers","freeProcess","require","findInputParameter","findOutputParameter","findCamundaProperty","findCamundaInOut","CAMUNDA_EXECUTION_LISTENER_TYPE","BASIC_MODDLE_TYPES","EXTENSION_BINDING_TYPES","IO_BINDING_TYPES","IN_OUT_BINDING_TYPES","propertyGetter","getPropertyValue","objectWithKey","propertySetter","setPropertyValue","propertyValidator","validateValue","camundaProperties","camundaProperty","ioParameter","ioElement","bindingName","unknownPropertyBinding","existingCamundaProperty","newCamundaProperty","existingIoParameter","newIoParameter","existingInOut","moddlePropertyDescriptor","propertiesByName","moddleType","existingFieldInjections","newFieldInjections","notEmpty","minLength","matchesPattern","propertyWithScope","regexp","renderCustomField","propertyType","entryOptions","customFieldsGroup","idScopeName","customScopeFieldsGroup","propertyId","scopedProperty","createExtensionElements","createFailedJobRetryTimeCycle","retryTimeCycleEntry","retryTimeCycle","newCycle","allowPrototypes","arrayLimit","decoder","decode","parameterLimit","plainObjects","parseValues","cleanStr","ignoreQueryPrefix","limit","bracketEqualsPos","parseObject","chain","leaf","cleanRoot","parseArrays","parseKeys","givenKey","isRegExp","tempObj","newObj","merge","compact","getScriptType","parentElement","scriptLanguagePropName","scriptValuePropName","isFormatRequired","boScriptResource","boScript","boScriptFormat","scriptResourceValue","scriptType","scriptValue","clearScriptFormat","btnNode","canClearScriptFormat","clearScriptResource","canClearScriptResource","clearScript","canClearScript","isScriptResource","Reporter","messages","arrLength","othLength","arrValue","othValue","compared","othIndex","baseSetToString","getContainedActivities","getFlowElements","getContainedBoundaryEvents","isCompensationEventAttachedToActivity","activity","activityId","canActivityBeCompensated","getActivitiesForCompensation","getActivitiesForActivityRef","activitiesForActivityRef","createActivityRefOptions","activities","waitForCompletion","activityRef","argument","DELEGATE_TYPES","PROPERTIES","isDelegate","getDelegationLabel","delegateEntry","delegationLabel","nativeMin","oldArray","validationErrors","getAllKeys","isList","isMap","typeInfo","nameValue","parameterType","createParameterTypeElem","items","newEntry","PLACEHOLDER","WRAP_CURRY_BOUND_FLAG","WRAP_REARG_FLAG","mergeData","srcBitmask","newBitmask","isCombo","resultVariableEntry","thrower","ACCESSORS","argument0","argument1","FUNC_ERROR_TEXT","debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","flush","debounced","isInvoking","objProps","objLength","othProps","skipCtor","objCtor","othCtor","isCatchingErrorEvent","MAX_SAFE_INTEGER","percentTwenties","RFC1738","RFC3986","baseSetData","outgoingWithoutCondition","isSymbol","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","IndexedObject","arraySpeciesCreate","TYPE","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","specificCreate","versionTagEntry","processBo","propertiesEntry","reWrapDetails","reSplitDetails","hashGet","disallowNodeType","externalTaskPriorityEntry","taskPriority","defaultButtonAction","defaultButtonShow","buttonLabel","buttonAction","actionMethod","showName","buttonShow","showMethod","documentations","documentation","newObjectList","elementDocuEntry","processDocuEntry","isEventSubProcess","isConditionalStartEvent","reIsUint","CreateAndReferenceElementHandler","referencingObject","newObject","newObjectContainer","newObjectParent","referencedObject","previousReference","blankStartEvents","shortOut","clone","__chain__","__index__","__values__","getCamundaInOutMappings","getVariableMappings","camundaMappings","getInOutType","inOutType","CAMUNDA_IN_EXTENSION_ELEMENT","CAMUNDA_OUT_EXTENSION_ELEMENT","WHITESPACE_REGEX","inOutTypeOptions","inEntry","outEntry","variableMappings","mappingValue","mappingType","variablesMappings","sourceLabel","selectedMapping","exportName","VENDOR_PREFIXES","TEST_ELEMENT","TYPE_FUNCTION","setTimeoutContext","bindFn","invokeArrayArg","each","deprecationMessage","nextKey","extend","dest","src","inherit","childP","baseP","_super","boolOrFn","ifUndefined","val1","val2","addEventListeners","splitStr","removeEventListeners","hasParent","inStr","inArray","findByKey","uniqueArray","results","prefixed","camelProp","toUpperCase","_uniqueId","uniqueId","getWindowForElement","doc","ownerDocument","defaultView","parentWindow","MOBILE_REGEX","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","navigator","userAgent","INPUT_TYPE_TOUCH","INPUT_TYPE_PEN","INPUT_TYPE_MOUSE","INPUT_TYPE_KINECT","COMPUTE_INTERVAL","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","PROPS_XY","PROPS_CLIENT_XY","Input","manager","inputTarget","domHandler","ev","enable","createInputInstance","Type","PointerEventInput","TouchMouseInput","MouseInput","inputHandler","pointersLen","pointers","changedPointersLen","changedPointers","isFinal","computeInputData","recognize","prevInput","pointersLength","firstInput","simpleCloneInputData","firstMultiple","offsetCenter","getCenter","timeStamp","deltaTime","computeDeltaXY","offsetDirection","overallVelocity","getVelocity","overallVelocityX","overallVelocityY","getScale","rotation","getRotation","maxPointers","computeIntervalInputData","offsetDelta","prevDelta","velocity","velocityX","velocityY","lastInterval","atan2","PI","evEl","evTarget","evWin","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","pressed","pointerType","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","3","4","5","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","store","MSPointerEvent","PointerEvent","removePointer","eventTypeNormalized","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","started","normalizeSingleTouches","touches","changedTouches","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","targetIds","getTouches","allTouches","identifier","targetTouches","changedTargetTouches","touch","DEDUP_TIMEOUT","DEDUP_DISTANCE","primaryTouch","lastTouches","recordTouches","eventData","setLastTouch","lastTouch","lts","removeLastTouch","isSyntheticEvent","inputEvent","inputData","isMouse","sourceCapabilities","firesTouchEvents","PREFIXED_TOUCH_ACTION","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MAP","getTouchActionProps","TouchAction","cleanTouchActions","hasPanX","hasPanY","touchMap","cssSupports","CSS","supports","compute","touchAction","getTouchAction","preventDefaults","prevented","hasNone","isTapPointer","isTapMovement","isTapTouchTime","preventSrc","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","Recognizer","simultaneous","requireFail","stateStr","directionStr","getRecognizerByNameIfManager","otherRecognizer","AttrRecognizer","PanRecognizer","pX","pY","PinchRecognizer","PressRecognizer","_timer","_input","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","Hammer","preset","recognizeWith","dropRecognizeWith","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","inputDataClone","attrTest","optionPointers","isRecognized","directionTest","hasMoved","inOut","validPointers","validMovement","validTime","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","VERSION","domEvents","cssProps","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","STOP","FORCED_STOP","oldCssProps","toggleCssProps","triggerDomEvent","gestureEvent","gesture","existing","Swipe","Rotate","$indexOf","arrayMethodIsStrict","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","searchElement","isForking","leftIndex","leftLength","symbolToString","createPartial","pairs","domQueryAll","queryAll","domRemove","domDelegate","domMatches","scrollTabs","HIDE_CLASS","DEBOUNCE_DELAY","isToggle","isSelect","isContentEditable","getPropertyPlaceholders","placeholders","getFormControls","controls","getFormControlValuesInScope","controlNodes","controlNode","checked","getFormControlValues","listContainer","listNodes","listNode","valuesEqual","extractEntries","tabs","extractGroups","PropertiesPanel","_propertiesProvider","isImplicitRoot","tabBarNode","scroller","selectors","tabsContainer","tab","ignore","newActiveNode","oldActiveNode","linkNode","tabId","activateTab","detach","_bindListeners","attachTo","panelNode","panel","allTabNodes","allTabLinkNodes","tabNode","currentTabId","tabLinkNode","tabLink","needsCreate","newTabs","_entriesChanged","activeTabId","activeTabNode","_updateActivation","oldEntryIds","newEntryIds","handleChange","getEntry","onChangeAction","isEntryDirty","executeAction","applyChanges","updateState","handleInput","eventHandlerId","actionId","updateShow","updateDisable","showNodes","showNode","expr","shouldShow","currentNode","shouldDisable","commandToExecute","applyValidationErrors","valid","errorMessageNode","nextSibling","listEntryNodes","listValue","listEntryNode","setInputValue","contentEditable","setSelectValue","setToggleValue","nodeValue","setTextValue","getContentEditableSelection","focusNode","focusOffset","anchorOffset","setContentEditableSelection","domRange","domSelection","containerNode","_createPanel","_bindTemplate","inputNodes","isGroupVisible","groupNode","isTabVisible","toggleVisible","checkActiveTabVisibility","labelNode","tabVisible","groupVisible","listEntryContainer","existingElements","listItemNode","entriesToRemove","j","headerNode","tabLinksNode","tabContainerNode","tabIndex","querySelector","cssClass","hexTable","compactQueue","queue","compacted","arrayToObject","mergeTarget","acc","refs","MultiCommandHandler","hasStartEvent","EventDefinitionHelper","setCacheHas","reWrapComment","details","ParticipantHelper","DOMIterables","ArrayIteratorMethods","createNonEnumerableProperty","TO_STRING_TAG","ArrayValues","COLLECTION_NAME","Collection","CollectionPrototype","selectbox","inputName","UpdateBusinessObjectHandler","referenceType","extensionsElementHelper","isListener","decisionRef","hasFunc","canRemoveFailedJobRetryTimeCycle","asyncBeforeEntry","asyncBefore","asyncAfterEntry","asyncAfter","exclusiveEntry","exclusive","matcher","isInOut","parameters","memoized","Cache","basePropertyDeep","setData","WRAP_PARTIAL_RIGHT_FLAG","wrapFunc","isCurry","newHoldersRight","newPartials","newPartialsRight","escape","cssEscape","codeUnit","firstCodeUnit","textInputField","checkboxField","selectBoxField","comboBoxField","textBoxField","validationAwareTextInputField","tableField","labelEntry","setDefaultParameters","defaultGet","defaultSet","defaultValidate","EntryFactory","chainAll","baseProperty","formHelper","generateValueId","formFieldTextField","getSelectedFormField","selectedFormField","ensureFormKeyAndDataSupported","formKey","formFieldsEntry","formBusinessKeyFormFieldEntry","formDataExtension","storedValue","isStartEvent","existingFormField","enumValue","newConstraint","constraint","currentConstraint","isStartableInTasklistEntry","isStartableInTasklist","executableEntry","HOT_COUNT","HOT_SPAN","nativeNow","lastCalled","stamp","remaining","codeVariable","escalationCodeVariable","reIsDeepProp","reIsPlainProp","findElementById","selectedElement","optionTemplate","CAMUNDA_FIELD_EXTENSION_ELEMENT","getSelectedField","fieldEntry","getCamundaFields","getCamundaListenerFields","getFieldType","fieldType","expressionValue","stringValue","camundaFields","newFieldElem","selectedField","fieldName","fieldTypeOptions","fieldValue","__lastInvalidValue","CSSRuleList","CSSStyleDeclaration","CSSValueList","ClientRectList","DOMRectList","DOMStringList","DOMTokenList","DataTransferItemList","FileList","HTMLAllCollection","HTMLCollection","HTMLFormElement","HTMLSelectElement","MediaList","MimeTypeArray","NamedNodeMap","NodeList","PaintRequestList","Plugin","PluginArray","SVGLengthList","SVGNumberList","SVGPathSegList","SVGPointList","SVGStringList","SVGTransformList","SourceBufferList","StyleSheetList","TextTrackCueList","TextTrackList","TouchList","wrapFlags","pair","mitt","scrollSymbolLeft","scrollSymbolRight","ScrollTabs","$el","_createScrollButtons","__scrollTabs","getActiveTabNode","getTabsContainerNode","getAllTabNodes","getVisibleTabs","allTabs","getAdjacentTab","referenceTabNode","visibleTabs","_bindWheelEvent","_bindTabClickEvents","_bindScrollButtonEvents","scrollToTabNode","oldActiveTab","newActiveTab","oldActiveTabNode","newActiveTabNode","tabsContainerNode","tabWidth","offsetWidth","tabOffsetLeft","tabOffsetRight","containerScrollLeft","scrollLeft","overflowClass"],"mappings":"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","file":"js/chunk-a66e63ec.c5ff7c50.js","sourcesContent":["'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar find = require('min-dash').find;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../helper/CmdHelper'),\n    ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    scriptImplementation = require('./implementation/Script'),\n    timerImplementation = require('../../bpmn/parts/implementation/TimerEventDefinition');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  var LISTENER_TYPE_LABEL = {\n    class: translate('Java Class'),\n    expression: translate('Expression'),\n    delegateExpression: translate('Delegate Expression'),\n    script: translate('Script')\n  };\n\n  options = options || {};\n\n  var getSelectedListener = options.getSelectedListener;\n\n  var classProp = 'class',\n      expressionProp = 'expression',\n      delegateExpressionProp = 'delegateExpression',\n      scriptProp = 'script';\n\n  var executionListenerEventTypeOptions = ImplementationTypeHelper.isSequenceFlow(element) ? [\n    { name: translate('take'), value: 'take' }\n  ] : [\n    { name: translate('start'), value: 'start' },\n    { name: translate('end'), value: 'end' }\n  ];\n\n  var taskListenerEventTypeOptions = [\n    { name: translate('create'), value: 'create' },\n    { name: translate('assignment'), value: 'assignment' },\n    { name: translate('complete'), value: 'complete' },\n    { name: translate('delete'), value: 'delete' },\n    { name: translate('update'), value: 'update' },\n    { name: translate('timeout'), value: 'timeout' }\n  ];\n\n  var isSelected = function(element, node) {\n    return getSelectedListener(element, node);\n  };\n\n\n  // eventType ////////////////\n  group.entries.push(entryFactory.selectBox({\n    id: 'listener-event-type',\n    label: translate('Event Type'),\n    modelProperty: 'eventType',\n    emptyParameter: false,\n\n    get: function(element, node) {\n\n      var listener = getSelectedListener(element, node);\n\n      var eventType = listener && listener.get('event');\n\n      return {\n        eventType: eventType\n      };\n    },\n\n    set: function(element, values, node) {\n      var eventType = values.eventType,\n          listener = getSelectedListener(element, node),\n          eventDefinitions = listener && listener.eventDefinitions;\n\n      // ensure only timeout events can have timer event definitions\n      if (eventDefinitions && eventType !== 'timeout') {\n        eventDefinitions = [];\n      }\n\n      return cmdHelper.updateBusinessObject(element, listener,\n        {\n          event: eventType,\n          eventDefinitions: eventDefinitions\n        }\n      );\n    },\n\n    selectOptions: function(element, node) {\n      var eventTypeOptions;\n\n      var selectedListener = getSelectedListener(element, node);\n      if (ImplementationTypeHelper.isTaskListener(selectedListener)) {\n        eventTypeOptions = taskListenerEventTypeOptions;\n      } else if (ImplementationTypeHelper.isExecutionListener(selectedListener)) {\n        eventTypeOptions = executionListenerEventTypeOptions;\n      }\n\n      return eventTypeOptions;\n\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  // listenerId ///////////////\n  group.entries.push(entryFactory.textField({\n    id: 'listener-id',\n    label: translate('Listener Id'),\n    modelProperty: 'listenerId',\n\n    get: function(element, node) {\n      var value = {},\n          listener = getSelectedListener(element, node);\n\n      value.listenerId = (listener && listener.get('id')) || undefined;\n\n      return value;\n    },\n\n    set: function(element, values, node) {\n      var update = {},\n          listener = getSelectedListener(element, node);\n\n      update['id'] = values.listenerId || '';\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      var listener = getSelectedListener(element, node);\n\n      return !ImplementationTypeHelper.isTaskListener(listener);\n    },\n\n    validate: function(element, values, node) {\n      var value = values.listenerId,\n          listener = getSelectedListener(element, node),\n          validate = {};\n\n      if (!value && isTimeoutTaskListener(listener)) {\n        validate.listenerId = translate('Must provide a value for timeout task listener');\n      }\n\n      return validate;\n    }\n\n  }));\n\n\n  // listenerType ///////////////\n  group.entries.push(entryFactory.selectBox({\n    id: 'listener-type',\n    label: translate('Listener Type'),\n    selectOptions: [\n      { value: classProp, name: translate('Java Class') },\n      { value: expressionProp, name: translate('Expression') },\n      { value: delegateExpressionProp, name: translate('Delegate Expression') },\n      { value: scriptProp, name: translate('Script') }\n    ],\n    modelProperty: 'listenerType',\n    emptyParameter: false,\n\n    get: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return {\n        listenerType: ImplementationTypeHelper.getImplementationType(listener)\n      };\n    },\n\n    set: function(element, values, node) {\n      var listener = getSelectedListener(element, node),\n          listenerType = values.listenerType || undefined,\n          update = {};\n\n      update[classProp] = listenerType === classProp ? '' : undefined;\n      update[expressionProp] = listenerType === expressionProp ? '' : undefined;\n      update[delegateExpressionProp] = listenerType === delegateExpressionProp ? '' : undefined;\n      update[scriptProp] = listenerType === scriptProp ? bpmnFactory.create('camunda:Script') : undefined;\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  // listenerValue //////////////\n  group.entries.push(entryFactory.textField({\n    id: 'listener-value',\n    dataValueLabel: 'listenerValueLabel',\n    modelProperty: 'listenerValue',\n\n    get: function(element, node) {\n      var value = {},\n          listener = getSelectedListener(element, node),\n          listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      value.listenerValueLabel = LISTENER_TYPE_LABEL[listenerType] || '';\n      value.listenerValue = (listener && listener.get(listenerType)) || undefined;\n\n      return value;\n    },\n\n    set: function(element, values, node) {\n      var update = {},\n          listener = getSelectedListener(element, node),\n          listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      update[listenerType] = values.listenerValue || '';\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return !listener || listener.script;\n    },\n\n    validate: function(element, values) {\n      var value = values.listenerValue,\n          validate = {};\n\n      if (!value) {\n        validate.listenerValue = translate('Must provide a value');\n      }\n\n      return validate;\n    }\n\n  }));\n\n\n  // script ////////////////////\n  var script = scriptImplementation('scriptFormat', 'value', true, translate);\n\n  group.entries.push({\n    id: 'listener-script-value',\n    html: '<div data-show=\"isScript\">' +\n            script.template +\n          '</div>',\n\n    get: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script ? script.get(element, listener.script) : {};\n    },\n\n    set: function(element, values, node) {\n      var listener = getSelectedListener(element, node);\n      var update = script.set(element, values, listener);\n      return cmdHelper.updateBusinessObject(element, listener.script, update);\n    },\n\n    validate: function(element, values, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script ? script.validate(element, values) : {};\n    },\n\n    isScript: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script;\n    },\n\n    script: script\n\n  });\n\n\n  // timerEventDefinition //////\n  var timerEventDefinitionHandler = function(element, node) {\n    var listener = getSelectedListener(element, node);\n\n    if (!listener || !isTimeoutTaskListener(listener)) {\n      return;\n    }\n\n    var timerEventDefinition = getTimerEventDefinition(listener);\n\n    if (!timerEventDefinition) {\n      return false;\n    }\n\n    return timerEventDefinition;\n  };\n\n  function createTimerEventDefinition(element, node) {\n\n    var listener = getSelectedListener(element, node);\n\n    if (!listener || !isTimeoutTaskListener(listener)) {\n      return;\n    }\n\n    var eventDefinitions = listener.get('eventDefinitions') || [],\n        timerEventDefinition = bpmnFactory.create('bpmn:TimerEventDefinition');\n\n    eventDefinitions.push(timerEventDefinition);\n\n    listener.eventDefinitions = eventDefinitions;\n\n    return timerEventDefinition;\n  }\n\n  var timerOptions = {\n    idPrefix: 'listener-',\n    createTimerEventDefinition: createTimerEventDefinition\n  };\n\n  timerImplementation(group, element, bpmnFactory, timerEventDefinitionHandler, translate, timerOptions);\n\n};\n\n\n// helpers //////////////\n\nfunction isTimeoutTaskListener(listener) {\n  var eventType = listener && listener.event;\n  return eventType === 'timeout';\n}\n\nfunction getTimerEventDefinition(bo) {\n  var eventDefinitions = bo.eventDefinitions || [];\n\n  return find(eventDefinitions, function(event) {\n    return is(event, 'bpmn:TimerEventDefinition');\n  });\n\n}\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar callable = require('./implementation/Callable');\n\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar flattenDeep = require('lodash/flattenDeep');\nvar assign = require('lodash/assign');\n\nfunction getCallableType(element) {\n  var bo = getBusinessObject(element);\n\n  var boCalledElement = bo.get('calledElement'),\n      boCaseRef = bo.get('camunda:caseRef');\n\n  var callActivityType = '';\n  if (typeof boCalledElement !== 'undefined') {\n    callActivityType = 'bpmn';\n  } else\n\n  if (typeof boCaseRef !== 'undefined') {\n    callActivityType = 'cmmn';\n  }\n\n  return callActivityType;\n}\n\nvar DEFAULT_PROPS = {\n  calledElement: undefined,\n  'camunda:calledElementBinding': 'latest',\n  'camunda:calledElementVersion': undefined,\n  'camunda:calledElementTenantId': undefined,\n  'camunda:variableMappingClass' : undefined,\n  'camunda:variableMappingDelegateExpression' : undefined,\n  'camunda:caseRef': undefined,\n  'camunda:caseBinding': 'latest',\n  'camunda:caseVersion': undefined,\n  'camunda:caseTenantId': undefined\n};\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!is(element, 'camunda:CallActivity')) {\n    return;\n  }\n\n  group.entries.push(entryFactory.selectBox({\n    id : 'callActivity',\n    label: translate('CallActivity Type'),\n    selectOptions: [\n      { name: 'BPMN', value: 'bpmn' },\n      { name: 'CMMN', value: 'cmmn' }\n    ],\n    emptyParameter: true,\n    modelProperty: 'callActivityType',\n\n    get: function(element, node) {\n      return {\n        callActivityType: getCallableType(element)\n      };\n    },\n\n    set: function(element, values, node) {\n      var type = values.callActivityType;\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      if (type === 'bpmn') {\n        props.calledElement = '';\n      }\n      else if (type === 'cmmn') {\n        props['camunda:caseRef'] = '';\n      }\n\n      return cmdHelper.updateProperties(element, props);\n    }\n\n  }));\n\n  group.entries.push(callable(element, bpmnFactory, {\n    getCallableType: getCallableType\n  }, translate));\n\n  group.entries = flattenDeep(group.entries);\n};\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","module.exports = {\n  __depends__: [\n    require('./element-templates'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [ 'propertiesProvider' ],\n  propertiesProvider: [ 'type', require('./CamundaPropertiesProvider') ]\n};\n","'use strict';\n\nvar inputOutput = require('./implementation/InputOutput');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inputOutputEntry = inputOutput(element, bpmnFactory, {\n    idPrefix: 'connector-',\n    insideConnector: true\n  }, translate);\n\n  group.entries = group.entries.concat(inputOutputEntry.entries);\n\n  return {\n    getSelectedParameter: inputOutputEntry.getSelectedParameter\n  };\n\n};\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    InputOutputHelper = require('../../../helper/InputOutputHelper');\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nfunction getImplementationType(element) {\n  return ImplementationTypeHelper.getImplementationType(element);\n}\n\nfunction getBusinessObject(element) {\n  return ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n}\n\nfunction getConnector(bo) {\n  return InputOutputHelper.getConnector(bo);\n}\n\nfunction isConnector(element) {\n  return getImplementationType(element) === 'connector';\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  group.entries.push(entryFactory.textField({\n    id: 'connectorId',\n    label: translate('Connector Id'),\n    modelProperty: 'connectorId',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var connector = bo && getConnector(bo);\n      var value = connector && connector.get('connectorId');\n      return { connectorId: value };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var connector = getConnector(bo);\n      return cmdHelper.updateBusinessObject(element, connector, {\n        connectorId: values.connectorId || undefined\n      });\n    },\n\n    validate: function(element, values, node) {\n      return isConnector(element) && !values.connectorId ? { connectorId: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isConnector(element);\n    }\n\n  }));\n\n};\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&lang=css&\"","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar factory = require('../../../../factory/EntryFactory');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nvar assign = require('lodash/assign'),\n    forEach = require('lodash/forEach'),\n    find = require('lodash/find');\n\nfunction generatePropertyId() {\n  return utils.nextId('Property_');\n}\n\n/**\n * Get all camunda:property objects for a specific business object\n *\n * @param  {ModdleElement} parent\n *\n * @return {Array<ModdleElement>} a list of camunda:property objects\n */\nfunction getPropertyValues(parent) {\n  var properties = parent && getPropertiesElement(parent);\n  if (properties && properties.values) {\n    return properties.values;\n  }\n  return [];\n}\n\n/**\n * Get all camunda:Properties object for a specific business object\n *\n * @param  {ModdleElement} parent\n *\n * @return {ModdleElement} a camunda:Properties object\n */\nfunction getPropertiesElement(element) {\n  if (!isExtensionElements(element)) {\n    return element.properties;\n  } else {\n    return getPropertiesElementInsideExtensionElements(element);\n  }\n}\n\n/**\n * Get first camunda:Properties object for a specific bpmn:ExtensionElements\n * business object.\n *\n * @param {ModdleElement} extensionElements\n *\n * @return {ModdleElement} a camunda:Properties object\n */\nfunction getPropertiesElementInsideExtensionElements(extensionElements) {\n  return find(extensionElements.values, function(elem) {\n    return is(elem, 'camunda:Properties');\n  });\n}\n\n/**\n * Returns true, if the given business object is a bpmn:ExtensionElements.\n *\n * @param {ModdleElement} element\n *\n * @return {boolean} a boolean value\n */\nfunction isExtensionElements(element) {\n  return is(element, 'bpmn:ExtensionElements');\n}\n\n/**\n * Create a camunda:property entry using tableEntryFactory\n *\n * @param  {djs.model.Base} element\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {Array<string>} options.modelProperties\n * @param  {Array<string>} options.labels\n * @param  {function} options.getParent Gets the parent business object\n * @param  {function} options.show Indicate when the entry will be shown, should return boolean\n */\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getParent = options.getParent;\n\n  var modelProperties = options.modelProperties,\n      createParent = options.createParent;\n\n  var bo = getBusinessObject(element);\n  if (is(element, 'bpmn:Participant')) {\n    bo = bo.get('processRef');\n  }\n\n  // build properties group only when the participant have a processRef\n  if (!bo) {\n    return;\n  }\n\n  assign(options, {\n    addLabel: translate('Add Property'),\n    getElements: function(element, node) {\n      var parent = getParent(element, node, bo);\n      return getPropertyValues(parent);\n    },\n    addElement: function(element, node) {\n      var commands = [],\n          parent = getParent(element, node, bo);\n\n      if (!parent && typeof createParent === 'function') {\n        var result = createParent(element, bo);\n        parent = result.parent;\n        commands.push(result.cmd);\n      }\n\n      var properties = getPropertiesElement(parent);\n      if (!properties) {\n        properties = elementHelper.createElement('camunda:Properties', {}, parent, bpmnFactory);\n\n        if (!isExtensionElements(parent)) {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { 'properties': properties }));\n        } else {\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            parent,\n            'values',\n            'extensionElements',\n            [ properties ],\n            []\n          ));\n        }\n      }\n\n      var propertyProps = {};\n      forEach(modelProperties, function(prop) {\n        propertyProps[prop] = undefined;\n      });\n\n      // create id if necessary\n      if (modelProperties.indexOf('id') >= 0) {\n        propertyProps.id = generatePropertyId();\n      }\n\n      var property = elementHelper.createElement('camunda:Property', propertyProps, properties, bpmnFactory);\n      commands.push(cmdHelper.addElementsTolist(element, properties, 'values', [ property ]));\n\n      return commands;\n    },\n    updateElement: function(element, value, node, idx) {\n      var parent = getParent(element, node, bo),\n          property = getPropertyValues(parent)[idx];\n\n      forEach(modelProperties, function(prop) {\n        value[prop] = value[prop] || undefined;\n      });\n\n      return cmdHelper.updateBusinessObject(element, property, value);\n    },\n    validate: function(element, value, node, idx) {\n      // validate id if necessary\n      if (modelProperties.indexOf('id') >= 0) {\n\n        var parent = getParent(element, node, bo),\n            properties = getPropertyValues(parent),\n            property = properties[idx];\n\n        if (property) {\n          // check if id is valid\n          var validationError = utils.isIdValid(property, value.id, translate);\n\n          if (validationError) {\n            return { id: validationError };\n          }\n        }\n      }\n    },\n    removeElement: function(element, node, idx) {\n      var commands = [],\n          parent = getParent(element, node, bo),\n          properties = getPropertiesElement(parent),\n          propertyValues = getPropertyValues(parent),\n          currentProperty = propertyValues[idx];\n\n      commands.push(cmdHelper.removeElementsFromList(element, properties, 'values', null, [ currentProperty ]));\n\n      if (propertyValues.length === 1) {\n        // remove camunda:properties if the last existing property has been removed\n        if (!isExtensionElements(parent)) {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { properties: undefined }));\n        } else {\n          forEach(parent.values, function(value) {\n            if (is(value, 'camunda:Properties')) {\n              commands.push(extensionElementsHelper.removeEntry(bo, element, value));\n            }\n          });\n        }\n      }\n\n      return commands;\n    }\n  });\n\n  return factory.table(options);\n};\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = strictIndexOf;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createInputParameter(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:InputParameter', {\n    name: binding.name,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\nmodule.exports.createInputParameter = createInputParameter;\n\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createOutputParameter(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: binding.source\n    });\n  } else {\n    parameterValue = binding.source;\n  }\n\n  return bpmnFactory.create('camunda:OutputParameter', {\n    name: value,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\nmodule.exports.createOutputParameter = createOutputParameter;\n\n\n/**\n * Create camunda property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaProperty(binding, value, bpmnFactory) {\n  return bpmnFactory.create('camunda:Property', {\n    name: binding.name,\n    value: value || ''\n  });\n}\n\nmodule.exports.createCamundaProperty = createCamundaProperty;\n\n\n/**\n * Create camunda:in element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaIn(binding, value, bpmnFactory) {\n\n  var properties = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:In', properties);\n}\n\nmodule.exports.createCamundaIn = createCamundaIn;\n\n\n/**\n * Create camunda:in with businessKey element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaInWithBusinessKey(binding, value, bpmnFactory) {\n  return bpmnFactory.create('camunda:In', {\n    businessKey: value\n  });\n}\n\nmodule.exports.createCamundaInWithBusinessKey = createCamundaInWithBusinessKey;\n\n\n/**\n * Create camunda:out element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaOut(binding, value, bpmnFactory) {\n  var properties = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:Out', properties);\n}\n\nmodule.exports.createCamundaOut = createCamundaOut;\n\n\n/**\n * Create camunda:executionListener element containing an inline script from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaExecutionListenerScript(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:ExecutionListener', {\n    event: binding.event,\n    value: parameterValue,\n    script: parameterDefinition\n  });\n}\n\nmodule.exports.createCamundaExecutionListenerScript = createCamundaExecutionListenerScript;\n\n/**\n * Create camunda:field element containing string or expression from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaFieldInjection(binding, value, bpmnFactory) {\n  var DEFAULT_PROPS = {\n    'string': undefined,\n    'expression': undefined,\n    'name': undefined\n  };\n\n  var props = assign({}, DEFAULT_PROPS);\n\n  if (!binding.expression) {\n    props.string = value;\n  } else {\n    props.expression = value;\n  }\n  props.name = binding.name;\n\n  return bpmnFactory.create('camunda:Field', props);\n}\nmodule.exports.createCamundaFieldInjection = createCamundaFieldInjection;\n\n\n// helpers ////////////////////////////\n\n/**\n * Create properties for camunda:in and camunda:out types.\n */\nfunction createCamundaInOutAttrs(binding, value) {\n\n  var properties = {};\n\n  // camunda:in source(Expression) target\n  if (binding.target) {\n\n    properties.target = binding.target;\n\n    if (binding.expression) {\n      properties.sourceExpression = value;\n    } else {\n      properties.source = value;\n    }\n  } else\n\n  // camunda:(in|out) variables local\n  if (binding.variables) {\n    properties.variables = 'all';\n\n    if (binding.variables === 'local') {\n      properties.local = true;\n    }\n  }\n\n  // camunda:out source(Expression) target\n  else {\n    properties.target = value;\n\n    [ 'source', 'sourceExpression' ].forEach(function(k) {\n      if (binding[k]) {\n        properties[k] = binding[k];\n      }\n    });\n  }\n\n  return properties;\n}\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar IS_PURE = require('../internals/is-pure');\n\nvar ITERATOR = wellKnownSymbol('iterator');\n\nmodule.exports = !fails(function () {\n  var url = new URL('b?a=1&b=2&c=3', 'http://a');\n  var searchParams = url.searchParams;\n  var result = '';\n  url.pathname = 'c%20d';\n  searchParams.forEach(function (value, key) {\n    searchParams['delete']('b');\n    result += key + value;\n  });\n  return (IS_PURE && !url.toJSON)\n    || !searchParams.sort\n    || url.href !== 'http://a/c%20d?a=1&c=3'\n    || searchParams.get('c') !== '3'\n    || String(new URLSearchParams('?a=1')) !== 'a=1'\n    || !searchParams[ITERATOR]\n    // throws in Edge\n    || new URL('https://a@b').username !== 'a'\n    || new URLSearchParams(new URLSearchParams('a=b')).get('a') !== 'b'\n    // not punycoded in Edge\n    || new URL('http://тест').host !== 'xn--e1aybc'\n    // not escaped in Chrome 62-\n    || new URL('http://a#б').hash !== '#%D0%B1'\n    // fails in Chrome 66-\n    || result !== 'a1c3'\n    // throws in Safari\n    || new URL('http://x', undefined).host !== 'x';\n});\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper');\n\nvar forEach = require('lodash/forEach');\n\nvar message = require('./implementation/MessageEventDefinition'),\n    signal = require('./implementation/SignalEventDefinition'),\n    error = require('./implementation/ErrorEventDefinition'),\n    escalation = require('./implementation/EscalationEventDefinition'),\n    timer = require('./implementation/TimerEventDefinition'),\n    compensation = require('./implementation/CompensateEventDefinition'),\n    condition = require('./implementation/ConditionalEventDefinition');\n\n\nmodule.exports = function(group, element, bpmnFactory, elementRegistry, translate) {\n  var events = [\n    'bpmn:StartEvent',\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  // Message and Signal Event Definition\n  forEach(events, function(event) {\n    if (is(element, event)) {\n\n      var messageEventDefinition = eventDefinitionHelper.getMessageEventDefinition(element),\n          signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(element);\n\n      if (messageEventDefinition) {\n        message(group, element, bpmnFactory, messageEventDefinition, translate);\n      }\n\n      if (signalEventDefinition) {\n        signal(group, element, bpmnFactory, signalEventDefinition, translate);\n      }\n\n    }\n  });\n\n  // Special Case: Receive Task\n  if (is(element, 'bpmn:ReceiveTask')) {\n    message(group, element, bpmnFactory, getBusinessObject(element), translate);\n  }\n\n  // Error Event Definition\n  var errorEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(errorEvents, function(event) {\n    if (is(element, event)) {\n\n      var errorEventDefinition = eventDefinitionHelper.getErrorEventDefinition(element);\n\n      if (errorEventDefinition) {\n\n        error(group, element, bpmnFactory, errorEventDefinition, translate);\n      }\n    }\n  });\n\n  // Escalation Event Definition\n  var escalationEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(escalationEvents, function(event) {\n    if (is(element, event)) {\n\n      var showEscalationCodeVariable = is(element, 'bpmn:StartEvent') || is(element, 'bpmn:BoundaryEvent');\n\n      // get business object\n      var escalationEventDefinition = eventDefinitionHelper.getEscalationEventDefinition(element);\n\n      if (escalationEventDefinition) {\n        escalation(group, element, bpmnFactory, escalationEventDefinition, showEscalationCodeVariable,\n          translate);\n      }\n    }\n\n  });\n\n  // Timer Event Definition\n  var timerEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  forEach(timerEvents, function(event) {\n    if (is(element, event)) {\n\n      // get business object\n      var timerEventDefinition = eventDefinitionHelper.getTimerEventDefinition(element);\n\n      if (timerEventDefinition) {\n        timer(group, element, bpmnFactory, timerEventDefinition, translate);\n      }\n    }\n  });\n\n  // Compensate Event Definition\n  var compensationEvents = [\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent'\n  ];\n\n  forEach(compensationEvents, function(event) {\n    if (is(element, event)) {\n\n      // get business object\n      var compensateEventDefinition = eventDefinitionHelper.getCompensateEventDefinition(element);\n\n      if (compensateEventDefinition) {\n        compensation(group, element, bpmnFactory, compensateEventDefinition, elementRegistry, translate);\n      }\n    }\n  });\n\n\n  // Conditional Event Definition\n  var conditionalEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  if (isAny(element, conditionalEvents)) {\n\n    // get business object\n    var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n    if (conditionalEventDefinition) {\n      condition(group, element, bpmnFactory, conditionalEventDefinition, elementRegistry, translate);\n    }\n  }\n\n};\n","var realNames = require('./_realNames');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the name of `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {string} Returns the function name.\n */\nfunction getFuncName(func) {\n  var result = (func.name + ''),\n      array = realNames[result],\n      length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n  while (length--) {\n    var data = array[length],\n        otherFunc = data.func;\n    if (otherFunc == null || otherFunc == func) {\n      return data.name;\n    }\n  }\n  return result;\n}\n\nmodule.exports = getFuncName;\n","'use strict';\n\nvar ElementHelper = {};\nmodule.exports = ElementHelper;\n\n/**\n * Creates a new element and set the parent to it\n *\n * @method ElementHelper#createElement\n *\n * @param {String} elementType of the new element\n * @param {Object} properties of the new element in key-value pairs\n * @param {moddle.object} parent of the new element\n * @param {BpmnFactory} factory which creates the new element\n *\n * @returns {djs.model.Base} element which is created\n */\nElementHelper.createElement = function(elementType, properties, parent, factory) {\n  var element = factory.create(elementType, properties);\n  element.$parent = parent;\n\n  return element;\n};\n","/**\n * A rule that checks that sequence flows outgoing from a\n * conditional forking gateway or activity are\n * either default flows _or_ have a condition attached\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isConditionalForking(node)) {\n      return;\n    }\n\n    const outgoing = node.outgoing || [];\n\n    outgoing.forEach((flow) => {\n      const missingCondition = (\n        !hasCondition(flow) &&\n        !isDefaultFlow(node, flow)\n      );\n\n      if (missingCondition) {\n        reporter.report(flow.id, 'Sequence flow is missing condition');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////////////////\n\nfunction isConditionalForking(node) {\n\n  const defaultFlow = node['default'];\n  const outgoing = node.outgoing || [];\n\n  return defaultFlow || outgoing.find(hasCondition);\n}\n\nfunction hasCondition(flow) {\n  return !!flow.conditionExpression;\n}\n\nfunction isDefaultFlow(node, flow) {\n  return node['default'] === flow;\n}","var baseCreate = require('./_baseCreate'),\n    isObject = require('./isObject');\n\n/**\n * Creates a function that produces an instance of `Ctor` regardless of\n * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n *\n * @private\n * @param {Function} Ctor The constructor to wrap.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCtor(Ctor) {\n  return function() {\n    // Use a `switch` statement to work with class constructors. See\n    // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n    // for more details.\n    var args = arguments;\n    switch (args.length) {\n      case 0: return new Ctor;\n      case 1: return new Ctor(args[0]);\n      case 2: return new Ctor(args[0], args[1]);\n      case 3: return new Ctor(args[0], args[1], args[2]);\n      case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n      case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n      case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n      case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n    }\n    var thisBinding = baseCreate(Ctor.prototype),\n        result = Ctor.apply(thisBinding, args);\n\n    // Mimic the constructor's `return` behavior.\n    // See https://es5.github.io/#x13.2.2 for more details.\n    return isObject(result) ? result : thisBinding;\n  };\n}\n\nmodule.exports = createCtor;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar historyTimeToLive = require('./implementation/HistoryTimeToLive');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:Process') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(historyTimeToLive(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n\n  }\n};\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","var baseKeys = require('./_baseKeys'),\n    getTag = require('./_getTag'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLike = require('./isArrayLike'),\n    isBuffer = require('./isBuffer'),\n    isPrototype = require('./_isPrototype'),\n    isTypedArray = require('./isTypedArray');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = isEmpty;\n","import {\n  some\n} from 'min-dash';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * Return true if element has any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nexport function isAny(element, types) {\n  return some(types, function(t) {\n    return is(element, t);\n  });\n}\n\n\n/**\n * Return the parent of the element with any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {String|Array<String>} anyType\n *\n * @return {djs.model.Base}\n */\nexport function getParent(element, anyType) {\n\n  if (typeof anyType === 'string') {\n    anyType = [ anyType ];\n  }\n\n  while ((element = element.parent)) {\n    if (isAny(element, anyType)) {\n      return element;\n    }\n  }\n\n  return null;\n}","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var candidateStarterGroupsEntry = entryFactory.textField({\n    id: 'candidateStarterGroups',\n    label: translate('Candidate Starter Groups'),\n    modelProperty: 'candidateStarterGroups',\n    description: translate('Specify more than one group as a comma separated list.'),\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var candidateStarterGroups = bo.get('camunda:candidateStarterGroups');\n\n      return {\n        candidateStarterGroups: candidateStarterGroups ? candidateStarterGroups : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:candidateStarterGroups': values.candidateStarterGroups || undefined\n      });\n    }\n\n  });\n\n  var candidateStarterUsersEntry = entryFactory.textField({\n    id: 'candidateStarterUsers',\n    label: translate('Candidate Starter Users'),\n    modelProperty: 'candidateStarterUsers',\n    description: translate('Specify more than one user as a comma separated list.'),\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var candidateStarterUsers = bo.get('camunda:candidateStarterUsers');\n\n      return {\n        candidateStarterUsers: candidateStarterUsers ? candidateStarterUsers : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:candidateStarterUsers': values.candidateStarterUsers || undefined\n      });\n    }\n\n  });\n\n  return [\n    candidateStarterGroupsEntry,\n    candidateStarterUsersEntry\n  ];\n};\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\nvar bind = require('lodash/bind');\n\n/**\n * An entry that renders a clickable link.\n *\n * A passed {@link options#handleClick} handler is responsible\n * to process the click.\n *\n * The link may be conditionally shown or hidden. This can be\n * controlled via the {@link options.showLink}.\n *\n * @param {Object} options\n * @param {String} options.id\n * @param {String} [options.label]\n * @param {Function} options.handleClick\n * @param {Function} [options.showLink] returning false to hide link\n * @param {String} [options.description]\n *\n * @example\n *\n * var linkEntry = link({\n *   id: 'foo',\n *   description: 'Some Description',\n *   handleClick: function(element, node, event) { ... },\n *   showLink: function(element, node) { ... }\n * });\n *\n * @return {Entry} the newly created entry\n */\nfunction link(options) {\n\n  var id = options.id,\n      label = options.label || id,\n      showLink = options.showLink,\n      handleClick = options.handleClick,\n      description = options.description;\n\n  if (showLink && typeof showLink !== 'function') {\n    throw new Error('options.showLink must be a function');\n  }\n\n  if (typeof handleClick !== 'function') {\n    throw new Error('options.handleClick must be a function');\n  }\n\n  var resource = {\n    id: id\n  };\n\n  resource.html =\n    '<a data-action=\"handleClick\" ' +\n    (showLink ? 'data-show=\"showLink\" ' : '') +\n    'class=\"bpp-entry-link' + (options.cssClasses ? ' ' + escapeHTML(options.cssClasses) : '') +\n    '\">' + escapeHTML(label) + '</a>';\n\n  // add description below link entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.handleClick = bind(handleClick, resource);\n\n  if (typeof showLink === 'function') {\n    resource.showLink = function() {\n      return showLink.apply(resource, arguments);\n    };\n  }\n\n  return resource;\n}\n\nmodule.exports = link;\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper');\n\n\nvar resultVariable = require('./ResultVariable');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar forEach = require('lodash/forEach');\n\nvar attributeInfo = {\n  bpmn: {\n    element: 'calledElement',\n    binding: 'camunda:calledElementBinding',\n    version: 'camunda:calledElementVersion',\n    versionTag: 'camunda:calledElementVersionTag',\n    tenantId: 'camunda:calledElementTenantId'\n  },\n\n  cmmn: {\n    element: 'camunda:caseRef',\n    binding: 'camunda:caseBinding',\n    version: 'camunda:caseVersion',\n    tenantId: 'camunda:caseTenantId'\n  },\n\n  dmn: {\n    element: 'camunda:decisionRef',\n    binding: 'camunda:decisionRefBinding',\n    version: 'camunda:decisionRefVersion',\n    versionTag: 'camunda:decisionRefVersionTag',\n    tenantId: 'camunda:decisionRefTenantId'\n  }\n};\n\nvar mapDecisionResultOptions = [\n  {\n    name: 'singleEntry (TypedValue)',\n    value: 'singleEntry'\n  },\n  {\n    name:'singleResult (Map<String, Object>)',\n    value:'singleResult'\n  },\n  {\n    name:'collectEntries (List<Object>)',\n    value:'collectEntries'\n  },\n  {\n    name:'resultList (List<Map<String, Object>>)',\n    value:'resultList'\n  }\n];\n\nvar delegateVariableMappingOptions = [\n  {\n    name: 'variableMappingClass',\n    value: 'variableMappingClass'\n  },\n  {\n    name: 'variableMappingDelegateExpression',\n    value: 'variableMappingDelegateExpression'\n  }\n];\n\nfunction getCamundaInWithBusinessKey(element) {\n  var camundaIn = [],\n      bo = getBusinessObject(element);\n\n  var camundaInParams = extensionElementsHelper.getExtensionElements(bo, 'camunda:In');\n  if (camundaInParams) {\n    forEach(camundaInParams, function(param) {\n      if (param.businessKey !== undefined) {\n        camundaIn.push(param);\n      }\n    });\n  }\n  return camundaIn;\n}\n\nfunction setBusinessKey(element, text, bpmnFactory) {\n  var commands = [];\n\n  var camundaInWithBusinessKey = getCamundaInWithBusinessKey(element);\n\n  if (camundaInWithBusinessKey.length) {\n    commands.push(cmdHelper.updateBusinessObject(element, camundaInWithBusinessKey[0], {\n      businessKey: text\n    }));\n  } else {\n    var bo = getBusinessObject(element),\n        extensionElements = bo.extensionElements;\n\n    if (!extensionElements) {\n      extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n      commands.push(cmdHelper.updateProperties(element, { extensionElements: extensionElements }));\n    }\n\n    var camundaIn = elementHelper.createElement(\n      'camunda:In',\n      { 'businessKey': text },\n      extensionElements,\n      bpmnFactory\n    );\n\n    commands.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      'extensionElements',\n      [ camundaIn ],[]\n    ));\n  }\n\n  return commands;\n}\n\nfunction deleteBusinessKey(element) {\n  var camundaInExtensions = getCamundaInWithBusinessKey(element);\n  var commands = [];\n  forEach(camundaInExtensions, function(elem) {\n    commands.push(extensionElementsHelper.removeEntry(getBusinessObject(element), element, elem));\n  });\n  return commands;\n}\n\nfunction isSupportedCallableType(type) {\n  return [ 'bpmn', 'cmmn', 'dmn' ].indexOf(type) !== -1;\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var bindingOptions = [\n    {\n      name: translate('latest'),\n      value: 'latest'\n    },\n    {\n      name: translate('deployment'),\n      value: 'deployment'\n    },\n    {\n      name: translate('version'),\n      value: 'version'\n    },\n    {\n      name: translate('versionTag'),\n      value: 'versionTag'\n    }\n  ];\n\n  var getCallableType = options.getCallableType;\n\n  var entries = [];\n\n  function getAttribute(element, prop) {\n    var type = getCallableType(element);\n    return (attributeInfo[type] || {})[prop];\n  }\n\n  function getCallActivityBindingValue(element) {\n    var type = getCallableType(element);\n    var bo = getBusinessObject(element);\n    var attr = (attributeInfo[type] || {}).binding;\n    return bo.get(attr);\n  }\n\n  function getDelegateVariableMappingType(element) {\n    var bo = getBusinessObject(element);\n\n    var boVariableMappingClass = bo.get('camunda:variableMappingClass'),\n        boVariableMappingDelegateExpression = bo.get('camunda:variableMappingDelegateExpression');\n\n    var delegateVariableMappingType = '';\n    if (typeof boVariableMappingClass !== 'undefined') {\n      delegateVariableMappingType = 'variableMappingClass';\n    } else\n\n    if (typeof boVariableMappingDelegateExpression !== 'undefined') {\n      delegateVariableMappingType = 'variableMappingDelegateExpression';\n    }\n\n    return delegateVariableMappingType;\n  }\n\n\n  entries.push(entryFactory.textField({\n    id: 'callable-element-ref',\n    dataValueLabel: 'callableElementLabel',\n    modelProperty: 'callableElementRef',\n\n    get: function(element, node) {\n      var callableElementRef;\n\n      var attr = getAttribute(element, 'element');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableElementRef = bo.get(attr);\n      }\n\n      var label = '';\n      var type = getCallableType(element);\n      if (type === 'bpmn') {\n        label = translate('Called Element');\n      }\n      else if (type === 'cmmn') {\n        label = translate('Case Ref');\n      }\n      else if (type === 'dmn') {\n        label = translate('Decision Ref');\n      }\n\n      return {\n        callableElementRef: callableElementRef,\n        callableElementLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCallableElementRef = values.callableElementRef;\n      var attr = getAttribute(element, 'element');\n\n      var props = {};\n      props[attr] = newCallableElementRef || '';\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var elementRef = values.callableElementRef;\n      var type = getCallableType(element);\n      return isSupportedCallableType(type) && !elementRef ? { callableElementRef: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isSupportedCallableType(getCallableType(element));\n    }\n\n  }));\n\n  entries.push(entryFactory.selectBox({\n    id: 'callable-binding',\n    label: translate('Binding'),\n    selectOptions: function(element) {\n      var type = getCallableType(element);\n      var options;\n\n      if (type === 'cmmn') {\n        options = bindingOptions.filter(function(bindingOption) {\n          return bindingOption.value !== 'versionTag';\n        });\n      } else {\n        options = bindingOptions;\n      }\n      return options;\n    },\n    modelProperty: 'callableBinding',\n\n    get: function(element, node) {\n      var callableBinding;\n\n      var attr = getAttribute(element, 'binding');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableBinding = bo.get(attr) || 'latest';\n      }\n\n      return {\n        callableBinding: callableBinding\n      };\n    },\n\n    set: function(element, values, node) {\n      var binding = values.callableBinding;\n      var attr = getAttribute(element, 'binding'),\n          attrVer = getAttribute(element, 'version'),\n          attrVerTag = getAttribute(element, 'versionTag');\n\n      var props = {};\n      props[attr] = binding;\n\n      // set version and versionTag values always to undefined to delete the existing value\n      props[attrVer] = undefined;\n      props[attrVerTag] = undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      return !isSupportedCallableType(getCallableType(element));\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'callable-version',\n    label: translate('Version'),\n    modelProperty: 'callableVersion',\n\n    get: function(element, node) {\n      var callableVersion;\n\n      var attr = getAttribute(element, 'version');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableVersion = bo.get(attr);\n      }\n\n      return {\n        callableVersion: callableVersion\n      };\n    },\n\n    set: function(element, values, node) {\n      var version = values.callableVersion;\n      var attr = getAttribute(element, 'version');\n\n      var props = {};\n      props[attr] = version || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var version = values.callableVersion;\n\n      var type = getCallableType(element);\n      return (\n        isSupportedCallableType(type) &&\n        getCallActivityBindingValue(element) === 'version' && (\n          !version ? { callableVersion: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n      return !isSupportedCallableType(type) || getCallActivityBindingValue(element) !== 'version';\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'callable-version-tag',\n    label: translate('Version Tag'),\n    modelProperty: 'versionTag',\n\n    get: function(element, node) {\n      var versionTag;\n\n      var attr = getAttribute(element, 'versionTag');\n\n      if (attr) {\n        var bo = getBusinessObject(element);\n\n        versionTag = bo.get(attr);\n      }\n\n      return {\n        versionTag: versionTag\n      };\n    },\n\n    set: function(element, values, node) {\n      var versionTag = values.versionTag;\n\n      var attr = getAttribute(element, 'versionTag');\n\n      var props = {};\n\n      props[attr] = versionTag || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var versionTag = values.versionTag;\n\n      var type = getCallableType(element);\n\n      return (\n        isSupportedCallableType(type) &&\n        getCallActivityBindingValue(element) === 'versionTag' && (\n          !versionTag ? { versionTag: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n\n      return !isSupportedCallableType(type) || getCallActivityBindingValue(element) !== 'versionTag';\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'tenant-id',\n    label: translate('Tenant Id'),\n    modelProperty: 'tenantId',\n\n    get: function(element, node) {\n      var tenantId;\n\n      var attr = getAttribute(element, 'tenantId');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        tenantId = bo.get(attr);\n      }\n\n      return {\n        tenantId: tenantId\n      };\n    },\n\n    set: function(element, values, node) {\n      var tenantId = values.tenantId;\n      var attr = getAttribute(element, 'tenantId');\n\n      var props = {};\n      props[attr] = tenantId || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n      return !isSupportedCallableType(type);\n    }\n\n  }));\n\n  if (is(getBusinessObject(element), 'bpmn:CallActivity')) {\n    entries.push(entryFactory.checkbox({\n      id: 'callable-business-key',\n      label: translate('Business Key'),\n      modelProperty: 'callableBusinessKey',\n\n      get: function(element, node) {\n        var camundaIn = getCamundaInWithBusinessKey(element);\n\n        return {\n          callableBusinessKey: !!(camundaIn && camundaIn.length > 0)\n        };\n      },\n\n      set: function(element, values, node) {\n        if (values.callableBusinessKey) {\n          return setBusinessKey(element, '#{execution.processBusinessKey}', bpmnFactory);\n        } else {\n          return deleteBusinessKey(element);\n        }\n      }\n    }));\n  }\n\n  entries.push(entryFactory.textField({\n    id: 'business-key-expression',\n    label: translate('Business Key Expression'),\n    modelProperty: 'businessKey',\n\n    get: function(element, node) {\n      var camundaInWithBusinessKey = getCamundaInWithBusinessKey(element);\n\n      return {\n        businessKey: (\n          camundaInWithBusinessKey.length ?\n            camundaInWithBusinessKey[0].get('camunda:businessKey') :\n            undefined\n        )\n      };\n    },\n\n    set: function(element, values, node) {\n      var businessKey = values.businessKey;\n\n      return setBusinessKey(element, businessKey, bpmnFactory);\n    },\n\n    validate: function(element, values, node) {\n      var businessKey = values.businessKey;\n\n      return businessKey === '' ? { businessKey: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !getCamundaInWithBusinessKey(element).length;\n    }\n\n  }));\n\n  entries = entries.concat(resultVariable(element, bpmnFactory, {\n    id: 'dmn-resultVariable',\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getCallableType,\n    hideResultVariable: function(element, node) {\n      return getCallableType(element) !== 'dmn';\n    }\n  }, translate));\n\n  entries.push(entryFactory.selectBox({\n    id: 'dmn-map-decision-result',\n    label: translate('Map Decision Result'),\n    selectOptions: mapDecisionResultOptions,\n    modelProperty: 'mapDecisionResult',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        mapDecisionResult: bo.get('camunda:mapDecisionResult') || 'resultList'\n      };\n    },\n\n    set: function(element, values, node) {\n      return cmdHelper.updateProperties(element, {\n        'camunda:mapDecisionResult': values.mapDecisionResult || 'resultList'\n      });\n    },\n\n    hidden: function(element, node) {\n      var bo = getBusinessObject(element);\n      var resultVariable = bo.get('camunda:resultVariable');\n      return !(getCallableType(element) === 'dmn' && typeof resultVariable !== 'undefined');\n    }\n\n  }));\n\n\n  entries.push(entryFactory.selectBox({\n    id: 'delegateVariableMappingType',\n    label: translate('Delegate Variable Mapping'),\n    selectOptions: delegateVariableMappingOptions,\n    emptyParameter: true,\n    modelProperty: 'delegateVariableMappingType',\n\n    get: function(element, node) {\n      return {\n        delegateVariableMappingType : getDelegateVariableMappingType(element)\n      };\n    },\n\n    set: function(element, values, node) {\n      var delegateVariableMappingType = values.delegateVariableMappingType;\n\n      var props = {\n        'camunda:variableMappingClass' : undefined,\n        'camunda:variableMappingDelegateExpression' : undefined\n      };\n\n      if (delegateVariableMappingType === 'variableMappingClass') {\n        props['camunda:variableMappingClass'] = '';\n      }\n      else if (delegateVariableMappingType === 'variableMappingDelegateExpression') {\n        props['camunda:variableMappingDelegateExpression'] = '';\n      }\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      return (getCallableType(element) !== 'bpmn');\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'delegateVariableMapping',\n    dataValueLabel: 'delegateVariableMappingLabel',\n    modelProperty: 'delegateVariableMapping',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n\n      var label = '';\n      var delegateVariableMapping = undefined;\n      var type = getDelegateVariableMappingType(element);\n\n      if (type === 'variableMappingClass') {\n        label = translate('Class');\n        delegateVariableMapping = bo.get('camunda:variableMappingClass');\n      }\n      else if (type === 'variableMappingDelegateExpression') {\n        label = translate('Delegate Expression');\n        delegateVariableMapping = bo.get('camunda:variableMappingDelegateExpression');\n      }\n\n      return {\n        delegateVariableMapping: delegateVariableMapping,\n        delegateVariableMappingLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var delegateVariableMapping = values.delegateVariableMapping;\n\n      var attr = 'camunda:' + getDelegateVariableMappingType(element);\n\n      var props = {};\n      props[attr] = delegateVariableMapping || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var delegateVariableMapping = values.delegateVariableMapping;\n      return (\n        getCallableType(element) === 'bpmn' && (\n          !delegateVariableMapping ? { delegateVariableMapping: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      return !(getCallableType(element) === 'bpmn' && getDelegateVariableMappingType(element) !== '');\n    }\n\n  }));\n\n  return entries;\n};\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","module.exports = require('./lib');\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar elementHelper = require('../helper/ElementHelper');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction CreateBusinessObjectListHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nCreateBusinessObjectListHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = CreateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + ' required');\n  }\n  return prop;\n\n}\nfunction ensureList(prop, name) {\n  if (!prop || Object.prototype.toString.call(prop) !== '[object Array]') {\n    throw new Error(name + ' needs to be a list');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Creates a new element under a provided parent and updates / creates a reference to it in\n * one atomic action.\n *\n * @method  CreateBusinessObjectListHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element which is the context for the reference\n * @param {moddle.referencingObject} context.referencingObject the object which creates the reference\n * @param {String} context.referenceProperty the property of the referencingObject which makes the reference\n * @param {moddle.newObject} context.newObject the new object to add\n * @param {moddle.newObjectContainer} context.newObjectContainer the container for the new object\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nCreateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      newObjects = ensureList(context.newObjects, 'newObjects'),\n      changed = [ context.element ]; // this will not change any diagram-js elements\n\n\n  var childObjects = [];\n  var self = this;\n\n  // create new array of business objects\n  forEach(newObjects, function(obj) {\n    var element = elementHelper.createElement(obj.type, obj.properties, currentObject, self._bpmnFactory);\n\n    childObjects.push(element);\n  });\n  context.childObject = childObjects;\n\n  // adjust array reference in the parent business object\n  context.previousChilds = currentObject[propertyName];\n  currentObject[propertyName] = childObjects;\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nCreateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousChilds = context.previousChilds;\n\n  // remove new element\n  currentObject.set(propertyName, previousChilds);\n\n  return context.changed;\n};\n","'use strict';\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Get the timer definition type for a given timer event definition.\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>} timer\n *\n * @return {string|undefined} the timer definition type\n */\nfunction getTimerDefinitionType(timer) {\n\n  if (!timer) {\n    return;\n  }\n\n  var timeDate = timer.get('timeDate');\n  if (typeof timeDate !== 'undefined') {\n    return 'timeDate';\n  }\n\n  var timeCycle = timer.get('timeCycle');\n  if (typeof timeCycle !== 'undefined') {\n    return 'timeCycle';\n  }\n\n  var timeDuration = timer.get('timeDuration');\n  if (typeof timeDuration !== 'undefined') {\n    return 'timeDuration';\n  }\n}\n\n/**\n * Get the actual timer event definition based on option, whether it's a getter\n * to fetch the timer event definition or the exact event definition itself\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>|Function} timerOrFunction\n * @param {Shape} element\n * @param {HTMLElement} node\n *\n * @return ModdleElement<bpmn:TimerEventDefinition>\n */\nfunction getTimerDefinition(timerOrFunction, element, node) {\n  if (typeof timerOrFunction === 'function') {\n    return timerOrFunction(element, node);\n  }\n\n  return timerOrFunction;\n}\n\n/**\n * Creates 'bpmn:FormalExpression' element.\n *\n * @param {ModdleElement} parent\n * @param {string} body\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement<bpmn:FormalExpression>} a formal expression\n */\nfunction createFormalExpression(parent, body, bpmnFactory) {\n  body = body || undefined;\n  return elementHelper.createElement('bpmn:FormalExpression', { body: body }, parent, bpmnFactory);\n}\n\nfunction TimerEventDefinition(group, element, bpmnFactory, timerEventDefinition, translate, options) {\n\n  var selectOptions = [\n    { value: 'timeDate', name: translate('Date') },\n    { value: 'timeDuration', name: translate('Duration') },\n    { value: 'timeCycle', name: translate('Cycle') }\n  ];\n\n  var prefix = options && options.idPrefix,\n      createTimerEventDefinition = options && options.createTimerEventDefinition;\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: prefix + 'timer-event-definition-type',\n    label: translate('Timer Definition Type'),\n    selectOptions: selectOptions,\n    emptyParameter: true,\n    modelProperty: 'timerDefinitionType',\n\n    get: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node);\n\n      return {\n        timerDefinitionType: getTimerDefinitionType(timerDefinition) || ''\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = {\n        timeDuration: undefined,\n        timeDate: undefined,\n        timeCycle: undefined\n      };\n\n\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          newType = values.timerDefinitionType;\n\n      if (!timerDefinition && typeof createTimerEventDefinition === 'function') {\n        timerDefinition = createTimerEventDefinition(element, node);\n      }\n\n      if (values.timerDefinitionType) {\n        var oldType = getTimerDefinitionType(timerDefinition);\n\n        var value;\n        if (oldType) {\n          var definition = timerDefinition.get(oldType);\n          value = definition.get('body');\n        }\n\n        props[newType] = createFormalExpression(timerDefinition, value, bpmnFactory);\n      }\n\n      return cmdHelper.updateBusinessObject(element, timerDefinition, props);\n    },\n\n    hidden: function(element, node) {\n      return getTimerDefinition(timerEventDefinition, element, node) === undefined;\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: prefix + 'timer-event-definition',\n    label: translate('Timer Definition'),\n    modelProperty: 'timerDefinition',\n\n    get: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type),\n          value = definition && definition.get('body');\n\n      return {\n        timerDefinition: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type);\n\n      if (definition) {\n        return cmdHelper.updateBusinessObject(element, definition, {\n          body: values.timerDefinition || undefined\n        });\n      }\n    },\n\n    validate: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type);\n\n      if (definition) {\n        var value = definition.get('body');\n        if (!value) {\n          return {\n            timerDefinition: translate('Must provide a value')\n          };\n        }\n      }\n    },\n\n    hidden: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node);\n\n      return !getTimerDefinitionType(timerDefinition);\n    }\n\n  }));\n\n}\n\nmodule.exports = TimerEventDefinition;\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getImplementationType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  function isExternal(element) {\n    return getImplementationType(element) === 'external';\n  }\n\n  var topicEntry = entryFactory.textField({\n    id: 'externalTopic',\n    label: translate('Topic'),\n    modelProperty: 'externalTopic',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { externalTopic: bo.get('camunda:topic') };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:topic': values.externalTopic\n      });\n    },\n\n    validate: function(element, values, node) {\n      return isExternal(element) && !values.externalTopic ? { externalTopic: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isExternal(element);\n    }\n\n  });\n\n  return [ topicEntry ];\n\n};\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar getTemplate = require('./Helper').getTemplate;\n\nvar PropertiesActivator = require('../../../PropertiesActivator');\n\nvar HIGHER_PRIORITY = 1100;\n\n/**\n * Applies template visibility settings.\n *\n * Controlled using `entriesVisible` on template config object:\n *\n * ```json\n *     \"entriesVisible\": {\n *       \"_all\": true|false,\n *       \"entryName\": true|false,\n *       ...\n *     }\n * ```\n *\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n */\nfunction CustomElementsPropertiesActivator(eventBus, elementTemplates) {\n  PropertiesActivator.call(this, eventBus, HIGHER_PRIORITY);\n\n  this.isEntryVisible = function(entry, element) {\n\n    var template = getTemplate(element, elementTemplates);\n\n    if (template && !isEntryVisible(entry, template)) {\n      return false;\n    }\n  };\n\n  this.isPropertyEditable = function(entry, propertyName, element) {\n\n    var template = getTemplate(element, elementTemplates);\n\n    if (template && !isEntryEditable(entry, template)) {\n      return false;\n    }\n  };\n}\n\nCustomElementsPropertiesActivator.$inject = [ 'eventBus', 'elementTemplates' ];\n\ninherits(CustomElementsPropertiesActivator, PropertiesActivator);\n\nmodule.exports = CustomElementsPropertiesActivator;\n\n\n\n// helpers ////////////////////////////////////\n\n\nvar CUSTOM_PROPERTIES_PATTERN = /^custom-/;\n\nvar DEFAULT_ENTRIES_VISIBLE = {\n  _all: false,\n  id: true,\n  name: true\n};\n\nfunction isCustomEntry(entry) {\n  return CUSTOM_PROPERTIES_PATTERN.test(entry.id);\n}\n\nfunction isEntryVisible(entry, template) {\n\n  var entryId = entry.id;\n\n  if (entryId === 'elementTemplate-chooser' || isCustomEntry(entry)) {\n    return true;\n  }\n\n  var entriesVisible = template.entriesVisible || DEFAULT_ENTRIES_VISIBLE;\n\n  if (typeof entriesVisible === 'boolean') {\n    return entriesVisible;\n  }\n\n  var defaultVisible = entriesVisible._all || false,\n      entryVisible = entriesVisible[entryId];\n\n  // d = true, e = false => false\n  // d = false, e = true => true\n  // d = false, e = false\n  return (\n    (defaultVisible === true && entryVisible !== false) ||\n    (defaultVisible === false && entryVisible === true)\n  );\n}\n\nfunction isEntryEditable(entry, template) {\n\n  var property;\n\n  if (isCustomEntry(entry)) {\n    property = getProperty(template, entry);\n\n    return property && property.editable !== false;\n  }\n\n  return true;\n}\n\nfunction getProperty(template, entry) {\n\n  var index;\n  var idx = entry.id.replace('custom-' + template.id + '-', '');\n  if (idx.indexOf('-') !== -1) {\n    var indexes = idx.split('-');\n    if (indexes.length == 2) {\n      var scopeName = indexes[0].replace(/_/g, ':');\n      index = parseInt(indexes[1], 10);\n      if (scopeName && !isNaN(index)) {\n        return template.scopes[scopeName].properties[index];\n      }\n    }\n  } else {\n    index = parseInt(idx, 10);\n    if (!isNaN(index)) {\n      return template.properties[index];\n    }\n  }\n\n  throw new Error('cannot extract property index for entry <' + entry.id + '>');\n}\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var baseEach = require('./_baseEach');\n\n/**\n * Aggregates elements of `collection` on `accumulator` with keys transformed\n * by `iteratee` and values set by `setter`.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform keys.\n * @param {Object} accumulator The initial aggregated object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction baseAggregator(collection, setter, iteratee, accumulator) {\n  baseEach(collection, function(value, key, collection) {\n    setter(accumulator, value, iteratee(value), collection);\n  });\n  return accumulator;\n}\n\nmodule.exports = baseAggregator;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  options = assign({\n    idPrefix: 'listener-',\n    insideListener: true\n  }, options);\n\n  var fieldInjectionEntry = fieldInjection(element, bpmnFactory, translate, options);\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","/** Used to lookup unminified function names. */\nvar realNames = {};\n\nmodule.exports = realNames;\n","'use strict';\n\nvar nameEntryFactory = require('./implementation/Name'),\n    createCategoryValue = require('../../../helper/CategoryHelper').createCategoryValue,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(group, element, bpmnFactory, canvas, translate) {\n\n  function initializeCategory(semantic) {\n    var rootElement = canvas.getRootElement(),\n        definitions = getBusinessObject(rootElement).$parent,\n        categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n    semantic.categoryValueRef = categoryValue;\n\n  }\n\n  function setGroupName(element, values) {\n    var bo = getBusinessObject(element),\n        categoryValueRef = bo.categoryValueRef;\n\n    if (!categoryValueRef) {\n      initializeCategory(bo);\n    }\n\n    // needs direct call to update categoryValue properly\n    return {\n      cmd: 'element.updateLabel',\n      context: {\n        element: element,\n        newLabel: values.categoryValue\n      }\n    };\n  }\n\n  function getGroupName(element) {\n    var bo = getBusinessObject(element),\n        value = (bo.categoryValueRef || {}).value;\n\n    return { categoryValue: value };\n  }\n\n  if (!is(element, 'bpmn:Collaboration')) {\n\n    var options;\n    if (is(element, 'bpmn:TextAnnotation')) {\n      options = { modelProperty: 'text', label: translate('Text') };\n    } else if (is(element, 'bpmn:Group')) {\n      options = {\n        modelProperty: 'categoryValue',\n        label: translate('Category Value'),\n        get: getGroupName,\n        set: setGroupName\n      };\n    }\n\n    // name\n    group.entries = group.entries.concat(nameEntryFactory(element, options, translate));\n\n  }\n\n};\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","var baseRest = require('./_baseRest'),\n    createWrap = require('./_createWrap'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_PARTIAL_FLAG = 32;\n\n/**\n * Creates a function that invokes `func` with the `this` binding of `thisArg`\n * and `partials` prepended to the arguments it receives.\n *\n * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n * may be used as a placeholder for partially applied arguments.\n *\n * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n * property of bound functions.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to bind.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {...*} [partials] The arguments to be partially applied.\n * @returns {Function} Returns the new bound function.\n * @example\n *\n * function greet(greeting, punctuation) {\n *   return greeting + ' ' + this.user + punctuation;\n * }\n *\n * var object = { 'user': 'fred' };\n *\n * var bound = _.bind(greet, object, 'hi');\n * bound('!');\n * // => 'hi fred!'\n *\n * // Bound with placeholders.\n * var bound = _.bind(greet, object, _, '!');\n * bound('hi');\n * // => 'hi fred!'\n */\nvar bind = baseRest(function(func, thisArg, partials) {\n  var bitmask = WRAP_BIND_FLAG;\n  if (partials.length) {\n    var holders = replaceHolders(partials, getHolder(bind));\n    bitmask |= WRAP_PARTIAL_FLAG;\n  }\n  return createWrap(func, bitmask, thisArg, partials, holders);\n});\n\n// Assign default placeholders.\nbind.placeholder = {};\n\nmodule.exports = bind;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var createFind = require('./_createFind'),\n    findIndex = require('./findIndex');\n\n/**\n * Iterates over elements of `collection`, returning the first element\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {*} Returns the matched element, else `undefined`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'age': 36, 'active': true },\n *   { 'user': 'fred',    'age': 40, 'active': false },\n *   { 'user': 'pebbles', 'age': 1,  'active': true }\n * ];\n *\n * _.find(users, function(o) { return o.age < 40; });\n * // => object for 'barney'\n *\n * // The `_.matches` iteratee shorthand.\n * _.find(users, { 'age': 1, 'active': true });\n * // => object for 'pebbles'\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.find(users, ['active', false]);\n * // => object for 'fred'\n *\n * // The `_.property` iteratee shorthand.\n * _.find(users, 'active');\n * // => object for 'barney'\n */\nvar find = createFind(findIndex);\n\nmodule.exports = find;\n","var metaMap = require('./_metaMap'),\n    noop = require('./noop');\n\n/**\n * Gets metadata for `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {*} Returns the metadata for `func`.\n */\nvar getData = !metaMap ? noop : function(func) {\n  return metaMap.get(func);\n};\n\nmodule.exports = getData;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Create an entry to modify the name of an an element.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n *\n * @return {Array<Object>} return an array containing\n *                         the entry to modify the name\n */\nmodule.exports = function(element, options, translate) {\n\n  options = options || {};\n  var id = options.id || 'name',\n      label = options.label || translate('Name'),\n      modelProperty = options.modelProperty || 'name';\n\n  var nameEntry = entryFactory.textBox({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    get: options.get,\n    set: options.set\n  });\n\n  return [ nameEntry ];\n\n};\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    baseLodash = require('./_baseLodash'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike'),\n    wrapperClone = require('./_wrapperClone');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates a `lodash` object which wraps `value` to enable implicit method\n * chain sequences. Methods that operate on and return arrays, collections,\n * and functions can be chained together. Methods that retrieve a single value\n * or may return a primitive value will automatically end the chain sequence\n * and return the unwrapped value. Otherwise, the value must be unwrapped\n * with `_#value`.\n *\n * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n * enabled using `_.chain`.\n *\n * The execution of chained methods is lazy, that is, it's deferred until\n * `_#value` is implicitly or explicitly called.\n *\n * Lazy evaluation allows several methods to support shortcut fusion.\n * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n * the creation of intermediate arrays and can greatly reduce the number of\n * iteratee executions. Sections of a chain sequence qualify for shortcut\n * fusion if the section is applied to an array and iteratees accept only\n * one argument. The heuristic for whether a section qualifies for shortcut\n * fusion is subject to change.\n *\n * Chaining is supported in custom builds as long as the `_#value` method is\n * directly or indirectly included in the build.\n *\n * In addition to lodash methods, wrappers have `Array` and `String` methods.\n *\n * The wrapper `Array` methods are:\n * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n *\n * The wrapper `String` methods are:\n * `replace` and `split`\n *\n * The wrapper methods that support shortcut fusion are:\n * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n *\n * The chainable wrapper methods are:\n * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n * `zipObject`, `zipObjectDeep`, and `zipWith`\n *\n * The wrapper methods that are **not** chainable by default are:\n * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n * `upperFirst`, `value`, and `words`\n *\n * @name _\n * @constructor\n * @category Seq\n * @param {*} value The value to wrap in a `lodash` instance.\n * @returns {Object} Returns the new `lodash` wrapper instance.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * var wrapped = _([1, 2, 3]);\n *\n * // Returns an unwrapped value.\n * wrapped.reduce(_.add);\n * // => 6\n *\n * // Returns a wrapped value.\n * var squares = wrapped.map(square);\n *\n * _.isArray(squares);\n * // => false\n *\n * _.isArray(squares.value());\n * // => true\n */\nfunction lodash(value) {\n  if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n    if (value instanceof LodashWrapper) {\n      return value;\n    }\n    if (hasOwnProperty.call(value, '__wrapped__')) {\n      return wrapperClone(value);\n    }\n  }\n  return new LodashWrapper(value);\n}\n\n// Ensure wrappers are instances of `baseLodash`.\nlodash.prototype = baseLodash.prototype;\nlodash.prototype.constructor = lodash;\n\nmodule.exports = lodash;\n","'use strict';\n\nvar values = require('lodash/values');\n\n/**\n * The guy knowing all configured element templates.\n *\n * This registry won't validate. Use the {@link Validator}\n * to verify a template is valid prior to adding it to\n * this registry.\n */\nfunction ElementTemplates() {\n\n  this._templates = {};\n\n  /**\n   * Sets the known element templates.\n   *\n   * @param {Array<TemplateDescriptor>} descriptors\n   *\n   * @return {ElementTemplates}\n   */\n  this.set = function(descriptors) {\n\n    var templates = this._templates = {};\n\n    descriptors.forEach(function(descriptor) {\n      templates[descriptor.id] = descriptor;\n    });\n\n    return this;\n  };\n\n  /**\n   * Get template descriptor with given id.\n   *\n   * @param {String} id\n   *\n   * @return {TemplateDescriptor}\n   */\n  this.get = function(id) {\n    return this._templates[id];\n  };\n\n  /**\n   * Return all known template descriptors.\n   *\n   * @return {Array<TemplateDescriptor>}\n   */\n  this.getAll = function() {\n    return values(this._templates);\n  };\n\n}\n\nmodule.exports = ElementTemplates;","const testRule = require('./test-rule');\n\nconst categoryMap = {\n  0: 'off',\n  1: 'warn',\n  2: 'error'\n};\n\n\nfunction Linter(options = {}) {\n\n  const {\n    config,\n    resolver\n  } = options;\n\n  if (typeof resolver === 'undefined') {\n    throw new Error('must provide <options.resolver>');\n  }\n\n  this.config = config;\n  this.resolver = resolver;\n\n  this.cachedRules = {};\n  this.cachedConfigs = {};\n}\n\n\nmodule.exports = Linter;\n\n/**\n * Applies a rule on the moddleRoot and adds reports to the finalReport\n *\n * @param {ModdleElement} moddleRoot\n *\n * @param {Object} ruleDefinition.name\n * @param {Object} ruleDefinition.config\n * @param {Object} ruleDefinition.category\n * @param {Rule} ruleDefinition.rule\n *\n * @return {Array<ValidationErrors>} rule reports\n */\nLinter.prototype.applyRule = function applyRule(moddleRoot, ruleDefinition) {\n\n  const {\n    config,\n    rule,\n    category,\n    name\n  } = ruleDefinition;\n\n  try {\n\n    const reports = testRule({\n      moddleRoot,\n      rule,\n      config\n    });\n\n    return reports.map(function(report) {\n      return {\n        ...report,\n        category\n      };\n    });\n  } catch (e) {\n    console.error('rule <' + name + '> failed with error: ', e);\n\n    return [\n      {\n        message: 'Rule error: ' + e.message,\n        category: 'error'\n      }\n    ];\n  }\n\n};\n\n\nLinter.prototype.resolveRule = function(name) {\n\n  const {\n    pkg,\n    ruleName\n  } = this.parseRuleName(name);\n\n  const id = `${pkg}-${ruleName}`;\n\n  const rule = this.cachedRules[id];\n\n  if (rule) {\n    return Promise.resolve(rule);\n  }\n\n  return Promise.resolve(this.resolver.resolveRule(pkg, ruleName)).then((ruleFactory) => {\n\n    if (!ruleFactory) {\n      throw new Error(`unknown rule <${name}>`);\n    }\n\n    const rule = this.cachedRules[id] = ruleFactory();\n\n    return rule;\n  });\n};\n\nLinter.prototype.resolveConfig = function(name) {\n\n  const {\n    pkg,\n    configName\n  } = this.parseConfigName(name);\n\n  const id = `${pkg}-${configName}`;\n\n  const config = this.cachedConfigs[id];\n\n  if (config) {\n    return Promise.resolve(config);\n  }\n\n  return Promise.resolve(this.resolver.resolveConfig(pkg, configName)).then((config) => {\n\n    if (!config) {\n      throw new Error(`unknown config <${name}>`);\n    }\n\n    const actualConfig = this.cachedConfigs[id] = this.normalizeConfig(config, pkg);\n\n    return actualConfig;\n  });\n};\n\n/**\n * Take a linter config and return list of resolved rules.\n *\n * @param {Object} config\n *\n * @return {Array<RuleDefinition>}\n */\nLinter.prototype.resolveRules = function(config) {\n\n  return this.resolveConfiguredRules(config).then((rulesConfig) => {\n\n    // parse rule values\n    const parsedRules = Object.entries(rulesConfig).map(([ name, value ]) => {\n      const {\n        category,\n        config\n      } = this.parseRuleValue(value);\n\n      return {\n        name,\n        category,\n        config\n      };\n    });\n\n    // filter only for enabled rules\n    const enabledRules = parsedRules.filter(definition => definition.category !== 'off');\n\n    // load enabled rules\n    const loaders = enabledRules.map((definition) => {\n\n      const {\n        name\n      } = definition;\n\n      return this.resolveRule(name).then(function(rule) {\n        return {\n          ...definition,\n          rule\n        };\n      });\n    });\n\n    return Promise.all(loaders);\n  });\n};\n\n\nLinter.prototype.resolveConfiguredRules = function(config) {\n\n  let parents = config.extends;\n\n  if (typeof parents === 'string') {\n    parents = [ parents ];\n  }\n\n  if (typeof parents === 'undefined') {\n    parents = [];\n  }\n\n  return Promise.all(\n    parents.map((configName) => {\n      return this.resolveConfig(configName).then((config) => {\n        return this.resolveConfiguredRules(config);\n      });\n    })\n  ).then((inheritedRules) => {\n\n    const overrideRules = this.normalizeConfig(config, 'bpmnlint').rules;\n\n    const rules = [ ...inheritedRules, overrideRules ].reduce((rules, currentRules) => {\n      return {\n        ...rules,\n        ...currentRules\n      };\n    }, {});\n\n    return rules;\n  });\n};\n\n\n/**\n * Lint the given model root, using the specified linter config.\n *\n * @param {ModdleElement} moddleRoot\n * @param {Object} [config] the bpmnlint configuration to use\n *\n * @return {Object} lint results, keyed by category names\n */\nLinter.prototype.lint = function(moddleRoot, config) {\n\n  config = config || this.config;\n\n  // load rules\n  return this.resolveRules(config).then((ruleDefinitions) => {\n\n    const allReports = {};\n\n    ruleDefinitions.forEach((ruleDefinition) => {\n\n      const {\n        name\n      } = ruleDefinition;\n\n      const reports = this.applyRule(moddleRoot, ruleDefinition);\n\n      if (reports.length) {\n        allReports[name] = reports;\n      }\n    });\n\n    return allReports;\n  });\n};\n\n\nLinter.prototype.parseRuleValue = function(value) {\n\n  let category;\n  let config;\n\n  if (Array.isArray(value)) {\n    category = value[0];\n    config = value[1];\n  } else {\n    category = value;\n    config = {};\n  }\n\n  // normalize rule flag to <error> and <warn> which\n  // may be upper case or a number at this point\n  if (typeof category === 'string') {\n    category = category.toLowerCase();\n  }\n\n  category = categoryMap[category] || category;\n\n  return {\n    config,\n    category\n  };\n};\n\nLinter.prototype.parseRuleName = function(name, localPackage = 'bpmnlint') {\n\n  /**\n   * We recognize the following rule name patterns:\n   *\n   * {RULE_NAME} => PKG = 'bpmnlint'\n   * bpmnlint/{RULE_NAME} => PKG = 'bpmnlint'\n   * {PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * bpmnlint-plugin-{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * @scope/{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * @scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   */\n\n  const match = /^(?:(?:(@[^/]+)\\/)?([^@]{1}[^/]*)\\/)?([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable rule name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName,\n    ruleName\n  ] = match;\n\n  if (!packageName) {\n    return {\n      pkg: localPackage,\n      ruleName\n    };\n  }\n\n  const pkg = `${ns ? ns + '/' : '' }${prefixPackage(packageName)}`;\n\n  return {\n    pkg,\n    ruleName\n  };\n};\n\n\nLinter.prototype.parseConfigName = function(name) {\n\n  /**\n   * We recognize the following config name patterns:\n   *\n   * bpmnlint:{CONFIG_NAME} => PKG = 'bpmnlint'\n   * plugin:{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:bpmnlint-plugin-{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:@scope/{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   */\n\n  const match = /^(?:(?:plugin:(?:(@[^/]+)\\/)?([^@]{1}[^/]*)\\/)|bpmnlint:)([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable config name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName,\n    configName\n  ] = match;\n\n  if (!packageName) {\n    return {\n      pkg: 'bpmnlint',\n      configName\n    };\n  }\n\n  const pkg = `${ns ? ns + '/' : '' }${prefixPackage(packageName)}`;\n\n  return {\n    pkg,\n    configName\n  };\n};\n\n\nLinter.prototype.getSimplePackageName = function(name) {\n\n  /**\n   * We recognize the following package name patterns:\n   *\n   * bpmnlint => PKG = 'bpmnlint'\n   * {PACKAGE_SHORTCUT} => PKG = PACKAGE_SHORTCUT\n   * bpmnlint-plugin-{PACKAGE_SHORTCUT}' => PKG = PACKAGE_SHORTCUT\n   * @scope/{PACKAGE_SHORTCUT} => PKG = '@scope/{PACKAGE_SHORTCUT}'\n   * @scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}' => PKG = '@scope/PACKAGE_SHORTCUT'\n   */\n\n  const match = /^(?:(@[^/]+)\\/)?([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable package name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName\n  ] = match;\n\n  return `${ns ? ns + '/' : '' }${unprefixPackage(packageName)}`;\n};\n\n\n/**\n * Validate and return validated config.\n *\n * @param  {Object} config\n * @param  {String} localPackage\n *\n * @return {Object} validated config\n */\nLinter.prototype.normalizeConfig = function(config, localPackage) {\n\n  const rules = config.rules || {};\n\n  const validatedRules = Object.keys(rules).reduce((normalizedRules, name) => {\n\n    const value = rules[name];\n\n    const {\n      pkg,\n      ruleName\n    } = this.parseRuleName(name, localPackage);\n\n    const normalizedName = (\n      pkg === 'bpmnlint'\n        ? ruleName\n        : `${this.getSimplePackageName(pkg)}/${ruleName}`\n    );\n\n    normalizedRules[normalizedName] = value;\n\n    return normalizedRules;\n  }, {});\n\n  return {\n    ...config,\n    rules: validatedRules\n  };\n};\n\n\n// helpers ///////////////////////////\n\nfunction prefixPackage(pkg) {\n\n  if (pkg === 'bpmnlint') {\n    return 'bpmnlint';\n  }\n\n  if (pkg.startsWith('bpmnlint-plugin-')) {\n    return pkg;\n  }\n\n  return `bpmnlint-plugin-${pkg}`;\n}\n\n\nfunction unprefixPackage(pkg) {\n\n  if (pkg.startsWith('bpmnlint-plugin-')) {\n    return pkg.substring('bpmnlint-plugin-'.length);\n  }\n\n  return pkg;\n}","'use strict';\n\nvar CmdHelper = {};\nmodule.exports = CmdHelper;\n\nCmdHelper.updateProperties = function(element, properties) {\n  return {\n    cmd: 'element.updateProperties',\n    context: { element: element, properties: properties }\n  };\n};\n\nCmdHelper.updateBusinessObject = function(element, businessObject, newProperties) {\n  return {\n    cmd: 'properties-panel.update-businessobject',\n    context: {\n      element: element,\n      businessObject: businessObject,\n      properties: newProperties\n    }\n  };\n};\n\nCmdHelper.addElementsTolist = function(element, businessObject, listPropertyName, objectsToAdd) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      objectsToAdd: objectsToAdd\n    }\n  };\n};\n\nCmdHelper.removeElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.addAndRemoveElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToAdd, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToAdd: objectsToAdd,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.setList = function(element, businessObject, listPropertyName, updatedObjectList) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      updatedObjectList: updatedObjectList\n    }\n  };\n};\n","'use strict';\n\nvar cmdHelper = require('./CmdHelper'),\n    elementHelper = require('./ElementHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar ExtensionElementsHelper = {};\n\nvar getExtensionElements = function(bo) {\n  return bo.get('extensionElements');\n};\n\nExtensionElementsHelper.getExtensionElements = function(bo, type) {\n  var extensionElements = getExtensionElements(bo);\n  if (typeof extensionElements !== 'undefined') {\n    var extensionValues = extensionElements.get('values');\n    if (typeof extensionValues !== 'undefined') {\n      var elements = extensionValues.filter(function(value) {\n        return is(value, type);\n      });\n      if (elements.length) {\n        return elements;\n      }\n    }\n  }\n};\n\nExtensionElementsHelper.addEntry = function(bo, element, entry, bpmnFactory) {\n  var extensionElements = bo.get('extensionElements');\n\n  // if there is no extensionElements list, create one\n  if (!extensionElements) {\n    // TODO: Ask Daniel which operation costs more\n    extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [entry] }, bo, bpmnFactory);\n    return { extensionElements : extensionElements };\n  } else {\n    // add new failedJobRetryExtensionElement to existing extensionElements list\n    return cmdHelper.addElementsTolist(element, extensionElements, 'values', [entry]);\n  }\n};\n\nExtensionElementsHelper.removeEntry = function(bo, element, entry) {\n  var extensionElements = bo.get('extensionElements');\n\n  if (!extensionElements) {\n\n    // return an empty command when there is no extensionElements list\n    return {};\n  }\n\n  return cmdHelper.removeElementsFromList(element, extensionElements, 'values', 'extensionElements', [entry]);\n};\n\nmodule.exports = ExtensionElementsHelper;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = baseFindIndex;\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.string.iterator');\nvar $ = require('../internals/export');\nvar DESCRIPTORS = require('../internals/descriptors');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar global = require('../internals/global');\nvar defineProperties = require('../internals/object-define-properties');\nvar redefine = require('../internals/redefine');\nvar anInstance = require('../internals/an-instance');\nvar has = require('../internals/has');\nvar assign = require('../internals/object-assign');\nvar arrayFrom = require('../internals/array-from');\nvar codeAt = require('../internals/string-multibyte').codeAt;\nvar toASCII = require('../internals/string-punycode-to-ascii');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar URLSearchParamsModule = require('../modules/web.url-search-params');\nvar InternalStateModule = require('../internals/internal-state');\n\nvar NativeURL = global.URL;\nvar URLSearchParams = URLSearchParamsModule.URLSearchParams;\nvar getInternalSearchParamsState = URLSearchParamsModule.getState;\nvar setInternalState = InternalStateModule.set;\nvar getInternalURLState = InternalStateModule.getterFor('URL');\nvar floor = Math.floor;\nvar pow = Math.pow;\n\nvar INVALID_AUTHORITY = 'Invalid authority';\nvar INVALID_SCHEME = 'Invalid scheme';\nvar INVALID_HOST = 'Invalid host';\nvar INVALID_PORT = 'Invalid port';\n\nvar ALPHA = /[A-Za-z]/;\nvar ALPHANUMERIC = /[\\d+\\-.A-Za-z]/;\nvar DIGIT = /\\d/;\nvar HEX_START = /^(0x|0X)/;\nvar OCT = /^[0-7]+$/;\nvar DEC = /^\\d+$/;\nvar HEX = /^[\\dA-Fa-f]+$/;\n// eslint-disable-next-line no-control-regex\nvar FORBIDDEN_HOST_CODE_POINT = /[\\u0000\\u0009\\u000A\\u000D #%/:?@[\\\\]]/;\n// eslint-disable-next-line no-control-regex\nvar FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT = /[\\u0000\\u0009\\u000A\\u000D #/:?@[\\\\]]/;\n// eslint-disable-next-line no-control-regex\nvar LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE = /^[\\u0000-\\u001F ]+|[\\u0000-\\u001F ]+$/g;\n// eslint-disable-next-line no-control-regex\nvar TAB_AND_NEW_LINE = /[\\u0009\\u000A\\u000D]/g;\nvar EOF;\n\nvar parseHost = function (url, input) {\n  var result, codePoints, index;\n  if (input.charAt(0) == '[') {\n    if (input.charAt(input.length - 1) != ']') return INVALID_HOST;\n    result = parseIPv6(input.slice(1, -1));\n    if (!result) return INVALID_HOST;\n    url.host = result;\n  // opaque host\n  } else if (!isSpecial(url)) {\n    if (FORBIDDEN_HOST_CODE_POINT_EXCLUDING_PERCENT.test(input)) return INVALID_HOST;\n    result = '';\n    codePoints = arrayFrom(input);\n    for (index = 0; index < codePoints.length; index++) {\n      result += percentEncode(codePoints[index], C0ControlPercentEncodeSet);\n    }\n    url.host = result;\n  } else {\n    input = toASCII(input);\n    if (FORBIDDEN_HOST_CODE_POINT.test(input)) return INVALID_HOST;\n    result = parseIPv4(input);\n    if (result === null) return INVALID_HOST;\n    url.host = result;\n  }\n};\n\nvar parseIPv4 = function (input) {\n  var parts = input.split('.');\n  var partsLength, numbers, index, part, radix, number, ipv4;\n  if (parts.length && parts[parts.length - 1] == '') {\n    parts.pop();\n  }\n  partsLength = parts.length;\n  if (partsLength > 4) return input;\n  numbers = [];\n  for (index = 0; index < partsLength; index++) {\n    part = parts[index];\n    if (part == '') return input;\n    radix = 10;\n    if (part.length > 1 && part.charAt(0) == '0') {\n      radix = HEX_START.test(part) ? 16 : 8;\n      part = part.slice(radix == 8 ? 1 : 2);\n    }\n    if (part === '') {\n      number = 0;\n    } else {\n      if (!(radix == 10 ? DEC : radix == 8 ? OCT : HEX).test(part)) return input;\n      number = parseInt(part, radix);\n    }\n    numbers.push(number);\n  }\n  for (index = 0; index < partsLength; index++) {\n    number = numbers[index];\n    if (index == partsLength - 1) {\n      if (number >= pow(256, 5 - partsLength)) return null;\n    } else if (number > 255) return null;\n  }\n  ipv4 = numbers.pop();\n  for (index = 0; index < numbers.length; index++) {\n    ipv4 += numbers[index] * pow(256, 3 - index);\n  }\n  return ipv4;\n};\n\n// eslint-disable-next-line max-statements\nvar parseIPv6 = function (input) {\n  var address = [0, 0, 0, 0, 0, 0, 0, 0];\n  var pieceIndex = 0;\n  var compress = null;\n  var pointer = 0;\n  var value, length, numbersSeen, ipv4Piece, number, swaps, swap;\n\n  var char = function () {\n    return input.charAt(pointer);\n  };\n\n  if (char() == ':') {\n    if (input.charAt(1) != ':') return;\n    pointer += 2;\n    pieceIndex++;\n    compress = pieceIndex;\n  }\n  while (char()) {\n    if (pieceIndex == 8) return;\n    if (char() == ':') {\n      if (compress !== null) return;\n      pointer++;\n      pieceIndex++;\n      compress = pieceIndex;\n      continue;\n    }\n    value = length = 0;\n    while (length < 4 && HEX.test(char())) {\n      value = value * 16 + parseInt(char(), 16);\n      pointer++;\n      length++;\n    }\n    if (char() == '.') {\n      if (length == 0) return;\n      pointer -= length;\n      if (pieceIndex > 6) return;\n      numbersSeen = 0;\n      while (char()) {\n        ipv4Piece = null;\n        if (numbersSeen > 0) {\n          if (char() == '.' && numbersSeen < 4) pointer++;\n          else return;\n        }\n        if (!DIGIT.test(char())) return;\n        while (DIGIT.test(char())) {\n          number = parseInt(char(), 10);\n          if (ipv4Piece === null) ipv4Piece = number;\n          else if (ipv4Piece == 0) return;\n          else ipv4Piece = ipv4Piece * 10 + number;\n          if (ipv4Piece > 255) return;\n          pointer++;\n        }\n        address[pieceIndex] = address[pieceIndex] * 256 + ipv4Piece;\n        numbersSeen++;\n        if (numbersSeen == 2 || numbersSeen == 4) pieceIndex++;\n      }\n      if (numbersSeen != 4) return;\n      break;\n    } else if (char() == ':') {\n      pointer++;\n      if (!char()) return;\n    } else if (char()) return;\n    address[pieceIndex++] = value;\n  }\n  if (compress !== null) {\n    swaps = pieceIndex - compress;\n    pieceIndex = 7;\n    while (pieceIndex != 0 && swaps > 0) {\n      swap = address[pieceIndex];\n      address[pieceIndex--] = address[compress + swaps - 1];\n      address[compress + --swaps] = swap;\n    }\n  } else if (pieceIndex != 8) return;\n  return address;\n};\n\nvar findLongestZeroSequence = function (ipv6) {\n  var maxIndex = null;\n  var maxLength = 1;\n  var currStart = null;\n  var currLength = 0;\n  var index = 0;\n  for (; index < 8; index++) {\n    if (ipv6[index] !== 0) {\n      if (currLength > maxLength) {\n        maxIndex = currStart;\n        maxLength = currLength;\n      }\n      currStart = null;\n      currLength = 0;\n    } else {\n      if (currStart === null) currStart = index;\n      ++currLength;\n    }\n  }\n  if (currLength > maxLength) {\n    maxIndex = currStart;\n    maxLength = currLength;\n  }\n  return maxIndex;\n};\n\nvar serializeHost = function (host) {\n  var result, index, compress, ignore0;\n  // ipv4\n  if (typeof host == 'number') {\n    result = [];\n    for (index = 0; index < 4; index++) {\n      result.unshift(host % 256);\n      host = floor(host / 256);\n    } return result.join('.');\n  // ipv6\n  } else if (typeof host == 'object') {\n    result = '';\n    compress = findLongestZeroSequence(host);\n    for (index = 0; index < 8; index++) {\n      if (ignore0 && host[index] === 0) continue;\n      if (ignore0) ignore0 = false;\n      if (compress === index) {\n        result += index ? ':' : '::';\n        ignore0 = true;\n      } else {\n        result += host[index].toString(16);\n        if (index < 7) result += ':';\n      }\n    }\n    return '[' + result + ']';\n  } return host;\n};\n\nvar C0ControlPercentEncodeSet = {};\nvar fragmentPercentEncodeSet = assign({}, C0ControlPercentEncodeSet, {\n  ' ': 1, '\"': 1, '<': 1, '>': 1, '`': 1\n});\nvar pathPercentEncodeSet = assign({}, fragmentPercentEncodeSet, {\n  '#': 1, '?': 1, '{': 1, '}': 1\n});\nvar userinfoPercentEncodeSet = assign({}, pathPercentEncodeSet, {\n  '/': 1, ':': 1, ';': 1, '=': 1, '@': 1, '[': 1, '\\\\': 1, ']': 1, '^': 1, '|': 1\n});\n\nvar percentEncode = function (char, set) {\n  var code = codeAt(char, 0);\n  return code > 0x20 && code < 0x7F && !has(set, char) ? char : encodeURIComponent(char);\n};\n\nvar specialSchemes = {\n  ftp: 21,\n  file: null,\n  http: 80,\n  https: 443,\n  ws: 80,\n  wss: 443\n};\n\nvar isSpecial = function (url) {\n  return has(specialSchemes, url.scheme);\n};\n\nvar includesCredentials = function (url) {\n  return url.username != '' || url.password != '';\n};\n\nvar cannotHaveUsernamePasswordPort = function (url) {\n  return !url.host || url.cannotBeABaseURL || url.scheme == 'file';\n};\n\nvar isWindowsDriveLetter = function (string, normalized) {\n  var second;\n  return string.length == 2 && ALPHA.test(string.charAt(0))\n    && ((second = string.charAt(1)) == ':' || (!normalized && second == '|'));\n};\n\nvar startsWithWindowsDriveLetter = function (string) {\n  var third;\n  return string.length > 1 && isWindowsDriveLetter(string.slice(0, 2)) && (\n    string.length == 2 ||\n    ((third = string.charAt(2)) === '/' || third === '\\\\' || third === '?' || third === '#')\n  );\n};\n\nvar shortenURLsPath = function (url) {\n  var path = url.path;\n  var pathSize = path.length;\n  if (pathSize && (url.scheme != 'file' || pathSize != 1 || !isWindowsDriveLetter(path[0], true))) {\n    path.pop();\n  }\n};\n\nvar isSingleDot = function (segment) {\n  return segment === '.' || segment.toLowerCase() === '%2e';\n};\n\nvar isDoubleDot = function (segment) {\n  segment = segment.toLowerCase();\n  return segment === '..' || segment === '%2e.' || segment === '.%2e' || segment === '%2e%2e';\n};\n\n// States:\nvar SCHEME_START = {};\nvar SCHEME = {};\nvar NO_SCHEME = {};\nvar SPECIAL_RELATIVE_OR_AUTHORITY = {};\nvar PATH_OR_AUTHORITY = {};\nvar RELATIVE = {};\nvar RELATIVE_SLASH = {};\nvar SPECIAL_AUTHORITY_SLASHES = {};\nvar SPECIAL_AUTHORITY_IGNORE_SLASHES = {};\nvar AUTHORITY = {};\nvar HOST = {};\nvar HOSTNAME = {};\nvar PORT = {};\nvar FILE = {};\nvar FILE_SLASH = {};\nvar FILE_HOST = {};\nvar PATH_START = {};\nvar PATH = {};\nvar CANNOT_BE_A_BASE_URL_PATH = {};\nvar QUERY = {};\nvar FRAGMENT = {};\n\n// eslint-disable-next-line max-statements\nvar parseURL = function (url, input, stateOverride, base) {\n  var state = stateOverride || SCHEME_START;\n  var pointer = 0;\n  var buffer = '';\n  var seenAt = false;\n  var seenBracket = false;\n  var seenPasswordToken = false;\n  var codePoints, char, bufferCodePoints, failure;\n\n  if (!stateOverride) {\n    url.scheme = '';\n    url.username = '';\n    url.password = '';\n    url.host = null;\n    url.port = null;\n    url.path = [];\n    url.query = null;\n    url.fragment = null;\n    url.cannotBeABaseURL = false;\n    input = input.replace(LEADING_AND_TRAILING_C0_CONTROL_OR_SPACE, '');\n  }\n\n  input = input.replace(TAB_AND_NEW_LINE, '');\n\n  codePoints = arrayFrom(input);\n\n  while (pointer <= codePoints.length) {\n    char = codePoints[pointer];\n    switch (state) {\n      case SCHEME_START:\n        if (char && ALPHA.test(char)) {\n          buffer += char.toLowerCase();\n          state = SCHEME;\n        } else if (!stateOverride) {\n          state = NO_SCHEME;\n          continue;\n        } else return INVALID_SCHEME;\n        break;\n\n      case SCHEME:\n        if (char && (ALPHANUMERIC.test(char) || char == '+' || char == '-' || char == '.')) {\n          buffer += char.toLowerCase();\n        } else if (char == ':') {\n          if (stateOverride && (\n            (isSpecial(url) != has(specialSchemes, buffer)) ||\n            (buffer == 'file' && (includesCredentials(url) || url.port !== null)) ||\n            (url.scheme == 'file' && !url.host)\n          )) return;\n          url.scheme = buffer;\n          if (stateOverride) {\n            if (isSpecial(url) && specialSchemes[url.scheme] == url.port) url.port = null;\n            return;\n          }\n          buffer = '';\n          if (url.scheme == 'file') {\n            state = FILE;\n          } else if (isSpecial(url) && base && base.scheme == url.scheme) {\n            state = SPECIAL_RELATIVE_OR_AUTHORITY;\n          } else if (isSpecial(url)) {\n            state = SPECIAL_AUTHORITY_SLASHES;\n          } else if (codePoints[pointer + 1] == '/') {\n            state = PATH_OR_AUTHORITY;\n            pointer++;\n          } else {\n            url.cannotBeABaseURL = true;\n            url.path.push('');\n            state = CANNOT_BE_A_BASE_URL_PATH;\n          }\n        } else if (!stateOverride) {\n          buffer = '';\n          state = NO_SCHEME;\n          pointer = 0;\n          continue;\n        } else return INVALID_SCHEME;\n        break;\n\n      case NO_SCHEME:\n        if (!base || (base.cannotBeABaseURL && char != '#')) return INVALID_SCHEME;\n        if (base.cannotBeABaseURL && char == '#') {\n          url.scheme = base.scheme;\n          url.path = base.path.slice();\n          url.query = base.query;\n          url.fragment = '';\n          url.cannotBeABaseURL = true;\n          state = FRAGMENT;\n          break;\n        }\n        state = base.scheme == 'file' ? FILE : RELATIVE;\n        continue;\n\n      case SPECIAL_RELATIVE_OR_AUTHORITY:\n        if (char == '/' && codePoints[pointer + 1] == '/') {\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n          pointer++;\n        } else {\n          state = RELATIVE;\n          continue;\n        } break;\n\n      case PATH_OR_AUTHORITY:\n        if (char == '/') {\n          state = AUTHORITY;\n          break;\n        } else {\n          state = PATH;\n          continue;\n        }\n\n      case RELATIVE:\n        url.scheme = base.scheme;\n        if (char == EOF) {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.query = base.query;\n        } else if (char == '/' || (char == '\\\\' && isSpecial(url))) {\n          state = RELATIVE_SLASH;\n        } else if (char == '?') {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.query = '';\n          state = QUERY;\n        } else if (char == '#') {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.query = base.query;\n          url.fragment = '';\n          state = FRAGMENT;\n        } else {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          url.path = base.path.slice();\n          url.path.pop();\n          state = PATH;\n          continue;\n        } break;\n\n      case RELATIVE_SLASH:\n        if (isSpecial(url) && (char == '/' || char == '\\\\')) {\n          state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n        } else if (char == '/') {\n          state = AUTHORITY;\n        } else {\n          url.username = base.username;\n          url.password = base.password;\n          url.host = base.host;\n          url.port = base.port;\n          state = PATH;\n          continue;\n        } break;\n\n      case SPECIAL_AUTHORITY_SLASHES:\n        state = SPECIAL_AUTHORITY_IGNORE_SLASHES;\n        if (char != '/' || buffer.charAt(pointer + 1) != '/') continue;\n        pointer++;\n        break;\n\n      case SPECIAL_AUTHORITY_IGNORE_SLASHES:\n        if (char != '/' && char != '\\\\') {\n          state = AUTHORITY;\n          continue;\n        } break;\n\n      case AUTHORITY:\n        if (char == '@') {\n          if (seenAt) buffer = '%40' + buffer;\n          seenAt = true;\n          bufferCodePoints = arrayFrom(buffer);\n          for (var i = 0; i < bufferCodePoints.length; i++) {\n            var codePoint = bufferCodePoints[i];\n            if (codePoint == ':' && !seenPasswordToken) {\n              seenPasswordToken = true;\n              continue;\n            }\n            var encodedCodePoints = percentEncode(codePoint, userinfoPercentEncodeSet);\n            if (seenPasswordToken) url.password += encodedCodePoints;\n            else url.username += encodedCodePoints;\n          }\n          buffer = '';\n        } else if (\n          char == EOF || char == '/' || char == '?' || char == '#' ||\n          (char == '\\\\' && isSpecial(url))\n        ) {\n          if (seenAt && buffer == '') return INVALID_AUTHORITY;\n          pointer -= arrayFrom(buffer).length + 1;\n          buffer = '';\n          state = HOST;\n        } else buffer += char;\n        break;\n\n      case HOST:\n      case HOSTNAME:\n        if (stateOverride && url.scheme == 'file') {\n          state = FILE_HOST;\n          continue;\n        } else if (char == ':' && !seenBracket) {\n          if (buffer == '') return INVALID_HOST;\n          failure = parseHost(url, buffer);\n          if (failure) return failure;\n          buffer = '';\n          state = PORT;\n          if (stateOverride == HOSTNAME) return;\n        } else if (\n          char == EOF || char == '/' || char == '?' || char == '#' ||\n          (char == '\\\\' && isSpecial(url))\n        ) {\n          if (isSpecial(url) && buffer == '') return INVALID_HOST;\n          if (stateOverride && buffer == '' && (includesCredentials(url) || url.port !== null)) return;\n          failure = parseHost(url, buffer);\n          if (failure) return failure;\n          buffer = '';\n          state = PATH_START;\n          if (stateOverride) return;\n          continue;\n        } else {\n          if (char == '[') seenBracket = true;\n          else if (char == ']') seenBracket = false;\n          buffer += char;\n        } break;\n\n      case PORT:\n        if (DIGIT.test(char)) {\n          buffer += char;\n        } else if (\n          char == EOF || char == '/' || char == '?' || char == '#' ||\n          (char == '\\\\' && isSpecial(url)) ||\n          stateOverride\n        ) {\n          if (buffer != '') {\n            var port = parseInt(buffer, 10);\n            if (port > 0xFFFF) return INVALID_PORT;\n            url.port = (isSpecial(url) && port === specialSchemes[url.scheme]) ? null : port;\n            buffer = '';\n          }\n          if (stateOverride) return;\n          state = PATH_START;\n          continue;\n        } else return INVALID_PORT;\n        break;\n\n      case FILE:\n        url.scheme = 'file';\n        if (char == '/' || char == '\\\\') state = FILE_SLASH;\n        else if (base && base.scheme == 'file') {\n          if (char == EOF) {\n            url.host = base.host;\n            url.path = base.path.slice();\n            url.query = base.query;\n          } else if (char == '?') {\n            url.host = base.host;\n            url.path = base.path.slice();\n            url.query = '';\n            state = QUERY;\n          } else if (char == '#') {\n            url.host = base.host;\n            url.path = base.path.slice();\n            url.query = base.query;\n            url.fragment = '';\n            state = FRAGMENT;\n          } else {\n            if (!startsWithWindowsDriveLetter(codePoints.slice(pointer).join(''))) {\n              url.host = base.host;\n              url.path = base.path.slice();\n              shortenURLsPath(url);\n            }\n            state = PATH;\n            continue;\n          }\n        } else {\n          state = PATH;\n          continue;\n        } break;\n\n      case FILE_SLASH:\n        if (char == '/' || char == '\\\\') {\n          state = FILE_HOST;\n          break;\n        }\n        if (base && base.scheme == 'file' && !startsWithWindowsDriveLetter(codePoints.slice(pointer).join(''))) {\n          if (isWindowsDriveLetter(base.path[0], true)) url.path.push(base.path[0]);\n          else url.host = base.host;\n        }\n        state = PATH;\n        continue;\n\n      case FILE_HOST:\n        if (char == EOF || char == '/' || char == '\\\\' || char == '?' || char == '#') {\n          if (!stateOverride && isWindowsDriveLetter(buffer)) {\n            state = PATH;\n          } else if (buffer == '') {\n            url.host = '';\n            if (stateOverride) return;\n            state = PATH_START;\n          } else {\n            failure = parseHost(url, buffer);\n            if (failure) return failure;\n            if (url.host == 'localhost') url.host = '';\n            if (stateOverride) return;\n            buffer = '';\n            state = PATH_START;\n          } continue;\n        } else buffer += char;\n        break;\n\n      case PATH_START:\n        if (isSpecial(url)) {\n          state = PATH;\n          if (char != '/' && char != '\\\\') continue;\n        } else if (!stateOverride && char == '?') {\n          url.query = '';\n          state = QUERY;\n        } else if (!stateOverride && char == '#') {\n          url.fragment = '';\n          state = FRAGMENT;\n        } else if (char != EOF) {\n          state = PATH;\n          if (char != '/') continue;\n        } break;\n\n      case PATH:\n        if (\n          char == EOF || char == '/' ||\n          (char == '\\\\' && isSpecial(url)) ||\n          (!stateOverride && (char == '?' || char == '#'))\n        ) {\n          if (isDoubleDot(buffer)) {\n            shortenURLsPath(url);\n            if (char != '/' && !(char == '\\\\' && isSpecial(url))) {\n              url.path.push('');\n            }\n          } else if (isSingleDot(buffer)) {\n            if (char != '/' && !(char == '\\\\' && isSpecial(url))) {\n              url.path.push('');\n            }\n          } else {\n            if (url.scheme == 'file' && !url.path.length && isWindowsDriveLetter(buffer)) {\n              if (url.host) url.host = '';\n              buffer = buffer.charAt(0) + ':'; // normalize windows drive letter\n            }\n            url.path.push(buffer);\n          }\n          buffer = '';\n          if (url.scheme == 'file' && (char == EOF || char == '?' || char == '#')) {\n            while (url.path.length > 1 && url.path[0] === '') {\n              url.path.shift();\n            }\n          }\n          if (char == '?') {\n            url.query = '';\n            state = QUERY;\n          } else if (char == '#') {\n            url.fragment = '';\n            state = FRAGMENT;\n          }\n        } else {\n          buffer += percentEncode(char, pathPercentEncodeSet);\n        } break;\n\n      case CANNOT_BE_A_BASE_URL_PATH:\n        if (char == '?') {\n          url.query = '';\n          state = QUERY;\n        } else if (char == '#') {\n          url.fragment = '';\n          state = FRAGMENT;\n        } else if (char != EOF) {\n          url.path[0] += percentEncode(char, C0ControlPercentEncodeSet);\n        } break;\n\n      case QUERY:\n        if (!stateOverride && char == '#') {\n          url.fragment = '';\n          state = FRAGMENT;\n        } else if (char != EOF) {\n          if (char == \"'\" && isSpecial(url)) url.query += '%27';\n          else if (char == '#') url.query += '%23';\n          else url.query += percentEncode(char, C0ControlPercentEncodeSet);\n        } break;\n\n      case FRAGMENT:\n        if (char != EOF) url.fragment += percentEncode(char, fragmentPercentEncodeSet);\n        break;\n    }\n\n    pointer++;\n  }\n};\n\n// `URL` constructor\n// https://url.spec.whatwg.org/#url-class\nvar URLConstructor = function URL(url /* , base */) {\n  var that = anInstance(this, URLConstructor, 'URL');\n  var base = arguments.length > 1 ? arguments[1] : undefined;\n  var urlString = String(url);\n  var state = setInternalState(that, { type: 'URL' });\n  var baseState, failure;\n  if (base !== undefined) {\n    if (base instanceof URLConstructor) baseState = getInternalURLState(base);\n    else {\n      failure = parseURL(baseState = {}, String(base));\n      if (failure) throw TypeError(failure);\n    }\n  }\n  failure = parseURL(state, urlString, null, baseState);\n  if (failure) throw TypeError(failure);\n  var searchParams = state.searchParams = new URLSearchParams();\n  var searchParamsState = getInternalSearchParamsState(searchParams);\n  searchParamsState.updateSearchParams(state.query);\n  searchParamsState.updateURL = function () {\n    state.query = String(searchParams) || null;\n  };\n  if (!DESCRIPTORS) {\n    that.href = serializeURL.call(that);\n    that.origin = getOrigin.call(that);\n    that.protocol = getProtocol.call(that);\n    that.username = getUsername.call(that);\n    that.password = getPassword.call(that);\n    that.host = getHost.call(that);\n    that.hostname = getHostname.call(that);\n    that.port = getPort.call(that);\n    that.pathname = getPathname.call(that);\n    that.search = getSearch.call(that);\n    that.searchParams = getSearchParams.call(that);\n    that.hash = getHash.call(that);\n  }\n};\n\nvar URLPrototype = URLConstructor.prototype;\n\nvar serializeURL = function () {\n  var url = getInternalURLState(this);\n  var scheme = url.scheme;\n  var username = url.username;\n  var password = url.password;\n  var host = url.host;\n  var port = url.port;\n  var path = url.path;\n  var query = url.query;\n  var fragment = url.fragment;\n  var output = scheme + ':';\n  if (host !== null) {\n    output += '//';\n    if (includesCredentials(url)) {\n      output += username + (password ? ':' + password : '') + '@';\n    }\n    output += serializeHost(host);\n    if (port !== null) output += ':' + port;\n  } else if (scheme == 'file') output += '//';\n  output += url.cannotBeABaseURL ? path[0] : path.length ? '/' + path.join('/') : '';\n  if (query !== null) output += '?' + query;\n  if (fragment !== null) output += '#' + fragment;\n  return output;\n};\n\nvar getOrigin = function () {\n  var url = getInternalURLState(this);\n  var scheme = url.scheme;\n  var port = url.port;\n  if (scheme == 'blob') try {\n    return new URL(scheme.path[0]).origin;\n  } catch (error) {\n    return 'null';\n  }\n  if (scheme == 'file' || !isSpecial(url)) return 'null';\n  return scheme + '://' + serializeHost(url.host) + (port !== null ? ':' + port : '');\n};\n\nvar getProtocol = function () {\n  return getInternalURLState(this).scheme + ':';\n};\n\nvar getUsername = function () {\n  return getInternalURLState(this).username;\n};\n\nvar getPassword = function () {\n  return getInternalURLState(this).password;\n};\n\nvar getHost = function () {\n  var url = getInternalURLState(this);\n  var host = url.host;\n  var port = url.port;\n  return host === null ? ''\n    : port === null ? serializeHost(host)\n    : serializeHost(host) + ':' + port;\n};\n\nvar getHostname = function () {\n  var host = getInternalURLState(this).host;\n  return host === null ? '' : serializeHost(host);\n};\n\nvar getPort = function () {\n  var port = getInternalURLState(this).port;\n  return port === null ? '' : String(port);\n};\n\nvar getPathname = function () {\n  var url = getInternalURLState(this);\n  var path = url.path;\n  return url.cannotBeABaseURL ? path[0] : path.length ? '/' + path.join('/') : '';\n};\n\nvar getSearch = function () {\n  var query = getInternalURLState(this).query;\n  return query ? '?' + query : '';\n};\n\nvar getSearchParams = function () {\n  return getInternalURLState(this).searchParams;\n};\n\nvar getHash = function () {\n  var fragment = getInternalURLState(this).fragment;\n  return fragment ? '#' + fragment : '';\n};\n\nvar accessorDescriptor = function (getter, setter) {\n  return { get: getter, set: setter, configurable: true, enumerable: true };\n};\n\nif (DESCRIPTORS) {\n  defineProperties(URLPrototype, {\n    // `URL.prototype.href` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-href\n    href: accessorDescriptor(serializeURL, function (href) {\n      var url = getInternalURLState(this);\n      var urlString = String(href);\n      var failure = parseURL(url, urlString);\n      if (failure) throw TypeError(failure);\n      getInternalSearchParamsState(url.searchParams).updateSearchParams(url.query);\n    }),\n    // `URL.prototype.origin` getter\n    // https://url.spec.whatwg.org/#dom-url-origin\n    origin: accessorDescriptor(getOrigin),\n    // `URL.prototype.protocol` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-protocol\n    protocol: accessorDescriptor(getProtocol, function (protocol) {\n      var url = getInternalURLState(this);\n      parseURL(url, String(protocol) + ':', SCHEME_START);\n    }),\n    // `URL.prototype.username` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-username\n    username: accessorDescriptor(getUsername, function (username) {\n      var url = getInternalURLState(this);\n      var codePoints = arrayFrom(String(username));\n      if (cannotHaveUsernamePasswordPort(url)) return;\n      url.username = '';\n      for (var i = 0; i < codePoints.length; i++) {\n        url.username += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n      }\n    }),\n    // `URL.prototype.password` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-password\n    password: accessorDescriptor(getPassword, function (password) {\n      var url = getInternalURLState(this);\n      var codePoints = arrayFrom(String(password));\n      if (cannotHaveUsernamePasswordPort(url)) return;\n      url.password = '';\n      for (var i = 0; i < codePoints.length; i++) {\n        url.password += percentEncode(codePoints[i], userinfoPercentEncodeSet);\n      }\n    }),\n    // `URL.prototype.host` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-host\n    host: accessorDescriptor(getHost, function (host) {\n      var url = getInternalURLState(this);\n      if (url.cannotBeABaseURL) return;\n      parseURL(url, String(host), HOST);\n    }),\n    // `URL.prototype.hostname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hostname\n    hostname: accessorDescriptor(getHostname, function (hostname) {\n      var url = getInternalURLState(this);\n      if (url.cannotBeABaseURL) return;\n      parseURL(url, String(hostname), HOSTNAME);\n    }),\n    // `URL.prototype.port` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-port\n    port: accessorDescriptor(getPort, function (port) {\n      var url = getInternalURLState(this);\n      if (cannotHaveUsernamePasswordPort(url)) return;\n      port = String(port);\n      if (port == '') url.port = null;\n      else parseURL(url, port, PORT);\n    }),\n    // `URL.prototype.pathname` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-pathname\n    pathname: accessorDescriptor(getPathname, function (pathname) {\n      var url = getInternalURLState(this);\n      if (url.cannotBeABaseURL) return;\n      url.path = [];\n      parseURL(url, pathname + '', PATH_START);\n    }),\n    // `URL.prototype.search` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-search\n    search: accessorDescriptor(getSearch, function (search) {\n      var url = getInternalURLState(this);\n      search = String(search);\n      if (search == '') {\n        url.query = null;\n      } else {\n        if ('?' == search.charAt(0)) search = search.slice(1);\n        url.query = '';\n        parseURL(url, search, QUERY);\n      }\n      getInternalSearchParamsState(url.searchParams).updateSearchParams(url.query);\n    }),\n    // `URL.prototype.searchParams` getter\n    // https://url.spec.whatwg.org/#dom-url-searchparams\n    searchParams: accessorDescriptor(getSearchParams),\n    // `URL.prototype.hash` accessors pair\n    // https://url.spec.whatwg.org/#dom-url-hash\n    hash: accessorDescriptor(getHash, function (hash) {\n      var url = getInternalURLState(this);\n      hash = String(hash);\n      if (hash == '') {\n        url.fragment = null;\n        return;\n      }\n      if ('#' == hash.charAt(0)) hash = hash.slice(1);\n      url.fragment = '';\n      parseURL(url, hash, FRAGMENT);\n    })\n  });\n}\n\n// `URL.prototype.toJSON` method\n// https://url.spec.whatwg.org/#dom-url-tojson\nredefine(URLPrototype, 'toJSON', function toJSON() {\n  return serializeURL.call(this);\n}, { enumerable: true });\n\n// `URL.prototype.toString` method\n// https://url.spec.whatwg.org/#URL-stringification-behavior\nredefine(URLPrototype, 'toString', function toString() {\n  return serializeURL.call(this);\n}, { enumerable: true });\n\nif (NativeURL) {\n  var nativeCreateObjectURL = NativeURL.createObjectURL;\n  var nativeRevokeObjectURL = NativeURL.revokeObjectURL;\n  // `URL.createObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/createObjectURL\n  // eslint-disable-next-line no-unused-vars\n  if (nativeCreateObjectURL) redefine(URLConstructor, 'createObjectURL', function createObjectURL(blob) {\n    return nativeCreateObjectURL.apply(NativeURL, arguments);\n  });\n  // `URL.revokeObjectURL` method\n  // https://developer.mozilla.org/en-US/docs/Web/API/URL/revokeObjectURL\n  // eslint-disable-next-line no-unused-vars\n  if (nativeRevokeObjectURL) redefine(URLConstructor, 'revokeObjectURL', function revokeObjectURL(url) {\n    return nativeRevokeObjectURL.apply(NativeURL, arguments);\n  });\n}\n\nsetToStringTag(URLConstructor, 'URL');\n\n$({ global: true, forced: !USE_NATIVE_URL, sham: !DESCRIPTORS }, {\n  URL: URLConstructor\n});\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    cacheHas = require('./_cacheHas'),\n    createSet = require('./_createSet'),\n    setToArray = require('./_setToArray');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseUniq;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory');\n\n\nmodule.exports = function(group, element, translate) {\n  if (is(element, 'camunda:Assignable')) {\n\n    // Assignee\n    group.entries.push(entryFactory.textField({\n      id : 'assignee',\n      label : translate('Assignee'),\n      modelProperty : 'assignee'\n    }));\n\n    // Candidate Users\n    group.entries.push(entryFactory.textField({\n      id : 'candidateUsers',\n      label : translate('Candidate Users'),\n      modelProperty : 'candidateUsers'\n    }));\n\n    // Candidate Groups\n    group.entries.push(entryFactory.textField({\n      id : 'candidateGroups',\n      label : translate('Candidate Groups'),\n      modelProperty : 'candidateGroups'\n    }));\n\n    // Due Date\n    group.entries.push(entryFactory.textField({\n      id : 'dueDate',\n      description : translate('The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)'),\n      label : translate('Due Date'),\n      modelProperty : 'dueDate'\n    }));\n\n    // FollowUp Date\n    group.entries.push(entryFactory.textField({\n      id : 'followUpDate',\n      description : translate('The follow up date as an EL expression (e.g. ${someDate} or an ' +\n                    'ISO date (e.g. 2015-06-26T09:54:00)'),\n      label : translate('Follow Up Date'),\n      modelProperty : 'followUpDate'\n    }));\n\n    // priority\n    group.entries.push(entryFactory.textField({\n      id : 'priority',\n      label : translate('Priority'),\n      modelProperty : 'priority'\n    }));\n  }\n};\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","'use strict';\n\nvar listener = require('./implementation/Listener');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var listenerEntry = listener(element, bpmnFactory, {}, translate);\n\n  group.entries = group.entries.concat(listenerEntry.entries);\n\n  return {\n    getSelectedListener: listenerEntry.getSelectedListener\n  };\n\n};\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    utils = require('../../../Utils'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nmodule.exports = function(group, element, translate, options) {\n\n  var description = options && options.description;\n\n  // Id\n  group.entries.push(entryFactory.validationAwareTextField({\n    id: 'id',\n    label: translate('Id'),\n    description: description && translate(description),\n    modelProperty: 'id',\n    getProperty: function(element) {\n      return getBusinessObject(element).id;\n    },\n    setProperty: function(element, properties) {\n\n      element = element.labelTarget || element;\n\n      return cmdHelper.updateProperties(element, properties);\n    },\n    validate: function(element, values) {\n      var idValue = values.id;\n\n      var bo = getBusinessObject(element);\n\n      var idError = utils.isIdValid(bo, idValue, translate);\n\n      return idError ? { id: idError } : {};\n    }\n  }));\n\n};\n","'use strict';\n\nvar domQuery = require('min-dom').query,\n    domClear = require('min-dom').clear,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    forEach = require('lodash/forEach'),\n    domify = require('min-dom').domify,\n    Ids = require('ids').default;\n\nvar SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nvar QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nvar ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nfunction selectedOption(selectBox) {\n  if (selectBox.selectedIndex >= 0) {\n    return selectBox.options[selectBox.selectedIndex].value;\n  }\n}\n\nmodule.exports.selectedOption = selectedOption;\n\n\nfunction selectedType(elementSyntax, inputNode) {\n  var typeSelect = domQuery(elementSyntax, inputNode);\n  return selectedOption(typeSelect);\n}\n\nmodule.exports.selectedType = selectedType;\n\n\n/**\n * Retrieve the root element the document this\n * business object is contained in.\n *\n * @return {ModdleElement}\n */\nfunction getRoot(businessObject) {\n  var parent = businessObject;\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n  return parent;\n}\n\nmodule.exports.getRoot = getRoot;\n\n\n/**\n * filters all elements in the list which have a given type.\n * removes a new list\n */\nfunction filterElementsByType(objectList, type) {\n  var list = objectList || [];\n  var result = [];\n  forEach(list, function(obj) {\n    if (is(obj, type)) {\n      result.push(obj);\n    }\n  });\n  return result;\n}\n\nmodule.exports.filterElementsByType = filterElementsByType;\n\n\nfunction findRootElementsByType(businessObject, referencedType) {\n  var root = getRoot(businessObject);\n\n  return filterElementsByType(root.rootElements, referencedType);\n}\n\nmodule.exports.findRootElementsByType = findRootElementsByType;\n\n\nfunction removeAllChildren(domElement) {\n  while (domElement.firstChild) {\n    domElement.removeChild(domElement.firstChild);\n  }\n}\n\nmodule.exports.removeAllChildren = removeAllChildren;\n\n\n/**\n * adds an empty option to the list\n */\nfunction addEmptyParameter(list) {\n  return list.push({ 'label': '', 'value': '', 'name': '' });\n}\n\nmodule.exports.addEmptyParameter = addEmptyParameter;\n\n\n/**\n * returns a list with all root elements for the given parameter 'referencedType'\n */\nfunction refreshOptionsModel(businessObject, referencedType) {\n  var model = [];\n  var referableObjects = findRootElementsByType(businessObject, referencedType);\n  forEach(referableObjects, function(obj) {\n    model.push({\n      label: (obj.name || '') + ' (id='+obj.id+')',\n      value: obj.id,\n      name: obj.name\n    });\n  });\n  return model;\n}\n\nmodule.exports.refreshOptionsModel = refreshOptionsModel;\n\n\n/**\n * fills the drop down with options\n */\nfunction updateOptionsDropDown(domSelector, businessObject, referencedType, entryNode) {\n  var options = refreshOptionsModel(businessObject, referencedType);\n  addEmptyParameter(options);\n  var selectBox = domQuery(domSelector, entryNode);\n  domClear(selectBox);\n\n  forEach(options, function(option) {\n    var optionEntry = domify('<option value=\"' + escapeHTML(option.value) + '\">' + escapeHTML(option.label) + '</option>');\n    selectBox.appendChild(optionEntry);\n  });\n  return options;\n}\n\nmodule.exports.updateOptionsDropDown = updateOptionsDropDown;\n\n\n/**\n * checks whether the id value is valid\n *\n * @param {ModdleElement} bo\n * @param {String} idValue\n * @param {Function} translate\n *\n * @return {String} error message\n */\nfunction isIdValid(bo, idValue, translate) {\n  var assigned = bo.$model.ids.assigned(idValue);\n\n  var idExists = assigned && assigned !== bo;\n\n  if (!idValue || idExists) {\n    return translate('Element must have an unique id.');\n  }\n\n  return validateId(idValue, translate);\n}\n\nmodule.exports.isIdValid = isIdValid;\n\n\nfunction validateId(idValue, translate) {\n\n  if (containsSpace(idValue)) {\n    return translate('Id must not contain spaces.');\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return translate('Id must not contain prefix.');\n    }\n\n    return translate('Id must be a valid QName.');\n  }\n}\n\nmodule.exports.validateId = validateId;\n\n\nfunction containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}\n\nmodule.exports.containsSpace = containsSpace;\n\n/**\n * generate a semantic id with given prefix\n */\nfunction nextId(prefix) {\n  var ids = new Ids([32,32,1]);\n\n  return ids.nextPrefixed(prefix);\n}\n\nmodule.exports.nextId = nextId;\n\n\nfunction triggerClickEvent(element) {\n  var evt;\n  var eventType = 'click';\n\n  if (document.createEvent) {\n    try {\n      // Chrome, Safari, Firefox\n      evt = new MouseEvent((eventType), { view: window, bubbles: true, cancelable: true });\n    } catch (e) {\n      // IE 11, PhantomJS (wat!)\n      evt = document.createEvent('MouseEvent');\n\n      evt.initEvent((eventType), true, true);\n    }\n    return element.dispatchEvent(evt);\n  } else {\n    // Welcome IE\n    evt = document.createEventObject();\n\n    return element.fireEvent('on' + eventType, evt);\n  }\n}\n\nmodule.exports.triggerClickEvent = triggerClickEvent;\n\n\nfunction escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n\nmodule.exports.escapeHTML = escapeHTML;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This function is like `composeArgs` except that the arguments composition\n * is tailored for `_.partialRight`.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to append to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgsRight(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersIndex = -1,\n      holdersLength = holders.length,\n      rightIndex = -1,\n      rightLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(rangeLength + rightLength),\n      isUncurried = !isCurried;\n\n  while (++argsIndex < rangeLength) {\n    result[argsIndex] = args[argsIndex];\n  }\n  var offset = argsIndex;\n  while (++rightIndex < rightLength) {\n    result[offset + rightIndex] = partials[rightIndex];\n  }\n  while (++holdersIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[offset + holders[holdersIndex]] = args[argsIndex++];\n    }\n  }\n  return result;\n}\n\nmodule.exports = composeArgsRight;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that verifies that an event contains maximum one event definition.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:Event')) {\n      return;\n    }\n\n    const eventDefinitions = node.eventDefinitions || [];\n\n    if (eventDefinitions.length > 1) {\n      reporter.report(node.id, 'Event has multiple event definitions');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","'use strict';\n\nvar isArray = require('lodash/isArray');\nvar isObject = require('lodash/isObject');\n\nvar DROPDOWN_TYPE = 'Dropdown';\n\nvar VALID_TYPES = [ 'String', 'Text', 'Boolean', 'Hidden', DROPDOWN_TYPE ];\n\nvar PROPERTY_TYPE = 'property',\n    CAMUNDA_PROPERTY_TYPE = 'camunda:property',\n    CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n    CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter',\n    CAMUNDA_IN_TYPE = 'camunda:in',\n    CAMUNDA_OUT_TYPE = 'camunda:out',\n    CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey',\n    CAMUNDA_EXECUTION_LISTENER = 'camunda:executionListener',\n    CAMUNDA_FIELD = 'camunda:field';\n\nvar VALID_BINDING_TYPES = [\n  PROPERTY_TYPE,\n  CAMUNDA_PROPERTY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_EXECUTION_LISTENER,\n  CAMUNDA_FIELD\n];\n\n\n/**\n * A element template validator.\n */\nfunction Validator() {\n\n  this._templatesById = {};\n\n  this._validTemplates = [];\n  this._errors = [];\n\n\n  /**\n   * Adds the templates.\n   *\n   * @param {Array<TemplateDescriptor>} templates\n   *\n   * @return {Validator} self\n   */\n  this.addAll = function(templates) {\n\n    if (!isArray(templates)) {\n      this._logError('templates must be []');\n    } else {\n      templates.forEach(this.add, this);\n    }\n\n    return this;\n  };\n\n  /**\n   * Add the given element template, if it is valid.\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Validator} self\n   */\n  this.add = function(template) {\n\n    var err = this._validateTemplate(template);\n\n    if (!err) {\n      this._templatesById[template.id] = template;\n\n      this._validTemplates.push(template);\n    }\n\n    return this;\n  };\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  this._validateTemplate = function(template) {\n\n    var err,\n        id = template.id,\n        appliesTo = template.appliesTo,\n        properties = template.properties,\n        scopes = template.scopes;\n\n    if (!id) {\n      return this._logError('missing template id');\n    }\n\n    if (id in this._templatesById) {\n      return this._logError('template id <' + id + '> already used');\n    }\n\n    if (!isArray(appliesTo)) {\n      err = this._logError('missing appliesTo=[]', template);\n    }\n\n    if (!isArray(properties)) {\n      err = this._logError('missing properties=[]', template);\n    } else {\n      if (!this._validateProperties(properties)) {\n        err = new Error('invalid properties');\n      }\n    }\n\n    if (scopes) {\n      err = this._validateScopes(template, scopes);\n    }\n\n    return err;\n  };\n\n  this._validateScopes = function(template, scopes) {\n\n    var err,\n        scope,\n        scopeName;\n\n    if (!isObject(scopes) || isArray(scopes)) {\n      return this._logError('invalid scopes, should be scopes={}', template);\n    }\n\n    for (scopeName in scopes) {\n      scope = scopes[scopeName];\n\n      if (!isObject(scope) || isArray(scope)) {\n        err = this._logError('invalid scope, should be scope={}', template);\n      }\n\n      if (!isArray(scope.properties)) {\n        err = this._logError(\n          'missing properties=[] in scope <' + scopeName + '>', template\n        );\n      } else {\n        if (!this._validateProperties(scope.properties)) {\n          err = new Error('invalid properties in scope <' + scopeName + '>');\n        }\n      }\n    }\n\n    return err;\n  };\n\n  /**\n   * Validate properties and return false if any is invalid.\n   *\n   * @param {Array<PropertyDescriptor>} properties\n   *\n   * @return {Boolean} true if all properties are valid\n   */\n  this._validateProperties = function(properties) {\n    var validProperties = properties.filter(this._validateProperty, this);\n\n    return properties.length === validProperties.length;\n  };\n\n  /**\n   * Validate property and return false, if there was\n   * a validation error.\n   *\n   * @param {PropertyDescriptor} property\n   *\n   * @return {Boolean} true if property is valid\n   */\n  this._validateProperty = function(property) {\n\n    var type = property.type,\n        binding = property.binding;\n\n    var err;\n\n    var bindingType = binding.type;\n\n    if (VALID_TYPES.indexOf(type) === -1) {\n      err = this._logError(\n        'invalid property type <' + type + '>; ' +\n        'must be any of { ' + VALID_TYPES.join(', ') + ' }'\n      );\n    }\n\n    if (type === DROPDOWN_TYPE && bindingType !== CAMUNDA_EXECUTION_LISTENER) {\n      if (!isArray(property.choices)) {\n        err = this._logError(\n          'must provide choices=[] with ' + DROPDOWN_TYPE + ' type'\n        );\n      } else\n\n      if (!property.choices.every(isDropdownChoiceValid)) {\n        err = this._logError(\n          '{ name, value } must be specified for ' +\n          DROPDOWN_TYPE + ' choices'\n        );\n      }\n    }\n\n    if (!binding) {\n      return this._logError('property missing binding');\n    }\n\n    if (VALID_BINDING_TYPES.indexOf(bindingType) === -1) {\n      err = this._logError(\n        'invalid property.binding type <' + bindingType + '>; ' +\n        'must be any of { ' + VALID_BINDING_TYPES.join(', ') + ' }'\n      );\n    }\n\n    if (bindingType === PROPERTY_TYPE ||\n        bindingType === CAMUNDA_PROPERTY_TYPE ||\n        bindingType === CAMUNDA_INPUT_PARAMETER_TYPE ||\n        bindingType === CAMUNDA_FIELD) {\n\n      if (!binding.name) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires name'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n      if (!binding.source) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires source'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_IN_TYPE) {\n\n      if (!binding.variables && !binding.target) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires ' +\n          'variables or target'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_OUT_TYPE) {\n\n      if (!binding.variables && !binding.source && !binding.sourceExpression) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires ' +\n          'variables, sourceExpression or source'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_EXECUTION_LISTENER) {\n\n      if (type !== 'Hidden') {\n        err = this._logError(\n          'invalid property type <' + type + '> for ' + CAMUNDA_EXECUTION_LISTENER + '; ' +\n          'must be <Hidden>'\n        );\n      }\n    }\n\n    return !err;\n  };\n\n\n  this._logError = function(err, template) {\n\n    if (typeof err === 'string') {\n      if (template) {\n        err = 'template(id: ' + template.id + ') ' + err;\n      }\n\n      err = new Error(err);\n    }\n\n    this._errors.push(err);\n\n    return err;\n  };\n\n  this.getErrors = function() {\n    return this._errors;\n  };\n\n  this.getValidTemplates = function() {\n    return this._validTemplates;\n  };\n}\n\nmodule.exports = Validator;\n\n\n// helpers ///////////////////////////////////\n\nfunction isDropdownChoiceValid(c) {\n  return 'name' in c && 'value' in c;\n}\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    inputOutputHelper = require('../../../../helper/InputOutputHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\n\nfunction getInputOutput(element, insideConnector) {\n  return inputOutputHelper.getInputOutput(element, insideConnector);\n}\n\nfunction getConnector(element) {\n  return inputOutputHelper.getConnector(element);\n}\n\nfunction getInputParameters(element, insideConnector) {\n  return inputOutputHelper.getInputParameters(element, insideConnector);\n}\n\nfunction getOutputParameters(element, insideConnector) {\n  return inputOutputHelper.getOutputParameters(element, insideConnector);\n}\n\nfunction getInputParameter(element, insideConnector, idx) {\n  return inputOutputHelper.getInputParameter(element, insideConnector, idx);\n}\n\nfunction getOutputParameter(element, insideConnector, idx) {\n  return inputOutputHelper.getOutputParameter(element, insideConnector, idx);\n}\n\n\nfunction createElement(type, parent, factory, properties) {\n  return elementHelper.createElement(type, properties, parent, factory);\n}\n\nfunction createInputOutput(parent, bpmnFactory, properties) {\n  return createElement('camunda:InputOutput', parent, bpmnFactory, properties);\n}\n\nfunction createParameter(type, parent, bpmnFactory, properties) {\n  return createElement(type, parent, bpmnFactory, properties);\n}\n\n\nfunction ensureInputOutputSupported(element, insideConnector) {\n  return inputOutputHelper.isInputOutputSupported(element, insideConnector);\n}\n\nfunction ensureOutparameterSupported(element, insideConnector) {\n  return inputOutputHelper.areOutputParametersSupported(element, insideConnector);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var TYPE_LABEL = {\n    'camunda:Map': translate('Map'),\n    'camunda:List': translate('List'),\n    'camunda:Script': translate('Script')\n  };\n\n  options = options || {};\n\n  var insideConnector = !!options.insideConnector,\n      idPrefix = options.idPrefix || '';\n\n  var getSelected = function(element, node) {\n    var selection = (inputEntry && inputEntry.getSelected(element, node)) || { idx: -1 };\n\n    var parameter = getInputParameter(element, insideConnector, selection.idx);\n    if (!parameter && outputEntry) {\n      selection = outputEntry.getSelected(element, node);\n      parameter = getOutputParameter(element, insideConnector, selection.idx);\n    }\n    return parameter;\n  };\n\n  var result = {\n    getSelectedParameter: getSelected\n  };\n\n  var entries = result.entries = [];\n\n  if (!ensureInputOutputSupported(element)) {\n    return result;\n  }\n\n  var newElement = function(type, prop, factory) {\n\n    return function(element, extensionElements, value) {\n      var commands = [];\n\n      var inputOutput = getInputOutput(element, insideConnector);\n      if (!inputOutput) {\n        var parent = !insideConnector ? extensionElements : getConnector(element);\n        inputOutput = createInputOutput(parent, bpmnFactory, {\n          inputParameters: [],\n          outputParameters: []\n        });\n\n        if (!insideConnector) {\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            extensionElements,\n            'values',\n            'extensionElements',\n            [ inputOutput ],\n            []\n          ));\n        } else {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { inputOutput: inputOutput }));\n        }\n      }\n\n      var newElem = createParameter(type, inputOutput, bpmnFactory, { name: value });\n      commands.push(cmdHelper.addElementsTolist(element, inputOutput, prop, [ newElem ]));\n\n      return commands;\n    };\n  };\n\n  var removeElement = function(getter, prop, otherProp) {\n    return function(element, extensionElements, value, idx) {\n      var inputOutput = getInputOutput(element, insideConnector);\n      var parameter = getter(element, insideConnector, idx);\n\n      var commands = [];\n      commands.push(cmdHelper.removeElementsFromList(element, inputOutput, prop, null, [ parameter ]));\n\n      var firstLength = inputOutput.get(prop).length-1;\n      var secondLength = (inputOutput.get(otherProp) || []).length;\n\n      if (!firstLength && !secondLength) {\n\n        if (!insideConnector) {\n          commands.push(extensionElementsHelper.removeEntry(getBusinessObject(element), element, inputOutput));\n        } else {\n          var connector = getConnector(element);\n          commands.push(cmdHelper.updateBusinessObject(element, connector, { inputOutput: undefined }));\n        }\n\n      }\n\n      return commands;\n    };\n  };\n\n  var setOptionLabelValue = function(getter) {\n    return function(element, node, option, property, value, idx) {\n      var parameter = getter(element, insideConnector, idx);\n\n      var suffix = 'Text';\n\n      var definition = parameter.get('definition');\n      if (typeof definition !== 'undefined') {\n        var type = definition.$type;\n        suffix = TYPE_LABEL[type];\n      }\n\n      option.text = (value || '') + ' : ' + suffix;\n    };\n  };\n\n\n  // input parameters ///////////////////////////////////////////////////////////////\n\n  var inputEntry = extensionElementsEntry(element, bpmnFactory, {\n    id: idPrefix + 'inputs',\n    label: translate('Input Parameters'),\n    modelProperty: 'name',\n    prefix: 'Input',\n    resizable: true,\n\n    createExtensionElement: newElement('camunda:InputParameter', 'inputParameters'),\n    removeExtensionElement: removeElement(getInputParameter, 'inputParameters', 'outputParameters'),\n\n    getExtensionElements: function(element) {\n      return getInputParameters(element, insideConnector);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outputEntry && outputEntry.deselect(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(getInputParameter)\n\n  });\n  entries.push(inputEntry);\n\n\n  // output parameters ///////////////////////////////////////////////////////\n\n  if (ensureOutparameterSupported(element, insideConnector)) {\n    var outputEntry = extensionElementsEntry(element, bpmnFactory, {\n      id: idPrefix + 'outputs',\n      label: translate('Output Parameters'),\n      modelProperty: 'name',\n      prefix: 'Output',\n      resizable: true,\n\n      createExtensionElement: newElement('camunda:OutputParameter', 'outputParameters'),\n      removeExtensionElement: removeElement(getOutputParameter, 'outputParameters', 'inputParameters'),\n\n      getExtensionElements: function(element) {\n        return getOutputParameters(element, insideConnector);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        inputEntry.deselect(element, node);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(getOutputParameter)\n\n    });\n    entries.push(outputEntry);\n  }\n\n  return result;\n\n};\n","var LazyWrapper = require('./_LazyWrapper'),\n    getData = require('./_getData'),\n    getFuncName = require('./_getFuncName'),\n    lodash = require('./wrapperLodash');\n\n/**\n * Checks if `func` has a lazy counterpart.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n *  else `false`.\n */\nfunction isLaziable(func) {\n  var funcName = getFuncName(func),\n      other = lodash[funcName];\n\n  if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n    return false;\n  }\n  if (func === other) {\n    return true;\n  }\n  var data = getData(other);\n  return !!data && func === data[0];\n}\n\nmodule.exports = isLaziable;\n","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks the presence of an end event per scope.\n */\nmodule.exports = function() {\n\n  function hasEndEvent(node) {\n    const flowElements = node.flowElements || [];\n\n    return (\n      flowElements.some(node => is(node, 'bpmn:EndEvent'))\n    );\n  }\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Process',\n      'bpmn:SubProcess'\n    ])) {\n      return;\n    }\n\n    if (!hasEndEvent(node)) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' is missing end event');\n    }\n  }\n\n  return { check };\n};\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var historyTimeToLiveEntry = entryFactory.textField({\n    id: 'historyTimeToLive',\n    label: translate('History Time To Live'),\n    modelProperty: 'historyTimeToLive',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var historyTimeToLive = bo.get('camunda:historyTimeToLive');\n\n      return {\n        historyTimeToLive: historyTimeToLive ? historyTimeToLive : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:historyTimeToLive': values.historyTimeToLive || undefined\n      });\n    }\n\n  });\n\n  return [ historyTimeToLiveEntry ];\n};\n","'use strict';\nvar charAt = require('../internals/string-multibyte').charAt;\nvar InternalStateModule = require('../internals/internal-state');\nvar defineIterator = require('../internals/define-iterator');\n\nvar STRING_ITERATOR = 'String Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalState = InternalStateModule.getterFor(STRING_ITERATOR);\n\n// `String.prototype[@@iterator]` method\n// https://tc39.github.io/ecma262/#sec-string.prototype-@@iterator\ndefineIterator(String, 'String', function (iterated) {\n  setInternalState(this, {\n    type: STRING_ITERATOR,\n    string: String(iterated),\n    index: 0\n  });\n// `%StringIteratorPrototype%.next` method\n// https://tc39.github.io/ecma262/#sec-%stringiteratorprototype%.next\n}, function next() {\n  var state = getInternalState(this);\n  var string = state.string;\n  var index = state.index;\n  var point;\n  if (index >= string.length) return { value: undefined, done: true };\n  point = charAt(string, index);\n  state.index += point.length;\n  return { value: point, done: false };\n});\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks that start events inside a normal sub-processes\n * are blank (do not have an event definition).\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SubProcess') || node.triggeredByEvent) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    flowElements.forEach(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      if (eventDefinitions.length > 0) {\n        reporter.report(flowElement.id, 'Start event must be blank');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};","'use strict';\n\nvar utils = require('./utils');\nvar formats = require('./formats');\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) { // eslint-disable-line func-name-matching\n        return prefix + '[]';\n    },\n    indices: function indices(prefix, key) { // eslint-disable-line func-name-matching\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) { // eslint-disable-line func-name-matching\n        return prefix;\n    }\n};\n\nvar toISO = Date.prototype.toISOString;\n\nvar defaults = {\n    delimiter: '&',\n    encode: true,\n    encoder: utils.encode,\n    encodeValuesOnly: false,\n    serializeDate: function serializeDate(date) { // eslint-disable-line func-name-matching\n        return toISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false\n};\n\nvar stringify = function stringify( // eslint-disable-line func-name-matching\n    object,\n    prefix,\n    generateArrayPrefix,\n    strictNullHandling,\n    skipNulls,\n    encoder,\n    filter,\n    sort,\n    allowDots,\n    serializeDate,\n    formatter,\n    encodeValuesOnly\n) {\n    var obj = object;\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = serializeDate(obj);\n    } else if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ? encoder(prefix, defaults.encoder) : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (typeof obj === 'string' || typeof obj === 'number' || typeof obj === 'boolean' || utils.isBuffer(obj)) {\n        if (encoder) {\n            var keyValue = encodeValuesOnly ? prefix : encoder(prefix, defaults.encoder);\n            return [formatter(keyValue) + '=' + formatter(encoder(obj, defaults.encoder))];\n        }\n        return [formatter(prefix) + '=' + formatter(String(obj))];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (Array.isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        if (Array.isArray(obj)) {\n            values = values.concat(stringify(\n                obj[key],\n                generateArrayPrefix(prefix, key),\n                generateArrayPrefix,\n                strictNullHandling,\n                skipNulls,\n                encoder,\n                filter,\n                sort,\n                allowDots,\n                serializeDate,\n                formatter,\n                encodeValuesOnly\n            ));\n        } else {\n            values = values.concat(stringify(\n                obj[key],\n                prefix + (allowDots ? '.' + key : '[' + key + ']'),\n                generateArrayPrefix,\n                strictNullHandling,\n                skipNulls,\n                encoder,\n                filter,\n                sort,\n                allowDots,\n                serializeDate,\n                formatter,\n                encodeValuesOnly\n            ));\n        }\n    }\n\n    return values;\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = opts ? utils.assign({}, opts) : {};\n\n    if (options.encoder !== null && options.encoder !== undefined && typeof options.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    var delimiter = typeof options.delimiter === 'undefined' ? defaults.delimiter : options.delimiter;\n    var strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n    var skipNulls = typeof options.skipNulls === 'boolean' ? options.skipNulls : defaults.skipNulls;\n    var encode = typeof options.encode === 'boolean' ? options.encode : defaults.encode;\n    var encoder = typeof options.encoder === 'function' ? options.encoder : defaults.encoder;\n    var sort = typeof options.sort === 'function' ? options.sort : null;\n    var allowDots = typeof options.allowDots === 'undefined' ? false : options.allowDots;\n    var serializeDate = typeof options.serializeDate === 'function' ? options.serializeDate : defaults.serializeDate;\n    var encodeValuesOnly = typeof options.encodeValuesOnly === 'boolean' ? options.encodeValuesOnly : defaults.encodeValuesOnly;\n    if (typeof options.format === 'undefined') {\n        options.format = formats['default'];\n    } else if (!Object.prototype.hasOwnProperty.call(formats.formatters, options.format)) {\n        throw new TypeError('Unknown format option provided.');\n    }\n    var formatter = formats.formatters[options.format];\n    var objKeys;\n    var filter;\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (Array.isArray(options.filter)) {\n        filter = options.filter;\n        objKeys = filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var arrayFormat;\n    if (options.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = options.arrayFormat;\n    } else if ('indices' in options) {\n        arrayFormat = options.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = 'indices';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[arrayFormat];\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (sort) {\n        objKeys.sort(sort);\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        keys = keys.concat(stringify(\n            obj[key],\n            key,\n            generateArrayPrefix,\n            strictNullHandling,\n            skipNulls,\n            encode ? encoder : null,\n            filter,\n            sort,\n            allowDots,\n            serializeDate,\n            formatter,\n            encodeValuesOnly\n        ));\n    }\n\n    var joined = keys.join(delimiter);\n    var prefix = options.addQueryPrefix === true ? '?' : '';\n\n    return joined.length > 0 ? prefix + joined : '';\n};\n","var baseAssignValue = require('./_baseAssignValue'),\n    createAggregator = require('./_createAggregator');\n\n/**\n * Creates an object composed of keys generated from the results of running\n * each element of `collection` thru `iteratee`. The corresponding value of\n * each key is the last element responsible for generating the key. The\n * iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n * @returns {Object} Returns the composed aggregate object.\n * @example\n *\n * var array = [\n *   { 'dir': 'left', 'code': 97 },\n *   { 'dir': 'right', 'code': 100 }\n * ];\n *\n * _.keyBy(array, function(o) {\n *   return String.fromCharCode(o.code);\n * });\n * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n *\n * _.keyBy(array, 'dir');\n * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n */\nvar keyBy = createAggregator(function(result, value, key) {\n  baseAssignValue(result, key, value);\n});\n\nmodule.exports = keyBy;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","'use strict';\n\nvar stringify = require('./stringify');\nvar parse = require('./parse');\nvar formats = require('./formats');\n\nmodule.exports = {\n    formats: formats,\n    parse: parse,\n    stringify: stringify\n};\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    InputOutputHelper = require('../../../helper/InputOutputHelper');\n\nvar utils = require('../../../Utils'),\n    escapeHTML = utils.escapeHTML,\n    triggerClickEvent = utils.triggerClickEvent;\n\nvar implementationType = require('./implementation/ImplementationType'),\n    delegate = require('./implementation/Delegate'),\n    external = require('./implementation/External'),\n    callable = require('./implementation/Callable'),\n    resultVariable = require('./implementation/ResultVariable');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domClasses = require('min-dom').classes;\n\nfunction getImplementationType(element) {\n  return ImplementationTypeHelper.getImplementationType(element);\n}\n\nfunction getBusinessObject(element) {\n  return ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n}\n\nfunction isDmnCapable(element) {\n  return ImplementationTypeHelper.isDmnCapable(element);\n}\n\nfunction isExternalCapable(element) {\n  return ImplementationTypeHelper.isExternalCapable(element);\n}\n\nfunction isServiceTaskLike(element) {\n  return ImplementationTypeHelper.isServiceTaskLike(element);\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!isServiceTaskLike(getBusinessObject(element))) {\n    return;\n  }\n\n  var hasDmnSupport = isDmnCapable(element);\n  var hasExternalSupport = isExternalCapable(getBusinessObject(element));\n\n  // implementation type ////////////////////////////////////\n\n  group.entries = group.entries.concat(implementationType(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType,\n    hasDmnSupport: hasDmnSupport,\n    hasExternalSupport: hasExternalSupport,\n    hasServiceTaskLikeSupport: true\n  }, translate));\n\n\n  // delegate (class, expression, delegateExpression) //////////\n\n  group.entries = group.entries.concat(delegate(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType\n  }, translate));\n\n\n  // result variable /////////////////////////////////////////\n\n  group.entries = group.entries.concat(resultVariable(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType,\n    hideResultVariable: function(element, node) {\n      return getImplementationType(element) !== 'expression';\n    }\n  }, translate));\n\n  // external //////////////////////////////////////////////////\n\n  if (hasExternalSupport) {\n    group.entries = group.entries.concat(external(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject,\n      getImplementationType: getImplementationType\n    }, translate));\n  }\n\n\n  // dmn ////////////////////////////////////////////////////////\n\n  if (hasDmnSupport) {\n    group.entries = group.entries.concat(callable(element, bpmnFactory, {\n      getCallableType: getImplementationType\n    }, translate));\n  }\n\n\n  // connector ////////////////////////////////////////////////\n\n  var isConnector = function(element) {\n    return getImplementationType(element) === 'connector';\n  };\n\n  group.entries.push(entryFactory.link({\n    id: 'configureConnectorLink',\n    label: translate('Configure Connector'),\n    handleClick: function(element, node, event) {\n\n      var connectorTabEl = getTabNode(node, 'connector');\n\n      if (connectorTabEl) {\n        triggerClickEvent(connectorTabEl);\n      }\n\n      // suppress actual link click\n      return false;\n    },\n    showLink: function(element, node) {\n      var link = domQuery('a', node);\n      link.textContent = '';\n\n      domClasses(link).remove('bpp-error-message');\n\n      if (isConnector(element)) {\n        var connectorId = InputOutputHelper.getConnector(element).get('connectorId');\n        if (connectorId) {\n          link.textContent = translate('Configure Connector');\n        } else {\n          link.innerHTML = '<span class=\"bpp-icon-warning\"></span> ' + escapeHTML(translate('Must configure Connector'));\n          domClasses(link).add('bpp-error-message');\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n  }));\n\n};\n\n\n\n// helpers ///////////////////////////\n\nfunction getTabNode(el, id) {\n  var containerEl = domClosest(el, '.bpp-properties-panel');\n\n  return domQuery('a[data-tab-target=\"' + id + '\"]', containerEl);\n}","/**\n * The function whose prototype chain sequence wrappers inherit from.\n *\n * @private\n */\nfunction baseLodash() {\n  // No operation performed.\n}\n\nmodule.exports = baseLodash;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getTemplate = require('../Helper').getTemplate,\n    getTemplateId = require('../Helper').getTemplateId;\n\nvar find = require('lodash/find');\n\nvar TEMPLATE_ATTR = require('../Helper').TEMPLATE_ATTR;\n\nfunction isAny(element, types) {\n  return types.reduce(function(result, type) {\n    return result || is(element, type);\n  }, false);\n}\n\n\nmodule.exports = function(group, element, elementTemplates, translate) {\n\n  var options = getTemplateOptions(element, elementTemplates, translate);\n\n  if (options.length === 1 && !options[0].isDefault) {\n    return;\n  }\n\n  // select element template (via dropdown)\n  group.entries.push(entryFactory.selectBox({\n    id: 'elementTemplate-chooser',\n    label: translate('Element Template'),\n    modelProperty: 'camunda:modelerTemplate',\n    selectOptions: options,\n    set: function(element, properties) {\n      return applyTemplate(element, properties[TEMPLATE_ATTR], elementTemplates);\n    },\n    disabled: function() {\n      var template = getTemplate(element, elementTemplates);\n\n      return template && isDefaultTemplate(template);\n    }\n  }));\n\n};\n\n\n// helpers //////////////////////////////////////\n\nfunction applyTemplate(element, newTemplateId, elementTemplates) {\n\n  // cleanup\n  // clear input output mappings\n  // undo changes to properties defined in template\n\n  // re-establish\n  // set input output mappings\n  // apply changes to properties as defined in new template\n\n  var oldTemplate = getTemplate(element, elementTemplates),\n      newTemplate = elementTemplates.get(newTemplateId);\n\n  if (oldTemplate === newTemplate) {\n    return;\n  }\n\n  return {\n    cmd: 'propertiesPanel.camunda.changeTemplate',\n    context: {\n      element: element,\n      oldTemplate: oldTemplate,\n      newTemplate: newTemplate\n    }\n  };\n}\n\nfunction getTemplateOptions(element, elementTemplates, translate) {\n\n  var currentTemplateId = getTemplateId(element);\n\n  var emptyOption = {\n    name: '',\n    value: ''\n  };\n\n  var allOptions = elementTemplates.getAll().reduce(function(templates, t) {\n    if (!isAny(element, t.appliesTo)) {\n      return templates;\n    }\n\n    return templates.concat({\n      name: translate(t.name),\n      value: t.id,\n      isDefault: t.isDefault\n    });\n  }, [ emptyOption ]);\n\n\n  var defaultOption = find(allOptions, function(option) {\n    return isDefaultTemplate(option);\n  });\n\n  var currentOption = find(allOptions, function(option) {\n    return option.value === currentTemplateId;\n  });\n\n  if (currentTemplateId && !currentOption) {\n    currentOption = unknownTemplate(currentTemplateId, translate);\n\n    allOptions.push(currentOption);\n  }\n\n  if (!defaultOption) {\n\n    // return all options, including empty\n    // and optionally unknownTemplate option\n    return allOptions;\n  }\n\n  // special limited handling for\n  // default options\n\n  var options = [];\n\n  // current template not set\n  if (!currentTemplateId) {\n    options.push({\n      name: '',\n      value: ''\n    });\n  }\n\n  // current template not default\n  if (currentOption && currentOption !== defaultOption) {\n    options.push(currentOption);\n  }\n\n  options.push(defaultOption);\n\n  // [ (empty), (current), defaultOption ]\n  return options;\n}\n\nfunction unknownTemplate(templateId, translate) {\n  return {\n    name: translate('[unknown template: {templateId}]', { templateId: templateId }),\n    value: templateId\n  };\n}\n\nfunction isDefaultTemplate(elementTemplate) {\n  return elementTemplate.isDefault;\n}","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    createHybrid = require('./_createHybrid'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/**\n * Creates a function that wraps `func` to enable currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {number} arity The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCurry(func, bitmask, arity) {\n  var Ctor = createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length,\n        placeholder = getHolder(wrapper);\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n      ? []\n      : replaceHolders(args, placeholder);\n\n    length -= holders.length;\n    if (length < arity) {\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, undefined,\n        args, holders, undefined, undefined, arity - length);\n    }\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return apply(fn, this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createCurry;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIsNaN = require('./_baseIsNaN'),\n    strictIndexOf = require('./_strictIndexOf');\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nmodule.exports = baseIndexOf;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{attrs:{\"id\":\"editor\"}},[_c('el-container',[_c('el-header',{attrs:{\"height\":\"36px\"}},[_c('el-button-group',[_c('el-button',{staticClass:\"el-icon-top-left\",attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.handleImportButton}},[_vm._v(\" 导入 \"),_c('fileLoader',{attrs:{\"id\":\"fileLoader\"},on:{\"loadFile\":_vm.loadBpmnFromFile}})],1),_c('el-dropdown',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"}},[_vm._v(\" 下载 \"),_c('i',{staticClass:\"el-icon-bottom-right\"})]),_c('el-dropdown-menu',{attrs:{\"slot\":\"dropdown\"},slot:\"dropdown\"},[_c('el-dropdown-item',[_c('a',{on:{\"click\":_vm.downloadBpmnToFile}},[_vm._v(\"下载.bpmn文件\")])]),_c('el-dropdown-item',[_c('a',{on:{\"click\":_vm.downloadBpmnToSVG}},[_vm._v(\"下载.svg文件\")])])],1)],1)],1),_c('el-button-group',[_c('el-button',{staticClass:\"el-icon-magic-stick\",attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.textTransform}},[_vm._v(\"NLP\")])],1),_c('el-button-group',[_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.resetBPMN}},[_vm._v(\"重置\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.checkBPMN}},[_vm._v(\"检查\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.saveBPMN}},[_vm._v(\"保存\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.recoBPMN}},[_vm._v(\"结构推荐\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.showWindow}},[_vm._v(\"语义推荐\")]),_c('el-button',{attrs:{\"type\":\"primary\",\"size\":\"medium\"},on:{\"click\":_vm.showUploadWindow}},[_vm._v(\"上传文件\")])],1)],1),_c('el-main',[_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowSearchWindow),expression:\"isShowSearchWindow\"}]},[_c('Search')],1),_c('div',{directives:[{name:\"show\",rawName:\"v-show\",value:(_vm.isShowUploadWindow),expression:\"isShowUploadWindow\"}]},[_c('FileUpload')],1),_c('div',{staticClass:\"bpmnContainer\"},[_c('div',{ref:\"canvas\",attrs:{\"id\":\"BpmnCanvas\"}}),_c('div',{ref:\"canvas\",attrs:{\"id\":\"BpmnProperties\"}})])])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","import inherits from 'inherits';\n\nimport Ids from 'ids';\n\nimport BaseViewer from './BaseViewer';\n\n\n/**\n * A base modeler for BPMN 2.0 diagrams.\n *\n * Have a look at {@link Modeler} for a bundle that includes actual features.\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function BaseModeler(options) {\n  BaseViewer.call(this, options);\n\n  // hook ID collection into the modeler\n  this.on('import.parse.complete', function(event) {\n    if (!event.error) {\n      this._collectIds(event.definitions, event.context);\n    }\n  }, this);\n\n  this.on('diagram.destroy', function() {\n    this.get('moddle').ids.clear();\n  }, this);\n}\n\ninherits(BaseModeler, BaseViewer);\n\n\n/**\n * Create a moddle instance, attaching ids to it.\n *\n * @param {Object} options\n */\nBaseModeler.prototype._createModdle = function(options) {\n  var moddle = BaseViewer.prototype._createModdle.call(this, options);\n\n  // attach ids to moddle to be able to track\n  // and validated ids in the BPMN 2.0 XML document\n  // tree\n  moddle.ids = new Ids([ 32, 36, 1 ]);\n\n  return moddle;\n};\n\n/**\n * Collect ids processed during parsing of the\n * definitions object.\n *\n * @param {ModdleElement} definitions\n * @param {Context} context\n */\nBaseModeler.prototype._collectIds = function(definitions, context) {\n\n  var moddle = definitions.$model,\n      ids = moddle.ids,\n      id;\n\n  // remove references from previous import\n  ids.clear();\n\n  for (id in context.elementsById) {\n    ids.claim(id, context.elementsById[id]);\n  }\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport Hammer from 'hammerjs';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar MIN_ZOOM = 0.2,\n    MAX_ZOOM = 4;\n\nvar mouseEvents = [\n  'mousedown',\n  'mouseup',\n  'mouseover',\n  'mouseout',\n  'click',\n  'dblclick'\n];\n\nfunction log() {\n\n  // console.log.apply(console, arguments);\n}\n\nfunction get(service, injector) {\n  return injector.get(service, false);\n}\n\nfunction stopEvent(event) {\n\n  event.preventDefault();\n  event.stopPropagation();\n\n  if (typeof event.stopImmediatePropagation === 'function') {\n    event.stopImmediatePropagation();\n  }\n}\n\n\nfunction createTouchRecognizer(node) {\n\n  function stopMouse(event) {\n\n    forEach(mouseEvents, function(e) {\n      domEvent.bind(node, e, stopEvent, true);\n    });\n  }\n\n  function allowMouse(event) {\n    setTimeout(function() {\n      forEach(mouseEvents, function(e) {\n        domEvent.unbind(node, e, stopEvent, true);\n      });\n    }, 500);\n  }\n\n  domEvent.bind(node, 'touchstart', stopMouse, true);\n  domEvent.bind(node, 'touchend', allowMouse, true);\n  domEvent.bind(node, 'touchcancel', allowMouse, true);\n\n  // A touch event recognizer that handles\n  // touch events only (we know, we can already handle\n  // mouse events out of the box)\n\n  var recognizer = new Hammer.Manager(node, {\n    inputClass: Hammer.TouchInput,\n    recognizers: []\n  });\n\n\n  var tap = new Hammer.Tap();\n  var pan = new Hammer.Pan({ threshold: 10 });\n  var press = new Hammer.Press();\n  var pinch = new Hammer.Pinch();\n\n  var doubleTap = new Hammer.Tap({ event: 'doubletap', taps: 2 });\n\n  pinch.requireFailure(pan);\n  pinch.requireFailure(press);\n\n  recognizer.add([ pan, press, pinch, doubleTap, tap ]);\n\n  recognizer.reset = function(force) {\n    var recognizers = this.recognizers,\n        session = this.session;\n\n    if (session.stopped) {\n      return;\n    }\n\n    log('recognizer', 'stop');\n\n    recognizer.stop(force);\n\n    setTimeout(function() {\n      var i, r;\n\n      log('recognizer', 'reset');\n      for (i = 0; (r = recognizers[i]); i++) {\n        r.reset();\n        r.state = 8; // FAILED STATE\n      }\n\n      session.curRecognizer = null;\n    }, 0);\n  };\n\n  recognizer.on('hammer.input', function(event) {\n    if (event.srcEvent.defaultPrevented) {\n      recognizer.reset(true);\n    }\n  });\n\n  return recognizer;\n}\n\n/**\n * A plugin that provides touch events for elements.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function TouchInteractionEvents(\n    injector, canvas, eventBus,\n    elementRegistry, interactionEvents) {\n\n  // optional integrations\n  var dragging = get('dragging', injector),\n      move = get('move', injector),\n      contextPad = get('contextPad', injector),\n      palette = get('palette', injector);\n\n  // the touch recognizer\n  var recognizer;\n\n  function handler(type) {\n\n    return function(event) {\n      log('element', type, event);\n\n      interactionEvents.fire(type, event);\n    };\n  }\n\n  function getGfx(target) {\n    var node = domClosest(target, 'svg, .djs-element', true);\n    return node;\n  }\n\n  function initEvents(svg) {\n\n    // touch recognizer\n    recognizer = createTouchRecognizer(svg);\n\n    recognizer.on('doubletap', handler('element.dblclick'));\n\n    recognizer.on('tap', handler('element.click'));\n\n    function startGrabCanvas(event) {\n\n      log('canvas', 'grab start');\n\n      var lx = 0, ly = 0;\n\n      function update(e) {\n\n        var dx = e.deltaX - lx,\n            dy = e.deltaY - ly;\n\n        canvas.scroll({ dx: dx, dy: dy });\n\n        lx = e.deltaX;\n        ly = e.deltaY;\n      }\n\n      function end(e) {\n        recognizer.off('panmove', update);\n        recognizer.off('panend', end);\n        recognizer.off('pancancel', end);\n\n        log('canvas', 'grab end');\n      }\n\n      recognizer.on('panmove', update);\n      recognizer.on('panend', end);\n      recognizer.on('pancancel', end);\n    }\n\n    function startGrab(event) {\n\n      var gfx = getGfx(event.target),\n          element = gfx && elementRegistry.get(gfx);\n\n      // recognizer\n      if (move && canvas.getRootElement() !== element) {\n        log('element', 'move start', element, event, true);\n        return move.start(event, element, true);\n      } else {\n        startGrabCanvas(event);\n      }\n    }\n\n    function startZoom(e) {\n\n      log('canvas', 'zoom start');\n\n      var zoom = canvas.zoom(),\n          mid = e.center;\n\n      function update(e) {\n\n        var ratio = 1 - (1 - e.scale) / 1.50,\n            newZoom = Math.max(MIN_ZOOM, Math.min(MAX_ZOOM, ratio * zoom));\n\n        canvas.zoom(newZoom, mid);\n\n        stopEvent(e);\n      }\n\n      function end(e) {\n        recognizer.off('pinchmove', update);\n        recognizer.off('pinchend', end);\n        recognizer.off('pinchcancel', end);\n\n        recognizer.reset(true);\n\n        log('canvas', 'zoom end');\n      }\n\n      recognizer.on('pinchmove', update);\n      recognizer.on('pinchend', end);\n      recognizer.on('pinchcancel', end);\n    }\n\n    recognizer.on('panstart', startGrab);\n    recognizer.on('press', startGrab);\n\n    recognizer.on('pinchstart', startZoom);\n  }\n\n  if (dragging) {\n\n    // simulate hover during dragging\n    eventBus.on('drag.move', function(event) {\n\n      var originalEvent = event.originalEvent;\n\n      if (!originalEvent || originalEvent instanceof MouseEvent) {\n        return;\n      }\n\n      var position = toPoint(originalEvent);\n\n      // this gets really expensive ...\n      var node = document.elementFromPoint(position.x, position.y),\n          gfx = getGfx(node),\n          element = gfx && elementRegistry.get(gfx);\n\n      if (element !== event.hover) {\n        if (event.hover) {\n          dragging.out(event);\n        }\n\n        if (element) {\n          dragging.hover({ element: element, gfx: gfx });\n\n          event.hover = element;\n          event.hoverGfx = gfx;\n        }\n      }\n    });\n  }\n\n  if (contextPad) {\n\n    eventBus.on('contextPad.create', function(event) {\n      var node = event.pad.html;\n\n      // touch recognizer\n      var padRecognizer = createTouchRecognizer(node);\n\n      padRecognizer.on('panstart', function(event) {\n        log('context-pad', 'panstart', event);\n        contextPad.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('press', function(event) {\n        log('context-pad', 'press', event);\n        contextPad.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('tap', function(event) {\n        log('context-pad', 'tap', event);\n        contextPad.trigger('click', event);\n      });\n    });\n  }\n\n  if (palette) {\n    eventBus.on('palette.create', function(event) {\n      var node = event.container;\n\n      // touch recognizer\n      var padRecognizer = createTouchRecognizer(node);\n\n      padRecognizer.on('panstart', function(event) {\n        log('palette', 'panstart', event);\n        palette.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('press', function(event) {\n        log('palette', 'press', event);\n        palette.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('tap', function(event) {\n        log('palette', 'tap', event);\n        palette.trigger('click', event);\n      });\n    });\n  }\n\n  eventBus.on('canvas.init', function(event) {\n    initEvents(event.svg);\n  });\n}\n\n\nTouchInteractionEvents.$inject = [\n  'injector',\n  'canvas',\n  'eventBus',\n  'elementRegistry',\n  'interactionEvents',\n  'touchFix'\n];\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\n\nexport default function TouchFix(canvas, eventBus) {\n\n  var self = this;\n\n  eventBus.on('canvas.init', function(e) {\n    self.addBBoxMarker(e.svg);\n  });\n}\n\nTouchFix.$inject = [ 'canvas', 'eventBus' ];\n\n\n/**\n * Safari mobile (iOS 7) does not fire touchstart event in <SVG> element\n * if there is no shape between 0,0 and viewport elements origin.\n *\n * So touchstart event is only fired when the <g class=\"viewport\"> element was hit.\n * Putting an element over and below the 'viewport' fixes that behavior.\n */\nTouchFix.prototype.addBBoxMarker = function(svg) {\n\n  var markerStyle = {\n    fill: 'none',\n    class: 'outer-bound-marker'\n  };\n\n  var rect1 = svgCreate('rect');\n  svgAttr(rect1, {\n    x: -10000,\n    y: 10000,\n    width: 10,\n    height: 10\n  });\n  svgAttr(rect1, markerStyle);\n\n  svgAppend(svg, rect1);\n\n  var rect2 = svgCreate('rect');\n  svgAttr(rect2, {\n    x: 10000,\n    y: 10000,\n    width: 10,\n    height: 10\n  });\n  svgAttr(rect2, markerStyle);\n\n  svgAppend(svg, rect2);\n};\n","import InteractionEventsModule from '../interaction-events';\n\nimport TouchInteractionEvents from './TouchInteractionEvents';\nimport TouchFix from './TouchFix';\n\nexport default {\n  __depends__: [ InteractionEventsModule ],\n  __init__: [ 'touchInteractionEvents' ],\n  touchInteractionEvents: [ 'type', TouchInteractionEvents ],\n  touchFix: [ 'type', TouchFix ]\n};","import TouchModule from '../../features/touch';\n\nexport default {\n  __depends__: [\n    TouchModule\n  ]\n};","import {\n  filter,\n  forEach,\n  sortBy\n} from 'min-dash';\n\nfunction last(arr) {\n  return arr && arr[arr.length - 1];\n}\n\nfunction sortTopOrMiddle(element) {\n  return element.y;\n}\n\nfunction sortLeftOrCenter(element) {\n  return element.x;\n}\n\n/**\n * Sorting functions for different types of alignment\n *\n * @type {Object}\n *\n * @return {Function}\n */\nvar ALIGNMENT_SORTING = {\n  left: sortLeftOrCenter,\n  center: sortLeftOrCenter,\n  right: function(element) {\n    return element.x + element.width;\n  },\n  top: sortTopOrMiddle,\n  middle: sortTopOrMiddle,\n  bottom: function(element) {\n    return element.y + element.height;\n  }\n};\n\n\nexport default function AlignElements(modeling) {\n  this._modeling = modeling;\n}\n\nAlignElements.$inject = [ 'modeling' ];\n\n\n/**\n * Get the relevant \"axis\" and \"dimension\" related to the current type of alignment\n *\n * @param  {String} type left|right|center|top|bottom|middle\n *\n * @return {Object} { axis, dimension }\n */\nAlignElements.prototype._getOrientationDetails = function(type) {\n  var vertical = [ 'top', 'bottom', 'middle' ],\n      axis = 'x',\n      dimension = 'width';\n\n  if (vertical.indexOf(type) !== -1) {\n    axis = 'y';\n    dimension = 'height';\n  }\n\n  return {\n    axis: axis,\n    dimension: dimension\n  };\n};\n\nAlignElements.prototype._isType = function(type, types) {\n  return types.indexOf(type) !== -1;\n};\n\n/**\n * Get a point on the relevant axis where elements should align to\n *\n * @param  {String} type left|right|center|top|bottom|middle\n * @param  {Array} sortedElements\n *\n * @return {Object}\n */\nAlignElements.prototype._alignmentPosition = function(type, sortedElements) {\n  var orientation = this._getOrientationDetails(type),\n      axis = orientation.axis,\n      dimension = orientation.dimension,\n      alignment = {},\n      centers = {},\n      hasSharedCenters = false,\n      centeredElements,\n      firstElement,\n      lastElement;\n\n  function getMiddleOrTop(first, last) {\n    return Math.round((first[axis] + last[axis] + last[dimension]) / 2);\n  }\n\n  if (this._isType(type, [ 'left', 'top' ])) {\n    alignment[type] = sortedElements[0][axis];\n\n  } else if (this._isType(type, [ 'right', 'bottom' ])) {\n    lastElement = last(sortedElements);\n\n    alignment[type] = lastElement[axis] + lastElement[dimension];\n\n  } else if (this._isType(type, [ 'center', 'middle' ])) {\n\n    // check if there is a center shared by more than one shape\n    // if not, just take the middle of the range\n    forEach(sortedElements, function(element) {\n      var center = element[axis] + Math.round(element[dimension] / 2);\n\n      if (centers[center]) {\n        centers[center].elements.push(element);\n      } else {\n        centers[center] = {\n          elements: [ element ],\n          center: center\n        };\n      }\n    });\n\n    centeredElements = sortBy(centers, function(center) {\n      if (center.elements.length > 1) {\n        hasSharedCenters = true;\n      }\n\n      return center.elements.length;\n    });\n\n    if (hasSharedCenters) {\n      alignment[type] = last(centeredElements).center;\n\n      return alignment;\n    }\n\n    firstElement = sortedElements[0];\n\n    sortedElements = sortBy(sortedElements, function(element) {\n      return element[axis] + element[dimension];\n    });\n\n    lastElement = last(sortedElements);\n\n    alignment[type] = getMiddleOrTop(firstElement, lastElement);\n  }\n\n  return alignment;\n};\n\n/**\n * Executes the alignment of a selection of elements\n *\n * @param  {Array} elements [description]\n * @param  {String} type left|right|center|top|bottom|middle\n */\nAlignElements.prototype.trigger = function(elements, type) {\n  var modeling = this._modeling;\n\n  var filteredElements = filter(elements, function(element) {\n    return !(element.waypoints || element.host || element.labelTarget);\n  });\n\n  var sortFn = ALIGNMENT_SORTING[type];\n\n  var sortedElements = sortBy(filteredElements, sortFn);\n\n  var alignment = this._alignmentPosition(type, sortedElements);\n\n  modeling.alignElements(sortedElements, alignment);\n};\n","import AlignElements from './AlignElements';\n\nexport default {\n  __init__: [ 'alignElements' ],\n  alignElements: [ 'type', AlignElements ]\n};\n","import { is } from '../../util/ModelUtil';\nimport { isAny } from '../modeling/util/ModelingUtil';\n\nimport {\n  getMid,\n  asTRBL,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  find,\n  reduce\n} from 'min-dash';\n\nvar DEFAULT_HORIZONTAL_DISTANCE = 50;\n\nvar MAX_HORIZONTAL_DISTANCE = 250;\n\n// padding to detect element placement\nvar PLACEMENT_DETECTION_PAD = 10;\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Point}\n */\nexport function getNewShapePosition(source, element) {\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n    return getTextAnnotationPosition(source, element);\n  }\n\n  if (isAny(element, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ])) {\n    return getDataElementPosition(source, element);\n  }\n\n  if (is(element, 'bpmn:FlowNode')) {\n    return getFlowNodePosition(source, element);\n  }\n\n  return getDefaultPosition(source, element);\n}\n\n/**\n * Always try to place element right of source;\n * compute actual distance from previous nodes in flow.\n */\nexport function getFlowNodePosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n  var sourceMid = getMid(source);\n\n  var horizontalDistance = getFlowNodeDistance(source, element);\n\n  var orientation = 'left',\n      rowSize = 80,\n      margin = 30;\n\n  if (is(source, 'bpmn:BoundaryEvent')) {\n    orientation = getOrientation(source, source.host, -25);\n\n    if (orientation.indexOf('top') !== -1) {\n      margin *= -1;\n    }\n  }\n\n  function getVerticalDistance(orient) {\n    if (orient.indexOf('top') != -1) {\n      return -1 * rowSize;\n    } else if (orient.indexOf('bottom') != -1) {\n      return rowSize;\n    } else {\n      return 0;\n    }\n  }\n\n  var position = {\n    x: sourceTrbl.right + horizontalDistance + element.width / 2,\n    y: sourceMid.y + getVerticalDistance(orientation)\n  };\n\n  var escapeDirection = {\n    y: {\n      margin: margin,\n      rowSize: rowSize\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Compute best distance between source and target,\n * based on existing connections to and from source.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n *\n * @return {Number} distance\n */\nexport function getFlowNodeDistance(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  // is connection a reference to consider?\n  function isReference(c) {\n    return is(c, 'bpmn:SequenceFlow');\n  }\n\n  function toTargetNode(weight) {\n\n    return function(shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function(shape) {\n          var shapeTrbl = asTRBL(shape);\n\n          return shapeTrbl.left - sourceTrbl.right;\n        }\n      };\n    };\n  }\n\n  function toSourceNode(weight) {\n    return function(shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function(shape) {\n          var shapeTrbl = asTRBL(shape);\n\n          return sourceTrbl.left - shapeTrbl.right;\n        }\n      };\n    };\n  }\n\n  // we create a list of nodes to take into consideration\n  // for calculating the optimal flow node distance\n  //\n  //   * weight existing target nodes higher than source nodes\n  //   * only take into account individual nodes once\n  //\n  var nodes = reduce([].concat(\n    getTargets(source, isReference).map(toTargetNode(5)),\n    getSources(source, isReference).map(toSourceNode(1))\n  ), function(nodes, node) {\n\n    // filter out shapes connected twice via source or target\n    nodes[node.shape.id + '__weight_' + node.weight] = node;\n\n    return nodes;\n  }, {});\n\n  // compute distances between source and incoming nodes;\n  // group at the same time by distance and expose the\n  // favourite distance as { fav: { count, value } }.\n  var distancesGrouped = reduce(nodes, function(result, node) {\n\n    var shape = node.shape,\n        weight = node.weight,\n        distanceTo = node.distanceTo;\n\n    var fav = result.fav,\n        currentDistance,\n        currentDistanceCount,\n        currentDistanceEntry;\n\n    currentDistance = distanceTo(shape);\n\n    // ignore too far away peers\n    // or non-left to right modeled nodes\n    if (currentDistance < 0 || currentDistance > MAX_HORIZONTAL_DISTANCE) {\n      return result;\n    }\n\n    currentDistanceEntry = result[String(currentDistance)] =\n      result[String(currentDistance)] || {\n        value: currentDistance,\n        count: 0\n      };\n\n    // inc diff count\n    currentDistanceCount = currentDistanceEntry.count += 1 * weight;\n\n    if (!fav || fav.count < currentDistanceCount) {\n      result.fav = currentDistanceEntry;\n    }\n\n    return result;\n  }, { });\n\n\n  if (distancesGrouped.fav) {\n    return distancesGrouped.fav.value;\n  } else {\n    return DEFAULT_HORIZONTAL_DISTANCE;\n  }\n}\n\n\n/**\n * Always try to place text annotations top right of source.\n */\nexport function getTextAnnotationPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var position = {\n    x: sourceTrbl.right + element.width / 2,\n    y: sourceTrbl.top - 50 - element.height / 2\n  };\n\n  var escapeDirection = {\n    y: {\n      margin: -30,\n      rowSize: 20\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Always put element bottom right of source.\n */\nexport function getDataElementPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var position = {\n    x: sourceTrbl.right - 10 + element.width / 2,\n    y: sourceTrbl.bottom + 40 + element.width / 2\n  };\n\n  var escapeDirection = {\n    x: {\n      margin: 30,\n      rowSize: 30\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Always put element right of source per default.\n */\nexport function getDefaultPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var sourceMid = getMid(source);\n\n  // simply put element right next to source\n  return {\n    x: sourceTrbl.right + DEFAULT_HORIZONTAL_DISTANCE + element.width / 2,\n    y: sourceMid.y\n  };\n}\n\n\n/**\n * Returns all connected elements around the given source.\n *\n * This includes:\n *\n *   - connected elements\n *   - host connected elements\n *   - attachers connected elements\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Array<djs.model.Shape>}\n */\nfunction getAutoPlaceClosure(source, element) {\n\n  var allConnected = getConnected(source);\n\n  if (source.host) {\n    allConnected = allConnected.concat(getConnected(source.host));\n  }\n\n  if (source.attachers) {\n    allConnected = allConnected.concat(source.attachers.reduce(function(shapes, attacher) {\n      return shapes.concat(getConnected(attacher));\n    }, []));\n  }\n\n  return allConnected;\n}\n\n/**\n * Return target at given position, if defined.\n *\n * This takes connected elements from host and attachers\n * into account, too.\n */\nexport function getConnectedAtPosition(source, position, element) {\n\n  var bounds = {\n    x: position.x - (element.width / 2),\n    y: position.y - (element.height / 2),\n    width: element.width,\n    height: element.height\n  };\n\n  var closure = getAutoPlaceClosure(source, element);\n\n  return find(closure, function(target) {\n\n    if (target === element) {\n      return false;\n    }\n\n    var orientation = getOrientation(target, bounds, PLACEMENT_DETECTION_PAD);\n\n    return orientation === 'intersect';\n  });\n}\n\n\n/**\n * Returns a new, position for the given element\n * based on the given element that is not occupied\n * by some element connected to source.\n *\n * Take into account the escapeDirection (where to move\n * on positioning clashes) in the computation.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n * @param {Point} position\n * @param {Object} escapeDelta\n *\n * @return {Point}\n */\nexport function deconflictPosition(source, element, position, escapeDelta) {\n\n  function nextPosition(existingElement) {\n\n    var newPosition = {\n      x: position.x,\n      y: position.y\n    };\n\n    [ 'x', 'y' ].forEach(function(axis) {\n\n      var axisDelta = escapeDelta[axis];\n\n      if (!axisDelta) {\n        return;\n      }\n\n      var dimension = axis === 'x' ? 'width' : 'height';\n\n      var margin = axisDelta.margin,\n          rowSize = axisDelta.rowSize;\n\n      if (margin < 0) {\n        newPosition[axis] = Math.min(\n          existingElement[axis] + margin - element[dimension] / 2,\n          position[axis] - rowSize + margin\n        );\n      } else {\n        newPosition[axis] = Math.max(\n          existingTarget[axis] + existingTarget[dimension] + margin + element[dimension] / 2,\n          position[axis] + rowSize + margin\n        );\n      }\n    });\n\n    return newPosition;\n  }\n\n  var existingTarget;\n\n  // deconflict position until free slot is found\n  while ((existingTarget = getConnectedAtPosition(source, position, element))) {\n    position = nextPosition(existingTarget);\n  }\n\n  return position;\n}\n\n\n\n// helpers //////////////////////\n\nfunction noneFilter() {\n  return true;\n}\n\nfunction getConnected(element, connectionFilter) {\n  return [].concat(\n    getTargets(element, connectionFilter),\n    getSources(element, connectionFilter)\n  );\n}\n\nfunction getSources(shape, connectionFilter) {\n\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.incoming.filter(connectionFilter).map(function(c) {\n    return c.source;\n  });\n}\n\nfunction getTargets(shape, connectionFilter) {\n\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.outgoing.filter(connectionFilter).map(function(c) {\n    return c.target;\n  });\n}","import { getNewShapePosition } from './AutoPlaceUtil';\n\n\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AutoPlace(eventBus, modeling) {\n\n  function emit(event, payload) {\n    return eventBus.fire(event, payload);\n  }\n\n\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n  this.append = function(source, shape) {\n\n    emit('autoPlace.start', {\n      source: source,\n      shape: shape\n    });\n\n    // allow others to provide the position\n    var position = emit('autoPlace', {\n      source: source,\n      shape: shape\n    });\n\n    if (!position) {\n      position = getNewShapePosition(source, shape);\n    }\n\n    var newShape = modeling.appendShape(source, shape, position, source.parent);\n\n    emit('autoPlace.end', {\n      source: source,\n      shape: newShape\n    });\n\n    return newShape;\n  };\n\n}\n\nAutoPlace.$inject = [\n  'eventBus',\n  'modeling'\n];","/**\n * Select element after auto placement.\n *\n * @param {EventBus} eventBus\n * @param {Selection} selection\n */\nexport default function AutoPlaceSelectionBehavior(eventBus, selection) {\n\n  eventBus.on('autoPlace.end', 500, function(e) {\n    selection.select(e.shape);\n  });\n\n}\n\nAutoPlaceSelectionBehavior.$inject = [\n  'eventBus',\n  'selection'\n];","import AutoPlace from './AutoPlace';\nimport AutoPlaceSelectionBehavior from './AutoPlaceSelectionBehavior';\n\nexport default {\n  __init__: [ 'autoPlaceSelectionBehavior' ],\n  autoPlace: [ 'type', AutoPlace ],\n  autoPlaceSelectionBehavior: [ 'type', AutoPlaceSelectionBehavior ]\n};","import {\n  forEach,\n  isFunction,\n  isArray,\n  isNumber,\n  isObject\n} from 'min-dash';\n\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A utility that can be used to plug-in into the command execution for\n * extension and/or validation.\n *\n * @param {EventBus} eventBus\n *\n * @example\n *\n * import inherits from 'inherits';\n *\n * import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n *\n * function CommandLogger(eventBus) {\n *   CommandInterceptor.call(this, eventBus);\n *\n *   this.preExecute(function(event) {\n *     console.log('command pre-execute', event);\n *   });\n * }\n *\n * inherits(CommandLogger, CommandInterceptor);\n *\n */\nexport default function CommandInterceptor(eventBus) {\n  this._eventBus = eventBus;\n}\n\nCommandInterceptor.$inject = [ 'eventBus' ];\n\nfunction unwrapEvent(fn, that) {\n  return function(event) {\n    return fn.call(that || null, event.context, event.command, event);\n  };\n}\n\n/**\n * Register an interceptor for a command execution\n *\n * @param {String|Array<String>} [events] list of commands to register on\n * @param {String} [hook] command hook, i.e. preExecute, executed to listen on\n * @param {Number} [priority] the priority on which to hook into the execution\n * @param {Function} handlerFn interceptor to be invoked with (event)\n * @param {Boolean} unwrap if true, unwrap the event and pass (context, command, event) to the\n *                          listener instead\n * @param {Object} [that] Pass context (`this`) to the handler function\n */\nCommandInterceptor.prototype.on = function(events, hook, priority, handlerFn, unwrap, that) {\n\n  if (isFunction(hook) || isNumber(hook)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = hook;\n    hook = null;\n  }\n\n  if (isFunction(priority)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (isObject(unwrap)) {\n    that = unwrap;\n    unwrap = false;\n  }\n\n  if (!isFunction(handlerFn)) {\n    throw new Error('handlerFn must be a function');\n  }\n\n  if (!isArray(events)) {\n    events = [ events ];\n  }\n\n  var eventBus = this._eventBus;\n\n  forEach(events, function(event) {\n\n    // concat commandStack(.event)?(.hook)?\n    var fullEvent = [ 'commandStack', event, hook ].filter(function(e) { return e; }).join('.');\n\n    eventBus.on(fullEvent, priority, unwrap ? unwrapEvent(handlerFn, that) : handlerFn, that);\n  });\n};\n\n\nvar hooks = [\n  'canExecute',\n  'preExecute',\n  'preExecuted',\n  'execute',\n  'executed',\n  'postExecute',\n  'postExecuted',\n  'revert',\n  'reverted'\n];\n\n/*\n * Install hook shortcuts\n *\n * This will generate the CommandInterceptor#(preExecute|...|reverted) methods\n * which will in term forward to CommandInterceptor#on.\n */\nforEach(hooks, function(hook) {\n\n  /**\n   * {canExecute|preExecute|preExecuted|execute|executed|postExecute|postExecuted|revert|reverted}\n   *\n   * A named hook for plugging into the command execution\n   *\n   * @param {String|Array<String>} [events] list of commands to register on\n   * @param {Number} [priority] the priority on which to hook into the execution\n   * @param {Function} handlerFn interceptor to be invoked with (event)\n   * @param {Boolean} [unwrap=false] if true, unwrap the event and pass (context, command, event) to the\n   *                          listener instead\n   * @param {Object} [that] Pass context (`this`) to the handler function\n   */\n  CommandInterceptor.prototype[hook] = function(events, priority, handlerFn, unwrap, that) {\n\n    if (isFunction(events) || isNumber(events)) {\n      that = unwrap;\n      unwrap = handlerFn;\n      handlerFn = priority;\n      priority = events;\n      events = null;\n    }\n\n    this.on(events, hook, priority, handlerFn, unwrap, that);\n  };\n});\n","import inherits from 'inherits';\n\nimport { getBBox as getBoundingBox } from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\nimport {\n  assign,\n  flatten,\n  find,\n  forEach,\n  groupBy,\n  isArray,\n  matchPattern,\n  pick,\n  values\n} from 'min-dash';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An auto resize component that takes care of expanding a parent element\n * if child elements are created or moved close the parents edge.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function AutoResize(eventBus, elementRegistry, modeling, rules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._elementRegistry = elementRegistry;\n  this._modeling = modeling;\n  this._rules = rules;\n\n  var self = this;\n\n  this.postExecuted([ 'shape.create' ], function(event) {\n    var context = event.context,\n        hints = context.hints || {},\n        shape = context.shape,\n        parent = context.parent || context.newParent;\n\n    if (hints.autoResize === false) {\n      return;\n    }\n\n    self._expand([ shape ], parent);\n  });\n\n  this.postExecuted([ 'elements.move' ], function(event) {\n    var context = event.context,\n        elements = flatten(values(context.closure.topLevel)),\n        hints = context.hints;\n\n    var autoResize = hints ? hints.autoResize : true;\n\n    if (autoResize === false) {\n      return;\n    }\n\n    var expandings = groupBy(elements, function(element) {\n      return element.parent.id;\n    });\n\n    forEach(expandings, function(elements, parentId) {\n\n      // optionally filter elements to be considered when resizing\n      if (isArray(autoResize)) {\n        elements = elements.filter(function(element) {\n          return find(autoResize, matchPattern({ id: element.id }));\n        });\n      }\n\n      self._expand(elements, parentId);\n    });\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape;\n\n    if (hints && hints.autoResize === false) {\n      return;\n    }\n\n    if (shape.collapsed) {\n      return;\n    }\n\n    self._expand(shape.children || [], shape);\n  });\n\n  this.postExecuted([ 'shape.resize' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        parent = shape.parent;\n\n    if (hints && hints.autoResize === false) {\n      return;\n    }\n\n    if (parent) {\n      self._expand([ shape ], parent);\n    }\n  });\n\n}\n\nAutoResize.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'modeling',\n  'rules'\n];\n\ninherits(AutoResize, CommandInterceptor);\n\n\n/**\n * Calculate the new bounds of the target shape, given\n * a number of elements have been moved or added into the parent.\n *\n * This method considers the current size, the added elements as well as\n * the provided padding for the new bounds.\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape} target\n */\nAutoResize.prototype._getOptimalBounds = function(elements, target) {\n\n  var offset = this.getOffset(target),\n      padding = this.getPadding(target);\n\n  var elementsTrbl = asTRBL(getBoundingBox(elements)),\n      targetTrbl = asTRBL(target);\n\n  var newTrbl = {};\n\n  if (elementsTrbl.top - targetTrbl.top < padding.top) {\n    newTrbl.top = elementsTrbl.top - offset.top;\n  }\n\n  if (elementsTrbl.left - targetTrbl.left < padding.left) {\n    newTrbl.left = elementsTrbl.left - offset.left;\n  }\n\n  if (targetTrbl.right - elementsTrbl.right < padding.right) {\n    newTrbl.right = elementsTrbl.right + offset.right;\n  }\n\n  if (targetTrbl.bottom - elementsTrbl.bottom < padding.bottom) {\n    newTrbl.bottom = elementsTrbl.bottom + offset.bottom;\n  }\n\n  return asBounds(assign({}, targetTrbl, newTrbl));\n};\n\n\n/**\n * Expand the target shape respecting rules, offset and padding\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape|String} target|targetId\n */\nAutoResize.prototype._expand = function(elements, target) {\n\n  if (typeof target === 'string') {\n    target = this._elementRegistry.get(target);\n  }\n\n  var allowed = this._rules.allowed('element.autoResize', {\n    elements: elements,\n    target: target\n  });\n\n  if (!allowed) {\n    return;\n  }\n\n  // calculate the new bounds\n  var newBounds = this._getOptimalBounds(elements, target);\n\n  if (!boundsChanged(newBounds, target)) {\n    return;\n  }\n\n  var resizeDirections = getResizeDirections(pick(target, [ 'x', 'y', 'width', 'height' ]), newBounds);\n\n  // resize the parent shape\n  this.resize(target, newBounds, {\n    autoResize: resizeDirections\n  });\n\n  var parent = target.parent;\n\n  // recursively expand parent elements\n  if (parent) {\n    this._expand([ target ], parent);\n  }\n};\n\n\n/**\n * Get the amount to expand the given shape in each direction.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getOffset = function(shape) {\n  return { top: 60, bottom: 60, left: 100, right: 100 };\n};\n\n\n/**\n * Get the activation threshold for each side for which\n * resize triggers.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getPadding = function(shape) {\n  return { top: 2, bottom: 2, left: 15, right: 15 };\n};\n\n\n/**\n * Perform the actual resize operation.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n * @param {Object} [hints]\n * @param {string} [hints.autoResize]\n */\nAutoResize.prototype.resize = function(shape, newBounds, hints) {\n  this._modeling.resizeShape(shape, newBounds, null, hints);\n};\n\n\nfunction boundsChanged(newBounds, oldBounds) {\n  return (\n    newBounds.x !== oldBounds.x ||\n    newBounds.y !== oldBounds.y ||\n    newBounds.width !== oldBounds.width ||\n    newBounds.height !== oldBounds.height\n  );\n}\n\n/**\n * Get directions of resize as {n|w|s|e} e.g. \"nw\".\n *\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @returns {string} Resize directions as {n|w|s|e}.\n */\nfunction getResizeDirections(oldBounds, newBounds) {\n  var directions = '';\n\n  oldBounds = asTRBL(oldBounds);\n  newBounds = asTRBL(newBounds);\n\n  if (oldBounds.top > newBounds.top) {\n    directions = directions.concat('n');\n  }\n\n  if (oldBounds.right < newBounds.right) {\n    directions = directions.concat('w');\n  }\n\n  if (oldBounds.bottom < newBounds.bottom) {\n    directions = directions.concat('s');\n  }\n\n  if (oldBounds.left > newBounds.left) {\n    directions = directions.concat('e');\n  }\n\n  return directions;\n}","import AutoResize from 'diagram-js/lib/features/auto-resize/AutoResize';\n\nimport inherits from 'inherits';\n\nimport { is } from '../../util/ModelUtil';\n\n\n/**\n * Sub class of the AutoResize module which implements a BPMN\n * specific resize function.\n */\nexport default function BpmnAutoResize(injector) {\n\n  injector.invoke(AutoResize, this);\n}\n\nBpmnAutoResize.$inject = [\n  'injector'\n];\n\ninherits(BpmnAutoResize, AutoResize);\n\n\n/**\n * Resize shapes and lanes.\n *\n * @param {djs.model.Shape} target\n * @param {Bounds} newBounds\n * @param {Object} hints\n */\nBpmnAutoResize.prototype.resize = function(target, newBounds, hints) {\n\n  if (is(target, 'bpmn:Participant')) {\n    this._modeling.resizeLane(target, newBounds, null, hints);\n  } else {\n    this._modeling.resizeShape(target, newBounds, null, hints);\n  }\n};","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n/**\n * A basic provider that may be extended to implement modeling rules.\n *\n * Extensions should implement the init method to actually add their custom\n * modeling checks. Checks may be added via the #addRule(action, fn) method.\n *\n * @param {EventBus} eventBus\n */\nexport default function RuleProvider(eventBus) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.init();\n}\n\nRuleProvider.$inject = [ 'eventBus' ];\n\ninherits(RuleProvider, CommandInterceptor);\n\n\n/**\n * Adds a modeling rule for the given action, implemented through\n * a callback function.\n *\n * The function will receive the modeling specific action context\n * to perform its check. It must return `false` to disallow the\n * action from happening or `true` to allow the action.\n *\n * A rule provider may pass over the evaluation to lower priority\n * rules by returning return nothing (or <code>undefined</code>).\n *\n * @example\n *\n * ResizableRules.prototype.init = function() {\n *\n *   \\/**\n *    * Return `true`, `false` or nothing to denote\n *    * _allowed_, _not allowed_ and _continue evaluating_.\n *    *\\/\n *   this.addRule('shape.resize', function(context) {\n *\n *     var shape = context.shape;\n *\n *     if (!context.newBounds) {\n *       // check general resizability\n *       if (!shape.resizable) {\n *         return false;\n *       }\n *\n *       // not returning anything (read: undefined)\n *       // will continue the evaluation of other rules\n *       // (with lower priority)\n *       return;\n *     } else {\n *       // element must have minimum size of 10*10 points\n *       return context.newBounds.width > 10 && context.newBounds.height > 10;\n *     }\n *   });\n * };\n *\n * @param {String|Array<String>} actions the identifier for the modeling action to check\n * @param {Number} [priority] the priority at which this rule is being applied\n * @param {Function} fn the callback function that performs the actual check\n */\nRuleProvider.prototype.addRule = function(actions, priority, fn) {\n\n  var self = this;\n\n  if (typeof actions === 'string') {\n    actions = [ actions ];\n  }\n\n  actions.forEach(function(action) {\n\n    self.canExecute(action, priority, function(context, action, event) {\n      return fn(context);\n    }, true);\n  });\n};\n\n/**\n * Implement this method to add new rules during provider initialization.\n */\nRuleProvider.prototype.init = function() {};","import RuleProvider from '../rules/RuleProvider';\n\nimport inherits from 'inherits';\n\n/**\n * This is a base rule provider for the element.autoResize rule.\n */\nexport default function AutoResizeProvider(eventBus) {\n\n  RuleProvider.call(this, eventBus);\n\n  var self = this;\n\n  this.addRule('element.autoResize', function(context) {\n    return self.canResize(context.elements, context.target);\n  });\n}\n\nAutoResizeProvider.$inject = [ 'eventBus' ];\n\ninherits(AutoResizeProvider, RuleProvider);\n\n/**\n * Needs to be implemented by sub classes to allow actual auto resize\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {djs.model.Shape} target\n *\n * @return {Boolean}\n */\nAutoResizeProvider.prototype.canResize = function(elements, target) {\n  return false;\n};","import { is } from '../../util/ModelUtil';\n\nimport inherits from 'inherits';\n\nimport { forEach } from 'min-dash';\n\nimport AutoResizeProvider from 'diagram-js/lib/features/auto-resize/AutoResizeProvider';\n\n\n/**\n * This module is a provider for automatically resizing parent BPMN elements\n */\nexport default function BpmnAutoResizeProvider(eventBus, modeling) {\n  AutoResizeProvider.call(this, eventBus);\n\n  this._modeling = modeling;\n}\n\ninherits(BpmnAutoResizeProvider, AutoResizeProvider);\n\nBpmnAutoResizeProvider.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Check if the given target can be expanded\n *\n * @param  {djs.model.Shape} target\n *\n * @return {boolean}\n */\nBpmnAutoResizeProvider.prototype.canResize = function(elements, target) {\n\n  if (!is(target, 'bpmn:Participant') && !is(target, 'bpmn:Lane') && !(is(target, 'bpmn:SubProcess'))) {\n    return false;\n  }\n\n  var canResize = true;\n\n  forEach(elements, function(element) {\n\n    if (is(element, 'bpmn:Lane') || element.labelTarget) {\n      canResize = false;\n      return;\n    }\n  });\n\n  return canResize;\n};\n","import BpmnAutoResize from './BpmnAutoResize';\nimport BpmnAutoResizeProvider from './BpmnAutoResizeProvider';\n\n\nexport default {\n  __init__: [\n    'bpmnAutoResize',\n    'bpmnAutoResizeProvider'\n  ],\n  bpmnAutoResize: [ 'type', BpmnAutoResize ],\n  bpmnAutoResizeProvider: [ 'type', BpmnAutoResizeProvider ]\n};\n","/* global TouchEvent */\n\nvar round = Math.round;\n\nimport { assign } from 'min-dash';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  getOriginal,\n  toPoint,\n  stopPropagation\n} from '../../util/Event';\n\nimport {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nvar DRAG_ACTIVE_CLS = 'djs-drag-active';\n\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\n\nfunction isTouchEvent(event) {\n\n  // check for TouchEvent being available first\n  // (i.e. not available on desktop Firefox)\n  return typeof TouchEvent !== 'undefined' && event instanceof TouchEvent;\n}\n\nfunction getLength(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n\n/**\n * A helper that fires canvas localized drag events and realizes\n * the general \"drag-and-drop\" look and feel.\n *\n * Calling {@link Dragging#activate} activates dragging on a canvas.\n *\n * It provides the following:\n *\n *   * emits life cycle events, namespaced with a prefix assigned\n *     during dragging activation\n *   * sets and restores the cursor\n *   * sets and restores the selection if elements still exist\n *   * ensures there can be only one drag operation active at a time\n *\n * Dragging may be canceled manually by calling {@link Dragging#cancel}\n * or by pressing ESC.\n *\n *\n * ## Life-cycle events\n *\n * Dragging can be in three different states, off, initialized\n * and active.\n *\n * (1) off: no dragging operation is in progress\n * (2) initialized: a new drag operation got initialized but not yet\n *                  started (i.e. because of no initial move)\n * (3) started: dragging is in progress\n *\n * Eventually dragging will be off again after a drag operation has\n * been ended or canceled via user click or ESC key press.\n *\n * To indicate transitions between these states dragging emits generic\n * life-cycle events with the `drag.` prefix _and_ events namespaced\n * to a prefix choosen by a user during drag initialization.\n *\n * The following events are emitted (appropriately prefixed) via\n * the {@link EventBus}.\n *\n * * `init`\n * * `start`\n * * `move`\n * * `end`\n * * `ended` (dragging already in off state)\n * * `cancel` (only if previously started)\n * * `canceled` (dragging already in off state, only if previously started)\n * * `cleanup`\n *\n *\n * @example\n *\n * function MyDragComponent(eventBus, dragging) {\n *\n *   eventBus.on('mydrag.start', function(event) {\n *     console.log('yes, we start dragging');\n *   });\n *\n *   eventBus.on('mydrag.move', function(event) {\n *     console.log('canvas local coordinates', event.x, event.y, event.dx, event.dy);\n *\n *     // local drag data is passed with the event\n *     event.context.foo; // \"BAR\"\n *\n *     // the original mouse event, too\n *     event.originalEvent; // MouseEvent(...)\n *   });\n *\n *   eventBus.on('element.click', function(event) {\n *     dragging.init(event, 'mydrag', {\n *       cursor: 'grabbing',\n *       data: {\n *         context: {\n *           foo: \"BAR\"\n *         }\n *       }\n *     });\n *   });\n * }\n */\nexport default function Dragging(eventBus, canvas, selection, elementRegistry) {\n\n  var defaultOptions = {\n    threshold: 5,\n    trapClick: true\n  };\n\n  // the currently active drag operation\n  // dragging is active as soon as this context exists.\n  //\n  // it is visually _active_ only when a context.active flag is set to true.\n  var context;\n\n  /* convert a global event into local coordinates */\n  function toLocalPoint(globalPosition) {\n\n    var viewbox = canvas.viewbox();\n\n    var clientRect = canvas._container.getBoundingClientRect();\n\n    return {\n      x: viewbox.x + (globalPosition.x - clientRect.left) / viewbox.scale,\n      y: viewbox.y + (globalPosition.y - clientRect.top) / viewbox.scale\n    };\n  }\n\n  // helpers\n\n  function fire(type, dragContext) {\n    dragContext = dragContext || context;\n\n    var event = eventBus.createEvent(\n      assign(\n        {},\n        dragContext.payload,\n        dragContext.data,\n        { isTouch: dragContext.isTouch }\n      )\n    );\n\n    // default integration\n    if (eventBus.fire('drag.' + type, event) === false) {\n      return false;\n    }\n\n    return eventBus.fire(dragContext.prefix + '.' + type, event);\n  }\n\n  function restoreSelection(previousSelection) {\n    var existingSelection = previousSelection.filter(function(element) {\n      return elementRegistry.get(element.id);\n    });\n\n    existingSelection.length && selection.select(existingSelection);\n  }\n\n  // event listeners\n\n  function move(event, activate) {\n    var payload = context.payload,\n        displacement = context.displacement;\n\n    var globalStart = context.globalStart,\n        globalCurrent = toPoint(event),\n        globalDelta = deltaPos(globalCurrent, globalStart);\n\n    var localStart = context.localStart,\n        localCurrent = toLocalPoint(globalCurrent),\n        localDelta = deltaPos(localCurrent, localStart);\n\n\n    // activate context explicitly or once threshold is reached\n    if (!context.active && (activate || getLength(globalDelta) > context.threshold)) {\n\n      // fire start event with original\n      // starting coordinates\n\n      assign(payload, {\n        x: round(localStart.x + displacement.x),\n        y: round(localStart.y + displacement.y),\n        dx: 0,\n        dy: 0\n      }, { originalEvent: event });\n\n      if (false === fire('start')) {\n        return cancel();\n      }\n\n      context.active = true;\n\n      // unset selection and remember old selection\n      // the previous (old) selection will always passed\n      // with the event via the event.previousSelection property\n      if (!context.keepSelection) {\n        payload.previousSelection = selection.get();\n        selection.select(null);\n      }\n\n      // allow custom cursor\n      if (context.cursor) {\n        cursorSet(context.cursor);\n      }\n\n      // indicate dragging via marker on root element\n      canvas.addMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n    }\n\n    stopPropagation(event);\n\n    if (context.active) {\n\n      // update payload with actual coordinates\n      assign(payload, {\n        x: round(localCurrent.x + displacement.x),\n        y: round(localCurrent.y + displacement.y),\n        dx: round(localDelta.x),\n        dy: round(localDelta.y)\n      }, { originalEvent: event });\n\n      // emit move event\n      fire('move');\n    }\n  }\n\n  function end(event) {\n    var previousContext,\n        returnValue = true;\n\n    if (context.active) {\n\n      if (event) {\n        context.payload.originalEvent = event;\n\n        // suppress original event (click, ...)\n        // because we just ended a drag operation\n        stopPropagation(event);\n      }\n\n      // implementations may stop restoring the\n      // original state (selections, ...) by preventing the\n      // end events default action\n      returnValue = fire('end');\n    }\n\n    if (returnValue === false) {\n      fire('rejected');\n    }\n\n    previousContext = cleanup(returnValue !== true);\n\n    // last event to be fired when all drag operations are done\n    // at this point in time no drag operation is in progress anymore\n    fire('ended', previousContext);\n  }\n\n\n  // cancel active drag operation if the user presses\n  // the ESC key on the keyboard\n\n  function checkCancel(event) {\n\n    if (event.which === 27) {\n      preventDefault(event);\n\n      cancel();\n    }\n  }\n\n\n  // prevent ghost click that might occur after a finished\n  // drag and drop session\n\n  function trapClickAndEnd(event) {\n\n    var untrap;\n\n    // trap the click in case we are part of an active\n    // drag operation. This will effectively prevent\n    // the ghost click that cannot be canceled otherwise.\n    if (context.active) {\n\n      untrap = installClickTrap(eventBus);\n\n      // remove trap after minimal delay\n      setTimeout(untrap, 400);\n\n      // prevent default action (click)\n      preventDefault(event);\n    }\n\n    end(event);\n  }\n\n  function trapTouch(event) {\n    move(event);\n  }\n\n  // update the drag events hover (djs.model.Base) and hoverGfx (Snap<SVGElement>)\n  // properties during hover and out and fire {prefix}.hover and {prefix}.out properties\n  // respectively\n\n  function hover(event) {\n    var payload = context.payload;\n\n    payload.hoverGfx = event.gfx;\n    payload.hover = event.element;\n\n    fire('hover');\n  }\n\n  function out(event) {\n    fire('out');\n\n    var payload = context.payload;\n\n    payload.hoverGfx = null;\n    payload.hover = null;\n  }\n\n\n  // life-cycle methods\n\n  function cancel(restore) {\n    var previousContext;\n\n    if (!context) {\n      return;\n    }\n\n    var wasActive = context.active;\n\n    if (wasActive) {\n      fire('cancel');\n    }\n\n    previousContext = cleanup(restore);\n\n    if (wasActive) {\n\n      // last event to be fired when all drag operations are done\n      // at this point in time no drag operation is in progress anymore\n      fire('canceled', previousContext);\n    }\n  }\n\n  function cleanup(restore) {\n    var previousContext,\n        endDrag;\n\n    fire('cleanup');\n\n    // reset cursor\n    cursorUnset();\n\n    if (context.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    // reset dom listeners\n    domEvent.unbind(document, 'mousemove', move);\n\n    domEvent.unbind(document, 'dragstart', preventDefault);\n    domEvent.unbind(document, 'selectstart', preventDefault);\n\n    domEvent.unbind(document, 'mousedown', endDrag, true);\n    domEvent.unbind(document, 'mouseup', endDrag, true);\n\n    domEvent.unbind(document, 'keyup', checkCancel);\n\n    domEvent.unbind(document, 'touchstart', trapTouch, true);\n    domEvent.unbind(document, 'touchcancel', cancel, true);\n    domEvent.unbind(document, 'touchmove', move, true);\n    domEvent.unbind(document, 'touchend', end, true);\n\n    eventBus.off('element.hover', hover);\n    eventBus.off('element.out', out);\n\n    // remove drag marker on root element\n    canvas.removeMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n\n    // restore selection, unless it has changed\n    var previousSelection = context.payload.previousSelection;\n\n    if (restore !== false && previousSelection && !selection.get().length) {\n      restoreSelection(previousSelection);\n    }\n\n    previousContext = context;\n\n    context = null;\n\n    return previousContext;\n  }\n\n  /**\n   * Initialize a drag operation.\n   *\n   * If `localPosition` is given, drag events will be emitted\n   * relative to it.\n   *\n   * @param {MouseEvent|TouchEvent} [event]\n   * @param {Point} [localPosition] actual diagram local position this drag operation should start at\n   * @param {String} prefix\n   * @param {Object} [options]\n   */\n  function init(event, relativeTo, prefix, options) {\n\n    // only one drag operation may be active, at a time\n    if (context) {\n      cancel(false);\n    }\n\n    if (typeof relativeTo === 'string') {\n      options = prefix;\n      prefix = relativeTo;\n      relativeTo = null;\n    }\n\n    options = assign({}, defaultOptions, options || {});\n\n    var data = options.data || {},\n        originalEvent,\n        globalStart,\n        localStart,\n        endDrag,\n        isTouch;\n\n    if (options.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    if (event) {\n      originalEvent = getOriginal(event) || event;\n      globalStart = toPoint(event);\n\n      stopPropagation(event);\n\n      // prevent default browser dragging behavior\n      if (originalEvent.type === 'dragstart') {\n        preventDefault(originalEvent);\n      }\n    } else {\n      originalEvent = null;\n      globalStart = { x: 0, y: 0 };\n    }\n\n    localStart = toLocalPoint(globalStart);\n\n    if (!relativeTo) {\n      relativeTo = localStart;\n    }\n\n    isTouch = isTouchEvent(originalEvent);\n\n    context = assign({\n      prefix: prefix,\n      data: data,\n      payload: {},\n      globalStart: globalStart,\n      displacement: deltaPos(relativeTo, localStart),\n      localStart: localStart,\n      isTouch: isTouch\n    }, options);\n\n    // skip dom registration if trigger\n    // is set to manual (during testing)\n    if (!options.manual) {\n\n      // add dom listeners\n\n      if (isTouch) {\n        domEvent.bind(document, 'touchstart', trapTouch, true);\n        domEvent.bind(document, 'touchcancel', cancel, true);\n        domEvent.bind(document, 'touchmove', move, true);\n        domEvent.bind(document, 'touchend', end, true);\n      } else {\n\n        // assume we use the mouse to interact per default\n        domEvent.bind(document, 'mousemove', move);\n\n        // prevent default browser drag and text selection behavior\n        domEvent.bind(document, 'dragstart', preventDefault);\n        domEvent.bind(document, 'selectstart', preventDefault);\n\n        domEvent.bind(document, 'mousedown', endDrag, true);\n        domEvent.bind(document, 'mouseup', endDrag, true);\n      }\n\n      domEvent.bind(document, 'keyup', checkCancel);\n\n      eventBus.on('element.hover', hover);\n      eventBus.on('element.out', out);\n    }\n\n    fire('init');\n\n    if (options.autoActivate) {\n      move(event, true);\n    }\n  }\n\n  // cancel on diagram destruction\n  eventBus.on('diagram.destroy', cancel);\n\n\n  // API\n\n  this.init = init;\n  this.move = move;\n  this.hover = hover;\n  this.out = out;\n  this.end = end;\n\n  this.cancel = cancel;\n\n  // for introspection\n\n  this.context = function() {\n    return context;\n  };\n\n  this.setOptions = function(options) {\n    assign(defaultOptions, options);\n  };\n}\n\nDragging.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'elementRegistry'\n];\n","import {\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Browsers may swallow certain events (hover, out ...) if users are to\n * fast with the mouse.\n *\n * @see http://stackoverflow.com/questions/7448468/why-cant-i-reliably-capture-a-mouseout-event\n *\n * The fix implemented in this component ensure that we\n *\n * 1) have a hover state after a successful drag.move event\n * 2) have an out event when dragging leaves an element\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {ElementRegistry} elementRegistry\n */\nexport default function HoverFix(eventBus, dragging, elementRegistry) {\n\n  var self = this;\n\n  /**\n   * Make sure we are god damn hovering!\n   *\n   * @param {Event} dragging event\n   */\n  function ensureHover(event) {\n\n    if (event.hover) {\n      return;\n    }\n\n    var originalEvent = event.originalEvent;\n\n    var gfx = self._findTargetGfx(originalEvent);\n\n    var element = gfx && elementRegistry.get(gfx);\n\n    if (gfx && element) {\n\n      // 1) cancel current mousemove\n      event.stopPropagation();\n\n      // 2) emit fake hover for new target\n      dragging.hover({ element: element, gfx: gfx });\n\n      // 3) re-trigger move event\n      dragging.move(originalEvent);\n    }\n  }\n\n  /**\n   * We wait for a specific sequence of events before\n   * emitting a fake drag.hover event.\n   *\n   * Event Sequence:\n   *\n   * drag.start\n   * drag.move >> ensure we are hovering\n   */\n  eventBus.on('drag.start', function(event) {\n\n    eventBus.once('drag.move', HIGH_PRIORITY, function(event) {\n\n      ensureHover(event);\n\n    });\n\n  });\n\n\n  /**\n   * We make sure that drag.out is always fired, even if the\n   * browser swallows an element.out event.\n   *\n   * Event sequence:\n   *\n   * drag.hover\n   * (element.out >> sometimes swallowed)\n   * element.hover >> ensure we fired drag.out\n   */\n  eventBus.on('drag.init', function() {\n\n    var hover, hoverGfx;\n\n    function setDragHover(event) {\n      hover = event.hover;\n      hoverGfx = event.hoverGfx;\n    }\n\n    function unsetHover() {\n      hover = null;\n      hoverGfx = null;\n    }\n\n    function ensureOut() {\n\n      if (!hover) {\n        return;\n      }\n\n      var element = hover,\n          gfx = hoverGfx;\n\n      hover = null;\n      hoverGfx = null;\n\n      // emit synthetic out event\n      dragging.out({\n        element: element,\n        gfx: gfx\n      });\n    }\n\n    eventBus.on('drag.hover', setDragHover);\n    eventBus.on('element.out', unsetHover);\n    eventBus.on('element.hover', HIGH_PRIORITY, ensureOut);\n\n    eventBus.once('drag.cleanup', function() {\n      eventBus.off('drag.hover', setDragHover);\n      eventBus.off('element.out', unsetHover);\n      eventBus.off('element.hover', ensureOut);\n    });\n\n  });\n\n  this._findTargetGfx = function(event) {\n    var position,\n        target;\n\n    if (!(event instanceof MouseEvent)) {\n      return;\n    }\n\n    position = toPoint(event);\n\n    // damn expensive operation, ouch!\n    target = document.elementFromPoint(position.x, position.y);\n\n    return getGfx(target);\n  };\n\n}\n\nHoverFix.$inject = [\n  'eventBus',\n  'dragging',\n  'elementRegistry'\n];\n\n\n// helpers /////////////////////\n\nfunction getGfx(target) {\n  return domClosest(target, 'svg, .djs-element', true);\n}","import SelectionModule from '../selection';\n\nimport Dragging from './Dragging';\nimport HoverFix from './HoverFix';\n\nexport default {\n  __init__: [\n    'hoverFix'\n  ],\n  __depends__: [\n    SelectionModule\n  ],\n  dragging: [ 'type', Dragging ],\n  hoverFix: [ 'type', HoverFix ]\n};","import { assign } from 'min-dash';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\n/**\n * Initiates canvas scrolling if current cursor point is close to a border.\n * Cancelled when current point moves back inside the scrolling borders\n * or cancelled manually.\n *\n * Default options :\n *   scrollThresholdIn: [ 20, 20, 20, 20 ],\n *   scrollThresholdOut: [ 0, 0, 0, 0 ],\n *   scrollRepeatTimeout: 15,\n *   scrollStep: 10\n *\n * Threshold order:\n *   [ left, top, right, bottom ]\n */\nexport default function AutoScroll(config, eventBus, canvas) {\n\n  this._canvas = canvas;\n\n  this._opts = assign({\n    scrollThresholdIn: [ 20, 20, 20, 20 ],\n    scrollThresholdOut: [ 0, 0, 0, 0 ],\n    scrollRepeatTimeout: 15,\n    scrollStep: 10\n  }, config);\n\n  var self = this;\n\n  eventBus.on('drag.move', function(e) {\n    var point = self._toBorderPoint(e);\n\n    self.startScroll(point);\n  });\n\n  eventBus.on([ 'drag.cleanup' ], function() {\n    self.stopScroll();\n  });\n}\n\nAutoScroll.$inject = [\n  'config.autoScroll',\n  'eventBus',\n  'canvas'\n];\n\n\n/**\n * Starts scrolling loop.\n * Point is given in global scale in canvas container box plane.\n *\n * @param  {Object} point { x: X, y: Y }\n */\nAutoScroll.prototype.startScroll = function(point) {\n\n  var canvas = this._canvas;\n  var opts = this._opts;\n  var self = this;\n\n  var clientRect = canvas.getContainer().getBoundingClientRect();\n\n  var diff = [\n    point.x,\n    point.y,\n    clientRect.width - point.x,\n    clientRect.height - point.y\n  ];\n\n  this.stopScroll();\n\n  var dx = 0,\n      dy = 0;\n\n  for (var i = 0; i < 4; i++) {\n    if (between(diff[i], opts.scrollThresholdOut[i], opts.scrollThresholdIn[i])) {\n      if (i === 0) {\n        dx = opts.scrollStep;\n      } else if (i == 1) {\n        dy = opts.scrollStep;\n      } else if (i == 2) {\n        dx = -opts.scrollStep;\n      } else if (i == 3) {\n        dy = -opts.scrollStep;\n      }\n    }\n  }\n\n  if (dx !== 0 || dy !== 0) {\n    canvas.scroll({ dx: dx, dy: dy });\n\n    this._scrolling = setTimeout(function() {\n      self.startScroll(point);\n    }, opts.scrollRepeatTimeout);\n  }\n};\n\nfunction between(val, start, end) {\n  if (start < val && val < end) {\n    return true;\n  }\n\n  return false;\n}\n\n\n/**\n * Stops scrolling loop.\n */\nAutoScroll.prototype.stopScroll = function() {\n  clearTimeout(this._scrolling);\n};\n\n\n/**\n * Overrides defaults options.\n *\n * @param  {Object} options\n */\nAutoScroll.prototype.setOptions = function(options) {\n  this._opts = assign({}, this._opts, options);\n};\n\n\n/**\n * Converts event to a point in canvas container plane in global scale.\n *\n * @param  {Event} event\n * @return {Point}\n */\nAutoScroll.prototype._toBorderPoint = function(event) {\n  var clientRect = this._canvas._container.getBoundingClientRect();\n\n  var globalPosition = toPoint(event.originalEvent);\n\n  return {\n    x: globalPosition.x - clientRect.left,\n    y: globalPosition.y - clientRect.top\n  };\n};","import DraggingModule from '../dragging';\n\nimport AutoScroll from './AutoScroll';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n  ],\n  __init__: [ 'autoScroll' ],\n  autoScroll: [ 'type', AutoScroll ]\n};","/**\n * A service that provides rules for certain diagram actions.\n *\n * The default implementation will hook into the {@link CommandStack}\n * to perform the actual rule evaluation. Make sure to provide the\n * `commandStack` service with this module if you plan to use it.\n *\n * Together with this implementation you may use the {@link RuleProvider}\n * to implement your own rule checkers.\n *\n * This module is ment to be easily replaced, thus the tiny foot print.\n *\n * @param {Injector} injector\n */\nexport default function Rules(injector) {\n  this._commandStack = injector.get('commandStack', false);\n}\n\nRules.$inject = [ 'injector' ];\n\n\n/**\n * Returns whether or not a given modeling action can be executed\n * in the specified context.\n *\n * This implementation will respond with allow unless anyone\n * objects.\n *\n * @param {String} action the action to be checked\n * @param {Object} [context] the context to check the action in\n *\n * @return {Boolean} returns true, false or null depending on whether the\n *                   operation is allowed, not allowed or should be ignored.\n */\nRules.prototype.allowed = function(action, context) {\n  var allowed = true;\n\n  var commandStack = this._commandStack;\n\n  if (commandStack) {\n    allowed = commandStack.canExecute(action, context);\n  }\n\n  // map undefined to true, i.e. no rules\n  return allowed === undefined ? true : allowed;\n};","import Rules from './Rules';\n\nexport default {\n  __init__: [ 'rules' ],\n  rules: [ 'type', Rules ]\n};\n","import {\n  pointDistance\n} from './Geometry';\n\nimport intersectPaths from 'path-intersection';\n\nvar round = Math.round,\n    max = Math.max;\n\n\nfunction circlePath(center, r) {\n  var x = center.x,\n      y = center.y;\n\n  return [\n    ['M', x, y],\n    ['m', 0, -r],\n    ['a', r, r, 0, 1, 1, 0, 2 * r],\n    ['a', r, r, 0, 1, 1, 0, -2 * r],\n    ['z']\n  ];\n}\n\nfunction linePath(points) {\n  var segments = [];\n\n  points.forEach(function(p, idx) {\n    segments.push([ idx === 0 ? 'M' : 'L', p.x, p.y ]);\n  });\n\n  return segments;\n}\n\n\nvar INTERSECTION_THRESHOLD = 10;\n\nfunction getBendpointIntersection(waypoints, reference) {\n\n  var i, w;\n\n  for (i = 0; (w = waypoints[i]); i++) {\n\n    if (pointDistance(w, reference) <= INTERSECTION_THRESHOLD) {\n      return {\n        point: waypoints[i],\n        bendpoint: true,\n        index: i\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction getPathIntersection(waypoints, reference) {\n\n  var intersections = intersectPaths(circlePath(reference, INTERSECTION_THRESHOLD), linePath(waypoints));\n\n  var a = intersections[0],\n      b = intersections[intersections.length - 1],\n      idx;\n\n  if (!a) {\n\n    // no intersection\n    return null;\n  }\n\n  if (a !== b) {\n\n    if (a.segment2 !== b.segment2) {\n\n      // we use the bendpoint in between both segments\n      // as the intersection point\n\n      idx = max(a.segment2, b.segment2) - 1;\n\n      return {\n        point: waypoints[idx],\n        bendpoint: true,\n        index: idx\n      };\n    }\n\n    return {\n      point: {\n        x: (round(a.x + b.x) / 2),\n        y: (round(a.y + b.y) / 2)\n      },\n      index: a.segment2\n    };\n  }\n\n  return {\n    point: {\n      x: round(a.x),\n      y: round(a.y)\n    },\n    index: a.segment2\n  };\n}\n\n/**\n * Returns the closest point on the connection towards a given reference point.\n *\n * @param  {Array<Point>} waypoints\n * @param  {Point} reference\n *\n * @return {Object} intersection data (segment, point)\n */\nexport function getApproxIntersection(waypoints, reference) {\n  return getBendpointIntersection(waypoints, reference) || getPathIntersection(waypoints, reference);\n}\n","import {\n  toPoint\n} from '../../util/Event';\n\nimport {\n  getMidPoint,\n  pointsAligned\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  rotate,\n  translate\n} from '../../util/SvgTransformUtil';\n\nimport {\n  getApproxIntersection\n} from '../../util/LineIntersection';\n\nexport var BENDPOINT_CLS = 'djs-bendpoint';\nexport var SEGMENT_DRAGGER_CLS = 'djs-segment-dragger';\n\nexport function toCanvasCoordinates(canvas, event) {\n\n  var position = toPoint(event),\n      clientRect = canvas._container.getBoundingClientRect(),\n      offset;\n\n  // canvas relative position\n\n  offset = {\n    x: clientRect.left,\n    y: clientRect.top\n  };\n\n  // update actual event payload with canvas relative measures\n\n  var viewbox = canvas.viewbox();\n\n  return {\n    x: viewbox.x + (position.x - offset.x) / viewbox.scale,\n    y: viewbox.y + (position.y - offset.y) / viewbox.scale\n  };\n}\n\nexport function getConnectionIntersection(canvas, waypoints, event) {\n  var localPosition = toCanvasCoordinates(canvas, event),\n      intersection = getApproxIntersection(waypoints, localPosition);\n\n  return intersection;\n}\n\nexport function addBendpoint(parentGfx, cls) {\n  var groupGfx = svgCreate('g');\n  svgClasses(groupGfx).add(BENDPOINT_CLS);\n\n  svgAppend(parentGfx, groupGfx);\n\n  var visual = svgCreate('circle');\n  svgAttr(visual, {\n    cx: 0,\n    cy: 0,\n    r: 4\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(groupGfx, visual);\n\n  var hit = svgCreate('circle');\n  svgAttr(hit, {\n    cx: 0,\n    cy: 0,\n    r: 10\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(groupGfx, hit);\n\n  if (cls) {\n    svgClasses(groupGfx).add(cls);\n  }\n\n  return groupGfx;\n}\n\nfunction createParallelDragger(parentGfx, segmentStart, segmentEnd, alignment) {\n  var draggerGfx = svgCreate('g');\n\n  svgAppend(parentGfx, draggerGfx);\n\n  var width = 14,\n      height = 3,\n      padding = 6,\n      hitWidth = calculateHitWidth(segmentStart, segmentEnd, alignment),\n      hitHeight = height + padding;\n\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(draggerGfx, visual);\n\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: -hitWidth / 2,\n    y: -hitHeight / 2,\n    width: hitWidth,\n    height: hitHeight\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(draggerGfx, hit);\n\n  rotate(draggerGfx, alignment === 'v' ? 90 : 0, 0, 0);\n\n  return draggerGfx;\n}\n\n\nexport function addSegmentDragger(parentGfx, segmentStart, segmentEnd) {\n\n  var groupGfx = svgCreate('g'),\n      mid = getMidPoint(segmentStart, segmentEnd),\n      alignment = pointsAligned(segmentStart, segmentEnd);\n\n  svgAppend(parentGfx, groupGfx);\n\n  createParallelDragger(groupGfx, segmentStart, segmentEnd, alignment);\n\n  svgClasses(groupGfx).add(SEGMENT_DRAGGER_CLS);\n  svgClasses(groupGfx).add(alignment === 'h' ? 'horizontal' : 'vertical');\n\n  translate(groupGfx, mid.x, mid.y);\n\n  return groupGfx;\n}\n\n/**\n * Calculates region for segment move which is 2/3 of the full segment length\n * @param {Number} segmentLength\n *\n * @return {Number}\n */\nexport function calculateSegmentMoveRegion(segmentLength) {\n  return Math.abs(Math.round(segmentLength * 2 / 3));\n}\n\n// helper //////////\n\nfunction calculateHitWidth(segmentStart, segmentEnd, alignment) {\n  var segmentLengthXAxis = segmentEnd.x - segmentStart.x,\n      segmentLengthYAxis = segmentEnd.y - segmentStart.y;\n\n  return alignment === 'h' ?\n    calculateSegmentMoveRegion(segmentLengthXAxis) :\n    calculateSegmentMoveRegion(segmentLengthYAxis);\n}\n","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import { forEach } from 'min-dash';\n\nimport {\n  event as domEvent,\n  query as domQuery,\n  queryAll as domQueryAll\n} from 'min-dom';\n\nimport {\n  BENDPOINT_CLS,\n  SEGMENT_DRAGGER_CLS,\n  addBendpoint,\n  addSegmentDragger,\n  calculateSegmentMoveRegion,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  escapeCSS\n} from '../../util/EscapeUtil';\n\nimport {\n  pointsAligned,\n  getMidPoint\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\n/**\n * A service that adds editable bendpoints to connections.\n */\nexport default function Bendpoints(\n    eventBus, canvas, interactionEvents,\n    bendpointMove, connectionSegmentMove) {\n\n  /**\n   * Returns true if intersection point is inside middle region of segment, adjusted by\n   * optional threshold\n   */\n  function isIntersectionMiddle(intersection, waypoints, treshold) {\n    var idx = intersection.index,\n        p = intersection.point,\n        p0, p1, mid, aligned, xDelta, yDelta;\n\n    if (idx <= 0 || intersection.bendpoint) {\n      return false;\n    }\n\n    p0 = waypoints[idx - 1];\n    p1 = waypoints[idx];\n    mid = getMidPoint(p0, p1),\n    aligned = pointsAligned(p0, p1);\n    xDelta = Math.abs(p.x - mid.x);\n    yDelta = Math.abs(p.y - mid.y);\n\n    return aligned && xDelta <= treshold && yDelta <= treshold;\n  }\n\n  /**\n   * Calculates the threshold from a connection's middle which fits the two-third-region\n   */\n  function calculateIntersectionThreshold(connection, intersection) {\n    var waypoints = connection.waypoints,\n        relevantSegment, alignment, segmentLength, threshold;\n\n    if (intersection.index <= 0 || intersection.bendpoint) {\n      return null;\n    }\n\n    // segment relative to connection intersection\n    relevantSegment = {\n      start: waypoints[intersection.index - 1],\n      end: waypoints[intersection.index]\n    };\n\n    alignment = pointsAligned(relevantSegment.start, relevantSegment.end);\n\n    if (!alignment) {\n      return null;\n    }\n\n    if (alignment === 'h') {\n      segmentLength = relevantSegment.end.x - relevantSegment.start.x;\n    } else {\n      segmentLength = relevantSegment.end.y - relevantSegment.start.y;\n    }\n\n    // calculate threshold relative to 2/3 of segment length\n    threshold = calculateSegmentMoveRegion(segmentLength) / 2;\n\n    return threshold;\n  }\n\n  function activateBendpointMove(event, connection) {\n    var waypoints = connection.waypoints,\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        threshold;\n\n    if (!intersection) {\n      return;\n    }\n\n    threshold = calculateIntersectionThreshold(connection, intersection);\n\n    if (isIntersectionMiddle(intersection, waypoints, threshold)) {\n      connectionSegmentMove.start(event, connection, intersection.index);\n    } else {\n      bendpointMove.start(event, connection, intersection.index, !intersection.bendpoint);\n    }\n\n    // we've handled the event\n    return true;\n  }\n\n  function bindInteractionEvents(node, eventName, element) {\n\n    domEvent.bind(node, eventName, function(event) {\n      interactionEvents.triggerMouseEvent(eventName, event, element);\n      event.stopPropagation();\n    });\n  }\n\n  function getBendpointsContainer(element, create) {\n\n    var layer = canvas.getLayer('overlays'),\n        gfx = domQuery('.djs-bendpoints[data-element-id=\"' + escapeCSS(element.id) + '\"]', layer);\n\n    if (!gfx && create) {\n      gfx = svgCreate('g');\n      svgAttr(gfx, { 'data-element-id': element.id });\n      svgClasses(gfx).add('djs-bendpoints');\n\n      svgAppend(layer, gfx);\n\n      bindInteractionEvents(gfx, 'mousedown', element);\n      bindInteractionEvents(gfx, 'click', element);\n      bindInteractionEvents(gfx, 'dblclick', element);\n    }\n\n    return gfx;\n  }\n\n  function getSegmentDragger(idx, parentGfx) {\n    return domQuery(\n      '.djs-segment-dragger[data-segment-idx=\"' + idx + '\"]',\n      parentGfx\n    );\n  }\n\n  function createBendpoints(gfx, connection) {\n    connection.waypoints.forEach(function(p, idx) {\n      var bendpoint = addBendpoint(gfx);\n\n      svgAppend(gfx, bendpoint);\n\n      translate(bendpoint, p.x, p.y);\n    });\n\n    // add floating bendpoint\n    addBendpoint(gfx, 'floating');\n  }\n\n  function createSegmentDraggers(gfx, connection) {\n\n    var waypoints = connection.waypoints;\n\n    var segmentStart,\n        segmentEnd,\n        segmentDraggerGfx;\n\n    for (var i = 1; i < waypoints.length; i++) {\n\n      segmentStart = waypoints[i - 1];\n      segmentEnd = waypoints[i];\n\n      if (pointsAligned(segmentStart, segmentEnd)) {\n        segmentDraggerGfx = addSegmentDragger(gfx, segmentStart, segmentEnd);\n\n        svgAttr(segmentDraggerGfx, { 'data-segment-idx': i });\n\n        bindInteractionEvents(segmentDraggerGfx, 'mousemove', connection);\n      }\n    }\n  }\n\n  function clearBendpoints(gfx) {\n    forEach(domQueryAll('.' + BENDPOINT_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function clearSegmentDraggers(gfx) {\n    forEach(domQueryAll('.' + SEGMENT_DRAGGER_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function addHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (!gfx) {\n      gfx = getBendpointsContainer(connection, true);\n\n      createBendpoints(gfx, connection);\n      createSegmentDraggers(gfx, connection);\n    }\n\n    return gfx;\n  }\n\n  function updateHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (gfx) {\n      clearSegmentDraggers(gfx);\n      clearBendpoints(gfx);\n      createSegmentDraggers(gfx, connection);\n      createBendpoints(gfx, connection);\n    }\n  }\n\n  function updateFloatingBendpointPosition(parentGfx, intersection) {\n    var floating = domQuery('.floating', parentGfx),\n        point = intersection.point;\n\n    if (!floating) {\n      return;\n    }\n\n    translate(floating, point.x, point.y);\n\n  }\n\n  function updateSegmentDraggerPosition(parentGfx, intersection, waypoints) {\n\n    var draggerGfx = getSegmentDragger(intersection.index, parentGfx),\n        segmentStart = waypoints[intersection.index - 1],\n        segmentEnd = waypoints[intersection.index],\n        point = intersection.point,\n        mid = getMidPoint(segmentStart, segmentEnd),\n        alignment = pointsAligned(segmentStart, segmentEnd),\n        draggerVisual, relativePosition;\n\n    if (!draggerGfx) {\n      return;\n    }\n\n    draggerVisual = getDraggerVisual(draggerGfx);\n\n    relativePosition = {\n      x: point.x - mid.x,\n      y: point.y - mid.y\n    };\n\n    if (alignment === 'v') {\n\n      // rotate position\n      relativePosition = {\n        x: relativePosition.y,\n        y: relativePosition.x\n      };\n    }\n\n    translate(draggerVisual, relativePosition.x, relativePosition.y);\n  }\n\n  eventBus.on('connection.changed', function(event) {\n    updateHandles(event.element);\n  });\n\n  eventBus.on('connection.remove', function(event) {\n    var gfx = getBendpointsContainer(event.element);\n\n    if (gfx) {\n      svgRemove(gfx);\n    }\n  });\n\n  eventBus.on('element.marker.update', function(event) {\n\n    var element = event.element,\n        bendpointsGfx;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    bendpointsGfx = addHandles(element);\n\n    if (event.add) {\n      svgClasses(bendpointsGfx).add(event.marker);\n    } else {\n      svgClasses(bendpointsGfx).remove(event.marker);\n    }\n  });\n\n  eventBus.on('element.mousemove', function(event) {\n\n    var element = event.element,\n        waypoints = element.waypoints,\n        bendpointsGfx,\n        intersection;\n\n    if (waypoints) {\n      bendpointsGfx = getBendpointsContainer(element, true);\n\n      intersection = getConnectionIntersection(canvas, waypoints, event.originalEvent);\n\n      if (!intersection) {\n        return;\n      }\n\n      updateFloatingBendpointPosition(bendpointsGfx, intersection);\n\n      if (!intersection.bendpoint) {\n        updateSegmentDraggerPosition(bendpointsGfx, intersection, waypoints);\n      }\n\n    }\n  });\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = event.originalEvent,\n        element = event.element;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    return activateBendpointMove(originalEvent, element);\n  });\n\n  eventBus.on('selection.changed', function(event) {\n    var newSelection = event.newSelection,\n        primary = newSelection[0];\n\n    if (primary && primary.waypoints) {\n      addHandles(primary);\n    }\n  });\n\n  eventBus.on('element.hover', function(event) {\n    var element = event.element;\n\n    if (element.waypoints) {\n      addHandles(element);\n      interactionEvents.registerEvent(event.gfx, 'mousemove', 'element.mousemove');\n    }\n  });\n\n  eventBus.on('element.out', function(event) {\n    interactionEvents.unregisterEvent(event.gfx, 'mousemove', 'element.mousemove');\n  });\n\n  // update bendpoint container data attribute on element ID change\n  eventBus.on('element.updateId', function(context) {\n    var element = context.element,\n        newId = context.newId;\n\n    if (element.waypoints) {\n      var bendpointContainer = getBendpointsContainer(element);\n\n      if (bendpointContainer) {\n        svgAttr(bendpointContainer, { 'data-element-id': newId });\n      }\n    }\n  });\n\n  // API\n\n  this.addHandles = addHandles;\n  this.updateHandles = updateHandles;\n  this.getBendpointsContainer = getBendpointsContainer;\n  this.getSegmentDragger = getSegmentDragger;\n}\n\nBendpoints.$inject = [\n  'eventBus',\n  'canvas',\n  'interactionEvents',\n  'bendpointMove',\n  'connectionSegmentMove'\n];\n\n\n\n// helper /////////////\n\nfunction getDraggerVisual(draggerGfx) {\n  return domQuery('.djs-visual', draggerGfx);\n}","import { filterRedundantWaypoints } from '../../layout/LayoutUtil';\n\nvar round = Math.round;\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\n\n/**\n * Move bendpoints through drag and drop to add/remove bendpoints or reconnect connection.\n */\nexport default function BendpointMove(injector, eventBus, canvas, dragging, rules, modeling) {\n  this._injector = injector;\n\n  this.start = function(event, connection, bendpointIndex, insert) {\n    var gfx = canvas.getGraphics(connection),\n        source = connection.source,\n        target = connection.target,\n        waypoints = connection.waypoints,\n        type;\n\n    if (!insert && bendpointIndex === 0) {\n      type = RECONNECT_START;\n    } else\n    if (!insert && bendpointIndex === waypoints.length - 1) {\n      type = RECONNECT_END;\n    } else {\n      type = UPDATE_WAYPOINTS;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    var allowed = rules.allowed(command, {\n      connection: connection,\n      source: source,\n      target: target\n    });\n\n    if (allowed === false) {\n      allowed = rules.allowed(command, {\n        connection: connection,\n        source: target,\n        target: source\n      });\n    }\n\n    if (allowed === false) {\n      return;\n    }\n\n    dragging.init(event, 'bendpoint.move', {\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: {\n          allowed: allowed,\n          bendpointIndex: bendpointIndex,\n          connection: connection,\n          source: source,\n          target: target,\n          insert: insert,\n          type: type\n        }\n      }\n    });\n  };\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hover = event.hover,\n        type = context.type;\n\n    // cache hover state\n    context.hover = hover;\n\n    var allowed;\n\n    if (!hover) {\n      return;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    allowed = context.allowed = rules.allowed(command, {\n      connection: connection,\n      source: type === RECONNECT_START ? hover : source,\n      target: type === RECONNECT_END ? hover : target\n    });\n\n    if (allowed) {\n      context.source = type === RECONNECT_START ? hover : source;\n      context.target = type === RECONNECT_END ? hover : target;\n\n      return;\n    }\n\n    if (allowed === false) {\n      allowed = context.allowed = rules.allowed(command, {\n        connection: connection,\n        source: type === RECONNECT_END ? hover : target,\n        target: type === RECONNECT_START ? hover : source\n      });\n    }\n\n    if (allowed) {\n      context.source = type === RECONNECT_END ? hover : target;\n      context.target = type === RECONNECT_START ? hover : source;\n    }\n  });\n\n  eventBus.on([ 'bendpoint.move.out', 'bendpoint.move.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.allowed = false;\n  });\n\n  eventBus.on('bendpoint.move.end', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        newWaypoints = connection.waypoints.slice(),\n        source = context.source,\n        target = context.target,\n        type = context.type,\n        hints = {};\n\n    // ensure integer values (important if zoom level was > 1 during move)\n    var docking = {\n      x: round(event.x),\n      y: round(event.y)\n    };\n\n    if (!allowed) {\n      return false;\n    }\n\n    if (type === UPDATE_WAYPOINTS) {\n      if (insert) {\n\n        // insert new bendpoint\n        newWaypoints.splice(bendpointIndex, 0, docking);\n      } else {\n\n        // swap previous waypoint with moved one\n        newWaypoints[bendpointIndex] = docking;\n      }\n\n      // pass hints about actual moved bendpoint\n      // useful for connection/label layout\n      hints = {\n        bendpointMove: {\n          insert: insert,\n          bendpointIndex: bendpointIndex\n        }\n      };\n\n      newWaypoints = this.cropWaypoints(connection, newWaypoints);\n\n      modeling.updateWaypoints(connection, filterRedundantWaypoints(newWaypoints), hints);\n    } else {\n      if (type === RECONNECT_START) {\n        hints.docking = 'source';\n\n        if (isReverse(context)) {\n          hints.docking = 'target';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      } else if (type === RECONNECT_END) {\n        hints.docking = 'target';\n\n        if (isReverse(context)) {\n          hints.docking = 'source';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      }\n\n      modeling.reconnect(connection, source, target, docking, hints);\n    }\n  }, this);\n}\n\nBendpointMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'rules',\n  'modeling'\n];\n\nBendpointMove.prototype.cropWaypoints = function(connection, newWaypoints) {\n  var connectionDocking = this._injector.get('connectionDocking', false);\n\n  if (!connectionDocking) {\n    return newWaypoints;\n  }\n\n  var waypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n\n  newWaypoints = connection.waypoints;\n\n  connection.waypoints = waypoints;\n\n  return newWaypoints;\n};\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target,\n      type = context.type;\n\n  if (type === RECONNECT_START) {\n    return hover && target && hover === target && source !== target;\n  }\n\n  if (type === RECONNECT_END) {\n    return hover && source && hover === source && source !== target;\n  }\n}","import {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { addBendpoint } from './BendpointUtil';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nimport { isReverse } from './BendpointMove';\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok',\n    MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating',\n    MARKER_ELEMENT_HIDDEN = 'djs-element-hidden';\n\nvar HIGH_PRIORITY = 1100;\n\n/**\n * Preview connection while moving bendpoints.\n */\nexport default function BendpointMovePreview(bendpointMove, injector, eventBus, canvas) {\n  this._injector = injector;\n\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  eventBus.on('bendpoint.move.start', function(event) {\n    var context = event.context,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        waypoints = connection.waypoints,\n        newWaypoints = waypoints.slice();\n\n    context.waypoints = waypoints;\n\n    if (insert) {\n\n      // insert placeholder for new bendpoint\n      newWaypoints.splice(bendpointIndex, 0, { x: event.x, y: event.y });\n    }\n\n    connection.waypoints = newWaypoints;\n\n    // add dragger gfx\n    var draggerGfx = context.draggerGfx = addBendpoint(canvas.getLayer('overlays'));\n\n    svgClasses(draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_ELEMENT_HIDDEN);\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        hover = context.hover,\n        type = context.type;\n\n    if (hover) {\n      canvas.addMarker(hover, MARKER_CONNECT_HOVER);\n\n      if (type === UPDATE_WAYPOINTS) {\n        return;\n      }\n\n      if (allowed) {\n        canvas.removeMarker(hover, MARKER_NOT_OK);\n        canvas.addMarker(hover, MARKER_OK);\n      } else if (allowed === false) {\n        canvas.removeMarker(hover, MARKER_OK);\n        canvas.addMarker(hover, MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([\n    'bendpoint.move.out',\n    'bendpoint.move.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        hover = context.hover,\n        target = context.target;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n  eventBus.on('bendpoint.move.move', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        type = context.type,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        newWaypoints = connection.waypoints.slice(),\n        bendpoint = { x: event.x, y: event.y },\n        hints;\n\n    if (connectionPreview) {\n      hints = {\n        source: source,\n        target: target\n      };\n\n      if (type === RECONNECT_START) {\n        if (isReverse(context)) {\n          hints.connectionEnd = bendpoint;\n          hints.source = target;\n          hints.target = hover || source;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          hints.connectionStart = bendpoint;\n          hints.source = hover || source;\n        }\n      } else if (type === RECONNECT_END) {\n        if (isReverse(context)) {\n          hints.connectionStart = bendpoint;\n          hints.target = source;\n          hints.source = hover || target;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          hints.connectionEnd = bendpoint;\n          hints.target = hover || target;\n        }\n\n      } else {\n        hints.noCropping = true;\n        hints.noLayout = true;\n        newWaypoints[ bendpointIndex ] = bendpoint;\n      }\n\n      if (type === UPDATE_WAYPOINTS) {\n        newWaypoints = bendpointMove.cropWaypoints(connection, newWaypoints);\n      }\n\n      hints.waypoints = newWaypoints;\n\n      connectionPreview.drawPreview(context, allowed, hints);\n    }\n\n    translate(draggerGfx, event.x, event.y);\n  }, this);\n\n  eventBus.on([\n    'bendpoint.move.end',\n    'bendpoint.move.cancel'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        target = context.target,\n        waypoints = context.waypoints;\n\n    connection.waypoints = waypoints;\n\n    // remove dragger gfx\n    svgRemove(draggerGfx);\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n    canvas.removeMarker(connection, MARKER_ELEMENT_HIDDEN);\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n\n    if (connectionPreview) {\n      connectionPreview.cleanUp(context);\n    }\n  });\n}\n\nBendpointMovePreview.$inject = [\n  'bendpointMove',\n  'injector',\n  'eventBus',\n  'canvas'\n];","import {\n  pointsAligned,\n  pointsOnLine\n} from '../../util/Geometry';\n\nimport {\n  addSegmentDragger,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  getMid,\n  getOrientation\n} from '../../layout/LayoutUtil';\n\nvar MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating';\n\nimport {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\nfunction axisAdd(point, axis, delta) {\n  return axisSet(point, axis, point[axis] + delta);\n}\n\nfunction axisSet(point, axis, value) {\n  return {\n    x: (axis === 'x' ? value : point.x),\n    y: (axis === 'y' ? value : point.y)\n  };\n}\n\nfunction axisFenced(position, segmentStart, segmentEnd, axis) {\n\n  var maxValue = Math.max(segmentStart[axis], segmentEnd[axis]),\n      minValue = Math.min(segmentStart[axis], segmentEnd[axis]);\n\n  var padding = 20;\n\n  var fencedValue = Math.min(Math.max(minValue + padding, position[axis]), maxValue - padding);\n\n  return axisSet(segmentStart, axis, fencedValue);\n}\n\nfunction flipAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\n\n/**\n * Get the docking point on the given element.\n *\n * Compute a reasonable docking, if non exists.\n *\n * @param  {Point} point\n * @param  {djs.model.Shape} referenceElement\n * @param  {String} moveAxis (x|y)\n *\n * @return {Point}\n */\nfunction getDocking(point, referenceElement, moveAxis) {\n\n  var referenceMid,\n      inverseAxis;\n\n  if (point.original) {\n    return point.original;\n  } else {\n    referenceMid = getMid(referenceElement);\n    inverseAxis = flipAxis(moveAxis);\n\n    return axisSet(point, inverseAxis, referenceMid[inverseAxis]);\n  }\n}\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function ConnectionSegmentMove(\n    injector, eventBus, canvas,\n    dragging, graphicsFactory, modeling) {\n\n  // optional connection docking integration\n  var connectionDocking = injector.get('connectionDocking', false);\n\n\n  // API\n\n  this.start = function(event, connection, idx) {\n\n    var context,\n        gfx = canvas.getGraphics(connection),\n        segmentStartIndex = idx - 1,\n        segmentEndIndex = idx,\n        waypoints = connection.waypoints,\n        segmentStart = waypoints[segmentStartIndex],\n        segmentEnd = waypoints[segmentEndIndex],\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        direction, axis, dragPosition;\n\n    direction = pointsAligned(segmentStart, segmentEnd);\n\n    // do not move diagonal connection\n    if (!direction) {\n      return;\n    }\n\n    // the axis where we are going to move things\n    axis = direction === 'v' ? 'x' : 'y';\n\n    if (segmentStartIndex === 0) {\n      segmentStart = getDocking(segmentStart, connection.source, axis);\n    }\n\n    if (segmentEndIndex === waypoints.length - 1) {\n      segmentEnd = getDocking(segmentEnd, connection.target, axis);\n    }\n\n    if (intersection) {\n      dragPosition = intersection.point;\n    } else {\n\n      // set to segment center as default\n      dragPosition = {\n        x: (segmentStart.x + segmentEnd.x) / 2,\n        y: (segmentStart.y + segmentEnd.y) / 2\n      };\n    }\n\n    context = {\n      connection: connection,\n      segmentStartIndex: segmentStartIndex,\n      segmentEndIndex: segmentEndIndex,\n      segmentStart: segmentStart,\n      segmentEnd: segmentEnd,\n      axis: axis,\n      dragPosition: dragPosition\n    };\n\n    dragging.init(event, dragPosition, 'connectionSegment.move', {\n      cursor: axis === 'x' ? 'resize-ew' : 'resize-ns',\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: context\n      }\n    });\n  };\n\n  /**\n   * Crop connection if connection cropping is provided.\n   *\n   * @param {Connection} connection\n   * @param {Array<Point>} newWaypoints\n   *\n   * @return {Array<Point>} cropped connection waypoints\n   */\n  function cropConnection(connection, newWaypoints) {\n\n    // crop connection, if docking service is provided only\n    if (!connectionDocking) {\n      return newWaypoints;\n    }\n\n    var oldWaypoints = connection.waypoints,\n        croppedWaypoints;\n\n    // temporary set new waypoints\n    connection.waypoints = newWaypoints;\n\n    croppedWaypoints = connectionDocking.getCroppedWaypoints(connection);\n\n    // restore old waypoints\n    connection.waypoints = oldWaypoints;\n\n    return croppedWaypoints;\n  }\n\n  // DRAGGING IMPLEMENTATION\n\n  function redrawConnection(data) {\n    graphicsFactory.update('connection', data.connection, data.connectionGfx);\n  }\n\n  function updateDragger(context, segmentOffset, event) {\n\n    var newWaypoints = context.newWaypoints,\n        segmentStartIndex = context.segmentStartIndex + segmentOffset,\n        segmentStart = newWaypoints[segmentStartIndex],\n        segmentEndIndex = context.segmentEndIndex + segmentOffset,\n        segmentEnd = newWaypoints[segmentEndIndex],\n        axis = flipAxis(context.axis);\n\n    // make sure the dragger does not move\n    // outside the connection\n    var draggerPosition = axisFenced(event, segmentStart, segmentEnd, axis);\n\n    // update dragger\n    translate(context.draggerGfx, draggerPosition.x, draggerPosition.y);\n  }\n\n  /**\n   * Filter waypoints for redundant ones (i.e. on the same axis).\n   * Returns the filtered waypoints and the offset related to the segment move.\n   *\n   * @param {Array<Point>} waypoints\n   * @param {Integer} segmentStartIndex of moved segment start\n   *\n   * @return {Object} { filteredWaypoints, segmentOffset }\n   */\n  function filterRedundantWaypoints(waypoints, segmentStartIndex) {\n\n    var segmentOffset = 0;\n\n    var filteredWaypoints = waypoints.filter(function(r, idx) {\n      if (pointsOnLine(waypoints[idx - 1], waypoints[idx + 1], r)) {\n\n        // remove point and increment offset\n        segmentOffset = idx <= segmentStartIndex ? segmentOffset - 1 : segmentOffset;\n        return false;\n      }\n\n      // dont remove point\n      return true;\n    });\n\n    return {\n      waypoints: filteredWaypoints,\n      segmentOffset: segmentOffset\n    };\n  }\n\n  eventBus.on('connectionSegment.move.start', function(event) {\n\n    var context = event.context,\n        connection = event.connection,\n        layer = canvas.getLayer('overlays');\n\n    context.originalWaypoints = connection.waypoints.slice();\n\n    // add dragger gfx\n    context.draggerGfx = addSegmentDragger(layer, context.segmentStart, context.segmentEnd);\n    svgClasses(context.draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('connectionSegment.move.move', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEndIndex = context.segmentEndIndex,\n        segmentStart = context.segmentStart,\n        segmentEnd = context.segmentEnd,\n        axis = context.axis;\n\n    var newWaypoints = context.originalWaypoints.slice(),\n        newSegmentStart = axisAdd(segmentStart, axis, event['d' + axis]),\n        newSegmentEnd = axisAdd(segmentEnd, axis, event['d' + axis]);\n\n    // original waypoint count and added / removed\n    // from start waypoint delta. We use the later\n    // to retrieve the updated segmentStartIndex / segmentEndIndex\n    var waypointCount = newWaypoints.length,\n        segmentOffset = 0;\n\n    // move segment start / end by axis delta\n    newWaypoints[segmentStartIndex] = newSegmentStart;\n    newWaypoints[segmentEndIndex] = newSegmentEnd;\n\n    var sourceToSegmentOrientation,\n        targetToSegmentOrientation;\n\n    // handle first segment\n    if (segmentStartIndex < 2) {\n      sourceToSegmentOrientation = getOrientation(connection.source, newSegmentStart);\n\n      // first bendpoint, remove first segment if intersecting\n      if (segmentStartIndex === 1) {\n\n        if (sourceToSegmentOrientation === 'intersect') {\n          newWaypoints.shift();\n          newWaypoints[0] = newSegmentStart;\n          segmentOffset--;\n        }\n      }\n\n      // docking point, add segment if not intersecting anymore\n      else {\n        if (sourceToSegmentOrientation !== 'intersect') {\n          newWaypoints.unshift(segmentStart);\n          segmentOffset++;\n        }\n      }\n    }\n\n    // handle last segment\n    if (segmentEndIndex > waypointCount - 3) {\n      targetToSegmentOrientation = getOrientation(connection.target, newSegmentEnd);\n\n      // last bendpoint, remove last segment if intersecting\n      if (segmentEndIndex === waypointCount - 2) {\n\n        if (targetToSegmentOrientation === 'intersect') {\n          newWaypoints.pop();\n          newWaypoints[newWaypoints.length - 1] = newSegmentEnd;\n        }\n      }\n\n      // last bendpoint, remove last segment if intersecting\n      else {\n        if (targetToSegmentOrientation !== 'intersect') {\n          newWaypoints.push(segmentEnd);\n        }\n      }\n    }\n\n    // update connection waypoints\n    context.newWaypoints = connection.waypoints = cropConnection(connection, newWaypoints);\n\n    // update dragger position\n    updateDragger(context, segmentOffset, event);\n\n    // save segmentOffset in context\n    context.newSegmentStartIndex = segmentStartIndex + segmentOffset;\n\n    // redraw connection\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.hover', function(event) {\n\n    event.context.hover = event.hover;\n    canvas.addMarker(event.hover, MARKER_CONNECT_HOVER);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.out',\n    'connectionSegment.move.cleanup'\n  ], function(event) {\n\n    // remove connect marker\n    // if it was added\n    var hover = event.context.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n    }\n  });\n\n  eventBus.on('connectionSegment.move.cleanup', function(event) {\n\n    var context = event.context,\n        connection = context.connection;\n\n    // remove dragger gfx\n    if (context.draggerGfx) {\n      svgRemove(context.draggerGfx);\n    }\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.cancel',\n    'connectionSegment.move.end'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    connection.waypoints = context.originalWaypoints;\n\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.end', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        newWaypoints = context.newWaypoints,\n        newSegmentStartIndex = context.newSegmentStartIndex;\n\n    // ensure we have actual pixel values bendpoint\n    // coordinates (important when zoom level was > 1 during move)\n    newWaypoints = newWaypoints.map(function(p) {\n      return {\n        original: p.original,\n        x: Math.round(p.x),\n        y: Math.round(p.y)\n      };\n    });\n\n    // apply filter redunant waypoints\n    var filtered = filterRedundantWaypoints(newWaypoints, newSegmentStartIndex);\n\n    // get filtered waypoints\n    var filteredWaypoints = filtered.waypoints,\n        croppedWaypoints = cropConnection(connection, filteredWaypoints),\n        segmentOffset = filtered.segmentOffset;\n\n    var hints = {\n      segmentMove: {\n        segmentStartIndex: context.segmentStartIndex,\n        newSegmentStartIndex: newSegmentStartIndex + segmentOffset\n      }\n    };\n\n    modeling.updateWaypoints(connection, croppedWaypoints, hints);\n  });\n}\n\nConnectionSegmentMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'graphicsFactory',\n  'modeling'\n];\n","var abs = Math.abs,\n    round = Math.round;\n\n\n/**\n * Snap value to a collection of reference values.\n *\n * @param  {Number} value\n * @param  {Array<Number>} values\n * @param  {Number} [tolerance=10]\n *\n * @return {Number} the value we snapped to or null, if none snapped\n */\nexport function snapTo(value, values, tolerance) {\n  tolerance = tolerance === undefined ? 10 : tolerance;\n\n  var idx, snapValue;\n\n  for (idx = 0; idx < values.length; idx++) {\n    snapValue = values[idx];\n\n    if (abs(snapValue - value) <= tolerance) {\n      return snapValue;\n    }\n  }\n}\n\n\nexport function topLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y\n  };\n}\n\nexport function topRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y\n  };\n}\n\nexport function bottomLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function bottomRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function mid(bounds, defaultValue) {\n\n  if (!bounds || isNaN(bounds.x) || isNaN(bounds.y)) {\n    return defaultValue;\n  }\n\n  return {\n    x: round(bounds.x + bounds.width / 2),\n    y: round(bounds.y + bounds.height / 2)\n  };\n}\n\n\n/**\n * Retrieve the snap state of the given event.\n *\n * @param  {Event} event\n * @param  {String} axis\n *\n * @return {Boolean} the snapped state\n *\n */\nexport function isSnapped(event, axis) {\n  var snapped = event.snapped;\n\n  if (!snapped) {\n    return false;\n  }\n\n  if (typeof axis === 'string') {\n    return snapped[axis];\n  }\n\n  return snapped.x && snapped.y;\n}\n\n\n/**\n * Set the given event as snapped.\n *\n * This method may change the x and/or y position of the shape\n * from the given event!\n *\n * @param {Event} event\n * @param {String} axis\n * @param {Number|Boolean} value\n *\n * @return {Number} old value\n */\nexport function setSnapped(event, axis, value) {\n  if (typeof axis !== 'string') {\n    throw new Error('axis must be in [x, y]');\n  }\n\n  if (typeof value !== 'number' && value !== false) {\n    throw new Error('value must be Number or false');\n  }\n\n  var delta,\n      previousValue = event[axis];\n\n  var snapped = event.snapped = (event.snapped || {});\n\n\n  if (value === false) {\n    snapped[axis] = false;\n  } else {\n    snapped[axis] = true;\n\n    delta = value - previousValue;\n\n    event[axis] += delta;\n    event['d' + axis] += delta;\n  }\n\n  return previousValue;\n}\n\n/**\n * Get children of a shape.\n *\n * @param {djs.model.Shape} parent\n *\n * @returns {Array<djs.model.Shape|djs.model.Connection>}\n */\nexport function getChildren(parent) {\n  return parent.children || [];\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport { setSnapped } from '../snapping/SnapUtil';\n\nvar abs= Math.abs,\n    round = Math.round;\n\nvar TOLERANCE = 10;\n\n\nexport default function BendpointSnapping(eventBus) {\n\n  function snapTo(values, value) {\n\n    if (isArray(values)) {\n      var i = values.length;\n\n      while (i--) if (abs(values[i] - value) <= TOLERANCE) {\n        return values[i];\n      }\n    } else {\n      values = +values;\n      var rem = value % values;\n\n      if (rem < TOLERANCE) {\n        return value - rem;\n      }\n\n      if (rem > values - TOLERANCE) {\n        return value - rem + values;\n      }\n    }\n\n    return value;\n  }\n\n  function mid(element) {\n    if (element.width) {\n      return {\n        x: round(element.width / 2 + element.x),\n        y: round(element.height / 2 + element.y)\n      };\n    }\n  }\n\n  // connection segment snapping //////////////////////\n\n  function getConnectionSegmentSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        connection = context.connection,\n        waypoints = connection.waypoints,\n        segmentStart = context.segmentStart,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEnd = context.segmentEnd,\n        segmentEndIndex = context.segmentEndIndex,\n        axis = context.axis;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [\n      waypoints[segmentStartIndex - 1],\n      segmentStart,\n      segmentEnd,\n      waypoints[segmentEndIndex + 1]\n    ];\n\n    if (segmentStartIndex < 2) {\n      referenceWaypoints.unshift(mid(connection.source));\n    }\n\n    if (segmentEndIndex > waypoints.length - 3) {\n      referenceWaypoints.unshift(mid(connection.target));\n    }\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        if (axis === 'y') {\n          snapPoints.horizontal.push(p.y);\n        }\n\n        if (axis === 'x') {\n          snapPoints.vertical.push(p.x);\n        }\n      }\n    });\n\n    return snapPoints;\n  }\n\n  eventBus.on('connectionSegment.move.move', 1500, function(event) {\n    var context = event.context,\n        snapPoints = getConnectionSegmentSnaps(context),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap\n    sx = snapTo(snapPoints.vertical, x);\n    sy = snapTo(snapPoints.horizontal, y);\n\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: sx,\n      y: sy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n\n\n  // bendpoint snapping //////////////////////\n\n  function getBendpointSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        waypoints = context.connection.waypoints,\n        bendpointIndex = context.bendpointIndex;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [ waypoints[bendpointIndex - 1], waypoints[bendpointIndex + 1] ];\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        snapPoints.horizontal.push(p.y);\n        snapPoints.vertical.push(p.x);\n      }\n    });\n\n    return snapPoints;\n  }\n\n\n  eventBus.on([ 'bendpoint.move.move', 'bendpoint.move.end' ], 1500, function(event) {\n\n    var context = event.context,\n        snapPoints = getBendpointSnaps(context),\n        hover = context.hover,\n        hoverMid = hover && mid(hover),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap to hover mid\n    sx = snapTo(hoverMid ? snapPoints.vertical.concat([ hoverMid.x ]) : snapPoints.vertical, x);\n    sy = snapTo(hoverMid ? snapPoints.horizontal.concat([ hoverMid.y ]) : snapPoints.horizontal, y);\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: event.x - cx,\n      y: event.y - cy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n}\n\n\nBendpointSnapping.$inject = [ 'eventBus' ];","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\n\nimport Bendpoints from './Bendpoints';\nimport BendpointMove from './BendpointMove';\nimport BendpointMovePreview from './BendpointMovePreview';\nimport ConnectionSegmentMove from './ConnectionSegmentMove';\nimport BendpointSnapping from './BendpointSnapping';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    RulesModule\n  ],\n  __init__: [ 'bendpoints', 'bendpointSnapping', 'bendpointMovePreview' ],\n  bendpoints: [ 'type', Bendpoints ],\n  bendpointMove: [ 'type', BendpointMove ],\n  bendpointMovePreview: [ 'type', BendpointMovePreview ],\n  connectionSegmentMove: [ 'type', ConnectionSegmentMove ],\n  bendpointSnapping: [ 'type', BendpointSnapping ]\n};\n","import {\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport {\n  isNil,\n  isObject\n} from 'min-dash';\n\n\nexport default function Connect(eventBus, dragging, modeling, rules) {\n\n  // rules\n\n  function canConnect(source, target) {\n    return rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n  }\n\n  function canConnectReverse(source, target) {\n    return canConnect(target, source);\n  }\n\n\n  // event handlers\n\n  eventBus.on('connect.hover', function(event) {\n    var context = event.context,\n        start = context.start,\n        hover = event.hover,\n        canExecute;\n\n    // cache hover state\n    context.hover = hover;\n\n    canExecute = context.canExecute = canConnect(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = start;\n      context.target = hover;\n\n      return;\n    }\n\n    canExecute = context.canExecute = canConnectReverse(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = hover;\n      context.target = start;\n    }\n  });\n\n  eventBus.on([ 'connect.out', 'connect.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.canExecute = false;\n  });\n\n  eventBus.on('connect.end', function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        connectionStart = context.connectionStart,\n        connectionEnd = {\n          x: event.x,\n          y: event.y\n        },\n        source = context.source,\n        target = context.target;\n\n    if (!canExecute) {\n      return false;\n    }\n\n    var attrs = null,\n        hints = {\n          connectionStart: isReverse(context) ? connectionEnd : connectionStart,\n          connectionEnd: isReverse(context) ? connectionStart : connectionEnd\n        };\n\n    if (isObject(canExecute)) {\n      attrs = canExecute;\n    }\n\n    modeling.connect(source, target, attrs, hints);\n  });\n\n\n  // API\n\n  /**\n   * Start connect operation.\n   *\n   * @param {DOMEvent} event\n   * @param {djs.model.Base} start\n   * @param {Point} [connectionStart]\n   * @param {boolean} [autoActivate=false]\n   */\n  this.start = function(event, start, connectionStart, autoActivate) {\n    if (!isObject(connectionStart)) {\n      autoActivate = connectionStart;\n      connectionStart = getMid(start);\n    }\n\n    dragging.init(event, 'connect', {\n      autoActivate: autoActivate,\n      data: {\n        shape: start,\n        context: {\n          start: start,\n          connectionStart: connectionStart\n        }\n      }\n    });\n  };\n}\n\nConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'rules'\n];\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target;\n\n  return hover && source && hover === source && source !== target;\n}","import { isReverse } from './Connect';\n\nvar HIGH_PRIORITY = 1100,\n    LOW_PRIORITY = 900;\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * Shows connection preview during connect.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ConnectPreview(injector, eventBus, canvas) {\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  connectionPreview && eventBus.on('connect.move', function(event) {\n    var context = event.context,\n        canConnect = context.canExecute,\n        hover = context.hover,\n        source = context.source,\n        start = context.start,\n        startPosition = context.startPosition,\n        target = context.target;\n\n    var connectionStart = isReverse(context) ? {\n      x: event.x,\n      y: event.y\n    } : startPosition;\n\n    var connectionEnd = isReverse(context) ? startPosition : {\n      x: event.x,\n      y: event.y\n    };\n\n    connectionPreview.drawPreview(context, canConnect, {\n      source: source || start,\n      target: target || hover,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd\n    });\n  });\n\n  eventBus.on('connect.hover', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        hover = event.hover,\n        canExecute = context.canExecute;\n\n    // ignore hover\n    if (canExecute === null) {\n      return;\n    }\n\n    canvas.addMarker(hover, canExecute ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n  eventBus.on([\n    'connect.out',\n    'connect.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, MARKER_NOT_OK);\n    }\n  });\n\n  connectionPreview && eventBus.on('connect.cleanup', function(event) {\n    connectionPreview.cleanUp(event.context);\n  });\n}\n\nConnectPreview.$inject = [\n  'injector',\n  'eventBus',\n  'canvas'\n];\n","import SelectionModule from '../selection';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\n\nimport Connect from './Connect';\nimport ConnectPreview from './ConnectPreview';\n\nexport default {\n  __depends__: [\n    SelectionModule,\n    RulesModule,\n    DraggingModule\n  ],\n  __init__: [\n    'connectPreview'\n  ],\n  connect: [ 'type', Connect ],\n  connectPreview: [ 'type', ConnectPreview ]\n};\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove,\n  clear as svgClear\n} from 'tiny-svg';\n\nimport {\n  isObject\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection,\n  getMid\n} from '../../layout/LayoutUtil';\n\n\nvar MARKER_CONNECTION_PREVIEW = 'djs-connection-preview';\n\n/**\n * Draws connection preview. Optionally, this can use layouter and connection docking to draw\n * better looking previews.\n *\n * @param {didi.Injector} injector\n * @param {Canvas} canvas\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementFactory} elementFactory\n */\nexport default function ConnectionPreview(\n    injector,\n    canvas,\n    graphicsFactory,\n    elementFactory\n) {\n  this._canvas = canvas;\n  this._graphicsFactory = graphicsFactory;\n  this._elementFactory = elementFactory;\n\n  // optional components\n  this._connectionDocking = injector.get('connectionDocking', false);\n  this._layouter = injector.get('layouter', false);\n}\n\nConnectionPreview.$inject = [\n  'injector',\n  'canvas',\n  'graphicsFactory',\n  'elementFactory'\n];\n\n/**\n * Draw connection preview.\n *\n * Provide at least one of <source, connectionStart> and <target, connectionEnd> to create a preview.\n * In the clean up stage, call `connectionPreview#cleanUp` with the context to remove preview.\n *\n * @param {Object} context\n * @param {Object|boolean} canConnect\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] connection preview start\n * @param {Point} [hints.connectionEnd] connection preview end\n * @param {Array<Point>} [hints.waypoints] provided waypoints for preview\n * @param {boolean} [hints.noLayout] true if preview should not be laid out\n * @param {boolean} [hints.noCropping] true if preview should not be cropped\n * @param {boolean} [hints.noNoop] true if simple connection should not be drawn\n */\nConnectionPreview.prototype.drawPreview = function(context, canConnect, hints) {\n\n  hints = hints || {};\n\n  var connectionPreviewGfx = context.connectionPreviewGfx,\n      getConnection = context.getConnection,\n      source = hints.source,\n      target = hints.target,\n      waypoints = hints.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd,\n      noLayout = hints.noLayout,\n      noCropping = hints.noCropping,\n      noNoop = hints.noNoop,\n      connection;\n\n  var self = this;\n\n  if (!connectionPreviewGfx) {\n    connectionPreviewGfx = context.connectionPreviewGfx = this.createConnectionPreviewGfx();\n  }\n\n  svgClear(connectionPreviewGfx);\n\n  if (!getConnection) {\n    getConnection = context.getConnection = cacheReturnValues(function(canConnect, source, target) {\n      return self.getConnection(canConnect, source, target);\n    });\n  }\n\n  if (canConnect) {\n    connection = getConnection(canConnect, source, target);\n  }\n\n  if (!connection) {\n    !noNoop && this.drawNoopPreview(connectionPreviewGfx, hints);\n    return;\n  }\n\n  connection.waypoints = waypoints || [];\n\n  // optional layout\n  if (this._layouter && !noLayout) {\n    connection.waypoints = this._layouter.layoutConnection(connection, {\n      source: source,\n      target: target,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd,\n      waypoints: hints.waypoints || connection.waypoints\n    });\n  }\n\n  // fallback if no waypoints were provided nor created with layouter\n  if (!connection.waypoints || !connection.waypoints.length) {\n    connection.waypoints = [\n      source ? getMid(source) : connectionStart,\n      target ? getMid(target) : connectionEnd\n    ];\n  }\n\n  // optional cropping\n  if (this._connectionDocking && (source || target) && !noCropping) {\n    connection.waypoints = this._connectionDocking.getCroppedWaypoints(connection, source, target);\n  }\n\n  this._graphicsFactory.drawConnection(connectionPreviewGfx, connection);\n};\n\n/**\n * Draw simple connection between source and target or provided points.\n *\n * @param {SVGElement} connectionPreviewGfx container for the connection\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] required if source is not provided\n * @param {Point} [hints.connectionEnd] required if target is not provided\n */\nConnectionPreview.prototype.drawNoopPreview = function(connectionPreviewGfx, hints) {\n  var source = hints.source,\n      target = hints.target,\n      start = hints.connectionStart || getMid(source),\n      end = hints.connectionEnd || getMid(target);\n\n  var waypoints = this.cropWaypoints(start, end, source, target);\n\n  var connection = this.createNoopConnection(waypoints[0], waypoints[1]);\n\n  svgAppend(connectionPreviewGfx, connection);\n};\n\n/**\n * Return cropped waypoints.\n *\n * @param {Point} start\n * @param {Point} end\n * @param {djs.model.shape} source\n * @param {djs.model.shape} target\n *\n * @returns {Array}\n */\nConnectionPreview.prototype.cropWaypoints = function(start, end, source, target) {\n  var graphicsFactory = this._graphicsFactory,\n      sourcePath = source && graphicsFactory.getShapePath(source),\n      targetPath = target && graphicsFactory.getShapePath(target),\n      connectionPath = graphicsFactory.getConnectionPath({ waypoints: [ start, end ] });\n\n  start = (source && getElementLineIntersection(sourcePath, connectionPath, true)) || start;\n  end = (target && getElementLineIntersection(targetPath, connectionPath, false)) || end;\n\n  return [ start, end ];\n};\n\n/**\n * Remove connection preview container if it exists.\n *\n * @param {Object} [context]\n * @param {SVGElement} [context.connectionPreviewGfx] preview container\n */\nConnectionPreview.prototype.cleanUp = function(context) {\n  if (context && context.connectionPreviewGfx) {\n    svgRemove(context.connectionPreviewGfx);\n  }\n};\n\n/**\n * Get connection that connects source and target.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {djs.model.connection}\n */\nConnectionPreview.prototype.getConnection = function(canConnect) {\n  var attrs = ensureConnectionAttrs(canConnect);\n\n  return this._elementFactory.createConnection(attrs);\n};\n\n\n/**\n * Add and return preview graphics.\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createConnectionPreviewGfx = function() {\n  var gfx = svgCreate('g');\n\n  svgAttr(gfx, {\n    pointerEvents: 'none'\n  });\n\n  svgClasses(gfx).add(MARKER_CONNECTION_PREVIEW);\n\n  svgAppend(this._canvas.getDefaultLayer(), gfx);\n\n  return gfx;\n};\n\n/**\n * Create and return simple connection.\n *\n * @param {Point} start\n * @param {Point} end\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createNoopConnection = function(start, end) {\n  var connection = svgCreate('polyline');\n\n  svgAttr(connection, {\n    'stroke': '#333',\n    'strokeDasharray': [ 1 ],\n    'strokeWidth': 2,\n    'pointer-events': 'none'\n  });\n\n  svgAttr(connection, { 'points': [ start.x, start.y, end.x, end.y ] });\n\n  return connection;\n};\n\n// helpers //////////\n\n/**\n * Returns function that returns cached return values referenced by stringified first argument.\n *\n * @param {Function} fn\n *\n * @return {Function}\n */\nfunction cacheReturnValues(fn) {\n  var returnValues = {};\n\n  /**\n   * Return cached return value referenced by stringified first argument.\n   *\n   * @returns {*}\n   */\n  return function(firstArgument) {\n    var key = JSON.stringify(firstArgument);\n\n    var returnValue = returnValues[key];\n\n    if (!returnValue) {\n      returnValue = returnValues[key] = fn.apply(null, arguments);\n    }\n\n    return returnValue;\n  };\n}\n\n/**\n * Ensure connection attributes is object.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {Object}\n */\nfunction ensureConnectionAttrs(canConnect) {\n  if (isObject(canConnect)) {\n    return canConnect;\n  } else {\n    return {};\n  }\n}\n","import ConnectionPreview from './ConnectionPreview';\n\nexport default {\n  __init__: [ 'connectionPreview' ],\n  connectionPreview: [ 'type', ConnectionPreview ]\n};\n","import {\n  assign,\n  bind,\n  pick\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  event as domEvent,\n  remove as domRemove\n} from 'min-dom';\n\nvar min = Math.min,\n    max = Math.max;\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}\n\nfunction stopPropagation(e) {\n  e.stopPropagation();\n}\n\nfunction isTextNode(node) {\n  return node.nodeType === Node.TEXT_NODE;\n}\n\nfunction toArray(nodeList) {\n  return [].slice.call(nodeList);\n}\n\n/**\n * Initializes a container for a content editable div.\n *\n * Structure:\n *\n * container\n *   parent\n *     content\n *     resize-handle\n *\n * @param {object} options\n * @param {DOMElement} options.container The DOM element to append the contentContainer to\n * @param {Function} options.keyHandler Handler for key events\n * @param {Function} options.resizeHandler Handler for resize events\n */\nexport default function TextBox(options) {\n  this.container = options.container;\n\n  this.parent = domify(\n    '<div class=\"djs-direct-editing-parent\">' +\n      '<div class=\"djs-direct-editing-content\" contenteditable=\"true\"></div>' +\n    '</div>'\n  );\n\n  this.content = domQuery('[contenteditable]', this.parent);\n\n  this.keyHandler = options.keyHandler || function() {};\n  this.resizeHandler = options.resizeHandler || function() {};\n\n  this.autoResize = bind(this.autoResize, this);\n  this.handlePaste = bind(this.handlePaste, this);\n}\n\n\n/**\n * Create a text box with the given position, size, style and text content\n *\n * @param {Object} bounds\n * @param {Number} bounds.x absolute x position\n * @param {Number} bounds.y absolute y position\n * @param {Number} [bounds.width] fixed width value\n * @param {Number} [bounds.height] fixed height value\n * @param {Number} [bounds.maxWidth] maximum width value\n * @param {Number} [bounds.maxHeight] maximum height value\n * @param {Number} [bounds.minWidth] minimum width value\n * @param {Number} [bounds.minHeight] minimum height value\n * @param {Object} [style]\n * @param {String} value text content\n *\n * @return {DOMElement} The created content DOM element\n */\nTextBox.prototype.create = function(bounds, style, value, options) {\n  var self = this;\n\n  var parent = this.parent,\n      content = this.content,\n      container = this.container;\n\n  options = this.options = options || {};\n\n  style = this.style = style || {};\n\n  var parentStyle = pick(style, [\n    'width',\n    'height',\n    'maxWidth',\n    'maxHeight',\n    'minWidth',\n    'minHeight',\n    'left',\n    'top',\n    'backgroundColor',\n    'position',\n    'overflow',\n    'border',\n    'wordWrap',\n    'textAlign',\n    'outline',\n    'transform'\n  ]);\n\n  assign(parent.style, {\n    width: bounds.width + 'px',\n    height: bounds.height + 'px',\n    maxWidth: bounds.maxWidth + 'px',\n    maxHeight: bounds.maxHeight + 'px',\n    minWidth: bounds.minWidth + 'px',\n    minHeight: bounds.minHeight + 'px',\n    left: bounds.x + 'px',\n    top: bounds.y + 'px',\n    backgroundColor: '#ffffff',\n    position: 'absolute',\n    overflow: 'visible',\n    border: '1px solid #ccc',\n    boxSizing: 'border-box',\n    wordWrap: 'normal',\n    textAlign: 'center',\n    outline: 'none'\n  }, parentStyle);\n\n  var contentStyle = pick(style, [\n    'fontFamily',\n    'fontSize',\n    'fontWeight',\n    'lineHeight',\n    'padding',\n    'paddingTop',\n    'paddingRight',\n    'paddingBottom',\n    'paddingLeft'\n  ]);\n\n  assign(content.style, {\n    boxSizing: 'border-box',\n    width: '100%',\n    outline: 'none',\n    wordWrap: 'break-word'\n  }, contentStyle);\n\n  if (options.centerVertically) {\n    assign(content.style, {\n      position: 'absolute',\n      top: '50%',\n      transform: 'translate(0, -50%)'\n    }, contentStyle);\n  }\n\n  content.innerText = value;\n\n  domEvent.bind(content, 'keydown', this.keyHandler);\n  domEvent.bind(content, 'mousedown', stopPropagation);\n  domEvent.bind(content, 'paste', self.handlePaste);\n\n  if (options.autoResize) {\n    domEvent.bind(content, 'input', this.autoResize);\n  }\n\n  if (options.resizable) {\n    this.resizable(style);\n  }\n\n  container.appendChild(parent);\n\n  // set selection to end of text\n  this.setSelection(content.lastChild, content.lastChild && content.lastChild.length);\n\n  return parent;\n};\n\n/**\n * Intercept paste events to remove formatting from pasted text.\n */\nTextBox.prototype.handlePaste = function(e) {\n  var options = this.options,\n      style = this.style;\n\n  e.preventDefault();\n\n  var text;\n\n  if (e.clipboardData) {\n\n    // Chrome, Firefox, Safari\n    text = e.clipboardData.getData('text/plain');\n  } else {\n\n    // Internet Explorer\n    text = window.clipboardData.getData('Text');\n  }\n\n  this.insertText(text);\n\n  if (options.autoResize) {\n    var hasResized = this.autoResize(style);\n\n    if (hasResized) {\n      this.resizeHandler(hasResized);\n    }\n  }\n};\n\nTextBox.prototype.insertText = function(text) {\n\n  // insertText command not supported by Internet Explorer\n  var success = document.execCommand('insertText', false, text);\n\n  if (success) {\n    return;\n  }\n\n  this._insertTextIE(text);\n};\n\nTextBox.prototype._insertTextIE = function(text) {\n\n  // Internet Explorer\n  var range = this.getSelection(),\n      startContainer = range.startContainer,\n      endContainer = range.endContainer,\n      startOffset = range.startOffset,\n      endOffset = range.endOffset,\n      commonAncestorContainer = range.commonAncestorContainer;\n\n  var childNodesArray = toArray(commonAncestorContainer.childNodes);\n\n  var container,\n      offset;\n\n  if (isTextNode(commonAncestorContainer)) {\n    var containerTextContent = startContainer.textContent;\n\n    startContainer.textContent =\n      containerTextContent.substring(0, startOffset)\n      + text\n      + containerTextContent.substring(endOffset);\n\n    container = startContainer;\n    offset = startOffset + text.length;\n\n  } else if (startContainer === this.content && endContainer === this.content) {\n    var textNode = document.createTextNode(text);\n\n    this.content.insertBefore(textNode, childNodesArray[startOffset]);\n\n    container = textNode;\n    offset = textNode.textContent.length;\n  } else {\n    var startContainerChildIndex = childNodesArray.indexOf(startContainer),\n        endContainerChildIndex = childNodesArray.indexOf(endContainer);\n\n    childNodesArray.forEach(function(childNode, index) {\n\n      if (index === startContainerChildIndex) {\n        childNode.textContent =\n          startContainer.textContent.substring(0, startOffset) +\n          text +\n          endContainer.textContent.substring(endOffset);\n      } else if (index > startContainerChildIndex && index <= endContainerChildIndex) {\n        domRemove(childNode);\n      }\n    });\n\n    container = startContainer;\n    offset = startOffset + text.length;\n  }\n\n  if (container && offset !== undefined) {\n\n    // is necessary in Internet Explorer\n    setTimeout(function() {\n      self.setSelection(container, offset);\n    });\n  }\n};\n\n/**\n * Automatically resize element vertically to fit its content.\n */\nTextBox.prototype.autoResize = function() {\n  var parent = this.parent,\n      content = this.content;\n\n  var fontSize = parseInt(this.style.fontSize) || 12;\n\n  if (content.scrollHeight > parent.offsetHeight ||\n      content.scrollHeight < parent.offsetHeight - fontSize) {\n    var bounds = parent.getBoundingClientRect();\n\n    var height = content.scrollHeight;\n    parent.style.height = height + 'px';\n\n    this.resizeHandler({\n      width: bounds.width,\n      height: bounds.height,\n      dx: 0,\n      dy: height - bounds.height\n    });\n  }\n};\n\n/**\n * Make an element resizable by adding a resize handle.\n */\nTextBox.prototype.resizable = function() {\n  var self = this;\n\n  var parent = this.parent,\n      resizeHandle = this.resizeHandle;\n\n  var minWidth = parseInt(this.style.minWidth) || 0,\n      minHeight = parseInt(this.style.minHeight) || 0,\n      maxWidth = parseInt(this.style.maxWidth) || Infinity,\n      maxHeight = parseInt(this.style.maxHeight) || Infinity;\n\n  if (!resizeHandle) {\n    resizeHandle = this.resizeHandle = domify(\n      '<div class=\"djs-direct-editing-resize-handle\"></div>'\n    );\n\n    var startX, startY, startWidth, startHeight;\n\n    var onMouseDown = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      startX = e.clientX;\n      startY = e.clientY;\n\n      var bounds = parent.getBoundingClientRect();\n\n      startWidth = bounds.width;\n      startHeight = bounds.height;\n\n      domEvent.bind(document, 'mousemove', onMouseMove);\n      domEvent.bind(document, 'mouseup', onMouseUp);\n    };\n\n    var onMouseMove = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      var newWidth = min(max(startWidth + e.clientX - startX, minWidth), maxWidth);\n      var newHeight = min(max(startHeight + e.clientY - startY, minHeight), maxHeight);\n\n      parent.style.width = newWidth + 'px';\n      parent.style.height = newHeight + 'px';\n\n      self.resizeHandler({\n        width: startWidth,\n        height: startHeight,\n        dx: e.clientX - startX,\n        dy: e.clientY - startY\n      });\n    };\n\n    var onMouseUp = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      domEvent.unbind(document,'mousemove', onMouseMove, false);\n      domEvent.unbind(document, 'mouseup', onMouseUp, false);\n    };\n\n    domEvent.bind(resizeHandle, 'mousedown', onMouseDown);\n  }\n\n  assign(resizeHandle.style, {\n    position: 'absolute',\n    bottom: '0px',\n    right: '0px',\n    cursor: 'nwse-resize',\n    width: '0',\n    height: '0',\n    borderTop: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent',\n    borderRight: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderBottom: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderLeft: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent'\n  });\n\n  parent.appendChild(resizeHandle);\n};\n\n\n/**\n * Clear content and style of the textbox, unbind listeners and\n * reset CSS style.\n */\nTextBox.prototype.destroy = function() {\n  var parent = this.parent,\n      content = this.content,\n      resizeHandle = this.resizeHandle;\n\n  // clear content\n  content.innerText = '';\n\n  // clear styles\n  parent.removeAttribute('style');\n  content.removeAttribute('style');\n\n  domEvent.unbind(content, 'keydown', this.keyHandler);\n  domEvent.unbind(content, 'mousedown', stopPropagation);\n  domEvent.unbind(content, 'input', this.autoResize);\n  domEvent.unbind(content, 'paste', this.handlePaste);\n\n  if (resizeHandle) {\n    resizeHandle.removeAttribute('style');\n\n    domRemove(resizeHandle);\n  }\n\n  domRemove(parent);\n};\n\n\nTextBox.prototype.getValue = function() {\n  return this.content.innerText.trim();\n};\n\n\nTextBox.prototype.getSelection = function() {\n  var selection = window.getSelection(),\n      range = selection.getRangeAt(0);\n\n  return range;\n};\n\n\nTextBox.prototype.setSelection = function(container, offset) {\n  var range = document.createRange();\n\n  if (container === null) {\n    range.selectNodeContents(this.content);\n  } else {\n    range.setStart(container, offset);\n    range.setEnd(container, offset);\n  }\n\n  var selection = window.getSelection();\n\n  selection.removeAllRanges();\n  selection.addRange(range);\n};\n","import {\n  bind,\n  find\n} from 'min-dash';\n\nimport TextBox from './TextBox';\n\n\n/**\n * A direct editing component that allows users\n * to edit an elements text directly in the diagram\n *\n * @param {EventBus} eventBus the event bus\n */\nexport default function DirectEditing(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n\n  this._providers = [];\n  this._textbox = new TextBox({\n    container: canvas.getContainer(),\n    keyHandler: bind(this._handleKey, this),\n    resizeHandler: bind(this._handleResize, this)\n  });\n}\n\nDirectEditing.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a direct editing provider\n\n * @param {Object} provider the provider, must expose an #activate(element) method that returns\n *                          an activation context ({ bounds: {x, y, width, height }, text }) if\n *                          direct editing is available for the given element.\n *                          Additionally the provider must expose a #update(element, value) method\n *                          to receive direct editing updates.\n */\nDirectEditing.prototype.registerProvider = function(provider) {\n  this._providers.push(provider);\n};\n\n\n/**\n * Returns true if direct editing is currently active\n *\n * @return {Boolean}\n */\nDirectEditing.prototype.isActive = function() {\n  return !!this._active;\n};\n\n\n/**\n * Cancel direct editing, if it is currently active\n */\nDirectEditing.prototype.cancel = function() {\n  if (!this._active) {\n    return;\n  }\n\n  this._fire('cancel');\n  this.close();\n};\n\n\nDirectEditing.prototype._fire = function(event, context) {\n  this._eventBus.fire('directEditing.' + event, context || { active: this._active });\n};\n\nDirectEditing.prototype.close = function() {\n  this._textbox.destroy();\n\n  this._fire('deactivate');\n\n  this._active = null;\n\n  this.resizable = undefined;\n};\n\n\nDirectEditing.prototype.complete = function() {\n\n  var active = this._active;\n\n  if (!active) {\n    return;\n  }\n\n  var containerBounds,\n      previousBounds = active.context.bounds,\n      newBounds = this.$textbox.getBoundingClientRect(),\n      newText = this.getValue(),\n      previousText = active.context.text;\n\n  if (\n    newText !== previousText ||\n    newBounds.height !== previousBounds.height ||\n    newBounds.width !== previousBounds.width\n  ) {\n    containerBounds = this._textbox.container.getBoundingClientRect();\n\n    active.provider.update(active.element, newText, active.context.text, {\n      x: newBounds.left - containerBounds.left,\n      y: newBounds.top - containerBounds.top,\n      width: newBounds.width,\n      height: newBounds.height\n    });\n  }\n\n  this._fire('complete');\n\n  this.close();\n};\n\n\nDirectEditing.prototype.getValue = function() {\n  return this._textbox.getValue();\n};\n\n\nDirectEditing.prototype._handleKey = function(e) {\n\n  // stop bubble\n  e.stopPropagation();\n\n  var key = e.keyCode || e.charCode;\n\n  // ESC\n  if (key === 27) {\n    e.preventDefault();\n    return this.cancel();\n  }\n\n  // Enter\n  if (key === 13 && !e.shiftKey) {\n    e.preventDefault();\n    return this.complete();\n  }\n};\n\n\nDirectEditing.prototype._handleResize = function(event) {\n  this._fire('resize', event);\n};\n\n\n/**\n * Activate direct editing on the given element\n *\n * @param {Object} ElementDescriptor the descriptor for a shape or connection\n * @return {Boolean} true if the activation was possible\n */\nDirectEditing.prototype.activate = function(element) {\n  if (this.isActive()) {\n    this.cancel();\n  }\n\n  // the direct editing context\n  var context;\n\n  var provider = find(this._providers, function(p) {\n    return (context = p.activate(element)) ? p : null;\n  });\n\n  // check if activation took place\n  if (context) {\n    this.$textbox = this._textbox.create(\n      context.bounds,\n      context.style,\n      context.text,\n      context.options\n    );\n\n    this._active = {\n      element: element,\n      context: context,\n      provider: provider\n    };\n\n    if (context.options && context.options.resizable) {\n      this.resizable = true;\n    }\n\n    this._fire('activate');\n  }\n\n  return !!context;\n};\n","import InteractionEventsModule from 'diagram-js/lib/features/interaction-events';\n\nimport DirectEditing from './lib/DirectEditing';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule\n  ],\n  __init__: [ 'directEditing' ],\n  directEditing: [ 'type', DirectEditing ]\n};","import {\n  assign,\n  isFunction,\n  isArray,\n  forEach,\n  isDefined\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  event as domEvent,\n  attr as domAttr,\n  query as domQuery,\n  classes as domClasses,\n  domify as domify\n} from 'min-dom';\n\nvar entrySelector = '.entry';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A context pad that displays element specific, contextual actions next\n * to a diagram element.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Overlays} overlays\n */\nexport default function ContextPad(config, eventBus, overlays) {\n\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._overlaysConfig = {\n    position: {\n      right: -9,\n      top: -6\n    },\n    scale: scale\n  };\n\n  this._current = null;\n\n  this._init();\n}\n\nContextPad.$inject = [\n  'config.contextPad',\n  'eventBus',\n  'overlays'\n];\n\n\n/**\n * Registers events needed for interaction with other components\n */\nContextPad.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n\n    var selection = e.newSelection;\n\n    if (selection.length === 1) {\n      self.open(selection[0]);\n    } else {\n      self.close();\n    }\n  });\n\n  eventBus.on('elements.delete', function(event) {\n    var elements = event.elements;\n\n    forEach(elements, function(e) {\n      if (self.isOpen(e)) {\n        self.close();\n      }\n    });\n  });\n\n  eventBus.on('element.changed', function(event) {\n    var element = event.element,\n        current = self._current;\n\n    // force reopen if element for which we are currently opened changed\n    if (current && current.element === element) {\n      self.open(element, true);\n    }\n  });\n};\n\n\n/**\n * Register a provider with the context pad\n *\n * @param  {Number} [priority=1000]\n * @param  {ContextPadProvider} provider\n *\n * @example\n * const contextPadProvider = {\n  *   getContextPadEntries: function(element) {\n  *     return function(entries) {\n  *       return {\n  *         ...entries,\n  *         'entry-1': {\n  *           label: 'My Entry',\n  *           action: function() { alert(\"I have been clicked!\"); }\n  *         }\n  *       };\n  *     }\n  *   }\n  * };\n  *\n * contextPad.registerProvider(800, contextPadProvider);\n */\nContextPad.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('contextPad.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n\n/**\n * Returns the context pad entries for a given element\n *\n * @param {djs.element.Base} element\n *\n * @return {Array<ContextPadEntryDescriptor>} list of entries\n */\nContextPad.prototype.getEntries = function(element) {\n  var providers = this._getProviders();\n\n  var entries = {};\n\n  // loop through all providers and their entries.\n  // group entries by id so that overriding an entry is possible\n  forEach(providers, function(provider) {\n    var entriesOrUpdater = provider.getContextPadEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\n\n/**\n * Trigger an action available on the opened context pad\n *\n * @param  {String} action\n * @param  {Event} event\n * @param  {Boolean} [autoActivate=false]\n */\nContextPad.prototype.trigger = function(action, event, autoActivate) {\n\n  var element = this._current.element,\n      entries = this._current.entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(originalEvent, element, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](originalEvent, element, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\n\n/**\n * Open the context pad for the given element\n *\n * @param {djs.model.Base} element\n * @param {Boolean} force if true, force reopening the context pad\n */\nContextPad.prototype.open = function(element, force) {\n  if (!force && this.isOpen(element)) {\n    return;\n  }\n\n  this.close();\n  this._updateAndOpen(element);\n};\n\nContextPad.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'contextPad.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nContextPad.prototype._updateAndOpen = function(element) {\n\n  var entries = this.getEntries(element),\n      pad = this.getPad(element),\n      html = pad.html;\n\n  forEach(entries, function(entry, id) {\n    var grouping = entry.group || 'default',\n        control = domify(entry.html || '<div class=\"entry\" draggable=\"true\"></div>'),\n        container;\n\n    domAttr(control, 'data-action', id);\n\n    container = domQuery('[data-group=' + grouping + ']', html);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      html.appendChild(container);\n    }\n\n    container.appendChild(control);\n\n    if (entry.className) {\n      addClasses(control, entry.className);\n    }\n\n    if (entry.title) {\n      domAttr(control, 'title', entry.title);\n    }\n\n    if (entry.imageUrl) {\n      control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n    }\n  });\n\n  domClasses(html).add('open');\n\n  this._current = {\n    element: element,\n    pad: pad,\n    entries: entries\n  };\n\n  this._eventBus.fire('contextPad.open', { current: this._current });\n};\n\n\nContextPad.prototype.getPad = function(element) {\n  if (this.isOpen()) {\n    return this._current.pad;\n  }\n\n  var self = this;\n\n  var overlays = this._overlays;\n\n  var html = domify('<div class=\"djs-context-pad\"></div>');\n\n  var overlaysConfig = assign({\n    html: html\n  }, this._overlaysConfig);\n\n  domDelegate.bind(html, entrySelector, 'click', function(event) {\n    self.trigger('click', event);\n  });\n\n  domDelegate.bind(html, entrySelector, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  // stop propagation of mouse events\n  domEvent.bind(html, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  this._overlayId = overlays.add(element, 'context-pad', overlaysConfig);\n\n  var pad = overlays.get(this._overlayId);\n\n  this._eventBus.fire('contextPad.create', { element: element, pad: pad });\n\n  return pad;\n};\n\n\n/**\n * Close the context pad\n */\nContextPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._overlays.remove(this._overlayId);\n\n  this._overlayId = null;\n\n  this._eventBus.fire('contextPad.close', { current: this._current });\n\n  this._current = null;\n};\n\n/**\n * Check if pad is open. If element is given, will check\n * if pad is opened with given element.\n *\n * @param {Element} element\n * @return {Boolean}\n */\nContextPad.prototype.isOpen = function(element) {\n  return !!this._current && (!element ? true : this._current.element === element);\n};\n\n\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}","import InteractionEventsModule from '../interaction-events';\nimport OverlaysModule from '../overlays';\n\nimport ContextPad from './ContextPad';\n\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    OverlaysModule\n  ],\n  contextPad: [ 'type', ContextPad ]\n};","import {\r\n  forEach\r\n} from 'min-dash';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  classes as svgClasses,\r\n  clone as svgClone,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nvar MARKER_TYPES = [\r\n  'marker-start',\r\n  'marker-mid',\r\n  'marker-end'\r\n];\r\n\r\nvar NODES_CAN_HAVE_MARKER = [\r\n  'circle',\r\n  'ellipse',\r\n  'line',\r\n  'path',\r\n  'polygon',\r\n  'polyline',\r\n  'rect'\r\n];\r\n\r\n\r\n/**\r\n * Adds support for previews of moving/resizing elements.\r\n */\r\nexport default function PreviewSupport(elementRegistry, eventBus, canvas, styles) {\r\n  this._elementRegistry = elementRegistry;\r\n  this._canvas = canvas;\r\n  this._styles = styles;\r\n\r\n  this._clonedMarkers = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('drag.cleanup', function() {\r\n    forEach(self._clonedMarkers, function(clonedMarker) {\r\n      svgRemove(clonedMarker);\r\n    });\r\n\r\n    self._clonedMarkers = {};\r\n  });\r\n}\r\n\r\nPreviewSupport.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas',\r\n  'styles'\r\n];\r\n\r\n\r\n/**\r\n * Returns graphics of an element.\r\n *\r\n * @param {djs.model.Base} element\r\n *\r\n * @return {SVGElement}\r\n */\r\nPreviewSupport.prototype.getGfx = function(element) {\r\n  return this._elementRegistry.getGraphics(element);\r\n};\r\n\r\n/**\r\n * Adds a move preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n * @param {SVGElement} [gfx]\r\n *\r\n * @return {SVGElement} dragger\r\n */\r\nPreviewSupport.prototype.addDragger = function(element, group, gfx) {\r\n  gfx = gfx || this.getGfx(element);\r\n\r\n  var dragger = svgClone(gfx);\r\n  var bbox = gfx.getBoundingClientRect();\r\n\r\n  this._cloneMarkers(getVisual(dragger));\r\n\r\n  svgAttr(dragger, this._styles.cls('djs-dragger', [], {\r\n    x: bbox.top,\r\n    y: bbox.left\r\n  }));\r\n\r\n  svgAppend(group, dragger);\r\n\r\n  return dragger;\r\n};\r\n\r\n/**\r\n * Adds a resize preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n *\r\n * @return {SVGElement} frame\r\n */\r\nPreviewSupport.prototype.addFrame = function(shape, group) {\r\n\r\n  var frame = svgCreate('rect', {\r\n    class: 'djs-resize-overlay',\r\n    width:  shape.width,\r\n    height: shape.height,\r\n    x: shape.x,\r\n    y: shape.y\r\n  });\r\n\r\n  svgAppend(group, frame);\r\n\r\n  return frame;\r\n};\r\n\r\n/**\r\n * Clone all markers referenced by a node and its child nodes.\r\n *\r\n * @param {SVGElement} gfx\r\n */\r\nPreviewSupport.prototype._cloneMarkers = function(gfx) {\r\n  var self = this;\r\n\r\n  if (gfx.childNodes) {\r\n\r\n    // TODO: use forEach once we drop PhantomJS\r\n    for (var i = 0; i < gfx.childNodes.length; i++) {\r\n\r\n      // recursively clone markers of child nodes\r\n      self._cloneMarkers(gfx.childNodes[ i ]);\r\n    }\r\n  }\r\n\r\n  if (!canHaveMarker(gfx)) {\r\n    return;\r\n  }\r\n\r\n  MARKER_TYPES.forEach(function(markerType) {\r\n    if (svgAttr(gfx, markerType)) {\r\n      var marker = getMarker(gfx, markerType, self._canvas.getContainer());\r\n\r\n      self._cloneMarker(gfx, marker, markerType);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Clone marker referenced by an element.\r\n *\r\n * @param {SVGElement} gfx\r\n * @param {SVGElement} marker\r\n * @param {string} markerType\r\n */\r\nPreviewSupport.prototype._cloneMarker = function(gfx, marker, markerType) {\r\n  var markerId = marker.id;\r\n\r\n  var clonedMarker = this._clonedMarkers[ markerId ];\r\n\r\n  if (!clonedMarker) {\r\n    clonedMarker = svgClone(marker);\r\n\r\n    var clonedMarkerId = markerId + '-clone';\r\n\r\n    clonedMarker.id = clonedMarkerId;\r\n\r\n    svgClasses(clonedMarker)\r\n      .add('djs-dragger')\r\n      .add('djs-dragger-marker');\r\n\r\n    this._clonedMarkers[ markerId ] = clonedMarker;\r\n\r\n    var defs = domQuery('defs', this._canvas._svg);\r\n\r\n    if (!defs) {\r\n      defs = svgCreate('defs');\r\n\r\n      svgAppend(this._canvas._svg, defs);\r\n    }\r\n\r\n    svgAppend(defs, clonedMarker);\r\n  }\r\n\r\n  var reference = idToReference(this._clonedMarkers[ markerId ].id);\r\n\r\n  svgAttr(gfx, markerType, reference);\r\n};\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get marker of given type referenced by node.\r\n *\r\n * @param {Node} node\r\n * @param {string} markerType\r\n * @param {Node} [parentNode]\r\n *\r\n * @param {Node}\r\n */\r\nfunction getMarker(node, markerType, parentNode) {\r\n  var id = referenceToId(svgAttr(node, markerType));\r\n\r\n  return domQuery('marker#' + id, parentNode || document);\r\n}\r\n\r\n/**\r\n * Get ID of fragment within current document from its functional IRI reference.\r\n * References may use single or double quotes.\r\n *\r\n * @param {string} reference\r\n *\r\n * @returns {string}\r\n */\r\nfunction referenceToId(reference) {\r\n  return reference.match(/url\\(['\"]?#([^'\"]*)['\"]?\\)/)[1];\r\n}\r\n\r\n/**\r\n * Get functional IRI reference for given ID of fragment within current document.\r\n *\r\n * @param {string} id\r\n *\r\n * @returns {string}\r\n */\r\nfunction idToReference(id) {\r\n  return 'url(#' + id + ')';\r\n}\r\n\r\n/**\r\n * Check wether node type can have marker attributes.\r\n *\r\n * @param {Node} node\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction canHaveMarker(node) {\r\n  return NODES_CAN_HAVE_MARKER.indexOf(node.nodeName) !== -1;\r\n}","import PreviewSupport from './PreviewSupport';\n\nexport default {\n  __init__: [ 'previewSupport' ],\n  previewSupport: [ 'type', PreviewSupport ]\n};\n","var MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_ATTACH = 'attach-ok',\n    MARKER_NEW_PARENT = 'new-parent';\n\nimport {\n  assign,\n  filter,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map\n} from 'min-dash';\n\nimport { getBBox } from '../../util/Elements';\n\nvar PREFIX = 'create';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * Create new elements through drag and drop.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function Create(\n    canvas,\n    dragging,\n    eventBus,\n    modeling,\n    rules\n) {\n\n  // rules //////////\n\n  /**\n   * Check wether elements can be created.\n   *\n   * @param {Array<djs.model.Base>} elements\n   * @param {djs.model.Base} target\n   * @param {Point} position\n   * @param {djs.model.Base} [source]\n   *\n   * @returns {boolean|null|Object}\n   */\n  function canCreate(elements, target, position, source) {\n    if (!target) {\n      return false;\n    }\n\n    // ignore child elements and external labels\n    elements = filter(elements, function(element) {\n      var labelTarget = element.labelTarget;\n\n      return !element.parent && !(isLabel(element) && elements.indexOf(labelTarget) !== -1);\n    });\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    var attach = false,\n        connect = false,\n        create = false;\n\n    // (1) attaching single shapes\n    if (isSingleShape(elements)) {\n      attach = rules.allowed('shape.attach', {\n        position: position,\n        shape: shape,\n        target: target\n      });\n    }\n\n    if (!attach) {\n\n      // (2) creating elements\n      if (isSingleShape(elements)) {\n        create = rules.allowed('shape.create', {\n          position: position,\n          shape: shape,\n          source: source,\n          target: target\n        });\n      } else {\n        create = rules.allowed('elements.create', {\n          elements: elements,\n          position: position,\n          target: target\n        });\n      }\n\n    }\n\n    // (3) appending single shapes\n    if (create || attach) {\n\n      if (shape && source) {\n        connect = rules.allowed('connection.create', {\n          source: source,\n          target: shape,\n          hints: {\n            targetParent: target,\n            targetAttach: attach\n          }\n        });\n      }\n\n      return {\n        attach: attach,\n        connect: connect\n      };\n    }\n\n    // ignore wether or not elements can be created\n    if (create === null || attach === null) {\n      return null;\n    }\n\n    return false;\n  }\n\n  function setMarker(element, marker) {\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  // event handling //////////\n\n  eventBus.on([ 'create.move', 'create.hover' ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hover = event.hover,\n        source = context.source;\n\n    if (!hover) {\n      context.canExecute = false;\n      context.target = null;\n\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    var canExecute = context.canExecute = hover && canCreate(elements, hover, position, source);\n\n    if (hover && canExecute !== null) {\n      context.target = hover;\n\n      if (canExecute && canExecute.attach) {\n        setMarker(hover, MARKER_ATTACH);\n      } else {\n        setMarker(hover, canExecute ? MARKER_NEW_PARENT : MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([ 'create.end', 'create.out', 'create.cleanup' ], function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      setMarker(hover, null);\n    }\n  });\n\n  eventBus.on('create.end', function(event) {\n    var context = event.context,\n        source = context.source,\n        shape = context.shape,\n        elements = context.elements,\n        target = context.target,\n        hints = context.hints,\n        canExecute = context.canExecute,\n        attach = canExecute && canExecute.attach,\n        connect = canExecute && canExecute.connect;\n\n    if (canExecute === false || !target) {\n      return false;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    if (connect) {\n      shape = modeling.appendShape(source, shape, position, target, {\n        attach: attach,\n        connection: connect === true ? {} : connect\n      });\n    } else {\n      elements = modeling.createElements(elements, position, target, assign({}, hints, {\n        attach: attach\n      }));\n\n      // update shape\n      shape = find(elements, function(element) {\n        return !isConnection(element);\n      });\n    }\n\n    // update elements and shape\n    assign(context, {\n      elements: elements,\n      shape: shape\n    });\n\n    assign(event, {\n      elements: elements,\n      shape: shape\n    });\n  });\n\n  function cancel() {\n    var context = dragging.context();\n\n    if (context && context.prefix === PREFIX) {\n      dragging.cancel();\n    }\n  }\n\n  // cancel on <elements.changed> that is not result of <drag.end>\n  eventBus.on('create.init', function() {\n    eventBus.on('elements.changed', cancel);\n\n    eventBus.once([ 'create.cancel', 'create.end' ], HIGH_PRIORITY, function() {\n      eventBus.off('elements.changed', cancel);\n    });\n  });\n\n  // API //////////\n\n  this.start = function(event, elements, context) {\n    if (!isArray(elements)) {\n      elements = [ elements ];\n    }\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    if (!shape) {\n\n      // at least one shape is required\n      return;\n    }\n\n    context = assign({\n      elements: elements,\n      hints: {},\n      shape: shape\n    }, context || {});\n\n    // make sure each element has x and y\n    forEach(elements, function(element) {\n      if (!isNumber(element.x)) {\n        element.x = 0;\n      }\n\n      if (!isNumber(element.y)) {\n        element.y = 0;\n      }\n    });\n\n    var bbox = getBBox(elements);\n\n    // center elements around cursor\n    forEach(elements, function(element) {\n      if (isConnection(element)) {\n        element.waypoints = map(element.waypoints, function(waypoint) {\n          return {\n            x: waypoint.x - bbox.x - bbox.width / 2,\n            y: waypoint.y - bbox.y - bbox.height / 2\n          };\n        });\n      }\n\n      assign(element, {\n        x: element.x - bbox.x - bbox.width / 2,\n        y: element.y - bbox.y - bbox.height / 2\n      });\n    });\n\n    dragging.init(event, PREFIX, {\n      cursor: 'grabbing',\n      autoActivate: true,\n      data: {\n        shape: shape,\n        elements: elements,\n        context: context\n      }\n    });\n  };\n}\n\nCreate.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules'\n];\n\n// helpers //////////\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  if (createConstraints.left) {\n    event.x = Math.max(event.x, createConstraints.left);\n  }\n\n  if (createConstraints.right) {\n    event.x = Math.min(event.x, createConstraints.right);\n  }\n\n  if (createConstraints.top) {\n    event.y = Math.max(event.y, createConstraints.top);\n  }\n\n  if (createConstraints.bottom) {\n    event.y = Math.min(event.y, createConstraints.bottom);\n  }\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isSingleShape(elements) {\n  return elements && elements.length === 1 && !isConnection(elements[0]);\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\r\n  translate\r\n} from '../../util/SvgTransformUtil';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nvar LOW_PRIORITY = 750;\r\n\r\n\r\nexport default function CreatePreview(\r\n    canvas,\r\n    eventBus,\r\n    graphicsFactory,\r\n    previewSupport,\r\n    styles\r\n) {\r\n  function createDragGroup(elements) {\r\n    var dragGroup = svgCreate('g');\r\n\r\n    svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\r\n\r\n    var childrenGfx = svgCreate('g');\r\n\r\n    elements.forEach(function(element) {\r\n\r\n      // create graphics\r\n      var gfx;\r\n\r\n      if (element.hidden) {\r\n        return;\r\n      }\r\n\r\n      if (element.waypoints) {\r\n        gfx = graphicsFactory._createContainer('connection', childrenGfx);\r\n\r\n        graphicsFactory.drawConnection(getVisual(gfx), element);\r\n      } else {\r\n        gfx = graphicsFactory._createContainer('shape', childrenGfx);\r\n\r\n        graphicsFactory.drawShape(getVisual(gfx), element);\r\n\r\n        translate(gfx, element.x, element.y);\r\n      }\r\n\r\n      // add preview\r\n      previewSupport.addDragger(element, dragGroup, gfx);\r\n    });\r\n\r\n    return dragGroup;\r\n  }\r\n\r\n  eventBus.on('create.move', LOW_PRIORITY, function(event) {\r\n\r\n    var hover = event.hover,\r\n        context = event.context,\r\n        elements = context.elements,\r\n        dragGroup = context.dragGroup;\r\n\r\n    // lazily create previews\r\n    if (!dragGroup) {\r\n      dragGroup = context.dragGroup = createDragGroup(elements);\r\n    }\r\n\r\n    var defaultLayer;\r\n\r\n    if (hover) {\r\n      if (!dragGroup.parentNode) {\r\n        defaultLayer = canvas.getDefaultLayer();\r\n\r\n        svgAppend(defaultLayer, dragGroup);\r\n      }\r\n\r\n      translate(dragGroup, event.x, event.y);\r\n    } else {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n\r\n  eventBus.on('create.cleanup', function(event) {\r\n    var context = event.context,\r\n        dragGroup = context.dragGroup;\r\n\r\n    if (dragGroup) {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n}\r\n\r\nCreatePreview.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'previewSupport',\r\n  'styles'\r\n];\r\n","import DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\nimport RulesModule from '../rules';\nimport SelectionModule from '../selection';\n\nimport Create from './Create';\nimport CreatePreview from './CreatePreview';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    PreviewSupportModule,\n    RulesModule,\n    SelectionModule\n  ],\n  __init__: [\n    'create',\n    'createPreview'\n  ],\n  create: [ 'type', Create ],\n  createPreview: [ 'type', CreatePreview ]\n};\n","import {\n  assign,\n  forEach,\n  isFunction,\n  isDefined,\n  omit,\n  size\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  domify as domify,\n  classes as domClasses,\n  attr as domAttr,\n  remove as domRemove\n} from 'min-dom';\n\nvar DATA_REF = 'data-id';\n\nvar CLOSE_EVENTS = [\n  'contextPad.close',\n  'canvas.viewbox.changing',\n  'commandStack.changed'\n];\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A popup menu that can be used to display a list of actions anywhere in the canvas.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n *\n * @class\n * @constructor\n */\nexport default function PopupMenu(config, eventBus, canvas) {\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._config = {\n    scale: scale\n  };\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._providers = {};\n  this._current = {};\n}\n\nPopupMenu.$inject = [\n  'config.popupMenu',\n  'eventBus',\n  'canvas'\n];\n\n/**\n * Registers a popup menu provider\n *\n * @param  {String} id\n * @param {Number} [priority=1000]\n * @param  {Object} provider\n *\n * @example\n * const popupMenuProvider = {\n *   getPopupMenuEntries: function(element) {\n *     return {\n *       'entry-1': {\n *         label: 'My Entry',\n *         action: function() { alert(\"I have been clicked!\"); }\n *       }\n *     }\n *   }\n * };\n *\n * popupMenu.registerProvider('myMenuID', popupMenuProvider);\n */\nPopupMenu.prototype.registerProvider = function(id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n/**\n * Determine if the popup menu has entries.\n *\n * @return {Boolean} true if empty\n */\nPopupMenu.prototype.isEmpty = function(element, providerId) {\n  if (!element) {\n    throw new Error('element parameter is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providerId parameter is missing');\n  }\n\n  var providers = this._getProviders(providerId);\n\n  if (!providers) {\n    return true;\n  }\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  var hasEntries = size(entries) > 0,\n      hasHeaderEntries = headerEntries && size(headerEntries) > 0;\n\n  return !hasEntries && !hasHeaderEntries;\n};\n\n\n/**\n * Create entries and open popup menu at given position\n *\n * @param  {Object} element\n * @param  {String} id provider id\n * @param  {Object} position\n *\n * @return {Object} popup menu instance\n */\nPopupMenu.prototype.open = function(element, id, position) {\n\n  var providers = this._getProviders(id);\n\n  if (!element) {\n    throw new Error('Element is missing');\n  }\n\n  if (!providers || !providers.length) {\n    throw new Error('No registered providers for: ' + id);\n  }\n\n  if (!position) {\n    throw new Error('the position argument is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  this._emit('open');\n\n  var current = this._current = {\n    className: id,\n    element: element,\n    position: position\n  };\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  current.entries = assign({}, entries, headerEntries);\n\n  current.container = this._createContainer();\n\n  if (size(headerEntries)) {\n    current.container.appendChild(\n      this._createEntries(headerEntries, 'djs-popup-header')\n    );\n  }\n\n  if (size(entries)) {\n    current.container.appendChild(\n      this._createEntries(entries, 'djs-popup-body')\n    );\n  }\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  this._attachContainer(current.container, parent, position.cursor);\n  this._bindAutoClose();\n};\n\n\n/**\n * Removes the popup menu and unbinds the event handlers.\n */\nPopupMenu.prototype.close = function() {\n\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this._unbindAutoClose();\n  domRemove(this._current.container);\n  this._current.container = null;\n};\n\n\n/**\n * Determine if an open popup menu exist.\n *\n * @return {Boolean} true if open\n */\nPopupMenu.prototype.isOpen = function() {\n  return !!this._current.container;\n};\n\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Object} event\n *\n * @return the result of the action callback, if any\n */\nPopupMenu.prototype.trigger = function(event) {\n\n  // silence other actions\n  event.preventDefault();\n\n  var element = event.delegateTarget || event.target,\n      entryId = domAttr(element, DATA_REF);\n\n  var entry = this._getEntry(entryId);\n\n  if (entry.action) {\n    return entry.action.call(null, event, entry);\n  }\n};\n\nPopupMenu.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nPopupMenu.prototype._getEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\nPopupMenu.prototype._getHeaderEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n\n      forEach(provider.getHeaderEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n\n\n};\n\n/**\n * Gets an entry instance (either entry or headerEntry) by id.\n *\n * @param  {String} entryId\n *\n * @return {Object} entry instance\n */\nPopupMenu.prototype._getEntry = function(entryId) {\n\n  var entry = this._current.entries[entryId];\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};\n\nPopupMenu.prototype._emit = function(eventName) {\n  this._eventBus.fire('popupMenu.' + eventName);\n};\n\n/**\n * Creates the popup menu container.\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createContainer = function() {\n  var container = domify('<div class=\"djs-popup\">'),\n      position = this._current.position,\n      className = this._current.className;\n\n  assign(container.style, {\n    position: 'absolute',\n    left: position.x + 'px',\n    top: position.y + 'px',\n    visibility: 'hidden'\n  });\n\n  domClasses(container).add(className);\n\n  return container;\n};\n\n\n/**\n * Attaches the container to the DOM.\n *\n * @param {Object} container\n * @param {Object} parent\n */\nPopupMenu.prototype._attachContainer = function(container, parent, cursor) {\n  var self = this;\n\n  // Event handler\n  domDelegate.bind(container, '.entry' ,'click', function(event) {\n    self.trigger(event);\n  });\n\n  this._updateScale(container);\n\n  // Attach to DOM\n  parent.appendChild(container);\n\n  if (cursor) {\n    this._assureIsInbounds(container, cursor);\n  }\n};\n\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @method _updateScale\n *\n * @param {Object} container\n */\nPopupMenu.prototype._updateScale = function(container) {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n\n  }\n\n  setTransform(container, 'scale(' + scale + ')');\n};\n\n\n/**\n * Make sure that the menu is always fully shown\n *\n * @method function\n *\n * @param  {Object} container\n * @param  {Position} cursor {x, y}\n */\nPopupMenu.prototype._assureIsInbounds = function(container, cursor) {\n  var canvas = this._canvas,\n      clientRect = canvas._container.getBoundingClientRect();\n\n  var containerX = container.offsetLeft,\n      containerY = container.offsetTop,\n      containerWidth = container.scrollWidth,\n      containerHeight = container.scrollHeight,\n      overAxis = {},\n      left, top;\n\n  var cursorPosition = {\n    x: cursor.x - clientRect.left,\n    y: cursor.y - clientRect.top\n  };\n\n  if (containerX + containerWidth > clientRect.width) {\n    overAxis.x = true;\n  }\n\n  if (containerY + containerHeight > clientRect.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  } else if (overAxis.x) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y + 'px';\n  } else if (overAxis.y && cursorPosition.y < containerHeight) {\n    left = cursorPosition.x + 'px';\n    top = 10 + 'px';\n  } else if (overAxis.y) {\n    left = cursorPosition.x + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  }\n\n  assign(container.style, { left: left, top: top }, { visibility: 'visible', 'z-index': 1000 });\n};\n\n\n/**\n * Creates a list of entries and returns them as a DOM container.\n *\n * @param {Array<Object>} entries an array of entry objects\n * @param {String} className the class name of the entry container\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntries = function(entries, className) {\n\n  var entriesContainer = domify('<div>'),\n      self = this;\n\n  domClasses(entriesContainer).add(className);\n\n  forEach(entries, function(entry, id) {\n    var entryContainer = self._createEntry(entry, id);\n    entriesContainer.appendChild(entryContainer);\n  });\n\n  return entriesContainer;\n};\n\n\n/**\n * Creates a single entry and returns it as a DOM container.\n *\n * @param  {Object} entry\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntry = function(entry, id) {\n\n  var entryContainer = domify('<div>'),\n      entryClasses = domClasses(entryContainer);\n\n  entryClasses.add('entry');\n\n  if (entry.className) {\n    entry.className.split(' ').forEach(function(className) {\n      entryClasses.add(className);\n    });\n  }\n\n  domAttr(entryContainer, DATA_REF, id);\n\n  if (entry.label) {\n    var label = domify('<span>');\n    label.textContent = entry.label;\n    entryContainer.appendChild(label);\n  }\n\n  if (entry.imageUrl) {\n    entryContainer.appendChild(domify('<img src=\"' + entry.imageUrl + '\" />'));\n  }\n\n  if (entry.active === true) {\n    entryClasses.add('active');\n  }\n\n  if (entry.disabled === true) {\n    entryClasses.add('disabled');\n  }\n\n  if (entry.title) {\n    entryContainer.title = entry.title;\n  }\n\n  return entryContainer;\n};\n\n\n/**\n * Set up listener to close popup automatically on certain events.\n */\nPopupMenu.prototype._bindAutoClose = function() {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n\n\n/**\n * Remove the auto-closing listener.\n */\nPopupMenu.prototype._unbindAutoClose = function() {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction setTransform(element, transform) {\n  element.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    element.style[prefix + 'transform'] = transform;\n  });\n}","import PopupMenu from './PopupMenu';\n\nexport default {\n  __init__: [ 'popupMenu' ],\n  popupMenu: [ 'type', PopupMenu ]\n};\n","/**\n * A clip board stub\n */\nexport default function Clipboard() {}\n\n\nClipboard.prototype.get = function() {\n  return this._data;\n};\n\nClipboard.prototype.set = function(data) {\n  this._data = data;\n};\n\nClipboard.prototype.clear = function() {\n  var data = this._data;\n\n  delete this._data;\n\n  return data;\n};\n\nClipboard.prototype.isEmpty = function() {\n  return !this._data;\n};","import Clipboard from './Clipboard';\n\nexport default {\n  clipboard: [ 'type', Clipboard ]\n};\n","export default function Mouse(eventBus) {\r\n  var self = this;\r\n\r\n  this._lastMoveEvent = null;\r\n\r\n  function setLastMoveEvent(mousemoveEvent) {\r\n    self._lastMoveEvent = mousemoveEvent;\r\n  }\r\n\r\n  eventBus.on('canvas.init', function(context) {\r\n    var svg = self._svg = context.svg;\r\n\r\n    svg.addEventListener('mousemove', setLastMoveEvent);\r\n  });\r\n\r\n  eventBus.on('canvas.destroy', function() {\r\n    self._lastMouseEvent = null;\r\n\r\n    self._svg.removeEventListener('mousemove', setLastMoveEvent);\r\n  });\r\n}\r\n\r\nMouse.$inject = [ 'eventBus' ];\r\n\r\nMouse.prototype.getLastMoveEvent = function() {\r\n  return this._lastMoveEvent || createMoveEvent(0, 0);\r\n};\r\n\r\n// helpers //////////\r\n\r\nexport function createMoveEvent(x, y) {\r\n  var event = document.createEvent('MouseEvent');\r\n\r\n  var screenX = x,\r\n      screenY = y,\r\n      clientX = x,\r\n      clientY = y;\r\n\r\n  if (event.initMouseEvent) {\r\n    event.initMouseEvent(\r\n      'mousemove',\r\n      true,\r\n      true,\r\n      window,\r\n      0,\r\n      screenX,\r\n      screenY,\r\n      clientX,\r\n      clientY,\r\n      false,\r\n      false,\r\n      false,\r\n      false,\r\n      0,\r\n      null\r\n    );\r\n  }\r\n\r\n  return event;\r\n}","import Mouse from './Mouse';\n\nexport default {\n  __init__: [ 'mouse' ],\n  mouse: [ 'type', Mouse ]\n};\n","import {\n  assign,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map,\n  matchPattern,\n  omit,\n  sortBy\n} from 'min-dash';\n\nimport {\n  getBBox,\n  getParents\n} from '../../util/Elements';\n\nimport { eachElement } from '../../util/Elements';\n\n/**\n * @typedef {Function} <copyPaste.canCopyElements> listener\n *\n * @param {Object} context\n * @param {Array<djs.model.Base>} context.elements\n *\n * @returns {Array<djs.model.Base>|boolean} - Return elements to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <copyPaste.copyElement> listener\n *\n * @param {Object} context\n * @param {Object} context.descriptor\n * @param {djs.model.Base} context.element\n * @param {Array<djs.model.Base>} context.elements\n */\n\n/**\n * @typedef {Function} <copyPaste.elementsCopied> listener\n *\n * @param {Object} context\n * @param {Object} context.elements\n * @param {Object} context.tree\n */\n\n/**\n * @typedef {Function} <copyPaste.pasteElement> listener\n *\n * @param {Object} context\n * @param {Object} context.cache - Already created elements.\n * @param {Object} context.descriptor\n */\n\n/**\n * @typedef {Function} <copyPaste.pasteElements> listener\n *\n * @param {Object} context\n * @param {Object} context.hints - Add hints before pasting.\n */\n\n/**\n * Copy and paste elements.\n *\n * @param {Canvas} canvas\n * @param {Create} create\n * @param {Clipboard} clipboard\n * @param {ElementFactory} elementFactory\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Mouse} mouse\n * @param {Rules} rules\n */\nexport default function CopyPaste(\n    canvas,\n    create,\n    clipboard,\n    elementFactory,\n    eventBus,\n    modeling,\n    mouse,\n    rules\n) {\n\n  this._canvas = canvas;\n  this._create = create;\n  this._clipboard = clipboard;\n  this._elementFactory = elementFactory;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._mouse = mouse;\n  this._rules = rules;\n\n  eventBus.on('copyPaste.copyElement', function(context) {\n    var descriptor = context.descriptor,\n        element = context.element,\n        elements = context.elements;\n\n    // default priority (priority = 1)\n    descriptor.priority = 1;\n\n    descriptor.id = element.id;\n\n    var parentCopied = find(elements, function(e) {\n      return e === element.parent;\n    });\n\n    // do NOT reference parent if parent wasn't copied\n    if (parentCopied) {\n      descriptor.parent = element.parent.id;\n    }\n\n    // attachers (priority = 2)\n    if (isAttacher(element)) {\n      descriptor.priority = 2;\n\n      descriptor.host = element.host.id;\n    }\n\n    // connections (priority = 3)\n    if (isConnection(element)) {\n      descriptor.priority = 3;\n\n      descriptor.source = element.source.id;\n      descriptor.target = element.target.id;\n\n      descriptor.waypoints = copyWaypoints(element);\n    }\n\n    // labels (priority = 4)\n    if (isLabel(element)) {\n      descriptor.priority = 4;\n\n      descriptor.labelTarget = element.labelTarget.id;\n    }\n\n    forEach([ 'x', 'y', 'width', 'height' ], function(property) {\n      if (isNumber(element[ property ])) {\n        descriptor[ property ] = element[ property ];\n      }\n    });\n\n    descriptor.hidden = element.hidden;\n    descriptor.collapsed = element.collapsed;\n\n  });\n\n  eventBus.on('copyPaste.pasteElements', function(context) {\n    var hints = context.hints;\n\n    assign(hints, {\n      createElementsBehavior: false\n    });\n  });\n}\n\nCopyPaste.$inject = [\n  'canvas',\n  'create',\n  'clipboard',\n  'elementFactory',\n  'eventBus',\n  'modeling',\n  'mouse',\n  'rules'\n];\n\n\n/**\n * Copy elements.\n *\n * @param {Array<djs.model.Base>} elements\n *\n * @returns {Object}\n */\nCopyPaste.prototype.copy = function(elements) {\n  var allowed,\n      tree;\n\n  if (!isArray(elements)) {\n    elements = elements ? [ elements ] : [];\n  }\n\n  allowed = this._eventBus.fire('copyPaste.canCopyElements', {\n    elements: elements\n  });\n\n  if (allowed === false) {\n    tree = {};\n  } else {\n    tree = this.createTree(isArray(allowed) ? allowed : elements);\n  }\n\n  // we set an empty tree, selection of elements\n  // to copy was empty.\n  this._clipboard.set(tree);\n\n  this._eventBus.fire('copyPaste.elementsCopied', {\n    elements: elements,\n    tree: tree\n  });\n\n  return tree;\n};\n\n/**\n * Paste elements.\n *\n * @param {Object} [context]\n * @param {djs.model.base} [context.element] - Parent.\n * @param {Point} [context.point] - Position.\n * @param {Object} [context.hints] - Hints.\n */\nCopyPaste.prototype.paste = function(context) {\n  var tree = this._clipboard.get();\n\n  if (this._clipboard.isEmpty()) {\n    return;\n  }\n\n  var hints = context && context.hints || {};\n\n  this._eventBus.fire('copyPaste.pasteElements', {\n    hints: hints\n  });\n\n  var elements = this._createElements(tree);\n\n  // paste directly\n  if (context && context.element && context.point) {\n    return this._paste(elements, context.element, context.point, hints);\n  }\n\n  this._create.start(this._mouse.getLastMoveEvent(), elements, {\n    hints: hints || {}\n  });\n};\n\n/**\n * Paste elements directly.\n *\n * @param {Array<djs.model.Base>} elements\n * @param {djs.model.base} target\n * @param {Point} position\n * @param {Object} [hints]\n */\nCopyPaste.prototype._paste = function(elements, target, position, hints) {\n\n  // make sure each element has x and y\n  forEach(elements, function(element) {\n    if (!isNumber(element.x)) {\n      element.x = 0;\n    }\n\n    if (!isNumber(element.y)) {\n      element.y = 0;\n    }\n  });\n\n  var bbox = getBBox(elements);\n\n  // center elements around cursor\n  forEach(elements, function(element) {\n    if (isConnection(element)) {\n      element.waypoints = map(element.waypoints, function(waypoint) {\n        return {\n          x: waypoint.x - bbox.x - bbox.width / 2,\n          y: waypoint.y - bbox.y - bbox.height / 2\n        };\n      });\n    }\n\n    assign(element, {\n      x: element.x - bbox.x - bbox.width / 2,\n      y: element.y - bbox.y - bbox.height / 2\n    });\n  });\n\n  return this._modeling.createElements(elements, position, target, assign({}, hints));\n};\n\n/**\n * Create elements from tree.\n */\nCopyPaste.prototype._createElements = function(tree) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var cache = {};\n\n  var elements = [];\n\n  forEach(tree, function(branch, depth) {\n\n    depth = parseInt(depth, 10);\n\n    // sort by priority\n    branch = sortBy(branch, 'priority');\n\n    forEach(branch, function(descriptor) {\n\n      // remove priority\n      var attrs = assign({}, omit(descriptor, [ 'priority' ]));\n\n      if (cache[ descriptor.parent ]) {\n        attrs.parent = cache[ descriptor.parent ];\n      } else {\n        delete attrs.parent;\n      }\n\n      eventBus.fire('copyPaste.pasteElement', {\n        cache: cache,\n        descriptor: attrs\n      });\n\n      var element;\n\n      if (isConnection(attrs)) {\n        attrs.source = cache[ descriptor.source ];\n        attrs.target = cache[ descriptor.target ];\n\n        element = cache[ descriptor.id ] = self.createConnection(attrs);\n\n        elements.push(element);\n\n        return;\n      }\n\n      if (isLabel(attrs)) {\n        attrs.labelTarget = cache[ attrs.labelTarget ];\n\n        element = cache[ descriptor.id ] = self.createLabel(attrs);\n\n        elements.push(element);\n\n        return;\n      }\n\n      if (attrs.host) {\n        attrs.host = cache[ attrs.host ];\n      }\n\n      element = cache[ descriptor.id ] = self.createShape(attrs);\n\n      elements.push(element);\n    });\n\n  });\n\n  return elements;\n};\n\nCopyPaste.prototype.createConnection = function(attrs) {\n  var connection = this._elementFactory.createConnection(omit(attrs, [ 'id' ]));\n\n  return connection;\n};\n\nCopyPaste.prototype.createLabel = function(attrs) {\n  var label = this._elementFactory.createLabel(omit(attrs, [ 'id' ]));\n\n  return label;\n};\n\nCopyPaste.prototype.createShape = function(attrs) {\n  var shape = this._elementFactory.createShape(omit(attrs, [ 'id' ]));\n\n  return shape;\n};\n\n/**\n * Check wether element has relations to other elements e.g. attachers, labels and connections.\n *\n * @param  {Object} element\n * @param  {Array<djs.model.Base>} elements\n *\n * @returns {Boolean}\n */\nCopyPaste.prototype.hasRelations = function(element, elements) {\n  var labelTarget,\n      source,\n      target;\n\n  if (isConnection(element)) {\n    source = find(elements, matchPattern({ id: element.source.id }));\n    target = find(elements, matchPattern({ id: element.target.id }));\n\n    if (!source || !target) {\n      return false;\n    }\n  }\n\n  if (isLabel(element)) {\n    labelTarget = find(elements, matchPattern({ id: element.labelTarget.id }));\n\n    if (!labelTarget) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/**\n * Create a tree-like structure from elements.\n *\n * @example\n * tree: {\n  *  0: [\n  *    { id: 'Shape_1', priority: 1, ... },\n  *    { id: 'Shape_2', priority: 1, ... },\n  *    { id: 'Connection_1', source: 'Shape_1', target: 'Shape_2', priority: 3, ... },\n  *    ...\n  *  ],\n  *  1: [\n  *    { id: 'Shape_3', parent: 'Shape1', priority: 1, ... },\n  *    ...\n  *  ]\n  * };\n  *\n  * @param  {Array<djs.model.base>} elements\n  *\n  * @return {Object}\n  */\nCopyPaste.prototype.createTree = function(elements) {\n  var rules = this._rules,\n      self = this;\n\n  var tree = {},\n      elementsData = [];\n\n  var parents = getParents(elements);\n\n  function canCopy(element, elements) {\n    return rules.allowed('element.copy', {\n      element: element,\n      elements: elements\n    });\n  }\n\n  function addElementData(element, depth) {\n\n    // (1) check wether element has already been added\n    var foundElementData = find(elementsData, function(elementsData) {\n      return element === elementsData.element;\n    });\n\n    // (2) add element if not already added\n    if (!foundElementData) {\n      elementsData.push({\n        element: element,\n        depth: depth\n      });\n\n      return;\n    }\n\n    // (3) update depth\n    if (foundElementData.depth < depth) {\n      elementsData = removeElementData(foundElementData, elementsData);\n\n      elementsData.push({\n        element: foundElementData.element,\n        depth: depth\n      });\n    }\n  }\n\n  function removeElementData(elementData, elementsData) {\n    var index = elementsData.indexOf(elementData);\n\n    if (index !== -1) {\n      elementsData.splice(index, 1);\n    }\n\n    return elementsData;\n  }\n\n  // (1) add elements\n  eachElement(parents, function(element, _index, depth) {\n\n    // do NOT add external labels directly\n    if (isLabel(element)) {\n      return;\n    }\n\n    // always copy external labels\n    forEach(element.labels, function(label) {\n      addElementData(label, depth);\n    });\n\n    function addRelatedElements(elements) {\n      elements && elements.length && forEach(elements, function(element) {\n\n        // add external labels\n        forEach(element.labels, function(label) {\n          addElementData(label, depth);\n        });\n\n        addElementData(element, depth);\n      });\n    }\n\n    forEach([ element.attachers, element.incoming, element.outgoing ], addRelatedElements);\n\n    addElementData(element, depth);\n\n    return element.children;\n  });\n\n  elements = map(elementsData, function(elementData) {\n    return elementData.element;\n  });\n\n  // (2) copy elements\n  elementsData = map(elementsData, function(elementData) {\n    elementData.descriptor = {};\n\n    self._eventBus.fire('copyPaste.copyElement', {\n      descriptor: elementData.descriptor,\n      element: elementData.element,\n      elements: elements\n    });\n\n    return elementData;\n  });\n\n  // (3) sort elements by priority\n  elementsData = sortBy(elementsData, function(elementData) {\n    return elementData.descriptor.priority;\n  });\n\n  elements = map(elementsData, function(elementData) {\n    return elementData.element;\n  });\n\n  // (4) create tree\n  forEach(elementsData, function(elementData) {\n    var depth = elementData.depth;\n\n    if (!self.hasRelations(elementData.element, elements)) {\n      removeElement(elementData.element, elements);\n\n      return;\n    }\n\n    if (!canCopy(elementData.element, elements)) {\n      removeElement(elementData.element, elements);\n\n      return;\n    }\n\n    if (!tree[depth]) {\n      tree[depth] = [];\n    }\n\n    tree[depth].push(elementData.descriptor);\n  });\n\n  return tree;\n};\n\n// helpers //////////\n\nfunction isAttacher(element) {\n  return !!element.host;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n\nfunction copyWaypoints(element) {\n  return map(element.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction removeElement(element, elements) {\n  var index = elements.indexOf(element);\n\n  if (index === -1) {\n    return elements;\n  }\n\n  return elements.splice(index, 1);\n}\n","import ClipboardModule from '../clipboard';\nimport CreateModule from '../create';\nimport MouseModule from '../mouse';\nimport RulesModule from '../rules';\n\nimport CopyPaste from './CopyPaste';\n\n\nexport default {\n  __depends__: [\n    ClipboardModule,\n    CreateModule,\n    MouseModule,\n    RulesModule\n  ],\n  __init__: [ 'copyPaste' ],\n  copyPaste: [ 'type', CopyPaste ]\n};\n","import {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  forEach,\n  isArray,\n  isUndefined,\n  omit,\n  reduce\n} from 'min-dash';\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nfunction removeProperties(element, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (element[property]) {\n      delete element[property];\n    }\n  });\n}\n\nvar LOW_PRIORITY = 750;\n\n\nexport default function BpmnCopyPaste(bpmnFactory, eventBus, moddleCopy) {\n\n  eventBus.on('copyPaste.copyElement', LOW_PRIORITY, function(context) {\n    var descriptor = context.descriptor,\n        element = context.element;\n\n    var businessObject = descriptor.oldBusinessObject = getBusinessObject(element);\n\n    descriptor.type = element.type;\n\n    copyProperties(businessObject, descriptor, 'name');\n\n    descriptor.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(businessObject.di, descriptor.di, [\n      'fill',\n      'stroke'\n    ]);\n\n    copyProperties(businessObject.di, descriptor, 'isExpanded');\n\n    if (isLabel(descriptor)) {\n      return descriptor;\n    }\n\n    // default sequence flow\n    if (businessObject.default) {\n      descriptor.default = businessObject.default.id;\n    }\n  });\n\n  eventBus.on('moddleCopy.canCopyProperty', function(context) {\n    var parent = context.parent,\n        property = context.property,\n        propertyName = context.propertyName,\n        bpmnProcess;\n\n    if (\n      propertyName === 'processRef' &&\n      is(parent, 'bpmn:Participant') &&\n      is(property, 'bpmn:Process')\n    ) {\n      bpmnProcess = bpmnFactory.create('bpmn:Process');\n\n      // return copy of process\n      return moddleCopy.copyElement(property, bpmnProcess);\n    }\n  });\n\n  var references;\n\n  function resolveReferences(descriptor, cache) {\n    var businessObject = getBusinessObject(descriptor);\n\n    // default sequence flows\n    if (descriptor.default) {\n\n      // relationship cannot be resolved immediately\n      references[ descriptor.default ] = {\n        element: businessObject,\n        property: 'default'\n      };\n    }\n\n    // boundary events\n    if (descriptor.host) {\n\n      // relationship can be resolved immediately\n      getBusinessObject(descriptor).attachedToRef = getBusinessObject(cache[ descriptor.host ]);\n    }\n\n    references = omit(references, reduce(references, function(array, reference, key) {\n      var element = reference.element,\n          property = reference.property;\n\n      if (key === descriptor.id) {\n        element[ property ] = businessObject;\n\n        array.push(descriptor.id);\n      }\n\n      return array;\n    }, []));\n  }\n\n  eventBus.on('copyPaste.pasteElements', function() {\n    references = {};\n  });\n\n  eventBus.on('copyPaste.pasteElement', function(context) {\n    var cache = context.cache,\n        descriptor = context.descriptor,\n        oldBusinessObject = descriptor.oldBusinessObject,\n        newBusinessObject;\n\n    // do NOT copy business object if external label\n    if (isLabel(descriptor)) {\n      descriptor.businessObject = getBusinessObject(cache[ descriptor.labelTarget ]);\n\n      return;\n    }\n\n    newBusinessObject = bpmnFactory.create(oldBusinessObject.$type);\n\n    descriptor.businessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject\n    );\n\n    // resolve references e.g. default sequence flow\n    resolveReferences(descriptor, cache);\n\n    copyProperties(descriptor, newBusinessObject, [\n      'isExpanded',\n      'name'\n    ]);\n\n    removeProperties(descriptor, 'oldBusinessObject');\n  });\n\n}\n\n\nBpmnCopyPaste.$inject = [\n  'bpmnFactory',\n  'eventBus',\n  'moddleCopy'\n];\n\n// helpers //////////\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\n  find,\n  forEach,\n  isArray,\n  isDefined,\n  isObject,\n  matchPattern,\n  reduce,\n  has,\n  sortBy\n} from 'min-dash';\n\nvar DISALLOWED_PROPERTIES = [\n  'artifacts',\n  'dataInputAssociations',\n  'dataOutputAssociations',\n  'default',\n  'flowElements',\n  'lanes',\n  'incoming',\n  'outgoing'\n];\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperties> listener\n *\n * @param {Object} context\n * @param {Array<string>} context.propertyNames\n * @param {ModdleElement} context.sourceElement\n * @param {ModdleElement} context.targetElement\n *\n * @returns {Array<string>|boolean} - Return properties to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {*|boolean} - Return copied property or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canSetCopiedProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {boolean} - Return false to disallow\n * setting copied property.\n */\n\n/**\n * Utility for copying model properties from source element to target element.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n * @param {BpmnModdle} moddle\n */\nexport default function ModdleCopy(eventBus, bpmnFactory, moddle) {\n  this._bpmnFactory = bpmnFactory;\n  this._eventBus = eventBus;\n  this._moddle = moddle;\n\n  // copy extension elements last\n  eventBus.on('moddleCopy.canCopyProperties', function(context) {\n    var propertyNames = context.propertyNames;\n\n    if (!propertyNames || !propertyNames.length) {\n      return;\n    }\n\n    return sortBy(propertyNames, function(propertyName) {\n      return propertyName === 'extensionElements';\n    });\n  });\n\n  // default check whether property can be copied\n  eventBus.on('moddleCopy.canCopyProperty', function(context) {\n    var parent = context.parent,\n        parentDescriptor = isObject(parent) && parent.$descriptor,\n        propertyName = context.propertyName;\n\n    if (propertyName && DISALLOWED_PROPERTIES.indexOf(propertyName) !== -1) {\n\n      // disallow copying property\n      return false;\n    }\n\n    if (propertyName &&\n      parentDescriptor &&\n      !find(parentDescriptor.properties, matchPattern({ name: propertyName }))) {\n\n      // disallow copying property\n      return false;\n    }\n  });\n\n  // do NOT allow to copy empty extension elements\n  eventBus.on('moddleCopy.canSetCopiedProperty', function(context) {\n    var property = context.property;\n\n    if (is(property, 'bpmn:ExtensionElements') && (!property.values || !property.values.length)) {\n\n      // disallow setting copied property\n      return false;\n    }\n  });\n}\n\nModdleCopy.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'moddle'\n];\n\n/**\n * Copy model properties of source element to target element.\n *\n * @param {ModdleElement} sourceElement\n * @param {ModdleElement} targetElement\n * @param {Array<string>} [propertyNames]\n *\n * @param {ModdleElement}\n */\nModdleCopy.prototype.copyElement = function(sourceElement, targetElement, propertyNames) {\n  var self = this;\n\n  if (propertyNames && !isArray(propertyNames)) {\n    propertyNames = [ propertyNames ];\n  }\n\n  propertyNames = propertyNames || getPropertyNames(sourceElement.$descriptor);\n\n  var canCopyProperties = this._eventBus.fire('moddleCopy.canCopyProperties', {\n    propertyNames: propertyNames,\n    sourceElement: sourceElement,\n    targetElement: targetElement\n  });\n\n  if (canCopyProperties === false) {\n    return targetElement;\n  }\n\n  if (isArray(canCopyProperties)) {\n    propertyNames = canCopyProperties;\n  }\n\n  // copy properties\n  forEach(propertyNames, function(propertyName) {\n    var sourceProperty;\n\n    if (has(sourceElement, propertyName)) {\n      sourceProperty = sourceElement.get(propertyName);\n    }\n\n    var copiedProperty = self.copyProperty(sourceProperty, targetElement, propertyName);\n\n    var canSetProperty = self._eventBus.fire('moddleCopy.canSetCopiedProperty', {\n      parent: parent,\n      property: copiedProperty,\n      propertyName: propertyName\n    });\n\n    if (canSetProperty === false) {\n      return;\n    }\n\n    if (isDefined(copiedProperty)) {\n      targetElement.set(propertyName, copiedProperty);\n    }\n  });\n\n  return targetElement;\n};\n\n/**\n * Copy model property.\n *\n * @param {*} property\n * @param {ModdleElement} parent\n * @param {string} propertyName\n *\n * @returns {*}\n */\nModdleCopy.prototype.copyProperty = function(property, parent, propertyName) {\n  var self = this;\n\n  // allow others to copy property\n  var copiedProperty = this._eventBus.fire('moddleCopy.canCopyProperty', {\n    parent: parent,\n    property: property,\n    propertyName: propertyName\n  });\n\n  // return if copying is NOT allowed\n  if (copiedProperty === false) {\n    return;\n  }\n\n  if (copiedProperty) {\n    if (isObject(copiedProperty) && copiedProperty.$type && !copiedProperty.$parent) {\n      copiedProperty.$parent = parent;\n    }\n\n    return copiedProperty;\n  }\n\n  var propertyDescriptor = this._moddle.getPropertyDescriptor(parent, propertyName);\n\n  // do NOT copy Ids and references\n  if (propertyDescriptor.isId || propertyDescriptor.isReference) {\n    return;\n  }\n\n  // copy arrays\n  if (isArray(property)) {\n    return reduce(property, function(childProperties, childProperty) {\n\n      // recursion\n      copiedProperty = self.copyProperty(childProperty, parent, propertyName);\n\n      // copying might NOT be allowed\n      if (copiedProperty) {\n        copiedProperty.$parent = parent;\n\n        return childProperties.concat(copiedProperty);\n      }\n\n      return childProperties;\n    }, []);\n  }\n\n  // copy model elements\n  if (isObject(property) && property.$type) {\n    if (this._moddle.getElementDescriptor(property).isGeneric) {\n      return;\n    }\n\n    copiedProperty = self._bpmnFactory.create(property.$type);\n\n    copiedProperty.$parent = parent;\n\n    // recursion\n    copiedProperty = self.copyElement(property, copiedProperty);\n\n    return copiedProperty;\n  }\n\n  // copy primitive properties\n  return property;\n};\n\n// helpers //////////\n\nexport function getPropertyNames(descriptor, keepDefaultProperties) {\n  return reduce(descriptor.properties, function(properties, property) {\n\n    if (keepDefaultProperties && property.default) {\n      return properties;\n    }\n\n    return properties.concat(property.name);\n  }, []);\n}\n\nfunction is(element, type) {\n  return element && (typeof element.$instanceOf === 'function') && element.$instanceOf(type);\n}","import CopyPasteModule from 'diagram-js/lib/features/copy-paste';\n\nimport BpmnCopyPaste from './BpmnCopyPaste';\nimport ModdleCopy from './ModdleCopy';\n\nexport default {\n  __depends__: [\n    CopyPasteModule\n  ],\n  __init__: [ 'bpmnCopyPaste', 'moddleCopy' ],\n  bpmnCopyPaste: [ 'type', BpmnCopyPaste ],\n  moddleCopy: [ 'type', ModdleCopy ]\n};\n","import {\n  assign\n} from 'min-dash';\n\nvar round = Math.round;\n\n/**\n * Service that allow replacing of elements.\n */\nexport default function Replace(modeling) {\n\n  this._modeling = modeling;\n}\n\nReplace.$inject = [ 'modeling' ];\n\n/**\n * @param {Element} oldElement - Element to be replaced\n * @param {Object}  newElementData - Containing information about the new element,\n *                                   for example the new bounds and type.\n * @param {Object}  options - Custom options that will be attached to the context. It can be used to inject data\n *                            that is needed in the command chain. For example it could be used in\n *                            eventbus.on('commandStack.shape.replace.postExecute') to change shape attributes after\n *                            shape creation.\n */\nReplace.prototype.replaceElement = function(oldElement, newElementData, options) {\n\n  if (oldElement.waypoints) {\n\n    // TODO(nikku): we do not replace connections, yet\n    return null;\n  }\n\n  var modeling = this._modeling;\n\n  var width = newElementData.width || oldElement.width,\n      height = newElementData.height || oldElement.height,\n      x = newElementData.x || oldElement.x,\n      y = newElementData.y || oldElement.y,\n      centerX = round(x + width / 2),\n      centerY = round(y + height / 2);\n\n  // modeling API requires center coordinates,\n  // account for that when handling shape bounds\n\n  return modeling.replaceShape(\n    oldElement,\n    assign(\n      {},\n      newElementData,\n      {\n        x: centerX,\n        y: centerY,\n        width: width,\n        height: height\n      }\n    ),\n    options\n  );\n};\n","import Replace from './Replace';\n\nexport default {\n  __init__: [ 'replace' ],\n  replace: [ 'type', Replace ]\n};","import {\n  pick,\n  assign,\n  filter,\n  forEach,\n  isArray,\n  isUndefined,\n  has\n} from 'min-dash';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../util/ModelUtil';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess\n} from '../../util/DiUtil';\n\nimport { getPropertyNames } from '../copy-paste/ModdleCopy';\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nvar CUSTOM_PROPERTIES = [\n  'cancelActivity',\n  'instantiate',\n  'eventGatewayType',\n  'triggeredByEvent',\n  'isInterrupting'\n];\n\n\nfunction toggeling(element, target) {\n\n  var oldCollapsed = (\n    element && has(element, 'collapsed') ? element.collapsed : !isExpanded(element)\n  );\n\n  var targetCollapsed;\n\n  if (target && (has(target, 'collapsed') || has(target, 'isExpanded'))) {\n\n    // property is explicitly set so use it\n    targetCollapsed = (\n      has(target, 'collapsed') ? target.collapsed : !target.isExpanded\n    );\n  } else {\n\n    // keep old state\n    targetCollapsed = oldCollapsed;\n  }\n\n  if (oldCollapsed !== targetCollapsed) {\n    element.collapsed = oldCollapsed;\n    return true;\n  }\n\n  return false;\n}\n\n\n\n/**\n * This module takes care of replacing BPMN elements\n */\nexport default function BpmnReplace(\n    bpmnFactory,\n    elementFactory,\n    moddleCopy,\n    modeling,\n    replace,\n    selection\n) {\n\n  /**\n   * Prepares a new business object for the replacement element\n   * and triggers the replace operation.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {Object} target\n   * @param  {Object} [hints]\n   *\n   * @return {djs.model.Base} the newly created element\n   */\n  function replaceElement(element, target, hints) {\n\n    hints = hints || {};\n\n    var type = target.type,\n        oldBusinessObject = element.businessObject;\n\n    if (isSubProcess(oldBusinessObject)) {\n      if (type === 'bpmn:SubProcess') {\n        if (toggeling(element, target)) {\n\n          // expanding or collapsing process\n          modeling.toggleCollapse(element);\n\n          return element;\n        }\n      }\n    }\n\n    var newBusinessObject = bpmnFactory.create(type);\n\n    var newElement = {\n      type: type,\n      businessObject: newBusinessObject\n    };\n\n    var elementProps = getPropertyNames(oldBusinessObject.$descriptor),\n        newElementProps = getPropertyNames(newBusinessObject.$descriptor, true),\n        copyProps = intersection(elementProps, newElementProps);\n\n    // initialize special properties defined in target definition\n    assign(newBusinessObject, pick(target, CUSTOM_PROPERTIES));\n\n    var properties = filter(copyProps, function(propertyName) {\n\n      // copying event definitions, unless we replace\n      if (propertyName === 'eventDefinitions') {\n        return hasEventDefinition(element, target.eventDefinitionType);\n      }\n\n      // retain loop characteristics if the target element\n      // is not an event sub process\n      if (propertyName === 'loopCharacteristics') {\n        return !isEventSubProcess(newBusinessObject);\n      }\n\n      // so the applied properties from 'target' don't get lost\n      if (newBusinessObject.hasOwnProperty(propertyName)) {\n        return false;\n      }\n\n      if (propertyName === 'processRef' && target.isExpanded === false) {\n        return false;\n      }\n\n      if (propertyName === 'triggeredByEvent') {\n        return false;\n      }\n\n      return true;\n    });\n\n    newBusinessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject,\n      properties\n    );\n\n    // initialize custom BPMN extensions\n    if (target.eventDefinitionType) {\n\n      // only initialize with new eventDefinition\n      // if we did not set an event definition yet,\n      // i.e. because we copied it\n      if (!hasEventDefinition(newBusinessObject, target.eventDefinitionType)) {\n        newElement.eventDefinitionType = target.eventDefinitionType;\n      }\n    }\n\n    if (is(oldBusinessObject, 'bpmn:Activity')) {\n\n      if (isSubProcess(oldBusinessObject)) {\n\n        // no toggeling, so keep old state\n        newElement.isExpanded = isExpanded(oldBusinessObject);\n      }\n\n      // else if property is explicitly set, use it\n      else if (target && has(target, 'isExpanded')) {\n        newElement.isExpanded = target.isExpanded;\n      }\n\n      // TODO: need also to respect min/max Size\n      // copy size, from an expanded subprocess to an expanded alternative subprocess\n      // except bpmn:Task, because Task is always expanded\n      if ((isExpanded(oldBusinessObject) && !is(oldBusinessObject, 'bpmn:Task')) && newElement.isExpanded) {\n        newElement.width = element.width;\n        newElement.height = element.height;\n      }\n    }\n\n    // remove children if not expanding sub process\n    if (isSubProcess(oldBusinessObject) && !isSubProcess(newBusinessObject)) {\n      hints.moveChildren = false;\n    }\n\n    // transform collapsed/expanded pools\n    if (is(oldBusinessObject, 'bpmn:Participant')) {\n\n      // create expanded pool\n      if (target.isExpanded === true) {\n        newBusinessObject.processRef = bpmnFactory.create('bpmn:Process');\n      } else {\n\n        // remove children when transforming to collapsed pool\n        hints.moveChildren = false;\n      }\n\n      // apply same width and default height\n      newElement.width = element.width;\n      newElement.height = elementFactory._getDefaultSize(newBusinessObject).height;\n    }\n\n    newBusinessObject.name = oldBusinessObject.name;\n\n    // retain default flow's reference between inclusive <-> exclusive gateways and activities\n    if (\n      isAny(oldBusinessObject, [\n        'bpmn:ExclusiveGateway',\n        'bpmn:InclusiveGateway',\n        'bpmn:Activity'\n      ]) &&\n      isAny(newBusinessObject, [\n        'bpmn:ExclusiveGateway',\n        'bpmn:InclusiveGateway',\n        'bpmn:Activity'\n      ])\n    ) {\n      newBusinessObject.default = oldBusinessObject.default;\n    }\n\n    if (\n      target.host &&\n      !is(oldBusinessObject, 'bpmn:BoundaryEvent') &&\n      is(newBusinessObject, 'bpmn:BoundaryEvent')\n    ) {\n      newElement.host = target.host;\n    }\n\n    newElement.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(oldBusinessObject.di, newElement.di, [\n      'fill',\n      'stroke'\n    ]);\n\n    newElement = replace.replaceElement(element, newElement, hints);\n\n    if (hints.select !== false) {\n      selection.select(newElement);\n    }\n\n    return newElement;\n  }\n\n  this.replaceElement = replaceElement;\n}\n\nBpmnReplace.$inject = [\n  'bpmnFactory',\n  'elementFactory',\n  'moddleCopy',\n  'modeling',\n  'replace',\n  'selection'\n];\n\n\nfunction isSubProcess(bo) {\n  return is(bo, 'bpmn:SubProcess');\n}\n\nfunction hasEventDefinition(element, type) {\n\n  var bo = getBusinessObject(element);\n\n  return type && bo.get('eventDefinitions').some(function(definition) {\n    return is(definition, type);\n  });\n}\n\n/**\n * Compute intersection between two arrays.\n */\nfunction intersection(a1, a2) {\n  return a1.filter(function(el) {\n    return a2.indexOf(el) !== -1;\n  });\n}\n","import CopyPasteModule from '../copy-paste';\nimport ReplaceModule from 'diagram-js/lib/features/replace';\nimport SelectionModule from 'diagram-js/lib/features/selection';\n\nimport BpmnReplace from './BpmnReplace';\n\nexport default {\n  __depends__: [\n    CopyPasteModule,\n    ReplaceModule,\n    SelectionModule\n  ],\n  bpmnReplace: [ 'type', BpmnReplace ]\n};\n","import {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isExpanded\n} from '../../../util/DiUtil';\n\n\n/**\n * Returns true, if an element is from a different type\n * than a target definition. Takes into account the type,\n * event definition type and triggeredByEvent property.\n *\n * @param {djs.model.Base} element\n *\n * @return {Boolean}\n */\nexport function isDifferentType(element) {\n\n  return function(entry) {\n    var target = entry.target;\n\n    var businessObject = getBusinessObject(element),\n        eventDefinition = businessObject.eventDefinitions && businessObject.eventDefinitions[0];\n\n    var isTypeEqual = businessObject.$type === target.type;\n\n    var isEventDefinitionEqual = (\n      (eventDefinition && eventDefinition.$type) === target.eventDefinitionType\n    );\n\n    var isTriggeredByEventEqual = (\n      businessObject.triggeredByEvent === target.triggeredByEvent\n    );\n\n    var isExpandedEqual = (\n      target.isExpanded === undefined ||\n      target.isExpanded === isExpanded(businessObject)\n    );\n\n    return !isTypeEqual || !isEventDefinitionEqual || !isTriggeredByEventEqual || !isExpandedEqual;\n  };\n}","export var START_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throwing',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message Start Event',\n    actionName: 'replace-with-message-start',\n    className: 'bpmn-icon-start-event-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Start Event',\n    actionName: 'replace-with-timer-start',\n    className: 'bpmn-icon-start-event-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Start Event',\n    actionName: 'replace-with-conditional-start',\n    className: 'bpmn-icon-start-event-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Start Event',\n    actionName: 'replace-with-signal-start',\n    className: 'bpmn-icon-start-event-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  }\n];\n\nexport var INTERMEDIATE_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message Intermediate Catch Event',\n    actionName: 'replace-with-message-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-message',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Message Intermediate Throw Event',\n    actionName: 'replace-with-message-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-message',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Intermediate Catch Event',\n    actionName: 'replace-with-timer-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-timer',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Intermediate Throw Event',\n    actionName: 'replace-with-escalation-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-escalation',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Intermediate Catch Event',\n    actionName: 'replace-with-conditional-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-condition',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Link Intermediate Catch Event',\n    actionName: 'replace-with-link-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-link',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:LinkEventDefinition'\n    }\n  },\n  {\n    label: 'Link Intermediate Throw Event',\n    actionName: 'replace-with-link-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-link',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:LinkEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Intermediate Throw Event',\n    actionName: 'replace-with-compensation-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-compensation',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Intermediate Catch Event',\n    actionName: 'replace-with-signal-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-signal',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Intermediate Throw Event',\n    actionName: 'replace-with-signal-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-signal',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  }\n];\n\nexport var END_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message End Event',\n    actionName: 'replace-with-message-end',\n    className: 'bpmn-icon-end-event-message',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation End Event',\n    actionName: 'replace-with-escalation-end',\n    className: 'bpmn-icon-end-event-escalation',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Error End Event',\n    actionName: 'replace-with-error-end',\n    className: 'bpmn-icon-end-event-error',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Cancel End Event',\n    actionName: 'replace-with-cancel-end',\n    className: 'bpmn-icon-end-event-cancel',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:CancelEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation End Event',\n    actionName: 'replace-with-compensation-end',\n    className: 'bpmn-icon-end-event-compensation',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Signal End Event',\n    actionName: 'replace-with-signal-end',\n    className: 'bpmn-icon-end-event-signal',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Terminate End Event',\n    actionName: 'replace-with-terminate-end',\n    className: 'bpmn-icon-end-event-terminate',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:TerminateEventDefinition'\n    }\n  }\n];\n\nexport var GATEWAY = [\n  {\n    label: 'Exclusive Gateway',\n    actionName: 'replace-with-exclusive-gateway',\n    className: 'bpmn-icon-gateway-xor',\n    target: {\n      type: 'bpmn:ExclusiveGateway'\n    }\n  },\n  {\n    label: 'Parallel Gateway',\n    actionName: 'replace-with-parallel-gateway',\n    className: 'bpmn-icon-gateway-parallel',\n    target: {\n      type: 'bpmn:ParallelGateway'\n    }\n  },\n  {\n    label: 'Inclusive Gateway',\n    actionName: 'replace-with-inclusive-gateway',\n    className: 'bpmn-icon-gateway-or',\n    target: {\n      type: 'bpmn:InclusiveGateway'\n    }\n  },\n  {\n    label: 'Complex Gateway',\n    actionName: 'replace-with-complex-gateway',\n    className: 'bpmn-icon-gateway-complex',\n    target: {\n      type: 'bpmn:ComplexGateway'\n    }\n  },\n  {\n    label: 'Event based Gateway',\n    actionName: 'replace-with-event-based-gateway',\n    className: 'bpmn-icon-gateway-eventbased',\n    target: {\n      type: 'bpmn:EventBasedGateway',\n      instantiate: false,\n      eventGatewayType: 'Exclusive'\n    }\n  }\n\n  // Gateways deactivated until https://github.com/bpmn-io/bpmn-js/issues/194\n  // {\n  //   label: 'Event based instantiating Gateway',\n  //   actionName: 'replace-with-exclusive-event-based-gateway',\n  //   className: 'bpmn-icon-exclusive-event-based',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Exclusive' }\n  //   }\n  // },\n  // {\n  //   label: 'Parallel Event based instantiating Gateway',\n  //   actionName: 'replace-with-parallel-event-based-instantiate-gateway',\n  //   className: 'bpmn-icon-parallel-event-based-instantiate-gateway',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Parallel' }\n  //   }\n  // }\n];\n\nexport var SUBPROCESS_EXPANDED = [\n  {\n    label: 'Transaction',\n    actionName: 'replace-with-transaction',\n    className: 'bpmn-icon-transaction',\n    target: {\n      type: 'bpmn:Transaction',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Event Sub Process',\n    actionName: 'replace-with-event-subprocess',\n    className: 'bpmn-icon-event-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      triggeredByEvent: true,\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Sub Process (collapsed)',\n    actionName: 'replace-with-collapsed-subprocess',\n    className: 'bpmn-icon-subprocess-collapsed',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: false\n    }\n  }\n];\n\nexport var TRANSACTION = [\n  {\n    label: 'Sub Process',\n    actionName: 'replace-with-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Event Sub Process',\n    actionName: 'replace-with-event-subprocess',\n    className: 'bpmn-icon-event-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      triggeredByEvent: true,\n      isExpanded: true\n    }\n  }\n];\n\nexport var EVENT_SUB_PROCESS = [\n  {\n    label: 'Sub Process',\n    actionName: 'replace-with-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Transaction',\n    actionName: 'replace-with-transaction',\n    className: 'bpmn-icon-transaction',\n    target: {\n      type: 'bpmn:Transaction',\n      isExpanded: true\n    }\n  }\n];\n\nexport var TASK = [\n  {\n    label: 'Task',\n    actionName: 'replace-with-task',\n    className: 'bpmn-icon-task',\n    target: {\n      type: 'bpmn:Task'\n    }\n  },\n  {\n    label: 'Send Task',\n    actionName: 'replace-with-send-task',\n    className: 'bpmn-icon-send',\n    target: {\n      type: 'bpmn:SendTask'\n    }\n  },\n  {\n    label: 'Receive Task',\n    actionName: 'replace-with-receive-task',\n    className: 'bpmn-icon-receive',\n    target: {\n      type: 'bpmn:ReceiveTask'\n    }\n  },\n  {\n    label: 'User Task',\n    actionName: 'replace-with-user-task',\n    className: 'bpmn-icon-user',\n    target: {\n      type: 'bpmn:UserTask'\n    }\n  },\n  {\n    label: 'Manual Task',\n    actionName: 'replace-with-manual-task',\n    className: 'bpmn-icon-manual',\n    target: {\n      type: 'bpmn:ManualTask'\n    }\n  },\n  {\n    label: 'Business Rule Task',\n    actionName: 'replace-with-rule-task',\n    className: 'bpmn-icon-business-rule',\n    target: {\n      type: 'bpmn:BusinessRuleTask'\n    }\n  },\n  {\n    label: 'Service Task',\n    actionName: 'replace-with-service-task',\n    className: 'bpmn-icon-service',\n    target: {\n      type: 'bpmn:ServiceTask'\n    }\n  },\n  {\n    label: 'Script Task',\n    actionName: 'replace-with-script-task',\n    className: 'bpmn-icon-script',\n    target: {\n      type: 'bpmn:ScriptTask'\n    }\n  },\n  {\n    label: 'Call Activity',\n    actionName: 'replace-with-call-activity',\n    className: 'bpmn-icon-call-activity',\n    target: {\n      type: 'bpmn:CallActivity'\n    }\n  },\n  {\n    label: 'Sub Process (collapsed)',\n    actionName: 'replace-with-collapsed-subprocess',\n    className: 'bpmn-icon-subprocess-collapsed',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: false\n    }\n  },\n  {\n    label: 'Sub Process (expanded)',\n    actionName: 'replace-with-expanded-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  }\n];\n\nexport var BOUNDARY_EVENT = [\n  {\n    label: 'Message Boundary Event',\n    actionName: 'replace-with-message-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-message',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Boundary Event',\n    actionName: 'replace-with-timer-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-timer',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Boundary Event',\n    actionName: 'replace-with-escalation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-escalation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Boundary Event',\n    actionName: 'replace-with-conditional-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-condition',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Error Boundary Event',\n    actionName: 'replace-with-error-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-error',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Cancel Boundary Event',\n    actionName: 'replace-with-cancel-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-cancel',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:CancelEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Boundary Event',\n    actionName: 'replace-with-signal-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-signal',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Boundary Event',\n    actionName: 'replace-with-compensation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-compensation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Message Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-message-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-message',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Timer Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-timer-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-timer',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Escalation Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-escalation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-escalation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Conditional Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-conditional-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-condition',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Signal Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-signal-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-signal',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition',\n      cancelActivity: false\n    }\n  }\n];\n\nexport var EVENT_SUB_PROCESS_START_EVENT = [\n  {\n    label: 'Message Start Event',\n    actionName: 'replace-with-message-start',\n    className: 'bpmn-icon-start-event-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Start Event',\n    actionName: 'replace-with-timer-start',\n    className: 'bpmn-icon-start-event-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Start Event',\n    actionName: 'replace-with-conditional-start',\n    className: 'bpmn-icon-start-event-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Start Event',\n    actionName: 'replace-with-signal-start',\n    className: 'bpmn-icon-start-event-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Error Start Event',\n    actionName: 'replace-with-error-start',\n    className: 'bpmn-icon-start-event-error',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Start Event',\n    actionName: 'replace-with-escalation-start',\n    className: 'bpmn-icon-start-event-escalation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Start Event',\n    actionName: 'replace-with-compensation-start',\n    className: 'bpmn-icon-start-event-compensation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Message Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-message-start',\n    className: 'bpmn-icon-start-event-non-interrupting-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Timer Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-timer-start',\n    className: 'bpmn-icon-start-event-non-interrupting-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Conditional Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-conditional-start',\n    className: 'bpmn-icon-start-event-non-interrupting-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Signal Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-signal-start',\n    className: 'bpmn-icon-start-event-non-interrupting-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Escalation Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-escalation-start',\n    className: 'bpmn-icon-start-event-non-interrupting-escalation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition',\n      isInterrupting: false\n    }\n  }\n];\n\nexport var SEQUENCE_FLOW = [\n  {\n    label: 'Sequence Flow',\n    actionName: 'replace-with-sequence-flow',\n    className: 'bpmn-icon-connection'\n  },\n  {\n    label: 'Default Flow',\n    actionName: 'replace-with-default-flow',\n    className: 'bpmn-icon-default-flow'\n  },\n  {\n    label: 'Conditional Flow',\n    actionName: 'replace-with-conditional-flow',\n    className: 'bpmn-icon-conditional-flow'\n  }\n];\n\nexport var PARTICIPANT = [\n  {\n    label: 'Expanded Pool',\n    actionName: 'replace-with-expanded-pool',\n    className: 'bpmn-icon-participant',\n    target: {\n      type: 'bpmn:Participant',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Collapsed Pool',\n    actionName: 'replace-with-collapsed-pool',\n\n    // TODO(@janstuemmel): maybe design new icon\n    className: 'bpmn-icon-lane',\n    target: {\n      type: 'bpmn:Participant',\n      isExpanded: false\n    }\n  }\n];\n","import {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isEventSubProcess,\n  isExpanded\n} from '../../util/DiUtil';\n\nimport {\n  isDifferentType\n} from './util/TypeUtil';\n\nimport {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport * as replaceOptions from '../replace/ReplaceOptions';\n\n\n/**\n * This module is an element agnostic replace menu provider for the popup menu.\n */\nexport default function ReplaceMenuProvider(\n    popupMenu, modeling, moddle,\n    bpmnReplace, rules, translate) {\n\n  this._popupMenu = popupMenu;\n  this._modeling = modeling;\n  this._moddle = moddle;\n  this._bpmnReplace = bpmnReplace;\n  this._rules = rules;\n  this._translate = translate;\n\n  this.register();\n}\n\nReplaceMenuProvider.$inject = [\n  'popupMenu',\n  'modeling',\n  'moddle',\n  'bpmnReplace',\n  'rules',\n  'translate'\n];\n\n\n/**\n * Register replace menu provider in the popup menu\n */\nReplaceMenuProvider.prototype.register = function() {\n  this._popupMenu.registerProvider('bpmn-replace', this);\n};\n\n\n/**\n * Get all entries from replaceOptions for the given element and apply filters\n * on them. Get for example only elements, which are different from the current one.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getEntries = function(element) {\n\n  var businessObject = element.businessObject;\n\n  var rules = this._rules;\n\n  var entries;\n\n  if (!rules.allowed('shape.replace', { element: element })) {\n    return [];\n  }\n\n  var differentType = isDifferentType(element);\n\n  // start events outside event sub processes\n  if (is(businessObject, 'bpmn:StartEvent') && !isEventSubProcess(businessObject.$parent)) {\n\n    entries = filter(replaceOptions.START_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded/collapsed pools\n  if (is(businessObject, 'bpmn:Participant')) {\n\n    entries = filter(replaceOptions.PARTICIPANT, function(entry) {\n      return isExpanded(businessObject) !== entry.target.isExpanded;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // start events inside event sub processes\n  if (is(businessObject, 'bpmn:StartEvent') && isEventSubProcess(businessObject.$parent)) {\n\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS_START_EVENT, function(entry) {\n\n      var target = entry.target;\n\n      var isInterrupting = target.isInterrupting !== false;\n\n      var isInterruptingEqual = getBusinessObject(element).isInterrupting === isInterrupting;\n\n      // filters elements which types and event definition are equal but have have different interrupting types\n      return differentType(entry) || !differentType(entry) && !isInterruptingEqual;\n\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // end events\n  if (is(businessObject, 'bpmn:EndEvent')) {\n\n    entries = filter(replaceOptions.END_EVENT, function(entry) {\n      var target = entry.target;\n\n      // hide cancel end events outside transactions\n      if (target.eventDefinitionType == 'bpmn:CancelEventDefinition' && !is(businessObject.$parent, 'bpmn:Transaction')) {\n        return false;\n      }\n\n      return differentType(entry);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // boundary events\n  if (is(businessObject, 'bpmn:BoundaryEvent')) {\n\n    entries = filter(replaceOptions.BOUNDARY_EVENT, function(entry) {\n\n      var target = entry.target;\n\n      if (target.eventDefinition == 'bpmn:CancelEventDefinition' &&\n         !is(businessObject.attachedToRef, 'bpmn:Transaction')) {\n        return false;\n      }\n      var cancelActivity = target.cancelActivity !== false;\n\n      var isCancelActivityEqual = businessObject.cancelActivity == cancelActivity;\n\n      return differentType(entry) || !differentType(entry) && !isCancelActivityEqual;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // intermediate events\n  if (is(businessObject, 'bpmn:IntermediateCatchEvent') ||\n      is(businessObject, 'bpmn:IntermediateThrowEvent')) {\n\n    entries = filter(replaceOptions.INTERMEDIATE_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // gateways\n  if (is(businessObject, 'bpmn:Gateway')) {\n\n    entries = filter(replaceOptions.GATEWAY, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // transactions\n  if (is(businessObject, 'bpmn:Transaction')) {\n\n    entries = filter(replaceOptions.TRANSACTION, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded event sub processes\n  if (isEventSubProcess(businessObject) && isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded sub processes\n  if (is(businessObject, 'bpmn:SubProcess') && isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.SUBPROCESS_EXPANDED, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // collapsed ad hoc sub processes\n  if (is(businessObject, 'bpmn:AdHocSubProcess') && !isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.TASK, function(entry) {\n\n      var target = entry.target;\n\n      var isTargetSubProcess = target.type === 'bpmn:SubProcess';\n\n      var isTargetExpanded = target.isExpanded === true;\n\n      return isDifferentType(element, target) && (!isTargetSubProcess || isTargetExpanded);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // sequence flows\n  if (is(businessObject, 'bpmn:SequenceFlow')) {\n    return this._createSequenceFlowEntries(element, replaceOptions.SEQUENCE_FLOW);\n  }\n\n  // flow nodes\n  if (is(businessObject, 'bpmn:FlowNode')) {\n    entries = filter(replaceOptions.TASK, differentType);\n\n    // collapsed SubProcess can not be replaced with itself\n    if (is(businessObject, 'bpmn:SubProcess') && !isExpanded(businessObject)) {\n      entries = filter(entries, function(entry) {\n        return entry.label !== 'Sub Process (collapsed)';\n      });\n    }\n\n    return this._createEntries(element, entries);\n  }\n\n  return [];\n};\n\n\n/**\n * Get a list of header items for the given element. This includes buttons\n * for multi instance markers and for the ad hoc marker.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getHeaderEntries = function(element) {\n\n  var headerEntries = [];\n\n  if (is(element, 'bpmn:Activity') && !isEventSubProcess(element)) {\n    headerEntries = headerEntries.concat(this._getLoopEntries(element));\n  }\n\n  if (is(element, 'bpmn:SubProcess') &&\n      !is(element, 'bpmn:Transaction') &&\n      !isEventSubProcess(element)) {\n    headerEntries.push(this._getAdHocEntry(element));\n  }\n\n  return headerEntries;\n};\n\n\n/**\n * Creates an array of menu entry objects for a given element and filters the replaceOptions\n * according to a filter function.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createEntries = function(element, replaceOptions) {\n  var menuEntries = [];\n\n  var self = this;\n\n  forEach(replaceOptions, function(definition) {\n    var entry = self._createMenuEntry(definition, element);\n\n    menuEntries.push(entry);\n  });\n\n  return menuEntries;\n};\n\n/**\n * Creates an array of menu entry objects for a given sequence flow.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createSequenceFlowEntries = function(element, replaceOptions) {\n\n  var businessObject = getBusinessObject(element);\n\n  var menuEntries = [];\n\n  var modeling = this._modeling,\n      moddle = this._moddle;\n\n  var self = this;\n\n  forEach(replaceOptions, function(entry) {\n\n    switch (entry.actionName) {\n    case 'replace-with-default-flow':\n      if (businessObject.sourceRef.default !== businessObject &&\n            (is(businessObject.sourceRef, 'bpmn:ExclusiveGateway') ||\n             is(businessObject.sourceRef, 'bpmn:InclusiveGateway') ||\n             is(businessObject.sourceRef, 'bpmn:ComplexGateway') ||\n             is(businessObject.sourceRef, 'bpmn:Activity'))) {\n\n        menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element.source, { default: businessObject });\n        }));\n      }\n      break;\n    case 'replace-with-conditional-flow':\n      if (!businessObject.conditionExpression && is(businessObject.sourceRef, 'bpmn:Activity')) {\n\n        menuEntries.push(self._createMenuEntry(entry, element, function() {\n          var conditionExpression = moddle.create('bpmn:FormalExpression', { body: '' });\n\n          modeling.updateProperties(element, { conditionExpression: conditionExpression });\n        }));\n      }\n      break;\n    default:\n\n      // default flows\n      if (is(businessObject.sourceRef, 'bpmn:Activity') && businessObject.conditionExpression) {\n        return menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element, { conditionExpression: undefined });\n        }));\n      }\n\n      // conditional flows\n      if ((is(businessObject.sourceRef, 'bpmn:ExclusiveGateway') ||\n           is(businessObject.sourceRef, 'bpmn:InclusiveGateway') ||\n           is(businessObject.sourceRef, 'bpmn:ComplexGateway') ||\n           is(businessObject.sourceRef, 'bpmn:Activity')) &&\n           businessObject.sourceRef.default === businessObject) {\n\n        return menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element.source, { default: undefined });\n        }));\n      }\n    }\n  });\n\n  return menuEntries;\n};\n\n\n/**\n * Creates and returns a single menu entry item.\n *\n * @param  {Object} definition a single replace options definition object\n * @param  {djs.model.Base} element\n * @param  {Function} [action] an action callback function which gets called when\n *                             the menu entry is being triggered.\n *\n * @return {Object} menu entry item\n */\nReplaceMenuProvider.prototype._createMenuEntry = function(definition, element, action) {\n  var translate = this._translate;\n  var replaceElement = this._bpmnReplace.replaceElement;\n\n  var replaceAction = function() {\n    return replaceElement(element, definition.target);\n  };\n\n  action = action || replaceAction;\n\n  var menuEntry = {\n    label: translate(definition.label),\n    className: definition.className,\n    id: definition.actionName,\n    action: action\n  };\n\n  return menuEntry;\n};\n\n/**\n * Get a list of menu items containing buttons for multi instance markers\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._getLoopEntries = function(element) {\n\n  var self = this;\n  var translate = this._translate;\n\n  function toggleLoopEntry(event, entry) {\n    var loopCharacteristics;\n\n    if (entry.active) {\n      loopCharacteristics = undefined;\n    } else {\n      loopCharacteristics = self._moddle.create(entry.options.loopCharacteristics);\n\n      if (entry.options.isSequential) {\n        loopCharacteristics.isSequential = entry.options.isSequential;\n      }\n    }\n    self._modeling.updateProperties(element, { loopCharacteristics: loopCharacteristics });\n  }\n\n  var businessObject = getBusinessObject(element),\n      loopCharacteristics = businessObject.loopCharacteristics;\n\n  var isSequential,\n      isLoop,\n      isParallel;\n\n  if (loopCharacteristics) {\n    isSequential = loopCharacteristics.isSequential;\n    isLoop = loopCharacteristics.isSequential === undefined;\n    isParallel = loopCharacteristics.isSequential !== undefined && !loopCharacteristics.isSequential;\n  }\n\n\n  var loopEntries = [\n    {\n      id: 'toggle-parallel-mi',\n      className: 'bpmn-icon-parallel-mi-marker',\n      title: translate('Parallel Multi Instance'),\n      active: isParallel,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:MultiInstanceLoopCharacteristics',\n        isSequential: false\n      }\n    },\n    {\n      id: 'toggle-sequential-mi',\n      className: 'bpmn-icon-sequential-mi-marker',\n      title: translate('Sequential Multi Instance'),\n      active: isSequential,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:MultiInstanceLoopCharacteristics',\n        isSequential: true\n      }\n    },\n    {\n      id: 'toggle-loop',\n      className: 'bpmn-icon-loop-marker',\n      title: translate('Loop'),\n      active: isLoop,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:StandardLoopCharacteristics'\n      }\n    }\n  ];\n  return loopEntries;\n};\n\n\n/**\n * Get the menu items containing a button for the ad hoc marker\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} a menu item\n */\nReplaceMenuProvider.prototype._getAdHocEntry = function(element) {\n  var translate = this._translate;\n  var businessObject = getBusinessObject(element);\n\n  var isAdHoc = is(businessObject, 'bpmn:AdHocSubProcess');\n\n  var replaceElement = this._bpmnReplace.replaceElement;\n\n  var adHocEntry = {\n    id: 'toggle-adhoc',\n    className: 'bpmn-icon-ad-hoc-marker',\n    title: translate('Ad-hoc'),\n    active: isAdHoc,\n    action: function(event, entry) {\n      if (isAdHoc) {\n        return replaceElement(element, { type: 'bpmn:SubProcess' }, {\n          autoResize: false,\n          layoutConnection: false\n        });\n      } else {\n        return replaceElement(element, { type: 'bpmn:AdHocSubProcess' }, {\n          autoResize: false,\n          layoutConnection: false\n        });\n      }\n    }\n  };\n\n  return adHocEntry;\n};\n","import PopupMenuModule from 'diagram-js/lib/features/popup-menu';\nimport ReplaceModule from '../replace';\n\nimport ReplaceMenuProvider from './ReplaceMenuProvider';\n\n\nexport default {\n  __depends__: [\n    PopupMenuModule,\n    ReplaceModule\n  ],\n  __init__: [ 'replaceMenuProvider' ],\n  replaceMenuProvider: [ 'type', ReplaceMenuProvider ]\n};","import {\n  filter,\n  isNumber\n} from 'min-dash';\n\nvar max = Math.max,\n    min = Math.min;\n\nvar DEFAULT_CHILD_BOX_PADDING = 20;\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\n\n/**\n * Substract a TRBL from another\n *\n * @param  {TRBL} trblA\n * @param  {TRBL} trblB\n *\n * @return {TRBL}\n */\nexport function substractTRBL(trblA, trblB) {\n  return {\n    top: trblA.top - trblB.top,\n    right: trblA.right - trblB.right,\n    bottom: trblA.bottom - trblB.bottom,\n    left: trblA.left - trblB.left\n  };\n}\n\n/**\n * Resize the given bounds by the specified delta from a given anchor point.\n *\n * @param {Bounds} bounds the bounding box that should be resized\n * @param {String} direction in which the element is resized (nw, ne, se, sw)\n * @param {Point} delta of the resize operation\n *\n * @return {Bounds} resized bounding box\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var dx = delta.x,\n      dy = delta.y;\n\n  var newBounds = {\n    x: bounds.x,\n    y: bounds.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    newBounds.y = bounds.y + dy;\n    newBounds.height = bounds.height - dy;\n  } else if (direction.indexOf('s') !== -1) {\n    newBounds.height = bounds.height + dy;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    newBounds.width = bounds.width + dx;\n  } else if (direction.indexOf('w') !== -1) {\n    newBounds.x = bounds.x + dx;\n    newBounds.width = bounds.width - dx;\n  }\n\n  return newBounds;\n}\n\n\n/**\n * Resize the given bounds by applying the passed\n * { top, right, bottom, left } delta.\n *\n * @param {Bounds} bounds\n * @param {TRBL} trblResize\n *\n * @return {Bounds}\n */\nexport function resizeTRBL(bounds, resize) {\n  return {\n    x: bounds.x + (resize.left || 0),\n    y: bounds.y + (resize.top || 0),\n    width: bounds.width - (resize.left || 0) + (resize.right || 0),\n    height: bounds.height - (resize.top || 0) + (resize.bottom || 0)\n  };\n}\n\n\nexport function reattachPoint(bounds, newBounds, point) {\n\n  var sx = bounds.width / newBounds.width,\n      sy = bounds.height / newBounds.height;\n\n  return {\n    x: Math.round((newBounds.x + newBounds.width / 2)) - Math.floor(((bounds.x + bounds.width / 2) - point.x) / sx),\n    y: Math.round((newBounds.y + newBounds.height / 2)) - Math.floor(((bounds.y + bounds.height / 2) - point.y) / sy)\n  };\n}\n\n\nfunction applyConstraints(attr, trbl, resizeConstraints) {\n\n  var value = trbl[attr],\n      minValue = resizeConstraints.min && resizeConstraints.min[attr],\n      maxValue = resizeConstraints.max && resizeConstraints.max[attr];\n\n  if (isNumber(minValue)) {\n    value = (/top|left/.test(attr) ? min : max)(value, minValue);\n  }\n\n  if (isNumber(maxValue)) {\n    value = (/top|left/.test(attr) ? max : min)(value, maxValue);\n  }\n\n  return value;\n}\n\nexport function ensureConstraints(currentBounds, resizeConstraints) {\n\n  if (!resizeConstraints) {\n    return currentBounds;\n  }\n\n  var currentTrbl = asTRBL(currentBounds);\n\n  return asBounds({\n    top: applyConstraints('top', currentTrbl, resizeConstraints),\n    right: applyConstraints('right', currentTrbl, resizeConstraints),\n    bottom: applyConstraints('bottom', currentTrbl, resizeConstraints),\n    left: applyConstraints('left', currentTrbl, resizeConstraints)\n  });\n}\n\n\nexport function getMinResizeBounds(direction, currentBounds, minDimensions, childrenBounds) {\n\n  var currentBox = asTRBL(currentBounds);\n\n  var minBox = {\n    top: /n/.test(direction) ? currentBox.bottom - minDimensions.height : currentBox.top,\n    left: /w/.test(direction) ? currentBox.right - minDimensions.width : currentBox.left,\n    bottom: /s/.test(direction) ? currentBox.top + minDimensions.height : currentBox.bottom,\n    right: /e/.test(direction) ? currentBox.left + minDimensions.width : currentBox.right\n  };\n\n  var childrenBox = childrenBounds ? asTRBL(childrenBounds) : minBox;\n\n  var combinedBox = {\n    top: min(minBox.top, childrenBox.top),\n    left: min(minBox.left, childrenBox.left),\n    bottom: max(minBox.bottom, childrenBox.bottom),\n    right: max(minBox.right, childrenBox.right)\n  };\n\n  return asBounds(combinedBox);\n}\n\nfunction asPadding(mayBePadding, defaultValue) {\n  if (typeof mayBePadding !== 'undefined') {\n    return mayBePadding;\n  } else {\n    return DEFAULT_CHILD_BOX_PADDING;\n  }\n}\n\nexport function addPadding(bbox, padding) {\n  var left, right, top, bottom;\n\n  if (typeof padding === 'object') {\n    left = asPadding(padding.left);\n    right = asPadding(padding.right);\n    top = asPadding(padding.top);\n    bottom = asPadding(padding.bottom);\n  } else {\n    left = right = top = bottom = asPadding(padding);\n  }\n\n  return {\n    x: bbox.x - left,\n    y: bbox.y - top,\n    width: bbox.width + left + right,\n    height: bbox.height + top + bottom\n  };\n}\n\n\n/**\n * Is the given element part of the resize\n * targets min boundary box?\n *\n * This is the default implementation which excludes\n * connections and labels.\n *\n * @param {djs.model.Base} element\n */\nfunction isBBoxChild(element) {\n\n  // exclude connections\n  if (element.waypoints) {\n    return false;\n  }\n\n  // exclude labels\n  if (element.type === 'label') {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Return children bounding computed from a shapes children\n * or a list of prefiltered children.\n *\n * @param  {djs.model.Shape|Array<djs.model.Shape>} shapeOrChildren\n * @param  {Number|Object} padding\n *\n * @return {Bounds}\n */\nexport function computeChildrenBBox(shapeOrChildren, padding) {\n\n  var elements;\n\n  // compute based on shape\n  if (shapeOrChildren.length === undefined) {\n\n    // grab all the children that are part of the\n    // parents children box\n    elements = filter(shapeOrChildren.children, isBBoxChild);\n\n  } else {\n    elements = shapeOrChildren;\n  }\n\n  if (elements.length) {\n    return addPadding(getBBox(elements), padding);\n  }\n}\n","import { is } from '../../../util/ModelUtil';\n\nimport {\n  getParent\n} from './ModelingUtil';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substractTRBL,\n  resizeTRBL\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\nvar abs = Math.abs;\n\n\nfunction getTRBLResize(oldBounds, newBounds) {\n  return substractTRBL(asTRBL(newBounds), asTRBL(oldBounds));\n}\n\n\nvar LANE_PARENTS = [\n  'bpmn:Participant',\n  'bpmn:Process',\n  'bpmn:SubProcess'\n];\n\nexport var LANE_INDENTATION = 30;\n\n\n/**\n * Collect all lane shapes in the given paren\n *\n * @param  {djs.model.Shape} shape\n * @param  {Array<djs.model.Base>} [collectedShapes]\n *\n * @return {Array<djs.model.Base>}\n */\nexport function collectLanes(shape, collectedShapes) {\n\n  collectedShapes = collectedShapes || [];\n\n  shape.children.filter(function(s) {\n    if (is(s, 'bpmn:Lane')) {\n      collectLanes(s, collectedShapes);\n\n      collectedShapes.push(s);\n    }\n  });\n\n  return collectedShapes;\n}\n\n\n/**\n * Return the lane children of the given element.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {Array<djs.model.Shape>}\n */\nexport function getChildLanes(shape) {\n  return shape.children.filter(function(c) {\n    return is(c, 'bpmn:Lane');\n  });\n}\n\n\n/**\n * Return the root element containing the given lane shape\n *\n * @param {djs.model.Shape} shape\n *\n * @return {djs.model.Shape}\n */\nexport function getLanesRoot(shape) {\n  return getParent(shape, LANE_PARENTS) || shape;\n}\n\n\n/**\n * Compute the required resize operations for lanes\n * adjacent to the given shape, assuming it will be\n * resized to the given new bounds.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n *\n * @return {Array<Object>}\n */\nexport function computeLanesResize(shape, newBounds) {\n\n  var rootElement = getLanesRoot(shape);\n\n  var initialShapes = is(rootElement, 'bpmn:Process') ? [] : [ rootElement ];\n\n  var allLanes = collectLanes(rootElement, initialShapes),\n      shapeTrbl = asTRBL(shape),\n      shapeNewTrbl = asTRBL(newBounds),\n      trblResize = getTRBLResize(shape, newBounds),\n      resizeNeeded = [];\n\n  allLanes.forEach(function(other) {\n\n    if (other === shape) {\n      return;\n    }\n\n    var topResize = 0,\n        rightResize = trblResize.right,\n        bottomResize = 0,\n        leftResize = trblResize.left;\n\n    var otherTrbl = asTRBL(other);\n\n    if (trblResize.top) {\n      if (abs(otherTrbl.bottom - shapeTrbl.top) < 10) {\n        bottomResize = shapeNewTrbl.top - otherTrbl.bottom;\n      }\n\n      if (abs(otherTrbl.top - shapeTrbl.top) < 5) {\n        topResize = shapeNewTrbl.top - otherTrbl.top;\n      }\n    }\n\n    if (trblResize.bottom) {\n      if (abs(otherTrbl.top - shapeTrbl.bottom) < 10) {\n        topResize = shapeNewTrbl.bottom - otherTrbl.top;\n      }\n\n      if (abs(otherTrbl.bottom - shapeTrbl.bottom) < 5) {\n        bottomResize = shapeNewTrbl.bottom - otherTrbl.bottom;\n      }\n    }\n\n    if (topResize || rightResize || bottomResize || leftResize) {\n\n      resizeNeeded.push({\n        shape: other,\n        newBounds: resizeTRBL(other, {\n          top: topResize,\n          right: rightResize,\n          bottom: bottomResize,\n          left: leftResize\n        })\n      });\n    }\n\n  });\n\n  return resizeNeeded;\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess\n} from '../../util/DiUtil';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  getChildLanes\n} from '../modeling/util/LaneUtil';\n\nimport {\n  hasPrimaryModifier\n} from 'diagram-js/lib/util/Mouse';\n\n\n/**\n * A provider for BPMN 2.0 elements context pad\n */\nexport default function ContextPadProvider(\n    config, injector, eventBus,\n    contextPad, modeling, elementFactory,\n    connect, create, popupMenu,\n    canvas, rules, translate) {\n\n  config = config || {};\n\n  contextPad.registerProvider(this);\n\n  this._contextPad = contextPad;\n\n  this._modeling = modeling;\n\n  this._elementFactory = elementFactory;\n  this._connect = connect;\n  this._create = create;\n  this._popupMenu = popupMenu;\n  this._canvas = canvas;\n  this._rules = rules;\n  this._translate = translate;\n\n  if (config.autoPlace !== false) {\n    this._autoPlace = injector.get('autoPlace', false);\n  }\n\n  eventBus.on('create.end', 250, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (!hasPrimaryModifier(event) || !contextPad.isOpen(shape)) {\n      return;\n    }\n\n    var entries = contextPad.getEntries(shape);\n\n    if (entries.replace) {\n      entries.replace.action.click(event, shape);\n    }\n  });\n}\n\nContextPadProvider.$inject = [\n  'config.contextPad',\n  'injector',\n  'eventBus',\n  'contextPad',\n  'modeling',\n  'elementFactory',\n  'connect',\n  'create',\n  'popupMenu',\n  'canvas',\n  'rules',\n  'translate'\n];\n\n\nContextPadProvider.prototype.getContextPadEntries = function(element) {\n\n  var contextPad = this._contextPad,\n      modeling = this._modeling,\n\n      elementFactory = this._elementFactory,\n      connect = this._connect,\n      create = this._create,\n      popupMenu = this._popupMenu,\n      canvas = this._canvas,\n      rules = this._rules,\n      autoPlace = this._autoPlace,\n      translate = this._translate;\n\n  var actions = {};\n\n  if (element.type === 'label') {\n    return actions;\n  }\n\n  var businessObject = element.businessObject;\n\n  function startConnect(event, element) {\n    connect.start(event, element);\n  }\n\n  function removeElement(e) {\n    modeling.removeElements([ element ]);\n  }\n\n  function getReplaceMenuPosition(element) {\n\n    var Y_OFFSET = 5;\n\n    var diagramContainer = canvas.getContainer(),\n        pad = contextPad.getPad(element).html;\n\n    var diagramRect = diagramContainer.getBoundingClientRect(),\n        padRect = pad.getBoundingClientRect();\n\n    var top = padRect.top - diagramRect.top;\n    var left = padRect.left - diagramRect.left;\n\n    var pos = {\n      x: left,\n      y: top + padRect.height + Y_OFFSET\n    };\n\n    return pos;\n  }\n\n\n  /**\n   * Create an append action\n   *\n   * @param {String} type\n   * @param {String} className\n   * @param {String} [title]\n   * @param {Object} [options]\n   *\n   * @return {Object} descriptor\n   */\n  function appendAction(type, className, title, options) {\n\n    if (typeof title !== 'string') {\n      options = title;\n      title = translate('Append {type}', { type: type.replace(/^bpmn:/, '') });\n    }\n\n    function appendStart(event, element) {\n\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n      create.start(event, shape, {\n        source: element\n      });\n    }\n\n\n    var append = autoPlace ? function(event, element) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n\n      autoPlace.append(element, shape);\n    } : appendStart;\n\n\n    return {\n      group: 'model',\n      className: className,\n      title: title,\n      action: {\n        dragstart: appendStart,\n        click: append\n      }\n    };\n  }\n\n  function splitLaneHandler(count) {\n\n    return function(event, element) {\n\n      // actual split\n      modeling.splitLane(element, count);\n\n      // refresh context pad after split to\n      // get rid of split icons\n      contextPad.open(element, true);\n    };\n  }\n\n\n  if (isAny(businessObject, [ 'bpmn:Lane', 'bpmn:Participant' ]) && isExpanded(businessObject)) {\n\n    var childLanes = getChildLanes(element);\n\n    assign(actions, {\n      'lane-insert-above': {\n        group: 'lane-insert-above',\n        className: 'bpmn-icon-lane-insert-above',\n        title: translate('Add Lane above'),\n        action: {\n          click: function(event, element) {\n            modeling.addLane(element, 'top');\n          }\n        }\n      }\n    });\n\n    if (childLanes.length < 2) {\n\n      if (element.height >= 120) {\n        assign(actions, {\n          'lane-divide-two': {\n            group: 'lane-divide',\n            className: 'bpmn-icon-lane-divide-two',\n            title: translate('Divide into two Lanes'),\n            action: {\n              click: splitLaneHandler(2)\n            }\n          }\n        });\n      }\n\n      if (element.height >= 180) {\n        assign(actions, {\n          'lane-divide-three': {\n            group: 'lane-divide',\n            className: 'bpmn-icon-lane-divide-three',\n            title: translate('Divide into three Lanes'),\n            action: {\n              click: splitLaneHandler(3)\n            }\n          }\n        });\n      }\n    }\n\n    assign(actions, {\n      'lane-insert-below': {\n        group: 'lane-insert-below',\n        className: 'bpmn-icon-lane-insert-below',\n        title: translate('Add Lane below'),\n        action: {\n          click: function(event, element) {\n            modeling.addLane(element, 'bottom');\n          }\n        }\n      }\n    });\n\n  }\n\n  if (is(businessObject, 'bpmn:FlowNode')) {\n\n    if (is(businessObject, 'bpmn:EventBasedGateway')) {\n\n      assign(actions, {\n        'append.receive-task': appendAction(\n          'bpmn:ReceiveTask',\n          'bpmn-icon-receive-task',\n          translate('Append ReceiveTask')\n        ),\n        'append.message-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-message',\n          translate('Append MessageIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:MessageEventDefinition' }\n        ),\n        'append.timer-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-timer',\n          translate('Append TimerIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:TimerEventDefinition' }\n        ),\n        'append.condition-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-condition',\n          translate('Append ConditionIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:ConditionalEventDefinition' }\n        ),\n        'append.signal-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-signal',\n          translate('Append SignalIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:SignalEventDefinition' }\n        )\n      });\n    } else\n\n    if (isEventType(businessObject, 'bpmn:BoundaryEvent', 'bpmn:CompensateEventDefinition')) {\n\n      assign(actions, {\n        'append.compensation-activity':\n            appendAction(\n              'bpmn:Task',\n              'bpmn-icon-task',\n              translate('Append compensation activity'),\n              {\n                isForCompensation: true\n              }\n            )\n      });\n    } else\n\n    if (!is(businessObject, 'bpmn:EndEvent') &&\n        !businessObject.isForCompensation &&\n        !isEventType(businessObject, 'bpmn:IntermediateThrowEvent', 'bpmn:LinkEventDefinition') &&\n        !isEventSubProcess(businessObject)) {\n\n      assign(actions, {\n        'append.end-event': appendAction(\n          'bpmn:EndEvent',\n          'bpmn-icon-end-event-none',\n          translate('Append EndEvent')\n        ),\n        'append.gateway': appendAction(\n          'bpmn:ExclusiveGateway',\n          'bpmn-icon-gateway-none',\n          translate('Append Gateway')\n        ),\n        'append.append-task': appendAction(\n          'bpmn:Task',\n          'bpmn-icon-task',\n          translate('Append Task')\n        ),\n        'append.intermediate-event': appendAction(\n          'bpmn:IntermediateThrowEvent',\n          'bpmn-icon-intermediate-event-none',\n          translate('Append Intermediate/Boundary Event')\n        )\n      });\n    }\n  }\n\n  if (!popupMenu.isEmpty(element, 'bpmn-replace')) {\n\n    // Replace menu entry\n    assign(actions, {\n      'replace': {\n        group: 'edit',\n        className: 'bpmn-icon-screw-wrench',\n        title: translate('Change type'),\n        action: {\n          click: function(event, element) {\n\n            var position = assign(getReplaceMenuPosition(element), {\n              cursor: { x: event.x, y: event.y }\n            });\n\n            popupMenu.open(element, 'bpmn-replace', position);\n          }\n        }\n      }\n    });\n  }\n\n  if (isAny(businessObject, [\n    'bpmn:FlowNode',\n    'bpmn:InteractionNode',\n    'bpmn:DataObjectReference',\n    'bpmn:DataStoreReference'\n  ])) {\n\n    assign(actions, {\n      'append.text-annotation': appendAction('bpmn:TextAnnotation', 'bpmn-icon-text-annotation'),\n\n      'connect': {\n        group: 'connect',\n        className: 'bpmn-icon-connection-multi',\n        title: translate('Connect using ' +\n                  (businessObject.isForCompensation ? '' : 'Sequence/MessageFlow or ') +\n                  'Association'),\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n  if (isAny(businessObject, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ])) {\n    assign(actions, {\n      'connect': {\n        group: 'connect',\n        className: 'bpmn-icon-connection-multi',\n        title: translate('Connect using DataInputAssociation'),\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n  // delete element entry, only show if allowed by rules\n  var deleteAllowed = rules.allowed('elements.delete', { elements: [ element ] });\n\n  if (isArray(deleteAllowed)) {\n\n    // was the element returned as a deletion candidate?\n    deleteAllowed = deleteAllowed[0] === element;\n  }\n\n  if (deleteAllowed) {\n    assign(actions, {\n      'delete': {\n        group: 'edit',\n        className: 'bpmn-icon-trash',\n        title: translate('Remove'),\n        action: {\n          click: removeElement\n        }\n      }\n    });\n  }\n\n  return actions;\n};\n\n\n// helpers /////////\n\nfunction isEventType(eventBo, type, definition) {\n\n  var isType = eventBo.$instanceOf(type);\n  var isDefinition = false;\n\n  var definitions = eventBo.eventDefinitions || [];\n  forEach(definitions, function(def) {\n    if (def.$type === definition) {\n      isDefinition = true;\n    }\n  });\n\n  return isType && isDefinition;\n}\n","import DirectEditingModule from 'diagram-js-direct-editing';\nimport ContextPadModule from 'diagram-js/lib/features/context-pad';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ConnectModule from 'diagram-js/lib/features/connect';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport PopupMenuModule from '../popup-menu';\n\nimport ContextPadProvider from './ContextPadProvider';\n\nexport default {\n  __depends__: [\n    DirectEditingModule,\n    ContextPadModule,\n    SelectionModule,\n    ConnectModule,\n    CreateModule,\n    PopupMenuModule\n  ],\n  __init__: [ 'contextPadProvider' ],\n  contextPadProvider: [ 'type', ContextPadProvider ]\n};","import {\n  sortBy,\n  forEach,\n  filter\n} from 'min-dash';\n\nvar AXIS_DIMENSIONS = {\n  horizontal: [ 'x', 'width' ],\n  vertical: [ 'y', 'height' ]\n};\n\nvar THRESHOLD = 5;\n\n\n/**\n * Groups and filters elements and then trigger even distribution.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n\n  this._filters = [];\n\n  // register filter for filtering big elements\n  this.registerFilter(function(elements, axis, dimension) {\n    var elementsSize = 0,\n        numOfShapes = 0,\n        avgDimension;\n\n    forEach(elements, function(element) {\n      if (element.waypoints || element.labelTarget) {\n        return;\n      }\n\n      elementsSize += element[dimension];\n\n      numOfShapes += 1;\n    });\n\n    avgDimension = Math.round(elementsSize / numOfShapes);\n\n    return filter(elements, function(element) {\n      return element[dimension] < (avgDimension + 50);\n    });\n  });\n\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\n\n/**\n * Registers filter functions that allow external parties to filter\n * out certain elements.\n *\n * @param  {Function} filterFn\n */\nDistributeElements.prototype.registerFilter = function(filterFn) {\n  if (typeof filterFn !== 'function') {\n    throw new Error('the filter has to be a function');\n  }\n\n  this._filters.push(filterFn);\n};\n\n/**\n * Distributes the elements with a given orientation\n *\n * @param  {Array} elements    [description]\n * @param  {String} orientation [description]\n */\nDistributeElements.prototype.trigger = function(elements, orientation) {\n  var modeling = this._modeling;\n\n  var groups,\n      distributableElements;\n\n  if (elements.length < 3) {\n    return;\n  }\n\n  this._setOrientation(orientation);\n\n  distributableElements = this._filterElements(elements);\n\n  groups = this._createGroups(distributableElements);\n\n  // nothing to distribute\n  if (groups.length <= 2) {\n    return;\n  }\n\n  modeling.distributeElements(groups, this._axis, this._dimension);\n\n  return groups;\n};\n\n/**\n * Filters the elements with provided filters by external parties\n *\n * @param  {Array[Elements]} elements\n *\n * @return {Array[Elements]}\n */\nDistributeElements.prototype._filterElements = function(elements) {\n  var filters = this._filters,\n      axis = this._axis,\n      dimension = this._dimension,\n      distributableElements = [].concat(elements);\n\n  if (!filters.length) {\n    return elements;\n  }\n\n  forEach(filters, function(filterFn) {\n    distributableElements = filterFn(distributableElements, axis, dimension);\n  });\n\n  return distributableElements;\n};\n\n\n/**\n * Create range (min, max) groups. Also tries to group elements\n * together that share the same range.\n *\n * @example\n * \tvar distributableElements = [\n * \t\t{\n * \t\t\trange: {\n * \t\t\t\tmin: 100,\n * \t\t\t\tmax: 200\n * \t\t\t},\n * \t\t\telements: [ { id: 'shape1', .. }]\n * \t\t}\n * \t]\n *\n * @param  {Array} elements\n *\n * @return {Array[Objects]}\n */\nDistributeElements.prototype._createGroups = function(elements) {\n  var rangeGroups = [],\n      self = this,\n      axis = this._axis,\n      dimension = this._dimension;\n\n  if (!axis) {\n    throw new Error('must have a defined \"axis\" and \"dimension\"');\n  }\n\n  // sort by 'left->right' or 'top->bottom'\n  var sortedElements = sortBy(elements, axis);\n\n  forEach(sortedElements, function(element, idx) {\n    var elementRange = self._findRange(element, axis, dimension),\n        range;\n\n    var previous = rangeGroups[rangeGroups.length - 1];\n\n    if (previous && self._hasIntersection(previous.range, elementRange)) {\n      rangeGroups[rangeGroups.length - 1].elements.push(element);\n    } else {\n      range = { range: elementRange, elements: [ element ] };\n\n      rangeGroups.push(range);\n    }\n  });\n\n  return rangeGroups;\n};\n\n\n/**\n * Maps a direction to the according axis and dimension\n *\n * @param  {String} direction 'horizontal' or 'vertical'\n */\nDistributeElements.prototype._setOrientation = function(direction) {\n  var orientation = AXIS_DIMENSIONS[direction];\n\n  this._axis = orientation[0];\n  this._dimension = orientation[1];\n};\n\n\n/**\n * Checks if the two ranges intercept each other\n *\n * @param  {Object} rangeA {min, max}\n * @param  {Object} rangeB {min, max}\n *\n * @return {Boolean}\n */\nDistributeElements.prototype._hasIntersection = function(rangeA, rangeB) {\n  return Math.max(rangeA.min, rangeA.max) >= Math.min(rangeB.min, rangeB.max) &&\n         Math.min(rangeA.min, rangeA.max) <= Math.max(rangeB.min, rangeB.max);\n};\n\n\n/**\n * Returns the min and max values for an element\n *\n * @param  {[type]} element   [description]\n * @param  {[type]} axis      [description]\n * @param  {[type]} dimension [description]\n *\n * @return {[type]}           [description]\n */\nDistributeElements.prototype._findRange = function(element) {\n  var axis = element[this._axis],\n      dimension = element[this._dimension];\n\n  return {\n    min: axis + THRESHOLD,\n    max: axis + dimension - THRESHOLD\n  };\n};\n","import DistributeElements from './DistributeElements';\n\nexport default {\n  __init__: [ 'distributeElements' ],\n  distributeElements: [ 'type', DistributeElements ]\n};\n","import {\n  filter\n} from 'min-dash';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\n\n/**\n * Registers element exclude filters for elements that\n * currently do not support distribution.\n */\nexport default function BpmnDistributeElements(distributeElements) {\n\n  distributeElements.registerFilter(function(elements) {\n    return filter(elements, function(element) {\n      var cannotDistribute = isAny(element, [\n        'bpmn:Association',\n        'bpmn:BoundaryEvent',\n        'bpmn:DataInputAssociation',\n        'bpmn:DataOutputAssociation',\n        'bpmn:Lane',\n        'bpmn:MessageFlow',\n        'bpmn:Participant',\n        'bpmn:SequenceFlow',\n        'bpmn:TextAnnotation'\n      ]);\n\n      return !(element.labelTarget || cannotDistribute);\n    });\n  });\n}\n\nBpmnDistributeElements.$inject = [ 'distributeElements' ];","import DistributeElementsModule from 'diagram-js/lib/features/distribute-elements';\n\nimport BpmnDistributeElements from './BpmnDistributeElements';\n\n\nexport default {\n  __depends__: [\n    DistributeElementsModule\n  ],\n  __init__: [ 'bpmnDistributeElements' ],\n  bpmnDistributeElements: [ 'type', BpmnDistributeElements ]\n};\n","import {\n  forEach,\n  isArray\n} from 'min-dash';\n\nvar NOT_REGISTERED_ERROR = 'is not a registered action',\n    IS_REGISTERED_ERROR = 'is already registered';\n\n\n/**\n * An interface that provides access to modeling actions by decoupling\n * the one who requests the action to be triggered and the trigger itself.\n *\n * It's possible to add new actions by registering them with ´registerAction´\n * and likewise unregister existing ones with ´unregisterAction´.\n *\n *\n * ## Life-Cycle and configuration\n *\n * The editor actions will wait for diagram initialization before\n * registering default actions _and_ firing an `editorActions.init` event.\n *\n * Interested parties may listen to the `editorActions.init` event with\n * low priority to check, which actions got registered. Other components\n * may use the event to register their own actions via `registerAction`.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function EditorActions(eventBus, injector) {\n\n  // initialize actions\n  this._actions = {};\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // all diagram modules got loaded; check which ones\n    // are available and register the respective default actions\n    self._registerDefaultActions(injector);\n\n    // ask interested parties to register available editor\n    // actions on diagram initialization\n    eventBus.fire('editorActions.init', {\n      editorActions: self\n    });\n  });\n\n}\n\nEditorActions.$inject = [\n  'eventBus',\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (1) retrieve optional components to integrate with\n\n  var commandStack = injector.get('commandStack', false);\n  var modeling = injector.get('modeling', false);\n  var selection = injector.get('selection', false);\n  var zoomScroll = injector.get('zoomScroll', false);\n  var copyPaste = injector.get('copyPaste', false);\n  var canvas = injector.get('canvas', false);\n  var rules = injector.get('rules', false);\n  var keyboardMove = injector.get('keyboardMove', false);\n  var keyboardMoveSelection = injector.get('keyboardMoveSelection', false);\n\n  // (2) check components and register actions\n\n  if (commandStack) {\n    this.register('undo', function() {\n      commandStack.undo();\n    });\n\n    this.register('redo', function() {\n      commandStack.redo();\n    });\n  }\n\n  if (copyPaste && selection) {\n    this.register('copy', function() {\n      var selectedElements = selection.get();\n\n      copyPaste.copy(selectedElements);\n    });\n  }\n\n  if (copyPaste) {\n    this.register('paste', function() {\n      copyPaste.paste();\n    });\n  }\n\n  if (zoomScroll) {\n    this.register('stepZoom', function(opts) {\n      zoomScroll.stepZoom(opts.value);\n    });\n  }\n\n  if (canvas) {\n    this.register('zoom', function(opts) {\n      canvas.zoom(opts.value);\n    });\n  }\n\n  if (modeling && selection && rules) {\n    this.register('removeSelection', function() {\n\n      var selectedElements = selection.get();\n\n      if (!selectedElements.length) {\n        return;\n      }\n\n      var allowed = rules.allowed('elements.delete', { elements: selectedElements }),\n          removableElements;\n\n      if (allowed === false) {\n        return;\n      }\n      else if (isArray(allowed)) {\n        removableElements = allowed;\n      }\n      else {\n        removableElements = selectedElements;\n      }\n\n      if (removableElements.length) {\n        modeling.removeElements(removableElements.slice());\n      }\n    });\n  }\n\n  if (keyboardMove) {\n    this.register('moveCanvas', function(opts) {\n      keyboardMove.moveCanvas(opts);\n    });\n  }\n\n  if (keyboardMoveSelection) {\n    this.register('moveSelection', function(opts) {\n      keyboardMoveSelection.moveSelection(opts.direction, opts.accelerated);\n    });\n  }\n\n};\n\n\n/**\n * Triggers a registered action\n *\n * @param  {String} action\n * @param  {Object} opts\n *\n * @return {Unknown} Returns what the registered listener returns\n */\nEditorActions.prototype.trigger = function(action, opts) {\n  if (!this._actions[action]) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  return this._actions[action](opts);\n};\n\n\n/**\n * Registers a collections of actions.\n * The key of the object will be the name of the action.\n *\n * @example\n * ´´´\n * var actions = {\n *   spaceTool: function() {\n *     spaceTool.activateSelection();\n *   },\n *   lassoTool: function() {\n *     lassoTool.activateSelection();\n *   }\n * ];\n *\n * editorActions.register(actions);\n *\n * editorActions.isRegistered('spaceTool'); // true\n * ´´´\n *\n * @param  {Object} actions\n */\nEditorActions.prototype.register = function(actions, listener) {\n  var self = this;\n\n  if (typeof actions === 'string') {\n    return this._registerAction(actions, listener);\n  }\n\n  forEach(actions, function(listener, action) {\n    self._registerAction(action, listener);\n  });\n};\n\n/**\n * Registers a listener to an action key\n *\n * @param  {String} action\n * @param  {Function} listener\n */\nEditorActions.prototype._registerAction = function(action, listener) {\n  if (this.isRegistered(action)) {\n    throw error(action, IS_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = listener;\n};\n\n/**\n * Unregister an existing action\n *\n * @param {String} action\n */\nEditorActions.prototype.unregister = function(action) {\n  if (!this.isRegistered(action)) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = undefined;\n};\n\n/**\n * Returns the number of actions that are currently registered\n *\n * @return {Number}\n */\nEditorActions.prototype.getActions = function() {\n  return Object.keys(this._actions);\n};\n\n/**\n * Checks wether the given action is registered\n *\n * @param {String} action\n *\n * @return {Boolean}\n */\nEditorActions.prototype.isRegistered = function(action) {\n  return !!this._actions[action];\n};\n\n\nfunction error(action, message) {\n  return new Error(action + ' ' + message);\n}\n","import EditorActions from './EditorActions';\n\nexport default {\n  __init__: [ 'editorActions' ],\n  editorActions: [ 'type', EditorActions ]\n};\n","import inherits from 'inherits';\n\nimport EditorActions from 'diagram-js/lib/features/editor-actions/EditorActions';\n\nimport { filter } from 'min-dash';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  getBBox\n} from 'diagram-js/lib/util/Elements';\n\n\n/**\n * Registers and executes BPMN specific editor actions.\n *\n * @param {Injector} injector\n */\nexport default function BpmnEditorActions(injector) {\n  injector.invoke(EditorActions, this);\n}\n\ninherits(BpmnEditorActions, EditorActions);\n\nBpmnEditorActions.$inject = [\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nBpmnEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (0) invoke super method\n\n  EditorActions.prototype._registerDefaultActions.call(this, injector);\n\n  // (1) retrieve optional components to integrate with\n\n  var canvas = injector.get('canvas', false);\n  var elementRegistry = injector.get('elementRegistry', false);\n  var selection = injector.get('selection', false);\n  var spaceTool = injector.get('spaceTool', false);\n  var lassoTool = injector.get('lassoTool', false);\n  var handTool = injector.get('handTool', false);\n  var globalConnect = injector.get('globalConnect', false);\n  var distributeElements = injector.get('distributeElements', false);\n  var alignElements = injector.get('alignElements', false);\n  var directEditing = injector.get('directEditing', false);\n  var searchPad = injector.get('searchPad', false);\n  var modeling = injector.get('modeling', false);\n\n  // (2) check components and register actions\n\n  if (canvas && elementRegistry && selection) {\n    this._registerAction('selectElements', function() {\n\n      // select all elements except for the invisible\n      // root element\n      var rootElement = canvas.getRootElement();\n\n      var elements = elementRegistry.filter(function(element) {\n        return element !== rootElement;\n      });\n\n      selection.select(elements);\n\n      return elements;\n    });\n  }\n\n  if (spaceTool) {\n    this._registerAction('spaceTool', function() {\n      spaceTool.toggle();\n    });\n  }\n\n  if (lassoTool) {\n    this._registerAction('lassoTool', function() {\n      lassoTool.toggle();\n    });\n  }\n\n  if (handTool) {\n    this._registerAction('handTool', function() {\n      handTool.toggle();\n    });\n  }\n\n  if (globalConnect) {\n    this._registerAction('globalConnectTool', function() {\n      globalConnect.toggle();\n    });\n  }\n\n  if (selection && distributeElements) {\n    this._registerAction('distributeElements', function(opts) {\n      var currentSelection = selection.get(),\n          type = opts.type;\n\n      if (currentSelection.length) {\n        distributeElements.trigger(currentSelection, type);\n      }\n    });\n  }\n\n  if (selection && alignElements) {\n    this._registerAction('alignElements', function(opts) {\n      var currentSelection = selection.get(),\n          aligneableElements = [],\n          type = opts.type;\n\n      if (currentSelection.length) {\n        aligneableElements = filter(currentSelection, function(element) {\n          return !is(element, 'bpmn:Lane');\n        });\n\n        alignElements.trigger(aligneableElements, type);\n      }\n    });\n  }\n\n  if (selection && modeling) {\n    this._registerAction('setColor', function(opts) {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        modeling.setColor(currentSelection, opts);\n      }\n    });\n  }\n\n  if (selection && directEditing) {\n    this._registerAction('directEditing', function() {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        directEditing.activate(currentSelection[0]);\n      }\n    });\n  }\n\n  if (searchPad) {\n    this._registerAction('find', function() {\n      searchPad.toggle();\n    });\n  }\n\n  if (canvas && modeling) {\n    this._registerAction('moveToOrigin', function() {\n      var rootElement = canvas.getRootElement(),\n          boundingBox,\n          elements;\n\n      if (is(rootElement, 'bpmn:Collaboration')) {\n        elements = elementRegistry.filter(function(element) {\n          return is(element.parent, 'bpmn:Collaboration');\n        });\n      } else {\n        elements = elementRegistry.filter(function(element) {\n          return element !== rootElement && !is(element.parent, 'bpmn:SubProcess');\n        });\n      }\n\n      boundingBox = getBBox(elements);\n\n      modeling.moveElements(\n        elements,\n        { x: -boundingBox.x, y: -boundingBox.y },\n        rootElement\n      );\n    });\n  }\n\n};","import EditorActionsModule from 'diagram-js/lib/features/editor-actions';\n\nimport BpmnEditorActions from './BpmnEditorActions';\n\nexport default {\n  __depends__: [\n    EditorActionsModule\n  ],\n  editorActions: [ 'type', BpmnEditorActions ]\n};\n","import { isAny } from '../modeling/util/ModelingUtil';\r\n\r\nexport default function BpmnGridSnapping(eventBus) {\r\n  eventBus.on([\r\n    'create.init',\r\n    'shape.move.init'\r\n  ], function(event) {\r\n    var context = event.context,\r\n        shape = event.shape;\r\n\r\n    if (isAny(shape, [\r\n      'bpmn:Participant',\r\n      'bpmn:SubProcess',\r\n      'bpmn:TextAnnotation'\r\n    ])) {\r\n      if (!context.gridSnappingContext) {\r\n        context.gridSnappingContext = {};\r\n      }\r\n\r\n      context.gridSnappingContext.snapLocation = 'top-left';\r\n    }\r\n  });\r\n}\r\n\r\nBpmnGridSnapping.$inject = [ 'eventBus' ];","export var SPACING = 10;\n\nexport function quantize(value, quantum, fn) {\n  if (!fn) {\n    fn = 'round';\n  }\n\n  return Math[ fn ](value / quantum) * quantum;\n}","import {\r\n  setSnapped,\r\n  isSnapped\r\n} from '../snapping/SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  assign,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nimport {\r\n  SPACING,\r\n  quantize\r\n} from './GridUtil';\r\n\r\nvar LOWER_PRIORITY = 1200;\r\nvar LOW_PRIORITY = 800;\r\n\r\n/**\r\n * Basic grid snapping that covers connecting, creating, moving, resizing shapes, moving bendpoints\r\n * and connection segments.\r\n */\r\nexport default function GridSnapping(elementRegistry, eventBus, config) {\r\n\r\n  var active = !config || config.active !== false;\r\n\r\n  this._eventBus = eventBus;\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('diagram.init', LOW_PRIORITY, function() {\r\n    self.setActive(active);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'bendpoint.move.move',\r\n    'bendpoint.move.end',\r\n    'connect.move',\r\n    'connect.end',\r\n    'connectionSegment.move.move',\r\n    'connectionSegment.move.end',\r\n    'resize.move',\r\n    'resize.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], LOWER_PRIORITY, function(event) {\r\n    var originalEvent = event.originalEvent;\r\n\r\n    if (!self.active || (originalEvent && isCmd(originalEvent))) {\r\n      return;\r\n    }\r\n\r\n    var context = event.context,\r\n        gridSnappingContext = context.gridSnappingContext;\r\n\r\n    if (!gridSnappingContext) {\r\n      gridSnappingContext = context.gridSnappingContext = {};\r\n    }\r\n\r\n    [ 'x', 'y' ].forEach(function(axis) {\r\n      var options = {};\r\n\r\n      // allow snapping with offset\r\n      var snapOffset = getSnapOffset(event, axis, elementRegistry);\r\n\r\n      if (snapOffset) {\r\n        options.offset = snapOffset;\r\n      }\r\n\r\n      // allow snapping with min and max\r\n      var snapConstraints = getSnapConstraints(event, axis);\r\n\r\n      if (snapConstraints) {\r\n        assign(options, snapConstraints);\r\n      }\r\n\r\n      if (!isSnapped(event, axis)) {\r\n        self.snapEvent(event, axis, options);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Snap an events x or y with optional min, max and offset.\r\n *\r\n * @param {Object} event\r\n * @param {string} axis\r\n * @param {number} [options.min]\r\n * @param {number} [options.max]\r\n * @param {number} [options.offset]\r\n */\r\nGridSnapping.prototype.snapEvent = function(event, axis, options) {\r\n  var snappedValue = this.snapValue(event[ axis ], options);\r\n\r\n  setSnapped(event, axis, snappedValue);\r\n};\r\n\r\n/**\r\n * Expose grid spacing for third parties (i.e. extensions).\r\n *\r\n * @return {Number} spacing of grid dots\r\n */\r\nGridSnapping.prototype.getGridSpacing = function() {\r\n  return SPACING;\r\n};\r\n\r\n/**\r\n * Snap value with optional min, max and offset.\r\n *\r\n * @param {number} value\r\n * @param {Object} options\r\n * @param {number} [options.min]\r\n * @param {number} [options.max]\r\n * @param {number} [options.offset]\r\n */\r\nGridSnapping.prototype.snapValue = function(value, options) {\r\n  var offset = 0;\r\n\r\n  if (options && options.offset) {\r\n    offset = options.offset;\r\n  }\r\n\r\n  value += offset;\r\n\r\n  value = quantize(value, SPACING);\r\n\r\n  var min, max;\r\n\r\n  if (options && options.min) {\r\n    min = options.min;\r\n\r\n    if (isNumber(min)) {\r\n      min = quantize(min + offset, SPACING, 'ceil');\r\n\r\n      value = Math.max(value, min);\r\n    }\r\n  }\r\n\r\n  if (options && options.max) {\r\n    max = options.max;\r\n\r\n    if (isNumber(max)) {\r\n      max = quantize(max + offset, SPACING, 'floor');\r\n\r\n      value = Math.min(value, max);\r\n    }\r\n  }\r\n\r\n  value -= offset;\r\n\r\n  return value;\r\n};\r\n\r\nGridSnapping.prototype.isActive = function() {\r\n  return this.active;\r\n};\r\n\r\nGridSnapping.prototype.setActive = function(active) {\r\n  this.active = active;\r\n\r\n  this._eventBus.fire('gridSnapping.toggle', { active: active });\r\n};\r\n\r\nGridSnapping.prototype.toggleActive = function() {\r\n  this.setActive(!this.active);\r\n};\r\n\r\nGridSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'config.gridSnapping'\r\n];\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get minimum and maximum snap constraints.\r\n * Constraints are cached.\r\n *\r\n * @param {Object} event\r\n * @param {Object} event.context\r\n * @param {string} axis\r\n *\r\n * @returns {boolean|Object}\r\n */\r\nfunction getSnapConstraints(event, axis) {\r\n  var context = event.context,\r\n      createConstraints = context.createConstraints,\r\n      resizeConstraints = context.resizeConstraints || {},\r\n      gridSnappingContext = context.gridSnappingContext,\r\n      snapConstraints = gridSnappingContext.snapConstraints;\r\n\r\n  // cache snap constraints\r\n  if (snapConstraints && snapConstraints[ axis ]) {\r\n    return snapConstraints[ axis ];\r\n  }\r\n\r\n  if (!snapConstraints) {\r\n    snapConstraints = gridSnappingContext.snapConstraints = {};\r\n  }\r\n\r\n  if (!snapConstraints[ axis ]) {\r\n    snapConstraints[ axis ] = {};\r\n  }\r\n\r\n  var direction = context.direction;\r\n\r\n  // create\r\n  if (createConstraints) {\r\n    if (isHorizontal(axis)) {\r\n      snapConstraints.x.min = createConstraints.left;\r\n      snapConstraints.x.max = createConstraints.right;\r\n    } else {\r\n      snapConstraints.y.min = createConstraints.top;\r\n      snapConstraints.y.max = createConstraints.bottom;\r\n    }\r\n  }\r\n\r\n  // resize\r\n  var minResizeConstraints = resizeConstraints.min,\r\n      maxResizeConstraints = resizeConstraints.max;\r\n\r\n  if (minResizeConstraints) {\r\n    if (isHorizontal(axis)) {\r\n\r\n      if (isWest(direction)) {\r\n        snapConstraints.x.max = minResizeConstraints.left;\r\n      } else {\r\n        snapConstraints.x.min = minResizeConstraints.right;\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isNorth(direction)) {\r\n        snapConstraints.y.max = minResizeConstraints.top;\r\n      } else {\r\n        snapConstraints.y.min = minResizeConstraints.bottom;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  if (maxResizeConstraints) {\r\n    if (isHorizontal(axis)) {\r\n\r\n      if (isWest(direction)) {\r\n        snapConstraints.x.min = maxResizeConstraints.left;\r\n      } else {\r\n        snapConstraints.x.max = maxResizeConstraints.right;\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isNorth(direction)) {\r\n        snapConstraints.y.min = maxResizeConstraints.top;\r\n      } else {\r\n        snapConstraints.y.max = maxResizeConstraints.bottom;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return snapConstraints[ axis ];\r\n}\r\n\r\n/**\r\n * Get snap offset.\r\n * Offset is cached.\r\n *\r\n * @param {Object} event\r\n * @param {string} axis\r\n * @param {ElementRegistry} elementRegistry\r\n *\r\n * @returns {number}\r\n */\r\nfunction getSnapOffset(event, axis, elementRegistry) {\r\n  var context = event.context,\r\n      shape = event.shape,\r\n      gridSnappingContext = context.gridSnappingContext,\r\n      snapLocation = gridSnappingContext.snapLocation,\r\n      snapOffset = gridSnappingContext.snapOffset;\r\n\r\n  // cache snap offset\r\n  if (snapOffset && isNumber(snapOffset[ axis ])) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (!snapOffset) {\r\n    snapOffset = gridSnappingContext.snapOffset = {};\r\n  }\r\n\r\n  if (!isNumber(snapOffset[ axis ])) {\r\n    snapOffset[ axis ] = 0;\r\n  }\r\n\r\n  if (!shape) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (!elementRegistry.get(shape.id)) {\r\n\r\n    if (isHorizontal(axis)) {\r\n      snapOffset[ axis ] += shape[ axis ] + shape.width / 2;\r\n    } else {\r\n      snapOffset[ axis ] += shape[ axis ] + shape.height / 2;\r\n    }\r\n  }\r\n\r\n  if (!snapLocation) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (axis === 'x') {\r\n    if (/left/.test(snapLocation)) {\r\n      snapOffset[ axis ] -= shape.width / 2;\r\n    } else if (/right/.test(snapLocation)) {\r\n      snapOffset[ axis ] += shape.width / 2;\r\n    }\r\n  } else {\r\n    if (/top/.test(snapLocation)) {\r\n      snapOffset[ axis ] -= shape.height / 2;\r\n    } else if (/bottom/.test(snapLocation)) {\r\n      snapOffset[ axis ] += shape.height / 2;\r\n    }\r\n  }\r\n\r\n  return snapOffset[ axis ];\r\n}\r\n\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}\r\n\r\nfunction isNorth(direction) {\r\n  return direction.indexOf('n') !== -1;\r\n}\r\n\r\nfunction isWest(direction) {\r\n  return direction.indexOf('w') !== -1;\r\n}","import inherits from 'inherits';\r\n\r\nimport CommandInterceptor from '../../../command/CommandInterceptor';\r\n\r\nimport {\r\n  assign,\r\n  isString\r\n} from 'min-dash';\r\n\r\n\r\n/**\r\n * Integrates resizing with grid snapping.\r\n */\r\nexport default function ResizeBehavior(eventBus, gridSnapping) {\r\n  CommandInterceptor.call(this, eventBus);\r\n\r\n  this._gridSnapping = gridSnapping;\r\n\r\n  var self = this;\r\n\r\n  this.preExecute('shape.resize', function(event) {\r\n    var context = event.context,\r\n        hints = context.hints || {},\r\n        autoResize = hints.autoResize;\r\n\r\n    if (!autoResize) {\r\n      return;\r\n    }\r\n\r\n    var shape = context.shape,\r\n        newBounds = context.newBounds;\r\n\r\n    if (isString(autoResize)) {\r\n      context.newBounds = self.snapComplex(newBounds, autoResize);\r\n    } else {\r\n      context.newBounds = self.snapSimple(shape, newBounds);\r\n    }\r\n  });\r\n}\r\n\r\nResizeBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping',\r\n  'modeling'\r\n];\r\n\r\ninherits(ResizeBehavior, CommandInterceptor);\r\n\r\n/**\r\n * Snap width and height in relation to center.\r\n *\r\n * @param {djs.model.shape} shape\r\n * @param {Bounds} newBounds\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapSimple = function(shape, newBounds) {\r\n  var gridSnapping = this._gridSnapping;\r\n\r\n  newBounds.width = gridSnapping.snapValue(newBounds.width, {\r\n    min: newBounds.width\r\n  });\r\n\r\n  newBounds.height = gridSnapping.snapValue(newBounds.height, {\r\n    min: newBounds.height\r\n  });\r\n\r\n  newBounds.x = shape.x + (shape.width / 2) - (newBounds.width / 2);\r\n  newBounds.y = shape.y + (shape.height / 2) - (newBounds.height / 2);\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap x, y, width and height according to given directions.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapComplex = function(newBounds, directions) {\r\n  if (/w|e/.test(directions)) {\r\n    newBounds = this.snapHorizontally(newBounds, directions);\r\n  }\r\n\r\n  if (/n|s/.test(directions)) {\r\n    newBounds = this.snapVertically(newBounds, directions);\r\n  }\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap in one or both directions horizontally.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapHorizontally = function(newBounds, directions) {\r\n  var gridSnapping = this._gridSnapping,\r\n      west = /w/.test(directions),\r\n      east = /e/.test(directions);\r\n\r\n  var snappedNewBounds = {};\r\n\r\n  snappedNewBounds.width = gridSnapping.snapValue(newBounds.width, {\r\n    min: newBounds.width\r\n  });\r\n\r\n  if (east) {\r\n\r\n    // handle <we>\r\n    if (west) {\r\n      snappedNewBounds.x = gridSnapping.snapValue(newBounds.x, {\r\n        max: newBounds.x\r\n      });\r\n\r\n      snappedNewBounds.width += gridSnapping.snapValue(newBounds.x - snappedNewBounds.x, {\r\n        min: newBounds.x - snappedNewBounds.x\r\n      });\r\n    }\r\n\r\n    // handle <e>\r\n    else {\r\n      newBounds.x = newBounds.x + newBounds.width - snappedNewBounds.width;\r\n    }\r\n  }\r\n\r\n  // assign snapped x and width\r\n  assign(newBounds, snappedNewBounds);\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap in one or both directions vertically.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapVertically = function(newBounds, directions) {\r\n  var gridSnapping = this._gridSnapping,\r\n      north = /n/.test(directions),\r\n      south = /s/.test(directions);\r\n\r\n  var snappedNewBounds = {};\r\n\r\n  snappedNewBounds.height = gridSnapping.snapValue(newBounds.height, {\r\n    min: newBounds.height\r\n  });\r\n\r\n  if (north) {\r\n\r\n    // handle <ns>\r\n    if (south) {\r\n      snappedNewBounds.y = gridSnapping.snapValue(newBounds.y, {\r\n        max: newBounds.y\r\n      });\r\n\r\n      snappedNewBounds.height += gridSnapping.snapValue(newBounds.y - snappedNewBounds.y, {\r\n        min: newBounds.y - snappedNewBounds.y\r\n      });\r\n    }\r\n\r\n    // handle <n>\r\n    else {\r\n      newBounds.y = newBounds.y + newBounds.height - snappedNewBounds.height;\r\n    }\r\n  }\r\n\r\n  // assign snapped y and height\r\n  assign(newBounds, snappedNewBounds);\r\n\r\n  return newBounds;\r\n};","var HIGH_PRIORITY = 2000;\r\n\r\n/**\r\n * Integrates space tool with grid snapping.\r\n */\r\nexport default function SpaceToolBehavior(eventBus, gridSnapping) {\r\n  eventBus.on([\r\n    'spaceTool.move',\r\n    'spaceTool.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context;\r\n\r\n    if (!context.initialized) {\r\n      return;\r\n    }\r\n\r\n    var axis = context.axis;\r\n\r\n    var snapped;\r\n\r\n    if (axis === 'x') {\r\n\r\n      // snap delta x to multiple of 10\r\n      snapped = gridSnapping.snapValue(event.dx);\r\n\r\n      event.x = event.x + snapped - event.dx;\r\n      event.dx = snapped;\r\n    } else {\r\n\r\n      // snap delta y to multiple of 10\r\n      snapped = gridSnapping.snapValue(event.dy);\r\n\r\n      event.y = event.y + snapped - event.dy;\r\n      event.dy = snapped;\r\n    }\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping'\r\n];","import ResizeBehavior from './ResizeBehavior';\r\nimport SpaceToolBehavior from './SpaceToolBehavior';\r\n\r\nexport default {\r\n  __init__: [\r\n    'gridSnappingResizeBehavior',\r\n    'gridSnappingSpaceToolBehavior'\r\n  ],\r\n  gridSnappingResizeBehavior: [ 'type', ResizeBehavior ],\r\n  gridSnappingSpaceToolBehavior: [ 'type', SpaceToolBehavior ]\r\n};","import GridSnapping from './GridSnapping';\r\n\r\nimport GridSnappingBehaviorModule from './behavior';\r\n\r\nexport default {\r\n  __depends__: [ GridSnappingBehaviorModule ],\r\n  __init__: [ 'gridSnapping' ],\r\n  gridSnapping: [ 'type', GridSnapping ]\r\n};","import { getNewShapePosition } from '../../auto-place/AutoPlaceUtil';\r\n\r\nimport { getMid } from 'diagram-js/lib/layout/LayoutUtil';\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\n\r\nexport default function AutoPlaceBehavior(eventBus, gridSnapping) {\r\n  eventBus.on('autoPlace', function(context) {\r\n    var source = context.source,\r\n        sourceMid = getMid(source),\r\n        shape = context.shape;\r\n\r\n    var position = getNewShapePosition(source, shape);\r\n\r\n    [ 'x', 'y' ].forEach(function(axis) {\r\n      var options = {};\r\n\r\n      // do not snap if x/y equal\r\n      if (position[ axis ] === sourceMid[ axis ]) {\r\n        return;\r\n      }\r\n\r\n      if (position[ axis ] > sourceMid[ axis ]) {\r\n        options.min = position[ axis ];\r\n      } else {\r\n        options.max = position[ axis ];\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n\r\n        if (isHorizontal(axis)) {\r\n          options.offset = -shape.width / 2;\r\n        } else {\r\n          options.offset = -shape.height / 2;\r\n        }\r\n\r\n      }\r\n\r\n      position[ axis ] = gridSnapping.snapValue(position[ axis ], options);\r\n\r\n    });\r\n\r\n    // must be returned to be considered by auto place\r\n    return position;\r\n  });\r\n}\r\n\r\nAutoPlaceBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping'\r\n];\r\n\r\n// helpers //////////\r\n\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}","import { is } from '../../../util/ModelUtil';\r\n\r\nvar HIGHER_PRIORITY = 1750;\r\n\r\n\r\nexport default function CreateParticipantBehavior(canvas, eventBus, gridSnapping) {\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        rootElement = canvas.getRootElement();\r\n\r\n    if (!is(shape, 'bpmn:Participant') ||\r\n      !is(rootElement, 'bpmn:Process') ||\r\n      !rootElement.children.length) {\r\n      return;\r\n    }\r\n\r\n    var createConstraints = context.createConstraints;\r\n\r\n    if (!createConstraints) {\r\n      return;\r\n    }\r\n\r\n    shape.width = gridSnapping.snapValue(shape.width, { min: shape.width });\r\n    shape.height = gridSnapping.snapValue(shape.height, { min: shape.height });\r\n  });\r\n}\r\n\r\nCreateParticipantBehavior.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'gridSnapping'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { pointsAligned } from 'diagram-js/lib/util/Geometry';\n\nimport {\n  assign\n} from 'min-dash';\n\nvar HIGH_PRIORITY = 3000;\n\n\n/**\n * Snaps connections with Manhattan layout.\n */\nexport default function LayoutConnectionBehavior(eventBus, gridSnapping, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  this._gridSnapping = gridSnapping;\n\n  var self = this;\n\n  this.postExecuted([\n    'connection.create',\n    'connection.layout'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        hints = context.hints || {},\n        waypoints = connection.waypoints;\n\n    if (hints.connectionStart || hints.connectionEnd || hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (!hasMiddleSegments(waypoints)) {\n      return;\n    }\n\n    modeling.updateWaypoints(connection, self.snapMiddleSegments(waypoints));\n  });\n}\n\nLayoutConnectionBehavior.$inject = [\n  'eventBus',\n  'gridSnapping',\n  'modeling'\n];\n\ninherits(LayoutConnectionBehavior, CommandInterceptor);\n\n/**\n * Snap middle segments of a given connection.\n *\n * @param {Array<Point>} waypoints\n *\n * @returns {Array<Point>}\n */\nLayoutConnectionBehavior.prototype.snapMiddleSegments = function(waypoints) {\n  var gridSnapping = this._gridSnapping,\n      snapped;\n\n  waypoints = waypoints.slice();\n\n  for (var i = 1; i < waypoints.length - 2; i++) {\n\n    snapped = snapSegment(gridSnapping, waypoints[i], waypoints[i + 1]);\n\n    waypoints[i] = snapped[0];\n    waypoints[i + 1] = snapped[1];\n  }\n\n  return waypoints;\n};\n\n\n// helpers //////////\n\n/**\n * Check whether a connection has a middle segments.\n *\n * @param {Array} waypoints\n *\n * @returns {boolean}\n */\nfunction hasMiddleSegments(waypoints) {\n  return waypoints.length > 3;\n}\n\n/**\n * Check whether an alignment is horizontal.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction horizontallyAligned(aligned) {\n  return aligned === 'h';\n}\n\n/**\n * Check whether an alignment is vertical.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction verticallyAligned(aligned) {\n  return aligned === 'v';\n}\n\n/**\n * Get middle segments from a given connection.\n *\n * @param {Array} waypoints\n *\n * @returns {Array}\n */\nfunction snapSegment(gridSnapping, segmentStart, segmentEnd) {\n\n  var aligned = pointsAligned(segmentStart, segmentEnd);\n\n  var snapped = {};\n\n  if (horizontallyAligned(aligned)) {\n\n    // snap horizontally\n    snapped.y = gridSnapping.snapValue(segmentStart.y);\n  }\n\n  if (verticallyAligned(aligned)) {\n\n    // snap vertically\n    snapped.x = gridSnapping.snapValue(segmentStart.x);\n  }\n\n  if ('x' in snapped || 'y' in snapped) {\n    segmentStart = assign({}, segmentStart, snapped);\n    segmentEnd = assign({}, segmentEnd, snapped);\n  }\n\n  return [ segmentStart, segmentEnd ];\n}","import AutoPlaceBehavior from './AutoPlaceBehavior';\r\nimport CreateParticipantBehavior from './CreateParticipantBehavior';\r\nimport LayoutConnectionBehavior from './LayoutConnectionBehavior';\r\n\r\nexport default {\r\n  __init__: [\r\n    'gridSnappingAutoPlaceBehavior',\r\n    'gridSnappingCreateParticipantBehavior',\r\n    'gridSnappingLayoutConnectionBehavior',\r\n  ],\r\n  gridSnappingAutoPlaceBehavior: [ 'type', AutoPlaceBehavior ],\r\n  gridSnappingCreateParticipantBehavior: [ 'type', CreateParticipantBehavior ],\r\n  gridSnappingLayoutConnectionBehavior: [ 'type', LayoutConnectionBehavior ]\r\n};","import BpmnGridSnapping from './BpmnGridSnapping';\r\nimport GridSnappingModule from 'diagram-js/lib/features/grid-snapping';\r\n\r\nimport GridSnappingBehaviorModule from './behavior';\r\n\r\nexport default {\r\n  __depends__: [\r\n    GridSnappingModule,\r\n    GridSnappingBehaviorModule\r\n  ],\r\n  __init__: [ 'bpmnGridSnapping' ],\r\n  bpmnGridSnapping: [ 'type', BpmnGridSnapping ]\r\n};","import { is } from '../../util/ModelUtil';\n\nimport { isExpanded } from '../../util/DiUtil';\n\nvar LABEL_WIDTH = 30,\n    LABEL_HEIGHT = 30;\n\n\n/**\n * BPMN-specific hit zones and interaction fixes.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function BpmnInteractionEvents(eventBus, interactionEvents) {\n\n  this._interactionEvents = interactionEvents;\n\n  var self = this;\n\n  eventBus.on([\n    'interactionEvents.createHit',\n    'interactionEvents.updateHit'\n  ], function(context) {\n    var element = context.element,\n        gfx = context.gfx;\n\n    if (is(element, 'bpmn:Lane')) {\n      return self.createParticipantHit(element, gfx);\n    } else\n\n    if (is(element, 'bpmn:Participant')) {\n      if (isExpanded(element)) {\n        return self.createParticipantHit(element, gfx);\n      } else {\n        return self.createDefaultHit(element, gfx);\n      }\n    } else\n\n    if (is(element, 'bpmn:SubProcess')) {\n      if (isExpanded(element)) {\n        return self.createSubProcessHit(element, gfx);\n      } else {\n        return self.createDefaultHit(element, gfx);\n      }\n    }\n  });\n\n}\n\nBpmnInteractionEvents.$inject = [\n  'eventBus',\n  'interactionEvents'\n];\n\n\nBpmnInteractionEvents.prototype.createDefaultHit = function(element, gfx) {\n  this._interactionEvents.removeHits(gfx);\n\n  this._interactionEvents.createDefaultHit(element, gfx);\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createParticipantHit = function(element, gfx) {\n\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, 'click-stroke', {\n    width: element.width,\n    height: element.height\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, 'all', {\n    width: LABEL_WIDTH,\n    height: element.height\n  });\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createSubProcessHit = function(element, gfx) {\n\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, 'click-stroke', {\n    width: element.width,\n    height: element.height\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, 'all', {\n    width: element.width,\n    height: LABEL_HEIGHT\n  });\n\n  // indicate that we created a hit\n  return true;\n};","import BpmnInteractionEvents from './BpmnInteractionEvents';\n\nexport default {\n  __init__: [ 'bpmnInteractionEvents' ],\n  bpmnInteractionEvents: [ 'type', BpmnInteractionEvents ]\n};","import inherits from 'inherits';\n\nimport KeyboardBindings from 'diagram-js/lib/features/keyboard/KeyboardBindings';\n\n\n/**\n * BPMN 2.0 specific keyboard bindings.\n *\n * @param {Injector} injector\n */\nexport default function BpmnKeyboardBindings(injector) {\n  injector.invoke(KeyboardBindings, this);\n}\n\ninherits(BpmnKeyboardBindings, KeyboardBindings);\n\nBpmnKeyboardBindings.$inject = [\n  'injector'\n];\n\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nBpmnKeyboardBindings.prototype.registerBindings = function(keyboard, editorActions) {\n\n  // inherit default bindings\n  KeyboardBindings.prototype.registerBindings.call(this, keyboard, editorActions);\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {String} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n  // select all elements\n  // CTRL + A\n  addListener('selectElements', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['a', 'A'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('selectElements');\n\n      return true;\n    }\n  });\n\n  // search labels\n  // CTRL + F\n  addListener('find', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['f', 'F'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('find');\n\n      return true;\n    }\n  });\n\n  // activate space tool\n  // S\n  addListener('spaceTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['s', 'S'], event)) {\n      editorActions.trigger('spaceTool');\n\n      return true;\n    }\n  });\n\n  // activate lasso tool\n  // L\n  addListener('lassoTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['l', 'L'], event)) {\n      editorActions.trigger('lassoTool');\n\n      return true;\n    }\n  });\n\n  // activate hand tool\n  // H\n  addListener('handTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['h', 'H'], event)) {\n      editorActions.trigger('handTool');\n\n      return true;\n    }\n  });\n\n  // activate global connect tool\n  // C\n  addListener('globalConnectTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['c', 'C'], event)) {\n      editorActions.trigger('globalConnectTool');\n\n      return true;\n    }\n  });\n\n  // activate direct editing\n  // E\n  addListener('directEditing', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['e', 'E'], event)) {\n      editorActions.trigger('directEditing');\n\n      return true;\n    }\n  });\n\n};","import KeyboardModule from 'diagram-js/lib/features/keyboard';\n\nimport BpmnKeyboardBindings from './BpmnKeyboardBindings';\n\nexport default {\n  __depends__: [\n    KeyboardModule\n  ],\n  __init__: [ 'keyboardBindings' ],\n  keyboardBindings: [ 'type', BpmnKeyboardBindings ]\n};\n","import {\n  assign\n} from 'min-dash';\n\n\nvar DEFAULT_CONFIG = {\n  moveSpeed: 1,\n  moveSpeedAccelerated: 10\n};\n\nvar HIGHER_PRIORITY = 1500;\n\nvar LEFT = 'left';\nvar UP = 'up';\nvar RIGHT = 'right';\nvar DOWN = 'down';\n\nvar KEY_TO_DIRECTION = {\n  ArrowLeft: LEFT,\n  Left: LEFT,\n  ArrowUp: UP,\n  Up: UP,\n  ArrowRight: RIGHT,\n  Right: RIGHT,\n  ArrowDown: DOWN,\n  Down: DOWN\n};\n\nvar DIRECTIONS_DELTA = {\n  left: function(speed) {\n    return {\n      x: -speed,\n      y: 0\n    };\n  },\n  up: function(speed) {\n    return {\n      x: 0,\n      y: -speed\n    };\n  },\n  right: function(speed) {\n    return {\n      x: speed,\n      y: 0\n    };\n  },\n  down: function(speed) {\n    return {\n      x: 0,\n      y: speed\n    };\n  }\n};\n\n\n/**\n * Enables to move selection with keyboard arrows.\n * Use with Shift for modified speed (default=1, with Shift=10).\n * Pressed Cmd/Ctrl turns the feature off.\n *\n * @param {Object} config\n * @param {Number} [config.moveSpeed=1]\n * @param {Number} [config.moveSpeedAccelerated=10]\n * @param {Keyboard} keyboard\n * @param {Modeling} modeling\n * @param {Selection} selection\n */\nexport default function KeyboardMoveSelection(\n    config,\n    keyboard,\n    modeling,\n    rules,\n    selection\n) {\n\n  var self = this;\n\n  this._config = assign({}, DEFAULT_CONFIG, config || {});\n\n  keyboard.addListener(HIGHER_PRIORITY, function(event) {\n\n    var keyEvent = event.keyEvent;\n\n    var direction = KEY_TO_DIRECTION[keyEvent.key];\n\n    if (!direction) {\n      return;\n    }\n\n    if (keyboard.isCmd(keyEvent)) {\n      return;\n    }\n\n    var accelerated = keyboard.isShift(keyEvent);\n\n    self.moveSelection(direction, accelerated);\n\n    return true;\n  });\n\n\n  /**\n   * Move selected elements in the given direction,\n   * optionally specifying accelerated movement.\n   *\n   * @param {String} direction\n   * @param {Boolean} [accelerated=false]\n   */\n  this.moveSelection = function(direction, accelerated) {\n\n    var selectedElements = selection.get();\n\n    if (!selectedElements.length) {\n      return;\n    }\n\n    var speed = this._config[\n      accelerated ?\n        'moveSpeedAccelerated' :\n        'moveSpeed'\n    ];\n\n    var delta = DIRECTIONS_DELTA[direction](speed);\n\n    var canMove = rules.allowed('elements.move', {\n      shapes: selectedElements\n    });\n\n    if (canMove) {\n      modeling.moveElements(selectedElements, delta);\n    }\n  };\n\n}\n\nKeyboardMoveSelection.$inject = [\n  'config.keyboardMoveSelection',\n  'keyboard',\n  'modeling',\n  'rules',\n  'selection'\n];","import KeyboardModule from '../keyboard';\nimport SelectionModule from '../selection';\n\nimport KeyboardMoveSelection from './KeyboardMoveSelection';\n\nexport default {\n  __depends__: [\n    KeyboardModule,\n    SelectionModule\n  ],\n  __init__: [\n    'keyboardMoveSelection'\n  ],\n  keyboardMoveSelection: [ 'type', KeyboardMoveSelection ]\n};\n","import {\n  getType as getElementType\n} from '../../util/Elements';\n\n/**\n * Adds change support to the diagram, including\n *\n * <ul>\n *   <li>redrawing shapes and connections on change</li>\n * </ul>\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n * @param {GraphicsFactory} graphicsFactory\n */\nexport default function ChangeSupport(\n    eventBus, canvas, elementRegistry,\n    graphicsFactory) {\n\n\n  // redraw shapes / connections on change\n\n  eventBus.on('element.changed', function(event) {\n\n    var element = event.element;\n\n    // element might have been deleted and replaced by new element with same ID\n    // thus check for parent of element except for root element\n    if (element.parent || element === canvas.getRootElement()) {\n      event.gfx = elementRegistry.getGraphics(element);\n    }\n\n    // shape + gfx may have been deleted\n    if (!event.gfx) {\n      return;\n    }\n\n    eventBus.fire(getElementType(element) + '.changed', event);\n  });\n\n  eventBus.on('elements.changed', function(event) {\n\n    var elements = event.elements;\n\n    elements.forEach(function(e) {\n      eventBus.fire('element.changed', { element: e });\n    });\n\n    graphicsFactory.updateContainments(elements);\n  });\n\n  eventBus.on('shape.changed', function(event) {\n    graphicsFactory.update('shape', event.element, event.gfx);\n  });\n\n  eventBus.on('connection.changed', function(event) {\n    graphicsFactory.update('connection', event.element, event.gfx);\n  });\n}\n\nChangeSupport.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'graphicsFactory'\n];","import ChangeSupport from './ChangeSupport';\n\nexport default {\n  __init__: [ 'changeSupport'],\n  changeSupport: [ 'type', ChangeSupport ]\n};","import {\n  pick,\n  assign\n} from 'min-dash';\n\nimport {\n  resizeBounds,\n  ensureConstraints,\n  computeChildrenBBox,\n  getMinResizeBounds\n} from './ResizeUtil';\n\nimport {\n  asTRBL,\n  getMid,\n  roundBounds\n} from '../../layout/LayoutUtil';\n\nvar DEFAULT_MIN_WIDTH = 10;\n\n\n/**\n * A component that provides resizing of shapes on the canvas.\n *\n * The following components are part of shape resize:\n *\n *  * adding resize handles,\n *  * creating a visual during resize\n *  * checking resize rules\n *  * committing a change once finished\n *\n *\n * ## Customizing\n *\n * It's possible to customize the resizing behaviour by intercepting 'resize.start'\n * and providing the following parameters through the 'context':\n *\n *   * minDimensions ({ width, height }): minimum shape dimensions\n *\n *   * childrenBoxPadding ({ left, top, bottom, right } || number):\n *     gap between the minimum bounding box and the container\n *\n * f.ex:\n *\n * ```javascript\n * eventBus.on('resize.start', 1500, function(event) {\n *   var context = event.context,\n *\n *  context.minDimensions = { width: 140, height: 120 };\n *\n *  // Passing general padding\n *  context.childrenBoxPadding = 30;\n *\n *  // Passing padding to a specific side\n *  context.childrenBoxPadding.left = 20;\n * });\n * ```\n */\nexport default function Resize(eventBus, rules, modeling, dragging) {\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  var self = this;\n\n\n  /**\n   * Handle resize move by specified delta.\n   *\n   * @param {Object} context\n   * @param {Point} delta\n   */\n  function handleMove(context, delta) {\n\n    var shape = context.shape,\n        direction = context.direction,\n        resizeConstraints = context.resizeConstraints,\n        newBounds;\n\n    context.delta = delta;\n\n    newBounds = resizeBounds(shape, direction, delta);\n\n    // ensure constraints during resize\n    context.newBounds = ensureConstraints(newBounds, resizeConstraints);\n\n    // update + cache executable state\n    context.canExecute = self.canResize(context);\n  }\n\n  /**\n   * Handle resize start.\n   *\n   * @param  {Object} context\n   */\n  function handleStart(context) {\n\n    var resizeConstraints = context.resizeConstraints,\n\n        // evaluate minBounds for backwards compatibility\n        minBounds = context.minBounds;\n\n    if (resizeConstraints !== undefined) {\n      return;\n    }\n\n    if (minBounds === undefined) {\n      minBounds = self.computeMinResizeBox(context);\n    }\n\n    context.resizeConstraints = {\n      min: asTRBL(minBounds)\n    };\n  }\n\n  /**\n   * Handle resize end.\n   *\n   * @param  {Object} context\n   */\n  function handleEnd(context) {\n    var shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (canExecute) {\n\n      // ensure we have actual pixel values for new bounds\n      // (important when zoom level was > 1 during move)\n      newBounds = roundBounds(newBounds);\n\n      if (!boundsChanged(shape, newBounds)) {\n\n        // no resize necessary\n        return;\n      }\n\n      // perform the actual resize\n      modeling.resizeShape(shape, newBounds);\n    }\n  }\n\n\n  eventBus.on('resize.start', function(event) {\n    handleStart(event.context);\n  });\n\n  eventBus.on('resize.move', function(event) {\n    var delta = {\n      x: event.dx,\n      y: event.dy\n    };\n\n    handleMove(event.context, delta);\n  });\n\n  eventBus.on('resize.end', function(event) {\n    handleEnd(event.context);\n  });\n\n}\n\n\nResize.prototype.canResize = function(context) {\n  var rules = this._rules;\n\n  var ctx = pick(context, [ 'newBounds', 'shape', 'delta', 'direction' ]);\n\n  return rules.allowed('shape.resize', ctx);\n};\n\n/**\n * Activate a resize operation.\n *\n * You may specify additional contextual information and must specify a\n * resize direction during activation of the resize event.\n *\n * @param {MouseEvent} event\n * @param {djs.model.Shape} shape\n * @param {Object|String} contextOrDirection\n */\nResize.prototype.activate = function(event, shape, contextOrDirection) {\n  var dragging = this._dragging,\n      context,\n      direction;\n\n  if (typeof contextOrDirection === 'string') {\n    contextOrDirection = {\n      direction: contextOrDirection\n    };\n  }\n\n  context = assign({ shape: shape }, contextOrDirection);\n\n  direction = context.direction;\n\n  if (!direction) {\n    throw new Error('must provide a direction (n|w|s|e|nw|se|ne|sw)');\n  }\n\n  dragging.init(event, getReferencePoint(shape, direction), 'resize', {\n    autoActivate: true,\n    cursor: getCursor(direction),\n    data: {\n      shape: shape,\n      context: context\n    }\n  });\n};\n\nResize.prototype.computeMinResizeBox = function(context) {\n  var shape = context.shape,\n      direction = context.direction,\n      minDimensions,\n      childrenBounds;\n\n  minDimensions = context.minDimensions || {\n    width: DEFAULT_MIN_WIDTH,\n    height: DEFAULT_MIN_WIDTH\n  };\n\n  // get children bounds\n  childrenBounds = computeChildrenBBox(shape, context.childrenBoxPadding);\n\n  // get correct minimum bounds from given resize direction\n  // basically ensures that the minBounds is max(childrenBounds, minDimensions)\n  return getMinResizeBounds(direction, shape, minDimensions, childrenBounds);\n};\n\n\nResize.$inject = [\n  'eventBus',\n  'rules',\n  'modeling',\n  'dragging'\n];\n\n// helpers //////////\n\nfunction boundsChanged(shape, newBounds) {\n  return shape.x !== newBounds.x ||\n    shape.y !== newBounds.y ||\n    shape.width !== newBounds.width ||\n    shape.height !== newBounds.height;\n}\n\nexport function getReferencePoint(shape, direction) {\n  var mid = getMid(shape),\n      trbl = asTRBL(shape);\n\n  var referencePoint = {\n    x: mid.x,\n    y: mid.y\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    referencePoint.y = trbl.top;\n  } else if (direction.indexOf('s') !== -1) {\n    referencePoint.y = trbl.bottom;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    referencePoint.x = trbl.right;\n  } else if (direction.indexOf('w') !== -1) {\n    referencePoint.x = trbl.left;\n  }\n\n  return referencePoint;\n}\n\nfunction getCursor(direction) {\n  var prefix = 'resize-';\n\n  if (direction === 'n' || direction === 's') {\n    return prefix + 'ns';\n  } else if (direction === 'e' || direction === 'w') {\n    return prefix + 'ew';\n  } else if (direction === 'nw' || direction === 'se') {\n    return prefix + 'nwse';\n  } else {\n    return prefix + 'nesw';\n  }\n}","var MARKER_RESIZING = 'djs-resizing',\n    MARKER_RESIZE_NOT_OK = 'resize-not-ok';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  attr as svgAttr,\n  remove as svgRemove,\n  classes as svgClasses\n} from 'tiny-svg';\n\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n\n    var shape = context.shape,\n        bounds = context.newBounds,\n        frame = context.frame;\n\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getDefaultLayer());\n\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n\n    if (bounds.width > 5) {\n      svgAttr(frame, { x: bounds.x, width: bounds.width });\n    }\n\n    if (bounds.height > 5) {\n      svgAttr(frame, { y: bounds.y, height: bounds.height });\n    }\n\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n        frame = context.frame;\n\n    if (frame) {\n      svgRemove(context.frame);\n    }\n\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function(event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function(event) {\n    removeFrame(event.context);\n  });\n\n}\n\nResizePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'previewSupport'\n];","import {\n  bind,\n  forEach\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  clear as svgClear,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  isPrimaryButton\n} from '../../util/Mouse';\n\nimport {\n  transform\n} from '../../util/SvgTransformUtil';\n\nimport { getReferencePoint } from './Resize';\n\nvar HANDLE_OFFSET = -6,\n    HANDLE_SIZE = 4,\n    HANDLE_HIT_SIZE = 20;\n\nvar CLS_RESIZER = 'djs-resizer';\n\nvar directions = [ 'n', 'w', 's', 'e', 'nw', 'ne', 'se', 'sw' ];\n\n\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n\n  this._resize = resize;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n    var newSelection = e.newSelection;\n\n    // remove old selection markers\n    self.removeResizers();\n\n    // add new selection markers ONLY if single selection\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n\n  eventBus.on('shape.changed', function(e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n\n      self.addResizer(shape);\n    }\n  });\n}\n\n\nResizeHandles.prototype.makeDraggable = function(element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\n\nResizeHandles.prototype._createResizer = function(element, x, y, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var offset = getHandleOffset(direction);\n\n  var group = svgCreate('g');\n\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n\n  svgAppend(resizersParent, group);\n\n  var visual = svgCreate('rect');\n\n  svgAttr(visual, {\n    x: -HANDLE_SIZE / 2 + offset.x,\n    y: -HANDLE_SIZE / 2 + offset.y,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n\n  svgAppend(group, visual);\n\n  var hit = svgCreate('rect');\n\n  svgAttr(hit, {\n    x: -HANDLE_HIT_SIZE / 2 + offset.x,\n    y: -HANDLE_HIT_SIZE / 2 + offset.y,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n\n  svgAppend(group, hit);\n\n  transform(group, x, y);\n\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function(element, direction) {\n  var point = getReferencePoint(element, direction);\n\n  var resizer = this._createResizer(element, point.x, point.y, direction);\n\n  this.makeDraggable(element, resizer, direction);\n};\n\n// resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Shape} shape\n */\nResizeHandles.prototype.addResizer = function(shape) {\n  var self = this;\n\n  var resize = this._resize;\n\n  if (!resize.canResize({ shape: shape })) {\n    return;\n  }\n\n  forEach(directions, function(direction) {\n    self.createResizer(shape, direction);\n  });\n};\n\n/**\n * Remove all resizers\n */\nResizeHandles.prototype.removeResizers = function() {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function() {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'resize'\n];\n\n// helpers //////////\n\nfunction getHandleOffset(direction) {\n  var offset = {\n    x: 0,\n    y: 0\n  };\n\n  if (direction.indexOf('e') !== -1) {\n    offset.x = -HANDLE_OFFSET;\n  } else if (direction.indexOf('w') !== -1) {\n    offset.x = HANDLE_OFFSET;\n  }\n\n  if (direction.indexOf('s') !== -1) {\n    offset.y = -HANDLE_OFFSET;\n  } else if (direction.indexOf('n') !== -1) {\n    offset.y = HANDLE_OFFSET;\n  }\n\n  return offset;\n}","import RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Resize from './Resize';\nimport ResizePreview from './ResizePreview';\nimport ResizeHandles from './ResizeHandles';\n\nexport default {\n  __depends__: [\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'resize',\n    'resizePreview',\n    'resizeHandles'\n  ],\n  resize: [ 'type', Resize ],\n  resizePreview: [ 'type', ResizePreview ],\n  resizeHandles: [ 'type', ResizeHandles ]\n};\n","import {\n  add as collectionAdd\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  getBusinessObject\n} from '../../../../util/ModelUtil';\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nexport function createCategoryValue(definitions, bpmnFactory) {\n  var categoryValue = bpmnFactory.create('bpmn:CategoryValue'),\n      category = bpmnFactory.create('bpmn:Category', {\n        categoryValue: [ categoryValue ]\n      });\n\n  // add to correct place\n  collectionAdd(definitions.get('rootElements'), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n\n}","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getLabel\n} from './LabelUtil';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  createCategoryValue\n} from '../modeling/behavior/util/CategoryUtil';\n\nimport { isAny } from '../modeling/util/ModelingUtil';\nimport { isExpanded } from '../../util/DiUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../util/LabelUtil';\n\n\nexport default function LabelEditingProvider(\n    eventBus, bpmnFactory, canvas, directEditing,\n    modeling, resizeHandles, textRenderer) {\n\n  this._bpmnFactory = bpmnFactory;\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n\n  directEditing.registerProvider(this);\n\n  // listen to dblclick on non-root elements\n  eventBus.on('element.dblclick', function(event) {\n    activateDirectEdit(event.element, true);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on([\n    'autoPlace.start',\n    'canvas.viewbox.changing',\n    'drag.init',\n    'element.mousedown',\n    'popupMenu.open'\n  ], function(event) {\n\n    if (directEditing.isActive()) {\n      directEditing.complete();\n    }\n  });\n\n  // cancel on command stack changes\n  eventBus.on([ 'commandStack.changed' ], function(e) {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n\n\n  eventBus.on('directEditing.activate', function(event) {\n    resizeHandles.removeResizers();\n  });\n\n  eventBus.on('create.end', 500, function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n\n  eventBus.on('autoPlace.end', 500, function(event) {\n    activateDirectEdit(event.shape);\n  });\n\n\n  function activateDirectEdit(element, force) {\n    if (force ||\n        isAny(element, [ 'bpmn:Task', 'bpmn:TextAnnotation', 'bpmn:Group' ]) ||\n        isCollapsedSubProcess(element)) {\n\n      directEditing.activate(element);\n    }\n  }\n\n}\n\nLabelEditingProvider.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'canvas',\n  'directEditing',\n  'modeling',\n  'resizeHandles',\n  'textRenderer'\n];\n\n\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\nLabelEditingProvider.prototype.activate = function(element) {\n\n  // text\n  var text = getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  var context = {\n    text: text\n  };\n\n  // bounds\n  var bounds = this.getEditingBBox(element);\n\n  assign(context, bounds);\n\n  var options = {};\n\n  // tasks\n  if (\n    isAny(element, [\n      'bpmn:Task',\n      'bpmn:Participant',\n      'bpmn:Lane',\n      'bpmn:CallActivity'\n    ]) ||\n    isCollapsedSubProcess(element)\n  ) {\n    assign(options, {\n      centerVertically: true\n    });\n  }\n\n  // external labels\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(options, {\n      resizable: true,\n      autoResize: true\n    });\n  }\n\n  assign(context, {\n    options: options\n  });\n\n  return context;\n};\n\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function(element) {\n  var canvas = this._canvas;\n\n  var target = element.label || element;\n\n  var bbox = canvas.getAbsoluteBBox(target);\n\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  };\n\n  // default position\n  var bounds = { x: bbox.x, y: bbox.y };\n\n  var zoom = canvas.zoom();\n\n  var defaultStyle = this._textRenderer.getDefaultStyle(),\n      externalStyle = this._textRenderer.getExternalStyle();\n\n  // take zoom into account\n  var externalFontSize = externalStyle.fontSize * zoom,\n      externalLineHeight = externalStyle.lineHeight,\n      defaultFontSize = defaultStyle.fontSize * zoom,\n      defaultLineHeight = defaultStyle.lineHeight;\n\n  var style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight\n  };\n\n  // adjust for expanded pools AND lanes\n  if (is(element, 'bpmn:Lane') || isExpandedPool(element)) {\n\n    assign(bounds, {\n      width: bbox.height,\n      height: 30 * zoom,\n      x: bbox.x - bbox.height / 2 + (15 * zoom),\n      y: mid.y - (30 * zoom) / 2\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      transform: 'rotate(-90deg)'\n    });\n  }\n\n\n  // internal labels for tasks and collapsed call activities,\n  // sub processes and participants\n  if (isAny(element, [ 'bpmn:Task', 'bpmn:CallActivity']) ||\n      isCollapsedPool(element) ||\n      isCollapsedSubProcess(element)) {\n\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n\n  // internal labels for expanded sub processes\n  if (isExpandedSubProcess(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      x: bbox.x\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n  var width = 90 * zoom,\n      paddingTop = 7 * zoom,\n      paddingBottom = 4 * zoom;\n\n  // external labels for events, data elements, gateways, groups and connections\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // external label not yet created\n  if (isLabelExternal(target)\n      && !hasExternalLabel(target)\n      && !isLabel(target)) {\n\n    var externalLabelMid = getExternalLabelMid(element);\n\n    var absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0\n    });\n\n    var height = externalFontSize + paddingTop + paddingBottom;\n\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n      minWidth: 30 * zoom,\n      minHeight: 10 * zoom\n    });\n\n    assign(style, {\n      textAlign: 'left',\n      paddingTop: (5 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (7 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight\n    });\n  }\n\n  return { bounds: bounds, style: style };\n};\n\n\nLabelEditingProvider.prototype.update = function(\n    element, newLabel,\n    activeContextText, bounds) {\n\n  var newBounds,\n      bbox;\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n\n    bbox = this._canvas.getAbsoluteBBox(element);\n\n    newBounds = {\n      x: element.x,\n      y: element.y,\n      width: element.width / bbox.width * bounds.width,\n      height: element.height / bbox.height * bounds.height\n    };\n  }\n\n  if (is(element, 'bpmn:Group')) {\n\n    var businessObject = getBusinessObject(element);\n\n    // initialize categoryValue if not existing\n    if (!businessObject.categoryValueRef) {\n\n      var rootElement = this._canvas.getRootElement(),\n          definitions = getBusinessObject(rootElement).$parent;\n\n      var categoryValue = createCategoryValue(definitions, this._bpmnFactory);\n\n      getBusinessObject(element).categoryValueRef = categoryValue;\n    }\n\n  }\n\n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n};\n\n\n\n// helpers //////////////////////\n\nfunction isCollapsedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && !isExpanded(element);\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isCollapsedPool(element) {\n  return is(element, 'bpmn:Participant') && !isExpanded(element);\n}\n\nfunction isExpandedPool(element) {\n  return is(element, 'bpmn:Participant') && isExpanded(element);\n}\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  translate\n} from 'diagram-js/lib/util/SvgTransformUtil';\n\nvar MARKER_HIDDEN = 'djs-element-hidden',\n    MARKER_LABEL_HIDDEN = 'djs-label-hidden';\n\n\nexport default function LabelEditingPreview(\n    eventBus, canvas, elementRegistry,\n    pathMap) {\n\n  var self = this;\n\n  var defaultLayer = canvas.getDefaultLayer();\n\n  var element, absoluteElementBBox, gfx;\n\n  eventBus.on('directEditing.activate', function(context) {\n    var activeProvider = context.active;\n\n    element = activeProvider.element.label || activeProvider.element;\n\n    // text annotation\n    if (is(element, 'bpmn:TextAnnotation')) {\n      absoluteElementBBox = canvas.getAbsoluteBBox(element);\n\n      gfx = svgCreate('g');\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      var path = self.path = svgCreate('path');\n\n      svgAttr(path, {\n        d: textPathData,\n        strokeWidth: 2,\n        stroke: getStrokeColor(element)\n      });\n\n      svgAppend(gfx, path);\n\n      svgAppend(defaultLayer, gfx);\n\n      translate(gfx, element.x, element.y);\n    }\n\n    if (is(element, 'bpmn:TextAnnotation') ||\n        element.labelTarget) {\n      canvas.addMarker(element, MARKER_HIDDEN);\n    } else if (is(element, 'bpmn:Task') ||\n               is(element, 'bpmn:CallActivity') ||\n               is(element, 'bpmn:SubProcess') ||\n               is(element, 'bpmn:Participant')) {\n      canvas.addMarker(element, MARKER_LABEL_HIDDEN);\n    }\n  });\n\n  eventBus.on('directEditing.resize', function(context) {\n\n    // text annotation\n    if (is(element, 'bpmn:TextAnnotation')) {\n      var height = context.height,\n          dy = context.dy;\n\n      var newElementHeight = Math.max(element.height / absoluteElementBBox.height * (height + dy), 0);\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: newElementHeight,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      svgAttr(self.path, {\n        d: textPathData\n      });\n    }\n  });\n\n  eventBus.on([ 'directEditing.complete', 'directEditing.cancel' ], function(context) {\n    var activeProvider = context.active;\n\n    if (activeProvider) {\n      canvas.removeMarker(activeProvider.element.label || activeProvider.element, MARKER_HIDDEN);\n      canvas.removeMarker(element, MARKER_LABEL_HIDDEN);\n    }\n\n    element = undefined;\n    absoluteElementBBox = undefined;\n\n    if (gfx) {\n      svgRemove(gfx);\n\n      gfx = undefined;\n    }\n  });\n}\n\nLabelEditingPreview.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'pathMap'\n];\n\n\n// helpers ///////////////////\n\nfunction getStrokeColor(element, defaultColor) {\n  var bo = getBusinessObject(element);\n\n  return bo.di.get('stroke') || defaultColor || 'black';\n}","import ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport DirectEditingModule from 'diagram-js-direct-editing';\n\nimport LabelEditingProvider from './LabelEditingProvider';\nimport LabelEditingPreview from './LabelEditingPreview';\n\n\nexport default {\n  __depends__: [\n    ChangeSupportModule,\n    ResizeModule,\n    DirectEditingModule\n  ],\n  __init__: [\n    'labelEditingProvider',\n    'labelEditingPreview'\n  ],\n  labelEditingProvider: [ 'type', LabelEditingProvider ],\n  labelEditingPreview: [ 'type', LabelEditingPreview ]\n};\n","import inherits from 'inherits';\n\nimport {\n  getOrientation,\n  getMid,\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substract\n} from 'diagram-js/lib/util/Math';\n\nimport {\n  hasExternalLabel\n} from '../../../util/LabelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nvar ALIGNMENTS = [\n  'top',\n  'bottom',\n  'left',\n  'right'\n];\n\nvar ELEMENT_LABEL_DISTANCE = 10;\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AdaptiveLabelPositioningBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.postExecuted([\n    'connection.create',\n    'connection.layout',\n    'connection.updateWaypoints'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(source);\n      checkLabelAdjustment(target);\n    }\n  });\n\n\n  this.postExecuted([\n    'label.create'\n  ], function(event) {\n    var context = event.context,\n        shape = context.shape,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(shape.labelTarget);\n    }\n  });\n\n\n  this.postExecuted([\n    'elements.create'\n  ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      elements.forEach(function(element) {\n        checkLabelAdjustment(element);\n      });\n    }\n  });\n\n  function checkLabelAdjustment(element) {\n\n    // skip non-existing labels\n    if (!hasExternalLabel(element)) {\n      return;\n    }\n\n    var optimalPosition = getOptimalPosition(element);\n\n    // no optimal position found\n    if (!optimalPosition) {\n      return;\n    }\n\n    adjustLabelPosition(element, optimalPosition);\n  }\n\n  function adjustLabelPosition(element, orientation) {\n\n    var elementMid = getMid(element),\n        label = element.label,\n        labelMid = getMid(label);\n\n    // ignore labels that are being created\n    if (!label.parent) {\n      return;\n    }\n\n    var elementTrbl = asTRBL(element);\n\n    var newLabelMid;\n\n    switch (orientation) {\n    case 'top':\n      newLabelMid = {\n        x: elementMid.x,\n        y: elementTrbl.top - ELEMENT_LABEL_DISTANCE - label.height / 2\n      };\n\n      break;\n\n    case 'left':\n\n      newLabelMid = {\n        x: elementTrbl.left - ELEMENT_LABEL_DISTANCE - label.width / 2,\n        y: elementMid.y\n      };\n\n      break;\n\n    case 'bottom':\n\n      newLabelMid = {\n        x: elementMid.x,\n        y: elementTrbl.bottom + ELEMENT_LABEL_DISTANCE + label.height / 2\n      };\n\n      break;\n\n    case 'right':\n\n      newLabelMid = {\n        x: elementTrbl.right + ELEMENT_LABEL_DISTANCE + label.width / 2,\n        y: elementMid.y\n      };\n\n      break;\n    }\n\n    var delta = substract(newLabelMid, labelMid);\n\n    modeling.moveShape(label, delta);\n  }\n\n}\n\ninherits(AdaptiveLabelPositioningBehavior, CommandInterceptor);\n\nAdaptiveLabelPositioningBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Return alignments which are taken by a boundary's host element\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenHostAlignments(element) {\n\n  var hostElement = element.host,\n      elementMid = getMid(element),\n      hostOrientation = getOrientation(elementMid, hostElement);\n\n  var freeAlignments;\n\n  // check whether there is a multi-orientation, e.g. 'top-left'\n  if (hostOrientation.indexOf('-') >= 0) {\n    freeAlignments = hostOrientation.split('-');\n  } else {\n    freeAlignments = [ hostOrientation ];\n  }\n\n  var takenAlignments = ALIGNMENTS.filter(function(alignment) {\n\n    return freeAlignments.indexOf(alignment) === -1;\n  });\n\n  return takenAlignments;\n\n}\n\n/**\n * Return alignments which are taken by related connections\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenConnectionAlignments(element) {\n\n  var elementMid = getMid(element);\n\n  var takenAlignments = [].concat(\n    element.incoming.map(function(c) {\n      return c.waypoints[c.waypoints.length - 2 ];\n    }),\n    element.outgoing.map(function(c) {\n      return c.waypoints[1];\n    })\n  ).map(function(point) {\n    return getApproximateOrientation(elementMid, point);\n  });\n\n  return takenAlignments;\n}\n\n/**\n * Return the optimal label position around an element\n * or _undefined_, if none was found.\n *\n * @param  {Shape} element\n *\n * @return {String} positioning identifier\n */\nfunction getOptimalPosition(element) {\n\n  var labelMid = getMid(element.label);\n\n  var elementMid = getMid(element);\n\n  var labelOrientation = getApproximateOrientation(elementMid, labelMid);\n\n  if (!isAligned(labelOrientation)) {\n    return;\n  }\n\n  var takenAlignments = getTakenConnectionAlignments(element);\n\n  if (element.host) {\n    var takenHostAlignments = getTakenHostAlignments(element);\n\n    takenAlignments = takenAlignments.concat(takenHostAlignments);\n  }\n\n  var freeAlignments = ALIGNMENTS.filter(function(alignment) {\n\n    return takenAlignments.indexOf(alignment) === -1;\n  });\n\n  // NOTHING TO DO; label already aligned a.O.K.\n  if (freeAlignments.indexOf(labelOrientation) !== -1) {\n    return;\n  }\n\n  return freeAlignments[0];\n}\n\nfunction getApproximateOrientation(p0, p1) {\n  return getOrientation(p1, p0, 5);\n}\n\nfunction isAligned(orientation) {\n  return ALIGNMENTS.indexOf(orientation) !== -1;\n}\n","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n\nexport default function AppendBehavior(eventBus, elementFactory, bpmnRules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // assign correct shape position unless already set\n\n  this.preExecute('shape.append', function(context) {\n\n    var source = context.source,\n        shape = context.shape;\n\n    if (!context.position) {\n\n      if (is(shape, 'bpmn:TextAnnotation')) {\n        context.position = {\n          x: source.x + source.width / 2 + 75,\n          y: source.y - (50) - shape.height / 2\n        };\n      } else {\n        context.position = {\n          x: source.x + source.width + 80 + shape.width / 2,\n          y: source.y + source.height / 2\n        };\n      }\n    }\n  }, true);\n}\n\ninherits(AppendBehavior, CommandInterceptor);\n\nAppendBehavior.$inject = [\n  'eventBus',\n  'elementFactory',\n  'bpmnRules'\n];","import inherits from 'inherits';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  filter,\r\n  forEach\r\n} from 'min-dash';\r\n\r\n\r\nexport default function AssociationBehavior(injector, modeling) {\r\n  injector.invoke(CommandInterceptor, this);\r\n\r\n  this.postExecute('shape.move', function(context) {\r\n    var newParent = context.newParent,\r\n        shape = context.shape;\r\n\r\n    var associations = filter(shape.incoming.concat(shape.outgoing), function(connection) {\r\n      return is(connection, 'bpmn:Association');\r\n    });\r\n\r\n    forEach(associations, function(association) {\r\n      modeling.moveConnection(association, { x: 0, y: 0 }, newParent);\r\n    });\r\n  }, true);\r\n}\r\n\r\ninherits(AssociationBehavior, CommandInterceptor);\r\n\r\nAssociationBehavior.$inject = [\r\n  'injector',\r\n  'modeling'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject } from '../../../util/ModelUtil';\n\nimport { isAny } from '../util/ModelingUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Replace intermediate event with boundary event when creating or moving results in attached event.\n */\nexport default function AttachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  var self = this;\n\n  this.postExecuted('elements.create', LOW_PRIORITY, function(context) {\n    var elements = context.elements;\n\n    elements = elements.filter(function(shape) {\n      var host = shape.host;\n\n      return shouldReplace(shape, host);\n    });\n\n    if (elements.length !== 1) {\n      return;\n    }\n\n    elements.map(function(element) {\n      return elements.indexOf(element);\n    }).forEach(function(index) {\n      var host = elements[ index ];\n\n      context.elements[ index ] = self.replaceShape(elements[ index ], host);\n    });\n  }, true);\n\n\n  this.preExecute('elements.move', LOW_PRIORITY, function(context) {\n    var shapes = context.shapes,\n        host = context.newHost;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    if (shouldReplace(shape, host)) {\n      context.shapes = [ self.replaceShape(shape, host) ];\n    }\n  }, true);\n}\n\nAttachEventBehavior.$inject = [\n  'bpmnReplace',\n  'injector'\n];\n\ninherits(AttachEventBehavior, CommandInterceptor);\n\nAttachEventBehavior.prototype.replaceShape = function(shape, host) {\n  var eventDefinition = getEventDefinition(shape);\n\n  var boundaryEvent = {\n    type: 'bpmn:BoundaryEvent',\n    host: host\n  };\n\n  if (eventDefinition) {\n    boundaryEvent.eventDefinitionType = eventDefinition.$type;\n  }\n\n  return this._bpmnReplace.replaceElement(shape, boundaryEvent, { layoutConnection: false });\n};\n\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  var businessObject = getBusinessObject(element),\n      eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) &&\n    isAny(shape, [ 'bpmn:IntermediateThrowEvent', 'bpmn:IntermediateCatchEvent' ]) && !!host;\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  filter,\n  forEach\n} from 'min-dash';\n\n\n/**\n * BPMN specific boundary event behavior\n */\nexport default function BoundaryEventBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  function getBoundaryEvents(element) {\n    return filter(element.attachers, function(attacher) {\n      return is(attacher, 'bpmn:BoundaryEvent');\n    });\n  }\n\n  // remove after connecting to event-based gateway\n  this.postExecute('connection.create', function(event) {\n    var source = event.context.source,\n        target = event.context.target,\n        boundaryEvents = getBoundaryEvents(target);\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      is(target, 'bpmn:ReceiveTask') &&\n      boundaryEvents.length > 0\n    ) {\n      modeling.removeElements(boundaryEvents);\n    }\n\n  });\n\n  // remove after replacing connected gateway with event-based gateway\n  this.postExecute('connection.reconnect', function(event) {\n    var oldSource = event.context.oldSource,\n        newSource = event.context.newSource;\n\n    if (is(oldSource, 'bpmn:Gateway') &&\n        is(newSource, 'bpmn:EventBasedGateway')) {\n      forEach(newSource.outgoing, function(connection) {\n        var target = connection.target,\n            attachedboundaryEvents = getBoundaryEvents(target);\n\n        if (is(target, 'bpmn:ReceiveTask') &&\n            attachedboundaryEvents.length > 0) {\n          modeling.removeElements(attachedboundaryEvents);\n        }\n      });\n    }\n  });\n}\n\nBoundaryEventBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(BoundaryEventBehavior, CommandInterceptor);\n","import inherits from 'inherits';\r\n\r\nimport {\r\n  find,\r\n  isArray,\r\n  matchPattern,\r\n  some\r\n} from 'min-dash';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  add as collectionAdd,\r\n  remove as collectionRemove\r\n} from 'diagram-js/lib/util/Collections';\r\n\r\nimport {\r\n  getBusinessObject,\r\n  is\r\n} from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nimport { hasEventDefinition } from '../../../util/DiUtil';\r\n\r\nvar LOW_PRIORITY = 500;\r\n\r\n\r\n/**\r\n * Add referenced root elements (error, escalation, message, signal) if they don't exist.\r\n * Copy referenced root elements on copy & paste.\r\n */\r\nexport default function RootElementReferenceBehavior(\r\n    bpmnjs, eventBus, injector, moddleCopy, bpmnFactory\r\n) {\r\n  injector.invoke(CommandInterceptor, this);\r\n\r\n  function canHaveRootElementReference(element) {\r\n    return isAny(element, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ]) ||\r\n      hasAnyEventDefinition(element, [\r\n        'bpmn:ErrorEventDefinition',\r\n        'bpmn:EscalationEventDefinition',\r\n        'bpmn:MessageEventDefinition',\r\n        'bpmn:SignalEventDefinition'\r\n      ]);\r\n  }\r\n\r\n  function hasRootElement(rootElement) {\r\n    var definitions = bpmnjs.getDefinitions(),\r\n        rootElements = definitions.get('rootElements');\r\n\r\n    return !!find(rootElements, matchPattern({ id: rootElement.id }));\r\n  }\r\n\r\n  function getRootElementReferencePropertyName(eventDefinition) {\r\n    if (is(eventDefinition, 'bpmn:ErrorEventDefinition')) {\r\n      return 'errorRef';\r\n    } else if (is(eventDefinition, 'bpmn:EscalationEventDefinition')) {\r\n      return 'escalationRef';\r\n    } else if (is(eventDefinition, 'bpmn:MessageEventDefinition')) {\r\n      return 'messageRef';\r\n    } else if (is(eventDefinition, 'bpmn:SignalEventDefinition')) {\r\n      return 'signalRef';\r\n    }\r\n  }\r\n\r\n  function getRootElement(businessObject) {\r\n    if (isAny(businessObject, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ])) {\r\n      return businessObject.get('messageRef');\r\n    }\r\n\r\n    var eventDefinitions = businessObject.get('eventDefinitions'),\r\n        eventDefinition = eventDefinitions[ 0 ];\r\n\r\n    return eventDefinition.get(getRootElementReferencePropertyName(eventDefinition));\r\n  }\r\n\r\n  function setRootElement(businessObject, rootElement) {\r\n    if (isAny(businessObject, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ])) {\r\n      return businessObject.set('messageRef', rootElement);\r\n    }\r\n\r\n    var eventDefinitions = businessObject.get('eventDefinitions'),\r\n        eventDefinition = eventDefinitions[ 0 ];\r\n\r\n    return eventDefinition.set(getRootElementReferencePropertyName(eventDefinition), rootElement);\r\n  }\r\n\r\n  // create shape\r\n  this.executed('shape.create', function(context) {\r\n    var shape = context.shape;\r\n\r\n    if (!canHaveRootElementReference(shape)) {\r\n      return;\r\n    }\r\n\r\n    var businessObject = getBusinessObject(shape),\r\n        rootElement = getRootElement(businessObject),\r\n        rootElements;\r\n\r\n    if (rootElement && !hasRootElement(rootElement)) {\r\n      rootElements = bpmnjs.getDefinitions().get('rootElements');\r\n\r\n      // add root element\r\n      collectionAdd(rootElements, rootElement);\r\n\r\n      context.addedRootElement = rootElement;\r\n    }\r\n  }, true);\r\n\r\n  this.reverted('shape.create', function(context) {\r\n    var addedRootElement = context.addedRootElement;\r\n\r\n    if (!addedRootElement) {\r\n      return;\r\n    }\r\n\r\n    var rootElements = bpmnjs.getDefinitions().get('rootElements');\r\n\r\n    // remove root element\r\n    collectionRemove(rootElements, addedRootElement);\r\n  }, true);\r\n\r\n  eventBus.on('copyPaste.copyElement', function(context) {\r\n    var descriptor = context.descriptor,\r\n        element = context.element;\r\n\r\n    if (!canHaveRootElementReference(element)) {\r\n      return;\r\n    }\r\n\r\n    var businessObject = getBusinessObject(element),\r\n        rootElement = getRootElement(businessObject);\r\n\r\n    if (rootElement) {\r\n      descriptor.referencedRootElement = rootElement;\r\n    }\r\n  });\r\n\r\n  eventBus.on('copyPaste.pasteElement', LOW_PRIORITY, function(context) {\r\n    var descriptor = context.descriptor,\r\n        businessObject = descriptor.businessObject;\r\n\r\n    if (!canHaveRootElementReference(businessObject)) {\r\n      return;\r\n    }\r\n\r\n    var referencedRootElement = descriptor.referencedRootElement;\r\n\r\n    if (!referencedRootElement) {\r\n      return;\r\n    }\r\n\r\n    if (!hasRootElement(referencedRootElement)) {\r\n      referencedRootElement = moddleCopy.copyElement(\r\n        referencedRootElement,\r\n        bpmnFactory.create(referencedRootElement.$type)\r\n      );\r\n    }\r\n\r\n    setRootElement(businessObject, referencedRootElement);\r\n  });\r\n}\r\n\r\nRootElementReferenceBehavior.$inject = [\r\n  'bpmnjs',\r\n  'eventBus',\r\n  'injector',\r\n  'moddleCopy',\r\n  'bpmnFactory'\r\n];\r\n\r\ninherits(RootElementReferenceBehavior, CommandInterceptor);\r\n\r\n// helpers //////////\r\n\r\nfunction hasAnyEventDefinition(element, types) {\r\n  if (!isArray(types)) {\r\n    types = [ types ];\r\n  }\r\n\r\n  return some(types, function(type) {\r\n    return hasEventDefinition(element, type);\r\n  });\r\n}","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getParent } from '../util/ModelingUtil';\n\n\nexport default function CreateBehavior(injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute('shape.create', 1500, function(event) {\n    var context = event.context,\n        parent = context.parent,\n        shape = context.shape;\n\n    if (is(parent, 'bpmn:Lane') && !is(shape, 'bpmn:Lane')) {\n      context.parent = getParent(parent, 'bpmn:Participant');\n    }\n  });\n\n}\n\n\nCreateBehavior.$inject = [ 'injector' ];\n\ninherits(CreateBehavior, CommandInterceptor);","import { getLanesRoot } from '../util/LaneUtil';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\nvar HIGHEST_PRIORITY = 2000;\r\n\r\n\r\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\r\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\r\n\r\n  eventBus.on([\r\n    'create.hover',\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.hover',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape || event.shape,\r\n        hover = event.hover;\r\n\r\n    // ensure elements are not dropped onto a bpmn:Lane but onto\r\n    // the underlying bpmn:Participant\r\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, [ 'bpmn:Lane', 'bpmn:Participant' ])) {\r\n      event.hover = getLanesRoot(hover);\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n\r\n    var rootElement = canvas.getRootElement();\r\n\r\n    // ensure bpmn:Group and label elements are dropped\r\n    // always onto the root\r\n    if (hover !== rootElement && (shape.labelTarget || is(shape, 'bpmn:Group'))) {\r\n      event.hover = rootElement;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.out',\r\n    'connect.end',\r\n    'connect.cleanup',\r\n    'global-connect.hover',\r\n    'global-connect.out',\r\n    'global-connect.end',\r\n    'global-connect.cleanup'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var hover = event.hover;\r\n\r\n    // ensure connections start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane')) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'bendpoint.move.hover'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        hover = event.hover,\r\n        type = context.type;\r\n\r\n    // ensure reconnect start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.start'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        start = context.start;\r\n\r\n    // ensure connect start on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(start, 'bpmn:Lane')) {\r\n      context.start = getLanesRoot(start) || start;\r\n    }\r\n  });\r\n\r\n\r\n  // allow movement of participants from lanes\r\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function(event) {\r\n    var shape = event.shape;\r\n\r\n    if (is(shape, 'bpmn:Lane')) {\r\n      event.shape = getLanesRoot(shape) || shape;\r\n    }\r\n  });\r\n\r\n}\r\n\r\nFixHoverBehavior.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * BPMN specific create data object behavior\n */\nexport default function CreateDataObjectBehavior(eventBus, bpmnFactory, moddle) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute('shape.create', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:DataObjectReference') && shape.type !== 'label') {\n\n      // create a DataObject every time a DataObjectReference is created\n      var dataObject = bpmnFactory.create('bpmn:DataObject');\n\n      // set the reference to the DataObject\n      shape.businessObject.dataObjectRef = dataObject;\n    }\n  });\n\n}\n\nCreateDataObjectBehavior.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'moddle'\n];\n\ninherits(CreateDataObjectBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nimport { getBBox } from 'diagram-js/lib/util/Elements';\n\nimport {\n  assign,\n  find\n} from 'min-dash';\n\nimport { asTRBL } from 'diagram-js/lib/layout/LayoutUtil';\n\nvar HORIZONTAL_PARTICIPANT_PADDING = 20,\n    VERTICAL_PARTICIPANT_PADDING = 20;\n\nexport var PARTICIPANT_BORDER_WIDTH = 30;\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * BPMN-specific behavior for creating participants.\n */\nexport default function CreateParticipantBehavior(canvas, eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  // fit participant\n  eventBus.on([\n    'create.start',\n    'shape.move.start'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement();\n\n    if (!is(shape, 'bpmn:Participant') ||\n      !is(rootElement, 'bpmn:Process') ||\n      !rootElement.children.length) {\n      return;\n    }\n\n    // ignore connections, groups and labels\n    var children = rootElement.children.filter(function(element) {\n      return !is(element, 'bpmn:Group') &&\n        !isLabel(element) &&\n        !isConnection(element);\n    });\n\n    // ensure for available children to calculate bounds\n    if (!children.length) {\n      return;\n    }\n\n    var childrenBBox = getBBox(children);\n\n    var participantBounds = getParticipantBounds(shape, childrenBBox);\n\n    // assign width and height\n    assign(shape, participantBounds);\n\n    // assign create constraints\n    context.createConstraints = getParticipantCreateConstraints(shape, childrenBBox);\n  });\n\n  // force hovering process when creating first participant\n  eventBus.on('create.start', HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement(),\n        rootElementGfx = canvas.getGraphics(rootElement);\n\n    function ensureHoveringProcess(event) {\n      event.element = rootElement;\n      event.gfx = rootElementGfx;\n    }\n\n    if (is(shape, 'bpmn:Participant') && is(rootElement, 'bpmn:Process')) {\n      eventBus.on('element.hover', HIGH_PRIORITY, ensureHoveringProcess);\n\n      eventBus.once('create.cleanup', function() {\n        eventBus.off('element.hover', ensureHoveringProcess);\n      });\n    }\n  });\n\n  function ensureCollaboration(context) {\n    var parent = context.parent,\n        collaboration;\n\n    var rootElement = canvas.getRootElement();\n\n    if (is(rootElement, 'bpmn:Collaboration')) {\n      collaboration = rootElement;\n    } else {\n\n      // update root element by making collaboration\n      collaboration = modeling.makeCollaboration();\n\n      // re-use process when creating first participant\n      context.process = parent;\n    }\n\n    context.parent = collaboration;\n  }\n\n  // turn process into collaboration before adding participant\n  this.preExecute('shape.create', function(context) {\n    var parent = context.parent,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Participant') && is(parent, 'bpmn:Process')) {\n      ensureCollaboration(context);\n    }\n  }, true);\n\n  this.execute('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n      context.oldProcessRef = shape.businessObject.processRef;\n\n      // re-use process when creating first participant\n      shape.businessObject.processRef = process.businessObject;\n    }\n  }, true);\n\n  this.revert('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n\n      // re-use process when creating first participant\n      shape.businessObject.processRef = context.oldProcessRef;\n    }\n  }, true);\n\n  this.postExecute('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n\n      // move children from process to participant\n      var processChildren = process.children.slice();\n\n      modeling.moveElements(processChildren, { x: 0, y: 0 }, shape);\n    }\n\n  }, true);\n\n  // turn process into collaboration when creating participants\n  this.preExecute('elements.create', HIGH_PRIORITY, function(context) {\n    var elements = context.elements,\n        parent = context.parent,\n        participant;\n\n    var hasParticipants = findParticipant(elements);\n\n    if (hasParticipants && is(parent, 'bpmn:Process')) {\n      ensureCollaboration(context);\n\n      participant = findParticipant(elements);\n\n      context.oldProcessRef = participant.businessObject.processRef;\n\n      // re-use process when creating first participant\n      participant.businessObject.processRef = parent.businessObject;\n    }\n  }, true);\n\n  this.revert('elements.create', function(context) {\n    var elements = context.elements,\n        process = context.process,\n        participant;\n\n    if (process) {\n      participant = findParticipant(elements);\n\n      // re-use process when creating first participant\n      participant.businessObject.processRef = context.oldProcessRef;\n    }\n  }, true);\n\n  this.postExecute('elements.create', function(context) {\n    var elements = context.elements,\n        process = context.process,\n        participant;\n\n    if (process) {\n      participant = findParticipant(elements);\n\n      // move children from process to first participant\n      var processChildren = process.children.slice();\n\n      modeling.moveElements(processChildren, { x: 0, y: 0 }, participant);\n    }\n\n  }, true);\n\n}\n\nCreateParticipantBehavior.$inject = [\n  'canvas',\n  'eventBus',\n  'modeling'\n];\n\ninherits(CreateParticipantBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getParticipantBounds(shape, childrenBBox) {\n  childrenBBox = {\n    width: childrenBBox.width + HORIZONTAL_PARTICIPANT_PADDING * 2 + PARTICIPANT_BORDER_WIDTH,\n    height: childrenBBox.height + VERTICAL_PARTICIPANT_PADDING * 2\n  };\n\n  var width = Math.max(shape.width, childrenBBox.width),\n      height = Math.max(shape.height, childrenBBox.height);\n\n  return {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getParticipantCreateConstraints(shape, childrenBBox) {\n  childrenBBox = asTRBL(childrenBBox);\n\n  return {\n    bottom: childrenBBox.top + shape.height / 2 - VERTICAL_PARTICIPANT_PADDING,\n    left: childrenBBox.right - shape.width / 2 + HORIZONTAL_PARTICIPANT_PADDING,\n    top: childrenBBox.bottom - shape.height / 2 + VERTICAL_PARTICIPANT_PADDING,\n    right: childrenBBox.left + shape.width / 2 - HORIZONTAL_PARTICIPANT_PADDING - PARTICIPANT_BORDER_WIDTH\n  };\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction findParticipant(elements) {\n  return find(elements, function(element) {\n    return is(element, 'bpmn:Participant');\n  });\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  find\n} from 'min-dash';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar TARGET_REF_PLACEHOLDER_NAME = '__targetRef_placeholder';\n\n\n/**\n * This behavior makes sure we always set a fake\n * DataInputAssociation#targetRef as demanded by the BPMN 2.0\n * XSD schema.\n *\n * The reference is set to a bpmn:Property{ name: '__targetRef_placeholder' }\n * which is created on the fly and cleaned up afterwards if not needed\n * anymore.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n */\nexport default function DataInputAssociationBehavior(eventBus, bpmnFactory) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  this.executed([\n    'connection.create',\n    'connection.delete',\n    'connection.move',\n    'connection.reconnect'\n  ], ifDataInputAssociation(fixTargetRef));\n\n  this.reverted([\n    'connection.create',\n    'connection.delete',\n    'connection.move',\n    'connection.reconnect'\n  ], ifDataInputAssociation(fixTargetRef));\n\n\n  function usesTargetRef(element, targetRef, removedConnection) {\n\n    var inputAssociations = element.get('dataInputAssociations');\n\n    return find(inputAssociations, function(association) {\n      return association !== removedConnection &&\n             association.targetRef === targetRef;\n    });\n  }\n\n  function getTargetRef(element, create) {\n\n    var properties = element.get('properties');\n\n    var targetRefProp = find(properties, function(p) {\n      return p.name === TARGET_REF_PLACEHOLDER_NAME;\n    });\n\n    if (!targetRefProp && create) {\n      targetRefProp = bpmnFactory.create('bpmn:Property', {\n        name: TARGET_REF_PLACEHOLDER_NAME\n      });\n\n      collectionAdd(properties, targetRefProp);\n    }\n\n    return targetRefProp;\n  }\n\n  function cleanupTargetRef(element, connection) {\n\n    var targetRefProp = getTargetRef(element);\n\n    if (!targetRefProp) {\n      return;\n    }\n\n    if (!usesTargetRef(element, targetRefProp, connection)) {\n      collectionRemove(element.get('properties'), targetRefProp);\n    }\n  }\n\n  /**\n   * Make sure targetRef is set to a valid property or\n   * `null` if the connection is detached.\n   *\n   * @param {Event} event\n   */\n  function fixTargetRef(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        connectionBo = connection.businessObject,\n        target = connection.target,\n        targetBo = target && target.businessObject,\n        newTarget = context.newTarget,\n        newTargetBo = newTarget && newTarget.businessObject,\n        oldTarget = context.oldTarget || context.target,\n        oldTargetBo = oldTarget && oldTarget.businessObject;\n\n    var dataAssociation = connection.businessObject,\n        targetRefProp;\n\n    if (oldTargetBo && oldTargetBo !== targetBo) {\n      cleanupTargetRef(oldTargetBo, connectionBo);\n    }\n\n    if (newTargetBo && newTargetBo !== targetBo) {\n      cleanupTargetRef(newTargetBo, connectionBo);\n    }\n\n    if (targetBo) {\n      targetRefProp = getTargetRef(targetBo, true);\n      dataAssociation.targetRef = targetRefProp;\n    } else {\n      dataAssociation.targetRef = null;\n    }\n  }\n}\n\nDataInputAssociationBehavior.$inject = [\n  'eventBus',\n  'bpmnFactory'\n];\n\ninherits(DataInputAssociationBehavior, CommandInterceptor);\n\n\n/**\n * Only call the given function when the event\n * touches a bpmn:DataInputAssociation.\n *\n * @param {Function} fn\n * @return {Function}\n */\nfunction ifDataInputAssociation(fn) {\n\n  return function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    if (is(connection, 'bpmn:DataInputAssociation')) {\n      return fn(event);\n    }\n  };\n}","export default function UpdateSemanticParentHandler(bpmnUpdater) {\r\n  this._bpmnUpdater = bpmnUpdater;\r\n}\r\n\r\nUpdateSemanticParentHandler.$inject = [ 'bpmnUpdater' ];\r\n\r\n\r\nUpdateSemanticParentHandler.prototype.execute = function(context) {\r\n  var dataStoreBo = context.dataStoreBo,\r\n      newSemanticParent = context.newSemanticParent,\r\n      newDiParent = context.newDiParent;\r\n\r\n  context.oldSemanticParent = dataStoreBo.$parent;\r\n  context.oldDiParent = dataStoreBo.di.$parent;\r\n\r\n  // update semantic parent\r\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, newSemanticParent);\r\n\r\n  // update DI parent\r\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, newDiParent);\r\n};\r\n\r\nUpdateSemanticParentHandler.prototype.revert = function(context) {\r\n  var dataStoreBo = context.dataStoreBo,\r\n      oldSemanticParent = context.oldSemanticParent,\r\n      oldDiParent = context.oldDiParent;\r\n\r\n  // update semantic parent\r\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, oldSemanticParent);\r\n\r\n  // update DI parent\r\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, oldDiParent);\r\n};\r\n\r\n","import inherits from 'inherits';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nimport UpdateSemanticParentHandler from '../cmd/UpdateSemanticParentHandler';\r\n\r\n\r\n/**\r\n * BPMN specific data store behavior\r\n */\r\nexport default function DataStoreBehavior(\r\n    canvas, commandStack, elementRegistry,\r\n    eventBus) {\r\n\r\n  CommandInterceptor.call(this, eventBus);\r\n\r\n  commandStack.registerHandler('dataStore.updateContainment', UpdateSemanticParentHandler);\r\n\r\n  function getFirstParticipant() {\r\n    return elementRegistry.filter(function(element) {\r\n      return is(element, 'bpmn:Participant');\r\n    })[0];\r\n  }\r\n\r\n  function getDataStores(element) {\r\n    return element.children.filter(function(child) {\r\n      return is(child, 'bpmn:DataStoreReference') && !child.labelTarget;\r\n    });\r\n  }\r\n\r\n  function updateDataStoreParent(dataStore, newDataStoreParent) {\r\n    var dataStoreBo = dataStore.businessObject || dataStore;\r\n\r\n    newDataStoreParent = newDataStoreParent || getFirstParticipant();\r\n\r\n    if (newDataStoreParent) {\r\n      var newDataStoreParentBo = newDataStoreParent.businessObject || newDataStoreParent;\r\n\r\n      commandStack.execute('dataStore.updateContainment', {\r\n        dataStoreBo: dataStoreBo,\r\n        newSemanticParent: newDataStoreParentBo.processRef || newDataStoreParentBo,\r\n        newDiParent: newDataStoreParentBo.di\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  // disable auto-resize for data stores\r\n  this.preExecute('shape.create', function(event) {\r\n\r\n    var context = event.context,\r\n        shape = context.shape;\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label') {\r\n\r\n      if (!context.hints) {\r\n        context.hints = {};\r\n      }\r\n\r\n      // prevent auto resizing\r\n      context.hints.autoResize = false;\r\n    }\r\n  });\r\n\r\n\r\n  // disable auto-resize for data stores\r\n  this.preExecute('elements.move', function(event) {\r\n    var context = event.context,\r\n        shapes = context.shapes;\r\n\r\n    var dataStoreReferences = shapes.filter(function(shape) {\r\n      return is(shape, 'bpmn:DataStoreReference');\r\n    });\r\n\r\n    if (dataStoreReferences.length) {\r\n      if (!context.hints) {\r\n        context.hints = {};\r\n      }\r\n\r\n      // prevent auto resizing for data store references\r\n      context.hints.autoResize = shapes.filter(function(shape) {\r\n        return !is(shape, 'bpmn:DataStoreReference');\r\n      });\r\n    }\r\n  });\r\n\r\n\r\n  // update parent on data store created\r\n  this.postExecute('shape.create', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent;\r\n\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label' &&\r\n        is(parent, 'bpmn:Collaboration')) {\r\n\r\n      updateDataStoreParent(shape);\r\n    }\r\n  });\r\n\r\n\r\n  // update parent on data store moved\r\n  this.postExecute('shape.move', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        oldParent = context.oldParent,\r\n        parent = shape.parent;\r\n\r\n    if (is(oldParent, 'bpmn:Collaboration')) {\r\n\r\n      // do nothing if not necessary\r\n      return;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label' &&\r\n        is(parent, 'bpmn:Collaboration')) {\r\n\r\n      var participant = is(oldParent, 'bpmn:Participant') ?\r\n        oldParent :\r\n        getAncestor(oldParent, 'bpmn:Participant');\r\n\r\n      updateDataStoreParent(shape, participant);\r\n    }\r\n  });\r\n\r\n\r\n  // update data store parents on participant or subprocess deleted\r\n  this.postExecute('shape.delete', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        rootElement = canvas.getRootElement();\r\n\r\n    if (isAny(shape, [ 'bpmn:Participant', 'bpmn:SubProcess' ])\r\n        && is(rootElement, 'bpmn:Collaboration')) {\r\n      getDataStores(rootElement)\r\n        .filter(function(dataStore) {\r\n          return isDescendant(dataStore, shape);\r\n        })\r\n        .forEach(function(dataStore) {\r\n          updateDataStoreParent(dataStore);\r\n        });\r\n    }\r\n  });\r\n\r\n  // update data store parents on collaboration -> process\r\n  this.postExecute('canvas.updateRoot', function(event) {\r\n    var context = event.context,\r\n        oldRoot = context.oldRoot,\r\n        newRoot = context.newRoot;\r\n\r\n    var dataStores = getDataStores(oldRoot);\r\n\r\n    dataStores.forEach(function(dataStore) {\r\n\r\n      if (is(newRoot, 'bpmn:Process')) {\r\n        updateDataStoreParent(dataStore, newRoot);\r\n      }\r\n\r\n    });\r\n  });\r\n}\r\n\r\nDataStoreBehavior.$inject = [\r\n  'canvas',\r\n  'commandStack',\r\n  'elementRegistry',\r\n  'eventBus',\r\n];\r\n\r\ninherits(DataStoreBehavior, CommandInterceptor);\r\n\r\n\r\n// helpers //////////\r\n\r\nfunction isDescendant(descendant, ancestor) {\r\n  var descendantBo = descendant.businessObject || descendant,\r\n      ancestorBo = ancestor.businessObject || ancestor;\r\n\r\n  while (descendantBo.$parent) {\r\n    if (descendantBo.$parent === ancestorBo.processRef || ancestorBo) {\r\n      return true;\r\n    }\r\n\r\n    descendantBo = descendantBo.$parent;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction getAncestor(element, type) {\r\n\r\n  while (element.parent) {\r\n    if (is(element.parent, type)) {\r\n      return element.parent;\r\n    }\r\n\r\n    element = element.parent;\r\n  }\r\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  getChildLanes\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function compensateLaneDelete(shape, oldParent) {\n\n    var siblings = getChildLanes(oldParent);\n\n    var topAffected = [];\n    var bottomAffected = [];\n\n    eachElement(siblings, function(element) {\n\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments,\n        bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected, 'y', offset, shape.y - 10);\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset }, 'n');\n    }\n  }\n\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'spaceTool'\n];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Replace boundary event with intermediate event when creating or moving results in detached event.\n */\nexport default function DetachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  var self = this;\n\n  this.postExecuted('elements.create', LOW_PRIORITY, function(context) {\n    var elements = context.elements;\n\n    elements.filter(function(shape) {\n      var host = shape.host;\n\n      return shouldReplace(shape, host);\n    }).map(function(shape) {\n      return elements.indexOf(shape);\n    }).forEach(function(index) {\n      context.elements[ index ] = self.replaceShape(elements[ index ]);\n    });\n  }, true);\n\n  this.preExecute('elements.move', LOW_PRIORITY, function(context) {\n    var shapes = context.shapes,\n        newHost = context.newHost;\n\n    shapes.forEach(function(shape, index) {\n      var host = shape.host;\n\n      if (shouldReplace(shape, includes(shapes, host) ? host : newHost)) {\n        shapes[ index ] = self.replaceShape(shape);\n      }\n    });\n  }, true);\n}\n\nDetachEventBehavior.$inject = [\n  'bpmnReplace',\n  'injector'\n];\n\ninherits(DetachEventBehavior, CommandInterceptor);\n\nDetachEventBehavior.prototype.replaceShape = function(shape) {\n  var eventDefinition = getEventDefinition(shape),\n      intermediateEvent;\n\n  if (eventDefinition) {\n    intermediateEvent = {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: eventDefinition.$type\n    };\n  } else {\n    intermediateEvent = {\n      type: 'bpmn:IntermediateThrowEvent'\n    };\n  }\n\n  return this._bpmnReplace.replaceElement(shape, intermediateEvent, { layoutConnection: false });\n};\n\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  var businessObject = getBusinessObject(element),\n      eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) && is(shape, 'bpmn:BoundaryEvent') && !host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import inherits from 'inherits';\n\nimport {\n  assign,\n  filter,\n  find,\n  isNumber\n} from 'min-dash';\n\nimport { getMid } from 'diagram-js/lib/layout/LayoutUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getApproxIntersection\n} from 'diagram-js/lib/util/LineIntersection';\n\n\nexport default function DropOnFlowBehavior(eventBus, bpmnRules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Reconnect start / end of a connection after\n   * dropping an element on a flow.\n   */\n\n  function insertShape(shape, targetFlow, positionOrBounds) {\n    var waypoints = targetFlow.waypoints,\n        waypointsBefore,\n        waypointsAfter,\n        dockingPoint,\n        source,\n        target,\n        incomingConnection,\n        outgoingConnection,\n        oldOutgoing = shape.outgoing.slice(),\n        oldIncoming = shape.incoming.slice();\n\n    var mid;\n\n    if (isNumber(positionOrBounds.width)) {\n      mid = getMid(positionOrBounds);\n    } else {\n      mid = positionOrBounds;\n    }\n\n    var intersection = getApproxIntersection(waypoints, mid);\n\n    if (intersection) {\n      waypointsBefore = waypoints.slice(0, intersection.index);\n      waypointsAfter = waypoints.slice(intersection.index + (intersection.bendpoint ? 1 : 0));\n\n      // due to inaccuracy intersection might have been found\n      if (!waypointsBefore.length || !waypointsAfter.length) {\n        return;\n      }\n\n      dockingPoint = intersection.bendpoint ? waypoints[intersection.index] : mid;\n\n      // if last waypointBefore is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsBefore[waypointsBefore.length-1])) {\n        waypointsBefore.push(copy(dockingPoint));\n      }\n\n      // if first waypointAfter is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsAfter[0])) {\n        waypointsAfter.unshift(copy(dockingPoint));\n      }\n    }\n\n    source = targetFlow.source;\n    target = targetFlow.target;\n\n    if (bpmnRules.canConnect(source, shape, targetFlow)) {\n\n      // reconnect source -> inserted shape\n      modeling.reconnectEnd(targetFlow, shape, waypointsBefore || mid);\n\n      incomingConnection = targetFlow;\n    }\n\n    if (bpmnRules.canConnect(shape, target, targetFlow)) {\n\n      if (!incomingConnection) {\n\n        // reconnect inserted shape -> end\n        modeling.reconnectStart(targetFlow, shape, waypointsAfter || mid);\n\n        outgoingConnection = targetFlow;\n      } else {\n        outgoingConnection = modeling.connect(\n          shape, target, { type: targetFlow.type, waypoints: waypointsAfter }\n        );\n      }\n    }\n\n    var duplicateConnections = [].concat(\n\n      incomingConnection && filter(oldIncoming, function(connection) {\n        return connection.source === incomingConnection.source;\n      }) || [],\n\n      outgoingConnection && filter(oldOutgoing, function(connection) {\n        return connection.target === outgoingConnection.target;\n      }) || []\n    );\n\n    if (duplicateConnections.length) {\n      modeling.removeElements(duplicateConnections);\n    }\n  }\n\n  this.preExecute('elements.move', function(context) {\n\n    var newParent = context.newParent,\n        shapes = context.shapes,\n        delta = context.delta,\n        shape = shapes[0];\n\n    if (!shape || !newParent) {\n      return;\n    }\n\n    // if the new parent is a connection,\n    // change it to the new parent's parent\n    if (newParent && newParent.waypoints) {\n      context.newParent = newParent = newParent.parent;\n    }\n\n    var shapeMid = getMid(shape);\n    var newShapeMid = {\n      x: shapeMid.x + delta.x,\n      y: shapeMid.y + delta.y\n    };\n\n    // find a connection which intersects with the\n    // element's mid point\n    var connection = find(newParent.children, function(element) {\n      var canInsert = bpmnRules.canInsert(shapes, element);\n\n      return canInsert && getApproxIntersection(element.waypoints, newShapeMid);\n    });\n\n    if (connection) {\n      context.targetFlow = connection;\n      context.position = newShapeMid;\n    }\n\n  }, true);\n\n  this.postExecuted('elements.move', function(context) {\n\n    var shapes = context.shapes,\n        targetFlow = context.targetFlow,\n        position = context.position;\n\n    if (targetFlow) {\n      insertShape(shapes[0], targetFlow, position);\n    }\n\n  }, true);\n\n  this.preExecute('shape.create', function(context) {\n\n    var parent = context.parent,\n        shape = context.shape;\n\n    if (bpmnRules.canInsert(shape, parent)) {\n      context.targetFlow = parent;\n      context.parent = parent.parent;\n    }\n  }, true);\n\n  this.postExecuted('shape.create', function(context) {\n\n    var shape = context.shape,\n        targetFlow = context.targetFlow,\n        positionOrBounds = context.position;\n\n    if (targetFlow) {\n      insertShape(shape, targetFlow, positionOrBounds);\n    }\n  }, true);\n}\n\ninherits(DropOnFlowBehavior, CommandInterceptor);\n\nDropOnFlowBehavior.$inject = [\n  'eventBus',\n  'bpmnRules',\n  'modeling'\n];\n\n\n// helpers /////////////////////\n\nfunction isPointInsideBBox(bbox, point) {\n  var x = point.x,\n      y = point.y;\n\n  return x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height;\n}\n\nfunction copy(obj) {\n  return assign({}, obj);\n}\n\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nexport default function EventBasedGatewayBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Remove existing sequence flows of event-based target before connecting\n   * from event-based gateway.\n   */\n  this.preExecuted('connection.create', function(event) {\n\n    var context = event.context,\n        source = context.source,\n        target = context.target,\n        existingIncomingConnections = target.incoming.slice();\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      target.incoming.length\n    ) {\n\n      existingIncomingConnections.filter(isSequenceFlow)\n        .forEach(function(sequenceFlow) {\n          modeling.removeConnection(sequenceFlow);\n        });\n    }\n  });\n\n  /**\n   *  After replacing shape with event-based gateway, remove incoming sequence\n   *  flows of event-based targets which do not belong to event-based gateway\n   *  source.\n   */\n  this.preExecuted('shape.replace', function(event) {\n\n    var newShape = event.context.newShape,\n        newShapeTargets,\n        newShapeTargetsIncomingSequenceFlows;\n\n    if (!is(newShape, 'bpmn:EventBasedGateway')) {\n      return;\n    }\n\n    newShapeTargets = newShape.outgoing.filter(isSequenceFlow)\n      .map(function(sequenceFlow) {\n        return sequenceFlow.target;\n      });\n\n    newShapeTargetsIncomingSequenceFlows = newShapeTargets.reduce(function(sequenceFlows, target) {\n      var incomingSequenceFlows = target.incoming.filter(isSequenceFlow);\n\n      return sequenceFlows.concat(incomingSequenceFlows);\n    }, []);\n\n    newShapeTargetsIncomingSequenceFlows.forEach(function(sequenceFlow) {\n      if (sequenceFlow.source !== newShape) {\n        modeling.removeConnection(sequenceFlow);\n      }\n    });\n  });\n}\n\nEventBasedGatewayBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(EventBasedGatewayBehavior, CommandInterceptor);\n\n\n\n// helpers //////////////////////\n\nfunction isSequenceFlow(connection) {\n  return is(connection, 'bpmn:SequenceFlow');\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  createCategoryValue\n} from './util/CategoryUtil';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * BPMN specific Group behavior\n */\nexport default function GroupBehavior(\n    bpmnFactory,\n    canvas,\n    elementRegistry,\n    eventBus,\n    injector,\n    moddleCopy\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  /**\n   * Gets process definitions\n   *\n   * @return {ModdleElement} definitions\n   */\n  function getDefinitions() {\n    var rootElement = canvas.getRootElement(),\n        businessObject = getBusinessObject(rootElement);\n\n    return businessObject.$parent;\n  }\n\n  /**\n   * Removes a referenced category value for a given group shape\n   *\n   * @param {djs.model.Shape} shape\n   */\n  function removeReferencedCategoryValue(shape) {\n\n    var businessObject = getBusinessObject(shape),\n        categoryValue = businessObject.categoryValueRef;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    var category = categoryValue.$parent;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    collectionRemove(category.categoryValue, categoryValue);\n\n    // cleanup category if it is empty\n    if (category && !category.categoryValue.length) {\n      removeCategory(category);\n    }\n  }\n\n  /**\n   * Removes a given category from the definitions\n   *\n   * @param {ModdleElement} category\n   */\n  function removeCategory(category) {\n\n    var definitions = getDefinitions();\n\n    collectionRemove(definitions.get('rootElements'), category);\n  }\n\n  /**\n   * Returns all group element in the current registry\n   *\n   * @return {Array<djs.model.shape>} a list of group shapes\n   */\n  function getGroupElements() {\n    return elementRegistry.filter(function(e) {\n      return is(e, 'bpmn:Group');\n    });\n  }\n\n  /**\n   * Returns true if given categoryValue is referenced in one of the given elements\n   *\n   * @param {Array<djs.model.shape>} elements\n   * @param {ModdleElement} categoryValue\n   * @return {Boolean}\n   */\n  function isReferenced(elements, categoryValue) {\n    return elements.some(function(e) {\n\n      var businessObject = getBusinessObject(e);\n\n      return businessObject.categoryValueRef\n        && businessObject.categoryValueRef === categoryValue;\n    });\n  }\n\n  /**\n   * remove referenced category + value when group was deleted\n   */\n  this.executed('shape.delete', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n\n      var businessObject = getBusinessObject(shape),\n          categoryValueRef = businessObject.categoryValueRef,\n          groupElements = getGroupElements();\n\n      if (!isReferenced(groupElements, categoryValueRef)) {\n        removeReferencedCategoryValue(shape);\n      }\n    }\n  });\n\n  /**\n   * re-attach removed category\n   */\n  this.reverted('shape.delete', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n\n      var businessObject = getBusinessObject(shape),\n          categoryValueRef = businessObject.categoryValueRef,\n          definitions = getDefinitions(),\n          category = categoryValueRef ? categoryValueRef.$parent : null;\n\n      collectionAdd(category.get('categoryValue'), categoryValueRef);\n      collectionAdd(definitions.get('rootElements'), category);\n    }\n  });\n\n  /**\n   * create new category + value when group was created\n   */\n  this.execute('shape.create', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        businessObject = getBusinessObject(shape);\n\n    if (is(businessObject, 'bpmn:Group') && !businessObject.categoryValueRef) {\n\n      var definitions = getDefinitions(),\n          categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n      // link the reference to the Group\n      businessObject.categoryValueRef = categoryValue;\n    }\n  });\n\n\n  this.revert('shape.create', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n      removeReferencedCategoryValue(shape);\n\n      delete getBusinessObject(shape).categoryValueRef;\n\n    }\n  });\n\n  // copy bpmn:CategoryValue when copying element\n  eventBus.on('moddleCopy.canCopyProperty', HIGH_PRIORITY, function(context) {\n    var property = context.property,\n        categoryValue;\n\n    if (is(property, 'bpmn:CategoryValue')) {\n      categoryValue = createCategoryValue(getDefinitions(), bpmnFactory);\n\n      // return copy of category\n      return moddleCopy.copyElement(property, categoryValue);\n    }\n  });\n\n}\n\nGroupBehavior.$inject = [\n  'bpmnFactory',\n  'canvas',\n  'elementRegistry',\n  'eventBus',\n  'injector',\n  'moddleCopy'\n];\n\ninherits(GroupBehavior, CommandInterceptor);","/**\n * Returns the intersection between two line segments a and b.\n *\n * @param {Point} l1s\n * @param {Point} l1e\n * @param {Point} l2s\n * @param {Point} l2e\n *\n * @return {Point}\n */\nexport default function lineIntersect(l1s, l1e, l2s, l2e) {\n\n  // if the lines intersect, the result contains the x and y of the\n  // intersection (treating the lines as infinite) and booleans for\n  // whether line segment 1 or line segment 2 contain the point\n  var denominator, a, b, c, numerator;\n\n  denominator = ((l2e.y - l2s.y) * (l1e.x - l1s.x)) - ((l2e.x - l2s.x) * (l1e.y - l1s.y));\n\n  if (denominator == 0) {\n    return null;\n  }\n\n  a = l1s.y - l2s.y;\n  b = l1s.x - l2s.x;\n  numerator = ((l2e.x - l2s.x) * a) - ((l2e.y - l2s.y) * b);\n\n  c = numerator / denominator;\n\n  // if we cast these lines infinitely in\n  // both directions, they intersect here\n  return {\n    x: Math.round(l1s.x + (c * (l1e.x - l1s.x))),\n    y: Math.round(l1s.y + (c * (l1e.y - l1s.y)))\n  };\n}","import {\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport lineIntersect from './util/LineIntersect';\n\n\n/**\n * Fix broken dockings after DI imports.\n *\n * @param {EventBus} eventBus\n */\nexport default function ImportDockingFix(eventBus) {\n\n  function adjustDocking(startPoint, nextPoint, elementMid) {\n\n    var elementTop = {\n      x: elementMid.x,\n      y: elementMid.y - 50\n    };\n\n    var elementLeft = {\n      x: elementMid.x - 50,\n      y: elementMid.y\n    };\n\n    var verticalIntersect = lineIntersect(startPoint, nextPoint, elementMid, elementTop),\n        horizontalIntersect = lineIntersect(startPoint, nextPoint, elementMid, elementLeft);\n\n    // original is horizontal or vertical center cross intersection\n    var centerIntersect;\n\n    if (verticalIntersect && horizontalIntersect) {\n      if (getDistance(verticalIntersect, elementMid) > getDistance(horizontalIntersect, elementMid)) {\n        centerIntersect = horizontalIntersect;\n      } else {\n        centerIntersect = verticalIntersect;\n      }\n    } else {\n      centerIntersect = verticalIntersect || horizontalIntersect;\n    }\n\n    startPoint.original = centerIntersect;\n  }\n\n  function fixDockings(connection) {\n    var waypoints = connection.waypoints;\n\n    adjustDocking(\n      waypoints[0],\n      waypoints[1],\n      getMid(connection.source)\n    );\n\n    adjustDocking(\n      waypoints[waypoints.length - 1],\n      waypoints[waypoints.length - 2],\n      getMid(connection.target)\n    );\n  }\n\n  eventBus.on('bpmnElement.added', function(e) {\n\n    var element = e.element;\n\n    if (element.waypoints) {\n      fixDockings(element);\n    }\n  });\n}\n\nImportDockingFix.$inject = [\n  'eventBus'\n];\n\n\n// helpers //////////////////////\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isAny\n} from '../util/ModelingUtil';\n\n/**\n * A component that makes sure that each created or updated\n * Pool and Lane is assigned an isHorizontal property set to true.\n *\n * @param {EventBus} eventBus\n */\nexport default function IsHorizontalFix(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var elementTypesToUpdate = [\n    'bpmn:Participant',\n    'bpmn:Lane'\n  ];\n\n  this.executed([ 'shape.move', 'shape.create', 'shape.resize' ], function(event) {\n    var bo = getBusinessObject(event.context.shape);\n\n    if (isAny(bo, elementTypesToUpdate) && !bo.di.get('isHorizontal')) {\n\n      // set attribute directly to avoid modeling#updateProperty side effects\n      bo.di.set('isHorizontal', true);\n    }\n  });\n\n}\n\nIsHorizontalFix.$inject = [ 'eventBus' ];\n\ninherits(IsHorizontalFix, CommandInterceptor);\n","/**\n * Returns the length of a vector\n *\n * @param {Vector}\n * @return {Float}\n */\nexport function vectorLength(v) {\n  return Math.sqrt(Math.pow(v.x, 2) + Math.pow(v.y, 2));\n}\n\n\n/**\n * Calculates the angle between a line a the yAxis\n *\n * @param {Array}\n * @return {Float}\n */\nexport function getAngle(line) {\n\n  // return value is between 0, 180 and -180, -0\n  // @janstuemmel: maybe replace return a/b with b/a\n  return Math.atan((line[1].y - line[0].y) / (line[1].x - line[0].x));\n}\n\n\n/**\n * Rotates a vector by a given angle\n *\n * @param {Vector}\n * @param {Float} Angle in radians\n * @return {Vector}\n */\nexport function rotateVector(vector, angle) {\n  return (!angle) ? vector : {\n    x: Math.cos(angle) * vector.x - Math.sin(angle) * vector.y,\n    y: Math.sin(angle) * vector.x + Math.cos(angle) * vector.y\n  };\n}\n\n\n/**\n * Solves a 2D equation system\n * a + r*b = c, where a,b,c are 2D vectors\n *\n * @param {Vector}\n * @param {Vector}\n * @param {Vector}\n * @return {Float}\n */\nfunction solveLambaSystem(a, b, c) {\n\n  // the 2d system\n  var system = [\n    { n: a[0] - c[0], lambda: b[0] },\n    { n: a[1] - c[1], lambda: b[1] }\n  ];\n\n  // solve\n  var n = system[0].n * b[0] + system[1].n * b[1],\n      l = system[0].lambda * b[0] + system[1].lambda * b[1];\n\n  return -n/l;\n}\n\n\n/**\n * Position of perpendicular foot\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Point} the perpendicular foot position\n */\nexport function perpendicularFoot(point, line) {\n\n  var a = line[0], b = line[1];\n\n  // relative position of b from a\n  var bd = { x: b.x - a.x, y: b.y - a.y };\n\n  // solve equation system to the parametrized vectors param real value\n  var r = solveLambaSystem([ a.x, a.y ], [ bd.x, bd.y ], [ point.x, point.y ]);\n\n  return { x: a.x + r*bd.x, y: a.y + r*bd.y };\n}\n\n\n/**\n * Calculates the distance between a point and a line\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Float} distance\n */\nexport function getDistancePointLine(point, line) {\n\n  var pfPoint = perpendicularFoot(point, line);\n\n  // distance vector\n  var connectionVector = {\n    x: pfPoint.x - point.x,\n    y: pfPoint.y - point.y\n  };\n\n  return vectorLength(connectionVector);\n}\n\n\n/**\n * Calculates the distance between two points\n *\n * @param {Point}\n * @param {Point}\n * @return {Float} distance\n */\nexport function getDistancePointPoint(point1, point2) {\n\n  return vectorLength({\n    x: point1.x - point2.x,\n    y: point1.y - point2.y\n  });\n}","var sqrt = Math.sqrt,\n    min = Math.min,\n    max = Math.max,\n    abs = Math.abs;\n\n/**\n * Calculate the square (power to two) of a number.\n *\n * @param {Number} n\n *\n * @return {Number}\n */\nfunction sq(n) {\n  return Math.pow(n, 2);\n}\n\n/**\n * Get distance between two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Number}\n */\nfunction getDistance(p1, p2) {\n  return sqrt(sq(p1.x - p2.x) + sq(p1.y - p2.y));\n}\n\n/**\n * Return the attachment of the given point on the specified line.\n *\n * The attachment is either a bendpoint (attached to the given point)\n * or segment (attached to a location on a line segment) attachment:\n *\n * ```javascript\n * var pointAttachment = {\n *   type: 'bendpoint',\n *   bendpointIndex: 3,\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n *\n * var segmentAttachment = {\n *   type: 'segment',\n *   segmentIndex: 2,\n *   relativeLocation: 0.31, // attach point location between 0 (at start) and 1 (at end)\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n * ```\n *\n * @param {Point} point\n * @param {Array<Point>} line\n *\n * @return {Object} attachment\n */\nexport function getAttachment(point, line) {\n\n  var idx = 0,\n      segmentStart,\n      segmentEnd,\n      segmentStartDistance,\n      segmentEndDistance,\n      attachmentPosition,\n      minDistance,\n      intersections,\n      attachment,\n      attachmentDistance,\n      closestAttachmentDistance,\n      closestAttachment;\n\n  for (idx = 0; idx < line.length - 1; idx++) {\n\n    segmentStart = line[idx];\n    segmentEnd = line[idx + 1];\n\n    if (pointsEqual(segmentStart, segmentEnd)) {\n      intersections = [ segmentStart ];\n    } else {\n      segmentStartDistance = getDistance(point, segmentStart);\n      segmentEndDistance = getDistance(point, segmentEnd);\n\n      minDistance = min(segmentStartDistance, segmentEndDistance);\n\n      intersections = getCircleSegmentIntersections(segmentStart, segmentEnd, point, minDistance);\n    }\n\n    if (intersections.length < 1) {\n      throw new Error('expected between [1, 2] circle -> line intersections');\n    }\n\n    // one intersection -> bendpoint attachment\n    if (intersections.length === 1) {\n      attachment = {\n        type: 'bendpoint',\n        position: intersections[0],\n        segmentIndex: idx,\n        bendpointIndex: pointsEqual(segmentStart, intersections[0]) ? idx : idx + 1\n      };\n    }\n\n    // two intersections -> segment attachment\n    if (intersections.length === 2) {\n\n      attachmentPosition = mid(intersections[0], intersections[1]);\n\n      attachment = {\n        type: 'segment',\n        position: attachmentPosition,\n        segmentIndex: idx,\n        relativeLocation: getDistance(segmentStart, attachmentPosition) / getDistance(segmentStart, segmentEnd)\n      };\n    }\n\n    attachmentDistance = getDistance(attachment.position, point);\n\n    if (!closestAttachment || closestAttachmentDistance > attachmentDistance) {\n      closestAttachment = attachment;\n      closestAttachmentDistance = attachmentDistance;\n    }\n  }\n\n  return closestAttachment;\n}\n\n/**\n * Gets the intersection between a circle and a line segment.\n *\n * @param {Point} s1 segment start\n * @param {Point} s2 segment end\n * @param {Point} cc circle center\n * @param {Number} cr circle radius\n *\n * @return {Array<Point>} intersections\n */\nfunction getCircleSegmentIntersections(s1, s2, cc, cr) {\n\n  var baX = s2.x - s1.x;\n  var baY = s2.y - s1.y;\n  var caX = cc.x - s1.x;\n  var caY = cc.y - s1.y;\n\n  var a = baX * baX + baY * baY;\n  var bBy2 = baX * caX + baY * caY;\n  var c = caX * caX + caY * caY - cr * cr;\n\n  var pBy2 = bBy2 / a;\n  var q = c / a;\n\n  var disc = pBy2 * pBy2 - q;\n\n  // check against negative value to work around\n  // negative, very close to zero results (-4e-15)\n  // being produced in some environments\n  if (disc < 0 && disc > -0.000001) {\n    disc = 0;\n  }\n\n  if (disc < 0) {\n    return [];\n  }\n\n  // if disc == 0 ... dealt with later\n  var tmpSqrt = sqrt(disc);\n  var abScalingFactor1 = -pBy2 + tmpSqrt;\n  var abScalingFactor2 = -pBy2 - tmpSqrt;\n\n  var i1 = {\n    x: s1.x - baX * abScalingFactor1,\n    y: s1.y - baY * abScalingFactor1\n  };\n\n  if (disc === 0) { // abScalingFactor1 == abScalingFactor2\n    return [ i1 ];\n  }\n\n  var i2 = {\n    x: s1.x - baX * abScalingFactor2,\n    y: s1.y - baY * abScalingFactor2\n  };\n\n  // return only points on line segment\n  return [ i1, i2 ].filter(function(p) {\n    return isPointInSegment(p, s1, s2);\n  });\n}\n\n\nfunction isPointInSegment(p, segmentStart, segmentEnd) {\n  return (\n    fenced(p.x, segmentStart.x, segmentEnd.x) &&\n    fenced(p.y, segmentStart.y, segmentEnd.y)\n  );\n}\n\nfunction fenced(n, rangeStart, rangeEnd) {\n\n  // use matching threshold to work around\n  // precision errors in intersection computation\n\n  return (\n    n >= min(rangeStart, rangeEnd) - EQUAL_THRESHOLD &&\n    n <= max(rangeStart, rangeEnd) + EQUAL_THRESHOLD\n  );\n}\n\n/**\n * Calculate mid of two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Point}\n */\nfunction mid(p1, p2) {\n\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2\n  };\n}\n\nvar EQUAL_THRESHOLD = 0.1;\n\nfunction pointsEqual(p1, p2) {\n\n  return (\n    abs(p1.x - p2.x) <= EQUAL_THRESHOLD &&\n    abs(p1.y - p2.y) <= EQUAL_THRESHOLD\n  );\n}\n","import {\n  getDistancePointPoint,\n  rotateVector,\n  getAngle\n} from './GeometricUtil';\n\nimport {\n  getAttachment\n} from './LineAttachmentUtil';\n\nimport {\n  roundPoint\n} from 'diagram-js/lib/layout/LayoutUtil';\n\n\nexport function findNewLabelLineStartIndex(oldWaypoints, newWaypoints, attachment, hints) {\n\n  var index = attachment.segmentIndex;\n\n  var offset = newWaypoints.length - oldWaypoints.length;\n\n  // segmentMove happened\n  if (hints.segmentMove) {\n\n    var oldSegmentStartIndex = hints.segmentMove.segmentStartIndex,\n        newSegmentStartIndex = hints.segmentMove.newSegmentStartIndex;\n\n    // if label was on moved segment return new segment index\n    if (index === oldSegmentStartIndex) {\n      return newSegmentStartIndex;\n    }\n\n    // label is after new segment index\n    if (index >= newSegmentStartIndex) {\n      return (index+offset < newSegmentStartIndex) ? newSegmentStartIndex : index+offset;\n    }\n\n    // if label is before new segment index\n    return index;\n  }\n\n  // bendpointMove happened\n  if (hints.bendpointMove) {\n\n    var insert = hints.bendpointMove.insert,\n        bendpointIndex = hints.bendpointMove.bendpointIndex,\n        newIndex;\n\n    // waypoints length didnt change\n    if (offset === 0) {\n      return index;\n    }\n\n    // label behind new/removed bendpoint\n    if (index >= bendpointIndex) {\n      newIndex = insert ? index + 1 : index - 1;\n    }\n\n    // label before new/removed bendpoint\n    if (index < bendpointIndex) {\n\n      newIndex = index;\n\n      // decide label should take right or left segment\n      if (insert && attachment.type !== 'bendpoint' && bendpointIndex-1 === index) {\n\n        var rel = relativePositionMidWaypoint(newWaypoints, bendpointIndex);\n\n        if (rel < attachment.relativeLocation) {\n          newIndex++;\n        }\n      }\n    }\n\n    return newIndex;\n  }\n\n  // start/end changed\n  if (offset === 0) {\n    return index;\n  }\n\n  if (hints.connectionStart) {\n    return (index === 0) ? 0 : null;\n  }\n\n  if (hints.connectionEnd) {\n    return (index === oldWaypoints.length - 2) ? newWaypoints.length - 2 : null;\n  }\n\n  // if nothing fits, return null\n  return null;\n}\n\n\n/**\n * Calculate the required adjustment (move delta) for the given label\n * after the connection waypoints got updated.\n *\n * @param {djs.model.Label} label\n * @param {Array<Point>} newWaypoints\n * @param {Array<Point>} oldWaypoints\n * @param {Object} hints\n *\n * @return {Point} delta\n */\nexport function getLabelAdjustment(label, newWaypoints, oldWaypoints, hints) {\n\n  var x = 0,\n      y = 0;\n\n  var labelPosition = getLabelMid(label);\n\n  // get closest attachment\n  var attachment = getAttachment(labelPosition, oldWaypoints),\n      oldLabelLineIndex = attachment.segmentIndex,\n      newLabelLineIndex = findNewLabelLineStartIndex(oldWaypoints, newWaypoints, attachment, hints);\n\n  if (newLabelLineIndex === null) {\n    return { x: x, y: y };\n  }\n\n  // should never happen\n  // TODO(@janstuemmel): throw an error here when connectionSegmentMove is refactored\n  if (newLabelLineIndex < 0 ||\n      newLabelLineIndex > newWaypoints.length - 2) {\n    return { x: x, y: y };\n  }\n\n  var oldLabelLine = getLine(oldWaypoints, oldLabelLineIndex),\n      newLabelLine = getLine(newWaypoints, newLabelLineIndex),\n      oldFoot = attachment.position;\n\n  var relativeFootPosition = getRelativeFootPosition(oldLabelLine, oldFoot),\n      angleDelta = getAngleDelta(oldLabelLine, newLabelLine);\n\n  // special rule if label on bendpoint\n  if (attachment.type === 'bendpoint') {\n\n    var offset = newWaypoints.length - oldWaypoints.length,\n        oldBendpointIndex = attachment.bendpointIndex,\n        oldBendpoint = oldWaypoints[oldBendpointIndex];\n\n    // bendpoint position hasn't changed, return same position\n    if (newWaypoints.indexOf(oldBendpoint) !== -1) {\n      return { x: x, y: y };\n    }\n\n    // new bendpoint and old bendpoint have same index, then just return the offset\n    if (offset === 0) {\n      var newBendpoint = newWaypoints[oldBendpointIndex];\n\n      return {\n        x: newBendpoint.x - attachment.position.x,\n        y: newBendpoint.y - attachment.position.y\n      };\n    }\n\n    // if bendpoints get removed\n    if (offset < 0 && oldBendpointIndex !== 0 && oldBendpointIndex < oldWaypoints.length - 1) {\n      relativeFootPosition = relativePositionMidWaypoint(oldWaypoints, oldBendpointIndex);\n    }\n  }\n\n  var newFoot = {\n    x: (newLabelLine[1].x - newLabelLine[0].x) * relativeFootPosition + newLabelLine[0].x,\n    y: (newLabelLine[1].y - newLabelLine[0].y) * relativeFootPosition + newLabelLine[0].y\n  };\n\n  // the rotated vector to label\n  var newLabelVector = rotateVector({\n    x: labelPosition.x - oldFoot.x,\n    y: labelPosition.y - oldFoot.y\n  }, angleDelta);\n\n  // the new relative position\n  x = newFoot.x + newLabelVector.x - labelPosition.x;\n  y = newFoot.y + newLabelVector.y - labelPosition.y;\n\n  return roundPoint({\n    x: x,\n    y: y\n  });\n}\n\n\n// HELPERS //////////////////////\n\nfunction relativePositionMidWaypoint(waypoints, idx) {\n\n  var distanceSegment1 = getDistancePointPoint(waypoints[idx-1], waypoints[idx]),\n      distanceSegment2 = getDistancePointPoint(waypoints[idx], waypoints[idx+1]);\n\n  var relativePosition = distanceSegment1 / (distanceSegment1 + distanceSegment2);\n\n  return relativePosition;\n}\n\nfunction getLabelMid(label) {\n  return {\n    x: label.x + label.width / 2,\n    y: label.y + label.height / 2\n  };\n}\n\nfunction getAngleDelta(l1, l2) {\n  var a1 = getAngle(l1),\n      a2 = getAngle(l2);\n  return a2 - a1;\n}\n\nfunction getLine(waypoints, idx) {\n  return [ waypoints[idx], waypoints[idx+1] ];\n}\n\nfunction getRelativeFootPosition(line, foot) {\n\n  var length = getDistancePointPoint(line[0], line[1]),\n      lengthToFoot = getDistancePointPoint(line[0], foot);\n\n  return length === 0 ? 0 : lengthToFoot / length;\n}\n","import {\n  roundPoint\n} from '../layout/LayoutUtil';\n\nimport {\n  center,\n  delta\n} from './PositionUtil';\n\n\n/**\n * Calculates the absolute point relative to the new element's position\n *\n * @param {point} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {point} point [absolute]\n */\nexport function getNewAttachPoint(point, oldBounds, newBounds) {\n  var oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      oldDelta = delta(point, oldCenter);\n\n  var newDelta = {\n    x: oldDelta.x * (newBounds.width / oldBounds.width),\n    y: oldDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  return roundPoint({\n    x: newCenter.x + newDelta.x,\n    y: newCenter.y + newDelta.y\n  });\n}\n\n\n/**\n * Calculates the shape's delta relative to a new position\n * of a certain element's bounds\n *\n * @param {djs.model.Shape} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {delta} delta\n */\nexport function getNewAttachShapeDelta(shape, oldBounds, newBounds) {\n  var shapeCenter = center(shape),\n      oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      shapeDelta = delta(shape, shapeCenter),\n      oldCenterDelta = delta(shapeCenter, oldCenter);\n\n  var newCenterDelta = {\n    x: oldCenterDelta.x * (newBounds.width / oldBounds.width),\n    y: oldCenterDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  var newShapeCenter = {\n    x: newCenter.x + newCenterDelta.x,\n    y: newCenter.y + newCenterDelta.y\n  };\n\n  return roundPoint({\n    x: newShapeCenter.x + shapeDelta.x - shape.x,\n    y: newShapeCenter.y + shapeDelta.y - shape.y\n  });\n}","import {\n  assign\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isLabelExternal,\n  getExternalLabelMid,\n  hasExternalLabel,\n  isLabel\n} from '../../../util/LabelUtil';\n\nimport {\n  getLabel\n} from '../../label-editing/LabelUtil';\n\nimport {\n  getLabelAdjustment\n} from './util/LabelLayoutUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getNewAttachPoint\n} from 'diagram-js/lib/util/AttachUtil';\n\nimport {\n  getMid,\n  roundPoint\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  delta\n} from 'diagram-js/lib/util/PositionUtil';\n\nimport {\n  sortBy\n} from 'min-dash';\n\nimport {\n  getDistancePointLine,\n  perpendicularFoot\n} from './util/GeometricUtil';\n\nvar DEFAULT_LABEL_DIMENSIONS = {\n  width: 90,\n  height: 20\n};\n\nvar NAME_PROPERTY = 'name';\nvar TEXT_PROPERTY = 'text';\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {BpmnFactory} bpmnFactory\n * @param {TextRenderer} textRenderer\n */\nexport default function LabelBehavior(\n    eventBus, modeling, bpmnFactory,\n    textRenderer) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // update label if name property was updated\n  this.postExecute('element.updateProperties', function(e) {\n    var context = e.context,\n        element = context.element,\n        properties = context.properties;\n\n    if (NAME_PROPERTY in properties) {\n      modeling.updateLabel(element, properties[NAME_PROPERTY]);\n    }\n\n    if (TEXT_PROPERTY in properties\n        && is(element, 'bpmn:TextAnnotation')) {\n\n      var newBounds = textRenderer.getTextAnnotationBounds(\n        {\n          x: element.x,\n          y: element.y,\n          width: element.width,\n          height: element.height\n        },\n        properties[TEXT_PROPERTY] || ''\n      );\n\n      modeling.updateLabel(element, properties.text, newBounds);\n    }\n  });\n\n  // create label shape after shape/connection was created\n  this.postExecute([ 'shape.create', 'connection.create' ], function(e) {\n    var context = e.context,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior === false) {\n      return;\n    }\n\n    var element = context.shape || context.connection,\n        businessObject = element.businessObject;\n\n    if (isLabel(element) || !isLabelExternal(element)) {\n      return;\n    }\n\n    // only create label if attribute available\n    if (!getLabel(element)) {\n      return;\n    }\n\n    var labelCenter = getExternalLabelMid(element);\n\n    // we don't care about x and y\n    var labelDimensions = textRenderer.getExternalLabelBounds(\n      DEFAULT_LABEL_DIMENSIONS,\n      getLabel(element)\n    );\n\n    modeling.createLabel(element, labelCenter, {\n      id: businessObject.id + '_label',\n      businessObject: businessObject,\n      width: labelDimensions.width,\n      height: labelDimensions.height\n    });\n  });\n\n  // update label after label shape was deleted\n  this.postExecute('shape.delete', function(event) {\n    var context = event.context,\n        labelTarget = context.labelTarget,\n        hints = context.hints || {};\n\n    // check if label\n    if (labelTarget && hints.unsetLabel !== false) {\n      modeling.updateLabel(labelTarget, null, null, { removeShape: false });\n    }\n  });\n\n  // update di information on label creation\n  this.postExecute([ 'label.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        businessObject,\n        di;\n\n    // we want to trigger on real labels only\n    if (!element.labelTarget) {\n      return;\n    }\n\n    // we want to trigger on BPMN elements only\n    if (!is(element.labelTarget || element, 'bpmn:BaseElement')) {\n      return;\n    }\n\n    businessObject = element.businessObject,\n    di = businessObject.di;\n\n\n    if (!di.label) {\n      di.label = bpmnFactory.create('bpmndi:BPMNLabel', {\n        bounds: bpmnFactory.create('dc:Bounds')\n      });\n    }\n\n    assign(di.label.bounds, {\n      x: element.x,\n      y: element.y,\n      width: element.width,\n      height: element.height\n    });\n  });\n\n  function getVisibleLabelAdjustment(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        label = connection.label,\n        hints = assign({}, context.hints),\n        newWaypoints = context.newWaypoints || connection.waypoints,\n        oldWaypoints = context.oldWaypoints;\n\n\n    if (typeof hints.startChanged === 'undefined') {\n      hints.startChanged = !!hints.connectionStart;\n    }\n\n    if (typeof hints.endChanged === 'undefined') {\n      hints.endChanged = !!hints.connectionEnd;\n    }\n\n    return getLabelAdjustment(label, newWaypoints, oldWaypoints, hints);\n  }\n\n  this.postExecute([\n    'connection.layout',\n    'connection.updateWaypoints'\n  ], function(event) {\n    var context = event.context,\n        hints = context.hints || {};\n\n    if (hints.labelBehavior === false) {\n      return;\n    }\n\n    var connection = context.connection,\n        label = connection.label,\n        labelAdjustment;\n\n    // handle missing label as well as the case\n    // that the label parent does not exist (yet),\n    // because it is being pasted / created via multi element create\n    //\n    // Cf. https://github.com/bpmn-io/bpmn-js/pull/1227\n    if (!label || !label.parent) {\n      return;\n    }\n\n    labelAdjustment = getVisibleLabelAdjustment(event);\n\n    modeling.moveShape(label, labelAdjustment);\n  });\n\n\n  // keep label position on shape replace\n  this.postExecute([ 'shape.replace' ], function(event) {\n    var context = event.context,\n        newShape = context.newShape,\n        oldShape = context.oldShape;\n\n    var businessObject = getBusinessObject(newShape);\n\n    if (businessObject\n      && isLabelExternal(businessObject)\n      && oldShape.label\n      && newShape.label) {\n      newShape.label.x = oldShape.label.x;\n      newShape.label.y = oldShape.label.y;\n    }\n  });\n\n\n  // move external label after resizing\n  this.postExecute('shape.resize', function(event) {\n\n    var context = event.context,\n        shape = context.shape,\n        newBounds = context.newBounds,\n        oldBounds = context.oldBounds;\n\n    if (hasExternalLabel(shape)) {\n\n      var label = shape.label,\n          labelMid = getMid(label),\n          edges = asEdges(oldBounds);\n\n      // get nearest border point to label as reference point\n      var referencePoint = getReferencePoint(labelMid, edges);\n\n      var delta = getReferencePointDelta(referencePoint, oldBounds, newBounds);\n\n      modeling.moveShape(label, delta);\n\n    }\n\n  });\n\n}\n\ninherits(LabelBehavior, CommandInterceptor);\n\nLabelBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'bpmnFactory',\n  'textRenderer'\n];\n\n// helpers //////////////////////\n\n/**\n * Calculates a reference point delta relative to a new position\n * of a certain element's bounds\n *\n * @param {Point} point\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @return {Delta} delta\n */\nexport function getReferencePointDelta(referencePoint, oldBounds, newBounds) {\n\n  var newReferencePoint = getNewAttachPoint(referencePoint, oldBounds, newBounds);\n\n  return roundPoint(delta(newReferencePoint, referencePoint));\n}\n\n/**\n * Generates the nearest point (reference point) for a given point\n * onto given set of lines\n *\n * @param {Array<Point, Point>} lines\n * @param {Point} point\n *\n * @param {Point}\n */\nexport function getReferencePoint(point, lines) {\n\n  if (!lines.length) {\n    return;\n  }\n\n  var nearestLine = getNearestLine(point, lines);\n\n  return perpendicularFoot(point, nearestLine);\n}\n\n/**\n * Convert the given bounds to a lines array containing all edges\n *\n * @param {Bounds|Point} bounds\n *\n * @return Array<Point>\n */\nexport function asEdges(bounds) {\n  return [\n    [ // top\n      {\n        x: bounds.x,\n        y: bounds.y\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y\n      }\n    ],\n    [ // right\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0)\n      }\n    ],\n    [ // bottom\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0)\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0)\n      }\n    ],\n    [ // left\n      {\n        x: bounds.x,\n        y: bounds.y\n      },\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0)\n      }\n    ]\n  ];\n}\n\n/**\n * Returns the nearest line for a given point by distance\n * @param {Point} point\n * @param Array<Point> lines\n *\n * @return Array<Point>\n */\nfunction getNearestLine(point, lines) {\n\n  var distances = lines.map(function(l) {\n    return {\n      line: l,\n      distance: getDistancePointLine(point, l)\n    };\n  });\n\n  var sorted = sortBy(distances, 'distance');\n\n  return sorted[0].line;\n}\n","import { is } from '../../../util/ModelUtil';\n\nvar COLLAB_ERR_MSG = 'flow elements must be children of pools/participants',\n    PROCESS_ERR_MSG = 'participants cannot be pasted onto a non-empty process diagram';\n\n\nexport default function ModelingFeedback(eventBus, tooltips, translate) {\n\n  function showError(position, message, timeout) {\n    tooltips.add({\n      position: {\n        x: position.x + 5,\n        y: position.y + 5\n      },\n      type: 'error',\n      timeout: timeout || 2000,\n      html: '<div>' + message + '</div>'\n    });\n  }\n\n  eventBus.on([ 'shape.move.rejected', 'create.rejected' ], function(event) {\n    var context = event.context,\n        shape = context.shape,\n        target = context.target;\n\n    if (is(target, 'bpmn:Collaboration') && is(shape, 'bpmn:FlowNode')) {\n      showError(event, translate(COLLAB_ERR_MSG));\n    }\n  });\n\n  eventBus.on([ 'elements.paste.rejected' ], function(event) {\n    var context = event.context,\n        position = context.position,\n        target = context.target;\n\n    if (is(target, 'bpmn:Collaboration')) {\n      showError(position, translate(COLLAB_ERR_MSG));\n    }\n\n    if (is(target, 'bpmn:Process')) {\n      showError(position, translate(PROCESS_ERR_MSG), 3000);\n    }\n  });\n}\n\nModelingFeedback.$inject = [\n  'eventBus',\n  'tooltips',\n  'translate'\n];\n","import {\n  forEach,\n  find,\n  matchPattern\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\nexport default function ReplaceConnectionBehavior(eventBus, modeling, bpmnRules, injector) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var dragging = injector.get('dragging', false);\n\n  function fixConnection(connection) {\n\n    var source = connection.source,\n        target = connection.target,\n        parent = connection.parent;\n\n    // do not do anything if connection\n    // is already deleted (may happen due to other\n    // behaviors plugged-in before)\n    if (!parent) {\n      return;\n    }\n\n    var replacementType,\n        remove;\n\n    /**\n     * Check if incoming or outgoing connections\n     * can stay or could be substituted with an\n     * appropriate replacement.\n     *\n     * This holds true for SequenceFlow <> MessageFlow.\n     */\n\n    if (is(connection, 'bpmn:SequenceFlow')) {\n      if (!bpmnRules.canConnectSequenceFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectMessageFlow(source, target)) {\n        replacementType = 'bpmn:MessageFlow';\n      }\n    }\n\n    // transform message flows into sequence flows, if possible\n\n    if (is(connection, 'bpmn:MessageFlow')) {\n\n      if (!bpmnRules.canConnectMessageFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectSequenceFlow(source, target)) {\n        replacementType = 'bpmn:SequenceFlow';\n      }\n    }\n\n    if (is(connection, 'bpmn:Association') && !bpmnRules.canConnectAssociation(source, target)) {\n      remove = true;\n    }\n\n\n    // remove invalid connection,\n    // unless it has been removed already\n    if (remove) {\n      modeling.removeConnection(connection);\n    }\n\n    // replace SequenceFlow <> MessageFlow\n\n    if (replacementType) {\n      modeling.connect(source, target, {\n        type: replacementType,\n        waypoints: connection.waypoints.slice()\n      });\n    }\n  }\n\n  function replaceReconnectedConnection(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        source = context.newSource || connection.source,\n        target = context.newTarget || connection.target,\n        allowed,\n        replacement;\n\n    allowed = bpmnRules.canConnect(source, target);\n\n    if (!allowed || allowed.type === connection.type) {\n      return;\n    }\n\n    replacement = modeling.connect(source, target, {\n      type: allowed.type,\n      waypoints: connection.waypoints.slice()\n    });\n\n    // remove old connection\n    modeling.removeConnection(connection);\n\n    // replace connection in context to reconnect end/start\n    context.connection = replacement;\n\n    if (dragging) {\n      cleanDraggingSelection(connection, replacement);\n    }\n  }\n\n  // monkey-patch selection saved in dragging in order to re-select it when operation is finished\n  function cleanDraggingSelection(oldConnection, newConnection) {\n    var context = dragging.context(),\n        previousSelection = context && context.payload.previousSelection,\n        index;\n\n    // do nothing if not dragging or no selection was present\n    if (!previousSelection || !previousSelection.length) {\n      return;\n    }\n\n    index = previousSelection.indexOf(oldConnection);\n\n    if (index === -1) {\n      return;\n    }\n\n    previousSelection.splice(index, 1, newConnection);\n  }\n\n  // lifecycle hooks\n\n  this.postExecuted('elements.move', function(context) {\n\n    var closure = context.closure,\n        allConnections = closure.allConnections;\n\n    forEach(allConnections, fixConnection);\n  }, true);\n\n  this.preExecute('connection.reconnect', replaceReconnectedConnection);\n\n  this.postExecuted('element.updateProperties', function(event) {\n    var context = event.context,\n        properties = context.properties,\n        element = context.element,\n        businessObject = element.businessObject,\n        connection;\n\n    // remove condition on change to default\n    if (properties.default) {\n      connection = find(\n        element.outgoing,\n        matchPattern({ id: element.businessObject.default.id })\n      );\n\n      if (connection) {\n        modeling.updateProperties(connection, { conditionExpression: undefined });\n      }\n    }\n\n    // remove default from source on change to conditional\n    if (properties.conditionExpression && businessObject.sourceRef.default === businessObject) {\n      modeling.updateProperties(element.source, { default: undefined });\n    }\n  });\n}\n\ninherits(ReplaceConnectionBehavior, CommandInterceptor);\n\nReplaceConnectionBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'bpmnRules',\n  'injector'\n];\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * BPMN specific remove behavior\n */\nexport default function RemoveParticipantBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  /**\n   * morph collaboration diagram into process diagram\n   * after the last participant has been removed\n   */\n\n  this.preExecute('shape.delete', function(context) {\n\n    var shape = context.shape,\n        parent = shape.parent;\n\n    // activate the behavior if the shape to be removed\n    // is a participant\n    if (is(shape, 'bpmn:Participant')) {\n      context.collaborationRoot = parent;\n    }\n  }, true);\n\n  this.postExecute('shape.delete', function(context) {\n\n    var collaborationRoot = context.collaborationRoot;\n\n    if (collaborationRoot && !collaborationRoot.businessObject.participants.length) {\n\n      // replace empty collaboration with process diagram\n      modeling.makeProcess();\n    }\n  }, true);\n\n}\n\nRemoveParticipantBehavior.$inject = [ 'eventBus', 'modeling' ];\n\ninherits(RemoveParticipantBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport { forEach } from 'min-dash';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { isEventSubProcess } from '../../../util/DiUtil';\n\n\n/**\n * BPMN-specific replace behavior.\n */\nexport default function ReplaceElementBehaviour(\n    bpmnReplace,\n    bpmnRules,\n    elementRegistry,\n    injector,\n    modeling,\n    selection\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n  this._elementRegistry = elementRegistry;\n  this._selection = selection;\n\n  // replace elements on move\n  this.postExecuted([ 'elements.move' ], 500, function(event) {\n    var context = event.context,\n        target = context.newParent,\n        newHost = context.newHost,\n        elements = [];\n\n    forEach(context.closure.topLevel, function(topLevelElements) {\n      if (isEventSubProcess(topLevelElements)) {\n        elements = elements.concat(topLevelElements.children);\n      } else {\n        elements = elements.concat(topLevelElements);\n      }\n    });\n\n    // set target to host if attaching\n    if (elements.length === 1 && newHost) {\n      target = newHost;\n    }\n\n    var canReplace = bpmnRules.canReplace(elements, target);\n\n    if (canReplace) {\n      this.replaceElements(elements, canReplace.replacements, newHost);\n    }\n  }, this);\n\n  // update attachments on host replace\n  this.postExecute([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape,\n        attachers = oldShape.attachers,\n        canReplace;\n\n    if (attachers && attachers.length) {\n      canReplace = bpmnRules.canReplace(attachers, newShape);\n\n      this.replaceElements(attachers, canReplace.replacements);\n    }\n\n  }, this);\n\n  // keep ID on shape replace\n  this.postExecuted([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    modeling.unclaimId(oldShape.businessObject.id, oldShape.businessObject);\n    modeling.updateProperties(newShape, { id: oldShape.id });\n  });\n}\n\ninherits(ReplaceElementBehaviour, CommandInterceptor);\n\nReplaceElementBehaviour.prototype.replaceElements = function(elements, newElements) {\n  var elementRegistry = this._elementRegistry,\n      bpmnReplace = this._bpmnReplace,\n      selection = this._selection;\n\n  forEach(newElements, function(replacement) {\n    var newElement = {\n      type: replacement.newElementType\n    };\n\n    var oldElement = elementRegistry.get(replacement.oldElementId);\n\n    var idx = elements.indexOf(oldElement);\n\n    elements[idx] = bpmnReplace.replaceElement(oldElement, newElement, { select: false });\n  });\n\n  if (newElements) {\n    selection.select(elements);\n  }\n};\n\nReplaceElementBehaviour.$inject = [\n  'bpmnReplace',\n  'bpmnRules',\n  'elementRegistry',\n  'injector',\n  'modeling',\n  'selection'\n];\n","import { is } from '../../../../util/ModelUtil';\r\n\r\nimport {\r\n  asTRBL\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nimport {\r\n  collectLanes,\r\n  getLanesRoot\r\n} from '../../../modeling/util/LaneUtil';\r\n\r\nvar abs = Math.abs,\r\n    min = Math.min,\r\n    max = Math.max;\r\n\r\n\r\nfunction addToTrbl(trbl, attr, value, choice) {\r\n  var current = trbl[attr];\r\n\r\n  // make sure to set the value if it does not exist\r\n  // or apply the correct value by comparing against\r\n  // choice(value, currentValue)\r\n  trbl[attr] = current === undefined ? value : choice(value, current);\r\n}\r\n\r\nfunction addMin(trbl, attr, value) {\r\n  return addToTrbl(trbl, attr, value, min);\r\n}\r\n\r\nfunction addMax(trbl, attr, value) {\r\n  return addToTrbl(trbl, attr, value, max);\r\n}\r\n\r\nvar LANE_MIN_HEIGHT = 60,\r\n    LANE_MIN_WIDTH = 300,\r\n    LANE_RIGHT_PADDING = 20,\r\n    LANE_LEFT_PADDING = 50,\r\n    LANE_TOP_PADDING = 20,\r\n    LANE_BOTTOM_PADDING = 20;\r\n\r\n\r\nexport function getParticipantResizeConstraints(laneShape, resizeDirection, balanced) {\r\n  var lanesRoot = getLanesRoot(laneShape);\r\n\r\n  var isFirst = true,\r\n      isLast = true;\r\n\r\n  // max top/bottom size for lanes\r\n  var allLanes = collectLanes(lanesRoot, [ lanesRoot ]);\r\n\r\n  var laneTrbl = asTRBL(laneShape);\r\n\r\n  var maxTrbl = {},\r\n      minTrbl = {};\r\n\r\n  if (/e/.test(resizeDirection)) {\r\n    minTrbl.right = laneTrbl.left + LANE_MIN_WIDTH;\r\n  } else\r\n  if (/w/.test(resizeDirection)) {\r\n    minTrbl.left = laneTrbl.right - LANE_MIN_WIDTH;\r\n  }\r\n\r\n  allLanes.forEach(function(other) {\r\n\r\n    var otherTrbl = asTRBL(other);\r\n\r\n    if (/n/.test(resizeDirection)) {\r\n\r\n      if (otherTrbl.top < (laneTrbl.top - 10)) {\r\n        isFirst = false;\r\n      }\r\n\r\n      // max top size (based on next element)\r\n      if (balanced && abs(laneTrbl.top - otherTrbl.bottom) < 10) {\r\n        addMax(maxTrbl, 'top', otherTrbl.top + LANE_MIN_HEIGHT);\r\n      }\r\n\r\n      // min top size (based on self or nested element)\r\n      if (abs(laneTrbl.top - otherTrbl.top) < 5) {\r\n        addMin(minTrbl, 'top', otherTrbl.bottom - LANE_MIN_HEIGHT);\r\n      }\r\n    }\r\n\r\n    if (/s/.test(resizeDirection)) {\r\n\r\n      if (otherTrbl.bottom > (laneTrbl.bottom + 10)) {\r\n        isLast = false;\r\n      }\r\n\r\n      // max bottom size (based on previous element)\r\n      if (balanced && abs(laneTrbl.bottom - otherTrbl.top) < 10) {\r\n        addMin(maxTrbl, 'bottom', otherTrbl.bottom - LANE_MIN_HEIGHT);\r\n      }\r\n\r\n      // min bottom size (based on self or nested element)\r\n      if (abs(laneTrbl.bottom - otherTrbl.bottom) < 5) {\r\n        addMax(minTrbl, 'bottom', otherTrbl.top + LANE_MIN_HEIGHT);\r\n      }\r\n    }\r\n  });\r\n\r\n  // max top/bottom/left/right size based on flow nodes\r\n  var flowElements = lanesRoot.children.filter(function(s) {\r\n    return !s.hidden && !s.waypoints && (is(s, 'bpmn:FlowElement') || is(s, 'bpmn:Artifact'));\r\n  });\r\n\r\n  flowElements.forEach(function(flowElement) {\r\n\r\n    var flowElementTrbl = asTRBL(flowElement);\r\n\r\n    if (isFirst && /n/.test(resizeDirection)) {\r\n      addMin(minTrbl, 'top', flowElementTrbl.top - LANE_TOP_PADDING);\r\n    }\r\n\r\n    if (/e/.test(resizeDirection)) {\r\n      addMax(minTrbl, 'right', flowElementTrbl.right + LANE_RIGHT_PADDING);\r\n    }\r\n\r\n    if (isLast && /s/.test(resizeDirection)) {\r\n      addMax(minTrbl, 'bottom', flowElementTrbl.bottom + LANE_BOTTOM_PADDING);\r\n    }\r\n\r\n    if (/w/.test(resizeDirection)) {\r\n      addMin(minTrbl, 'left', flowElementTrbl.left - LANE_LEFT_PADDING);\r\n    }\r\n  });\r\n\r\n  return {\r\n    min: minTrbl,\r\n    max: maxTrbl\r\n  };\r\n}","import { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport { getParticipantResizeConstraints } from './util/ResizeUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\n\r\nexport var PARTICIPANT_MIN_DIMENSIONS = { width: 300, height: 150 };\r\n\r\nexport var SUB_PROCESS_MIN_DIMENSIONS = { width: 140, height: 120 };\r\n\r\nexport var TEXT_ANNOTATION_MIN_DIMENSIONS = { width: 50, height: 30 };\r\n\r\n\r\n/**\r\n * Set minimum bounds/resize constraints on resize.\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nexport default function ResizeBehavior(eventBus) {\r\n  eventBus.on('resize.start', HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        direction = context.direction,\r\n        balanced = context.balanced;\r\n\r\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\r\n      context.resizeConstraints = getParticipantResizeConstraints(shape, direction, balanced);\r\n    }\r\n\r\n    if (is(shape, 'bpmn:Participant')) {\r\n      context.minDimensions = PARTICIPANT_MIN_DIMENSIONS;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n      context.minDimensions = SUB_PROCESS_MIN_DIMENSIONS;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:TextAnnotation')) {\r\n      context.minDimensions = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n    }\r\n  });\r\n}\r\n\r\nResizeBehavior.$inject = [ 'eventBus' ];","import { is } from '../../../util/ModelUtil';\n\nimport {\n  roundBounds\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  hasPrimaryModifier\n} from 'diagram-js/lib/util/Mouse';\n\nvar SLIGHTLY_HIGHER_PRIORITY = 1001;\n\n\n/**\n * Invoke {@link Modeling#resizeLane} instead of\n * {@link Modeling#resizeShape} when resizing a Lane\n * or Participant shape.\n */\nexport default function ResizeLaneBehavior(eventBus, modeling) {\n\n  eventBus.on('resize.start', SLIGHTLY_HIGHER_PRIORITY + 500, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\n\n      // should we resize the opposite lane(s) in\n      // order to compensate for the resize operation?\n      context.balanced = !hasPrimaryModifier(event);\n    }\n  });\n\n  /**\n   * Intercept resize end and call resize lane function instead.\n   */\n  eventBus.on('resize.end', SLIGHTLY_HIGHER_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\n\n      if (canExecute) {\n\n        // ensure we have actual pixel values for new bounds\n        // (important when zoom level was > 1 during move)\n        newBounds = roundBounds(newBounds);\n\n        // perform the actual resize\n        modeling.resizeLane(shape, newBounds, context.balanced);\n      }\n\n      // stop propagation\n      return false;\n    }\n  });\n}\n\nResizeLaneBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport lineIntersect from './util/LineIntersect';\n\n\nexport default function RemoveElementBehavior(eventBus, bpmnRules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Combine sequence flows when deleting an element\n   * if there is one incoming and one outgoing\n   * sequence flow\n   */\n  this.preExecute('shape.delete', function(e) {\n\n    var shape = e.context.shape;\n\n    // only handle [a] -> [shape] -> [b] patterns\n    if (shape.incoming.length !== 1 || shape.outgoing.length !== 1) {\n      return;\n    }\n\n    var inConnection = shape.incoming[0],\n        outConnection = shape.outgoing[0];\n\n    // only handle sequence flows\n    if (!is(inConnection, 'bpmn:SequenceFlow') || !is(outConnection, 'bpmn:SequenceFlow')) {\n      return;\n    }\n\n    if (bpmnRules.canConnect(inConnection.source, outConnection.target, inConnection)) {\n\n      // compute new, combined waypoints\n      var newWaypoints = getNewWaypoints(inConnection.waypoints, outConnection.waypoints);\n\n      modeling.reconnectEnd(inConnection, outConnection.target, newWaypoints);\n    }\n  });\n\n}\n\ninherits(RemoveElementBehavior, CommandInterceptor);\n\nRemoveElementBehavior.$inject = [\n  'eventBus',\n  'bpmnRules',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}\n\n\nfunction getNewWaypoints(inWaypoints, outWaypoints) {\n\n  var intersection = lineIntersect(\n    getDocking(inWaypoints[inWaypoints.length - 2]),\n    getDocking(inWaypoints[inWaypoints.length - 1]),\n    getDocking(outWaypoints[1]),\n    getDocking(outWaypoints[0]));\n\n  if (intersection) {\n    return [].concat(\n      inWaypoints.slice(0, inWaypoints.length - 1),\n      [ intersection ],\n      outWaypoints.slice(1));\n  } else {\n    return [\n      getDocking(inWaypoints[0]),\n      getDocking(outWaypoints[outWaypoints.length - 1])\n    ];\n  }\n}","import { forEach } from 'min-dash';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport {\r\n  PARTICIPANT_MIN_DIMENSIONS,\r\n  SUB_PROCESS_MIN_DIMENSIONS,\r\n  TEXT_ANNOTATION_MIN_DIMENSIONS\r\n} from './ResizeBehavior';\r\n\r\nexport default function SpaceToolBehavior(eventBus) {\r\n  eventBus.on('spaceTool.getMinDimensions', function(context) {\r\n    var shapes = context.shapes,\r\n        minDimensions = {};\r\n\r\n    forEach(shapes, function(shape) {\r\n      var id = shape.id;\r\n\r\n      if (is(shape, 'bpmn:Participant')) {\r\n        minDimensions[ id ] = PARTICIPANT_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n        minDimensions[ id ] = SUB_PROCESS_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n        minDimensions[ id ] = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n      }\r\n    });\r\n\r\n    return minDimensions;\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [ 'eventBus' ];\r\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil.js';\n\n/**\n * Add start event replacing element with expanded sub process.\n *\n * @param {Injector} injector\n * @param {Modeling} modeling\n */\nexport default function SubProcessStartEventBehavior(injector, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.postExecuted('shape.replace', function(event) {\n    var oldShape = event.context.oldShape,\n        newShape = event.context.newShape;\n\n    if (\n      !is(newShape, 'bpmn:SubProcess') ||\n      !is(oldShape, 'bpmn:Task') ||\n      !isExpanded(newShape)\n    ) {\n      return;\n    }\n\n    var position = getStartEventPosition(newShape);\n\n    modeling.createShape({ type: 'bpmn:StartEvent' }, position, newShape);\n  });\n}\n\nSubProcessStartEventBehavior.$inject = [\n  'injector',\n  'modeling'\n];\n\ninherits(SubProcessStartEventBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getStartEventPosition(shape) {\n  return {\n    x: shape.x + shape.width / 6,\n    y: shape.y + shape.height / 2\n  };\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  computeChildrenBBox\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\n\nvar LOW_PRIORITY = 500;\n\n\nexport default function ToggleElementCollapseBehaviour(\n    eventBus, elementFactory, modeling,\n    resize) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function hideEmptyLabels(children) {\n    if (children.length) {\n      children.forEach(function(child) {\n        if (child.type === 'label' && !child.businessObject.name) {\n          child.hidden = true;\n        }\n      });\n    }\n  }\n\n  function expandedBounds(shape, defaultSize) {\n    var children = shape.children,\n        newBounds = defaultSize,\n        visibleElements,\n        visibleBBox;\n\n    visibleElements = filterVisible(children).concat([ shape ]);\n\n    visibleBBox = computeChildrenBBox(visibleElements);\n\n    if (visibleBBox) {\n\n      // center to visibleBBox with max(defaultSize, childrenBounds)\n      newBounds.width = Math.max(visibleBBox.width, newBounds.width);\n      newBounds.height = Math.max(visibleBBox.height, newBounds.height);\n\n      newBounds.x = visibleBBox.x + (visibleBBox.width - newBounds.width) / 2;\n      newBounds.y = visibleBBox.y + (visibleBBox.height - newBounds.height) / 2;\n    } else {\n\n      // center to collapsed shape with defaultSize\n      newBounds.x = shape.x + (shape.width - newBounds.width) / 2;\n      newBounds.y = shape.y + (shape.height - newBounds.height) / 2;\n    }\n\n    return newBounds;\n  }\n\n  function collapsedBounds(shape, defaultSize) {\n\n    return {\n      x: shape.x + (shape.width - defaultSize.width) / 2,\n      y: shape.y + (shape.height - defaultSize.height) / 2,\n      width: defaultSize.width,\n      height: defaultSize.height\n    };\n  }\n\n  this.executed([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shape = context.shape;\n\n    if (!is(shape, 'bpmn:SubProcess')) {\n      return;\n    }\n\n    if (!shape.collapsed) {\n\n      // all children got made visible through djs, hide empty labels\n      hideEmptyLabels(shape.children);\n\n      // remove collapsed marker\n      getBusinessObject(shape).di.isExpanded = true;\n    } else {\n\n      // place collapsed marker\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.reverted([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n\n    var context = e.context;\n    var shape = context.shape;\n\n\n    // revert removing/placing collapsed marker\n    if (!shape.collapsed) {\n      getBusinessObject(shape).di.isExpanded = true;\n\n    } else {\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n    var shape = e.context.shape,\n        defaultSize = elementFactory._getDefaultSize(shape),\n        newBounds;\n\n    if (shape.collapsed) {\n\n      // resize to default size of collapsed shapes\n      newBounds = collapsedBounds(shape, defaultSize);\n    } else {\n\n      // resize to bounds of max(visible children, defaultSize)\n      newBounds = expandedBounds(shape, defaultSize);\n    }\n\n    modeling.resizeShape(shape, newBounds, null, {\n      autoResize: shape.collapsed ? false : 'nwse'\n    });\n  });\n\n}\n\n\ninherits(ToggleElementCollapseBehaviour, CommandInterceptor);\n\nToggleElementCollapseBehaviour.$inject = [\n  'eventBus',\n  'elementFactory',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction filterVisible(elements) {\n  return elements.filter(function(e) {\n    return !e.hidden;\n  });\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil';\nimport { isLabel } from '../../../util/LabelUtil';\n\n\n/**\n * Unclaims model IDs on element deletion.\n *\n * @param {Canvas} canvas\n * @param {Injector} injector\n * @param {Moddle} moddle\n * @param {Modeling} modeling\n */\nexport default function UnclaimIdBehavior(canvas, injector, moddle, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute('shape.delete', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        shapeBo = shape.businessObject;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    if (is(shape, 'bpmn:Participant') && isExpanded(shape)) {\n      moddle.ids.unclaim(shapeBo.processRef.id);\n    }\n\n    modeling.unclaimId(shapeBo.id, shapeBo);\n  });\n\n\n  this.preExecute('connection.delete', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        connectionBo = connection.businessObject;\n\n    modeling.unclaimId(connectionBo.id, connectionBo);\n  });\n\n  this.preExecute('canvas.updateRoot', function() {\n    var rootElement = canvas.getRootElement(),\n        rootElementBo = rootElement.businessObject;\n\n    moddle.ids.unclaim(rootElementBo.id);\n  });\n}\n\ninherits(UnclaimIdBehavior, CommandInterceptor);\n\nUnclaimIdBehavior.$inject = [ 'canvas', 'injector', 'moddle', 'modeling' ];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar LOW_PRIORITY = 500,\n    HIGH_PRIORITY = 5000;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function UpdateFlowNodeRefsBehavior(eventBus, modeling, translate) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Ok, this is it:\n   *\n   * We have to update the Lane#flowNodeRefs _and_\n   * FlowNode#lanes with every FlowNode move/resize and\n   * Lane move/resize.\n   *\n   * We want to group that stuff to recompute containments\n   * as efficient as possible.\n   *\n   * Yea!\n   */\n\n  // the update context\n  var context;\n\n\n  function initContext() {\n    context = context || new UpdateContext();\n    context.enter();\n\n    return context;\n  }\n\n  function getContext() {\n    if (!context) {\n      throw new Error(translate('out of bounds release'));\n    }\n\n    return context;\n  }\n\n  function releaseContext() {\n\n    if (!context) {\n      throw new Error(translate('out of bounds release'));\n    }\n\n    var triggerUpdate = context.leave();\n\n    if (triggerUpdate) {\n      modeling.updateLaneRefs(context.flowNodes, context.lanes);\n\n      context = null;\n    }\n\n    return triggerUpdate;\n  }\n\n\n  var laneRefUpdateEvents = [\n    'spaceTool',\n    'lane.add',\n    'lane.resize',\n    'lane.split',\n    'elements.create',\n    'elements.delete',\n    'elements.move',\n    'shape.create',\n    'shape.delete',\n    'shape.move',\n    'shape.resize'\n  ];\n\n\n  // listen to a lot of stuff to group lane updates\n\n  this.preExecute(laneRefUpdateEvents, HIGH_PRIORITY, function(event) {\n    initContext();\n  });\n\n  this.postExecuted(laneRefUpdateEvents, LOW_PRIORITY, function(event) {\n    releaseContext();\n  });\n\n\n  // Mark flow nodes + lanes that need an update\n\n  this.preExecute([\n    'shape.create',\n    'shape.move',\n    'shape.delete',\n    'shape.resize'\n  ], function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    var updateContext = getContext();\n\n    // no need to update labels\n    if (shape.labelTarget) {\n      return;\n    }\n\n    if (is(shape, 'bpmn:Lane')) {\n      updateContext.addLane(shape);\n    }\n\n    if (is(shape, 'bpmn:FlowNode')) {\n      updateContext.addFlowNode(shape);\n    }\n  });\n}\n\nUpdateFlowNodeRefsBehavior.$inject = [\n  'eventBus',\n  'modeling' ,\n  'translate'\n];\n\ninherits(UpdateFlowNodeRefsBehavior, CommandInterceptor);\n\n\nfunction UpdateContext() {\n\n  this.flowNodes = [];\n  this.lanes = [];\n\n  this.counter = 0;\n\n  this.addLane = function(lane) {\n    this.lanes.push(lane);\n  };\n\n  this.addFlowNode = function(flowNode) {\n    this.flowNodes.push(flowNode);\n  };\n\n  this.enter = function() {\n    this.counter++;\n  };\n\n  this.leave = function() {\n    this.counter--;\n\n    return !this.counter;\n  };\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\n\n/**\n * A behavior that unsets the Default property of\n * sequence flow source on element delete, if the\n * removed element is the Gateway or Task's default flow.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function DeleteSequenceFlowBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  this.preExecute('connection.delete', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source;\n\n    if (isDefaultFlow(connection, source)) {\n      modeling.updateProperties(source, {\n        'default': null\n      });\n    }\n  });\n}\n\ninherits(DeleteSequenceFlowBehavior, CommandInterceptor);\n\nDeleteSequenceFlowBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction isDefaultFlow(connection, source) {\n\n  if (!is(connection, 'bpmn:SequenceFlow')) {\n    return false;\n  }\n\n  var sourceBo = getBusinessObject(source),\n      sequenceFlow = getBusinessObject(connection);\n\n  return sourceBo.get('default') === sequenceFlow;\n}","import AdaptiveLabelPositioningBehavior from './AdaptiveLabelPositioningBehavior';\nimport AppendBehavior from './AppendBehavior';\nimport AssociationBehavior from './AssociationBehavior';\nimport AttachEventBehavior from './AttachEventBehavior';\nimport BoundaryEventBehavior from './BoundaryEventBehavior';\nimport RootElementReferenceBehavior from './RootElementReferenceBehavior';\nimport CreateBehavior from './CreateBehavior';\nimport FixHoverBehavior from './FixHoverBehavior';\nimport CreateDataObjectBehavior from './CreateDataObjectBehavior';\nimport CreateParticipantBehavior from './CreateParticipantBehavior';\nimport DataInputAssociationBehavior from './DataInputAssociationBehavior';\nimport DataStoreBehavior from './DataStoreBehavior';\nimport DeleteLaneBehavior from './DeleteLaneBehavior';\nimport DetachEventBehavior from './DetachEventBehavior';\nimport DropOnFlowBehavior from './DropOnFlowBehavior';\nimport EventBasedGatewayBehavior from './EventBasedGatewayBehavior';\nimport GroupBehavior from './GroupBehavior';\nimport ImportDockingFix from './ImportDockingFix';\nimport IsHorizontalFix from './IsHorizontalFix';\nimport LabelBehavior from './LabelBehavior';\nimport ModelingFeedback from './ModelingFeedback';\nimport ReplaceConnectionBehavior from './ReplaceConnectionBehavior';\nimport RemoveParticipantBehavior from './RemoveParticipantBehavior';\nimport ReplaceElementBehaviour from './ReplaceElementBehaviour';\nimport ResizeBehavior from './ResizeBehavior';\nimport ResizeLaneBehavior from './ResizeLaneBehavior';\nimport RemoveElementBehavior from './RemoveElementBehavior';\nimport SpaceToolBehavior from './SpaceToolBehavior';\nimport SubProcessStartEventBehavior from './SubProcessStartEventBehavior';\nimport ToggleElementCollapseBehaviour from './ToggleElementCollapseBehaviour';\nimport UnclaimIdBehavior from './UnclaimIdBehavior';\nimport UpdateFlowNodeRefsBehavior from './UpdateFlowNodeRefsBehavior';\nimport UnsetDefaultFlowBehavior from './UnsetDefaultFlowBehavior';\n\nexport default {\n  __init__: [\n    'adaptiveLabelPositioningBehavior',\n    'appendBehavior',\n    'associationBehavior',\n    'attachEventBehavior',\n    'boundaryEventBehavior',\n    'rootElementReferenceBehavior',\n    'createBehavior',\n    'fixHoverBehavior',\n    'createDataObjectBehavior',\n    'createParticipantBehavior',\n    'dataStoreBehavior',\n    'dataInputAssociationBehavior',\n    'deleteLaneBehavior',\n    'detachEventBehavior',\n    'dropOnFlowBehavior',\n    'eventBasedGatewayBehavior',\n    'groupBehavior',\n    'importDockingFix',\n    'isHorizontalFix',\n    'labelBehavior',\n    'modelingFeedback',\n    'removeElementBehavior',\n    'removeParticipantBehavior',\n    'replaceConnectionBehavior',\n    'replaceElementBehaviour',\n    'resizeBehavior',\n    'resizeLaneBehavior',\n    'toggleElementCollapseBehaviour',\n    'spaceToolBehavior',\n    'subProcessStartEventBehavior',\n    'unclaimIdBehavior',\n    'unsetDefaultFlowBehavior',\n    'updateFlowNodeRefsBehavior'\n  ],\n  adaptiveLabelPositioningBehavior: [ 'type', AdaptiveLabelPositioningBehavior ],\n  appendBehavior: [ 'type', AppendBehavior ],\n  associationBehavior: [ 'type', AssociationBehavior ],\n  attachEventBehavior: [ 'type', AttachEventBehavior ],\n  boundaryEventBehavior: [ 'type', BoundaryEventBehavior ],\n  rootElementReferenceBehavior: [ 'type', RootElementReferenceBehavior ],\n  createBehavior: [ 'type', CreateBehavior ],\n  fixHoverBehavior: [ 'type', FixHoverBehavior ],\n  createDataObjectBehavior: [ 'type', CreateDataObjectBehavior ],\n  createParticipantBehavior: [ 'type', CreateParticipantBehavior ],\n  dataInputAssociationBehavior: [ 'type', DataInputAssociationBehavior ],\n  dataStoreBehavior: [ 'type', DataStoreBehavior ],\n  deleteLaneBehavior: [ 'type', DeleteLaneBehavior ],\n  detachEventBehavior: [ 'type', DetachEventBehavior ],\n  dropOnFlowBehavior: [ 'type', DropOnFlowBehavior ],\n  eventBasedGatewayBehavior: [ 'type', EventBasedGatewayBehavior ],\n  groupBehavior: [ 'type', GroupBehavior ],\n  importDockingFix: [ 'type', ImportDockingFix ],\n  isHorizontalFix: [ 'type', IsHorizontalFix ],\n  labelBehavior: [ 'type', LabelBehavior ],\n  modelingFeedback: [ 'type', ModelingFeedback ],\n  replaceConnectionBehavior: [ 'type', ReplaceConnectionBehavior ],\n  removeParticipantBehavior: [ 'type', RemoveParticipantBehavior ],\n  replaceElementBehaviour: [ 'type', ReplaceElementBehaviour ],\n  resizeBehavior: [ 'type', ResizeBehavior ],\n  resizeLaneBehavior: [ 'type', ResizeLaneBehavior ],\n  removeElementBehavior: [ 'type', RemoveElementBehavior ],\n  toggleElementCollapseBehaviour : [ 'type', ToggleElementCollapseBehaviour ],\n  spaceToolBehavior: [ 'type', SpaceToolBehavior ],\n  subProcessStartEventBehavior: [ 'type', SubProcessStartEventBehavior ],\n  unclaimIdBehavior: [ 'type', UnclaimIdBehavior ],\n  updateFlowNodeRefsBehavior: [ 'type', UpdateFlowNodeRefsBehavior ],\n  unsetDefaultFlowBehavior: [ 'type', UnsetDefaultFlowBehavior ]\n};\n","import { getOrientation } from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nexport function getBoundaryAttachment(position, targetBounds) {\r\n\r\n  var orientation = getOrientation(position, targetBounds, -15);\r\n\r\n  if (orientation !== 'intersect') {\r\n    return orientation;\r\n  } else {\r\n    return null;\r\n  }\r\n}","import {\n  every,\n  find,\n  forEach,\n  some\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../util/ModelUtil';\n\nimport {\n  getParent,\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  isLabel\n} from '../../util/LabelUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess,\n  isInterrupting,\n  hasErrorEventDefinition,\n  hasEscalationEventDefinition,\n  hasCompensateEventDefinition\n} from '../../util/DiUtil';\n\nimport RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\n\nimport {\n  getBoundaryAttachment as isBoundaryAttachment\n} from '../snapping/BpmnSnappingUtil';\n\n\n/**\n * BPMN specific modeling rule\n */\nexport default function BpmnRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(BpmnRules, RuleProvider);\n\nBpmnRules.$inject = [ 'eventBus' ];\n\nBpmnRules.prototype.init = function() {\n\n  this.addRule('connection.start', function(context) {\n    var source = context.source;\n\n    return canStartConnection(source);\n  });\n\n  this.addRule('connection.create', function(context) {\n    var source = context.source,\n        target = context.target,\n        hints = context.hints || {},\n        targetParent = hints.targetParent,\n        targetAttach = hints.targetAttach;\n\n    // don't allow incoming connections on\n    // newly created boundary events\n    // to boundary events\n    if (targetAttach) {\n      return false;\n    }\n\n    // temporarily set target parent for scoping\n    // checks to work\n    if (targetParent) {\n      target.parent = targetParent;\n    }\n\n    try {\n      return canConnect(source, target);\n    } finally {\n\n      // unset temporary target parent\n      if (targetParent) {\n        target.parent = null;\n      }\n    }\n  });\n\n  this.addRule('connection.reconnect', function(context) {\n\n    var connection = context.connection,\n        source = context.source,\n        target = context.target;\n\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule('connection.updateWaypoints', function(context) {\n    return {\n      type: context.connection.type\n    };\n  });\n\n  this.addRule('shape.resize', function(context) {\n\n    var shape = context.shape,\n        newBounds = context.newBounds;\n\n    return canResize(shape, newBounds);\n  });\n\n  this.addRule('elements.create', function(context) {\n    var elements = context.elements,\n        position = context.position,\n        target = context.target;\n\n    return every(elements, function(element) {\n      if (isConnection(element)) {\n        return canConnect(element.source, element.target, element);\n      }\n\n      if (element.host) {\n        return canAttach(element, element.host, null, position);\n      }\n\n      return canCreate(element, target, null, position);\n    });\n  });\n\n  this.addRule('elements.move', function(context) {\n\n    var target = context.target,\n        shapes = context.shapes,\n        position = context.position;\n\n    return canAttach(shapes, target, null, position) ||\n           canReplace(shapes, target, position) ||\n           canMove(shapes, target, position) ||\n           canInsert(shapes, target, position);\n  });\n\n  this.addRule('shape.create', function(context) {\n    return canCreate(\n      context.shape,\n      context.target,\n      context.source,\n      context.position\n    );\n  });\n\n  this.addRule('shape.attach', function(context) {\n\n    return canAttach(\n      context.shape,\n      context.target,\n      null,\n      context.position\n    );\n  });\n\n  this.addRule('element.copy', function(context) {\n    var element = context.element,\n        elements = context.elements;\n\n    return canCopy(elements, element);\n  });\n};\n\nBpmnRules.prototype.canConnectMessageFlow = canConnectMessageFlow;\n\nBpmnRules.prototype.canConnectSequenceFlow = canConnectSequenceFlow;\n\nBpmnRules.prototype.canConnectDataAssociation = canConnectDataAssociation;\n\nBpmnRules.prototype.canConnectAssociation = canConnectAssociation;\n\nBpmnRules.prototype.canMove = canMove;\n\nBpmnRules.prototype.canAttach = canAttach;\n\nBpmnRules.prototype.canReplace = canReplace;\n\nBpmnRules.prototype.canDrop = canDrop;\n\nBpmnRules.prototype.canInsert = canInsert;\n\nBpmnRules.prototype.canCreate = canCreate;\n\nBpmnRules.prototype.canConnect = canConnect;\n\nBpmnRules.prototype.canResize = canResize;\n\nBpmnRules.prototype.canCopy = canCopy;\n\n/**\n * Utility functions for rule checking\n */\n\n/**\n * Checks if given element can be used for starting connection.\n *\n * @param  {Element} source\n * @return {Boolean}\n */\nfunction canStartConnection(element) {\n  if (nonExistingOrLabel(element)) {\n    return null;\n  }\n\n  return isAny(element, [\n    'bpmn:FlowNode',\n    'bpmn:InteractionNode',\n    'bpmn:DataObjectReference',\n    'bpmn:DataStoreReference'\n  ]);\n}\n\nfunction nonExistingOrLabel(element) {\n  return !element || isLabel(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction getOrganizationalParent(element) {\n\n  do {\n    if (is(element, 'bpmn:Process')) {\n      return getBusinessObject(element);\n    }\n\n    if (is(element, 'bpmn:Participant')) {\n      return (\n        getBusinessObject(element).processRef ||\n        getBusinessObject(element)\n      );\n    }\n  } while ((element = element.parent));\n\n}\n\nfunction isTextAnnotation(element) {\n  return is(element, 'bpmn:TextAnnotation');\n}\n\nfunction isGroup(element) {\n  return is(element, 'bpmn:Group') && !element.labelTarget;\n}\n\nfunction isCompensationBoundary(element) {\n  return is(element, 'bpmn:BoundaryEvent') &&\n         hasEventDefinition(element, 'bpmn:CompensateEventDefinition');\n}\n\nfunction isForCompensation(e) {\n  return getBusinessObject(e).isForCompensation;\n}\n\nfunction isSameOrganization(a, b) {\n  var parentA = getOrganizationalParent(a),\n      parentB = getOrganizationalParent(b);\n\n  return parentA === parentB;\n}\n\nfunction isMessageFlowSource(element) {\n  return (\n    is(element, 'bpmn:InteractionNode') && (\n      !is(element, 'bpmn:Event') || (\n        is(element, 'bpmn:ThrowEvent') &&\n        hasEventDefinitionOrNone(element, 'bpmn:MessageEventDefinition')\n      )\n    )\n  );\n}\n\nfunction isMessageFlowTarget(element) {\n  return (\n    is(element, 'bpmn:InteractionNode') &&\n    !isForCompensation(element) && (\n      !is(element, 'bpmn:Event') || (\n        is(element, 'bpmn:CatchEvent') &&\n        hasEventDefinitionOrNone(element, 'bpmn:MessageEventDefinition')\n      )\n    )\n  );\n}\n\nfunction getScopeParent(element) {\n\n  var parent = element;\n\n  while ((parent = parent.parent)) {\n\n    if (is(parent, 'bpmn:FlowElementsContainer')) {\n      return getBusinessObject(parent);\n    }\n\n    if (is(parent, 'bpmn:Participant')) {\n      return getBusinessObject(parent).processRef;\n    }\n  }\n\n  return null;\n}\n\nfunction isSameScope(a, b) {\n  var scopeParentA = getScopeParent(a),\n      scopeParentB = getScopeParent(b);\n\n  return scopeParentA === scopeParentB;\n}\n\nfunction hasEventDefinition(element, eventDefinition) {\n  var bo = getBusinessObject(element);\n\n  return !!find(bo.eventDefinitions || [], function(definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction hasEventDefinitionOrNone(element, eventDefinition) {\n  var bo = getBusinessObject(element);\n\n  return (bo.eventDefinitions || []).every(function(definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction isSequenceFlowSource(element) {\n  return (\n    is(element, 'bpmn:FlowNode') &&\n    !is(element, 'bpmn:EndEvent') &&\n    !isEventSubProcess(element) &&\n    !(is(element, 'bpmn:IntermediateThrowEvent') &&\n      hasEventDefinition(element, 'bpmn:LinkEventDefinition')\n    ) &&\n    !isCompensationBoundary(element) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isSequenceFlowTarget(element) {\n  return (\n    is(element, 'bpmn:FlowNode') &&\n    !is(element, 'bpmn:StartEvent') &&\n    !is(element, 'bpmn:BoundaryEvent') &&\n    !isEventSubProcess(element) &&\n    !(is(element, 'bpmn:IntermediateCatchEvent') &&\n      hasEventDefinition(element, 'bpmn:LinkEventDefinition')\n    ) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isEventBasedTarget(element) {\n  return (\n    is(element, 'bpmn:ReceiveTask') || (\n      is(element, 'bpmn:IntermediateCatchEvent') && (\n        hasEventDefinition(element, 'bpmn:MessageEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:TimerEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:ConditionalEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:SignalEventDefinition')\n      )\n    )\n  );\n}\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n\nfunction getParents(element) {\n\n  var parents = [];\n\n  while (element) {\n    element = element.parent;\n\n    if (element) {\n      parents.push(element);\n    }\n  }\n\n  return parents;\n}\n\nfunction isParent(possibleParent, element) {\n  var allParents = getParents(element);\n  return allParents.indexOf(possibleParent) !== -1;\n}\n\nfunction canConnect(source, target, connection) {\n\n  if (nonExistingOrLabel(source) || nonExistingOrLabel(target)) {\n    return null;\n  }\n\n  if (!is(connection, 'bpmn:DataAssociation')) {\n\n    if (canConnectMessageFlow(source, target)) {\n      return { type: 'bpmn:MessageFlow' };\n    }\n\n    if (canConnectSequenceFlow(source, target)) {\n      return { type: 'bpmn:SequenceFlow' };\n    }\n  }\n\n  var connectDataAssociation = canConnectDataAssociation(source, target);\n\n  if (connectDataAssociation) {\n    return connectDataAssociation;\n  }\n\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return {\n      type: 'bpmn:Association',\n      associationDirection: 'One'\n    };\n  }\n\n  if (canConnectAssociation(source, target)) {\n\n    return {\n      type: 'bpmn:Association'\n    };\n  }\n\n  return false;\n}\n\n/**\n * Can an element be dropped into the target element\n *\n * @return {Boolean}\n */\nfunction canDrop(element, target, position) {\n\n  // can move labels and groups everywhere\n  if (isLabel(element) || isGroup(element)) {\n    return true;\n  }\n\n\n  // disallow to create elements on collapsed pools\n  if (is(target, 'bpmn:Participant') && !isExpanded(target)) {\n    return false;\n  }\n\n  // allow to create new participants on\n  // existing collaboration and process diagrams\n  if (is(element, 'bpmn:Participant')) {\n    return is(target, 'bpmn:Process') || is(target, 'bpmn:Collaboration');\n  }\n\n  // allow moving DataInput / DataOutput within its original container only\n  if (isAny(element, [ 'bpmn:DataInput', 'bpmn:DataOutput' ])) {\n\n    if (element.parent) {\n      return target === element.parent;\n    }\n  }\n\n  // allow creating lanes on participants and other lanes only\n  if (is(element, 'bpmn:Lane')) {\n    return is(target, 'bpmn:Participant') || is(target, 'bpmn:Lane');\n  }\n\n  // disallow dropping boundary events which cannot replace with intermediate event\n  if (is(element, 'bpmn:BoundaryEvent') && !isDroppableBoundaryEvent(element)) {\n    return false;\n  }\n\n  // drop flow elements onto flow element containers\n  // and participants\n  if (is(element, 'bpmn:FlowElement') && !is(element, 'bpmn:DataStoreReference')) {\n    if (is(target, 'bpmn:FlowElementsContainer')) {\n      return isExpanded(target);\n    }\n\n    return isAny(target, [ 'bpmn:Participant', 'bpmn:Lane' ]);\n  }\n\n  // account for the fact that data associations are always\n  // rendered and moved to top (Process or Collaboration level)\n  //\n  // artifacts may be placed wherever, too\n  if (isAny(element, [ 'bpmn:Artifact', 'bpmn:DataAssociation', 'bpmn:DataStoreReference' ])) {\n    return isAny(target, [\n      'bpmn:Collaboration',\n      'bpmn:Lane',\n      'bpmn:Participant',\n      'bpmn:Process',\n      'bpmn:SubProcess' ]);\n  }\n\n  if (is(element, 'bpmn:MessageFlow')) {\n    return is(target, 'bpmn:Collaboration')\n      || element.source.parent == target\n      || element.target.parent == target;\n  }\n\n  return false;\n}\n\nfunction isDroppableBoundaryEvent(event) {\n  return getBusinessObject(event).cancelActivity && (\n    hasNoEventDefinition(event) || hasCommonBoundaryIntermediateEventDefinition(event)\n  );\n}\n\nfunction isBoundaryEvent(element) {\n  return !isLabel(element) && is(element, 'bpmn:BoundaryEvent');\n}\n\nfunction isLane(element) {\n  return is(element, 'bpmn:Lane');\n}\n\n/**\n * We treat IntermediateThrowEvents as boundary events during create,\n * this must be reflected in the rules.\n */\nfunction isBoundaryCandidate(element) {\n  if (isBoundaryEvent(element)) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:IntermediateThrowEvent') && hasNoEventDefinition(element)) {\n    return true;\n  }\n\n  return (\n    is(element, 'bpmn:IntermediateCatchEvent') &&\n    hasCommonBoundaryIntermediateEventDefinition(element)\n  );\n}\n\nfunction hasNoEventDefinition(element) {\n  var bo = getBusinessObject(element);\n\n  return bo && !(bo.eventDefinitions && bo.eventDefinitions.length);\n}\n\nfunction hasCommonBoundaryIntermediateEventDefinition(element) {\n  return hasOneOfEventDefinitions(element, [\n    'bpmn:MessageEventDefinition',\n    'bpmn:TimerEventDefinition',\n    'bpmn:SignalEventDefinition',\n    'bpmn:ConditionalEventDefinition'\n  ]);\n}\n\nfunction hasOneOfEventDefinitions(element, eventDefinitions) {\n  return eventDefinitions.some(function(definition) {\n    return hasEventDefinition(element, definition);\n  });\n}\n\nfunction isReceiveTaskAfterEventBasedGateway(element) {\n  return (\n    is(element, 'bpmn:ReceiveTask') &&\n    find(element.incoming, function(incoming) {\n      return is(incoming.source, 'bpmn:EventBasedGateway');\n    })\n  );\n}\n\n\nfunction canAttach(elements, target, source, position) {\n\n  if (!Array.isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  // only (re-)attach one element at a time\n  if (elements.length !== 1) {\n    return false;\n  }\n\n  var element = elements[0];\n\n  // do not attach labels\n  if (isLabel(element)) {\n    return false;\n  }\n\n  // only handle boundary events\n  if (!isBoundaryCandidate(element)) {\n    return false;\n  }\n\n  // disallow drop on event sub processes\n  if (isEventSubProcess(target)) {\n    return false;\n  }\n\n  // only allow drop on non compensation activities\n  if (!is(target, 'bpmn:Activity') || isForCompensation(target)) {\n    return false;\n  }\n\n  // only attach to subprocess border\n  if (position && !isBoundaryAttachment(position, target)) {\n    return false;\n  }\n\n  // do not attach on receive tasks after event based gateways\n  if (isReceiveTaskAfterEventBasedGateway(target)) {\n    return false;\n  }\n\n  return 'attach';\n}\n\n\n/**\n * Defines how to replace elements for a given target.\n *\n * Returns an array containing all elements which will be replaced.\n *\n * @example\n *\n *  [{ id: 'IntermediateEvent_2',\n *     type: 'bpmn:StartEvent'\n *   },\n *   { id: 'IntermediateEvent_5',\n *     type: 'bpmn:EndEvent'\n *   }]\n *\n * @param  {Array} elements\n * @param  {Object} target\n *\n * @return {Object} an object containing all elements which have to be replaced\n */\nfunction canReplace(elements, target, position) {\n\n  if (!target) {\n    return false;\n  }\n\n  var canExecute = {\n    replacements: []\n  };\n\n  forEach(elements, function(element) {\n\n    if (!isEventSubProcess(target)) {\n\n      if (is(element, 'bpmn:StartEvent') &&\n          element.type !== 'label' &&\n          canDrop(element, target)) {\n\n        // replace a non-interrupting start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (!isInterrupting(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:StartEvent'\n          });\n        }\n\n        // replace an error/escalation/compensate start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (hasErrorEventDefinition(element) ||\n            hasEscalationEventDefinition(element) ||\n            hasCompensateEventDefinition(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:StartEvent'\n          });\n        }\n      }\n    }\n\n    if (!is(target, 'bpmn:Transaction')) {\n      if (hasEventDefinition(element, 'bpmn:CancelEventDefinition') &&\n          element.type !== 'label') {\n\n        if (is(element, 'bpmn:EndEvent') && canDrop(element, target)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:EndEvent'\n          });\n        }\n\n        if (is(element, 'bpmn:BoundaryEvent') && canAttach(element, target, null, position)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:BoundaryEvent'\n          });\n        }\n      }\n    }\n  });\n\n  return canExecute.replacements.length ? canExecute : false;\n}\n\nfunction canMove(elements, target) {\n\n  // do not move selection containing lanes\n  if (some(elements, isLane)) {\n    return false;\n  }\n\n  // allow default move check to start move operation\n  if (!target) {\n    return true;\n  }\n\n  return elements.every(function(element) {\n    return canDrop(element, target);\n  });\n}\n\nfunction canCreate(shape, target, source, position) {\n\n  if (!target) {\n    return false;\n  }\n\n  if (isLabel(shape) || isGroup(shape)) {\n    return true;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  // ensure we do not drop the element\n  // into source\n  if (source && isParent(source, target)) {\n    return false;\n  }\n\n  return canDrop(shape, target, position) || canInsert(shape, target, position);\n}\n\nfunction canResize(shape, newBounds) {\n  if (is(shape, 'bpmn:SubProcess')) {\n    return (\n      isExpanded(shape) && (\n        !newBounds || (newBounds.width >= 100 && newBounds.height >= 80)\n      )\n    );\n  }\n\n  if (is(shape, 'bpmn:Lane')) {\n    return !newBounds || (newBounds.width >= 130 && newBounds.height >= 60);\n  }\n\n  if (is(shape, 'bpmn:Participant')) {\n    return !newBounds || (newBounds.width >= 250 && newBounds.height >= 50);\n  }\n\n  if (isTextAnnotation(shape)) {\n    return true;\n  }\n\n  if (isGroup(shape)) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Check, whether one side of the relationship\n * is a text annotation.\n */\nfunction isOneTextAnnotation(source, target) {\n\n  var sourceTextAnnotation = isTextAnnotation(source),\n      targetTextAnnotation = isTextAnnotation(target);\n\n  return (\n    (sourceTextAnnotation || targetTextAnnotation) &&\n    (sourceTextAnnotation !== targetTextAnnotation)\n  );\n}\n\n\nfunction canConnectAssociation(source, target) {\n\n  // do not connect connections\n  if (isConnection(source) || isConnection(target)) {\n    return false;\n  }\n\n  // compensation boundary events are exception\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return true;\n  }\n\n  // don't connect parent <-> child\n  if (isParent(target, source) || isParent(source, target)) {\n    return false;\n  }\n\n  // allow connection of associations between <!TextAnnotation> and <TextAnnotation>\n  if (isOneTextAnnotation(source, target)) {\n    return true;\n  }\n\n  // can connect associations where we can connect\n  // data associations, too (!)\n  return !!canConnectDataAssociation(source, target);\n}\n\nfunction canConnectMessageFlow(source, target) {\n\n  // during connect user might move mouse out of canvas\n  // https://github.com/bpmn-io/bpmn-js/issues/1033\n  if (getRootElement(source) && !getRootElement(target)) {\n    return false;\n  }\n\n  return (\n    isMessageFlowSource(source) &&\n    isMessageFlowTarget(target) &&\n    !isSameOrganization(source, target)\n  );\n}\n\nfunction canConnectSequenceFlow(source, target) {\n\n  if (\n    isEventBasedTarget(target) &&\n    target.incoming.length > 0 &&\n    areOutgoingEventBasedGatewayConnections(target.incoming) &&\n    !is(source, 'bpmn:EventBasedGateway')\n  ) {\n    return false;\n  }\n\n  return isSequenceFlowSource(source) &&\n         isSequenceFlowTarget(target) &&\n         isSameScope(source, target) &&\n         !(is(source, 'bpmn:EventBasedGateway') && !isEventBasedTarget(target));\n}\n\n\nfunction canConnectDataAssociation(source, target) {\n\n  if (isAny(source, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ]) &&\n      isAny(target, [ 'bpmn:Activity', 'bpmn:ThrowEvent' ])) {\n    return { type: 'bpmn:DataInputAssociation' };\n  }\n\n  if (isAny(target, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ]) &&\n      isAny(source, [ 'bpmn:Activity', 'bpmn:CatchEvent' ])) {\n    return { type: 'bpmn:DataOutputAssociation' };\n  }\n\n  return false;\n}\n\nfunction canInsert(shape, flow, position) {\n\n  if (!flow) {\n    return false;\n  }\n\n  if (Array.isArray(shape)) {\n    if (shape.length !== 1) {\n      return false;\n    }\n\n    shape = shape[0];\n  }\n\n  if (flow.source === shape ||\n      flow.target === shape) {\n    return false;\n  }\n\n  // return true if we can drop on the\n  // underlying flow parent\n  //\n  // at this point we are not really able to talk\n  // about connection rules (yet)\n\n  return (\n    isAny(flow, [ 'bpmn:SequenceFlow', 'bpmn:MessageFlow' ]) &&\n    !isLabel(flow) &&\n    is(shape, 'bpmn:FlowNode') &&\n    !is(shape, 'bpmn:BoundaryEvent') &&\n    canDrop(shape, flow.parent, position));\n}\n\nfunction includes(elements, element) {\n  return (elements && element) && elements.indexOf(element) !== -1;\n}\n\nfunction canCopy(elements, element) {\n  if (isLabel(element)) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:Lane') && !includes(elements, element.parent)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction isOutgoingEventBasedGatewayConnection(connection) {\n\n  if (connection && connection.source) {\n    return is(connection.source, 'bpmn:EventBasedGateway');\n  }\n}\n\nfunction areOutgoingEventBasedGatewayConnections(connections) {\n  connections = connections || [];\n\n  return connections.some(isOutgoingEventBasedGatewayConnection);\n}\n\nfunction getRootElement(element) {\n  return getParent(element, 'bpmn:Process') || getParent(element, 'bpmn:Collaboration');\n}\n","import RulesModule from 'diagram-js/lib/features/rules';\n\nimport BpmnRules from './BpmnRules';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'bpmnRules' ],\n  bpmnRules: [ 'type', BpmnRules ]\n};\n","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An abstract provider that allows modelers to implement a custom\n * ordering of diagram elements on the canvas.\n *\n * It makes sure that the order is always preserved during element\n * creation and move operations.\n *\n * In order to use this behavior, inherit from it and override\n * the method {@link OrderingProvider#getOrdering}.\n *\n * @example\n *\n * ```javascript\n * function CustomOrderingProvider(eventBus) {\n *   OrderingProvider.call(this, eventBus);\n *\n *   this.getOrdering = function(element, newParent) {\n *     // always insert elements at the front\n *     // when moving\n *     return {\n *       index: 0,\n *       parent: newParent\n *     };\n *   };\n * }\n * ```\n *\n * @param {EventBus} eventBus\n */\nexport default function OrderingProvider(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  var self = this;\n\n  this.preExecute([ 'shape.create', 'connection.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.parent = ordering.parent;\n      }\n\n      context.parentIndex = ordering.index;\n    }\n  });\n\n  this.preExecute([ 'shape.move', 'connection.move' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.newParent || element.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.newParent = ordering.parent;\n      }\n\n      context.newParentIndex = ordering.index;\n    }\n  });\n}\n\n/**\n * Return a custom ordering of the element, both in terms\n * of parent element and index in the new parent.\n *\n * Implementors of this method must return an object with\n * `parent` _and_ `index` in it.\n *\n * @param {djs.model.Base} element\n * @param {djs.model.Shape} newParent\n *\n * @return {Object} ordering descriptor\n */\nOrderingProvider.prototype.getOrdering = function(element, newParent) {\n  return null;\n};\n\ninherits(OrderingProvider, CommandInterceptor);","import inherits from 'inherits';\n\nimport OrderingProvider from 'diagram-js/lib/features/ordering/OrderingProvider';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  findIndex,\n  find\n} from 'min-dash';\n\n\n/**\n * a simple ordering provider that makes sure:\n *\n * (0) labels and groups are rendered always on top\n * (1) elements are ordered by a {level} property\n */\nexport default function BpmnOrderingProvider(eventBus, canvas, translate) {\n\n  OrderingProvider.call(this, eventBus);\n\n  var orders = [\n    { type: 'bpmn:SubProcess', order: { level: 6 } },\n    {\n      type: 'bpmn:SequenceFlow',\n      order: {\n        level: 3,\n        containers: [\n          'bpmn:Participant',\n          'bpmn:FlowElementsContainer'\n        ]\n      }\n    },\n\n    // handle DataAssociation(s) like message flows and render them always on top\n    {\n      type: 'bpmn:DataAssociation',\n      order: {\n        level: 9,\n        containers: [\n          'bpmn:Collaboration',\n          'bpmn:Process'\n        ]\n      }\n    },\n    {\n      type: 'bpmn:MessageFlow', order: {\n        level: 9,\n        containers: [ 'bpmn:Collaboration' ]\n      }\n    },\n    {\n      type: 'bpmn:Association',\n      order: {\n        level: 6,\n        containers: [\n          'bpmn:Participant',\n          'bpmn:FlowElementsContainer',\n          'bpmn:Collaboration'\n        ]\n      }\n    },\n    { type: 'bpmn:BoundaryEvent', order: { level: 8 } },\n    {\n      type: 'bpmn:Group',\n      order: {\n        level: 10,\n        containers: [\n          'bpmn:Collaboration',\n          'bpmn:Process'\n        ]\n      }\n    },\n    { type: 'bpmn:FlowElement', order: { level: 5 } },\n    { type: 'bpmn:Participant', order: { level: -2 } },\n    { type: 'bpmn:Lane', order: { level: -1 } }\n  ];\n\n  function computeOrder(element) {\n    if (element.labelTarget) {\n      return { level: 10 };\n    }\n\n    var entry = find(orders, function(o) {\n      return isAny(element, [ o.type ]);\n    });\n\n    return entry && entry.order || { level: 1 };\n  }\n\n  function getOrder(element) {\n\n    var order = element.order;\n\n    if (!order) {\n      element.order = order = computeOrder(element);\n    }\n\n    return order;\n  }\n\n  function findActualParent(element, newParent, containers) {\n\n    var actualParent = newParent;\n\n    while (actualParent) {\n\n      if (isAny(actualParent, containers)) {\n        break;\n      }\n\n      actualParent = actualParent.parent;\n    }\n\n    if (!actualParent) {\n      throw new Error(translate('no parent for {element} in {parent}', {\n        element: element.id,\n        parent: newParent.id\n      }));\n    }\n\n    return actualParent;\n  }\n\n  this.getOrdering = function(element, newParent) {\n\n    // render labels always on top\n    if (element.labelTarget) {\n      return {\n        parent: canvas.getRootElement(),\n        index: -1\n      };\n    }\n\n    var elementOrder = getOrder(element);\n\n\n    if (elementOrder.containers) {\n      newParent = findActualParent(element, newParent, elementOrder.containers);\n    }\n\n\n    var currentIndex = newParent.children.indexOf(element);\n\n    var insertIndex = findIndex(newParent.children, function(child) {\n\n      // do not compare with labels, they are created\n      // in the wrong order (right after elements) during import and\n      // mess up the positioning.\n      if (!element.labelTarget && child.labelTarget) {\n        return false;\n      }\n\n      return elementOrder.level < getOrder(child).level;\n    });\n\n\n    // if the element is already in the child list at\n    // a smaller index, we need to adjust the insert index.\n    // this takes into account that the element is being removed\n    // before being re-inserted\n    if (insertIndex !== -1) {\n      if (currentIndex !== -1 && currentIndex < insertIndex) {\n        insertIndex -= 1;\n      }\n    }\n\n    return {\n      index: insertIndex,\n      parent: newParent\n    };\n  };\n}\n\nBpmnOrderingProvider.$inject = [ 'eventBus', 'canvas', 'translate' ];\n\ninherits(BpmnOrderingProvider, OrderingProvider);","import translate from 'diagram-js/lib/i18n/translate';\n\nimport BpmnOrderingProvider from './BpmnOrderingProvider';\n\nexport default {\n  __depends__: [\n    translate\n  ],\n  __init__: [ 'bpmnOrderingProvider' ],\n  bpmnOrderingProvider: [ 'type', BpmnOrderingProvider ]\n};","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute` and `postExecute` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {Object}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {Array<Object>}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {Number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {Object}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: []\n  };\n\n\n  this._injector = injector;\n  this._eventBus = eventBus;\n\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command\n *\n * @param {String} command the command to execute\n * @param {Object} context the environment to execute the command in\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  var action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction(action);\n};\n\n\n/**\n * Ask whether a given command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param  {String} command the command to execute\n * @param  {Object} context the environment to execute the command in\n *\n * @return {Boolean} true if the command can be executed\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  var action = { command: command, context: context };\n\n  var handler = this._getHandler(command);\n\n  var result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed');\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  var action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  var action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack\n *\n * @param {String} command\n * @param {CommandHandler} handler\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack\n * by instantiating it and injecting its dependencies.\n *\n * @param {String} command\n * @param {Function} a constructor for a {@link CommandHandler}\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  var handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n    self._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      self._markDirty(handler.revert(context));\n    }\n\n    self._revertedAction(action);\n\n    self._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  var names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ],\n      i, name, result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (i = 0; (name = names[i]); i++) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  var execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n\n    self._fire(command, 'execute', action);\n\n    if (handler.execute) {\n\n      // actual execute + mark return results as dirty\n      self._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    self._executedAction(action, redo);\n\n    self._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction(action);\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  var execution = this._currentExecution,\n      actions = execution.actions;\n\n  var baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  var execution = this._currentExecution,\n      actions = execution.actions,\n      dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty.reverse()) });\n\n    dirty.length = 0;\n\n    this._fire('changed');\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  var execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  var stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","import {\n  isString,\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  attr as domAttr,\n  classes as domClasses,\n  remove as domRemove,\n  delegate as domDelegate\n} from 'min-dom';\n\nimport Ids from '../../util/IdGenerator';\n\n// document wide unique tooltip ids\nvar ids = new Ids('tt');\n\n\nfunction createRoot(parentNode) {\n  var root = domify(\n    '<div class=\"djs-tooltip-container\" style=\"position: absolute; width: 0; height: 0;\" />'\n  );\n\n  parentNode.insertBefore(root, parentNode.firstChild);\n\n  return root;\n}\n\n\nfunction setPosition(el, x, y) {\n  assign(el.style, { left: x + 'px', top: y + 'px' });\n}\n\nfunction setVisible(el, visible) {\n  el.style.display = visible === false ? 'none' : '';\n}\n\n\nvar tooltipClass = 'djs-tooltip',\n    tooltipSelector = '.' + tooltipClass;\n\n/**\n * A service that allows users to render tool tips on the diagram.\n *\n * The tooltip service will take care of updating the tooltip positioning\n * during navigation + zooming.\n *\n * @example\n *\n * ```javascript\n *\n * // add a pink badge on the top left of the shape\n * tooltips.add({\n *   position: {\n *     x: 50,\n *     y: 100\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or with optional life span\n * tooltips.add({\n *   position: {\n *     top: -5,\n *     left: -5\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>',\n *   ttl: 2000\n * });\n *\n * // remove a tool tip\n * var id = tooltips.add(...);\n * tooltips.remove(id);\n * ```\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Tooltips(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  this._ids = ids;\n\n  this._tooltipDefaults = {\n    show: {\n      minZoom: 0.7,\n      maxZoom: 5.0\n    }\n  };\n\n  /**\n   * Mapping tooltipId -> tooltip\n   */\n  this._tooltips = {};\n\n  // root html element for all tooltips\n  this._tooltipRoot = createRoot(canvas.getContainer());\n\n\n  var self = this;\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mouseover', function(event) {\n    self.trigger('mouseover', event);\n  });\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mouseout', function(event) {\n    self.trigger('mouseout', event);\n  });\n\n  this._init();\n}\n\n\nTooltips.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Adds a HTML tooltip to the diagram\n *\n * @param {Object}               tooltip   the tooltip configuration\n *\n * @param {String|DOMElement}    tooltip.html                 html element to use as an tooltip\n * @param {Object}               [tooltip.show]               show configuration\n * @param {Number}               [tooltip.show.minZoom]       minimal zoom level to show the tooltip\n * @param {Number}               [tooltip.show.maxZoom]       maximum zoom level to show the tooltip\n * @param {Object}               tooltip.position             where to attach the tooltip\n * @param {Number}               [tooltip.position.left]      relative to element bbox left attachment\n * @param {Number}               [tooltip.position.top]       relative to element bbox top attachment\n * @param {Number}               [tooltip.position.bottom]    relative to element bbox bottom attachment\n * @param {Number}               [tooltip.position.right]     relative to element bbox right attachment\n * @param {Number}               [tooltip.timeout=-1]\n *\n * @return {String}              id that may be used to reference the tooltip for update or removal\n */\nTooltips.prototype.add = function(tooltip) {\n\n  if (!tooltip.position) {\n    throw new Error('must specifiy tooltip position');\n  }\n\n  if (!tooltip.html) {\n    throw new Error('must specifiy tooltip html');\n  }\n\n  var id = this._ids.next();\n\n  tooltip = assign({}, this._tooltipDefaults, tooltip, {\n    id: id\n  });\n\n  this._addTooltip(tooltip);\n\n  if (tooltip.timeout) {\n    this.setTimeout(tooltip);\n  }\n\n  return id;\n};\n\nTooltips.prototype.trigger = function(action, event) {\n\n  var node = event.delegateTarget || event.target;\n\n  var tooltip = this.get(domAttr(node, 'data-tooltip-id'));\n\n  if (!tooltip) {\n    return;\n  }\n\n  if (action === 'mouseover' && tooltip.timeout) {\n    this.clearTimeout(tooltip);\n  }\n\n  if (action === 'mouseout' && tooltip.timeout) {\n\n    // cut timeout after mouse out\n    tooltip.timeout = 1000;\n\n    this.setTimeout(tooltip);\n  }\n};\n\n/**\n * Get a tooltip with the given id\n *\n * @param {String} id\n */\nTooltips.prototype.get = function(id) {\n\n  if (typeof id !== 'string') {\n    id = id.id;\n  }\n\n  return this._tooltips[id];\n};\n\nTooltips.prototype.clearTimeout = function(tooltip) {\n\n  tooltip = this.get(tooltip);\n\n  if (!tooltip) {\n    return;\n  }\n\n  var removeTimer = tooltip.removeTimer;\n\n  if (removeTimer) {\n    clearTimeout(removeTimer);\n    tooltip.removeTimer = null;\n  }\n};\n\nTooltips.prototype.setTimeout = function(tooltip) {\n\n  tooltip = this.get(tooltip);\n\n  if (!tooltip) {\n    return;\n  }\n\n  this.clearTimeout(tooltip);\n\n  var self = this;\n\n  tooltip.removeTimer = setTimeout(function() {\n    self.remove(tooltip);\n  }, tooltip.timeout);\n};\n\n/**\n * Remove an tooltip with the given id\n *\n * @param {String} id\n */\nTooltips.prototype.remove = function(id) {\n\n  var tooltip = this.get(id);\n\n  if (tooltip) {\n    domRemove(tooltip.html);\n    domRemove(tooltip.htmlContainer);\n\n    delete tooltip.htmlContainer;\n\n    delete this._tooltips[tooltip.id];\n  }\n};\n\n\nTooltips.prototype.show = function() {\n  setVisible(this._tooltipRoot);\n};\n\n\nTooltips.prototype.hide = function() {\n  setVisible(this._tooltipRoot, false);\n};\n\n\nTooltips.prototype._updateRoot = function(viewbox) {\n  var a = viewbox.scale || 1;\n  var d = viewbox.scale || 1;\n\n  var matrix = 'matrix(' + a + ',0,0,' + d + ',' + (-1 * viewbox.x * a) + ',' + (-1 * viewbox.y * d) + ')';\n\n  this._tooltipRoot.style.transform = matrix;\n  this._tooltipRoot.style['-ms-transform'] = matrix;\n};\n\n\nTooltips.prototype._addTooltip = function(tooltip) {\n\n  var id = tooltip.id,\n      html = tooltip.html,\n      htmlContainer,\n      tooltipRoot = this._tooltipRoot;\n\n  // unwrap jquery (for those who need it)\n  if (html.get && html.constructor.prototype.jquery) {\n    html = html.get(0);\n  }\n\n  // create proper html elements from\n  // tooltip HTML strings\n  if (isString(html)) {\n    html = domify(html);\n  }\n\n  htmlContainer = domify('<div data-tooltip-id=\"' + id + '\" class=\"' + tooltipClass + '\" style=\"position: absolute\">');\n\n  htmlContainer.appendChild(html);\n\n  if (tooltip.type) {\n    domClasses(htmlContainer).add('djs-tooltip-' + tooltip.type);\n  }\n\n  if (tooltip.className) {\n    domClasses(htmlContainer).add(tooltip.className);\n  }\n\n  tooltip.htmlContainer = htmlContainer;\n\n  tooltipRoot.appendChild(htmlContainer);\n\n  this._tooltips[id] = tooltip;\n\n  this._updateTooltip(tooltip);\n};\n\n\nTooltips.prototype._updateTooltip = function(tooltip) {\n\n  var position = tooltip.position,\n      htmlContainer = tooltip.htmlContainer;\n\n  // update overlay html based on tooltip x, y\n\n  setPosition(htmlContainer, position.x, position.y);\n};\n\n\nTooltips.prototype._updateTooltipVisibilty = function(viewbox) {\n\n  forEach(this._tooltips, function(tooltip) {\n    var show = tooltip.show,\n        htmlContainer = tooltip.htmlContainer,\n        visible = true;\n\n    if (show) {\n      if (show.minZoom > viewbox.scale ||\n          show.maxZoom < viewbox.scale) {\n        visible = false;\n      }\n\n      setVisible(htmlContainer, visible);\n    }\n  });\n};\n\nTooltips.prototype._init = function() {\n\n  var self = this;\n\n  // scroll/zoom integration\n\n  function updateViewbox(viewbox) {\n    self._updateRoot(viewbox);\n    self._updateTooltipVisibilty(viewbox);\n\n    self.show();\n  }\n\n  this._eventBus.on('canvas.viewbox.changing', function(event) {\n    self.hide();\n  });\n\n  this._eventBus.on('canvas.viewbox.changed', function(event) {\n    updateViewbox(event.viewbox);\n  });\n};\n","import Tooltips from './Tooltips';\n\nexport default {\n  __init__: [ 'tooltips' ],\n  tooltips: [ 'type', Tooltips ]\n};","/**\n * Remove from the beginning of a collection until it is empty.\n *\n * This is a null-safe operation that ensures elements\n * are being removed from the given collection until the\n * collection is empty.\n *\n * The implementation deals with the fact that a remove operation\n * may touch, i.e. remove multiple elements in the collection\n * at a time.\n *\n * @param {Array<Object>} [collection]\n * @param {Function} removeFn\n *\n * @return {Array<Object>} the cleared collection\n */\nexport function saveClear(collection, removeFn) {\n\n  if (typeof removeFn !== 'function') {\n    throw new Error('removeFn iterator must be a function');\n  }\n\n  if (!collection) {\n    return;\n  }\n\n  var e;\n\n  while ((e = collection[0])) {\n    removeFn(e);\n  }\n\n  return collection;\n}\n","import {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nvar LOW_PRIORITY = 250,\n    HIGH_PRIORITY = 1400;\n\nimport {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../util/Collections';\n\nimport { saveClear } from '../../util/Removal';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * A handler that makes sure labels are properly moved with\n * their label targets.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function LabelSupport(injector, eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n  // remove labels from the collection that are being\n  // moved with other elements anyway\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = removeLabels(shapes);\n    context.validatedShapes = removeLabels(validatedShapes);\n  });\n\n  // add labels to visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes;\n\n    var labels = [];\n\n    forEach(shapes, function(element) {\n\n      forEach(element.labels, function(label) {\n\n        if (!label.hidden && context.shapes.indexOf(label) === -1) {\n          labels.push(label);\n        }\n\n        if (element.labelTarget) {\n          labels.push(element);\n        }\n      });\n    });\n\n    forEach(labels, function(label) {\n      movePreview.makeDraggable(context, label, true);\n    });\n\n  });\n\n  // add all labels to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        enclosedElements = closure.enclosedElements;\n\n    var enclosedLabels = [];\n\n    // find labels that are not part of\n    // move closure yet and add them\n    forEach(enclosedElements, function(element) {\n      forEach(element.labels, function(label) {\n\n        if (!enclosedElements[label.id]) {\n          enclosedLabels.push(label);\n        }\n      });\n    });\n\n    closure.addAll(enclosedLabels);\n  });\n\n\n  this.preExecute([\n    'connection.delete',\n    'shape.delete'\n  ], function(e) {\n\n    var context = e.context,\n        element = context.connection || context.shape;\n\n    saveClear(element.labels, function(label) {\n      modeling.removeShape(label, { nested: true });\n    });\n  });\n\n\n  this.execute('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = shape.labelTarget;\n\n    // unset labelTarget\n    if (labelTarget) {\n      context.labelTargetIndex = collectionIdx(labelTarget.labels, shape);\n      context.labelTarget = labelTarget;\n\n      shape.labelTarget = null;\n    }\n  });\n\n  this.revert('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = context.labelTarget,\n        labelTargetIndex = context.labelTargetIndex;\n\n    // restore labelTarget\n    if (labelTarget) {\n      collectionAdd(labelTarget.labels, shape, labelTargetIndex);\n\n      shape.labelTarget = labelTarget;\n    }\n  });\n\n}\n\ninherits(LabelSupport, CommandInterceptor);\n\nLabelSupport.$inject = [\n  'injector',\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeLabels(elements) {\n\n  return filter(elements, function(element) {\n\n    // filter out labels that are move together\n    // with their label targets\n    return elements.indexOf(element.labelTarget) === -1;\n  });\n}\n","import LabelSupport from './LabelSupport';\n\nexport default {\n  __init__: [ 'labelSupport'],\n  labelSupport: [ 'type', LabelSupport ]\n};\n","import {\n  flatten,\n  filter,\n  forEach,\n  groupBy,\n  map,\n  unionBy\n} from 'min-dash';\n\nimport { saveClear } from '../../util/Removal';\n\nimport { getNewAttachShapeDelta } from '../../util/AttachUtil';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\nvar LOW_PRIORITY = 251,\n    HIGH_PRIORITY = 1401;\n\nvar MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Adds the notion of attached elements to the modeler.\n *\n * Optionally depends on `diagram-js/lib/features/move` to render\n * the attached elements during move preview.\n *\n * Optionally depends on `diagram-js/lib/features/label-support`\n * to render attached labels during move preview.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Rules} rules\n * @param {Modeling} modeling\n */\nexport default function AttachSupport(injector, eventBus, canvas, rules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n\n  // remove all the attached elements from the shapes to be validated\n  // add all the attached shapes to the overall list of moved shapes\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = addAttached(shapes);\n\n    context.validatedShapes = removeAttached(validatedShapes);\n  });\n\n  // add attachers to the visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      movePreview.makeDraggable(context, attacher, true);\n\n      forEach(attacher.labels, function(label) {\n        movePreview.makeDraggable(context, label, true);\n      });\n    });\n  });\n\n  // add attach-ok marker to current host\n  movePreview && eventBus.on('shape.move.start', function(event) {\n    var context = event.context,\n        shapes = context.shapes;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    var host = shape.host;\n\n    if (host) {\n      canvas.addMarker(host, MARKER_ATTACH);\n\n      eventBus.once([\n        'shape.move.out',\n        'shape.move.cleanup'\n      ], function() {\n        canvas.removeMarker(host, MARKER_ATTACH);\n      });\n    }\n  });\n\n  // add all attachers to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      closure.add(attacher, closure.topLevel[attacher.host.id]);\n    });\n  });\n\n  // perform the attaching after shapes are done moving\n  this.postExecuted('elements.move', function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        newHost = context.newHost,\n        attachers;\n\n    // only single elements can be attached\n    // multiply elements can be detached\n    if (newHost && shapes.length !== 1) {\n      return;\n    }\n\n    if (newHost) {\n      attachers = shapes;\n    } else {\n\n      // find attachers moved without host\n      attachers = filter(shapes, function(shape) {\n        var host = shape.host;\n\n        return isAttacher(shape) && !includes(shapes, host);\n      });\n    }\n\n    forEach(attachers, function(attacher) {\n      modeling.updateAttachment(attacher, newHost);\n    });\n  });\n\n  // ensure invalid attachment connections are removed\n  this.postExecuted('elements.move', function(e) {\n\n    var shapes = e.context.shapes;\n\n    forEach(shapes, function(shape) {\n\n      forEach(shape.attachers, function(attacher) {\n\n        // remove invalid outgoing connections\n        forEach(attacher.outgoing.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnect', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n\n        // remove invalid incoming connections\n        forEach(attacher.incoming.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnect', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n      });\n    });\n  });\n\n  this.postExecute('shape.create', function(e) {\n    var context = e.context,\n        shape = context.shape,\n        host = context.host;\n\n    if (host) {\n      modeling.updateAttachment(shape, host);\n    }\n  });\n\n  // update attachments if the host is replaced\n  this.postExecute('shape.replace', function(e) {\n\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    // move the attachers to the new host\n    saveClear(oldShape.attachers, function(attacher) {\n      var allowed = rules.allowed('elements.move', {\n        target: newShape,\n        shapes: [attacher]\n      });\n\n      if (allowed === 'attach') {\n        modeling.updateAttachment(attacher, newShape);\n      } else {\n        modeling.removeShape(attacher);\n      }\n    });\n\n    // move attachers if new host has different size\n    if (newShape.attachers.length) {\n\n      forEach(newShape.attachers, function(attacher) {\n        var delta = getNewAttachShapeDelta(attacher, oldShape, newShape);\n        modeling.moveShape(attacher, delta, attacher.parent);\n      });\n    }\n\n  });\n\n  // move shape on host resize\n  this.postExecute('shape.resize', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        oldBounds = context.oldBounds,\n        newBounds = context.newBounds,\n        attachers = shape.attachers,\n        hints = context.hints || {};\n\n    if (hints.attachSupport === false) {\n      return;\n    }\n\n    forEach(attachers, function(attacher) {\n      var delta = getNewAttachShapeDelta(attacher, oldBounds, newBounds);\n\n      modeling.moveShape(attacher, delta, attacher.parent);\n\n      forEach(attacher.labels, function(label) {\n        modeling.moveShape(label, delta, label.parent);\n      });\n    });\n  });\n\n  // remove attachments\n  this.preExecute('shape.delete', function(event) {\n\n    var shape = event.context.shape;\n\n    saveClear(shape.attachers, function(attacher) {\n      modeling.removeShape(attacher);\n    });\n\n    if (shape.host) {\n      modeling.updateAttachment(shape, null);\n    }\n  });\n}\n\ninherits(AttachSupport, CommandInterceptor);\n\nAttachSupport.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'rules',\n  'modeling'\n];\n\n\n/**\n * Return attachers of the given shapes\n *\n * @param {Array<djs.model.Base>} shapes\n * @return {Array<djs.model.Base>}\n */\nfunction getAttachers(shapes) {\n  return flatten(map(shapes, function(s) {\n    return s.attachers || [];\n  }));\n}\n\n/**\n * Return a combined list of elements and\n * attachers.\n *\n * @param {Array<djs.model.Base>} elements\n * @return {Array<djs.model.Base>} filtered\n */\nfunction addAttached(elements) {\n  var attachers = getAttachers(elements);\n\n  return unionBy('id', elements, attachers);\n}\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeAttached(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while (element) {\n\n      // host in selection\n      if (element.host && ids[element.host.id]) {\n        return false;\n      }\n\n      element = element.parent;\n    }\n\n    return true;\n  });\n}\n\nfunction isAttacher(shape) {\n  return !!shape.host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import RulesModule from '../rules';\n\nimport AttachSupport from './AttachSupport';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'attachSupport' ],\n  attachSupport: [ 'type', AttachSupport ]\n};\n","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  closest as domClosest\n} from 'min-dom';\n\nvar LOW_PRIORITY = 250;\n\n/**\n * The tool manager acts as middle-man between the available tool's and the Palette,\n * it takes care of making sure that the correct active state is set.\n *\n * @param  {Object}    eventBus\n * @param  {Object}    dragging\n */\nexport default function ToolManager(eventBus, dragging) {\n  this._eventBus = eventBus;\n  this._dragging = dragging;\n\n  this._tools = [];\n  this._active = null;\n}\n\nToolManager.$inject = [ 'eventBus', 'dragging' ];\n\nToolManager.prototype.registerTool = function(name, events) {\n  var tools = this._tools;\n\n  if (!events) {\n    throw new Error('A tool has to be registered with it\\'s \"events\"');\n  }\n\n  tools.push(name);\n\n  this.bindEvents(name, events);\n};\n\nToolManager.prototype.isActive = function(tool) {\n  return tool && this._active === tool;\n};\n\nToolManager.prototype.length = function(tool) {\n  return this._tools.length;\n};\n\nToolManager.prototype.setActive = function(tool) {\n  var eventBus = this._eventBus;\n\n  if (this._active !== tool) {\n    this._active = tool;\n\n    eventBus.fire('tool-manager.update', { tool: tool });\n  }\n};\n\nToolManager.prototype.bindEvents = function(name, events) {\n  var eventBus = this._eventBus,\n      dragging = this._dragging;\n\n  var eventsToRegister = [];\n\n  eventBus.on(events.tool + '.init', function(event) {\n    var context = event.context;\n\n    // Active tools that want to reactivate themselves must do this explicitly\n    if (!context.reactivate && this.isActive(name)) {\n      this.setActive(null);\n\n      dragging.cancel();\n      return;\n    }\n\n    this.setActive(name);\n\n  }, this);\n\n  // Todo[ricardo]: add test cases\n  forEach(events, function(event) {\n    eventsToRegister.push(event + '.ended');\n    eventsToRegister.push(event + '.canceled');\n  });\n\n  eventBus.on(eventsToRegister, LOW_PRIORITY, function(event) {\n    var originalEvent = event.originalEvent;\n\n    // We defer the de-activation of the tool to the .activate phase,\n    // so we're able to check if we want to toggle off the current\n    // active tool or switch to a new one\n    if (!this._active) {\n      return;\n    }\n\n    if (originalEvent && domClosest(originalEvent.target, '.group[data-group=\"tools\"]')) {\n      return;\n    }\n\n    this.setActive(null);\n  }, this);\n};\n","import DraggingModule from '../dragging';\n\nimport ToolManager from './ToolManager';\n\nexport default {\n  __depends__: [\n    DraggingModule\n  ],\n  __init__: [ 'toolManager' ],\n  toolManager: [ 'type', ToolManager ]\n};\n","import { forEach } from 'min-dash';\n\n/**\n * Return direction given axis and delta.\n *\n * @param {string} axis\n * @param {number} delta\n *\n * @return {string}\n */\nexport function getDirection(axis, delta) {\n\n  if (axis === 'x') {\n    if (delta > 0) {\n      return 'e';\n    }\n\n    if (delta < 0) {\n      return 'w';\n    }\n  }\n\n  if (axis === 'y') {\n    if (delta > 0) {\n      return 's';\n    }\n\n    if (delta < 0) {\n      return 'n';\n    }\n  }\n\n  return null;\n}\n\n/**\n * Returns connections whose waypoints are to be updated. Waypoints are to be updated if start\n * or end is to be moved or resized.\n *\n * @param {Array<djs.model.Shape} movingShapes\n * @param {Array<djs.model.Shape} resizingShapes\n *\n * @returns {Array<djs.model.Connection>}\n */\nexport function getWaypointsUpdatingConnections(movingShapes, resizingShapes) {\n  var waypointsUpdatingConnections = [];\n\n  forEach(movingShapes, function(shape) {\n    var incoming = shape.incoming,\n        outgoing = shape.outgoing;\n\n    forEach(incoming.concat(outgoing), function(connection) {\n      var source = connection.source,\n          target = connection.target;\n\n      if (includes(movingShapes, source) ||\n        includes(movingShapes, target) ||\n        includes(resizingShapes, source) ||\n        includes(resizingShapes, target)) {\n\n        if (!includes(waypointsUpdatingConnections, connection)) {\n          waypointsUpdatingConnections.push(connection);\n        }\n      }\n    });\n  });\n\n  return waypointsUpdatingConnections;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\n/**\n * Resize bounds.\n *\n * @param {Object} bounds\n * @param {number} bounds.x\n * @param {number} bounds.y\n * @param {number} bounds.width\n * @param {number} bounds.height\n * @param {string} direction\n * @param {Object} delta\n * @param {number} delta.x\n * @param {number} delta.y\n *\n * @return {Object}\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var x = bounds.x,\n      y = bounds.y,\n      width = bounds.width,\n      height = bounds.height,\n      dx = delta.x,\n      dy = delta.y;\n\n  switch (direction) {\n  case 'n':\n    return {\n      x: x,\n      y: y + dy,\n      width: width,\n      height: height - dy\n    };\n  case 's':\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height + dy\n    };\n  case 'w':\n    return {\n      x: x + dx,\n      y: y,\n      width: width - dx,\n      height: height\n    };\n  case 'e':\n    return {\n      x: x,\n      y: y,\n      width: width + dx,\n      height: height\n    };\n  default:\n    throw new Error('unknown direction: ' + direction);\n  }\n}","import {\n  assign,\n  filter,\n  forEach,\n  isNumber\n} from 'min-dash';\n\nimport { asTRBL } from '../../layout/LayoutUtil';\n\nimport { getBBox } from '../../util/Elements';\n\nimport { getDirection } from './SpaceUtil';\n\nimport { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { set as setCursor } from '../../util/Cursor';\n\nimport { selfAndAllChildren } from '../../util/Elements';\n\nvar abs = Math.abs,\n    round = Math.round;\n\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\n\nvar CURSOR_CROSSHAIR = 'crosshair';\n\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\n\nvar HIGH_PRIORITY = 1500;\n\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\n\nvar PADDING = 20;\n\n\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {toolManager} toolManager\n */\nexport default function SpaceTool(canvas, dragging, eventBus, modeling, rules, toolManager) {\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n\n  var self = this;\n\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n\n  eventBus.on('spaceTool.selection.end', function(event) {\n    eventBus.once('spaceTool.selection.ended', function() {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n\n  eventBus.on('spaceTool.move', HIGH_PRIORITY , function(event) {\n    var context = event.context,\n        initialized = context.initialized;\n\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n\n  eventBus.on('spaceTool.end', function(event) {\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes,\n        start = context.start;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    delta[ axis ] = round(event[ 'd' + axis ]);\n\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n\n    eventBus.once('spaceTool.ended', function(event) {\n\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\n\nSpaceTool.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules',\n  'toolManager'\n];\n\n/**\n * Activate space tool selection.\n *\n * @param {Object} event\n * @param {boolean} autoActivate\n */\nSpaceTool.prototype.activateSelection = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n\n/**\n * Activate space tool make space.\n *\n * @param  {MouseEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function(event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Make space.\n *\n * @param  {Array<djs.model.Shape>} movingShapes\n * @param  {Array<djs.model.Shape>} resizingShapes\n * @param  {Object} delta\n * @param  {number} delta.x\n * @param  {number} delta.y\n * @param  {string} direction\n * @param  {number} start\n */\nSpaceTool.prototype.makeSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {Object} event\n * @param {Object} context\n *\n * @return {boolean}\n */\nSpaceTool.prototype.init = function(event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      delta = event[ 'd' + axis ],\n      start = event[ axis ] - delta;\n\n  if (abs(delta) < 5) {\n    return false;\n  }\n\n  // invert delta to remove space when moving left\n  if (delta < 0) {\n    delta *= -1;\n  }\n\n  // invert delta to add/remove space when removing/adding space if modifier key is pressed\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n\n  var direction = getDirection(axis, delta);\n\n  var root = this._canvas.getRootElement();\n\n  var children = selfAndAllChildren(root, true);\n\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    shapes: elements.resizingShapes\n  });\n\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n\n  assign(\n    context,\n    elements,\n    {\n      axis: axis,\n      direction: direction,\n      spaceToolConstraints: spaceToolConstraints,\n      start: start\n    }\n  );\n\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n\n  return true;\n};\n\n/**\n * Get elements to be moved and resized.\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {string} axis\n * @param  {number} delta\n * @param  {number} start\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function(elements, axis, delta, start) {\n  var rules = this._rules;\n\n  var movingShapes = [],\n      resizingShapes = [];\n\n  forEach(elements, function(element) {\n    if (!element.parent || isConnection(element)) {\n      return;\n    }\n\n    var shapeStart = element[ axis ],\n        shapeEnd = shapeStart + element[ AXIS_TO_DIMENSION[ axis ] ];\n\n    // shape to be moved\n    if ((delta > 0 && shapeStart > start) || (delta < 0 && shapeEnd < start)) {\n      return movingShapes.push(element);\n    }\n\n    // shape to be resized\n    if (shapeStart < start &&\n      shapeEnd > start &&\n      rules.allowed('shape.resize', { shape: element })\n    ) {\n\n      return resizingShapes.push(element);\n    }\n  });\n\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nSpaceTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^spaceTool/.test(context.prefix);\n};\n\n// helpers //////////\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      spaceToolConstraints = context.spaceToolConstraints;\n\n  if (!spaceToolConstraints) {\n    return;\n  }\n\n  var x, y;\n\n  if (spaceToolConstraints.left) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (spaceToolConstraints.right) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (spaceToolConstraints.top) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n\n  if (spaceToolConstraints.bottom) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\n\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n      resizingShapes = elements.resizingShapes;\n\n  if (!resizingShapes.length) {\n    return;\n  }\n\n  var spaceToolConstraints = {},\n      min,\n      max;\n\n  forEach(resizingShapes, function(resizingShape) {\n    var resizingShapeBBox = asTRBL(resizingShape);\n\n    // find children that are not moving or resizing\n    var nonMovingResizingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) &&\n        !isLabel(child) &&\n        !includes(movingShapes, child) &&\n        !includes(resizingShapes, child);\n    });\n\n    // find children that are moving\n    var movingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n\n    var minOrMax,\n        nonMovingResizingChildrenBBox,\n        movingChildrenBBox;\n\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n\n      minOrMax = start -\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ direction ] ] +\n        nonMovingResizingChildrenBBox[ DIRECTION_TO_TRBL[ direction ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n\n      minOrMax = start -\n        movingChildrenBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ] +\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    var resizingShapeMinDimensions = minDimensions && minDimensions[ resizingShape.id ];\n\n    if (resizingShapeMinDimensions) {\n      if (direction === 'n') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n\n  return spaceToolConstraints;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}","import {\n  forEach\n} from 'min-dash';\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_RESIZING = 'djs-resizing';\n\nvar LOW_PRIORITY = 250;\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\nvar max = Math.max;\n\n\n/**\n * Provides previews for selecting/moving/resizing shapes when creating/removing space.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function SpaceToolPreview(\n    eventBus, elementRegistry, canvas,\n    styles, previewSupport) {\n\n  function addPreviewGfx(collection, dragGroup) {\n    forEach(collection, function(element) {\n      previewSupport.addDragger(element, dragGroup);\n\n      canvas.addMarker(element, MARKER_DRAGGING);\n    });\n  }\n\n  // add crosshair\n  eventBus.on('spaceTool.selection.start', function(event) {\n    var space = canvas.getLayer('space'),\n        context = event.context;\n\n    var orientation = {\n      x: 'M 0,-10000 L 0,10000',\n      y: 'M -10000,0 L 10000,0'\n    };\n\n    var crosshairGroup = svgCreate('g');\n    svgAttr(crosshairGroup, styles.cls('djs-crosshair-group', [ 'no-events' ]));\n\n    svgAppend(space, crosshairGroup);\n\n    // horizontal path\n    var pathX = svgCreate('path');\n    svgAttr(pathX, 'd', orientation.x);\n    svgClasses(pathX).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathX);\n\n    // vertical path\n    var pathY = svgCreate('path');\n    svgAttr(pathY, 'd', orientation.y);\n    svgClasses(pathY).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathY);\n\n    context.crosshairGroup = crosshairGroup;\n  });\n\n  // update crosshair\n  eventBus.on('spaceTool.selection.move', function(event) {\n    var crosshairGroup = event.context.crosshairGroup;\n\n    translate(crosshairGroup, event.x, event.y);\n  });\n\n  // remove crosshair\n  eventBus.on('spaceTool.selection.cleanup', function(event) {\n    var context = event.context,\n        crosshairGroup = context.crosshairGroup;\n\n    if (crosshairGroup) {\n      svgRemove(crosshairGroup);\n    }\n  });\n\n  // add and update move/resize previews\n  eventBus.on('spaceTool.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        line = context.line,\n        axis = context.axis,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    if (!context.dragGroup) {\n      var spaceLayer = canvas.getLayer('space');\n\n      line = svgCreate('path');\n      svgAttr(line, 'd', 'M0,0 L0,0');\n      svgClasses(line).add('djs-crosshair');\n\n      svgAppend(spaceLayer, line);\n\n      context.line = line;\n\n      var dragGroup = svgCreate('g');\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), dragGroup);\n\n      // shapes\n      addPreviewGfx(movingShapes, dragGroup);\n\n      // connections\n      var movingConnections = context.movingConnections = elementRegistry.filter(function(element) {\n        var sourceIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsMoving = true;\n            }\n          });\n        });\n\n        var targetIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsMoving = true;\n            }\n          });\n        });\n\n        var sourceIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsResizing = true;\n            }\n          });\n        });\n\n        var targetIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsResizing = true;\n            }\n          });\n        });\n\n        return isConnection(element)\n          && (sourceIsMoving || sourceIsResizing)\n          && (targetIsMoving || targetIsResizing);\n      });\n\n\n      addPreviewGfx(movingConnections, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    if (!context.frameGroup) {\n      var frameGroup = svgCreate('g');\n      svgAttr(frameGroup, styles.cls('djs-frame-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), frameGroup);\n\n      var frames = [];\n\n      forEach(resizingShapes, function(shape) {\n        var frame = previewSupport.addFrame(shape, frameGroup);\n\n        var initialBounds = frame.getBBox();\n\n        frames.push({\n          element: frame,\n          initialBounds: initialBounds\n        });\n\n        canvas.addMarker(shape, MARKER_RESIZING);\n      });\n\n      context.frameGroup = frameGroup;\n      context.frames = frames;\n    }\n\n    var orientation = {\n      x: 'M' + event.x + ', -10000 L' + event.x + ', 10000',\n      y: 'M -10000, ' + event.y + ' L 10000, ' + event.y\n    };\n\n    svgAttr(line, { d: orientation[ axis ] });\n\n    var opposite = { x: 'y', y: 'x' };\n    var delta = { x: event.dx, y: event.dy };\n    delta[ opposite[ context.axis ] ] = 0;\n\n    // update move previews\n    translate(context.dragGroup, delta.x, delta.y);\n\n    // update resize previews\n    forEach(context.frames, function(frame) {\n      var element = frame.element,\n          initialBounds = frame.initialBounds,\n          width,\n          height;\n\n      if (context.direction === 'e') {\n        svgAttr(element, {\n          width: max(initialBounds.width + delta.x, 5)\n        });\n      } else {\n        width = max(initialBounds.width - delta.x, 5);\n\n        svgAttr(element, {\n          width: width,\n          x: initialBounds.x + initialBounds.width - width\n        });\n      }\n\n      if (context.direction === 's') {\n        svgAttr(element, {\n          height: max(initialBounds.height + delta.y, 5)\n        });\n      } else {\n        height = max(initialBounds.height - delta.y, 5);\n\n        svgAttr(element, {\n          height: height,\n          y: initialBounds.y + initialBounds.height - height\n        });\n      }\n    });\n\n  });\n\n  // remove move/resize previews\n  eventBus.on('spaceTool.cleanup', function(event) {\n\n    var context = event.context,\n        movingShapes = context.movingShapes,\n        movingConnections = context.movingConnections,\n        resizingShapes = context.resizingShapes,\n        line = context.line,\n        dragGroup = context.dragGroup,\n        frameGroup = context.frameGroup;\n\n    // moving shapes\n    forEach(movingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_DRAGGING);\n    });\n\n    // moving connections\n    forEach(movingConnections, function(connection) {\n      canvas.removeMarker(connection, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(line);\n      svgRemove(dragGroup);\n    }\n\n    forEach(resizingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_RESIZING);\n    });\n\n    if (frameGroup) {\n      svgRemove(frameGroup);\n    }\n  });\n}\n\nSpaceToolPreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\nimport ToolManagerModule from '../tool-manager';\nimport PreviewSupportModule from '../preview-support';\n\nimport SpaceTool from './SpaceTool';\nimport SpaceToolPreview from './SpaceToolPreview';\n\nexport default {\n  __init__: ['spaceToolPreview'],\n  __depends__: [\n    DraggingModule,\n    RulesModule,\n    ToolManagerModule,\n    PreviewSupportModule\n  ],\n  spaceTool: ['type', SpaceTool ],\n  spaceToolPreview: ['type', SpaceToolPreview ]\n};\n","import {\n  map,\n  assign,\n  pick\n} from 'min-dash';\n\nimport {\n  isAny\n} from './util/ModelingUtil';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\n\nexport default function BpmnFactory(moddle) {\n  this._model = moddle;\n}\n\nBpmnFactory.$inject = [ 'moddle' ];\n\n\nBpmnFactory.prototype._needsId = function(element) {\n  return isAny(element, [\n    'bpmn:RootElement',\n    'bpmn:FlowElement',\n    'bpmn:MessageFlow',\n    'bpmn:DataAssociation',\n    'bpmn:Artifact',\n    'bpmn:Participant',\n    'bpmn:Lane',\n    'bpmn:LaneSet',\n    'bpmn:Process',\n    'bpmn:Collaboration',\n    'bpmndi:BPMNShape',\n    'bpmndi:BPMNEdge',\n    'bpmndi:BPMNDiagram',\n    'bpmndi:BPMNPlane',\n    'bpmn:Property',\n    'bpmn:CategoryValue'\n  ]);\n};\n\nBpmnFactory.prototype._ensureId = function(element) {\n\n  // generate semantic ids for elements\n  // bpmn:SequenceFlow -> SequenceFlow_ID\n  var prefix;\n\n  if (is(element, 'bpmn:Activity')) {\n    prefix = 'Activity';\n  } else if (is(element, 'bpmn:Event')) {\n    prefix = 'Event';\n  } else if (is(element, 'bpmn:Gateway')) {\n    prefix = 'Gateway';\n  } else if (is(element, 'bpmn:FlowElement')) {\n    prefix = 'Flow';\n  } else {\n    prefix = (element.$type || '').replace(/^[^:]*:/g, '');\n  }\n\n  prefix += '_';\n\n  if (!element.id && this._needsId(element)) {\n    element.id = this._model.ids.nextPrefixed(prefix, element);\n  }\n};\n\n\nBpmnFactory.prototype.create = function(type, attrs) {\n  var element = this._model.create(type, attrs || {});\n\n  this._ensureId(element);\n\n  return element;\n};\n\n\nBpmnFactory.prototype.createDiLabel = function() {\n  return this.create('bpmndi:BPMNLabel', {\n    bounds: this.createDiBounds()\n  });\n};\n\n\nBpmnFactory.prototype.createDiShape = function(semantic, bounds, attrs) {\n\n  return this.create('bpmndi:BPMNShape', assign({\n    bpmnElement: semantic,\n    bounds: this.createDiBounds(bounds)\n  }, attrs));\n};\n\n\nBpmnFactory.prototype.createDiBounds = function(bounds) {\n  return this.create('dc:Bounds', bounds);\n};\n\n\nBpmnFactory.prototype.createDiWaypoints = function(waypoints) {\n  var self = this;\n\n  return map(waypoints, function(pos) {\n    return self.createDiWaypoint(pos);\n  });\n};\n\nBpmnFactory.prototype.createDiWaypoint = function(point) {\n  return this.create('dc:Point', pick(point, [ 'x', 'y' ]));\n};\n\n\nBpmnFactory.prototype.createDiEdge = function(semantic, waypoints, attrs) {\n  return this.create('bpmndi:BPMNEdge', assign({\n    bpmnElement: semantic\n  }, attrs));\n};\n\nBpmnFactory.prototype.createDiPlane = function(semantic) {\n  return this.create('bpmndi:BPMNPlane', {\n    bpmnElement: semantic\n  });\n};","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  remove as collectionRemove,\n  add as collectionAdd\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  Label\n} from 'diagram-js/lib/model';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isAny\n} from './util/ModelingUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n/**\n * A handler responsible for updating the underlying BPMN 2.0 XML + DI\n * once changes on the diagram happen\n */\nexport default function BpmnUpdater(\n    eventBus, bpmnFactory, connectionDocking,\n    translate) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._bpmnFactory = bpmnFactory;\n  this._translate = translate;\n\n  var self = this;\n\n\n\n  // connection cropping //////////////////////\n\n  // crop connection ends during create/update\n  function cropConnection(e) {\n    var context = e.context,\n        hints = context.hints || {},\n        connection;\n\n    if (!context.cropped && hints.createElementsBehavior !== false) {\n      connection = context.connection;\n      connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n      context.cropped = true;\n    }\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.create'\n  ], cropConnection);\n\n  this.reverted([ 'connection.layout' ], function(e) {\n    delete e.context.cropped;\n  });\n\n\n\n  // BPMN + DI update //////////////////////\n\n\n  // update parent\n  function updateParent(e) {\n    var context = e.context;\n\n    self.updateParent(context.shape || context.connection, context.oldParent);\n  }\n\n  function reverseUpdateParent(e) {\n    var context = e.context;\n\n    var element = context.shape || context.connection,\n\n        // oldParent is the (old) new parent, because we are undoing\n        oldParent = context.parent || context.newParent;\n\n    self.updateParent(element, oldParent);\n  }\n\n  this.executed([\n    'shape.move',\n    'shape.create',\n    'shape.delete',\n    'connection.create',\n    'connection.move',\n    'connection.delete'\n  ], ifBpmn(updateParent));\n\n  this.reverted([\n    'shape.move',\n    'shape.create',\n    'shape.delete',\n    'connection.create',\n    'connection.move',\n    'connection.delete'\n  ], ifBpmn(reverseUpdateParent));\n\n  /*\n   * ## Updating Parent\n   *\n   * When morphing a Process into a Collaboration or vice-versa,\n   * make sure that both the *semantic* and *di* parent of each element\n   * is updated.\n   *\n   */\n  function updateRoot(event) {\n    var context = event.context,\n        oldRoot = context.oldRoot,\n        children = oldRoot.children;\n\n    forEach(children, function(child) {\n      if (is(child, 'bpmn:BaseElement')) {\n        self.updateParent(child);\n      }\n    });\n  }\n\n  this.executed([ 'canvas.updateRoot' ], updateRoot);\n  this.reverted([ 'canvas.updateRoot' ], updateRoot);\n\n\n  // update bounds\n  function updateBounds(e) {\n    var shape = e.context.shape;\n\n    if (!is(shape, 'bpmn:BaseElement')) {\n      return;\n    }\n\n    self.updateBounds(shape);\n  }\n\n  this.executed([ 'shape.move', 'shape.create', 'shape.resize' ], ifBpmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  this.reverted([ 'shape.move', 'shape.create', 'shape.resize' ], ifBpmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  // Handle labels separately. This is necessary, because the label bounds have to be updated\n  // every time its shape changes, not only on move, create and resize.\n  eventBus.on('shape.changed', function(event) {\n    if (event.element.type === 'label') {\n      updateBounds({ context: { shape: event.element } });\n    }\n  });\n\n  // attach / detach connection\n  function updateConnection(e) {\n    self.updateConnection(e.context);\n  }\n\n  this.executed([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnect'\n  ], ifBpmn(updateConnection));\n\n  this.reverted([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnect'\n  ], ifBpmn(updateConnection));\n\n\n  // update waypoints\n  function updateConnectionWaypoints(e) {\n    self.updateConnectionWaypoints(e.context.connection);\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.move',\n    'connection.updateWaypoints',\n  ], ifBpmn(updateConnectionWaypoints));\n\n  this.reverted([\n    'connection.layout',\n    'connection.move',\n    'connection.updateWaypoints',\n  ], ifBpmn(updateConnectionWaypoints));\n\n  // update conditional/default flows\n  this.executed('connection.reconnect', ifBpmn(function(event) {\n    var context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n    // remove condition from connection on reconnect to new source\n    // if new source can NOT have condional sequence flow\n    if (connectionBo.conditionExpression && !isAny(newSourceBo, [\n      'bpmn:Activity',\n      'bpmn:ExclusiveGateway',\n      'bpmn:InclusiveGateway'\n    ])) {\n      context.oldConditionExpression = connectionBo.conditionExpression;\n\n      delete connectionBo.conditionExpression;\n    }\n\n    // remove default from old source flow on reconnect to new source\n    // if source changed\n    if (oldSource !== newSource && oldSourceBo.default === connectionBo) {\n      context.oldDefault = oldSourceBo.default;\n\n      delete oldSourceBo.default;\n    }\n  }));\n\n  this.reverted('connection.reconnect', ifBpmn(function(event) {\n    var context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n    // add condition to connection on revert reconnect to new source\n    if (context.oldConditionExpression) {\n      connectionBo.conditionExpression = context.oldConditionExpression;\n    }\n\n    // add default to old source on revert reconnect to new source\n    if (context.oldDefault) {\n      oldSourceBo.default = context.oldDefault;\n\n      delete newSourceBo.default;\n    }\n  }));\n\n  // update attachments\n  function updateAttachment(e) {\n    self.updateAttachment(e.context);\n  }\n\n  this.executed([ 'element.updateAttachment' ], ifBpmn(updateAttachment));\n  this.reverted([ 'element.updateAttachment' ], ifBpmn(updateAttachment));\n}\n\ninherits(BpmnUpdater, CommandInterceptor);\n\nBpmnUpdater.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'connectionDocking',\n  'translate'\n];\n\n\n// implementation //////////////////////\n\nBpmnUpdater.prototype.updateAttachment = function(context) {\n\n  var shape = context.shape,\n      businessObject = shape.businessObject,\n      host = shape.host;\n\n  businessObject.attachedToRef = host && host.businessObject;\n};\n\nBpmnUpdater.prototype.updateParent = function(element, oldParent) {\n\n  // do not update BPMN 2.0 label parent\n  if (element instanceof Label) {\n    return;\n  }\n\n  // data stores in collaborations are handled separately by DataStoreBehavior\n  if (is(element, 'bpmn:DataStoreReference') &&\n      element.parent &&\n      is(element.parent, 'bpmn:Collaboration')) {\n    return;\n  }\n\n  var parentShape = element.parent;\n\n  var businessObject = element.businessObject,\n      parentBusinessObject = parentShape && parentShape.businessObject,\n      parentDi = parentBusinessObject && parentBusinessObject.di;\n\n  if (is(element, 'bpmn:FlowNode')) {\n    this.updateFlowNodeRefs(businessObject, parentBusinessObject, oldParent && oldParent.businessObject);\n  }\n\n  if (is(element, 'bpmn:DataOutputAssociation')) {\n    if (element.source) {\n      parentBusinessObject = element.source.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  if (is(element, 'bpmn:DataInputAssociation')) {\n    if (element.target) {\n      parentBusinessObject = element.target.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  this.updateSemanticParent(businessObject, parentBusinessObject);\n\n  if (is(element, 'bpmn:DataObjectReference') && businessObject.dataObjectRef) {\n    this.updateSemanticParent(businessObject.dataObjectRef, parentBusinessObject);\n  }\n\n  this.updateDiParent(businessObject.di, parentDi);\n};\n\n\nBpmnUpdater.prototype.updateBounds = function(shape) {\n\n  var di = shape.businessObject.di;\n\n  var target = (shape instanceof Label) ? this._getLabel(di) : di;\n\n  var bounds = target.bounds;\n\n  if (!bounds) {\n    bounds = this._bpmnFactory.createDiBounds();\n    target.set('bounds', bounds);\n  }\n\n  assign(bounds, {\n    x: shape.x,\n    y: shape.y,\n    width: shape.width,\n    height: shape.height\n  });\n};\n\nBpmnUpdater.prototype.updateFlowNodeRefs = function(businessObject, newContainment, oldContainment) {\n\n  if (oldContainment === newContainment) {\n    return;\n  }\n\n  var oldRefs, newRefs;\n\n  if (is (oldContainment, 'bpmn:Lane')) {\n    oldRefs = oldContainment.get('flowNodeRef');\n    collectionRemove(oldRefs, businessObject);\n  }\n\n  if (is(newContainment, 'bpmn:Lane')) {\n    newRefs = newContainment.get('flowNodeRef');\n    collectionAdd(newRefs, businessObject);\n  }\n};\n\n\n// update existing sourceElement and targetElement di information\nBpmnUpdater.prototype.updateDiConnection = function(di, newSource, newTarget) {\n\n  if (di.sourceElement && di.sourceElement.bpmnElement !== newSource) {\n    di.sourceElement = newSource && newSource.di;\n  }\n\n  if (di.targetElement && di.targetElement.bpmnElement !== newTarget) {\n    di.targetElement = newTarget && newTarget.di;\n  }\n\n};\n\n\nBpmnUpdater.prototype.updateDiParent = function(di, parentDi) {\n\n  if (parentDi && !is(parentDi, 'bpmndi:BPMNPlane')) {\n    parentDi = parentDi.$parent;\n  }\n\n  if (di.$parent === parentDi) {\n    return;\n  }\n\n  var planeElements = (parentDi || di.$parent).get('planeElement');\n\n  if (parentDi) {\n    planeElements.push(di);\n    di.$parent = parentDi;\n  } else {\n    collectionRemove(planeElements, di);\n    di.$parent = null;\n  }\n};\n\nfunction getDefinitions(element) {\n  while (element && !is(element, 'bpmn:Definitions')) {\n    element = element.$parent;\n  }\n\n  return element;\n}\n\nBpmnUpdater.prototype.getLaneSet = function(container) {\n\n  var laneSet, laneSets;\n\n  // bpmn:Lane\n  if (is(container, 'bpmn:Lane')) {\n    laneSet = container.childLaneSet;\n\n    if (!laneSet) {\n      laneSet = this._bpmnFactory.create('bpmn:LaneSet');\n      container.childLaneSet = laneSet;\n      laneSet.$parent = container;\n    }\n\n    return laneSet;\n  }\n\n  // bpmn:Participant\n  if (is(container, 'bpmn:Participant')) {\n    container = container.processRef;\n  }\n\n  // bpmn:FlowElementsContainer\n  laneSets = container.get('laneSets');\n  laneSet = laneSets[0];\n\n  if (!laneSet) {\n    laneSet = this._bpmnFactory.create('bpmn:LaneSet');\n    laneSet.$parent = container;\n    laneSets.push(laneSet);\n  }\n\n  return laneSet;\n};\n\nBpmnUpdater.prototype.updateSemanticParent = function(businessObject, newParent, visualParent) {\n\n  var containment,\n      translate = this._translate;\n\n  if (businessObject.$parent === newParent) {\n    return;\n  }\n\n  if (is(businessObject, 'bpmn:DataInput') || is(businessObject, 'bpmn:DataOutput')) {\n\n    if (is(newParent, 'bpmn:Participant') && 'processRef' in newParent) {\n      newParent = newParent.processRef;\n    }\n\n    // already in correct ioSpecification\n    if ('ioSpecification' in newParent && newParent.ioSpecification === businessObject.$parent) {\n      return;\n    }\n  }\n\n  if (is(businessObject, 'bpmn:Lane')) {\n\n    if (newParent) {\n      newParent = this.getLaneSet(newParent);\n    }\n\n    containment = 'lanes';\n  } else\n\n  if (is(businessObject, 'bpmn:FlowElement')) {\n\n    if (newParent) {\n\n      if (is(newParent, 'bpmn:Participant')) {\n        newParent = newParent.processRef;\n      } else\n\n      if (is(newParent, 'bpmn:Lane')) {\n        do {\n\n          // unwrap Lane -> LaneSet -> (Lane | FlowElementsContainer)\n          newParent = newParent.$parent.$parent;\n        } while (is(newParent, 'bpmn:Lane'));\n\n      }\n    }\n\n    containment = 'flowElements';\n\n  } else\n\n  if (is(businessObject, 'bpmn:Artifact')) {\n\n    while (newParent &&\n           !is(newParent, 'bpmn:Process') &&\n           !is(newParent, 'bpmn:SubProcess') &&\n           !is(newParent, 'bpmn:Collaboration')) {\n\n      if (is(newParent, 'bpmn:Participant')) {\n        newParent = newParent.processRef;\n        break;\n      } else {\n        newParent = newParent.$parent;\n      }\n    }\n\n    containment = 'artifacts';\n  } else\n\n  if (is(businessObject, 'bpmn:MessageFlow')) {\n    containment = 'messageFlows';\n\n  } else\n\n  if (is(businessObject, 'bpmn:Participant')) {\n    containment = 'participants';\n\n    // make sure the participants process is properly attached / detached\n    // from the XML document\n\n    var process = businessObject.processRef,\n        definitions;\n\n    if (process) {\n      definitions = getDefinitions(businessObject.$parent || newParent);\n\n      if (businessObject.$parent) {\n        collectionRemove(definitions.get('rootElements'), process);\n        process.$parent = null;\n      }\n\n      if (newParent) {\n        collectionAdd(definitions.get('rootElements'), process);\n        process.$parent = definitions;\n      }\n    }\n  } else\n\n  if (is(businessObject, 'bpmn:DataOutputAssociation')) {\n    containment = 'dataOutputAssociations';\n  } else\n\n  if (is(businessObject, 'bpmn:DataInputAssociation')) {\n    containment = 'dataInputAssociations';\n  }\n\n  if (!containment) {\n    throw new Error(translate(\n      'no parent for {element} in {parent}',\n      {\n        element: businessObject.id,\n        parent: newParent.id\n      }\n    ));\n  }\n\n  var children;\n\n  if (businessObject.$parent) {\n\n    // remove from old parent\n    children = businessObject.$parent.get(containment);\n    collectionRemove(children, businessObject);\n  }\n\n  if (!newParent) {\n    businessObject.$parent = null;\n  } else {\n\n    // add to new parent\n    children = newParent.get(containment);\n    children.push(businessObject);\n    businessObject.$parent = newParent;\n  }\n\n  if (visualParent) {\n    var diChildren = visualParent.get(containment);\n\n    collectionRemove(children, businessObject);\n\n    if (newParent) {\n\n      if (!diChildren) {\n        diChildren = [];\n        newParent.set(containment, diChildren);\n      }\n\n      diChildren.push(businessObject);\n    }\n  }\n};\n\n\nBpmnUpdater.prototype.updateConnectionWaypoints = function(connection) {\n  connection.businessObject.di.set('waypoint', this._bpmnFactory.createDiWaypoints(connection.waypoints));\n};\n\n\nBpmnUpdater.prototype.updateConnection = function(context) {\n\n  var connection = context.connection,\n      businessObject = getBusinessObject(connection),\n      newSource = getBusinessObject(connection.source),\n      newTarget = getBusinessObject(connection.target),\n      visualParent;\n\n  if (!is(businessObject, 'bpmn:DataAssociation')) {\n\n    var inverseSet = is(businessObject, 'bpmn:SequenceFlow');\n\n    if (businessObject.sourceRef !== newSource) {\n      if (inverseSet) {\n        collectionRemove(businessObject.sourceRef && businessObject.sourceRef.get('outgoing'), businessObject);\n\n        if (newSource && newSource.get('outgoing')) {\n          newSource.get('outgoing').push(businessObject);\n        }\n      }\n\n      businessObject.sourceRef = newSource;\n    }\n\n    if (businessObject.targetRef !== newTarget) {\n      if (inverseSet) {\n        collectionRemove(businessObject.targetRef && businessObject.targetRef.get('incoming'), businessObject);\n\n        if (newTarget && newTarget.get('incoming')) {\n          newTarget.get('incoming').push(businessObject);\n        }\n      }\n\n      businessObject.targetRef = newTarget;\n    }\n  } else\n\n  if (is(businessObject, 'bpmn:DataInputAssociation')) {\n\n    // handle obnoxious isMsome sourceRef\n    businessObject.get('sourceRef')[0] = newSource;\n\n    visualParent = context.parent || context.newParent || newTarget;\n\n    this.updateSemanticParent(businessObject, newTarget, visualParent);\n  } else\n\n  if (is(businessObject, 'bpmn:DataOutputAssociation')) {\n    visualParent = context.parent || context.newParent || newSource;\n\n    this.updateSemanticParent(businessObject, newSource, visualParent);\n\n    // targetRef = new target\n    businessObject.targetRef = newTarget;\n  }\n\n  this.updateConnectionWaypoints(connection);\n\n  this.updateDiConnection(businessObject.di, newSource, newTarget);\n};\n\n\n// helpers //////////////////////\n\nBpmnUpdater.prototype._getLabel = function(di) {\n  if (!di.label) {\n    di.label = this._bpmnFactory.createDiLabel();\n  }\n\n  return di.label;\n};\n\n\n/**\n * Make sure the event listener is only called\n * if the touched element is a BPMN element.\n *\n * @param  {Function} fn\n * @return {Function} guarded function\n */\nfunction ifBpmn(fn) {\n\n  return function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection;\n\n    if (is(element, 'bpmn:BaseElement')) {\n      fn(event);\n    }\n  };\n}\n","import {\n  assign,\n  forEach,\n  isObject\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  isExpanded\n} from '../../util/DiUtil';\n\nimport BaseElementFactory from 'diagram-js/lib/core/ElementFactory';\n\nimport {\n  DEFAULT_LABEL_SIZE\n} from '../../util/LabelUtil';\n\n\n/**\n * A bpmn-aware factory for diagram-js shapes\n */\nexport default function ElementFactory(bpmnFactory, moddle, translate) {\n  BaseElementFactory.call(this);\n\n  this._bpmnFactory = bpmnFactory;\n  this._moddle = moddle;\n  this._translate = translate;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\nElementFactory.$inject = [\n  'bpmnFactory',\n  'moddle',\n  'translate'\n];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function(elementType, attrs) {\n\n  // no special magic for labels,\n  // we assume their businessObjects have already been created\n  // and wired via attrs\n  if (elementType === 'label') {\n    return this.baseCreate(elementType, assign({ type: 'label' }, DEFAULT_LABEL_SIZE, attrs));\n  }\n\n  return this.createBpmnElement(elementType, attrs);\n};\n\nElementFactory.prototype.createBpmnElement = function(elementType, attrs) {\n  var size,\n      translate = this._translate;\n\n  attrs = attrs || {};\n\n  var businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error(translate('no shape type specified'));\n    }\n\n    businessObject = this._bpmnFactory.create(attrs.type);\n  }\n\n  if (!businessObject.di) {\n    if (elementType === 'root') {\n      businessObject.di = this._bpmnFactory.createDiPlane(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    } else\n    if (elementType === 'connection') {\n      businessObject.di = this._bpmnFactory.createDiEdge(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    } else {\n      businessObject.di = this._bpmnFactory.createDiShape(businessObject, {}, {\n        id: businessObject.id + '_di'\n      });\n    }\n  }\n\n  if (is(businessObject, 'bpmn:Group')) {\n    attrs = assign({\n      isFrame: true\n    }, attrs);\n  }\n\n  if (attrs.di) {\n    assign(businessObject.di, attrs.di);\n\n    delete attrs.di;\n  }\n\n  applyAttributes(businessObject, attrs, [\n    'processRef',\n    'isInterrupting',\n    'associationDirection',\n    'isForCompensation'\n  ]);\n\n  if (attrs.isExpanded) {\n    applyAttribute(businessObject.di, attrs, 'isExpanded');\n  }\n\n  if (is(businessObject, 'bpmn:ExclusiveGateway')) {\n    businessObject.di.isMarkerVisible = true;\n  }\n\n  var eventDefinitions,\n      newEventDefinition;\n\n  if (attrs.eventDefinitionType) {\n    eventDefinitions = businessObject.get('eventDefinitions') || [];\n    newEventDefinition = this._bpmnFactory.create(attrs.eventDefinitionType);\n\n    if (attrs.eventDefinitionType === 'bpmn:ConditionalEventDefinition') {\n      newEventDefinition.condition = this._bpmnFactory.create('bpmn:FormalExpression');\n    }\n\n    eventDefinitions.push(newEventDefinition);\n\n    newEventDefinition.$parent = businessObject;\n    businessObject.eventDefinitions = eventDefinitions;\n\n    delete attrs.eventDefinitionType;\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign({\n    businessObject: businessObject,\n    id: businessObject.id\n  }, size, attrs);\n\n  return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(semantic) {\n\n  if (is(semantic, 'bpmn:SubProcess')) {\n\n    if (isExpanded(semantic)) {\n      return { width: 350, height: 200 };\n    } else {\n      return { width: 100, height: 80 };\n    }\n  }\n\n  if (is(semantic, 'bpmn:Task')) {\n    return { width: 100, height: 80 };\n  }\n\n  if (is(semantic, 'bpmn:Gateway')) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:Event')) {\n    return { width: 36, height: 36 };\n  }\n\n  if (is(semantic, 'bpmn:Participant')) {\n    if (isExpanded(semantic)) {\n      return { width: 600, height: 250 };\n    } else {\n      return { width: 400, height: 60 };\n    }\n  }\n\n  if (is(semantic, 'bpmn:Lane')) {\n    return { width: 400, height: 100 };\n  }\n\n  if (is(semantic, 'bpmn:DataObjectReference')) {\n    return { width: 36, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:DataStoreReference')) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:TextAnnotation')) {\n    return { width: 100, height: 30 };\n  }\n\n  if (is(semantic, 'bpmn:Group')) {\n    return { width: 300, height: 300 };\n  }\n\n  return { width: 100, height: 80 };\n};\n\n\n/**\n * Create participant.\n *\n * @param {boolean|Object} [attrs] attrs\n *\n * @returns {djs.model.Shape}\n */\nElementFactory.prototype.createParticipantShape = function(attrs) {\n\n  if (!isObject(attrs)) {\n    attrs = { isExpanded: attrs };\n  }\n\n  attrs = assign({ type: 'bpmn:Participant' }, attrs || {});\n\n  // participants are expanded by default\n  if (attrs.isExpanded !== false) {\n    attrs.processRef = this._bpmnFactory.create('bpmn:Process');\n  }\n\n  return this.createShape(attrs);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Apply attributes from a map to the given element,\n * remove attribute from the map on application.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {Array<String>} attributeNames name of attributes to apply\n */\nfunction applyAttributes(element, attrs, attributeNames) {\n\n  forEach(attributeNames, function(property) {\n    if (attrs[property] !== undefined) {\n      applyAttribute(element, attrs, property);\n    }\n  });\n}\n\n/**\n * Apply named property to element and drain it from the attrs\n * collection.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {String} attributeName to apply\n */\nfunction applyAttribute(element, attrs, attributeName) {\n  element[attributeName] = attrs[attributeName];\n\n  delete attrs[attributeName];\n}","import { forEach } from 'min-dash';\n\n/**\n * A handler that align elements in a certain way.\n *\n */\nexport default function AlignElements(modeling, canvas) {\n  this._modeling = modeling;\n  this._canvas = canvas;\n}\n\nAlignElements.$inject = [ 'modeling', 'canvas' ];\n\n\nAlignElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var elements = context.elements,\n      alignment = context.alignment;\n\n\n  forEach(elements, function(element) {\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    if (alignment.left) {\n      delta.x = alignment.left - element.x;\n\n    } else if (alignment.right) {\n      delta.x = (alignment.right - element.width) - element.x;\n\n    } else if (alignment.center) {\n      delta.x = (alignment.center - Math.round(element.width / 2)) - element.x;\n\n    } else if (alignment.top) {\n      delta.y = alignment.top - element.y;\n\n    } else if (alignment.bottom) {\n      delta.y = (alignment.bottom - element.height) - element.y;\n\n    } else if (alignment.middle) {\n      delta.y = (alignment.middle - Math.round(element.height / 2)) - element.y;\n    }\n\n    modeling.moveElements([ element ], delta, element.parent);\n  });\n};\n\nAlignElements.prototype.postExecute = function(context) {\n\n};\n","import { some } from 'min-dash';\n\n\n/**\n * A handler that implements reversible appending of shapes\n * to a source shape.\n *\n * @param {canvas} Canvas\n * @param {elementFactory} ElementFactory\n * @param {modeling} Modeling\n */\nexport default function AppendShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nAppendShapeHandler.$inject = [ 'modeling' ];\n\n\n// api //////////////////////\n\n\n/**\n * Creates a new shape\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.shape the new shape\n * @param {ElementDescriptor} context.source the source object\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nAppendShapeHandler.prototype.preExecute = function(context) {\n\n  var source = context.source;\n\n  if (!source) {\n    throw new Error('source required');\n  }\n\n  var target = context.target || source.parent,\n      shape = context.shape;\n\n  shape = context.shape =\n    this._modeling.createShape(\n      shape,\n      context.position,\n      target, { attach: context.attach });\n\n  context.shape = shape;\n};\n\nAppendShapeHandler.prototype.postExecute = function(context) {\n  var parent = context.connectionParent || context.shape.parent;\n\n  if (!existsConnection(context.source, context.shape)) {\n\n    // create connection\n    this._modeling.connect(context.source, context.shape, context.connection, parent);\n  }\n};\n\n\nfunction existsConnection(source, target) {\n  return some(source.outgoing, function(c) {\n    return c.target === target;\n  });\n}","export default function CreateConnectionHandler(canvas, layouter) {\n  this._canvas = canvas;\n  this._layouter = layouter;\n}\n\nCreateConnectionHandler.$inject = [ 'canvas', 'layouter' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.element.Base} context.source the source object\n * @param {djs.element.Base} context.target the parent object\n * @param {Point} context.position position of the new element\n */\nCreateConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      source = context.source,\n      target = context.target,\n      parent = context.parent,\n      parentIndex = context.parentIndex,\n      hints = context.hints;\n\n  if (!source || !target) {\n    throw new Error('source and target required');\n  }\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  connection.source = source;\n  connection.target = target;\n\n  if (!connection.waypoints) {\n    connection.waypoints = this._layouter.layoutConnection(connection, hints);\n  }\n\n  // add connection\n  this._canvas.addConnection(connection, parent, parentIndex);\n\n  return connection;\n};\n\nCreateConnectionHandler.prototype.revert = function(context) {\n  var connection = context.connection;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};","import {\r\n  assign,\r\n  forEach,\r\n  isNumber,\r\n  map,\r\n  pick,\r\n  values\r\n} from 'min-dash';\r\n\r\nimport {\r\n  getBBox,\r\n  getParents\r\n} from '../../../util/Elements';\r\n\r\nvar round = Math.round;\r\n\r\nexport default function CreateElementsHandler(modeling) {\r\n  this._modeling = modeling;\r\n}\r\n\r\nCreateElementsHandler.$inject = [\r\n  'modeling'\r\n];\r\n\r\nCreateElementsHandler.prototype.preExecute = function(context) {\r\n  var elements = context.elements,\r\n      parent = context.parent,\r\n      parentIndex = context.parentIndex,\r\n      position = context.position,\r\n      hints = context.hints;\r\n\r\n  var modeling = this._modeling;\r\n\r\n  // make sure each element has x and y\r\n  forEach(elements, function(element) {\r\n    if (!isNumber(element.x)) {\r\n      element.x = 0;\r\n    }\r\n\r\n    if (!isNumber(element.y)) {\r\n      element.y = 0;\r\n    }\r\n  });\r\n\r\n  var bbox = getBBox(elements);\r\n\r\n  // center elements around position\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      element.waypoints = map(element.waypoints, function(waypoint) {\r\n        return {\r\n          x: round(waypoint.x - bbox.x - bbox.width / 2 + position.x),\r\n          y: round(waypoint.y - bbox.y - bbox.height / 2 + position.y)\r\n        };\r\n      });\r\n    }\r\n\r\n    assign(element, {\r\n      x: round(element.x - bbox.x - bbox.width / 2 + position.x),\r\n      y: round(element.y - bbox.y - bbox.height / 2 + position.y)\r\n    });\r\n  });\r\n\r\n  var parents = getParents(elements);\r\n\r\n  var cache = {};\r\n\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      cache[ element.id ] = isNumber(parentIndex) ?\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          parentIndex,\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        ) :\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        );\r\n\r\n      return;\r\n    }\r\n\r\n    var createShapeHints = assign({}, hints);\r\n\r\n    if (parents.indexOf(element) === -1) {\r\n      createShapeHints.autoResize = false;\r\n    }\r\n\r\n    cache[ element.id ] = isNumber(parentIndex) ?\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        parentIndex,\r\n        createShapeHints\r\n      ) :\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        createShapeHints\r\n      );\r\n  });\r\n\r\n  context.elements = values(cache);\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}","import { assign } from 'min-dash';\n\nvar round = Math.round;\n\n\n/**\n * A handler that implements reversible addition of shapes.\n *\n * @param {canvas} Canvas\n */\nexport default function CreateShapeHandler(canvas) {\n  this._canvas = canvas;\n}\n\nCreateShapeHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.model.Base} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      positionOrBounds = context.position,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  if (!positionOrBounds) {\n    throw new Error('position required');\n  }\n\n  // (1) add at event center position _or_ at given bounds\n  if (positionOrBounds.width !== undefined) {\n    assign(shape, positionOrBounds);\n  } else {\n    assign(shape, {\n      x: positionOrBounds.x - round(shape.width / 2),\n      y: positionOrBounds.y - round(shape.height / 2)\n    });\n  }\n\n  // (2) add to canvas\n  this._canvas.addShape(shape, parent, parentIndex);\n\n  return shape;\n};\n\n\n/**\n * Undo append by removing the shape\n */\nCreateShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape;\n\n  // (3) remove form canvas\n  this._canvas.removeShape(shape);\n\n  return shape;\n};","import inherits from 'inherits';\n\nimport CreateShapeHandler from './CreateShapeHandler';\n\n\n/**\n * A handler that attaches a label to a given target shape.\n *\n * @param {Canvas} canvas\n */\nexport default function CreateLabelHandler(canvas) {\n  CreateShapeHandler.call(this, canvas);\n}\n\ninherits(CreateLabelHandler, CreateShapeHandler);\n\nCreateLabelHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\nvar originalExecute = CreateShapeHandler.prototype.execute;\n\n/**\n * Appends a label to a target shape.\n *\n * @method CreateLabelHandler#execute\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.target the element the label is attached to\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateLabelHandler.prototype.execute = function(context) {\n\n  var label = context.shape;\n\n  ensureValidDimensions(label);\n\n  label.labelTarget = context.labelTarget;\n\n  return originalExecute.call(this, context);\n};\n\nvar originalRevert = CreateShapeHandler.prototype.revert;\n\n/**\n * Undo append by removing the shape\n */\nCreateLabelHandler.prototype.revert = function(context) {\n  context.shape.labelTarget = null;\n\n  return originalRevert.call(this, context);\n};\n\n\n// helpers //////////////////////\n\nfunction ensureValidDimensions(label) {\n\n  // make sure a label has valid { width, height } dimensions\n  [ 'width', 'height' ].forEach(function(prop) {\n    if (typeof label[prop] === 'undefined') {\n      label[prop] = 0;\n    }\n  });\n}","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible deletion of Connections.\n */\nexport default function DeleteConnectionHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteConnectionHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nDeleteConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      parent = connection.parent;\n\n  context.parent = parent;\n\n  // remember containment\n  context.parentIndex = collectionIdx(parent.children, connection);\n\n  context.source = connection.source;\n  context.target = connection.target;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};\n\n/**\n * Command revert implementation.\n */\nDeleteConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  connection.source = context.source;\n  connection.target = context.target;\n\n  // restore containment\n  collectionAdd(parent.children, connection, parentIndex);\n\n  this._canvas.addConnection(connection, parent);\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nexport default function DeleteElementsHandler(modeling, elementRegistry) {\n  this._modeling = modeling;\n  this._elementRegistry = elementRegistry;\n}\n\nDeleteElementsHandler.$inject = [\n  'modeling',\n  'elementRegistry'\n];\n\n\nDeleteElementsHandler.prototype.postExecute = function(context) {\n\n  var modeling = this._modeling,\n      elementRegistry = this._elementRegistry,\n      elements = context.elements;\n\n  forEach(elements, function(element) {\n\n    // element may have been removed with previous\n    // remove operations already (e.g. in case of nesting)\n    if (!elementRegistry.get(element.id)) {\n      return;\n    }\n\n    if (element.waypoints) {\n      modeling.removeConnection(element);\n    } else {\n      modeling.removeShape(element);\n    }\n  });\n};","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\nimport { saveClear } from '../../../util/Removal';\n\n\n/**\n * A handler that implements reversible deletion of shapes.\n *\n */\nexport default function DeleteShapeHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteShapeHandler.$inject = [ 'canvas', 'modeling' ];\n\n\n/**\n * - Remove connections\n * - Remove all direct children\n */\nDeleteShapeHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling;\n\n  var shape = context.shape;\n\n  // remove connections\n  saveClear(shape.incoming, function(connection) {\n\n    // To make sure that the connection isn't removed twice\n    // For example if a container is removed\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  saveClear(shape.outgoing, function(connection) {\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  // remove child shapes and connections\n  saveClear(shape.children, function(child) {\n    if (isConnection(child)) {\n      modeling.removeConnection(child, { nested: true });\n    } else {\n      modeling.removeShape(child, { nested: true });\n    }\n  });\n};\n\n/**\n * Remove shape and remember the parent\n */\nDeleteShapeHandler.prototype.execute = function(context) {\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = shape.parent;\n\n  context.oldParent = oldParent;\n\n  // remove containment\n  context.oldParentIndex = collectionIdx(oldParent.children, shape);\n\n  // remove shape\n  canvas.removeShape(shape);\n\n  return shape;\n};\n\n\n/**\n * Command revert implementation\n */\nDeleteShapeHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex;\n\n  // restore containment\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  canvas.addShape(shape, oldParent);\n\n  return shape;\n};\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import {\n  forEach,\n  sortBy\n} from 'min-dash';\n\n\n/**\n * A handler that distributes elements evenly.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\nvar OFF_AXIS = {\n  x: 'y',\n  y: 'x'\n};\n\nDistributeElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var groups = context.groups,\n      axis = context.axis,\n      dimension = context.dimension;\n\n  function updateRange(group, element) {\n    group.range.min = Math.min(element[axis], group.range.min);\n    group.range.max = Math.max(element[axis] + element[dimension], group.range.max);\n  }\n\n  function center(element) {\n    return element[axis] + element[dimension] / 2;\n  }\n\n  function lastIdx(arr) {\n    return arr.length - 1;\n  }\n\n  function rangeDiff(range) {\n    return range.max - range.min;\n  }\n\n  function centerElement(refCenter, element) {\n    var delta = { y: 0 };\n\n    delta[axis] = refCenter - center(element);\n\n    if (delta[axis]) {\n\n      delta[OFF_AXIS[axis]] = 0;\n\n      modeling.moveElements([ element ], delta, element.parent);\n    }\n  }\n\n  var firstGroup = groups[0],\n      lastGroupIdx = lastIdx(groups),\n      lastGroup = groups[ lastGroupIdx ];\n\n  var margin,\n      spaceInBetween,\n      groupsSize = 0; // the size of each range\n\n  forEach(groups, function(group, idx) {\n    var sortedElements,\n        refElem,\n        refCenter;\n\n    if (group.elements.length < 2) {\n      if (idx && idx !== groups.length - 1) {\n        updateRange(group, group.elements[0]);\n\n        groupsSize += rangeDiff(group.range);\n      }\n      return;\n    }\n\n    sortedElements = sortBy(group.elements, axis);\n\n    refElem = sortedElements[0];\n\n    if (idx === lastGroupIdx) {\n      refElem = sortedElements[lastIdx(sortedElements)];\n    }\n\n    refCenter = center(refElem);\n\n    // wanna update the ranges after the shapes have been centered\n    group.range = null;\n\n    forEach(sortedElements, function(element) {\n\n      centerElement(refCenter, element);\n\n      if (group.range === null) {\n        group.range = {\n          min: element[axis],\n          max: element[axis] + element[dimension]\n        };\n\n        return;\n      }\n\n      // update group's range after centering the range elements\n      updateRange(group, element);\n    });\n\n    if (idx && idx !== groups.length - 1) {\n      groupsSize += rangeDiff(group.range);\n    }\n  });\n\n  spaceInBetween = Math.abs(lastGroup.range.min - firstGroup.range.max);\n\n  margin = Math.round((spaceInBetween - groupsSize) / (groups.length - 1));\n\n  if (margin < groups.length - 1) {\n    return;\n  }\n\n  forEach(groups, function(group, groupIdx) {\n    var delta = {},\n        prevGroup;\n\n    if (group === firstGroup || group === lastGroup) {\n      return;\n    }\n\n    prevGroup = groups[groupIdx - 1];\n\n    group.range.max = 0;\n\n    forEach(group.elements, function(element, idx) {\n      delta[OFF_AXIS[axis]] = 0;\n      delta[axis] = (prevGroup.range.max - element[axis]) + margin;\n\n      if (group.range.min !== element[axis]) {\n        delta[axis] += element[axis] - group.range.min;\n      }\n\n      if (delta[axis]) {\n        modeling.moveElements([ element ], delta, element.parent);\n      }\n\n      group.range.max = Math.max(element[axis] + element[dimension], idx ? group.range.max : 0);\n    });\n  });\n};\n\nDistributeElements.prototype.postExecute = function(context) {\n\n};\n","import { assign } from 'min-dash';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function LayoutConnectionHandler(layouter, canvas) {\n  this._layouter = layouter;\n  this._canvas = canvas;\n}\n\nLayoutConnectionHandler.$inject = [ 'layouter', 'canvas' ];\n\nLayoutConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection;\n\n  var oldWaypoints = connection.waypoints;\n\n  assign(context, {\n    oldWaypoints: oldWaypoints\n  });\n\n  connection.waypoints = this._layouter.layoutConnection(connection, context.hints);\n\n  return connection;\n};\n\nLayoutConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection;\n\n  connection.waypoints = context.oldWaypoints;\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible moving of connections.\n *\n * The handler differs from the layout connection handler in a sense\n * that it preserves the connection layout.\n */\nexport default function MoveConnectionHandler() { }\n\n\nMoveConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      delta = context.delta;\n\n  var newParent = context.newParent || connection.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = connection.parent;\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, connection);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, connection, newParentIndex);\n\n  // update parent\n  connection.parent = newParent;\n\n  // update waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x += delta.x;\n    p.y += delta.y;\n\n    if (p.original) {\n      p.original.x += delta.x;\n      p.original.y += delta.y;\n    }\n  });\n\n  return connection;\n};\n\nMoveConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      newParent = connection.parent,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // remove from newParent\n  collectionRemove(newParent.children, connection);\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, connection, oldParentIndex);\n\n  // restore parent\n  connection.parent = oldParent;\n\n  // revert to old waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x -= delta.x;\n    p.y -= delta.y;\n\n    if (p.original) {\n      p.original.x -= delta.x;\n      p.original.y -= delta.y;\n    }\n  });\n\n  return connection;\n};","import {\n  getNewAttachPoint\n} from '../../../../util/AttachUtil';\n\n\nexport function getResizedSourceAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[0];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getResizedTargetAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[waypoints.length - 1];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getMovedSourceAnchor(connection, source, moveDelta) {\n  return getResizedSourceAnchor(connection, source, substractPosition(source, moveDelta));\n}\n\n\nexport function getMovedTargetAnchor(connection, target, moveDelta) {\n  return getResizedTargetAnchor(connection, target, substractPosition(target, moveDelta));\n}\n\n\n// helpers //////////////////////\n\nfunction substractPosition(bounds, delta) {\n  return {\n    x: bounds.x - delta.x,\n    y: bounds.y - delta.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n}\n\n\n/**\n * Return waypoints of given connection; throw if non exists (should not happen!!).\n *\n * @param {Connection} connection\n *\n * @return {Array<Point>}\n */\nfunction safeGetWaypoints(connection) {\n\n  var waypoints = connection.waypoints;\n\n  if (!waypoints.length) {\n    throw new Error('connection#' + connection.id + ': no waypoints');\n  }\n\n  return waypoints;\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getClosure\n} from '../../../../util/Elements';\n\n\nexport default function MoveClosure() {\n\n  this.allShapes = {};\n  this.allConnections = {};\n\n  this.enclosedElements = {};\n  this.enclosedConnections = {};\n\n  this.topLevel = {};\n}\n\n\nMoveClosure.prototype.add = function(element, isTopLevel) {\n  return this.addAll([ element ], isTopLevel);\n};\n\n\nMoveClosure.prototype.addAll = function(elements, isTopLevel) {\n\n  var newClosure = getClosure(elements, !!isTopLevel, this);\n\n  assign(this, newClosure);\n\n  return this;\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './AnchorsHelper';\n\nimport MoveClosure from './MoveClosure';\n\n\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\nMoveHelper.prototype.moveRecursive = function(elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\nMoveHelper.prototype.moveClosure = function(closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  }\n\n  // move all shapes\n  forEach(allShapes, function(shape) {\n\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  });\n\n  // move all child connections / layout external connections\n  forEach(allConnections, function(c) {\n\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\nMoveHelper.prototype.getClosure = function(elements) {\n  return new MoveClosure().addAll(elements, true);\n};","import MoveHelper from './helper/MoveHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveElementsHandler(modeling) {\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveElementsHandler.$inject = [ 'modeling' ];\n\nMoveElementsHandler.prototype.preExecute = function(context) {\n  context.closure = this._helper.getClosure(context.shapes);\n};\n\nMoveElementsHandler.prototype.postExecute = function(context) {\n\n  var hints = context.hints,\n      primaryShape;\n\n  if (hints && hints.primaryShape) {\n    primaryShape = hints.primaryShape;\n    hints.oldParent = primaryShape.parent;\n  }\n\n  this._helper.moveClosure(\n    context.closure,\n    context.delta,\n    context.newParent,\n    context.newHost,\n    primaryShape\n  );\n};","import {\n  assign,\n  forEach,\n  pick\n} from 'min-dash';\n\nimport MoveHelper from './helper/MoveHelper';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveShapeHandler(modeling) {\n  this._modeling = modeling;\n\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveShapeHandler.$inject = [ 'modeling' ];\n\n\nMoveShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      newParent = context.newParent || shape.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = shape.parent;\n\n  context.oldBounds = pick(shape, [ 'x', 'y', 'width', 'height']);\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, shape);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, shape, newParentIndex);\n\n  // update shape parent + position\n  assign(shape, {\n    parent: newParent,\n    x: shape.x + delta.x,\n    y: shape.y + delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.postExecute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      hints = context.hints;\n\n  var modeling = this._modeling;\n\n  if (hints.layout !== false) {\n\n    forEach(shape.incoming, function(c) {\n      modeling.layoutConnection(c, {\n        connectionEnd: getMovedTargetAnchor(c, shape, delta)\n      });\n    });\n\n    forEach(shape.outgoing, function(c) {\n      modeling.layoutConnection(c, {\n        connectionStart: getMovedSourceAnchor(c, shape, delta)\n      });\n    });\n  }\n\n  if (hints.recurse !== false) {\n    this.moveChildren(context);\n  }\n};\n\nMoveShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  // revert to old position and parent\n  assign(shape, {\n    parent: oldParent,\n    x: shape.x - delta.x,\n    y: shape.y - delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.moveChildren = function(context) {\n\n  var delta = context.delta,\n      shape = context.shape;\n\n  this._helper.moveRecursive(shape.children, delta, null);\n};\n\nMoveShapeHandler.prototype.getNewParent = function(context) {\n  return context.newParent || context.shape.parent;\n};\n","import { isArray } from 'min-dash';\n\n\n/**\n * Reconnect connection handler\n */\nexport default function ReconnectConnectionHandler(modeling) {\n  this._modeling = modeling;\n}\n\nReconnectConnectionHandler.$inject = [ 'modeling' ];\n\nReconnectConnectionHandler.prototype.execute = function(context) {\n  var newSource = context.newSource,\n      newTarget = context.newTarget,\n      connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints;\n\n  if (!newSource && !newTarget) {\n    throw new Error('newSource or newTarget required');\n  }\n\n  if (isArray(dockingOrPoints)) {\n    context.oldWaypoints = connection.waypoints;\n    connection.waypoints = dockingOrPoints;\n  }\n\n  if (newSource) {\n    context.oldSource = connection.source;\n    connection.source = newSource;\n  }\n\n  if (newTarget) {\n    context.oldTarget = connection.target;\n    connection.target = newTarget;\n  }\n\n  return connection;\n};\n\nReconnectConnectionHandler.prototype.postExecute = function(context) {\n  var connection = context.connection,\n      newSource = context.newSource,\n      newTarget = context.newTarget,\n      dockingOrPoints = context.dockingOrPoints,\n      hints = context.hints || {};\n\n  if (hints.layoutConnection === false) {\n    return;\n  }\n\n  var layoutConnectionHints = {};\n\n  if (newSource && (!newTarget || hints.docking === 'source')) {\n    layoutConnectionHints.connectionStart = getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ 0 ] : dockingOrPoints);\n  }\n\n  if (newTarget && (!newSource || hints.docking === 'target')) {\n    layoutConnectionHints.connectionEnd = getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ dockingOrPoints.length - 1 ] : dockingOrPoints);\n  }\n\n  if (hints.newWaypoints) {\n    layoutConnectionHints.waypoints = hints.newWaypoints;\n  }\n\n  this._modeling.layoutConnection(connection, layoutConnectionHints);\n};\n\nReconnectConnectionHandler.prototype.revert = function(context) {\n  var oldSource = context.oldSource,\n      oldTarget = context.oldTarget,\n      oldWaypoints = context.oldWaypoints,\n      connection = context.connection;\n\n  if (oldSource) {\n    connection.source = oldSource;\n  }\n\n  if (oldTarget) {\n    connection.target = oldTarget;\n  }\n\n  if (oldWaypoints) {\n    connection.waypoints = oldWaypoints;\n  }\n\n  return connection;\n};\n\n\n\n// helpers //////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}","import { forEach } from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n/**\n * Replace shape by adding new shape and removing old shape. Incoming and outgoing connections will\n * be kept if possible.\n *\n * @class\n * @constructor\n *\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function ReplaceShapeHandler(modeling, rules) {\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\nReplaceShapeHandler.$inject = [ 'modeling', 'rules' ];\n\n\n/**\n * Add new shape.\n *\n * @param {Object} context\n * @param {djs.model.Shape} context.oldShape\n * @param {Object} context.newData\n * @param {string} context.newData.type\n * @param {number} context.newData.x\n * @param {number} context.newData.y\n * @param {Object} [hints]\n */\nReplaceShapeHandler.prototype.preExecute = function(context) {\n  var self = this,\n      modeling = this._modeling,\n      rules = this._rules;\n\n  var oldShape = context.oldShape,\n      newData = context.newData,\n      hints = context.hints || {},\n      newShape;\n\n  function canReconnect(source, target, connection) {\n    return rules.allowed('connection.reconnect', {\n      connection: connection,\n      source: source,\n      target: target\n    });\n  }\n\n  // (1) add new shape at given position\n  var position = {\n    x: newData.x,\n    y: newData.y\n  };\n\n  var oldBounds = {\n    x: oldShape.x,\n    y: oldShape.y,\n    width: oldShape.width,\n    height: oldShape.height\n  };\n\n  newShape = context.newShape =\n    context.newShape ||\n    self.createShape(newData, position, oldShape.parent, hints);\n\n  // (2) update host\n  if (oldShape.host) {\n    modeling.updateAttachment(newShape, oldShape.host);\n  }\n\n  // (3) adopt all children from old shape\n  var children;\n\n  if (hints.moveChildren !== false) {\n    children = oldShape.children.slice();\n\n    modeling.moveElements(children, { x: 0, y: 0 }, newShape, hints);\n  }\n\n  // (4) reconnect connections to new shape if possible\n  var incoming = oldShape.incoming.slice(),\n      outgoing = oldShape.outgoing.slice();\n\n  forEach(incoming, function(connection) {\n    var source = connection.source,\n        allowed = canReconnect(source, newShape, connection);\n\n    if (allowed) {\n      self.reconnectEnd(\n        connection, newShape,\n        getResizedTargetAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n\n  forEach(outgoing, function(connection) {\n    var target = connection.target,\n        allowed = canReconnect(newShape, target, connection);\n\n    if (allowed) {\n      self.reconnectStart(\n        connection, newShape,\n        getResizedSourceAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n};\n\n\n/**\n * Remove old shape.\n */\nReplaceShapeHandler.prototype.postExecute = function(context) {\n  var oldShape = context.oldShape;\n\n  this._modeling.removeShape(oldShape);\n};\n\n\nReplaceShapeHandler.prototype.execute = function(context) {};\n\n\nReplaceShapeHandler.prototype.revert = function(context) {};\n\n\nReplaceShapeHandler.prototype.createShape = function(shape, position, target, hints) {\n  return this._modeling.createShape(shape, position, target, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectStart = function(connection, newSource, dockingPoint, hints) {\n  this._modeling.reconnectStart(connection, newSource, dockingPoint, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectEnd = function(connection, newTarget, dockingPoint, hints) {\n  this._modeling.reconnectEnd(connection, newTarget, dockingPoint, hints);\n};\n","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible resizing of shapes.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nResizeShapeHandler.$inject = [ 'modeling' ];\n\n/**\n * {\n *   shape: {....}\n *   newBounds: {\n *     width:  20,\n *     height: 40,\n *     x:       5,\n *     y:      10\n *   }\n *\n * }\n */\nResizeShapeHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      minBounds = context.minBounds;\n\n  if (newBounds.x === undefined || newBounds.y === undefined ||\n      newBounds.width === undefined || newBounds.height === undefined) {\n    throw new Error('newBounds must have {x, y, width, height} properties');\n  }\n\n  if (minBounds && (newBounds.width < minBounds.width\n    || newBounds.height < minBounds.height)) {\n    throw new Error('width and height cannot be less than minimum height and width');\n  } else if (!minBounds\n    && newBounds.width < 10 || newBounds.height < 10) {\n    throw new Error('width and height cannot be less than 10px');\n  }\n\n  // save old bbox in context\n  context.oldBounds = {\n    width:  shape.width,\n    height: shape.height,\n    x:      shape.x,\n    y:      shape.y\n  };\n\n  // update shape\n  assign(shape, {\n    width:  newBounds.width,\n    height: newBounds.height,\n    x:      newBounds.x,\n    y:      newBounds.y\n  });\n\n  return shape;\n};\n\nResizeShapeHandler.prototype.postExecute = function(context) {\n  var modeling = this._modeling;\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds,\n      hints = context.hints || {};\n\n  if (hints.layout === false) {\n    return;\n  }\n\n  forEach(shape.incoming, function(c) {\n    modeling.layoutConnection(c, {\n      connectionEnd: getResizedTargetAnchor(c, shape, oldBounds)\n    });\n  });\n\n  forEach(shape.outgoing, function(c) {\n    modeling.layoutConnection(c, {\n      connectionStart: getResizedSourceAnchor(c, shape, oldBounds)\n    });\n  });\n\n};\n\nResizeShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds;\n\n  // restore previous bbox\n  assign(shape, {\n    width:  oldBounds.width,\n    height: oldBounds.height,\n    x:      oldBounds.x,\n    y:      oldBounds.y\n  });\n\n  return shape;\n};\n","import {\n  assign,\n  forEach,\n  map\n} from 'min-dash';\n\nimport {\n  getWaypointsUpdatingConnections,\n  resizeBounds\n} from '../../space-tool/SpaceUtil';\n\n\n/**\n * Add or remove space by moving and resizing shapes and updating connection waypoints.\n */\nexport default function SpaceToolHandler(modeling) {\n  this._modeling = modeling;\n}\n\nSpaceToolHandler.$inject = [ 'modeling' ];\n\nSpaceToolHandler.prototype.preExecute = function(context) {\n  var delta = context.delta,\n      direction = context.direction,\n      movingShapes = context.movingShapes,\n      resizingShapes = context.resizingShapes,\n      start = context.start;\n\n  // (1) move shapes\n  this.moveShapes(movingShapes, delta);\n\n  // (2) resize shapes\n  this.resizeShapes(resizingShapes, delta, direction);\n\n  // (3) update connection waypoints\n  this.updateConnectionWaypoints(\n    getWaypointsUpdatingConnections(movingShapes, resizingShapes),\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes\n  );\n};\n\nSpaceToolHandler.prototype.execute = function() {};\nSpaceToolHandler.prototype.revert = function() {};\n\nSpaceToolHandler.prototype.moveShapes = function(shapes, delta) {\n  var self = this;\n\n  forEach(shapes, function(element) {\n    self._modeling.moveShape(element, delta, null, {\n      autoResize: false,\n      layout: false,\n      recurse: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.resizeShapes = function(shapes, delta, direction) {\n  var self = this;\n\n  forEach(shapes, function(shape) {\n    var newBounds = resizeBounds(shape, direction, delta);\n\n    self._modeling.resizeShape(shape, newBounds, null, {\n      attachSupport: false,\n      autoResize: false,\n      layout: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.updateConnectionWaypoints = function(\n    connections,\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes\n) {\n  var self = this;\n\n  forEach(connections, function(connection) {\n    var source = connection.source,\n        target = connection.target,\n        waypoints = copyWaypoints(connection);\n\n    var axis = getAxisFromDirection(direction);\n\n    // move waypoints\n    waypoints = map(waypoints, function(waypoint, index) {\n      var isFirstWaypoint = index === 0,\n          isLastWaypoint = index === waypoints.length - 1;\n\n      // do NOT move first/last waypoint if source/target NOT moving or resizing\n      if ((isFirstWaypoint && !includes(movingShapes.concat(resizingShapes), source)) ||\n        (isLastWaypoint && !includes(movingShapes.concat(resizingShapes), target))) {\n\n        return waypoint;\n      }\n\n      if ((waypoint[ axis ] > start && /e|s/.test(direction)) ||\n        (waypoint[ axis ] < start) && /n|w/.test(direction)) {\n\n        // move waypoint\n        waypoint[ axis ] = waypoint[ axis ] + delta[ axis ];\n      }\n\n      if (waypoint.original) {\n        if ((waypoint.original[ axis ] > start && /e|s/.test(direction)) ||\n          (waypoint.original[ axis ] < start) && /n|w/.test(direction)) {\n\n          // move waypoint original\n          waypoint.original[ axis ] = waypoint.original[ axis ] + delta[ axis ];\n        }\n      }\n\n      return waypoint;\n    });\n\n    self._modeling.updateWaypoints(connection, waypoints, {\n      labelBehavior: false\n    });\n  });\n};\n\n\n// helpers //////////\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction copyWaypoints(connection) {\n  return map(connection.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction getAxisFromDirection(direction) {\n  switch (direction) {\n  case 'n':\n    return 'y';\n  case 'w':\n    return 'x';\n  case 's':\n    return 'y';\n  case 'e':\n    return 'x';\n  }\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import {\n  assign,\n  forEach\n} from 'min-dash';\n\n/**\n * A handler that toggles the collapsed state of an element\n * and the visibility of all its children.\n *\n * @param {Modeling} modeling\n */\nexport default function ToggleShapeCollapseHandler(modeling) {\n  this._modeling = modeling;\n}\n\nToggleShapeCollapseHandler.$inject = [ 'modeling' ];\n\n\nToggleShapeCollapseHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      children = shape.children;\n\n  // recursively remember previous visibility of children\n  context.oldChildrenVisibility = getElementsVisibilityRecursive(children);\n\n  // toggle state\n  shape.collapsed = !shape.collapsed;\n\n  // recursively hide/show children\n  var result = setHiddenRecursive(children, shape.collapsed);\n\n  return [shape].concat(result);\n};\n\n\nToggleShapeCollapseHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldChildrenVisibility = context.oldChildrenVisibility;\n\n  var children = shape.children;\n\n  // recursively set old visability of children\n  var result = restoreVisibilityRecursive(children, oldChildrenVisibility);\n\n  // retoggle state\n  shape.collapsed = !shape.collapsed;\n\n  return [shape].concat(result);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Return a map { elementId -> hiddenState}.\n *\n * @param {Array<djs.model.Shape>} elements\n *\n * @return {Object}\n */\nfunction getElementsVisibilityRecursive(elements) {\n\n  var result = {};\n\n  forEach(elements, function(element) {\n    result[element.id] = element.hidden;\n\n    if (element.children) {\n      result = assign({}, result, getElementsVisibilityRecursive(element.children));\n    }\n  });\n\n  return result;\n}\n\n\nfunction setHiddenRecursive(elements, newHidden) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = newHidden;\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(setHiddenRecursive(element.children, element.collapsed || newHidden));\n    }\n  });\n\n  return result;\n}\n\nfunction restoreVisibilityRecursive(elements, lastState) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = lastState[element.id];\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(restoreVisibilityRecursive(element.children, lastState));\n    }\n  });\n\n  return result;\n}\n","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n/**\n * A handler that implements reversible attaching/detaching of shapes.\n */\nexport default function UpdateAttachmentHandler(modeling) {\n  this._modeling = modeling;\n}\n\nUpdateAttachmentHandler.$inject = [ 'modeling' ];\n\n\nUpdateAttachmentHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = shape.host;\n\n  // (0) detach from old host\n  context.oldHost = oldHost;\n  context.attacherIdx = removeAttacher(oldHost, shape);\n\n  // (1) attach to new host\n  addAttacher(newHost, shape);\n\n  // (2) update host\n  shape.host = newHost;\n\n  return shape;\n};\n\nUpdateAttachmentHandler.prototype.revert = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = context.oldHost,\n      attacherIdx = context.attacherIdx;\n\n  // (2) update host\n  shape.host = oldHost;\n\n  // (1) attach to new host\n  removeAttacher(newHost, shape);\n\n  // (0) detach from old host\n  addAttacher(oldHost, shape, attacherIdx);\n\n  return shape;\n};\n\n\nfunction removeAttacher(host, attacher) {\n\n  // remove attacher from host\n  return collectionRemove(host && host.attachers, attacher);\n}\n\nfunction addAttacher(host, attacher, idx) {\n\n  if (!host) {\n    return;\n  }\n\n  var attachers = host.attachers;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  collectionAdd(attachers, attacher, idx);\n}\n","export default function UpdateWaypointsHandler() { }\n\nUpdateWaypointsHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      newWaypoints = context.newWaypoints;\n\n  context.oldWaypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  return connection;\n};\n\nUpdateWaypointsHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      oldWaypoints = context.oldWaypoints;\n\n  connection.waypoints = oldWaypoints;\n\n  return connection;\n};","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  Base\n} from '../../model';\n\nimport AlignElementsHandler from './cmd/AlignElementsHandler';\nimport AppendShapeHandler from './cmd/AppendShapeHandler';\nimport CreateConnectionHandler from './cmd/CreateConnectionHandler';\nimport CreateElementsHandler from './cmd/CreateElementsHandler';\nimport CreateLabelHandler from './cmd/CreateLabelHandler';\nimport CreateShapeHandler from './cmd/CreateShapeHandler';\nimport DeleteConnectionHandler from './cmd/DeleteConnectionHandler';\nimport DeleteElementsHandler from './cmd/DeleteElementsHandler';\nimport DeleteShapeHandler from './cmd/DeleteShapeHandler';\nimport DistributeElementsHandler from './cmd/DistributeElementsHandler';\nimport LayoutConnectionHandler from './cmd/LayoutConnectionHandler';\nimport MoveConnectionHandler from './cmd/MoveConnectionHandler';\nimport MoveElementsHandler from './cmd/MoveElementsHandler';\nimport MoveShapeHandler from './cmd/MoveShapeHandler';\nimport ReconnectConnectionHandler from './cmd/ReconnectConnectionHandler';\nimport ReplaceShapeHandler from './cmd/ReplaceShapeHandler';\nimport ResizeShapeHandler from './cmd/ResizeShapeHandler';\nimport SpaceToolHandler from './cmd/SpaceToolHandler';\nimport ToggleShapeCollapseHandler from './cmd/ToggleShapeCollapseHandler';\nimport UpdateAttachmentHandler from './cmd/UpdateAttachmentHandler';\nimport UpdateWaypointsHandler from './cmd/UpdateWaypointsHandler';\n\n\n/**\n * The basic modeling entry point.\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n */\nexport default function Modeling(eventBus, elementFactory, commandStack) {\n  this._eventBus = eventBus;\n  this._elementFactory = elementFactory;\n  this._commandStack = commandStack;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // register modeling handlers\n    self.registerHandlers(commandStack);\n  });\n}\n\nModeling.$inject = [ 'eventBus', 'elementFactory', 'commandStack' ];\n\n\nModeling.prototype.getHandlers = function() {\n  return {\n    'shape.append': AppendShapeHandler,\n    'shape.create': CreateShapeHandler,\n    'shape.delete': DeleteShapeHandler,\n    'shape.move': MoveShapeHandler,\n    'shape.resize': ResizeShapeHandler,\n    'shape.replace': ReplaceShapeHandler,\n    'shape.toggleCollapse': ToggleShapeCollapseHandler,\n\n    'spaceTool': SpaceToolHandler,\n\n    'label.create': CreateLabelHandler,\n\n    'connection.create': CreateConnectionHandler,\n    'connection.delete': DeleteConnectionHandler,\n    'connection.move': MoveConnectionHandler,\n    'connection.layout': LayoutConnectionHandler,\n\n    'connection.updateWaypoints': UpdateWaypointsHandler,\n\n    'connection.reconnect': ReconnectConnectionHandler,\n\n    'elements.create': CreateElementsHandler,\n    'elements.move': MoveElementsHandler,\n    'elements.delete': DeleteElementsHandler,\n\n    'elements.distribute': DistributeElementsHandler,\n    'elements.align': AlignElementsHandler,\n\n    'element.updateAttachment': UpdateAttachmentHandler\n  };\n};\n\n/**\n * Register handlers with the command stack\n *\n * @param {CommandStack} commandStack\n */\nModeling.prototype.registerHandlers = function(commandStack) {\n  forEach(this.getHandlers(), function(handler, id) {\n    commandStack.registerHandler(id, handler);\n  });\n};\n\n\n// modeling helpers //////////////////////\n\nModeling.prototype.moveShape = function(shape, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = null;\n  }\n\n  var context = {\n    shape: shape,\n    delta:  delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.move', context);\n};\n\n\n/**\n * Update the attachment of the given shape.\n *\n * @param {djs.mode.Base} shape\n * @param {djs.model.Base} [newHost]\n */\nModeling.prototype.updateAttachment = function(shape, newHost) {\n  var context = {\n    shape: shape,\n    newHost: newHost\n  };\n\n  this._commandStack.execute('element.updateAttachment', context);\n};\n\n\n/**\n * Move a number of shapes to a new target, either setting it as\n * the new parent or attaching it.\n *\n * @param {Array<djs.mode.Base>} shapes\n * @param {Point} delta\n * @param {djs.model.Base} [target]\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach=false]\n */\nModeling.prototype.moveElements = function(shapes, delta, target, hints) {\n\n  hints = hints || {};\n\n  var attach = hints.attach;\n\n  var newParent = target,\n      newHost;\n\n  if (attach === true) {\n    newHost = target;\n    newParent = target.parent;\n  } else\n\n  if (attach === false) {\n    newHost = null;\n  }\n\n  var context = {\n    shapes: shapes,\n    delta: delta,\n    newParent: newParent,\n    newHost: newHost,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.move', context);\n};\n\n\nModeling.prototype.moveConnection = function(connection, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = undefined;\n  }\n\n  var context = {\n    connection: connection,\n    delta: delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.move', context);\n};\n\n\nModeling.prototype.layoutConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.layout', context);\n};\n\n\n/**\n * Create connection.\n *\n * @param {djs.model.Base} source\n * @param {djs.model.Base} target\n * @param {Number} [parentIndex]\n * @param {Object|djs.model.Connection} connection\n * @param {djs.model.Base} parent\n * @param {Object} hints\n *\n * @return {djs.model.Connection} the created connection.\n */\nModeling.prototype.createConnection = function(source, target, parentIndex, connection, parent, hints) {\n\n  if (typeof parentIndex === 'object') {\n    hints = parent;\n    parent = connection;\n    connection = parentIndex;\n    parentIndex = undefined;\n  }\n\n  connection = this._create('connection', connection);\n\n  var context = {\n    source: source,\n    target: target,\n    parent: parent,\n    parentIndex: parentIndex,\n    connection: connection,\n    hints: hints\n  };\n\n  this._commandStack.execute('connection.create', context);\n\n  return context.connection;\n};\n\n\n/**\n * Create a shape at the specified position.\n *\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape|djs.model.Root} target\n * @param {Number} [parentIndex] position in parents children list\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach] whether to attach to target or become a child\n *\n * @return {djs.model.Shape} the created shape\n */\nModeling.prototype.createShape = function(shape, position, target, parentIndex, hints) {\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var attach = hints.attach,\n      parent,\n      host;\n\n  shape = this._create('shape', shape);\n\n  if (attach) {\n    parent = target.parent;\n    host = target;\n  } else {\n    parent = target;\n  }\n\n  var context = {\n    position: position,\n    shape: shape,\n    parent: parent,\n    parentIndex: parentIndex,\n    host: host,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.create', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.createElements = function(elements, position, parent, parentIndex, hints) {\n  if (!isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var context = {\n    position: position,\n    elements: elements,\n    parent: parent,\n    parentIndex: parentIndex,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.create', context);\n\n  return context.elements;\n};\n\n\nModeling.prototype.createLabel = function(labelTarget, position, label, parent) {\n\n  label = this._create('label', label);\n\n  var context = {\n    labelTarget: labelTarget,\n    position: position,\n    parent: parent || labelTarget.parent,\n    shape: label\n  };\n\n  this._commandStack.execute('label.create', context);\n\n  return context.shape;\n};\n\n\n/**\n * Append shape to given source, drawing a connection\n * between source and the newly created shape.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape} target\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach]\n * @param {djs.model.Connection|Object} [hints.connection]\n * @param {djs.model.Base} [hints.connectionParent]\n *\n * @return {djs.model.Shape} the newly created shape\n */\nModeling.prototype.appendShape = function(source, shape, position, target, hints) {\n\n  hints = hints || {};\n\n  shape = this._create('shape', shape);\n\n  var context = {\n    source: source,\n    position: position,\n    target: target,\n    shape: shape,\n    connection: hints.connection,\n    connectionParent: hints.connectionParent,\n    attach: hints.attach\n  };\n\n  this._commandStack.execute('shape.append', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.removeElements = function(elements) {\n  var context = {\n    elements: elements\n  };\n\n  this._commandStack.execute('elements.delete', context);\n};\n\n\nModeling.prototype.distributeElements = function(groups, axis, dimension) {\n  var context = {\n    groups: groups,\n    axis: axis,\n    dimension: dimension\n  };\n\n  this._commandStack.execute('elements.distribute', context);\n};\n\n\nModeling.prototype.removeShape = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.delete', context);\n};\n\n\nModeling.prototype.removeConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.delete', context);\n};\n\nModeling.prototype.replaceShape = function(oldShape, newShape, hints) {\n  var context = {\n    oldShape: oldShape,\n    newData: newShape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.replace', context);\n\n  return context.newShape;\n};\n\nModeling.prototype.alignElements = function(elements, alignment) {\n  var context = {\n    elements: elements,\n    alignment: alignment\n  };\n\n  this._commandStack.execute('elements.align', context);\n};\n\nModeling.prototype.resizeShape = function(shape, newBounds, minBounds, hints) {\n  var context = {\n    shape: shape,\n    newBounds: newBounds,\n    minBounds: minBounds,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.resize', context);\n};\n\nModeling.prototype.createSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  var context = {\n    delta: delta,\n    direction: direction,\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes,\n    start: start\n  };\n\n  this._commandStack.execute('spaceTool', context);\n};\n\nModeling.prototype.updateWaypoints = function(connection, newWaypoints, hints) {\n  var context = {\n    connection: connection,\n    newWaypoints: newWaypoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.updateWaypoints', context);\n};\n\nModeling.prototype.reconnect = function(connection, source, target, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newSource: source,\n    newTarget: target,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnect', context);\n};\n\nModeling.prototype.reconnectStart = function(connection, newSource, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, newSource, connection.target, dockingOrPoints, assign(hints, {\n    docking: 'source'\n  }));\n};\n\nModeling.prototype.reconnectEnd = function(connection, newTarget, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, connection.source, newTarget, dockingOrPoints, assign(hints, {\n    docking: 'target'\n  }));\n};\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n  return this.createConnection(source, target, attrs || {}, source.parent, hints);\n};\n\nModeling.prototype._create = function(type, attrs) {\n  if (attrs instanceof Base) {\n    return attrs;\n  } else {\n    return this._elementFactory.create(type, attrs);\n  }\n};\n\nModeling.prototype.toggleCollapse = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.toggleCollapse', context);\n};\n","import {\n  reduce,\n  keys,\n  forEach,\n  assign\n} from 'min-dash';\n\nimport {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nvar DEFAULT_FLOW = 'default',\n    ID = 'id',\n    DI = 'di';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n/**\n * A handler that implements a BPMN 2.0 property update.\n *\n * This should be used to set simple properties on elements with\n * an underlying BPMN business object.\n *\n * Use respective diagram-js provided handlers if you would\n * like to perform automated modeling.\n */\nexport default function UpdatePropertiesHandler(\n    elementRegistry, moddle, translate,\n    modeling, textRenderer) {\n\n  this._elementRegistry = elementRegistry;\n  this._moddle = moddle;\n  this._translate = translate;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n}\n\nUpdatePropertiesHandler.$inject = [\n  'elementRegistry',\n  'moddle',\n  'translate',\n  'modeling',\n  'textRenderer'\n];\n\n\n// api //////////////////////\n\n/**\n * Updates a BPMN element with a list of new properties\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element to update\n * @param {Object} context.properties a list of properties to set on the element's\n *                                    businessObject (the BPMN model element)\n *\n * @return {Array<djs.model.Base>} the updated element\n */\nUpdatePropertiesHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      changed = [ element ],\n      translate = this._translate;\n\n  if (!element) {\n    throw new Error(translate('element required'));\n  }\n\n  var elementRegistry = this._elementRegistry,\n      ids = this._moddle.ids;\n\n  var businessObject = element.businessObject,\n      properties = unwrapBusinessObjects(context.properties),\n      oldProperties = context.oldProperties || getProperties(businessObject, properties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(businessObject[ID]);\n\n    elementRegistry.updateId(element, properties[ID]);\n\n    ids.claim(properties[ID], businessObject);\n  }\n\n  // correctly indicate visual changes on default flow updates\n  if (DEFAULT_FLOW in properties) {\n\n    if (properties[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(properties[DEFAULT_FLOW].id));\n    }\n\n    if (businessObject[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(businessObject[DEFAULT_FLOW].id));\n    }\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n\nUpdatePropertiesHandler.prototype.postExecute = function(context) {\n  var element = context.element,\n      label = element.label;\n\n  var text = label && getBusinessObject(label).name;\n\n  if (!text) {\n    return;\n  }\n\n  // get layouted text bounds and resize external\n  // external label accordingly\n  var newLabelBounds = this._textRenderer.getExternalLabelBounds(label, text);\n\n  this._modeling.resizeShape(label, newLabelBounds, NULL_DIMENSIONS);\n};\n\n/**\n * Reverts the update on a BPMN elements properties.\n *\n * @param  {Object} context\n *\n * @return {djs.model.Base} the updated element\n */\nUpdatePropertiesHandler.prototype.revert = function(context) {\n\n  var element = context.element,\n      properties = context.properties,\n      oldProperties = context.oldProperties,\n      businessObject = element.businessObject,\n      elementRegistry = this._elementRegistry,\n      ids = this._moddle.ids;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(properties[ID]);\n\n    elementRegistry.updateId(element, oldProperties[ID]);\n\n    ids.claim(oldProperties[ID], businessObject);\n  }\n\n  return context.changed;\n};\n\n\nfunction isIdChange(properties, businessObject) {\n  return ID in properties && properties[ID] !== businessObject[ID];\n}\n\n\nfunction getProperties(businessObject, properties) {\n  var propertyNames = keys(properties);\n\n  return reduce(propertyNames, function(result, key) {\n\n    // handle DI separately\n    if (key !== DI) {\n      result[key] = businessObject.get(key);\n    } else {\n      result[key] = getDiProperties(businessObject.di, keys(properties.di));\n    }\n\n    return result;\n  }, {});\n}\n\n\nfunction getDiProperties(di, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = di.get(key);\n\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n\n    if (key !== DI) {\n      businessObject.set(key, value);\n    } else {\n\n      // only update, if businessObject.di exists\n      if (businessObject.di) {\n        setDiProperties(businessObject.di, value);\n      }\n    }\n  });\n}\n\n\nfunction setDiProperties(di, properties) {\n  forEach(properties, function(value, key) {\n    di.set(key, value);\n  });\n}\n\n\nvar referencePropertyNames = [ 'default' ];\n\n/**\n * Make sure we unwrap the actual business object\n * behind diagram element that may have been\n * passed as arguments.\n *\n * @param  {Object} properties\n *\n * @return {Object} unwrappedProps\n */\nfunction unwrapBusinessObjects(properties) {\n\n  var unwrappedProps = assign({}, properties);\n\n  referencePropertyNames.forEach(function(name) {\n    if (name in properties) {\n      unwrappedProps[name] = getBusinessObject(unwrappedProps[name]);\n    }\n  });\n\n  return unwrappedProps;\n}","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\n\nexport default function UpdateCanvasRootHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nUpdateCanvasRootHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nUpdateCanvasRootHandler.prototype.execute = function(context) {\n\n  var canvas = this._canvas;\n\n  var newRoot = context.newRoot,\n      newRootBusinessObject = newRoot.businessObject,\n      oldRoot = canvas.getRootElement(),\n      oldRootBusinessObject = oldRoot.businessObject,\n      bpmnDefinitions = oldRootBusinessObject.$parent,\n      diPlane = oldRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(newRoot, true);\n\n  // (2) update root elements\n  collectionAdd(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = bpmnDefinitions;\n\n  collectionRemove(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = null;\n\n  // (3) wire di\n  oldRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = newRootBusinessObject;\n  newRootBusinessObject.di = diPlane;\n\n  context.oldRoot = oldRoot;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};\n\n\nUpdateCanvasRootHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var newRoot = context.newRoot,\n      newRootBusinessObject = newRoot.businessObject,\n      oldRoot = context.oldRoot,\n      oldRootBusinessObject = oldRoot.businessObject,\n      bpmnDefinitions = newRootBusinessObject.$parent,\n      diPlane = newRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(oldRoot, true);\n\n  // (2) update root elements\n  collectionRemove(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = null;\n\n  collectionAdd(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = bpmnDefinitions;\n\n  // (3) wire di\n  newRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = oldRootBusinessObject;\n  oldRootBusinessObject.di = diPlane;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};","import {\n  filter\n} from 'min-dash';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\nimport {\n  getLanesRoot,\n  getChildLanes,\n  LANE_INDENTATION\n} from '../util/LaneUtil';\n\n\n/**\n * A handler that allows us to add a new lane\n * above or below an existing one.\n *\n * @param {Modeling} modeling\n */\nexport default function AddLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nAddLaneHandler.$inject = [\n  'modeling',\n  'spaceTool'\n];\n\n\nAddLaneHandler.prototype.preExecute = function(context) {\n\n  var spaceTool = this._spaceTool,\n      modeling = this._modeling;\n\n  var shape = context.shape,\n      location = context.location;\n\n  var lanesRoot = getLanesRoot(shape);\n\n  var isRoot = lanesRoot === shape,\n      laneParent = isRoot ? shape : shape.parent;\n\n  var existingChildLanes = getChildLanes(laneParent);\n\n  // (0) add a lane if we currently got none and are adding to root\n  if (!existingChildLanes.length) {\n    modeling.createShape({ type: 'bpmn:Lane' }, {\n      x: shape.x + LANE_INDENTATION,\n      y: shape.y,\n      width: shape.width - LANE_INDENTATION,\n      height: shape.height\n    }, laneParent);\n  }\n\n  // (1) collect affected elements to create necessary space\n  var allAffected = [];\n\n  eachElement(lanesRoot, function(element) {\n    allAffected.push(element);\n\n    if (element === shape) {\n      return [];\n    }\n\n    return filter(element.children, function(c) {\n      return c !== shape;\n    });\n  });\n\n  var offset = location === 'top' ? -120 : 120,\n      lanePosition = location === 'top' ? shape.y : shape.y + shape.height,\n      spacePos = lanePosition + (location === 'top' ? 10 : -10),\n      direction = location === 'top' ? 'n' : 's';\n\n  var adjustments = spaceTool.calculateAdjustments(allAffected, 'y', offset, spacePos);\n\n  spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: 0, y: offset }, direction);\n\n  // (2) create new lane at open space\n  context.newLane = modeling.createShape({ type: 'bpmn:Lane' }, {\n    x: shape.x + (isRoot ? LANE_INDENTATION : 0),\n    y: lanePosition - (location === 'top' ? 120 : 0),\n    width: shape.width - (isRoot ? LANE_INDENTATION : 0),\n    height: 120\n  }, laneParent);\n};\n","import {\n  getChildLanes,\n  LANE_INDENTATION\n} from '../util/LaneUtil';\n\n\n/**\n * A handler that splits a lane into a number of sub-lanes,\n * creating new sub lanes, if necessary.\n *\n * @param {Modeling} modeling\n */\nexport default function SplitLaneHandler(modeling, translate) {\n  this._modeling = modeling;\n  this._translate = translate;\n}\n\nSplitLaneHandler.$inject = [\n  'modeling',\n  'translate'\n];\n\n\nSplitLaneHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling,\n      translate = this._translate;\n\n  var shape = context.shape,\n      newLanesCount = context.count;\n\n  var childLanes = getChildLanes(shape),\n      existingLanesCount = childLanes.length;\n\n  if (existingLanesCount > newLanesCount) {\n    throw new Error(translate('more than {count} child lanes', { count: newLanesCount }));\n  }\n\n  var newLanesHeight = Math.round(shape.height / newLanesCount);\n\n  // Iterate from top to bottom in child lane order,\n  // resizing existing lanes and creating new ones\n  // so that they split the parent proportionally.\n  //\n  // Due to rounding related errors, the bottom lane\n  // needs to take up all the remaining space.\n  var laneY,\n      laneHeight,\n      laneBounds,\n      newLaneAttrs,\n      idx;\n\n  for (idx = 0; idx < newLanesCount; idx++) {\n\n    laneY = shape.y + idx * newLanesHeight;\n\n    // if bottom lane\n    if (idx === newLanesCount - 1) {\n      laneHeight = shape.height - (newLanesHeight * idx);\n    } else {\n      laneHeight = newLanesHeight;\n    }\n\n    laneBounds = {\n      x: shape.x + LANE_INDENTATION,\n      y: laneY,\n      width: shape.width - LANE_INDENTATION,\n      height: laneHeight\n    };\n\n    if (idx < existingLanesCount) {\n\n      // resize existing lane\n      modeling.resizeShape(childLanes[idx], laneBounds);\n    } else {\n\n      // create a new lane at position\n      newLaneAttrs = {\n        type: 'bpmn:Lane'\n      };\n\n      modeling.createShape(newLaneAttrs, laneBounds, shape);\n    }\n  }\n};\n","import { is } from '../../../util/ModelUtil';\n\nimport {\n  getLanesRoot,\n  computeLanesResize\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substractTRBL\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\n\n/**\n * A handler that resizes a lane.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nResizeLaneHandler.$inject = [\n  'modeling',\n  'spaceTool'\n];\n\n\nResizeLaneHandler.prototype.preExecute = function(context) {\n\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      balanced = context.balanced;\n\n  if (balanced !== false) {\n    this.resizeBalanced(shape, newBounds);\n  } else {\n    this.resizeSpace(shape, newBounds);\n  }\n};\n\n\n/**\n * Resize balanced, adjusting next / previous lane sizes.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeBalanced = function(shape, newBounds) {\n\n  var modeling = this._modeling;\n\n  var resizeNeeded = computeLanesResize(shape, newBounds);\n\n  // resize the lane\n  modeling.resizeShape(shape, newBounds);\n\n  // resize other lanes as needed\n  resizeNeeded.forEach(function(r) {\n    modeling.resizeShape(r.shape, r.newBounds);\n  });\n};\n\n\n/**\n * Resize, making actual space and moving below / above elements.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeSpace = function(shape, newBounds) {\n  var spaceTool = this._spaceTool;\n\n  var shapeTrbl = asTRBL(shape),\n      newTrbl = asTRBL(newBounds);\n\n  var trblDiff = substractTRBL(newTrbl, shapeTrbl);\n\n  var lanesRoot = getLanesRoot(shape);\n\n  var allAffected = [],\n      allLanes = [];\n\n  eachElement(lanesRoot, function(element) {\n    allAffected.push(element);\n\n    if (is(element, 'bpmn:Lane') || is(element, 'bpmn:Participant')) {\n      allLanes.push(element);\n    }\n\n    return element.children;\n  });\n\n  var change,\n      spacePos,\n      direction,\n      offset,\n      adjustments;\n\n  if (trblDiff.bottom || trblDiff.top) {\n\n    change = trblDiff.bottom || trblDiff.top;\n    spacePos = shape.y + (trblDiff.bottom ? shape.height : 0) + (trblDiff.bottom ? -10 : 10);\n    direction = trblDiff.bottom ? 's' : 'n';\n\n    offset = trblDiff.top > 0 || trblDiff.bottom < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(allAffected, 'y', offset, spacePos);\n\n    spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: 0, y: change }, direction);\n  }\n\n\n  if (trblDiff.left || trblDiff.right) {\n\n    change = trblDiff.right || trblDiff.left;\n    spacePos = shape.x + (trblDiff.right ? shape.width : 0) + (trblDiff.right ? -10 : 100);\n    direction = trblDiff.right ? 'e' : 'w';\n\n    offset = trblDiff.left > 0 || trblDiff.right < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(allLanes, 'x', offset, spacePos);\n\n    spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: change, y: 0 }, direction);\n  }\n};","import {\n  collectLanes,\n  getLanesRoot\n} from '../util/LaneUtil';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nvar FLOW_NODE_REFS_ATTR = 'flowNodeRef',\n    LANES_ATTR = 'lanes';\n\n\n/**\n * A handler that updates lane refs on changed elements\n */\nexport default function UpdateFlowNodeRefsHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateFlowNodeRefsHandler.$inject = [\n  'elementRegistry'\n];\n\n\nUpdateFlowNodeRefsHandler.prototype.computeUpdates = function(flowNodeShapes, laneShapes) {\n\n  var handledNodes = [];\n\n  var updates = [];\n\n  var participantCache = {};\n\n  var allFlowNodeShapes = [];\n\n  function isInLaneShape(element, laneShape) {\n\n    var laneTrbl = asTRBL(laneShape);\n\n    var elementMid = {\n      x: element.x + element.width / 2,\n      y: element.y + element.height / 2\n    };\n\n    return elementMid.x > laneTrbl.left &&\n           elementMid.x < laneTrbl.right &&\n           elementMid.y > laneTrbl.top &&\n           elementMid.y < laneTrbl.bottom;\n  }\n\n  function addFlowNodeShape(flowNodeShape) {\n    if (handledNodes.indexOf(flowNodeShape) === -1) {\n      allFlowNodeShapes.push(flowNodeShape);\n      handledNodes.push(flowNodeShape);\n    }\n  }\n\n  function getAllLaneShapes(flowNodeShape) {\n\n    var root = getLanesRoot(flowNodeShape);\n\n    if (!participantCache[root.id]) {\n      participantCache[root.id] = collectLanes(root);\n    }\n\n    return participantCache[root.id];\n  }\n\n  function getNewLanes(flowNodeShape) {\n    if (!flowNodeShape.parent) {\n      return [];\n    }\n\n    var allLaneShapes = getAllLaneShapes(flowNodeShape);\n\n    return allLaneShapes.filter(function(l) {\n      return isInLaneShape(flowNodeShape, l);\n    }).map(function(shape) {\n      return shape.businessObject;\n    });\n  }\n\n  laneShapes.forEach(function(laneShape) {\n    var root = getLanesRoot(laneShape);\n\n    if (!root || handledNodes.indexOf(root) !== -1) {\n      return;\n    }\n\n    var children = root.children.filter(function(c) {\n      return is(c, 'bpmn:FlowNode');\n    });\n\n    children.forEach(addFlowNodeShape);\n\n    handledNodes.push(root);\n  });\n\n  flowNodeShapes.forEach(addFlowNodeShape);\n\n\n  allFlowNodeShapes.forEach(function(flowNodeShape) {\n\n    var flowNode = flowNodeShape.businessObject;\n\n    var lanes = flowNode.get(LANES_ATTR),\n        remove = lanes.slice(),\n        add = getNewLanes(flowNodeShape);\n\n    updates.push({ flowNode: flowNode, remove: remove, add: add });\n  });\n\n  laneShapes.forEach(function(laneShape) {\n\n    var lane = laneShape.businessObject;\n\n    // lane got removed XX-)\n    if (!laneShape.parent) {\n      lane.get(FLOW_NODE_REFS_ATTR).forEach(function(flowNode) {\n        updates.push({ flowNode: flowNode, remove: [ lane ], add: [] });\n      });\n    }\n  });\n\n  return updates;\n};\n\nUpdateFlowNodeRefsHandler.prototype.execute = function(context) {\n\n  var updates = context.updates;\n\n  if (!updates) {\n    updates = context.updates = this.computeUpdates(context.flowNodeShapes, context.laneShapes);\n  }\n\n\n  updates.forEach(function(update) {\n\n    var flowNode = update.flowNode,\n        lanes = flowNode.get(LANES_ATTR);\n\n    // unwire old\n    update.remove.forEach(function(oldLane) {\n      collectionRemove(lanes, oldLane);\n      collectionRemove(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire new\n    update.add.forEach(function(newLane) {\n      collectionAdd(lanes, newLane);\n      collectionAdd(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n\n\nUpdateFlowNodeRefsHandler.prototype.revert = function(context) {\n\n  var updates = context.updates;\n\n  updates.forEach(function(update) {\n\n    var flowNode = update.flowNode,\n        lanes = flowNode.get(LANES_ATTR);\n\n    // unwire new\n    update.add.forEach(function(newLane) {\n      collectionRemove(lanes, newLane);\n      collectionRemove(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire old\n    update.remove.forEach(function(oldLane) {\n      collectionAdd(lanes, oldLane);\n      collectionAdd(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n","export default function IdClaimHandler(moddle) {\n  this._moddle = moddle;\n}\n\nIdClaimHandler.$inject = [ 'moddle' ];\n\n\nIdClaimHandler.prototype.execute = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.claim(id, element);\n  } else {\n    ids.unclaim(id);\n  }\n};\n\n/**\n * Command revert implementation.\n */\nIdClaimHandler.prototype.revert = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.unclaim(id);\n  } else {\n    ids.claim(id, element);\n  }\n};\n\n","import {\r\n  assign,\r\n  forEach\r\n} from 'min-dash';\r\n\r\n\r\nvar DEFAULT_COLORS = {\r\n  fill: undefined,\r\n  stroke: undefined\r\n};\r\n\r\n\r\nexport default function SetColorHandler(commandStack) {\r\n  this._commandStack = commandStack;\r\n}\r\n\r\nSetColorHandler.$inject = [\r\n  'commandStack'\r\n];\r\n\r\n\r\nSetColorHandler.prototype.postExecute = function(context) {\r\n  var elements = context.elements,\r\n      colors = context.colors || DEFAULT_COLORS;\r\n\r\n  var self = this;\r\n\r\n  var di = {};\r\n\r\n  if ('fill' in colors) {\r\n    assign(di, { fill: colors.fill });\r\n  }\r\n\r\n  if ('stroke' in colors) {\r\n    assign(di, { stroke: colors.stroke });\r\n  }\r\n\r\n  forEach(elements, function(element) {\r\n\r\n    self._commandStack.execute('element.updateProperties', {\r\n      element: element,\r\n      properties: {\r\n        di: di\r\n      }\r\n    });\r\n  });\r\n\r\n};","import {\n  setLabel,\n  getLabel\n} from '../LabelUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../../util/LabelUtil';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n\n/**\n * A handler that updates the text of a BPMN element.\n */\nexport default function UpdateLabelHandler(modeling, textRenderer) {\n\n  /**\n   * Set the label and return the changed elements.\n   *\n   * Element parameter can be label itself or connection (i.e. sequence flow).\n   *\n   * @param {djs.model.Base} element\n   * @param {String} text\n   */\n  function setText(element, text) {\n\n    // external label if present\n    var label = element.label || element;\n\n    var labelTarget = element.labelTarget || element;\n\n    setLabel(label, text, labelTarget !== label);\n\n    return [ label, labelTarget ];\n  }\n\n  function preExecute(ctx) {\n    var element = ctx.element,\n        businessObject = element.businessObject,\n        newLabel = ctx.newLabel;\n\n    if (!isLabel(element)\n        && isLabelExternal(element)\n        && !hasExternalLabel(element)\n        && !isEmptyText(newLabel)) {\n\n      // create label\n      var paddingTop = 7;\n\n      var labelCenter = getExternalLabelMid(element);\n\n      labelCenter = {\n        x: labelCenter.x,\n        y: labelCenter.y + paddingTop\n      };\n\n      modeling.createLabel(element, labelCenter, {\n        id: businessObject.id + '_label',\n        businessObject: businessObject\n      });\n    }\n  }\n\n  function execute(ctx) {\n    ctx.oldLabel = getLabel(ctx.element);\n    return setText(ctx.element, ctx.newLabel);\n  }\n\n  function revert(ctx) {\n    return setText(ctx.element, ctx.oldLabel);\n  }\n\n  function postExecute(ctx) {\n    var element = ctx.element,\n        label = element.label || element,\n        newLabel = ctx.newLabel,\n        newBounds = ctx.newBounds,\n        hints = ctx.hints || {};\n\n    if (isLabel(label) && isEmptyText(newLabel)) {\n\n      if (hints.removeShape !== false) {\n        modeling.removeShape(label, { unsetLabel: false });\n      }\n\n      return;\n    }\n\n    // ignore internal labels for elements except text annotations\n    if (!isLabelExternal(element) && !is(element, 'bpmn:TextAnnotation')) {\n      return;\n    }\n\n    var text = getLabel(label);\n\n    // don't resize without text\n    if (!text) {\n      return;\n    }\n\n    // resize element based on label _or_ pre-defined bounds\n    if (typeof newBounds === 'undefined') {\n      newBounds = textRenderer.getExternalLabelBounds(label, text);\n    }\n\n    // setting newBounds to false or _null_ will\n    // disable the postExecute resize operation\n    if (newBounds) {\n      modeling.resizeShape(label, newBounds, NULL_DIMENSIONS);\n    }\n  }\n\n  // API\n\n  this.preExecute = preExecute;\n  this.execute = execute;\n  this.revert = revert;\n  this.postExecute = postExecute;\n}\n\nUpdateLabelHandler.$inject = [\n  'modeling',\n  'textRenderer'\n];\n\n\n// helpers ///////////////////////\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import inherits from 'inherits';\n\nimport BaseModeling from 'diagram-js/lib/features/modeling/Modeling';\n\nimport UpdatePropertiesHandler from './cmd/UpdatePropertiesHandler';\nimport UpdateCanvasRootHandler from './cmd/UpdateCanvasRootHandler';\nimport AddLaneHandler from './cmd/AddLaneHandler';\nimport SplitLaneHandler from './cmd/SplitLaneHandler';\nimport ResizeLaneHandler from './cmd/ResizeLaneHandler';\nimport UpdateFlowNodeRefsHandler from './cmd/UpdateFlowNodeRefsHandler';\nimport IdClaimHandler from './cmd/IdClaimHandler';\nimport SetColorHandler from './cmd/SetColorHandler';\n\nimport UpdateLabelHandler from '../label-editing/cmd/UpdateLabelHandler';\n\n\n/**\n * BPMN 2.0 modeling features activator\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n * @param {BpmnRules} bpmnRules\n */\nexport default function Modeling(\n    eventBus, elementFactory, commandStack,\n    bpmnRules) {\n\n  BaseModeling.call(this, eventBus, elementFactory, commandStack);\n\n  this._bpmnRules = bpmnRules;\n}\n\ninherits(Modeling, BaseModeling);\n\nModeling.$inject = [\n  'eventBus',\n  'elementFactory',\n  'commandStack',\n  'bpmnRules'\n];\n\n\nModeling.prototype.getHandlers = function() {\n  var handlers = BaseModeling.prototype.getHandlers.call(this);\n\n  handlers['element.updateProperties'] = UpdatePropertiesHandler;\n  handlers['canvas.updateRoot'] = UpdateCanvasRootHandler;\n  handlers['lane.add'] = AddLaneHandler;\n  handlers['lane.resize'] = ResizeLaneHandler;\n  handlers['lane.split'] = SplitLaneHandler;\n  handlers['lane.updateRefs'] = UpdateFlowNodeRefsHandler;\n  handlers['id.updateClaim'] = IdClaimHandler;\n  handlers['element.setColor'] = SetColorHandler;\n  handlers['element.updateLabel'] = UpdateLabelHandler;\n\n  return handlers;\n};\n\n\nModeling.prototype.updateLabel = function(element, newLabel, newBounds, hints) {\n  this._commandStack.execute('element.updateLabel', {\n    element: element,\n    newLabel: newLabel,\n    newBounds: newBounds,\n    hints: hints || {}\n  });\n};\n\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n\n  var bpmnRules = this._bpmnRules;\n\n  if (!attrs) {\n    attrs = bpmnRules.canConnect(source, target);\n  }\n\n  if (!attrs) {\n    return;\n  }\n\n  return this.createConnection(source, target, attrs, source.parent, hints);\n};\n\n\nModeling.prototype.updateProperties = function(element, properties) {\n  this._commandStack.execute('element.updateProperties', {\n    element: element,\n    properties: properties\n  });\n};\n\nModeling.prototype.resizeLane = function(laneShape, newBounds, balanced) {\n  this._commandStack.execute('lane.resize', {\n    shape: laneShape,\n    newBounds: newBounds,\n    balanced: balanced\n  });\n};\n\nModeling.prototype.addLane = function(targetLaneShape, location) {\n  var context = {\n    shape: targetLaneShape,\n    location: location\n  };\n\n  this._commandStack.execute('lane.add', context);\n\n  return context.newLane;\n};\n\nModeling.prototype.splitLane = function(targetLane, count) {\n  this._commandStack.execute('lane.split', {\n    shape: targetLane,\n    count: count\n  });\n};\n\n/**\n * Transform the current diagram into a collaboration.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeCollaboration = function() {\n\n  var collaborationElement = this._create('root', {\n    type: 'bpmn:Collaboration'\n  });\n\n  var context = {\n    newRoot: collaborationElement\n  };\n\n  this._commandStack.execute('canvas.updateRoot', context);\n\n  return collaborationElement;\n};\n\nModeling.prototype.updateLaneRefs = function(flowNodeShapes, laneShapes) {\n\n  this._commandStack.execute('lane.updateRefs', {\n    flowNodeShapes: flowNodeShapes,\n    laneShapes: laneShapes\n  });\n};\n\n/**\n * Transform the current diagram into a process.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeProcess = function() {\n\n  var processElement = this._create('root', {\n    type: 'bpmn:Process'\n  });\n\n  var context = {\n    newRoot: processElement\n  };\n\n  this._commandStack.execute('canvas.updateRoot', context);\n};\n\n\nModeling.prototype.claimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement,\n    claiming: true\n  });\n};\n\n\nModeling.prototype.unclaimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement\n  });\n};\n\nModeling.prototype.setColor = function(elements, colors) {\n  if (!elements.length) {\n    elements = [ elements ];\n  }\n\n  this._commandStack.execute('element.setColor', {\n    elements: elements,\n    colors: colors\n  });\n};\n","import {\n  getMid\n} from './LayoutUtil';\n\n\n/**\n * A base connection layouter implementation\n * that layouts the connection by directly connecting\n * mid(source) + mid(target).\n */\nexport default function BaseLayouter() {}\n\n\n/**\n * Return the new layouted waypoints for the given connection.\n *\n * The connection passed is still unchanged; you may figure out about\n * the new connection start / end via the layout hints provided.\n *\n * @param {djs.model.Connection} connection\n * @param {Object} [hints]\n * @param {Point} [hints.connectionStart]\n * @param {Point} [hints.connectionEnd]\n * @param {Point} [hints.source]\n * @param {Point} [hints.target]\n *\n * @return {Array<Point>} the layouted connection waypoints\n */\nBaseLayouter.prototype.layoutConnection = function(connection, hints) {\n\n  hints = hints || {};\n\n  return [\n    hints.connectionStart || getMid(hints.source || connection.source),\n    hints.connectionEnd || getMid(hints.target || connection.target)\n  ];\n};\n","import {\n  assign,\n  find,\n  isArray,\n  without\n} from 'min-dash';\n\nimport {\n  getOrientation,\n  getMid\n} from './LayoutUtil';\n\nimport {\n  pointInRect,\n  pointDistance,\n  pointsAligned,\n  pointsOnLine\n} from '../util/Geometry';\n\nvar MIN_SEGMENT_LENGTH = 20,\n    POINT_ORIENTATION_PADDING = 5;\n\nvar round = Math.round;\n\nvar INTERSECTION_THRESHOLD = 20,\n    ORIENTATION_THRESHOLD = {\n      'h:h': 20,\n      'v:v': 20,\n      'h:v': -10,\n      'v:h': -10\n    };\n\nfunction needsTurn(orientation, startDirection) {\n  return !{\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /./,\n    v: /./\n  }[startDirection].test(orientation);\n}\n\nfunction canLayoutStraight(direction, targetOrientation) {\n  return {\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /left|right/,\n    v: /top|bottom/\n  }[direction].test(targetOrientation);\n}\n\nfunction getSegmentBendpoints(a, b, directions) {\n  var orientation = getOrientation(b, a, POINT_ORIENTATION_PADDING);\n\n  var startDirection = directions.split(':')[0];\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  var segmentEnd, segmentDirections;\n\n  var layoutStraight = canLayoutStraight(startDirection, orientation),\n      layoutHorizontal = /h|r|l/.test(startDirection),\n      layoutTurn = false;\n\n  var turnNextDirections = false;\n\n  if (layoutStraight) {\n    segmentEnd = layoutHorizontal ? { x: xmid, y: a.y } : { x: a.x, y: ymid };\n\n    segmentDirections = layoutHorizontal ? 'h:h' : 'v:v';\n  } else {\n    layoutTurn = needsTurn(orientation, startDirection);\n\n    segmentDirections = layoutHorizontal ? 'h:v' : 'v:h';\n\n    if (layoutTurn) {\n\n      if (layoutHorizontal) {\n        turnNextDirections = ymid === a.y;\n\n        segmentEnd = {\n          x: a.x + MIN_SEGMENT_LENGTH * (/l/.test(startDirection) ? -1 : 1),\n          y: turnNextDirections ? ymid + MIN_SEGMENT_LENGTH : ymid\n        };\n      } else {\n        turnNextDirections = xmid === a.x;\n\n        segmentEnd = {\n          x: turnNextDirections ? xmid + MIN_SEGMENT_LENGTH : xmid,\n          y: a.y + MIN_SEGMENT_LENGTH * (/t/.test(startDirection) ? -1 : 1)\n        };\n      }\n\n    } else {\n      segmentEnd = {\n        x: xmid,\n        y: ymid\n      };\n    }\n  }\n\n  return {\n    waypoints: getBendpoints(a, segmentEnd, segmentDirections).concat(segmentEnd),\n    directions:  segmentDirections,\n    turnNextDirections: turnNextDirections\n  };\n}\n\nfunction getStartSegment(a, b, directions) {\n  return getSegmentBendpoints(a, b, directions);\n}\n\nfunction getEndSegment(a, b, directions) {\n  var invertedSegment = getSegmentBendpoints(b, a, invertDirections(directions));\n\n  return {\n    waypoints: invertedSegment.waypoints.slice().reverse(),\n    directions: invertDirections(invertedSegment.directions),\n    turnNextDirections: invertedSegment.turnNextDirections\n  };\n}\n\nfunction getMidSegment(startSegment, endSegment) {\n\n  var startDirection = startSegment.directions.split(':')[1],\n      endDirection = endSegment.directions.split(':')[0];\n\n  if (startSegment.turnNextDirections) {\n    startDirection = startDirection == 'h' ? 'v' : 'h';\n  }\n\n  if (endSegment.turnNextDirections) {\n    endDirection = endDirection == 'h' ? 'v' : 'h';\n  }\n\n  var directions = startDirection + ':' + endDirection;\n\n  var bendpoints = getBendpoints(\n    startSegment.waypoints[startSegment.waypoints.length - 1],\n    endSegment.waypoints[0],\n    directions\n  );\n\n  return {\n    waypoints: bendpoints,\n    directions: directions\n  };\n}\n\nfunction invertDirections(directions) {\n  return directions.split(':').reverse().join(':');\n}\n\n/**\n * Handle simple layouts with maximum two bendpoints.\n */\nfunction getSimpleBendpoints(a, b, directions) {\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  // one point, right or left from a\n  if (directions === 'h:v') {\n    return [ { x: b.x, y: a.y } ];\n  }\n\n  // one point, above or below a\n  if (directions === 'v:h') {\n    return [ { x: a.x, y: b.y } ];\n  }\n\n  // vertical segment between a and b\n  if (directions === 'h:h') {\n    return [\n      { x: xmid, y: a.y },\n      { x: xmid, y: b.y }\n    ];\n  }\n\n  // horizontal segment between a and b\n  if (directions === 'v:v') {\n    return [\n      { x: a.x, y: ymid },\n      { x: b.x, y: ymid }\n    ];\n  }\n\n  throw new Error('invalid directions: can only handle varians of [hv]:[hv]');\n}\n\n\n/**\n * Returns the mid points for a manhattan connection between two points.\n *\n * @example h:h (horizontal:horizontal)\n *\n * [a]----[x]\n *         |\n *        [x]----[b]\n *\n * @example h:v (horizontal:vertical)\n *\n * [a]----[x]\n *         |\n *        [b]\n *\n * @example h:r (horizontal:right)\n *\n * [a]----[x]\n *         |\n *    [b]-[x]\n *\n * @param  {Point} a\n * @param  {Point} b\n * @param  {String} directions\n *\n * @return {Array<Point>}\n */\nfunction getBendpoints(a, b, directions) {\n  directions = directions || 'h:h';\n\n  if (!isValidDirections(directions)) {\n    throw new Error(\n      'unknown directions: <' + directions + '>: ' +\n      'must be specified as <start>:<end> ' +\n      'with start/end in { h,v,t,r,b,l }'\n    );\n  }\n\n  // compute explicit directions, involving trbl dockings\n  // using a three segmented layouting algorithm\n  if (isExplicitDirections(directions)) {\n    var startSegment = getStartSegment(a, b, directions),\n        endSegment = getEndSegment(a, b, directions),\n        midSegment = getMidSegment(startSegment, endSegment);\n\n    return [].concat(\n      startSegment.waypoints,\n      midSegment.waypoints,\n      endSegment.waypoints\n    );\n  }\n\n  // handle simple [hv]:[hv] cases that can be easily computed\n  return getSimpleBendpoints(a, b, directions);\n}\n\n/**\n * Create a connection between the two points according\n * to the manhattan layout (only horizontal and vertical) edges.\n *\n * @param {Point} a\n * @param {Point} b\n *\n * @param {String} [directions='h:h'] specifies manhattan directions for each point as {adirection}:{bdirection}.\n                   A directionfor a point is either `h` (horizontal) or `v` (vertical)\n *\n * @return {Array<Point>}\n */\nexport function connectPoints(a, b, directions) {\n\n  var points = getBendpoints(a, b, directions);\n\n  points.unshift(a);\n  points.push(b);\n\n  return withoutRedundantPoints(points);\n}\n\n\n/**\n * Connect two rectangles using a manhattan layouted connection.\n *\n * @param {Bounds} source source rectangle\n * @param {Bounds} target target rectangle\n * @param {Point} [start] source docking\n * @param {Point} [end] target docking\n *\n * @param {Object} [hints]\n * @param {String} [hints.preserveDocking=source] preserve docking on selected side\n * @param {Array<String>} [hints.preferredLayouts]\n * @param {Point|Boolean} [hints.connectionStart] whether the start changed\n * @param {Point|Boolean} [hints.connectionEnd] whether the end changed\n *\n * @return {Array<Point>} connection points\n */\nexport function connectRectangles(source, target, start, end, hints) {\n\n  var preferredLayouts = hints && hints.preferredLayouts || [];\n\n  var preferredLayout = without(preferredLayouts, 'straight')[0] || 'h:h';\n\n  var threshold = ORIENTATION_THRESHOLD[preferredLayout] || 0;\n\n  var orientation = getOrientation(source, target, threshold);\n\n  var directions = getDirections(orientation, preferredLayout);\n\n  start = start || getMid(source);\n  end = end || getMid(target);\n\n  var directionSplit = directions.split(':');\n\n  // compute actual docking points for start / end\n  // this ensures we properly layout only parts of the\n  // connection that lies in between the two rectangles\n  var startDocking = getDockingPoint(start, source, directionSplit[0], invertOrientation(orientation)),\n      endDocking = getDockingPoint(end, target, directionSplit[1], orientation);\n\n  return connectPoints(startDocking, endDocking, directions);\n}\n\n\n/**\n * Repair the connection between two rectangles, of which one has been updated.\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} [start]\n * @param {Point} [end]\n * @param {Array<Point>} [waypoints]\n * @param {Object} [hints]\n * @param {Array<String>} [hints.preferredLayouts] list of preferred layouts\n * @param {Boolean} [hints.connectionStart]\n * @param {Boolean} [hints.connectionEnd]\n *\n * @return {Array<Point>} repaired waypoints\n */\nexport function repairConnection(source, target, start, end, waypoints, hints) {\n\n  if (isArray(start)) {\n    waypoints = start;\n    hints = end;\n\n    start = getMid(source);\n    end = getMid(target);\n  }\n\n  hints = assign({ preferredLayouts: [] }, hints);\n  waypoints = waypoints || [];\n\n  var preferredLayouts = hints.preferredLayouts,\n      preferStraight = preferredLayouts.indexOf('straight') !== -1,\n      repairedWaypoints;\n\n  // just layout non-existing or simple connections\n  // attempt to render straight lines, if required\n\n  // attempt to layout a straight line\n  repairedWaypoints = preferStraight && tryLayoutStraight(source, target, start, end, hints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from end\n  repairedWaypoints = hints.connectionEnd && tryRepairConnectionEnd(target, source, end, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from start\n  repairedWaypoints = hints.connectionStart && tryRepairConnectionStart(source, target, start, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // or whether nothing seems to have changed\n  if (!hints.connectionStart && !hints.connectionEnd && waypoints && waypoints.length) {\n    return waypoints;\n  }\n\n  // simply reconnect if nothing else worked\n  return connectRectangles(source, target, start, end, hints);\n}\n\n\nfunction inRange(a, start, end) {\n  return a >= start && a <= end;\n}\n\nfunction isInRange(axis, a, b) {\n  var size = {\n    x: 'width',\n    y: 'height'\n  };\n\n  return inRange(a[axis], b[axis], b[axis] + b[size[axis]]);\n}\n\n/**\n * Layout a straight connection\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} start\n * @param {Point} end\n * @param {Object} [hints]\n *\n * @return {Array<Point>|null} waypoints if straight layout worked\n */\nexport function tryLayoutStraight(source, target, start, end, hints) {\n  var axis = {},\n      primaryAxis,\n      orientation;\n\n  orientation = getOrientation(source, target);\n\n  // only layout a straight connection if shapes are\n  // horizontally or vertically aligned\n  if (!/^(top|bottom|left|right)$/.test(orientation)) {\n    return null;\n  }\n\n  if (/top|bottom/.test(orientation)) {\n    primaryAxis = 'x';\n  }\n\n  if (/left|right/.test(orientation)) {\n    primaryAxis = 'y';\n  }\n\n  if (hints.preserveDocking === 'target') {\n\n    if (!isInRange(primaryAxis, end, source)) {\n      return null;\n    }\n\n    axis[primaryAxis] = end[primaryAxis];\n\n    return [\n      {\n        x: axis.x !== undefined ? axis.x : start.x,\n        y: axis.y !== undefined ? axis.y : start.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : start.x,\n          y: axis.y !== undefined ? axis.y : start.y\n        }\n      },\n      {\n        x: end.x,\n        y: end.y\n      }\n    ];\n\n  } else {\n\n    if (!isInRange(primaryAxis, start, target)) {\n      return null;\n    }\n\n    axis[primaryAxis] = start[primaryAxis];\n\n    return [\n      {\n        x: start.x,\n        y: start.y\n      },\n      {\n        x: axis.x !== undefined ? axis.x : end.x,\n        y: axis.y !== undefined ? axis.y : end.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : end.x,\n          y: axis.y !== undefined ? axis.y : end.y\n        }\n      }\n    ];\n  }\n\n}\n\n/**\n * Repair a connection from start.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionStart(moved, other, newDocking, points) {\n  return _tryRepairConnectionSide(moved, other, newDocking, points);\n}\n\n/**\n * Repair a connection from end.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionEnd(moved, other, newDocking, points) {\n  var waypoints = points.slice().reverse();\n\n  waypoints = _tryRepairConnectionSide(moved, other, newDocking, waypoints);\n\n  return waypoints ? waypoints.reverse() : null;\n}\n\n/**\n * Repair a connection from one side that moved.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>} the repaired points between the two rectangles\n */\nfunction _tryRepairConnectionSide(moved, other, newDocking, points) {\n\n  function needsRelayout(points) {\n    if (points.length < 3) {\n      return true;\n    }\n\n    if (points.length > 4) {\n      return false;\n    }\n\n    // relayout if two points overlap\n    // this is most likely due to\n    return !!find(points, function(p, idx) {\n      var q = points[idx - 1];\n\n      return q && pointDistance(p, q) < 3;\n    });\n  }\n\n  function repairBendpoint(candidate, oldPeer, newPeer) {\n\n    var alignment = pointsAligned(oldPeer, candidate);\n\n    switch (alignment) {\n    case 'v':\n\n      // repair horizontal alignment\n      return { x: newPeer.x, y: candidate.y };\n    case 'h':\n\n      // repair vertical alignment\n      return { x: candidate.x, y: newPeer.y };\n    }\n\n    return { x: candidate.x, y: candidate. y };\n  }\n\n  function removeOverlapping(points, a, b) {\n    var i;\n\n    for (i = points.length - 2; i !== 0; i--) {\n\n      // intersects (?) break, remove all bendpoints up to this one and relayout\n      if (pointInRect(points[i], a, INTERSECTION_THRESHOLD) ||\n          pointInRect(points[i], b, INTERSECTION_THRESHOLD)) {\n\n        // return sliced old connection\n        return points.slice(i);\n      }\n    }\n\n    return points;\n  }\n\n  // (0) only repair what has layoutable bendpoints\n\n  // (1) if only one bendpoint and on shape moved onto other shapes axis\n  //     (horizontally / vertically), relayout\n\n  if (needsRelayout(points)) {\n    return null;\n  }\n\n  var oldDocking = points[0],\n      newPoints = points.slice(),\n      slicedPoints;\n\n  // (2) repair only last line segment and only if it was layouted before\n\n  newPoints[0] = newDocking;\n  newPoints[1] = repairBendpoint(newPoints[1], oldDocking, newDocking);\n\n\n  // (3) if shape intersects with any bendpoint after repair,\n  //     remove all segments up to this bendpoint and repair from there\n  slicedPoints = removeOverlapping(newPoints, moved, other);\n\n  if (slicedPoints !== newPoints) {\n    newPoints = _tryRepairConnectionSide(moved, other, newDocking, slicedPoints);\n  }\n\n  // (4) do NOT repair if repaired bendpoints are aligned\n  if (newPoints && pointsAligned(newPoints)) {\n    return null;\n  }\n\n  return newPoints;\n}\n\n\n/**\n * Returns the manhattan directions connecting two rectangles\n * with the given orientation.\n *\n * Will always return the default layout, if it is specific\n * regarding sides already (trbl).\n *\n * @example\n *\n * getDirections('top'); // -> 'v:v'\n * getDirections('intersect'); // -> 't:t'\n *\n * getDirections('top-right', 'v:h'); // -> 'v:h'\n * getDirections('top-right', 'h:h'); // -> 'h:h'\n *\n *\n * @param {String} orientation\n * @param {String} defaultLayout\n *\n * @return {String}\n */\nfunction getDirections(orientation, defaultLayout) {\n\n  // don't override specific trbl directions\n  if (isExplicitDirections(defaultLayout)) {\n    return defaultLayout;\n  }\n\n  switch (orientation) {\n  case 'intersect':\n    return 't:t';\n\n  case 'top':\n  case 'bottom':\n    return 'v:v';\n\n  case 'left':\n  case 'right':\n    return 'h:h';\n\n  // 'top-left'\n  // 'top-right'\n  // 'bottom-left'\n  // 'bottom-right'\n  default:\n    return defaultLayout;\n  }\n}\n\nfunction isValidDirections(directions) {\n  return directions && /^h|v|t|r|b|l:h|v|t|r|b|l$/.test(directions);\n}\n\nfunction isExplicitDirections(directions) {\n  return directions && /t|r|b|l/.test(directions);\n}\n\nfunction invertOrientation(orientation) {\n  return {\n    'top': 'bottom',\n    'bottom': 'top',\n    'left': 'right',\n    'right': 'left',\n    'top-left': 'bottom-right',\n    'bottom-right': 'top-left',\n    'top-right': 'bottom-left',\n    'bottom-left': 'top-right',\n  }[orientation];\n}\n\nfunction getDockingPoint(point, rectangle, dockingDirection, targetOrientation) {\n\n  // ensure we end up with a specific docking direction\n  // based on the targetOrientation, if <h|v> is being passed\n\n  if (dockingDirection === 'h') {\n    dockingDirection = /left/.test(targetOrientation) ? 'l' : 'r';\n  }\n\n  if (dockingDirection === 'v') {\n    dockingDirection = /top/.test(targetOrientation) ? 't' : 'b';\n  }\n\n  if (dockingDirection === 't') {\n    return { original: point, x: point.x, y: rectangle.y };\n  }\n\n  if (dockingDirection === 'r') {\n    return { original: point, x: rectangle.x + rectangle.width, y: point.y };\n  }\n\n  if (dockingDirection === 'b') {\n    return { original: point, x: point.x, y: rectangle.y + rectangle.height };\n  }\n\n  if (dockingDirection === 'l') {\n    return { original: point, x: rectangle.x, y: point.y };\n  }\n\n  throw new Error('unexpected dockingDirection: <' + dockingDirection + '>');\n}\n\n\n/**\n * Return list of waypoints with redundant ones filtered out.\n *\n * @example\n *\n * Original points:\n *\n *   [x] ----- [x] ------ [x]\n *                         |\n *                        [x] ----- [x] - [x]\n *\n * Filtered:\n *\n *   [x] ---------------- [x]\n *                         |\n *                        [x] ----------- [x]\n *\n * @param  {Array<Point>} waypoints\n *\n * @return {Array<Point>}\n */\nexport function withoutRedundantPoints(waypoints) {\n  return waypoints.reduce(function(points, p, idx) {\n\n    var previous = points[points.length - 1],\n        next = waypoints[idx + 1];\n\n    if (!pointsOnLine(previous, next, p, 0)) {\n      points.push(p);\n    }\n\n    return points;\n  }, []);\n}\n","import inherits from 'inherits';\n\nimport {\n  assign\n} from 'min-dash';\n\nimport BaseLayouter from 'diagram-js/lib/layout/BaseLayouter';\n\nimport {\n  repairConnection,\n  withoutRedundantPoints\n} from 'diagram-js/lib/layout/ManhattanLayout';\n\nimport {\n  getMid,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  isExpanded\n} from '../../util/DiUtil';\n\nimport { is } from '../../util/ModelUtil';\n\nvar ATTACH_ORIENTATION_PADDING = -10,\n    BOUNDARY_TO_HOST_THRESHOLD = 40;\n\nvar oppositeOrientationMapping = {\n  'top': 'bottom',\n  'top-right': 'bottom-left',\n  'top-left': 'bottom-right',\n  'right': 'left',\n  'bottom': 'top',\n  'bottom-right': 'top-left',\n  'bottom-left': 'top-right',\n  'left': 'right'\n};\n\nvar orientationDirectionMapping = {\n  top: 't',\n  right: 'r',\n  bottom: 'b',\n  left: 'l'\n};\n\n\nexport default function BpmnLayouter() {}\n\ninherits(BpmnLayouter, BaseLayouter);\n\n\nBpmnLayouter.prototype.layoutConnection = function(connection, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  var source = hints.source || connection.source,\n      target = hints.target || connection.target,\n      waypoints = hints.waypoints || connection.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd;\n\n  var manhattanOptions,\n      updatedWaypoints;\n\n  if (!connectionStart) {\n    connectionStart = getConnectionDocking(waypoints && waypoints[ 0 ], source);\n  }\n\n  if (!connectionEnd) {\n    connectionEnd = getConnectionDocking(waypoints && waypoints[ waypoints.length - 1 ], target);\n  }\n\n  // TODO(nikku): support vertical modeling\n  // and invert preferredLayouts accordingly\n\n  if (is(connection, 'bpmn:Association') ||\n      is(connection, 'bpmn:DataAssociation')) {\n\n    if (waypoints && !isCompensationAssociation(source, target)) {\n      return [].concat([ connectionStart ], waypoints.slice(1, -1), [ connectionEnd ]);\n    }\n  }\n\n  if (is(connection, 'bpmn:MessageFlow')) {\n    manhattanOptions = getMessageFlowManhattanOptions(source, target);\n  } else if (is(connection, 'bpmn:SequenceFlow') || isCompensationAssociation(source, target)) {\n\n    // layout all connection between flow elements h:h, except for\n    // (1) outgoing of boundary events -> layout based on attach orientation and target orientation\n    // (2) incoming/outgoing of gateways -> v:h for outgoing, h:v for incoming\n    // (3) loops\n    if (source === target) {\n      manhattanOptions = {\n        preferredLayouts: getLoopPreferredLayout(source, connection)\n      };\n    } else if (is(source, 'bpmn:BoundaryEvent')) {\n      manhattanOptions = {\n        preferredLayouts: getBoundaryEventPreferredLayouts(source, target, connectionEnd)\n      };\n    } else if (is(source, 'bpmn:Gateway')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'v:h' ]\n      };\n    } else if (is(target, 'bpmn:Gateway')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:v' ]\n      };\n    } else {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:h' ]\n      };\n    }\n  }\n\n  if (manhattanOptions) {\n    manhattanOptions = assign(manhattanOptions, hints);\n\n    updatedWaypoints = withoutRedundantPoints(repairConnection(\n      source,\n      target,\n      connectionStart,\n      connectionEnd,\n      waypoints,\n      manhattanOptions\n    ));\n  }\n\n  return updatedWaypoints || [ connectionStart, connectionEnd ];\n};\n\n\n// helpers //////////\n\nfunction getAttachOrientation(attachedElement) {\n  var hostElement = attachedElement.host;\n\n  return getOrientation(getMid(attachedElement), hostElement, ATTACH_ORIENTATION_PADDING);\n}\n\nfunction getMessageFlowManhattanOptions(source, target) {\n  return {\n    preferredLayouts: [ 'straight', 'v:v' ],\n    preserveDocking: getMessageFlowPreserveDocking(source, target)\n  };\n}\n\nfunction getMessageFlowPreserveDocking(source, target) {\n\n  // (1) docking element connected to participant has precedence\n  if (is(target, 'bpmn:Participant')) {\n    return 'source';\n  }\n\n  if (is(source, 'bpmn:Participant')) {\n    return 'target';\n  }\n\n  // (2) docking element connected to expanded sub-process has precedence\n  if (isExpandedSubProcess(target)) {\n    return 'source';\n  }\n\n  if (isExpandedSubProcess(source)) {\n    return 'target';\n  }\n\n  // (3) docking event has precedence\n  if (is(target, 'bpmn:Event')) {\n    return 'target';\n  }\n\n  if (is(source, 'bpmn:Event')) {\n    return 'source';\n  }\n\n  return null;\n}\n\nfunction getConnectionDocking(point, shape) {\n  return point ? (point.original || point) : getMid(shape);\n}\n\nfunction isCompensationAssociation(source, target) {\n  return is(target, 'bpmn:Activity') &&\n    is(source, 'bpmn:BoundaryEvent') &&\n    target.businessObject.isForCompensation;\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction isAnyOrientation(orientation, orientations) {\n  return orientations.indexOf(orientation) !== -1;\n}\n\nfunction getHorizontalOrientation(orientation) {\n  var matches = /right|left/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction getVerticalOrientation(orientation) {\n  var matches = /top|bottom/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction isOppositeOrientation(a, b) {\n  return oppositeOrientationMapping[a] === b;\n}\n\nfunction isOppositeHorizontalOrientation(a, b) {\n  var horizontalOrientation = getHorizontalOrientation(a);\n\n  var oppositeHorizontalOrientation = oppositeOrientationMapping[horizontalOrientation];\n\n  return b.indexOf(oppositeHorizontalOrientation) !== -1;\n}\n\nfunction isOppositeVerticalOrientation(a, b) {\n  var verticalOrientation = getVerticalOrientation(a);\n\n  var oppositeVerticalOrientation = oppositeOrientationMapping[verticalOrientation];\n\n  return b.indexOf(oppositeVerticalOrientation) !== -1;\n}\n\nfunction isHorizontalOrientation(orientation) {\n  return orientation === 'right' || orientation === 'left';\n}\n\nfunction getLoopPreferredLayout(source, connection) {\n  var waypoints = connection.waypoints;\n\n  var orientation = waypoints && waypoints.length && getOrientation(waypoints[0], source);\n\n  if (orientation === 'top') {\n    return [ 't:r' ];\n  } else if (orientation === 'right') {\n    return [ 'r:b' ];\n  } else if (orientation === 'left') {\n    return [ 'l:t' ];\n  }\n\n  return [ 'b:l' ];\n}\n\nfunction getBoundaryEventPreferredLayouts(source, target, end) {\n  var sourceMid = getMid(source),\n      targetMid = getMid(target),\n      attachOrientation = getAttachOrientation(source),\n      sourceLayout,\n      targetLayout;\n\n  var isLoop = isSame(source.host, target);\n\n  var attachedToSide = isAnyOrientation(attachOrientation, [ 'top', 'right', 'bottom', 'left' ]);\n\n  var targetOrientation = getOrientation(targetMid, sourceMid, {\n    x: source.width / 2 + target.width / 2,\n    y: source.height / 2 + target.height / 2\n  });\n\n  if (isLoop) {\n    return getBoundaryEventLoopLayout(attachOrientation, attachedToSide, source, target, end);\n  }\n\n  // source layout\n  sourceLayout = getBoundaryEventSourceLayout(attachOrientation, targetOrientation, attachedToSide);\n\n  // target layout\n  targetLayout = getBoundaryEventTargetLayout(attachOrientation, targetOrientation, attachedToSide);\n\n  return [ sourceLayout + ':' + targetLayout ];\n}\n\nfunction getBoundaryEventLoopLayout(attachOrientation, attachedToSide, source, target, end) {\n  var orientation = attachedToSide ? attachOrientation : getVerticalOrientation(attachOrientation),\n      sourceLayout = orientationDirectionMapping[ orientation ],\n      targetLayout;\n\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n      targetLayout = shouldConnectToSameSide('y', source, target, end) ? 'h' : 'b';\n    } else {\n      targetLayout = shouldConnectToSameSide('x', source, target, end) ? 'v' : 'l';\n    }\n  } else {\n    targetLayout = 'v';\n  }\n\n  return [ sourceLayout + ':' + targetLayout ];\n}\n\nfunction shouldConnectToSameSide(axis, source, target, end) {\n  var threshold = BOUNDARY_TO_HOST_THRESHOLD;\n\n  return !(\n    areCloseOnAxis(axis, end, target, threshold) ||\n    areCloseOnAxis(axis, end, {\n      x: target.x + target.width,\n      y: target.y + target.height\n    }, threshold) ||\n    areCloseOnAxis(axis, end, getMid(source), threshold)\n  );\n}\n\nfunction areCloseOnAxis(axis, a, b, threshold) {\n  return Math.abs(a[ axis ] - b[ axis ]) < threshold;\n}\n\nfunction getBoundaryEventSourceLayout(attachOrientation, targetOrientation, attachedToSide) {\n\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    return orientationDirectionMapping[ attachOrientation ];\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // same vertical or opposite horizontal orientation\n  if (isSame(\n    getVerticalOrientation(attachOrientation), getVerticalOrientation(targetOrientation)\n  ) || isOppositeOrientation(\n    getHorizontalOrientation(attachOrientation), getHorizontalOrientation(targetOrientation)\n  )) {\n    return orientationDirectionMapping[ getVerticalOrientation(attachOrientation) ];\n  }\n\n  // fallback\n  return orientationDirectionMapping[ getHorizontalOrientation(attachOrientation) ];\n}\n\nfunction getBoundaryEventTargetLayout(attachOrientation, targetOrientation, attachedToSide) {\n\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n\n      // orientation is right or left\n\n      // opposite horizontal orientation or same orientation\n      if (\n        isOppositeHorizontalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return 'h';\n      }\n\n      // fallback\n      return 'v';\n    } else {\n\n      // orientation is top or bottom\n\n      // opposite vertical orientation or same orientation\n      if (\n        isOppositeVerticalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return 'v';\n      }\n\n      // fallback\n      return 'h';\n    }\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // orientation is right, left\n  // or same vertical orientation but also right or left\n  if (isHorizontalOrientation(targetOrientation) ||\n    (isSame(getVerticalOrientation(attachOrientation), getVerticalOrientation(targetOrientation)) &&\n      getHorizontalOrientation(targetOrientation))) {\n    return 'h';\n  } else {\n    return 'v';\n  }\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection\n} from './LayoutUtil';\n\n\nfunction dockingToPoint(docking) {\n\n  // use the dockings actual point and\n  // retain the original docking\n  return assign({ original: docking.point.original || docking.point }, docking.actual);\n}\n\n\n/**\n * A {@link ConnectionDocking} that crops connection waypoints based on\n * the path(s) of the connection source and target.\n *\n * @param {djs.core.ElementRegistry} elementRegistry\n */\nexport default function CroppingConnectionDocking(elementRegistry, graphicsFactory) {\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n}\n\nCroppingConnectionDocking.$inject = [ 'elementRegistry', 'graphicsFactory' ];\n\n\n/**\n * @inheritDoc ConnectionDocking#getCroppedWaypoints\n */\nCroppingConnectionDocking.prototype.getCroppedWaypoints = function(connection, source, target) {\n\n  source = source || connection.source;\n  target = target || connection.target;\n\n  var sourceDocking = this.getDockingPoint(connection, source, true),\n      targetDocking = this.getDockingPoint(connection, target);\n\n  var croppedWaypoints = connection.waypoints.slice(sourceDocking.idx + 1, targetDocking.idx);\n\n  croppedWaypoints.unshift(dockingToPoint(sourceDocking));\n  croppedWaypoints.push(dockingToPoint(targetDocking));\n\n  return croppedWaypoints;\n};\n\n/**\n * Return the connection docking point on the specified shape\n *\n * @inheritDoc ConnectionDocking#getDockingPoint\n */\nCroppingConnectionDocking.prototype.getDockingPoint = function(connection, shape, dockStart) {\n\n  var waypoints = connection.waypoints,\n      dockingIdx,\n      dockingPoint,\n      croppedPoint;\n\n  dockingIdx = dockStart ? 0 : waypoints.length - 1;\n  dockingPoint = waypoints[dockingIdx];\n\n  croppedPoint = this._getIntersection(shape, connection, dockStart);\n\n  return {\n    point: dockingPoint,\n    actual: croppedPoint || dockingPoint,\n    idx: dockingIdx\n  };\n};\n\n\n// helpers //////////////////////\n\nCroppingConnectionDocking.prototype._getIntersection = function(shape, connection, takeFirst) {\n\n  var shapePath = this._getShapePath(shape),\n      connectionPath = this._getConnectionPath(connection);\n\n  return getElementLineIntersection(shapePath, connectionPath, takeFirst);\n};\n\nCroppingConnectionDocking.prototype._getConnectionPath = function(connection) {\n  return this._graphicsFactory.getConnectionPath(connection);\n};\n\nCroppingConnectionDocking.prototype._getShapePath = function(shape) {\n  return this._graphicsFactory.getShapePath(shape);\n};\n\nCroppingConnectionDocking.prototype._getGfx = function(element) {\n  return this._elementRegistry.getGraphics(element);\n};\n","import BehaviorModule from './behavior';\nimport RulesModule from '../rules';\nimport OrderingModule from '../ordering';\nimport ReplaceModule from '../replace';\n\nimport CommandModule from 'diagram-js/lib/command';\nimport TooltipsModule from 'diagram-js/lib/features/tooltips';\nimport LabelSupportModule from 'diagram-js/lib/features/label-support';\nimport AttachSupportModule from 'diagram-js/lib/features/attach-support';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport SpaceToolModule from 'diagram-js/lib/features/space-tool';\n\nimport BpmnFactory from './BpmnFactory';\nimport BpmnUpdater from './BpmnUpdater';\nimport ElementFactory from './ElementFactory';\nimport Modeling from './Modeling';\nimport BpmnLayouter from './BpmnLayouter';\nimport CroppingConnectionDocking from 'diagram-js/lib/layout/CroppingConnectionDocking';\n\n\nexport default {\n  __init__: [\n    'modeling',\n    'bpmnUpdater'\n  ],\n  __depends__: [\n    BehaviorModule,\n    RulesModule,\n    OrderingModule,\n    ReplaceModule,\n    CommandModule,\n    TooltipsModule,\n    LabelSupportModule,\n    AttachSupportModule,\n    SelectionModule,\n    ChangeSupportModule,\n    SpaceToolModule\n  ],\n  bpmnFactory: [ 'type', BpmnFactory ],\n  bpmnUpdater: [ 'type', BpmnUpdater ],\n  elementFactory: [ 'type', ElementFactory ],\n  modeling: [ 'type', Modeling ],\n  layouter: [ 'type', BpmnLayouter ],\n  connectionDocking: [ 'type', CroppingConnectionDocking ]\n};","import {\n  assign,\n  filter,\n  groupBy,\n  isObject\n} from 'min-dash';\n\nvar LOW_PRIORITY = 500,\n    MEDIUM_PRIORITY = 1250,\n    HIGH_PRIORITY = 1500;\n\nimport { getOriginal as getOriginalEvent } from '../../util/Event';\n\nvar round = Math.round;\n\nfunction mid(element) {\n  return {\n    x: element.x + round(element.width / 2),\n    y: element.y + round(element.height / 2)\n  };\n}\n\n/**\n * A plugin that makes shapes draggable / droppable.\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Modeling} modeling\n * @param {Selection} selection\n * @param {Rules} rules\n */\nexport default function MoveEvents(\n    eventBus, dragging, modeling,\n    selection, rules) {\n\n  // rules\n\n  function canMove(shapes, delta, position, target) {\n\n    return rules.allowed('elements.move', {\n      shapes: shapes,\n      delta: delta,\n      position: position,\n      target: target\n    });\n  }\n\n\n  // move events\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment.\n  //\n  // This sets up the context with\n  //\n  // * shape: the primary shape being moved\n  // * shapes: a list of shapes to be moved\n  // * validatedShapes: a list of shapes that are being checked\n  //                    against the rules before and during move\n  //\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(event) {\n\n    var context = event.context,\n        shape = event.shape,\n        shapes = selection.get().slice();\n\n    // move only single shape if the dragged element\n    // is not part of the current selection\n    if (shapes.indexOf(shape) === -1) {\n      shapes = [ shape ];\n    }\n\n    // ensure we remove nested elements in the collection\n    // and add attachers for a proper dragger\n    shapes = removeNested(shapes);\n\n    // attach shapes to drag context\n    assign(context, {\n      shapes: shapes,\n      validatedShapes: shapes,\n      shape: shape\n    });\n  });\n\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment\n  //\n  eventBus.on('shape.move.start', MEDIUM_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        canExecute;\n\n    canExecute = context.canExecute = canMove(validatedShapes);\n\n    // check if we can move the elements\n    if (!canExecute) {\n      return false;\n    }\n  });\n\n  // assign a low priority to this handler\n  // to let others modify the move event before we update\n  // the context\n  //\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        hover = event.hover,\n        delta = { x: event.dx, y: event.dy },\n        position = { x: event.x, y: event.y },\n        canExecute;\n\n    // check if we can move the elements\n    canExecute = canMove(validatedShapes, delta, position, hover);\n\n    context.delta = delta;\n    context.canExecute = canExecute;\n\n    // simply ignore move over\n    if (canExecute === null) {\n      context.target = null;\n\n      return;\n    }\n\n    context.target = hover;\n  });\n\n  eventBus.on('shape.move.end', function(event) {\n\n    var context = event.context;\n\n    var delta = context.delta,\n        canExecute = context.canExecute,\n        isAttach = canExecute === 'attach',\n        shapes = context.shapes;\n\n    if (canExecute === false) {\n      return false;\n    }\n\n    // ensure we have actual pixel values deltas\n    // (important when zoom level was > 1 during move)\n    delta.x = round(delta.x);\n    delta.y = round(delta.y);\n\n    if (delta.x === 0 && delta.y === 0) {\n\n      // didn't move\n      return;\n    }\n\n    modeling.moveElements(shapes, delta, context.target, {\n      primaryShape: context.shape,\n      attach: isAttach\n    });\n  });\n\n\n  // move activation\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = getOriginalEvent(event);\n\n    if (!originalEvent) {\n      throw new Error('must supply DOM mousedown event');\n    }\n\n    return start(originalEvent, event.element);\n  });\n\n  /**\n   * Start move.\n   *\n   * @param {MouseEvent} event\n   * @param {djs.model.Shape} shape\n   * @param {boolean} [activate]\n   * @param {Object} [context]\n   */\n  function start(event, element, activate, context) {\n    if (isObject(activate)) {\n      context = activate;\n      activate = false;\n    }\n\n    // do not move connections or the root element\n    if (element.waypoints || !element.parent) {\n      return;\n    }\n\n    var referencePoint = mid(element);\n\n    dragging.init(event, referencePoint, 'shape.move', {\n      cursor: 'grabbing',\n      autoActivate: activate,\n      data: {\n        shape: element,\n        context: context || {}\n      }\n    });\n\n    // we've handled the event\n    return true;\n  }\n\n  // API\n\n  this.start = start;\n}\n\nMoveEvents.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'selection',\n  'rules'\n];\n\n\n/**\n * Return a filtered list of elements that do not contain\n * those nested into others.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeNested(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while ((element = element.parent)) {\n\n      // parent in selection\n      if (ids[element.id]) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n}\n","import {\n  flatten,\n  forEach,\n  filter,\n  find,\n  groupBy,\n  map,\n  matchPattern,\n  size\n} from 'min-dash';\n\nimport {\n  selfAndAllChildren\n} from '../../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nvar LOW_PRIORITY = 499;\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_NEW_PARENT = 'new-parent',\n    MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Provides previews for moving shapes when moving.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function MovePreview(\n    eventBus, canvas, styles, previewSupport) {\n\n  function getVisualDragShapes(shapes) {\n    var elements = getAllDraggedElements(shapes);\n\n    var filteredElements = removeEdges(elements);\n\n    return filteredElements;\n  }\n\n  function getAllDraggedElements(shapes) {\n    var allShapes = selfAndAllChildren(shapes, true);\n\n    var allConnections = map(allShapes, function(shape) {\n      return (shape.incoming || []).concat(shape.outgoing || []);\n    });\n\n    return flatten(allShapes.concat(allConnections));\n  }\n\n  /**\n   * Sets drop marker on an element.\n   */\n  function setMarker(element, marker) {\n\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  function makeDraggable(context, element, addMarker) {\n\n    previewSupport.addDragger(element, context.dragGroup);\n\n    if (addMarker) {\n      canvas.addMarker(element, MARKER_DRAGGING);\n    }\n\n    if (context.allDraggedElements) {\n      context.allDraggedElements.push(element);\n    } else {\n      context.allDraggedElements = [ element ];\n    }\n  }\n\n  // assign a low priority to this handler\n  // to let others modify the move context before\n  // we draw things\n  eventBus.on('shape.move.start', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        dragShapes = context.shapes,\n        allDraggedElements = context.allDraggedElements;\n\n    var visuallyDraggedShapes = getVisualDragShapes(dragShapes);\n\n    if (!context.dragGroup) {\n      var dragGroup = svgCreate('g');\n\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      var defaultLayer = canvas.getDefaultLayer();\n\n      svgAppend(defaultLayer, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    // add previews\n    visuallyDraggedShapes.forEach(function(shape) {\n      previewSupport.addDragger(shape, context.dragGroup);\n    });\n\n    // cache all dragged elements / gfx\n    // so that we can quickly undo their state changes later\n    if (!allDraggedElements) {\n      allDraggedElements = getAllDraggedElements(dragShapes);\n    } else {\n      allDraggedElements = flatten([\n        allDraggedElements,\n        getAllDraggedElements(dragShapes)\n      ]);\n    }\n\n    // add dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.addMarker(e, MARKER_DRAGGING);\n    });\n\n    context.allDraggedElements = allDraggedElements;\n\n    // determine, if any of the dragged elements have different parents\n    context.differentParents = haveDifferentParents(dragShapes);\n  });\n\n  // update previews\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        dragGroup = context.dragGroup,\n        target = context.target,\n        parent = context.shape.parent,\n        canExecute = context.canExecute;\n\n    if (target) {\n      if (canExecute === 'attach') {\n        setMarker(target, MARKER_ATTACH);\n      } else if (context.canExecute && target && target.id !== parent.id) {\n        setMarker(target, MARKER_NEW_PARENT);\n      } else {\n        setMarker(target, context.canExecute ? MARKER_OK : MARKER_NOT_OK);\n      }\n    }\n\n    translate(dragGroup, event.dx, event.dy);\n  });\n\n  eventBus.on([ 'shape.move.out', 'shape.move.cleanup' ], function(event) {\n    var context = event.context,\n        target = context.target;\n\n    if (target) {\n      setMarker(target, null);\n    }\n  });\n\n  // remove previews\n  eventBus.on('shape.move.cleanup', function(event) {\n\n    var context = event.context,\n        allDraggedElements = context.allDraggedElements,\n        dragGroup = context.dragGroup;\n\n\n    // remove dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.removeMarker(e, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(dragGroup);\n    }\n  });\n\n\n  // API //////////////////////\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  this.makeDraggable = makeDraggable;\n}\n\nMovePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * returns elements minus all connections\n * where source or target is not elements\n */\nfunction removeEdges(elements) {\n\n  var filteredElements = filter(elements, function(element) {\n\n    if (!isConnection(element)) {\n      return true;\n    } else {\n\n      return (\n        find(elements, matchPattern({ id: element.source.id })) &&\n        find(elements, matchPattern({ id: element.target.id }))\n      );\n    }\n  });\n\n  return filteredElements;\n}\n\nfunction haveDifferentParents(elements) {\n  return size(groupBy(elements, function(e) { return e.parent && e.parent.id; })) !== 1;\n}\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import InteractionEventsModule from '../interaction-events';\nimport SelectionModule from '../selection';\nimport OutlineModule from '../outline';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Move from './Move';\nimport MovePreview from './MovePreview';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    SelectionModule,\n    OutlineModule,\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'move',\n    'movePreview'\n  ],\n  move: [ 'type', Move ],\n  movePreview: [ 'type', MovePreview ]\n};\n","import {\n  isArray,\n  isFunction,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  attr as domAttr,\n  clear as domClear,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  event as domEvent\n} from 'min-dom';\n\n\nvar TOGGLE_SELECTOR = '.djs-palette-toggle',\n    ENTRY_SELECTOR = '.entry',\n    ELEMENT_SELECTOR = TOGGLE_SELECTOR + ', ' + ENTRY_SELECTOR;\n\nvar PALETTE_OPEN_CLS = 'open',\n    PALETTE_TWO_COLUMN_CLS = 'two-column';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A palette containing modeling elements.\n */\nexport default function Palette(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('tool-manager.update', function(event) {\n    var tool = event.tool;\n\n    self.updateToolHighlight(tool);\n  });\n\n  eventBus.on('i18n.changed', function() {\n    self._update();\n  });\n\n  eventBus.on('diagram.init', function() {\n\n    self._diagramInitialized = true;\n\n    self._rebuild();\n  });\n}\n\nPalette.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a provider with the palette\n *\n * @param  {Number} [priority=1000]\n * @param  {PaletteProvider} provider\n *\n * @example\n * const paletteProvider = {\n *   getPaletteEntries: function() {\n *     return function(entries) {\n *       return {\n *         ...entries,\n *         'entry-1': {\n *           label: 'My Entry',\n *           action: function() { alert(\"I have been clicked!\"); }\n *         }\n *       };\n *     }\n *   }\n * };\n *\n * palette.registerProvider(800, paletteProvider);\n */\nPalette.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('palette.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n\n  this._rebuild();\n};\n\n\n/**\n * Returns the palette entries\n *\n * @return {Object<string, PaletteEntryDescriptor>} map of entries\n */\nPalette.prototype.getEntries = function() {\n  var providers = this._getProviders();\n\n  return providers.reduce(addPaletteEntries, {});\n};\n\nPalette.prototype._rebuild = function() {\n\n  if (!this._diagramInitialized) {\n    return;\n  }\n\n  var providers = this._getProviders();\n\n  if (!providers.length) {\n    return;\n  }\n\n  if (!this._container) {\n    this._init();\n  }\n\n  this._update();\n};\n\n/**\n * Initialize\n */\nPalette.prototype._init = function() {\n\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var parentContainer = this._getParentContainer();\n\n  var container = this._container = domify(Palette.HTML_MARKUP);\n\n  parentContainer.appendChild(container);\n\n  domDelegate.bind(container, ELEMENT_SELECTOR, 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    if (domMatches(target, TOGGLE_SELECTOR)) {\n      return self.toggle();\n    }\n\n    self.trigger('click', event);\n  });\n\n  // prevent drag propagation\n  domEvent.bind(container, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  // prevent drag propagation\n  domDelegate.bind(container, ENTRY_SELECTOR, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  eventBus.on('canvas.resized', this._layoutChanged, this);\n\n  eventBus.fire('palette.create', {\n    container: container\n  });\n};\n\nPalette.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'palette.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\n/**\n * Update palette state.\n *\n * @param  {Object} [state] { open, twoColumn }\n */\nPalette.prototype._toggleState = function(state) {\n\n  state = state || {};\n\n  var parent = this._getParentContainer(),\n      container = this._container;\n\n  var eventBus = this._eventBus;\n\n  var twoColumn;\n\n  var cls = domClasses(container);\n\n  if ('twoColumn' in state) {\n    twoColumn = state.twoColumn;\n  } else {\n    twoColumn = this._needsCollapse(parent.clientHeight, this._entries || {});\n  }\n\n  // always update two column\n  cls.toggle(PALETTE_TWO_COLUMN_CLS, twoColumn);\n\n  if ('open' in state) {\n    cls.toggle(PALETTE_OPEN_CLS, state.open);\n  }\n\n  eventBus.fire('palette.changed', {\n    twoColumn: twoColumn,\n    open: this.isOpen()\n  });\n};\n\nPalette.prototype._update = function() {\n\n  var entriesContainer = domQuery('.djs-palette-entries', this._container),\n      entries = this._entries = this.getEntries();\n\n  domClear(entriesContainer);\n\n  forEach(entries, function(entry, id) {\n\n    var grouping = entry.group || 'default';\n\n    var container = domQuery('[data-group=' + grouping + ']', entriesContainer);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      entriesContainer.appendChild(container);\n    }\n\n    var html = entry.html || (\n      entry.separator ?\n        '<hr class=\"separator\" />' :\n        '<div class=\"entry\" draggable=\"true\"></div>');\n\n\n    var control = domify(html);\n    container.appendChild(control);\n\n    if (!entry.separator) {\n      domAttr(control, 'data-action', id);\n\n      if (entry.title) {\n        domAttr(control, 'title', entry.title);\n      }\n\n      if (entry.className) {\n        addClasses(control, entry.className);\n      }\n\n      if (entry.imageUrl) {\n        control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n      }\n    }\n  });\n\n  // open after update\n  this.open();\n};\n\n\n/**\n * Trigger an action available on the palette\n *\n * @param  {String} action\n * @param  {Event} event\n */\nPalette.prototype.trigger = function(action, event, autoActivate) {\n  var entries = this._entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n\n  // when user clicks on the palette and not on an action\n  if (!entry) {\n    return;\n  }\n\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      handler(originalEvent, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      handler[action](originalEvent, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\nPalette.prototype._layoutChanged = function() {\n  this._toggleState({});\n};\n\n/**\n * Do we need to collapse to two columns?\n *\n * @param {Number} availableHeight\n * @param {Object} entries\n *\n * @return {Boolean}\n */\nPalette.prototype._needsCollapse = function(availableHeight, entries) {\n\n  // top margin + bottom toggle + bottom margin\n  // implementors must override this method if they\n  // change the palette styles\n  var margin = 20 + 10 + 20;\n\n  var entriesHeight = Object.keys(entries).length * 46;\n\n  return availableHeight < entriesHeight + margin;\n};\n\n/**\n * Close the palette\n */\nPalette.prototype.close = function() {\n\n  this._toggleState({\n    open: false,\n    twoColumn: false\n  });\n};\n\n\n/**\n * Open the palette\n */\nPalette.prototype.open = function() {\n  this._toggleState({ open: true });\n};\n\n\nPalette.prototype.toggle = function(open) {\n  if (this.isOpen()) {\n    this.close();\n  } else {\n    this.open();\n  }\n};\n\nPalette.prototype.isActiveTool = function(tool) {\n  return tool && this._activeTool === tool;\n};\n\nPalette.prototype.updateToolHighlight = function(name) {\n  var entriesContainer,\n      toolsContainer;\n\n  if (!this._toolsContainer) {\n    entriesContainer = domQuery('.djs-palette-entries', this._container);\n\n    this._toolsContainer = domQuery('[data-group=tools]', entriesContainer);\n  }\n\n  toolsContainer = this._toolsContainer;\n\n  forEach(toolsContainer.children, function(tool) {\n    var actionName = tool.getAttribute('data-action');\n\n    if (!actionName) {\n      return;\n    }\n\n    var toolClasses = domClasses(tool);\n\n    actionName = actionName.replace('-tool', '');\n\n    if (toolClasses.contains('entry') && actionName === name) {\n      toolClasses.add('highlighted-entry');\n    } else {\n      toolClasses.remove('highlighted-entry');\n    }\n  });\n};\n\n\n/**\n * Return true if the palette is opened.\n *\n * @example\n *\n * palette.open();\n *\n * if (palette.isOpen()) {\n *   // yes, we are open\n * }\n *\n * @return {boolean} true if palette is opened\n */\nPalette.prototype.isOpen = function() {\n  return domClasses(this._container).has(PALETTE_OPEN_CLS);\n};\n\n/**\n * Get container the palette lives in.\n *\n * @return {Element}\n */\nPalette.prototype._getParentContainer = function() {\n  return this._canvas.getContainer();\n};\n\n\n/* markup definition */\n\nPalette.HTML_MARKUP =\n  '<div class=\"djs-palette\">' +\n    '<div class=\"djs-palette-entries\"></div>' +\n    '<div class=\"djs-palette-toggle\"></div>' +\n  '</div>';\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}\n\nfunction addPaletteEntries(entries, provider) {\n\n  var entriesOrUpdater = provider.getPaletteEntries();\n\n  if (isFunction(entriesOrUpdater)) {\n    return entriesOrUpdater(entries);\n  }\n\n  forEach(entriesOrUpdater, function(entry, id) {\n    entries[id] = entry;\n  });\n\n  return entries;\n}","import Palette from './Palette';\n\nexport default {\n  __init__: [ 'palette' ],\n  palette: [ 'type', Palette ]\n};\n","import { values } from 'min-dash';\n\nimport { getEnclosedElements } from '../../util/Elements';\n\nimport { hasSecondaryModifier } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar LASSO_TOOL_CURSOR = 'crosshair';\n\n\nexport default function LassoTool(\n    eventBus, canvas, dragging,\n    elementRegistry, selection, toolManager) {\n\n  this._selection = selection;\n  this._dragging = dragging;\n\n  var self = this;\n\n  // lasso visuals implementation\n\n  /**\n  * A helper that realizes the selection box visual\n  */\n  var visuals = {\n\n    create: function(context) {\n      var container = canvas.getDefaultLayer(),\n          frame;\n\n      frame = context.frame = svgCreate('rect');\n      svgAttr(frame, {\n        class: 'djs-lasso-overlay',\n        width:  1,\n        height: 1,\n        x: 0,\n        y: 0\n      });\n\n      svgAppend(container, frame);\n    },\n\n    update: function(context) {\n      var frame = context.frame,\n          bbox = context.bbox;\n\n      svgAttr(frame, {\n        x: bbox.x,\n        y: bbox.y,\n        width: bbox.width,\n        height: bbox.height\n      });\n    },\n\n    remove: function(context) {\n\n      if (context.frame) {\n        svgRemove(context.frame);\n      }\n    }\n  };\n\n  toolManager.registerTool('lasso', {\n    tool: 'lasso.selection',\n    dragging: 'lasso'\n  });\n\n  eventBus.on('lasso.selection.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return;\n    }\n\n    eventBus.once('lasso.selection.ended', function() {\n      self.activateLasso(event.originalEvent, true);\n    });\n  });\n\n  // lasso interaction implementation\n\n  eventBus.on('lasso.end', function(event) {\n\n    var bbox = toBBox(event);\n\n    var elements = elementRegistry.filter(function(element) {\n      return element;\n    });\n\n    self.select(elements, bbox);\n  });\n\n  eventBus.on('lasso.start', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.create(context);\n  });\n\n  eventBus.on('lasso.move', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.update(context);\n  });\n\n  eventBus.on('lasso.cleanup', function(event) {\n\n    var context = event.context;\n\n    visuals.remove(context);\n  });\n\n\n  // event integration\n\n  eventBus.on('element.mousedown', 1500, function(event) {\n\n    if (hasSecondaryModifier(event)) {\n      self.activateLasso(event.originalEvent);\n\n      // we've handled the event\n      return true;\n    }\n  });\n}\n\nLassoTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'elementRegistry',\n  'selection',\n  'toolManager'\n];\n\n\nLassoTool.prototype.activateLasso = function(event, autoActivate) {\n\n  this._dragging.init(event, 'lasso', {\n    autoActivate: autoActivate,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.activateSelection = function(event) {\n\n  this._dragging.init(event, 'lasso.selection', {\n    trapClick: false,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.select = function(elements, bbox) {\n  var selectedElements = getEnclosedElements(elements, bbox);\n\n  this._selection.select(values(selectedElements));\n};\n\nLassoTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nLassoTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^lasso/.test(context.prefix);\n};\n\n\n\nfunction toBBox(event) {\n\n  var start = {\n\n    x: event.x - event.dx,\n    y: event.y - event.dy\n  };\n\n  var end = {\n    x: event.x,\n    y: event.y\n  };\n\n  var bbox;\n\n  if ((start.x <= end.x && start.y < end.y) ||\n      (start.x < end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: start.y,\n      width:  end.x - start.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x >= end.x && start.y < end.y) ||\n             (start.x > end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: start.y,\n      width:  start.x - end.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x <= end.x && start.y > end.y) ||\n             (start.x < end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: end.y,\n      width:  end.x - start.x,\n      height: start.y - end.y\n    };\n  } else if ((start.x >= end.x && start.y > end.y) ||\n             (start.x > end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  start.x - end.x,\n      height: start.y - end.y\n    };\n  } else {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  0,\n      height: 0\n    };\n  }\n  return bbox;\n}\n","import ToolManagerModule from '../tool-manager';\n\nimport LassoTool from './LassoTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'lassoTool' ],\n  lassoTool: [ 'type', LassoTool ]\n};\n","import { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\n\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\n\n\nexport default function HandTool(eventBus, canvas, dragging, injector, toolManager) {\n  this._dragging = dragging;\n\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function(event) {\n    if (hasPrimaryModifier(event)) {\n      this.activateMove(event.originalEvent);\n\n      return false;\n    }\n  }, this);\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent)) {\n      return;\n    }\n\n    if (self.isActive()) {\n      return;\n    }\n\n    function activateMove(event) {\n      self.activateMove(event);\n\n      window.removeEventListener('mousemove', activateMove);\n    }\n\n    window.addEventListener('mousemove', activateMove);\n\n    function deactivateMove(e) {\n      if (!isSpace(e.keyEvent)) {\n        return;\n      }\n\n      window.removeEventListener('mousemove', activateMove);\n\n      keyboard.removeListener(deactivateMove, 'keyboard.keyup');\n\n      dragging.cancel();\n    }\n\n    keyboard.addListener(HIGH_PRIORITY, deactivateMove, 'keyboard.keyup');\n  }, 'keyboard.keydown');\n\n  eventBus.on('hand.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function() {\n      this.activateMove(event.originalEvent, { reactivate: true });\n    }, this);\n\n  }, this);\n\n\n  eventBus.on('hand.move.move', function(event) {\n    var scale = canvas.viewbox().scale;\n\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n\n  eventBus.on('hand.move.end', function(event) {\n    var context = event.context,\n        reactivate = context.reactivate;\n\n    // Don't reactivate if the user is using the keyboard keybinding\n    if (!hasPrimaryModifier(event) && reactivate) {\n\n      eventBus.once('hand.move.ended', function(event) {\n        this.activateHand(event.originalEvent, true, true);\n      }, this);\n\n    }\n\n    return false;\n  }, this);\n\n}\n\nHandTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'injector',\n  'toolManager'\n];\n\n\nHandTool.prototype.activateMove = function(event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateHand();\n  }\n};\n\nHandTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}","import ToolManagerModule from '../tool-manager';\n\nimport HandTool from './HandTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'handTool' ],\n  handTool: [ 'type', HandTool ]\n};\n","var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Connect} connect\n * @param {Canvas} canvas\n * @param {ToolManager} toolManager\n * @param {Rules} rules\n */\nexport default function GlobalConnect(\n    eventBus, dragging, connect,\n    canvas, toolManager, rules) {\n\n  var self = this;\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n\n  eventBus.on('global-connect.hover', function(event) {\n    var context = event.context,\n        startTarget = event.hover;\n\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget);\n\n    // simply ignore hover\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n\n  eventBus.on([ 'global-connect.out', 'global-connect.cleanup' ], function(event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n\n  eventBus.on([ 'global-connect.ended' ], function(event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n          x: event.x,\n          y: event.y\n        };\n\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function() {\n      eventBus.once([ 'connect.ended', 'connect.canceled' ], function() {\n        eventBus.fire('global-connect.drag.ended');\n      });\n\n      connect.start(null, startTarget, startPosition);\n    });\n\n    return false;\n  });\n}\n\nGlobalConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'connect',\n  'canvas',\n  'toolManager',\n  'rules'\n];\n\n/**\n * Initiates tool activity.\n */\nGlobalConnect.prototype.start = function(event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\nGlobalConnect.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {Boolean}\n */\nGlobalConnect.prototype.canStartConnect = function(startTarget) {\n  return this._rules.allowed('connection.start', { source: startTarget });\n};\n","import ConnectModule from '../connect';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport ToolManagerModule from '../tool-manager';\n\nimport GlobalConnect from './GlobalConnect';\n\nexport default {\n  __depends__: [\n    ConnectModule,\n    RulesModule,\n    DraggingModule,\n    ToolManagerModule\n  ],\n  globalConnect: [ 'type', GlobalConnect ]\n};\n","import {\n  assign\n} from 'min-dash';\n\n\n/**\n * A palette provider for BPMN 2.0 elements.\n */\nexport default function PaletteProvider(\n    palette, create, elementFactory,\n    spaceTool, lassoTool, handTool,\n    globalConnect, translate) {\n\n  this._palette = palette;\n  this._create = create;\n  this._elementFactory = elementFactory;\n  this._spaceTool = spaceTool;\n  this._lassoTool = lassoTool;\n  this._handTool = handTool;\n  this._globalConnect = globalConnect;\n  this._translate = translate;\n\n  palette.registerProvider(this);\n}\n\nPaletteProvider.$inject = [\n  'palette',\n  'create',\n  'elementFactory',\n  'spaceTool',\n  'lassoTool',\n  'handTool',\n  'globalConnect',\n  'translate'\n];\n\n\nPaletteProvider.prototype.getPaletteEntries = function(element) {\n\n  var actions = {},\n      create = this._create,\n      elementFactory = this._elementFactory,\n      spaceTool = this._spaceTool,\n      lassoTool = this._lassoTool,\n      handTool = this._handTool,\n      globalConnect = this._globalConnect,\n      translate = this._translate;\n\n  function createAction(type, group, className, title, options) {\n\n    function createListener(event) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n\n      if (options) {\n        shape.businessObject.di.isExpanded = options.isExpanded;\n      }\n\n      create.start(event, shape);\n    }\n\n    var shortType = type.replace(/^bpmn:/, '');\n\n    return {\n      group: group,\n      className: className,\n      title: title || translate('Create {type}', { type: shortType }),\n      action: {\n        dragstart: createListener,\n        click: createListener\n      }\n    };\n  }\n\n  function createSubprocess(event) {\n    var subProcess = elementFactory.createShape({\n      type: 'bpmn:SubProcess',\n      x: 0,\n      y: 0,\n      isExpanded: true\n    });\n\n    var startEvent = elementFactory.createShape({\n      type: 'bpmn:StartEvent',\n      x: 40,\n      y: 82,\n      parent: subProcess\n    });\n\n    create.start(event, [ subProcess, startEvent ], {\n      hints: {\n        autoSelect: [ startEvent ]\n      }\n    });\n  }\n\n  function createParticipant(event) {\n    create.start(event, elementFactory.createParticipantShape());\n  }\n\n  assign(actions, {\n    'hand-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-hand-tool',\n      title: translate('Activate the hand tool'),\n      action: {\n        click: function(event) {\n          handTool.activateHand(event);\n        }\n      }\n    },\n    'lasso-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-lasso-tool',\n      title: translate('Activate the lasso tool'),\n      action: {\n        click: function(event) {\n          lassoTool.activateSelection(event);\n        }\n      }\n    },\n    'space-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-space-tool',\n      title: translate('Activate the create/remove space tool'),\n      action: {\n        click: function(event) {\n          spaceTool.activateSelection(event);\n        }\n      }\n    },\n    'global-connect-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-connection-multi',\n      title: translate('Activate the global connect tool'),\n      action: {\n        click: function(event) {\n          globalConnect.toggle(event);\n        }\n      }\n    },\n    'tool-separator': {\n      group: 'tools',\n      separator: true\n    },\n    'create.start-event': createAction(\n      'bpmn:StartEvent', 'event', 'bpmn-icon-start-event-none',\n      translate('Create StartEvent')\n    ),\n    'create.intermediate-event': createAction(\n      'bpmn:IntermediateThrowEvent', 'event', 'bpmn-icon-intermediate-event-none',\n      translate('Create Intermediate/Boundary Event')\n    ),\n    'create.end-event': createAction(\n      'bpmn:EndEvent', 'event', 'bpmn-icon-end-event-none',\n      translate('Create EndEvent')\n    ),\n    'create.exclusive-gateway': createAction(\n      'bpmn:ExclusiveGateway', 'gateway', 'bpmn-icon-gateway-none',\n      translate('Create Gateway')\n    ),\n    'create.task': createAction(\n      'bpmn:Task', 'activity', 'bpmn-icon-task',\n      translate('Create Task')\n    ),\n    'create.data-object': createAction(\n      'bpmn:DataObjectReference', 'data-object', 'bpmn-icon-data-object',\n      translate('Create DataObjectReference')\n    ),\n    'create.data-store': createAction(\n      'bpmn:DataStoreReference', 'data-store', 'bpmn-icon-data-store',\n      translate('Create DataStoreReference')\n    ),\n    'create.subprocess-expanded': {\n      group: 'activity',\n      className: 'bpmn-icon-subprocess-expanded',\n      title: translate('Create expanded SubProcess'),\n      action: {\n        dragstart: createSubprocess,\n        click: createSubprocess\n      }\n    },\n    'create.participant-expanded': {\n      group: 'collaboration',\n      className: 'bpmn-icon-participant',\n      title: translate('Create Pool/Participant'),\n      action: {\n        dragstart: createParticipant,\n        click: createParticipant\n      }\n    },\n    'create.group': createAction(\n      'bpmn:Group', 'artifact', 'bpmn-icon-group',\n      translate('Create Group')\n    ),\n  });\n\n  return actions;\n};\n","import PaletteModule from 'diagram-js/lib/features/palette';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport SpaceToolModule from 'diagram-js/lib/features/space-tool';\nimport LassoToolModule from 'diagram-js/lib/features/lasso-tool';\nimport HandToolModule from 'diagram-js/lib/features/hand-tool';\nimport GlobalConnectModule from 'diagram-js/lib/features/global-connect';\nimport translate from 'diagram-js/lib/i18n/translate';\n\nimport PaletteProvider from './PaletteProvider';\n\nexport default {\n  __depends__: [\n    PaletteModule,\n    CreateModule,\n    SpaceToolModule,\n    LassoToolModule,\n    HandToolModule,\n    GlobalConnectModule,\n    translate\n  ],\n  __init__: [ 'paletteProvider' ],\n  paletteProvider: [ 'type', PaletteProvider ]\n};\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport inherits from 'inherits';\n\nimport cssEscape from 'css.escape';\n\nimport {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  attr as svgAttr\n} from 'tiny-svg';\n\nvar LOW_PRIORITY = 250;\n\n\nexport default function BpmnReplacePreview(\n    eventBus, elementRegistry, elementFactory,\n    canvas, previewSupport) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Replace the visuals of all elements in the context which can be replaced\n   *\n   * @param  {Object} context\n   */\n  function replaceVisual(context) {\n\n    var replacements = context.canExecute.replacements;\n\n    forEach(replacements, function(replacement) {\n\n      var id = replacement.oldElementId;\n\n      var newElement = {\n        type: replacement.newElementType\n      };\n\n      // if the visual of the element is already replaced\n      if (context.visualReplacements[id]) {\n        return;\n      }\n\n      var element = elementRegistry.get(id);\n\n      assign(newElement, { x: element.x, y: element.y });\n\n      // create a temporary shape\n      var tempShape = elementFactory.createShape(newElement);\n\n      canvas.addShape(tempShape, element.parent);\n\n      // select the original SVG element related to the element and hide it\n      var gfx = domQuery('[data-element-id=\"' + cssEscape(element.id) + '\"]', context.dragGroup);\n\n      if (gfx) {\n        svgAttr(gfx, { display: 'none' });\n      }\n\n      // clone the gfx of the temporary shape and add it to the drag group\n      var dragger = previewSupport.addDragger(tempShape, context.dragGroup);\n\n      context.visualReplacements[id] = dragger;\n\n      canvas.removeShape(tempShape);\n    });\n  }\n\n  /**\n   * Restore the original visuals of the previously replaced elements\n   *\n   * @param  {Object} context\n   */\n  function restoreVisual(context) {\n\n    var visualReplacements = context.visualReplacements;\n\n    forEach(visualReplacements, function(dragger, id) {\n\n      var originalGfx = domQuery('[data-element-id=\"' + cssEscape(id) + '\"]', context.dragGroup);\n\n      if (originalGfx) {\n        svgAttr(originalGfx, { display: 'inline' });\n      }\n\n      dragger.remove();\n\n      if (visualReplacements[id]) {\n        delete visualReplacements[id];\n      }\n    });\n  }\n\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        canExecute = context.canExecute;\n\n    if (!context.visualReplacements) {\n      context.visualReplacements = {};\n    }\n\n    if (canExecute && canExecute.replacements) {\n      replaceVisual(context);\n    } else {\n      restoreVisual(context);\n    }\n  });\n}\n\nBpmnReplacePreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'elementFactory',\n  'canvas',\n  'previewSupport'\n];\n\ninherits(BpmnReplacePreview, CommandInterceptor);","import PreviewSupportModule from 'diagram-js/lib/features/preview-support';\n\nimport BpmnReplacePreview from './BpmnReplacePreview';\n\nexport default {\n  __depends__: [\n    PreviewSupportModule\n  ],\n  __init__: [ 'bpmnReplacePreview' ],\n  bpmnReplacePreview: [ 'type', BpmnReplacePreview ]\n};\n","import {\r\n  mid,\r\n  setSnapped\r\n} from 'diagram-js/lib/features/snapping/SnapUtil';\r\n\r\nimport { isCmd } from 'diagram-js/lib/features/keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  getOrientation\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nimport { is } from '../../util/ModelUtil';\r\n\r\nimport { isAny } from '../modeling/util/ModelingUtil';\r\n\r\nimport { some } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\nvar BOUNDARY_TO_HOST_THRESHOLD = 40;\r\n\r\nvar TARGET_BOUNDS_PADDING = 20,\r\n    TASK_BOUNDS_PADDING = 10;\r\n\r\nvar TARGET_CENTER_PADDING = 20;\r\n\r\nvar AXES = [ 'x', 'y' ];\r\n\r\nvar abs = Math.abs;\r\n\r\n/**\r\n * Snap during connect.\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nexport default function BpmnConnectSnapping(eventBus) {\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.move',\r\n    'connect.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        canExecute = context.canExecute,\r\n        start = context.start,\r\n        hover = context.hover,\r\n        source = context.source,\r\n        target = context.target;\r\n\r\n    // do NOT snap on CMD\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (!context.initialConnectionStart) {\r\n      context.initialConnectionStart = context.connectionStart;\r\n    }\r\n\r\n    // snap hover\r\n    if (canExecute && hover) {\r\n      snapToShape(event, hover, getTargetBoundsPadding(hover));\r\n    }\r\n\r\n    if (hover && isAnyType(canExecute, [\r\n      'bpmn:Association',\r\n      'bpmn:DataInputAssociation',\r\n      'bpmn:DataOutputAssociation',\r\n      'bpmn:SequenceFlow'\r\n    ])) {\r\n      context.connectionStart = mid(start);\r\n\r\n      // snap hover\r\n      if (isAny(hover, [ 'bpmn:Event', 'bpmn:Gateway' ])) {\r\n        snapToPosition(event, mid(hover));\r\n      }\r\n\r\n      // snap hover\r\n      if (isAny(hover, [ 'bpmn:Task', 'bpmn:SubProcess' ])) {\r\n        snapToTargetMid(event, hover);\r\n      }\r\n\r\n      // snap source and target\r\n      if (is(source, 'bpmn:BoundaryEvent') && target === source.host) {\r\n        snapBoundaryEventLoop(event);\r\n      }\r\n\r\n    } else if (isType(canExecute, 'bpmn:MessageFlow')) {\r\n\r\n      if (is(start, 'bpmn:Event')) {\r\n\r\n        // snap start\r\n        context.connectionStart = mid(start);\r\n      }\r\n\r\n      if (is(hover, 'bpmn:Event')) {\r\n\r\n        // snap hover\r\n        snapToPosition(event, mid(hover));\r\n      }\r\n\r\n    } else {\r\n\r\n      // un-snap source\r\n      context.connectionStart = context.initialConnectionStart;\r\n    }\r\n  });\r\n}\r\n\r\nBpmnConnectSnapping.$inject = [ 'eventBus' ];\r\n\r\n\r\n// helpers //////////\r\n\r\n// snap to target if event in target\r\nfunction snapToShape(event, target, padding) {\r\n  AXES.forEach(function(axis) {\r\n    var dimensionForAxis = getDimensionForAxis(axis, target);\r\n\r\n    if (event[ axis ] < target[ axis ] + padding) {\r\n      setSnapped(event, axis, target[ axis ] + padding);\r\n    } else if (event[ axis ] > target[ axis ] + dimensionForAxis - padding) {\r\n      setSnapped(event, axis, target[ axis ] + dimensionForAxis - padding);\r\n    }\r\n  });\r\n}\r\n\r\n// snap to target mid if event in target mid\r\nfunction snapToTargetMid(event, target) {\r\n  var targetMid = mid(target);\r\n\r\n  AXES.forEach(function(axis) {\r\n    if (isMid(event, target, axis)) {\r\n      setSnapped(event, axis, targetMid[ axis ]);\r\n    }\r\n  });\r\n}\r\n\r\n// snap to prevent loop overlapping boundary event\r\nfunction snapBoundaryEventLoop(event) {\r\n  var context = event.context,\r\n      source = context.source,\r\n      target = context.target;\r\n\r\n  if (isReverse(context)) {\r\n    return;\r\n  }\r\n\r\n  var sourceMid = mid(source),\r\n      orientation = getOrientation(sourceMid, target, -10),\r\n      axes = [];\r\n\r\n  if (/top|bottom/.test(orientation)) {\r\n    axes.push('x');\r\n  }\r\n\r\n  if (/left|right/.test(orientation)) {\r\n    axes.push('y');\r\n  }\r\n\r\n  axes.forEach(function(axis) {\r\n    var coordinate = event[ axis ], newCoordinate;\r\n\r\n    if (abs(coordinate - sourceMid[ axis ]) < BOUNDARY_TO_HOST_THRESHOLD) {\r\n      if (coordinate > sourceMid[ axis ]) {\r\n        newCoordinate = sourceMid[ axis ] + BOUNDARY_TO_HOST_THRESHOLD;\r\n      }\r\n      else {\r\n        newCoordinate = sourceMid[ axis ] - BOUNDARY_TO_HOST_THRESHOLD;\r\n      }\r\n\r\n      setSnapped(event, axis, newCoordinate);\r\n    }\r\n  });\r\n}\r\n\r\nfunction snapToPosition(event, position) {\r\n  setSnapped(event, 'x', position.x);\r\n  setSnapped(event, 'y', position.y);\r\n}\r\n\r\nfunction isType(attrs, type) {\r\n  return attrs && attrs.type === type;\r\n}\r\n\r\nfunction isAnyType(attrs, types) {\r\n  return some(types, function(type) {\r\n    return isType(attrs, type);\r\n  });\r\n}\r\n\r\nfunction getDimensionForAxis(axis, element) {\r\n  return axis === 'x' ? element.width : element.height;\r\n}\r\n\r\nfunction getTargetBoundsPadding(target) {\r\n  if (is(target, 'bpmn:Task')) {\r\n    return TASK_BOUNDS_PADDING;\r\n  } else {\r\n    return TARGET_BOUNDS_PADDING;\r\n  }\r\n}\r\n\r\nfunction isMid(event, target, axis) {\r\n  return event[ axis ] > target[ axis ] + TARGET_CENTER_PADDING\r\n    && event[ axis ] < target[ axis ] + getDimensionForAxis(axis, target) - TARGET_CENTER_PADDING;\r\n}\r\n\r\nfunction isReverse(context) {\r\n  var hover = context.hover,\r\n      source = context.source;\r\n\r\n  return hover && source && hover === source;\r\n}","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  snapTo\n} from './SnapUtil';\n\n\n/**\n * A snap context, containing the (possibly incomplete)\n * mappings of drop targets (to identify the snapping)\n * to computed snap points.\n */\nexport default function SnapContext() {\n\n  /**\n   * Map<String, SnapPoints> mapping drop targets to\n   * a list of possible snappings.\n   *\n   * @type {Object}\n   */\n  this._targets = {};\n\n  /**\n   * Map<String, Point> initial positioning of element\n   * regarding various snap directions.\n   *\n   * @type {Object}\n   */\n  this._snapOrigins = {};\n\n  /**\n   * List of snap locations\n   *\n   * @type {Array<String>}\n   */\n  this._snapLocations = [];\n\n  /**\n   * Map<String, Array<Point>> of default snapping locations\n   *\n   * @type {Object}\n   */\n  this._defaultSnaps = {};\n}\n\n\nSnapContext.prototype.getSnapOrigin = function(snapLocation) {\n  return this._snapOrigins[snapLocation];\n};\n\n\nSnapContext.prototype.setSnapOrigin = function(snapLocation, initialValue) {\n  this._snapOrigins[snapLocation] = initialValue;\n\n  if (this._snapLocations.indexOf(snapLocation) === -1) {\n    this._snapLocations.push(snapLocation);\n  }\n};\n\n\nSnapContext.prototype.addDefaultSnap = function(type, point) {\n\n  var snapValues = this._defaultSnaps[type];\n\n  if (!snapValues) {\n    snapValues = this._defaultSnaps[type] = [];\n  }\n\n  snapValues.push(point);\n};\n\n/**\n * Return a number of initialized snaps, i.e. snap locations such as\n * top-left, mid, bottom-right and so forth.\n *\n * @return {Array<String>} snapLocations\n */\nSnapContext.prototype.getSnapLocations = function() {\n  return this._snapLocations;\n};\n\n/**\n * Set the snap locations for this context.\n *\n * The order of locations determines precedence.\n *\n * @param {Array<String>} snapLocations\n */\nSnapContext.prototype.setSnapLocations = function(snapLocations) {\n  this._snapLocations = snapLocations;\n};\n\n/**\n * Get snap points for a given target\n *\n * @param {Element|String} target\n */\nSnapContext.prototype.pointsForTarget = function(target) {\n\n  var targetId = target.id || target;\n\n  var snapPoints = this._targets[targetId];\n\n  if (!snapPoints) {\n    snapPoints = this._targets[targetId] = new SnapPoints();\n    snapPoints.initDefaults(this._defaultSnaps);\n  }\n\n  return snapPoints;\n};\n\n\n/**\n * Creates the snap points and initializes them with the\n * given default values.\n *\n * @param {Object<String, Array<Point>>} [defaultPoints]\n */\nexport function SnapPoints(defaultSnaps) {\n\n  /**\n   * Map<String, Map<(x|y), Array<Number>>> mapping snap locations,\n   * i.e. top-left, bottom-right, center to actual snap values.\n   *\n   * @type {Object}\n   */\n  this._snapValues = {};\n}\n\nSnapPoints.prototype.add = function(snapLocation, point) {\n\n  var snapValues = this._snapValues[snapLocation];\n\n  if (!snapValues) {\n    snapValues = this._snapValues[snapLocation] = { x: [], y: [] };\n  }\n\n  if (snapValues.x.indexOf(point.x) === -1) {\n    snapValues.x.push(point.x);\n  }\n\n  if (snapValues.y.indexOf(point.y) === -1) {\n    snapValues.y.push(point.y);\n  }\n};\n\n\nSnapPoints.prototype.snap = function(point, snapLocation, axis, tolerance) {\n  var snappingValues = this._snapValues[snapLocation];\n\n  return snappingValues && snapTo(point[axis], snappingValues[axis], tolerance);\n};\n\n/**\n * Initialize a number of default snapping points.\n *\n * @param  {Object} defaultSnaps\n */\nSnapPoints.prototype.initDefaults = function(defaultSnaps) {\n\n  var self = this;\n\n  forEach(defaultSnaps || {}, function(snapPoints, snapLocation) {\n    forEach(snapPoints, function(point) {\n      self.add(snapLocation, point);\n    });\n  });\n};","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  getChildren,\r\n  isSnapped,\r\n  mid\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  forEach,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during create and move.\r\n *\r\n * @param {EventBus} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function CreateMoveSnapping(elementRegistry, eventBus, snapping) {\r\n  var self = this;\r\n\r\n  this._elementRegistry = elementRegistry;\r\n\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        snapContext = context.snapContext,\r\n        target = context.target;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event) || !target) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(target);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, target);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.cleanup',\r\n    'shape.move.cleanup'\r\n  ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nCreateMoveSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nCreateMoveSnapping.prototype.initSnap = function(event) {\r\n  var elementRegistry = this._elementRegistry;\r\n\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var shapeMid;\r\n\r\n  if (elementRegistry.get(shape.id)) {\r\n\r\n    // move\r\n    shapeMid = mid(shape, event);\r\n  } else {\r\n\r\n    // create\r\n    shapeMid = {\r\n      x: event.x + mid(shape).x,\r\n      y: event.y + mid(shape).y\r\n    };\r\n  }\r\n\r\n  var shapeTopLeft = {\r\n        x: shapeMid.x - shape.width / 2,\r\n        y: shapeMid.y - shape.height / 2\r\n      },\r\n      shapeBottomRight = {\r\n        x: shapeMid.x + shape.width / 2,\r\n        y: shapeMid.y + shape.height / 2\r\n      };\r\n\r\n  snapContext.setSnapOrigin('mid', {\r\n    x: shapeMid.x - event.x,\r\n    y: shapeMid.y - event.y\r\n  });\r\n\r\n  // snap labels to mid only\r\n  if (isLabel(shape)) {\r\n    return snapContext;\r\n  }\r\n\r\n  snapContext.setSnapOrigin('top-left', {\r\n    x: shapeTopLeft.x - event.x,\r\n    y: shapeTopLeft.y - event.y\r\n  });\r\n\r\n  snapContext.setSnapOrigin('bottom-right', {\r\n    x: shapeBottomRight.x - event.x,\r\n    y: shapeBottomRight.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n\r\n    // handle labels\r\n    if (isLabel(snapTarget)) {\r\n\r\n      if (isLabel(shape)) {\r\n        snapPoints.add('mid', mid(snapTarget));\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // handle connections\r\n    if (isConnection(snapTarget)) {\r\n\r\n      // ignore single segment connections\r\n      if (snapTarget.waypoints.length < 3) {\r\n        return;\r\n      }\r\n\r\n      // ignore first and last waypoint\r\n      var waypoints = snapTarget.waypoints.slice(1, -1);\r\n\r\n      forEach(waypoints, function(waypoint) {\r\n        snapPoints.add('mid', waypoint);\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    // handle shapes\r\n    snapPoints.add('mid', mid(snapTarget));\r\n  });\r\n\r\n  if (!isNumber(shape.x) || !isNumber(shape.y)) {\r\n    return snapPoints;\r\n  }\r\n\r\n  // snap to original position when moving\r\n  if (this._elementRegistry.get(shape.id)) {\r\n    snapPoints.add('mid', mid(shape));\r\n  }\r\n\r\n  return snapPoints;\r\n};\r\n\r\nCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isHidden(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}","import inherits from 'inherits';\n\nimport CreateMoveSnapping from 'diagram-js/lib/features/snapping/CreateMoveSnapping';\n\nimport {\n  isSnapped,\n  setSnapped,\n  topLeft,\n  bottomRight\n} from 'diagram-js/lib/features/snapping/SnapUtil';\n\nimport { isExpanded } from '../../util/DiUtil';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  asTRBL,\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport { getBoundaryAttachment } from './BpmnSnappingUtil';\n\nimport { forEach } from 'min-dash';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Snap during create and move.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function BpmnCreateMoveSnapping(eventBus, injector) {\n  injector.invoke(CreateMoveSnapping, this);\n\n  // creating first participant\n  eventBus.on([ 'create.move', 'create.end' ], HIGH_PRIORITY, setSnappedIfConstrained);\n\n  // snap boundary events\n  eventBus.on([\n    'create.move',\n    'create.end',\n    'shape.move.move',\n    'shape.move.end'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        target = context.target;\n\n    var canAttach = canExecute && (canExecute === 'attach' || canExecute.attach);\n\n    if (canAttach && !isSnapped(event)) {\n      snapBoundaryEvent(event, target);\n    }\n  });\n}\n\ninherits(BpmnCreateMoveSnapping, CreateMoveSnapping);\n\nBpmnCreateMoveSnapping.$inject = [\n  'eventBus',\n  'injector'\n];\n\nBpmnCreateMoveSnapping.prototype.initSnap = function(event) {\n  var snapContext = CreateMoveSnapping.prototype.initSnap.call(this, event);\n\n  var shape = event.shape;\n\n  var isMove = !!this._elementRegistry.get(shape.id);\n\n  // snap to docking points\n  forEach(shape.outgoing, function(connection) {\n    var docking = connection.waypoints[0];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', getDockingSnapOrigin(docking, isMove, event));\n  });\n\n  forEach(shape.incoming, function(connection) {\n    var docking = connection.waypoints[connection.waypoints.length - 1];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', getDockingSnapOrigin(docking, isMove, event));\n  });\n\n  if (is(shape, 'bpmn:Participant')) {\n\n    // snap to borders with higher priority\n    snapContext.setSnapLocations([ 'top-left', 'bottom-right', 'mid' ]);\n  }\n\n  return snapContext;\n};\n\nBpmnCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\n  CreateMoveSnapping.prototype.addSnapTargetPoints.call(this, snapPoints, shape, target);\n\n  var snapTargets = this.getSnapTargets(shape, target);\n\n  forEach(snapTargets, function(snapTarget) {\n\n    // handle TRBL alignment\n    //\n    // * with container elements\n    // * with text annotations\n    if (isContainer(snapTarget) || areAll([ shape, snapTarget ], 'bpmn:TextAnnotation')) {\n      snapPoints.add('top-left', topLeft(snapTarget));\n      snapPoints.add('bottom-right', bottomRight(snapTarget));\n    }\n  });\n\n  var elementRegistry = this._elementRegistry;\n\n  // snap to docking points if not create mode\n  forEach(shape.incoming, function(connection) {\n    if (elementRegistry.get(shape.id)) {\n\n      if (!includes(snapTargets, connection.source)) {\n        snapPoints.add('mid', getMid(connection.source));\n      }\n\n      var docking = connection.waypoints[0];\n      snapPoints.add(connection.id + '-docking', docking.original || docking);\n    }\n  });\n\n  forEach(shape.outgoing, function(connection) {\n    if (elementRegistry.get(shape.id)) {\n\n      if (!includes(snapTargets, connection.target)) {\n        snapPoints.add('mid', getMid(connection.target));\n      }\n\n      var docking = connection.waypoints[ connection.waypoints.length - 1 ];\n\n      snapPoints.add(connection.id + '-docking', docking.original || docking);\n    }\n  });\n\n  // add sequence flow parents as snap targets\n  if (is(target, 'bpmn:SequenceFlow')) {\n    snapPoints = this.addSnapTargetPoints(snapPoints, shape, target.parent);\n  }\n\n  return snapPoints;\n};\n\nBpmnCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\n  return CreateMoveSnapping.prototype.getSnapTargets.call(this, shape, target)\n    .filter(function(snapTarget) {\n\n      // do not snap to lanes\n      return !is(snapTarget, 'bpmn:Lane');\n    });\n};\n\n// helpers //////////\n\nfunction snapBoundaryEvent(event, target) {\n  var targetTRBL = asTRBL(target);\n\n  var direction = getBoundaryAttachment(event, target);\n\n  var context = event.context,\n      shape = context.shape;\n\n  var offset;\n\n  if (shape.parent) {\n    offset = { x: 0, y: 0 };\n  } else {\n    offset = getMid(shape);\n  }\n\n  if (/top/.test(direction)) {\n    setSnapped(event, 'y', targetTRBL.top - offset.y);\n  } else if (/bottom/.test(direction)) {\n    setSnapped(event, 'y', targetTRBL.bottom - offset.y);\n  }\n\n  if (/left/.test(direction)) {\n    setSnapped(event, 'x', targetTRBL.left - offset.x);\n  } else if (/right/.test(direction)) {\n    setSnapped(event, 'x', targetTRBL.right - offset.x);\n  }\n}\n\nfunction areAll(elements, type) {\n  return elements.every(function(el) {\n    return is(el, type);\n  });\n}\n\nfunction isContainer(element) {\n  if (is(element, 'bpmn:SubProcess') && isExpanded(element)) {\n    return true;\n  }\n\n  return is(element, 'bpmn:Participant');\n}\n\n\nfunction setSnappedIfConstrained(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  var top = createConstraints.top,\n      right = createConstraints.right,\n      bottom = createConstraints.bottom,\n      left = createConstraints.left;\n\n  if ((left && left >= event.x) || (right && right <= event.x)) {\n    setSnapped(event, 'x', event.x);\n  }\n\n  if ((top && top >= event.y) || (bottom && bottom <= event.y)) {\n    setSnapped(event, 'y', event.y);\n  }\n}\n\nfunction includes(array, value) {\n  return array.indexOf(value) !== -1;\n}\n\nfunction getDockingSnapOrigin(docking, isMove, event) {\n  return isMove ? (\n    {\n      x: docking.x - event.x,\n      y: docking.y - event.y\n    }\n  ) : {\n    x: docking.x,\n    y: docking.y\n  };\n}\n","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  bottomRight,\r\n  getChildren,\r\n  isSnapped,\r\n  setSnapped,\r\n  topLeft,\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  asTRBL,\r\n  getMid\r\n} from '../../layout/LayoutUtil';\r\n\r\nimport { forEach } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function ResizeSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([ 'resize.start' ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'resize.move',\r\n    'resize.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent,\r\n        direction = context.direction,\r\n        snapContext = context.snapContext;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event)) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(parent);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    if (isHorizontal(direction)) {\r\n      setSnapped(event, 'x', event.x);\r\n    }\r\n\r\n    if (isVertical(direction)) {\r\n      setSnapped(event, 'y', event.y);\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([ 'resize.cleanup' ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nResizeSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      direction = context.direction,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var snapOrigin = getSnapOrigin(shape, direction);\r\n\r\n  snapContext.setSnapOrigin('corner', {\r\n    x: snapOrigin.x - event.x,\r\n    y: snapOrigin.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nResizeSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target, direction) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n    snapPoints.add('corner', bottomRight(snapTarget));\r\n    snapPoints.add('corner', topLeft(snapTarget));\r\n  });\r\n\r\n  snapPoints.add('corner', getSnapOrigin(shape, direction));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nResizeSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nResizeSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isAttached(child, shape)\r\n      && !isConnection(child)\r\n      && !isHidden(child)\r\n      && !isLabel(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction getSnapOrigin(shape, direction) {\r\n  var mid = getMid(shape),\r\n      trbl = asTRBL(shape);\r\n\r\n  var snapOrigin = {\r\n    x: mid.x,\r\n    y: mid.y\r\n  };\r\n\r\n  if (direction.indexOf('n') !== -1) {\r\n    snapOrigin.y = trbl.top;\r\n  } else if (direction.indexOf('s') !== -1) {\r\n    snapOrigin.y = trbl.bottom;\r\n  }\r\n\r\n  if (direction.indexOf('e') !== -1) {\r\n    snapOrigin.x = trbl.right;\r\n  } else if (direction.indexOf('w') !== -1) {\r\n    snapOrigin.x = trbl.left;\r\n  }\r\n\r\n  return snapOrigin;\r\n}\r\n\r\nfunction isAttached(element, host) {\r\n  return element.host === host;\r\n}\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}\r\n\r\nfunction isHorizontal(direction) {\r\n  return direction === 'n' || direction === 's';\r\n}\r\n\r\nfunction isVertical(direction) {\r\n  return direction === 'e' || direction === 'w';\r\n}","import {\n  bind,\n  debounce,\n  forEach,\n  isNumber,\n  isObject\n} from 'min-dash';\n\nimport {\n  isSnapped,\n  setSnapped\n} from './SnapUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nvar SNAP_TOLERANCE = 7;\n\nexport var SNAP_LINE_HIDE_DELAY = 1000;\n\n\n/**\n * Generic snapping feature.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Snapping(canvas) {\n  this._canvas = canvas;\n\n  // delay hide by 1000 seconds since last snap\n  this._asyncHide = debounce(bind(this.hide, this), SNAP_LINE_HIDE_DELAY);\n}\n\nSnapping.$inject = [ 'canvas' ];\n\n/**\n * Snap an event to given snap points.\n *\n * @param {Event} event\n * @param {SnapPoints} snapPoints\n */\nSnapping.prototype.snap = function(event, snapPoints) {\n  var context = event.context,\n      snapContext = context.snapContext,\n      snapLocations = snapContext.getSnapLocations();\n\n  var snapping = {\n    x: isSnapped(event, 'x'),\n    y: isSnapped(event, 'y')\n  };\n\n  forEach(snapLocations, function(location) {\n    var snapOrigin = snapContext.getSnapOrigin(location);\n\n    var snapCurrent = {\n      x: event.x + snapOrigin.x,\n      y: event.y + snapOrigin.y\n    };\n\n    // snap both axis if not snapped already\n    forEach([ 'x', 'y' ], function(axis) {\n      var locationSnapping;\n\n      if (!snapping[axis]) {\n        locationSnapping = snapPoints.snap(snapCurrent, location, axis, SNAP_TOLERANCE);\n\n        if (locationSnapping !== undefined) {\n          snapping[axis] = {\n            value: locationSnapping,\n            originValue: locationSnapping - snapOrigin[axis]\n          };\n        }\n      }\n    });\n\n    // no need to continue snapping\n    if (snapping.x && snapping.y) {\n      return false;\n    }\n  });\n\n  // show snap lines\n  this.showSnapLine('vertical', snapping.x && snapping.x.value);\n  this.showSnapLine('horizontal', snapping.y && snapping.y.value);\n\n  // snap event\n  forEach([ 'x', 'y' ], function(axis) {\n    var axisSnapping = snapping[axis];\n\n    if (isObject(axisSnapping)) {\n      setSnapped(event, axis, axisSnapping.originValue);\n    }\n  });\n};\n\nSnapping.prototype._createLine = function(orientation) {\n  var root = this._canvas.getLayer('snap');\n\n  var line = svgCreate('path');\n\n  svgAttr(line, { d: 'M0,0 L0,0' });\n\n  svgClasses(line).add('djs-snap-line');\n\n  svgAppend(root, line);\n\n  return {\n    update: function(position) {\n\n      if (!isNumber(position)) {\n        svgAttr(line, { display: 'none' });\n      } else {\n        if (orientation === 'horizontal') {\n          svgAttr(line, {\n            d: 'M-100000,' + position + ' L+100000,' + position,\n            display: ''\n          });\n        } else {\n          svgAttr(line, {\n            d: 'M ' + position + ',-100000 L ' + position + ', +100000',\n            display: ''\n          });\n        }\n      }\n    }\n  };\n};\n\nSnapping.prototype._createSnapLines = function() {\n  this._snapLines = {\n    horizontal: this._createLine('horizontal'),\n    vertical: this._createLine('vertical')\n  };\n};\n\nSnapping.prototype.showSnapLine = function(orientation, position) {\n\n  var line = this.getSnapLine(orientation);\n\n  if (line) {\n    line.update(position);\n  }\n\n  this._asyncHide();\n};\n\nSnapping.prototype.getSnapLine = function(orientation) {\n  if (!this._snapLines) {\n    this._createSnapLines();\n  }\n\n  return this._snapLines[orientation];\n};\n\nSnapping.prototype.hide = function() {\n  forEach(this._snapLines, function(snapLine) {\n    snapLine.update();\n  });\n};\n","import CreateMoveSnapping from './CreateMoveSnapping';\nimport ResizeSnapping from './ResizeSnapping';\nimport Snapping from './Snapping';\n\nexport default {\n  __init__: [\n    'createMoveSnapping',\n    'resizeSnapping',\n    'snapping'\n  ],\n  createMoveSnapping: [ 'type', CreateMoveSnapping ],\n  resizeSnapping: [ 'type', ResizeSnapping ],\n  snapping: [ 'type', Snapping ]\n};","import BpmnConnectSnapping from './BpmnConnectSnapping';\nimport BpmnCreateMoveSnapping from './BpmnCreateMoveSnapping';\nimport SnappingModule from 'diagram-js/lib/features/snapping';\n\nexport default {\n  __depends__: [ SnappingModule ],\n  __init__: [\n    'connectSnapping',\n    'createMoveSnapping'\n  ],\n  connectSnapping: [ 'type', BpmnConnectSnapping ],\n  createMoveSnapping: [ 'type', BpmnCreateMoveSnapping ]\n};","import {\n  clear as domClear,\n  delegate as domDelegate,\n  query as domQuery,\n  classes as domClasses,\n  attr as domAttr,\n  domify as domify\n} from 'min-dom';\n\nimport {\n  getBBox as getBoundingBox\n} from '../../util/Elements';\n\nimport {\n  escapeHTML\n} from '../../util/EscapeUtil';\n\n/**\n * Provides searching infrastructure\n */\nexport default function SearchPad(canvas, eventBus, overlays, selection) {\n  this._open = false;\n  this._results = [];\n  this._eventMaps = [];\n\n  this._canvas = canvas;\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n  this._selection = selection;\n\n  // setup elements\n  this._container = domify(SearchPad.BOX_HTML);\n  this._searchInput = domQuery(SearchPad.INPUT_SELECTOR, this._container);\n  this._resultsContainer = domQuery(SearchPad.RESULTS_CONTAINER_SELECTOR, this._container);\n\n  // attach search pad\n  this._canvas.getContainer().appendChild(this._container);\n\n  // cleanup on destroy\n  eventBus.on([ 'canvas.destroy', 'diagram.destroy' ], this.close, this);\n}\n\n\nSearchPad.$inject = [\n  'canvas',\n  'eventBus',\n  'overlays',\n  'selection'\n];\n\n\n/**\n * Binds and keeps track of all event listereners\n */\nSearchPad.prototype._bindEvents = function() {\n  var self = this;\n\n  function listen(el, selector, type, fn) {\n    self._eventMaps.push({\n      el: el,\n      type: type,\n      listener: domDelegate.bind(el, selector, type, fn)\n    });\n  }\n\n  // close search on clicking anywhere outside\n  listen(document, 'html', 'click', function(e) {\n    self.close();\n  });\n\n  // stop event from propagating and closing search\n  // focus on input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    e.delegateTarget.focus();\n  });\n\n  // preselect result on hover\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'mouseover', function(e) {\n    e.stopPropagation();\n    self._scrollToNode(e.delegateTarget);\n    self._preselect(e.delegateTarget);\n  });\n\n  // selects desired result on mouse click\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    self._select(e.delegateTarget);\n  });\n\n  // prevent cursor in input from going left and right when using up/down to\n  // navigate results\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keydown', function(e) {\n\n    // up\n    if (e.keyCode === 38) {\n      e.preventDefault();\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      e.preventDefault();\n    }\n  });\n\n  // handle keyboard input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keyup', function(e) {\n\n    // escape\n    if (e.keyCode === 27) {\n      return self.close();\n    }\n\n    // enter\n    if (e.keyCode === 13) {\n      var selected = self._getCurrentResult();\n\n      return selected ? self._select(selected) : self.close();\n    }\n\n    // up\n    if (e.keyCode === 38) {\n      return self._scrollToDirection(true);\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      return self._scrollToDirection();\n    }\n\n    // left && right\n    // do not search while navigating text input\n    if (e.keyCode === 37 || e.keyCode === 39) {\n      return;\n    }\n\n    // anything else\n    self._search(e.delegateTarget.value);\n  });\n};\n\n\n/**\n * Unbinds all previously established listeners\n */\nSearchPad.prototype._unbindEvents = function() {\n  this._eventMaps.forEach(function(m) {\n    domDelegate.unbind(m.el, m.type, m.listener);\n  });\n};\n\n\n/**\n * Performs a search for the given pattern.\n *\n * @param  {String} pattern\n */\nSearchPad.prototype._search = function(pattern) {\n  var self = this;\n\n  this._clearResults();\n\n  // do not search on empty query\n  if (!pattern || pattern === '') {\n    return;\n  }\n\n  var searchResults = this._searchProvider.find(pattern);\n\n  if (!searchResults.length) {\n    return;\n  }\n\n  // append new results\n  searchResults.forEach(function(result) {\n    var id = result.element.id;\n    var node = self._createResultNode(result, id);\n    self._results[id] = {\n      element: result.element,\n      node: node\n    };\n  });\n\n  // preselect first result\n  var node = domQuery(SearchPad.RESULT_SELECTOR, this._resultsContainer);\n  this._scrollToNode(node);\n  this._preselect(node);\n};\n\n\n/**\n * Navigate to the previous/next result. Defaults to next result.\n * @param  {Boolean} previous\n */\nSearchPad.prototype._scrollToDirection = function(previous) {\n  var selected = this._getCurrentResult();\n  if (!selected) {\n    return;\n  }\n\n  var node = previous ? selected.previousElementSibling : selected.nextElementSibling;\n  if (node) {\n    this._scrollToNode(node);\n    this._preselect(node);\n  }\n};\n\n\n/**\n * Scroll to the node if it is not visible.\n *\n * @param  {Element} node\n */\nSearchPad.prototype._scrollToNode = function(node) {\n  if (!node || node === this._getCurrentResult()) {\n    return;\n  }\n\n  var nodeOffset = node.offsetTop;\n  var containerScroll = this._resultsContainer.scrollTop;\n\n  var bottomScroll = nodeOffset - this._resultsContainer.clientHeight + node.clientHeight;\n\n  if (nodeOffset < containerScroll) {\n    this._resultsContainer.scrollTop = nodeOffset;\n  } else if (containerScroll < bottomScroll) {\n    this._resultsContainer.scrollTop = bottomScroll;\n  }\n};\n\n\n/**\n * Clears all results data.\n */\nSearchPad.prototype._clearResults = function() {\n  domClear(this._resultsContainer);\n\n  this._results = [];\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.cleared');\n};\n\n\n/**\n * Get currently selected result.\n *\n * @return {Element}\n */\nSearchPad.prototype._getCurrentResult = function() {\n  return domQuery(SearchPad.RESULT_SELECTED_SELECTOR, this._resultsContainer);\n};\n\n\n/**\n * Create result DOM element within results container\n * that corresponds to a search result.\n *\n * 'result' : one of the elements returned by SearchProvider\n * 'id' : id attribute value to assign to the new DOM node\n * return : created DOM element\n *\n * @param  {SearchResult} result\n * @param  {String} id\n * @return {Element}\n */\nSearchPad.prototype._createResultNode = function(result, id) {\n  var node = domify(SearchPad.RESULT_HTML);\n\n  // create only if available\n  if (result.primaryTokens.length > 0) {\n    createInnerTextNode(node, result.primaryTokens, SearchPad.RESULT_PRIMARY_HTML);\n  }\n\n  // secondary tokens (represent element ID) are allways available\n  createInnerTextNode(node, result.secondaryTokens, SearchPad.RESULT_SECONDARY_HTML);\n\n  domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE, id);\n\n  this._resultsContainer.appendChild(node);\n\n  return node;\n};\n\n\n/**\n * Register search element provider.\n *\n * SearchProvider.find - provides search function over own elements\n *  (pattern) => [{ text: <String>, element: <Element>}, ...]\n *\n * @param  {SearchProvider} provider\n */\nSearchPad.prototype.registerProvider = function(provider) {\n  this._searchProvider = provider;\n};\n\n\n/**\n * Open search pad.\n */\nSearchPad.prototype.open = function() {\n  if (!this._searchProvider) {\n    throw new Error('no search provider registered');\n  }\n\n  if (this.isOpen()) {\n    return;\n  }\n\n  this._bindEvents();\n\n  this._open = true;\n\n  domClasses(this._container).add('open');\n\n  this._searchInput.focus();\n\n  this._eventBus.fire('searchPad.opened');\n};\n\n\n/**\n * Close search pad.\n */\nSearchPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._unbindEvents();\n\n  this._open = false;\n\n  domClasses(this._container).remove('open');\n\n  this._clearResults();\n\n  this._searchInput.value = '';\n  this._searchInput.blur();\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.closed');\n};\n\n\n/**\n * Toggles search pad on/off.\n */\nSearchPad.prototype.toggle = function() {\n  this.isOpen() ? this.close() : this.open();\n};\n\n\n/**\n * Report state of search pad.\n */\nSearchPad.prototype.isOpen = function() {\n  return this._open;\n};\n\n\n/**\n * Preselect result entry.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._preselect = function(node) {\n  var selectedNode = this._getCurrentResult();\n\n  // already selected\n  if (node === selectedNode) {\n    return;\n  }\n\n  // removing preselection from current node\n  if (selectedNode) {\n    domClasses(selectedNode).remove(SearchPad.RESULT_SELECTED_CLASS);\n  }\n\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  domClasses(node).add(SearchPad.RESULT_SELECTED_CLASS);\n\n  this._resetOverlay(element);\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.preselected', element);\n};\n\n\n/**\n * Select result node.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._select = function(node) {\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  this.close();\n\n  this._resetOverlay();\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.selected', element);\n};\n\n\n/**\n * Center viewbox on the element middle point.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._centerViewbox = function(element) {\n  var viewbox = this._canvas.viewbox();\n\n  var box = getBoundingBox(element);\n\n  var newViewbox = {\n    x: (box.x + box.width/2) - viewbox.outer.width/2,\n    y: (box.y + box.height/2) - viewbox.outer.height/2,\n    width: viewbox.outer.width,\n    height: viewbox.outer.height\n  };\n\n  this._canvas.viewbox(newViewbox);\n\n  this._canvas.zoom(viewbox.scale);\n};\n\n\n/**\n * Reset overlay removes and, optionally, set\n * overlay to a new element.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._resetOverlay = function(element) {\n  if (this._overlayId) {\n    this._overlays.remove(this._overlayId);\n  }\n\n  if (element) {\n    var box = getBoundingBox(element);\n    var overlay = constructOverlay(box);\n    this._overlayId = this._overlays.add(element, overlay);\n  }\n};\n\n\n/**\n * Construct overlay object for the given bounding box.\n *\n * @param  {BoundingBox} box\n * @return {Object}\n */\nfunction constructOverlay(box) {\n\n  var offset = 6;\n  var w = box.width + offset * 2;\n  var h = box.height + offset * 2;\n\n  var styles = [\n    'width: '+ w +'px',\n    'height: '+ h + 'px'\n  ].join('; ');\n\n  return {\n    position: {\n      bottom: h - offset,\n      right: w - offset\n    },\n    show: true,\n    html: '<div style=\"' + styles + '\" class=\"' + SearchPad.OVERLAY_CLASS + '\"></div>'\n  };\n}\n\n\n/**\n * Creates and appends child node from result tokens and HTML template.\n *\n * @param  {Element} node\n * @param  {Array<Object>} tokens\n * @param  {String} template\n */\nfunction createInnerTextNode(parentNode, tokens, template) {\n  var text = createHtmlText(tokens);\n  var childNode = domify(template);\n  childNode.innerHTML = text;\n  parentNode.appendChild(childNode);\n}\n\n/**\n * Create internal HTML markup from result tokens.\n * Caters for highlighting pattern matched tokens.\n *\n * @param  {Array<Object>} tokens\n * @return {String}\n */\nfunction createHtmlText(tokens) {\n  var htmlText = '';\n\n  tokens.forEach(function(t) {\n    if (t.matched) {\n      htmlText += '<strong class=\"' + SearchPad.RESULT_HIGHLIGHT_CLASS + '\">' + escapeHTML(t.matched) + '</strong>';\n    } else {\n      htmlText += escapeHTML(t.normal);\n    }\n  });\n\n  return htmlText !== '' ? htmlText : null;\n}\n\n\n/**\n * CONSTANTS\n */\nSearchPad.CONTAINER_SELECTOR = '.djs-search-container';\nSearchPad.INPUT_SELECTOR = '.djs-search-input input';\nSearchPad.RESULTS_CONTAINER_SELECTOR = '.djs-search-results';\nSearchPad.RESULT_SELECTOR = '.djs-search-result';\nSearchPad.RESULT_SELECTED_CLASS = 'djs-search-result-selected';\nSearchPad.RESULT_SELECTED_SELECTOR = '.' + SearchPad.RESULT_SELECTED_CLASS;\nSearchPad.RESULT_ID_ATTRIBUTE = 'data-result-id';\nSearchPad.RESULT_HIGHLIGHT_CLASS = 'djs-search-highlight';\nSearchPad.OVERLAY_CLASS = 'djs-search-overlay';\n\nSearchPad.BOX_HTML =\n  '<div class=\"djs-search-container djs-draggable djs-scrollable\">' +\n    '<div class=\"djs-search-input\">' +\n      '<input type=\"text\"/>' +\n    '</div>' +\n    '<div class=\"djs-search-results\"></div>' +\n  '</div>';\n\nSearchPad.RESULT_HTML =\n  '<div class=\"djs-search-result\"></div>';\n\nSearchPad.RESULT_PRIMARY_HTML =\n  '<div class=\"djs-search-result-primary\"></div>';\n\nSearchPad.RESULT_SECONDARY_HTML =\n  '<p class=\"djs-search-result-secondary\"></p>';\n","import OverlaysModule from '../overlays';\nimport SelectionModule from '../selection';\n\nimport SearchPad from './SearchPad';\n\nexport default {\n  __depends__: [\n    OverlaysModule,\n    SelectionModule\n  ],\n  searchPad: [ 'type', SearchPad ]\n};\n","import {\n  map,\n  filter,\n  sortBy\n} from 'min-dash';\n\nimport {\n  getLabel\n} from '../label-editing/LabelUtil';\n\n\n/**\n * Provides ability to search through BPMN elements\n */\nexport default function BpmnSearchProvider(elementRegistry, searchPad, canvas) {\n\n  this._elementRegistry = elementRegistry;\n  this._canvas = canvas;\n\n  searchPad.registerProvider(this);\n}\n\nBpmnSearchProvider.$inject = [\n  'elementRegistry',\n  'searchPad',\n  'canvas'\n];\n\n\n/**\n * Finds all elements that match given pattern\n *\n * <Result> :\n *  {\n *    primaryTokens: <Array<Token>>,\n *    secondaryTokens: <Array<Token>>,\n *    element: <Element>\n *  }\n *\n * <Token> :\n *  {\n *    normal|matched: <String>\n *  }\n *\n * @param  {String} pattern\n * @return {Array<Result>}\n */\nBpmnSearchProvider.prototype.find = function(pattern) {\n  var rootElement = this._canvas.getRootElement();\n\n  var elements = this._elementRegistry.filter(function(element) {\n    if (element.labelTarget) {\n      return false;\n    }\n    return true;\n  });\n\n  // do not include root element\n  elements = filter(elements, function(element) {\n    return element !== rootElement;\n  });\n\n  elements = map(elements, function(element) {\n    return {\n      primaryTokens: matchAndSplit(getLabel(element), pattern),\n      secondaryTokens: matchAndSplit(element.id, pattern),\n      element: element\n    };\n  });\n\n  // exclude non-matched elements\n  elements = filter(elements, function(element) {\n    return hasMatched(element.primaryTokens) || hasMatched(element.secondaryTokens);\n  });\n\n  elements = sortBy(elements, function(element) {\n    return getLabel(element.element) + element.element.id;\n  });\n\n  return elements;\n};\n\n\nfunction hasMatched(tokens) {\n  var matched = filter(tokens, function(t) {\n    return !!t.matched;\n  });\n\n  return matched.length > 0;\n}\n\n\nfunction matchAndSplit(text, pattern) {\n  var tokens = [],\n      originalText = text;\n\n  if (!text) {\n    return tokens;\n  }\n\n  text = text.toLowerCase();\n  pattern = pattern.toLowerCase();\n\n  var i = text.indexOf(pattern);\n\n  if (i > -1) {\n    if (i !== 0) {\n      tokens.push({\n        normal: originalText.substr(0, i)\n      });\n    }\n\n    tokens.push({\n      matched: originalText.substr(i, pattern.length)\n    });\n\n    if (pattern.length + i < text.length) {\n      tokens.push({\n        normal: originalText.substr(pattern.length + i, text.length)\n      });\n    }\n  } else {\n    tokens.push({\n      normal: originalText\n    });\n  }\n\n  return tokens;\n}","import SearchPadModule from 'diagram-js/lib/features/search-pad';\n\nimport BpmnSearchProvider from './BpmnSearchProvider';\n\n\nexport default {\n  __depends__: [\n    SearchPadModule\n  ],\n  __init__: [ 'bpmnSearch'],\n  bpmnSearch: [ 'type', BpmnSearchProvider ]\n};\n","import inherits from 'inherits';\n\nimport BaseModeler from './BaseModeler';\n\nimport Viewer from './Viewer';\nimport NavigatedViewer from './NavigatedViewer';\n\nimport KeyboardMoveModule from 'diagram-js/lib/navigation/keyboard-move';\nimport MoveCanvasModule from 'diagram-js/lib/navigation/movecanvas';\nimport TouchModule from 'diagram-js/lib/navigation/touch';\nimport ZoomScrollModule from 'diagram-js/lib/navigation/zoomscroll';\n\nimport AlignElementsModule from 'diagram-js/lib/features/align-elements';\nimport AutoPlaceModule from './features/auto-place';\nimport AutoResizeModule from './features/auto-resize';\nimport AutoScrollModule from 'diagram-js/lib/features/auto-scroll';\nimport BendpointsModule from 'diagram-js/lib/features/bendpoints';\nimport ConnectModule from 'diagram-js/lib/features/connect';\nimport ConnectionPreviewModule from 'diagram-js/lib/features/connection-preview';\nimport ContextPadModule from './features/context-pad';\nimport CopyPasteModule from './features/copy-paste';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport DistributeElementsModule from './features/distribute-elements';\nimport EditorActionsModule from './features/editor-actions';\nimport GridSnappingModule from './features/grid-snapping';\nimport InteractionEventsModule from './features/interaction-events';\nimport KeyboardModule from './features/keyboard';\nimport KeyboardMoveSelectionModule from 'diagram-js/lib/features/keyboard-move-selection';\nimport LabelEditingModule from './features/label-editing';\nimport ModelingModule from './features/modeling';\nimport MoveModule from 'diagram-js/lib/features/move';\nimport PaletteModule from './features/palette';\nimport ReplacePreviewModule from './features/replace-preview';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport SnappingModule from './features/snapping';\nimport SearchModule from './features/search';\n\n\nvar initialDiagram =\n  '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\n  '<bpmn:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ' +\n                    'xmlns:bpmn=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" ' +\n                    'xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" ' +\n                    'xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" ' +\n                    'targetNamespace=\"http://bpmn.io/schema/bpmn\" ' +\n                    'id=\"Definitions_1\">' +\n    '<bpmn:process id=\"Process_1\" isExecutable=\"false\">' +\n      '<bpmn:startEvent id=\"StartEvent_1\"/>' +\n    '</bpmn:process>' +\n    '<bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">' +\n      '<bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">' +\n        '<bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">' +\n          '<dc:Bounds height=\"36.0\" width=\"36.0\" x=\"173.0\" y=\"102.0\"/>' +\n        '</bpmndi:BPMNShape>' +\n      '</bpmndi:BPMNPlane>' +\n    '</bpmndi:BPMNDiagram>' +\n  '</bpmn:definitions>';\n\n\n/**\n * A modeler for BPMN 2.0 diagrams.\n *\n *\n * ## Extending the Modeler\n *\n * In order to extend the viewer pass extension modules to bootstrap via the\n * `additionalModules` option. An extension module is an object that exposes\n * named services.\n *\n * The following example depicts the integration of a simple\n * logging component that integrates with interaction events:\n *\n *\n * ```javascript\n *\n * // logging component\n * function InteractionLogger(eventBus) {\n *   eventBus.on('element.hover', function(event) {\n *     console.log()\n *   })\n * }\n *\n * InteractionLogger.$inject = [ 'eventBus' ]; // minification save\n *\n * // extension module\n * var extensionModule = {\n *   __init__: [ 'interactionLogger' ],\n *   interactionLogger: [ 'type', InteractionLogger ]\n * };\n *\n * // extend the viewer\n * var bpmnModeler = new Modeler({ additionalModules: [ extensionModule ] });\n * bpmnModeler.importXML(...);\n * ```\n *\n *\n * ## Customizing / Replacing Components\n *\n * You can replace individual diagram components by redefining them in override modules.\n * This works for all components, including those defined in the core.\n *\n * Pass in override modules via the `options.additionalModules` flag like this:\n *\n * ```javascript\n * function CustomContextPadProvider(contextPad) {\n *\n *   contextPad.registerProvider(this);\n *\n *   this.getContextPadEntries = function(element) {\n *     // no entries, effectively disable the context pad\n *     return {};\n *   };\n * }\n *\n * CustomContextPadProvider.$inject = [ 'contextPad' ];\n *\n * var overrideModule = {\n *   contextPadProvider: [ 'type', CustomContextPadProvider ]\n * };\n *\n * var bpmnModeler = new Modeler({ additionalModules: [ overrideModule ]});\n * ```\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function Modeler(options) {\n  BaseModeler.call(this, options);\n}\n\ninherits(Modeler, BaseModeler);\n\n\nModeler.Viewer = Viewer;\nModeler.NavigatedViewer = NavigatedViewer;\n\n/**\n * Create a new diagram to start modeling.\n *\n * @param {Function} [done]\n */\nModeler.prototype.createDiagram = function(done) {\n  return this.importXML(initialDiagram, done);\n};\n\n\nModeler.prototype._interactionModules = [\n\n  // non-modeling components\n  KeyboardMoveModule,\n  MoveCanvasModule,\n  TouchModule,\n  ZoomScrollModule\n];\n\nModeler.prototype._modelingModules = [\n\n  // modeling components\n  AlignElementsModule,\n  AutoPlaceModule,\n  AutoScrollModule,\n  AutoResizeModule,\n  BendpointsModule,\n  ConnectModule,\n  ConnectionPreviewModule,\n  ContextPadModule,\n  CopyPasteModule,\n  CreateModule,\n  DistributeElementsModule,\n  EditorActionsModule,\n  GridSnappingModule,\n  InteractionEventsModule,\n  KeyboardModule,\n  KeyboardMoveSelectionModule,\n  LabelEditingModule,\n  ModelingModule,\n  MoveModule,\n  PaletteModule,\n  ReplacePreviewModule,\n  ResizeModule,\n  SnappingModule,\n  SearchModule\n];\n\n\n// modules the modeler is composed of\n//\n// - viewer modules\n// - interaction modules\n// - modeling modules\n\nModeler.prototype._modules = [].concat(\n  Viewer.prototype._modules,\n  Modeler.prototype._interactionModules,\n  Modeler.prototype._modelingModules\n);\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search\"},[_c('el-autocomplete',{staticClass:\"inputBox\",attrs:{\"fetch-suggestions\":_vm.querySearchAsync,\"placeholder\":\"请输入内容\",\"trigger-on-focus\":false},on:{\"select\":_vm.handleSelect},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.search($event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('div',[_c('div',{staticClass:\"name\"},[_c('span',[_vm._v(_vm._s(item.value))])]),_c('div',{staticClass:\"addr\"},[_c('span',[_vm._v(_vm._s(item.address))])])])]}}]),model:{value:(_vm.state),callback:function ($$v) {_vm.state=$$v},expression:\"state\"}}),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.search}},[_vm._v(\"确定\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"search\">\r\n        <el-autocomplete class=\"inputBox\"\r\n                         v-model=\"state\"\r\n                         :fetch-suggestions=\"querySearchAsync\"\r\n                         placeholder=\"请输入内容\"\r\n                         :trigger-on-focus=\"false\"\r\n                         @select=\"handleSelect\"\r\n                         @keyup.enter.native=\"search\">\r\n            <template slot-scope=\"{ item }\">\r\n                <div>\r\n                    <div class=\"name\"><span>{{ item.value }}</span></div>\r\n                    <div class=\"addr\"><span>{{ item.address }}</span></div>\r\n                </div>\r\n\r\n\r\n            </template>\r\n        </el-autocomplete>\r\n        <el-button type=\"primary\" @click=\"search\">确定</el-button>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                restaurants: [],\r\n                state: ''\r\n            };\r\n        },\r\n        methods: {\r\n            search(){\r\n                console.log(\"search\")\r\n            },\r\n            querySearchAsync(queryString, cb) {\r\n                var restaurants = this.restaurants;\r\n                var results = queryString ? restaurants.filter(this.createFilter(queryString)) : restaurants;\r\n                // 调用 callback 返回建议列表的数据\r\n                //cb(results);\r\n                clearTimeout(this.timeout);\r\n                this.timeout = setTimeout(() => {\r\n                    cb(results);\r\n                }, 3000 * Math.random());\r\n            },\r\n            createFilter(queryString) {\r\n                return (restaurant) => {\r\n                    return (restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) !== -1);\r\n                };\r\n            },\r\n            loadAll() {\r\n                return [\r\n                    { \"value\": \"三全鲜食（北新泾店）\", \"address\": \"长宁区新渔路144号\" },\r\n                    { \"value\": \"Hot honey 首尔炸鸡（仙霞路）\", \"address\": \"上海市长宁区淞虹路661号\" },\r\n                    { \"value\": \"新旺角茶餐厅\", \"address\": \"上海市普陀区真北路988号创邑金沙谷6号楼113\" },\r\n                    { \"value\": \"泷千家(天山西路店)\", \"address\": \"天山西路438号\" },\r\n                    { \"value\": \"胖仙女纸杯蛋糕（上海凌空店）\", \"address\": \"上海市长宁区金钟路968号1幢18号楼一层商铺18-101\" },\r\n                    { \"value\": \"贡茶\", \"address\": \"上海市长宁区金钟路633号\" },\r\n                    { \"value\": \"豪大大香鸡排超级奶爸\", \"address\": \"上海市嘉定区曹安公路曹安路1685号\" },\r\n                    { \"value\": \"茶芝兰（奶茶，手抓饼）\", \"address\": \"上海市普陀区同普路1435号\" },\r\n                    { \"value\": \"十二泷町\", \"address\": \"上海市北翟路1444弄81号B幢-107\" },\r\n                    { \"value\": \"星移浓缩咖啡\", \"address\": \"上海市嘉定区新郁路817号\" },\r\n                    { \"value\": \"阿姨奶茶/豪大大\", \"address\": \"嘉定区曹安路1611号\" },\r\n                    { \"value\": \"新麦甜四季甜品炸鸡\", \"address\": \"嘉定区曹安公路2383弄55号\" },\r\n                    { \"value\": \"Monica摩托主题咖啡店\", \"address\": \"嘉定区江桥镇曹安公路2409号1F，2383弄62号1F\" },\r\n                    { \"value\": \"浮生若茶（凌空soho店）\", \"address\": \"上海长宁区金钟路968号9号楼地下一层\" },\r\n                    { \"value\": \"NONO JUICE  鲜榨果汁\", \"address\": \"上海市长宁区天山西路119号\" },\r\n                    { \"value\": \"CoCo都可(北新泾店）\", \"address\": \"上海市长宁区仙霞西路\" },\r\n                    { \"value\": \"快乐柠檬（神州智慧店）\", \"address\": \"上海市长宁区天山西路567号1层R117号店铺\" },\r\n                    { \"value\": \"Merci Paul cafe\", \"address\": \"上海市普陀区光复西路丹巴路28弄6号楼819\" },\r\n                    { \"value\": \"猫山王（西郊百联店）\", \"address\": \"上海市长宁区仙霞西路88号第一层G05-F01-1-306\" },\r\n                    { \"value\": \"枪会山\", \"address\": \"上海市普陀区棕榈路\" },\r\n                    { \"value\": \"纵食\", \"address\": \"元丰天山花园(东门) 双流路267号\" },\r\n                    { \"value\": \"钱记\", \"address\": \"上海市长宁区天山西路\" },\r\n                    { \"value\": \"壹杯加\", \"address\": \"上海市长宁区通协路\" },\r\n                    { \"value\": \"唦哇嘀咖\", \"address\": \"上海市长宁区新泾镇金钟路999号2幢（B幢）第01层第1-02A单元\" },\r\n                    { \"value\": \"爱茜茜里(西郊百联)\", \"address\": \"长宁区仙霞西路88号1305室\" },\r\n                    { \"value\": \"爱茜茜里(近铁广场)\", \"address\": \"上海市普陀区真北路818号近铁城市广场北区地下二楼N-B2-O2-C商铺\" },\r\n                    { \"value\": \"鲜果榨汁（金沙江路和美广店）\", \"address\": \"普陀区金沙江路2239号金沙和美广场B1-10-6\" },\r\n                    { \"value\": \"开心丽果（缤谷店）\", \"address\": \"上海市长宁区威宁路天山路341号\" },\r\n                    { \"value\": \"超级鸡车（丰庄路店）\", \"address\": \"上海市嘉定区丰庄路240号\" },\r\n                    { \"value\": \"妙生活果园（北新泾店）\", \"address\": \"长宁区新渔路144号\" },\r\n                    { \"value\": \"香宜度麻辣香锅\", \"address\": \"长宁区淞虹路148号\" },\r\n                    { \"value\": \"凡仔汉堡（老真北路店）\", \"address\": \"上海市普陀区老真北路160号\" },\r\n                    { \"value\": \"港式小铺\", \"address\": \"上海市长宁区金钟路968号15楼15-105室\" },\r\n                    { \"value\": \"蜀香源麻辣香锅（剑河路店）\", \"address\": \"剑河路443-1\" },\r\n                    { \"value\": \"北京饺子馆\", \"address\": \"长宁区北新泾街道天山西路490-1号\" },\r\n                    { \"value\": \"饭典*新简餐（凌空SOHO店）\", \"address\": \"上海市长宁区金钟路968号9号楼地下一层9-83室\" },\r\n                    { \"value\": \"焦耳·川式快餐（金钟路店）\", \"address\": \"上海市金钟路633号地下一层甲部\" },\r\n                    { \"value\": \"动力鸡车\", \"address\": \"长宁区仙霞西路299弄3号101B\" },\r\n                    { \"value\": \"浏阳蒸菜\", \"address\": \"天山西路430号\" },\r\n                    { \"value\": \"四海游龙（天山西路店）\", \"address\": \"上海市长宁区天山西路\" },\r\n                    { \"value\": \"樱花食堂（凌空店）\", \"address\": \"上海市长宁区金钟路968号15楼15-105室\" },\r\n                    { \"value\": \"壹分米客家传统调制米粉(天山店)\", \"address\": \"天山西路428号\" },\r\n                    { \"value\": \"福荣祥烧腊（平溪路店）\", \"address\": \"上海市长宁区协和路福泉路255弄57-73号\" },\r\n                    { \"value\": \"速记黄焖鸡米饭\", \"address\": \"上海市长宁区北新泾街道金钟路180号1层01号摊位\" },\r\n                    { \"value\": \"红辣椒麻辣烫\", \"address\": \"上海市长宁区天山西路492号\" },\r\n                    { \"value\": \"(小杨生煎)西郊百联餐厅\", \"address\": \"长宁区仙霞西路88号百联2楼\" },\r\n                    { \"value\": \"阳阳麻辣烫\", \"address\": \"天山西路389号\" },\r\n                    { \"value\": \"南拳妈妈龙虾盖浇饭\", \"address\": \"普陀区金沙江路1699号鑫乐惠美食广场A13\" }\r\n                ];\r\n            },\r\n            handleSelect(item) {\r\n                console.log(item);\r\n            },\r\n        },\r\n        mounted() {\r\n            this.restaurants = this.loadAll();\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n\r\n    .name {\r\n        text-overflow: ellipsis;\r\n        overflow: hidden;\r\n        float: left;\r\n    }\r\n    .addr {\r\n        font-size: 12px;\r\n        color: red;\r\n        text-align:right;\r\n        float: right;\r\n    }\r\n    .inputBox{\r\n        width:400px\r\n    }\r\n    .search{\r\n        position: fixed;\r\n        border-radius: 0.25rem;\r\n        left: 50%;\r\n        top: 50%;\r\n        transform: translate(-50%, -50%);\r\n        z-index: 1000;\r\n    }\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=f648602e&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Search.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"file-upload-window\"},[_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo\",attrs:{\"action\":\"\",\"http-request\":_vm.uploadSectionFile,\"multiple\":\"\",\"file-list\":_vm.fileList,\"auto-upload\":false}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取文件\")]),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":_vm.submitUpload}},[_vm._v(\"上传到服务器\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"file-upload-window\">\r\n        <el-upload\r\n                class=\"upload-demo\"\r\n                ref=\"upload\"\r\n                action=\"\"\r\n                :http-request=\"uploadSectionFile\"\r\n                multiple\r\n                :file-list=\"fileList\"\r\n                :auto-upload=\"false\">\r\n            <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取文件</el-button>\r\n            <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload\">上传到服务器</el-button>\r\n            <!--  <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>-->\r\n        </el-upload>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"FileUpload\",\r\n        data() {\r\n            return {\r\n                //fileList: [{name: 'food.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100'}, {name: 'food2.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100'}]\r\n                formData:[],\r\n                fileList:[]\r\n            };\r\n        },\r\n        methods: {\r\n            submitUpload() {\r\n                console.log(\"submitUpload\");\r\n                this.formData = new FormData();\r\n                this.$refs.upload.submit();\r\n                console.log(\"AFTERSUBMIT\");\r\n                console.log(this.formData);\r\n\r\n                if(this.fileList.length>0){\r\n                    this.$axios({\r\n                        method: 'post',\r\n                        url: 'http://backend-java:8090/upload/uploadFiles',\r\n                        //url: 'http://lxc-backend-java.ingress.isa.buaanlsde.cn/upload/uploadFiles',\r\n                        //lxc\r\n                        // headers: {\r\n                        //     'Content-Type': 'multipart/form-data'\r\n                        // },\r\n                        data: this.formData\r\n                    })\r\n                }\r\n\r\n            },\r\n\r\n            uploadSectionFile(param) {\r\n                console.log(param.file);\r\n                this.fileList.push(param.file)\r\n                console.log(\"uploadSectionFile\");\r\n                this.formData.append('files',param.file)\r\n                //var fileObj = param.file;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .file-upload-window {        \r\n        width: 400px;\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FileUpload.vue?vue&type=template&id=8d3627ba&scoped=true&\"\nimport script from \"./FileUpload.vue?vue&type=script&lang=js&\"\nexport * from \"./FileUpload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FileUpload.vue?vue&type=style&index=0&id=8d3627ba&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8d3627ba\",\n  null\n  \n)\n\nexport default component.exports","import axios from 'axios'\n\nexport function request(config) {\n  //1.创建实例\n  const instance = axios.create({\n    //baseURL: \"http://localhost:8090\" http://backend-py:8000/\n    baseURL: \"http://backend-java:8090\",\n    //baseURL: \"http://lxc-backend-java.ingress.isa.buaanlsde.cn\",\n    //timeout: 5000\n  })\n\n  //2.发送真正的网络请求\n  return instance(config)\n\n}\n","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import { Linter } from 'bpmnlint';\nimport { reduce, groupBy, assign } from 'min-dash';\nimport { domify } from 'min-dom';\nimport { escapeHTML } from 'diagram-js/lib/util/EscapeUtil';\n\nfunction EditorActions(injector, linting) {\n  var editorActions = injector.get('editorActions', false);\n\n  editorActions && editorActions.register({\n    toggleLinting: function() {\n      linting.toggle();\n    }\n  });\n}\n\nEditorActions.$inject = [\n  'injector',\n  'linting'\n];\n\nvar ErrorSvg = \"<svg width=\\\"12\\\" height=\\\"12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 352 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\\\"></path></svg>\";\n\nvar WarningSvg = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"12\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M288 328.83c-45.518 0-82.419 34.576-82.419 77.229 0 42.652 36.9 77.229 82.419 77.229 45.518 0 82.419-34.577 82.419-77.23 0-42.652-36.9-77.229-82.419-77.229zM207.439 57.034l11.61 204.348c.544 9.334 8.78 16.64 18.755 16.64h100.392c9.975 0 18.211-7.306 18.754-16.64l11.611-204.348c.587-10.082-7.98-18.56-18.754-18.56H226.192c-10.775 0-19.34 8.478-18.753 18.56z\\\"/></svg>\";\n\nvar SuccessSvg = \"<svg width=\\\"12\\\" height=\\\"12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\\\"></path></svg>\";\n\nvar OFFSET_TOP = -7,\r\n    OFFSET_RIGHT = -7;\r\n\r\nvar LOW_PRIORITY = 500;\r\n\r\nvar emptyConfig = {\r\n  resolver: {\r\n    resolveRule: function() {\r\n      return null;\r\n    }\r\n  },\r\n  config: {}\r\n};\r\n\r\nvar stateToIcon = {\r\n  error: ErrorSvg,\r\n  warning: WarningSvg,\r\n  success: SuccessSvg,\r\n  inactive: SuccessSvg\r\n};\r\n\r\nfunction Linting(\r\n    bpmnjs,\r\n    canvas,\r\n    config,\r\n    elementRegistry,\r\n    eventBus,\r\n    overlays,\r\n    translate\r\n) {\r\n  this._bpmnjs = bpmnjs;\r\n  this._canvas = canvas;\r\n  this._elementRegistry = elementRegistry;\r\n  this._eventBus = eventBus;\r\n  this._overlays = overlays;\r\n  this._translate = translate;\r\n\r\n  this._issues = {};\r\n\r\n  this._active = config && config.active || false;\r\n  this._linterConfig = emptyConfig;\r\n\r\n  this._overlayIds = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on([\r\n    'import.done',\r\n    'elements.changed',\r\n    'linting.configChanged',\r\n    'linting.toggle'\r\n  ], LOW_PRIORITY, function(e) {\r\n    if (self.isActive()) {\r\n      self.update();\r\n    }\r\n  });\r\n\r\n  eventBus.on('linting.toggle', function(event) {\r\n\r\n    const active = event.active;\r\n\r\n    if (!active) {\r\n      self._clearIssues();\r\n      self._updateButton();\r\n    }\r\n  });\r\n\r\n  eventBus.on('diagram.clear', function() {\r\n    self._clearIssues();\r\n  });\r\n\r\n  var linterConfig = config && config.bpmnlint;\r\n\r\n  linterConfig && eventBus.once('diagram.init', function() {\r\n\r\n    // bail out if config was already provided\r\n    // during initialization of other modules\r\n    if (self.getLinterConfig() !== emptyConfig) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      self.setLinterConfig(linterConfig);\r\n    } catch (err) {\r\n      console.error(\r\n        '[bpmn-js-bpmnlint] Invalid lint rules configured. ' +\r\n        'Please doublecheck your linting.bpmnlint configuration, ' +\r\n        'cf. https://github.com/bpmn-io/bpmn-js-bpmnlint#configure-lint-rules'\r\n      );\r\n    }\r\n  });\r\n\r\n  this._init();\r\n}\r\n\r\nLinting.prototype.setLinterConfig = function(linterConfig) {\r\n\r\n  if (!linterConfig.config || !linterConfig.resolver) {\r\n    throw new Error('Expected linterConfig = { config, resolver }');\r\n  }\r\n\r\n  this._linterConfig = linterConfig;\r\n\r\n  this._eventBus.fire('linting.configChanged');\r\n};\r\n\r\nLinting.prototype.getLinterConfig = function() {\r\n  return this._linterConfig;\r\n};\r\n\r\nLinting.prototype._init = function() {\r\n  this._createButton();\r\n\r\n  this._updateButton();\r\n};\r\n\r\nLinting.prototype.isActive = function() {\r\n  return this._active;\r\n};\r\n\r\nLinting.prototype._formatIssues = function(issues) {\r\n\r\n  const reports = reduce(issues, function(reports, ruleReports, rule) {\r\n\r\n    return reports.concat(ruleReports.map(function(report) {\r\n      report.rule = rule;\r\n\r\n      return report;\r\n    }));\r\n\r\n  }, []);\r\n\r\n  return groupBy(reports, function(report) {\r\n    return report.id;\r\n  });\r\n};\r\n\r\n/**\r\n * Toggle linting on or off.\r\n *\r\n * @param {boolean} [newActive]\r\n *\r\n * @return {boolean} the new active state\r\n */\r\nLinting.prototype.toggle = function(newActive) {\r\n\r\n  newActive = typeof newActive === 'undefined' ? !this.isActive() : newActive;\r\n\r\n  this._setActive(newActive);\r\n\r\n  return newActive;\r\n};\r\n\r\nLinting.prototype._setActive = function(active) {\r\n\r\n  if (this._active === active) {\r\n    return;\r\n  }\r\n\r\n  this._active = active;\r\n\r\n  this._eventBus.fire('linting.toggle', { active: active });\r\n};\r\n\r\n/**\r\n * Update overlays. Always lint and check wether overlays need update or not.\r\n */\r\nLinting.prototype.update = function() {\r\n  var self = this;\r\n\r\n  var definitions = this._bpmnjs.getDefinitions();\r\n\r\n  if (!definitions) {\r\n    return;\r\n  }\r\n\r\n  var lintStart = this._lintStart = Math.random();\r\n\r\n  this.lint().then(function(newIssues) {\r\n\r\n    if (self._lintStart !== lintStart) {\r\n      return;\r\n    }\r\n\r\n    newIssues = self._formatIssues(newIssues);\r\n\r\n    var remove = {},\r\n        update = {},\r\n        add = {};\r\n\r\n    for (var id1 in self._issues) {\r\n      if (!newIssues[id1]) {\r\n        remove[id1] = self._issues[id1];\r\n      }\r\n    }\r\n\r\n    for (var id2 in newIssues) {\r\n      if (!self._issues[id2]) {\r\n        add[id2] = newIssues[id2];\r\n      } else {\r\n        if (newIssues[id2] !== self._issues[id2]) {\r\n          update[id2] = newIssues[id2];\r\n        }\r\n      }\r\n    }\r\n\r\n    remove = assign(remove, update);\r\n    add = assign(add, update);\r\n\r\n    self._clearOverlays();\r\n    self._createIssues(add);\r\n\r\n    self._issues = newIssues;\r\n\r\n    self._updateButton();\r\n\r\n    self._fireComplete(newIssues);\r\n  });\r\n};\r\n\r\nLinting.prototype._fireComplete = function(issues) {\r\n  this._eventBus.fire('linting.completed', { issues: issues });\r\n};\r\n\r\nLinting.prototype._createIssues = function(issues) {\r\n  for (var id in issues) {\r\n    this._createElementIssues(id, issues[id]);\r\n  }\r\n};\r\n\r\n/**\r\n * Create overlays for an elements issues.\r\n *\r\n * @param {string} elementId - Elements ID.\r\n * @param {Array} elementIssues - All element issues including warnings and errors.\r\n */\r\nLinting.prototype._createElementIssues = function(elementId, elementIssues) {\r\n  var element = this._elementRegistry.get(elementId);\r\n\r\n  if (!element) {\r\n    return;\r\n  }\r\n\r\n  var menuPosition;\r\n  var position;\r\n\r\n  if (element === this._canvas.getRootElement()) {\r\n    menuPosition = 'bottom-right';\r\n\r\n    position = {\r\n      top: 20,\r\n      left: 150\r\n    };\r\n  } else {\r\n    menuPosition = 'top-right';\r\n\r\n    position = {\r\n      top: OFFSET_TOP,\r\n      left: OFFSET_RIGHT\r\n    };\r\n  }\r\n\r\n  var issuesByType = groupBy(elementIssues, function(elementIssue) {\r\n    return elementIssue.category;\r\n  });\r\n\r\n  var errors = issuesByType.error,\r\n      warnings = issuesByType.warn;\r\n\r\n  if (!errors && !warnings) {\r\n    return;\r\n  }\r\n\r\n  var $html = domify(\r\n    '<div class=\"bjsl-overlay bjsl-issues-' + menuPosition + '\"></div>'\r\n  );\r\n\r\n  var $icon = errors\r\n    ? domify('<div class=\"bjsl-icon bjsl-icon-error\">' + ErrorSvg + '</div>')\r\n    : domify('<div class=\"bjsl-icon bjsl-icon-warning\">' + WarningSvg + '</div>');\r\n\r\n  var $dropdown = domify('<div class=\"bjsl-dropdown\"></div>');\r\n  var $dropdownContent = domify('<div class=\"bjsl-dropdown-content\"></div>');\r\n  var $issues = domify('<div class=\"bjsl-issues\"></div>');\r\n  var $issueList = domify('<ul></ul>');\r\n\r\n  $html.appendChild($icon);\r\n  $html.appendChild($dropdown);\r\n\r\n  $dropdown.appendChild($dropdownContent);\r\n  $dropdownContent.appendChild($issues);\r\n\r\n  $issues.appendChild($issueList);\r\n\r\n  if (errors) {\r\n    this._addErrors($issueList, errors);\r\n  }\r\n\r\n  if (warnings) {\r\n    this._addWarnings($issueList, warnings);\r\n  }\r\n\r\n  this._overlayIds[elementId] = this._overlays.add(element, 'linting', {\r\n    position: position,\r\n    html: $html,\r\n    scale: {\r\n      min: .9\r\n    }\r\n  });\r\n};\r\n\r\nLinting.prototype._addErrors = function($ul, errors) {\r\n\r\n  var self = this;\r\n\r\n  errors.forEach(function(error) {\r\n    self._addEntry($ul, 'error', error);\r\n  });\r\n};\r\n\r\nLinting.prototype._addWarnings = function($ul, warnings) {\r\n\r\n  var self = this;\r\n\r\n  warnings.forEach(function(error) {\r\n    self._addEntry($ul, 'warning', error);\r\n  });\r\n};\r\n\r\nLinting.prototype._addEntry = function($ul, state, entry) {\r\n\r\n  var rule = entry.rule,\r\n      message = this._translate(entry.message);\r\n\r\n  var icon = stateToIcon[state];\r\n\r\n  var $entry = domify(\r\n    '<li class=\"' + state + '\">' +\r\n      icon +\r\n      '<a title=\"' + escapeHTML(rule) + ': ' + escapeHTML(message) + '\" ' +\r\n         'data-rule=\"' + escapeHTML(rule) + '\" ' +\r\n         'data-message=\"' + escapeHTML(message) + '\"' +\r\n      '>' +\r\n        escapeHTML(message) +\r\n      '</a>' +\r\n    '</li>'\r\n  );\r\n\r\n  $ul.appendChild($entry);\r\n};\r\n\r\nLinting.prototype._clearOverlays = function() {\r\n  this._overlays.remove({ type: 'linting' });\r\n\r\n  this._overlayIds = {};\r\n};\r\n\r\nLinting.prototype._clearIssues = function() {\r\n  this._issues = {};\r\n\r\n  this._clearOverlays();\r\n};\r\n\r\nLinting.prototype._setButtonState = function(state, errors, warnings) {\r\n  var button = this._button;\r\n\r\n  var icon = stateToIcon[state];\r\n\r\n  var html = icon + '<span>' + this._translate('{errors} Errors, {warnings} Warnings', { errors: errors.toString(), warnings: warnings.toString() }) + '</span>';\r\n\r\n  [\r\n    'error',\r\n    'inactive',\r\n    'success',\r\n    'warning'\r\n  ].forEach(function(s) {\r\n    if (state === s) {\r\n      button.classList.add('bjsl-button-' + s);\r\n    } else {\r\n      button.classList.remove('bjsl-button-' + s);\r\n    }\r\n  });\r\n\r\n  button.innerHTML = html;\r\n};\r\n\r\nLinting.prototype._updateButton = function() {\r\n\r\n  if (!this.isActive()) {\r\n    this._setButtonState('inactive', 0, 0);\r\n\r\n    return;\r\n  }\r\n\r\n  var errors = 0,\r\n      warnings = 0;\r\n\r\n  for (var id in this._issues) {\r\n    this._issues[id].forEach(function(issue) {\r\n      if (issue.category === 'error') {\r\n        errors++;\r\n      } else if (issue.category === 'warn') {\r\n        warnings++;\r\n      }\r\n    });\r\n  }\r\n\r\n  var state = (errors && 'error') || (warnings && 'warning') || 'success';\r\n\r\n  this._setButtonState(state, errors, warnings);\r\n};\r\n\r\nLinting.prototype._createButton = function() {\r\n\r\n  var self = this;\r\n\r\n  this._button = domify(\r\n    '<button class=\"bjsl-button bjsl-button-inactive\" title=\"' + this._translate('Toggle linting') + '\"></button>'\r\n  );\r\n\r\n  this._button.addEventListener('click', function() {\r\n    self.toggle();\r\n  });\r\n\r\n  this._canvas.getContainer().appendChild(this._button);\r\n};\r\n\r\nLinting.prototype.lint = function() {\r\n  var definitions = this._bpmnjs.getDefinitions();\r\n\r\n  var linter = new Linter(this._linterConfig);\r\n\r\n  return linter.lint(definitions);\r\n};\r\n\r\nLinting.$inject = [\r\n  'bpmnjs',\r\n  'canvas',\r\n  'config.linting',\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'overlays',\r\n  'translate'\r\n];\n\nvar index = {\r\n  __init__: [ 'linting', 'lintingEditorActions' ],\r\n  linting: [ 'type', Linting ],\r\n  lintingEditorActions: ['type', EditorActions ]\r\n};\n\nexport default index;\n//# sourceMappingURL=index.esm.js.map\n","\nvar cache = {};\n\n/**\n * A resolver that caches rules and configuration as part of the bundle,\n * making them accessible in the browser.\n *\n * @param {Object} cache\n */\nfunction Resolver() {}\n\nResolver.prototype.resolveRule = function(pkg, ruleName) {\n\n  const rule = cache[pkg + '/' + ruleName];\n\n  if (!rule) {\n    throw new Error('cannot resolve rule <' + pkg + '/' + ruleName + '>');\n  }\n\n  return rule;\n};\n\nResolver.prototype.resolveConfig = function(pkg, configName) {\n  throw new Error(\n    'cannot resolve config <' + configName + '> in <' + pkg +'>'\n  );\n};\n\nvar resolver = new Resolver();\n\nvar rules = {\n  \"conditional-flows\": \"error\",\n  \"end-event-required\": \"error\",\n  \"event-sub-process-typed-start-event\": \"error\",\n  \"fake-join\": \"warn\",\n  \"label-required\": \"error\",\n  \"no-complex-gateway\": \"error\",\n  \"no-disconnected\": \"error\",\n  \"no-duplicate-sequence-flows\": \"error\",\n  \"no-gateway-join-fork\": \"error\",\n  \"no-implicit-split\": \"error\",\n  \"no-inclusive-gateway\": \"error\",\n  \"single-blank-start-event\": \"error\",\n  \"single-event-definition\": \"error\",\n  \"start-event-required\": \"error\",\n  \"sub-process-blank-start-event\": \"error\"\n};\n\nvar config = {\n  rules: rules\n};\n\nvar bundle = {\n  resolver: resolver,\n  config: config\n};\n\nexport { resolver, config };\n\nexport default bundle;\n\n\n\nimport rule_0 from 'bpmnlint/rules/conditional-flows';\ncache['bpmnlint/conditional-flows'] = rule_0;\n\nimport rule_1 from 'bpmnlint/rules/end-event-required';\ncache['bpmnlint/end-event-required'] = rule_1;\n\nimport rule_2 from 'bpmnlint/rules/event-sub-process-typed-start-event';\ncache['bpmnlint/event-sub-process-typed-start-event'] = rule_2;\n\nimport rule_3 from 'bpmnlint/rules/fake-join';\ncache['bpmnlint/fake-join'] = rule_3;\n\nimport rule_4 from 'bpmnlint/rules/label-required';\ncache['bpmnlint/label-required'] = rule_4;\n\nimport rule_5 from 'bpmnlint/rules/no-complex-gateway';\ncache['bpmnlint/no-complex-gateway'] = rule_5;\n\nimport rule_6 from 'bpmnlint/rules/no-disconnected';\ncache['bpmnlint/no-disconnected'] = rule_6;\n\nimport rule_7 from 'bpmnlint/rules/no-duplicate-sequence-flows';\ncache['bpmnlint/no-duplicate-sequence-flows'] = rule_7;\n\nimport rule_8 from 'bpmnlint/rules/no-gateway-join-fork';\ncache['bpmnlint/no-gateway-join-fork'] = rule_8;\n\nimport rule_9 from 'bpmnlint/rules/no-implicit-split';\ncache['bpmnlint/no-implicit-split'] = rule_9;\n\nimport rule_10 from 'bpmnlint/rules/no-inclusive-gateway';\ncache['bpmnlint/no-inclusive-gateway'] = rule_10;\n\nimport rule_11 from 'bpmnlint/rules/single-blank-start-event';\ncache['bpmnlint/single-blank-start-event'] = rule_11;\n\nimport rule_12 from 'bpmnlint/rules/single-event-definition';\ncache['bpmnlint/single-event-definition'] = rule_12;\n\nimport rule_13 from 'bpmnlint/rules/start-event-required';\ncache['bpmnlint/start-event-required'] = rule_13;\n\nimport rule_14 from 'bpmnlint/rules/sub-process-blank-start-event';\ncache['bpmnlint/sub-process-blank-start-event'] = rule_14;","<template>\r\n  <div id=\"editor\">\r\n    <el-container>\r\n      <el-header height=\"36px\">\r\n        <el-button-group>\r\n          <el-button\r\n            type=\"primary\"\r\n            size=\"medium\"\r\n            class=\"el-icon-top-left\"\r\n            @click=\"handleImportButton\"\r\n          >\r\n            导入\r\n            <fileLoader id=\"fileLoader\" @loadFile=\"loadBpmnFromFile\" />\r\n          </el-button>\r\n          <el-dropdown>\r\n            <el-button type=\"primary\" size=\"medium\">\r\n              下载\r\n              <i class=\"el-icon-bottom-right\"></i>\r\n            </el-button>\r\n            <el-dropdown-menu slot=\"dropdown\">\r\n              <el-dropdown-item>\r\n                <a @click=\"downloadBpmnToFile\">下载.bpmn文件</a>\r\n              </el-dropdown-item>\r\n              <el-dropdown-item>\r\n                <a @click=\"downloadBpmnToSVG\">下载.svg文件</a>\r\n              </el-dropdown-item>\r\n            </el-dropdown-menu>\r\n          </el-dropdown>\r\n        </el-button-group>\r\n        <el-button-group>\r\n          <el-button\r\n            type=\"primary\"\r\n            size=\"medium\"\r\n            class=\"el-icon-magic-stick\"\r\n            @click=\"textTransform\"\r\n          >NLP</el-button>\r\n        </el-button-group>\r\n        <!--style=\"margin-left:10px\"-->\r\n        <el-button-group>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"resetBPMN\">重置</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"checkBPMN\">检查</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"saveBPMN\">保存</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"recoBPMN\">结构推荐</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"showWindow\">语义推荐</el-button>\r\n          <el-button type=\"primary\" size=\"medium\" @click=\"showUploadWindow\">上传文件</el-button>\r\n        </el-button-group>\r\n      </el-header>\r\n      <el-main>\r\n\r\n        <div v-show=\"isShowSearchWindow\">\r\n    <Search></Search>\r\n  </div>\r\n  <div v-show=\"isShowUploadWindow\">\r\n    <FileUpload></FileUpload>\r\n    </div>\r\n\r\n        <div class=\"bpmnContainer\">\r\n          <div id=\"BpmnCanvas\" ref=\"canvas\"></div>\r\n          <div id=\"BpmnProperties\" ref=\"canvas\"></div>\r\n        </div>\r\n      </el-main>\r\n    </el-container>\r\n  </div>\r\n</template>\r\n\r\n\r\n\r\n<script>\r\nimport BpmnModeler from \"bpmn-js/lib/Modeler\";\r\n//右侧元素属性菜单\r\nimport propertiesPanelModule from 'bpmn-js-properties-panel'\r\nimport propertiesProviderModule from 'bpmn-js-properties-panel/lib/provider/camunda'\r\nimport Search from  '../components/Search'\r\nimport FileUpload from '../components/FileUpload'\r\n//文件导入器\r\nimport fileLoader from \"../components/Editor/fileLoader.vue\";\r\nimport {request} from '../network/request'\r\n//验证工具\r\nimport lintModule from \"bpmn-js-bpmnlint\";\r\nimport bpmnlintConfig from \"../bpmn/lint/.bpmnlintrc\";\r\n//空白Bpmn模板\r\nimport BlankStr from \"../bpmn/samples/blank.js\";\r\nimport  qs from 'qs';\r\nexport default {\r\n  name: \"Editor\",\r\n  data: function() {\r\n    return {\r\n      xmlStr: this.$store.state.BpmnXml,\r\n      isCollapse: false,\r\n      bpmnModeler: null,\r\n      container: null,\r\n      isShowSearchWindow:false,\r\n      isShowUploadWindow:false\r\n    };\r\n  },\r\n  components: {\r\n    fileLoader: fileLoader,\r\n    Search,FileUpload\r\n  },\r\n\r\n  methods: {\r\n\r\n    showUploadWindow(){\r\n  this.isShowUploadWindow = !this.isShowUploadWindow\r\n  this.isShowSearchWindow = false\r\n},\r\nshowSearch(){\r\n  this.isShowSearchWindow = !this.isShowSearchWindow\r\n  this.isShowUploadWindow = false\r\n},\r\n     showWindow() {\r\n       //const axios = this.$axios;\r\n          //axios.defaults.withCredentials = true\r\n        this.$prompt('', '请输入您的需求:', {\r\n            confirmButtonText: '确定',\r\n            cancelButtonText: '取消',\r\n            closeOnClickModal: false,\r\n            showInput: true,\r\n            inputPlaceholder: \"请输入信息\",\r\n            inputType: \"textarea\"\r\n        }).then(({value}) => {\r\n            this.$message({\r\n                type: 'success',\r\n                message: '你的输入是: ' + (value == null ? \"\" : value)\r\n            })\r\n            //发送数据\r\n            request({\r\n              \r\n                url: \"/recommendation/RecommSemantics\",\r\n                method: \"get\",\r\n                params: {\r\n                    message: value\r\n                }\r\n            }).then(res => {\r\n                //console.log(res.data)\r\n                this.xmlStr = res.data;\r\n                this.bpmnModeler.importXML(this.xmlStr);\r\n            }).catch(err => {\r\n                console.log(\"发送失败\")\r\n            })\r\n        }).catch(() => {\r\n            this.$message({\r\n                type: 'info',\r\n                message: '还没想好？'\r\n            });\r\n        })\r\n    },\r\n    // 初始化函数\r\n    initBpmn: function() {\r\n      this.bpmnModeler = new BpmnModeler({\r\n        container: \"#BpmnCanvas\", //主窗口挂载点\r\n        propertiesPanel: {\r\n          parent: '#BpmnProperties'//右侧属性菜单挂载点\r\n        },\r\n        additionalModules: [\r\n          lintModule,//验证插件\r\n          //右侧属性菜单差插件\r\n          propertiesPanelModule,\r\n          propertiesProviderModule\r\n        ],\r\n        linting: {\r\n          bpmnlint: bpmnlintConfig\r\n          // active: getUrlParam('linting')\r\n        }\r\n      });\r\n      this.bpmnModeler.importXML(this.xmlStr); //载入空白模板\r\n    },\r\n\r\n    // 文件导入\r\n    //通过click()点击调用fileLoader组件，该组件不会显示在页面中\r\n    handleImportButton: function() {\r\n      const element = document.getElementById(\"fileLoader\");\r\n      element.click();\r\n    },\r\n    //组件接收到文件以后，会将字符串返回，发出loadFile事件\r\n    //监听到loadFile事件后，调用loadBpmnFromFile方法将字符串显示到页面\r\n    loadBpmnFromFile: function(bpmnFile) {\r\n      this.xmlStr = bpmnFile;\r\n      this.bpmnModeler.importXML(this.xmlStr);\r\n    },\r\n\r\n    //下载BPMN为.BPMN格式（本质上是xml格式）\r\n    downloadBpmnToFile: function() {\r\n      this.bpmnModeler.saveXML(\r\n        {\r\n          format: true\r\n        },\r\n        (err, xml) => {\r\n          this.download(\"1.bpmn\", xml);\r\n        }\r\n      );\r\n    },\r\n    //下载BPMN为.SVG格式\r\n    downloadBpmnToSVG: function() {\r\n      this.bpmnModeler.saveSVG(\r\n        {\r\n          format: true\r\n        },\r\n        (err, data) => {\r\n          this.download(\"bpmn.svg\", data);\r\n        }\r\n      );\r\n    },\r\n    //下载其实是调用了这个函数进行的，感觉还可以再简写一下\r\n    download: function(filename, text) {\r\n      let element = document.createElement(\"a\");\r\n      element.style.display = \"none\";\r\n      element.setAttribute(\r\n        \"href\",\r\n        \"data:text/plain;charset=utf-8,\" + encodeURIComponent(text)\r\n      );\r\n      element.setAttribute(\"download\", filename);\r\n      document.body.appendChild(element);\r\n      element.click();\r\n      document.body.removeChild(element);\r\n    },\r\n\r\n    //重置\r\n    //当前的this.xmlStr重新替换为空白模板\r\n    resetBPMN: function() {\r\n      this.xmlStr = BlankStr;\r\n      this.bpmnModeler.importXML(this.xmlStr);\r\n    },\r\n\r\n    //保存\r\n          saveBPMN: function() {            \r\n            \r\n            this.bpmnModeler.saveXML(\r\n              {\r\n                format: true\r\n              },\r\n              (err, xml) => {\r\n                this.xmlStr = xml;\r\n                this.$store.dispatch(\"editXml\", this.xmlStr);\r\n                \r\n                this.$prompt('', '请输入文件名:', {\r\n            confirmButtonText: '确定',\r\n            cancelButtonText: '取消',\r\n            closeOnClickModal: false,\r\n            showInput: true,\r\n            inputPlaceholder: \"请输入信息\",\r\n            inputType: \"textarea\"\r\n        }).then(({value}) => {            \r\n            //发送数据\r\n            request({\r\n              \r\n                url: \"/recommendation/saveBPMN\",\r\n                method: \"post\",\r\n                /*params: {\r\n                    name:value,\r\n                   //message : xml\r\n                },*/\r\n                data:  qs.stringify({name:value,message :xml}),\r\n                \r\n                \r\n            }).then(res => {\r\n                console.log(res.data)\r\n                if(res.data===\"0\"){\r\n                  this.$message({\r\n                      type: 'success',\r\n                      message: '保存成功'\r\n            });\r\n                }\r\n                //this.xmlStr = res.data;\r\n                //this.bpmnModeler.importXML(this.xmlStr);\r\n            }).catch(err => {\r\n                console.log(\"发送失败\")\r\n            })\r\n        }).catch(() => {\r\n            this.$message({\r\n                type: 'info',\r\n                message: '还没想好？'\r\n            });\r\n        })\r\n\r\n              }\r\n            );\r\n          },\r\n\r\n     //推荐     \r\n     \r\n        recoBPMN: function() {         \r\n          const axios = this.$axios;\r\n          axios.defaults.withCredentials = true\r\n          var strXML;\r\n          //Vue.prototype.$qs = qs         \r\n          this.bpmnModeler.saveXML(\r\n              {\r\n                format: true\r\n              },\r\n              (err, xml) => {\r\n                strXML= xml                      \r\n              }\r\n            );        \r\n       axios({\r\n              method: \"post\",              \r\n              //url: \"http://lxc-backend-java.ingress.isa.buaanlsde.cn/recommendation/RecommStructure\",   \r\n              //url: \"http://backend-java:8090/recommendation/RecommStructure\",   \r\n              url: \"http://localhost:8090/recommendation/RecommStructure\",        \r\n              data: qs.stringify({lxccontent:strXML})              \r\n            })\r\n              .then(res => {\r\n                //console.log(content);\r\n                this.xmlStr = res.data;\r\n                this.bpmnModeler.importXML(this.xmlStr);\r\n               \r\n               \r\n              })\r\n         },\r\n\r\n    //检查\r\n    checkBPMN: function() {\r\n      /*使用形式化验证会在底部出现Toggle Lint按钮，检查只需要点击响应的按钮即可*/\r\n      const bjslButton = document.querySelector(\".bjsl-button\");\r\n      bjslButton.click();\r\n    },\r\n    //文本转换\r\n    textTransform: function() {\r\n      const _bpmnModeler = this.bpmnModeler;\r\n      const axios = this.$axios;\r\n      this.$msgbox({\r\n        title: \"NLP\",\r\n        message: \"请输入一段描述业务流程的文字\",\r\n        showInput: true,\r\n        inputType: \"textarea\",\r\n        confirmButtonText: \"生成BPMN\",\r\n        beforeClose: (action, instance, done) => {\r\n          //这个函数在调用接口之前先看一下原理，\r\n          if (action === \"confirm\") {\r\n            instance.confirmButtonLoading = true;\r\n            instance.confirmButtonText = \"执行中...\";\r\n            //在发送前把数据打包，否则后端接收不到\r\n            let _param = new URLSearchParams();\r\n            _param.append(\r\n              \"str\",\r\n              instance.inputValue ? instance.inputValue : \" \"\r\n            );\r\n            // _param.append(\"name\", \"cbaymax\")\r\n\r\n            axios({\r\n              method: \"post\",\r\n              // test url: 'http://123.207.143.93:8081/anything',\r\n              url: \"/api/text2bpmn\",\r\n              data: _param\r\n            })\r\n              .then(res => {\r\n                console.log(res);\r\n                _bpmnModeler.importXML(res.data);\r\n                instance.confirmButtonLoading = false;\r\n                this.$message({\r\n                  type: \"success\",\r\n                  message: \"执行成功\"\r\n                });\r\n                done();\r\n              })\r\n              .catch(err => {\r\n                instance.confirmButtonLoading = false;\r\n                this.$message({\r\n                  type: \"error\",\r\n                  message: err\r\n                });\r\n                done();\r\n              });\r\n          } else {\r\n            this.$message({\r\n              type: \"info\",\r\n              message: \"已取消\"\r\n            });\r\n            done();\r\n          }\r\n        }\r\n      });\r\n    }\r\n  },\r\n\r\n  //生命周期函数 - 组件载入后, Vue 实例挂载到实际的 DOM 操作完成前执行该操作，不能在created()时初始化\r\n  mounted: function() {\r\n    this.initBpmn();\r\n  },\r\n  activated: function() {\r\n    this.xmlStr = this.$store.state.BpmnXml;\r\n    this.bpmnModeler.importXML(this.xmlStr);\r\n  }\r\n};\r\n</script>\r\n\r\n<style>\r\n.el-button {\r\n  background-color: #3F4254;\r\n}\r\n#editor .el-container {\r\n  position: fixed;\r\n  margin: auto;\r\n  left: 0px;\r\n  right: 0px;\r\n  bottom: 0px;\r\n  height: 100%;\r\n}\r\n\r\n#editor .el-header {\r\n  display: inline-flex;\r\n  height: 00px;\r\n  padding: 00px;\r\n}\r\n\r\n#editor .el-header .el-button-group {\r\n  display: inherit;\r\n}\r\n.el-main {\r\n    \r\n    padding: 00px;\r\n}\r\n#editor .bpmnContainer {\r\n  position: relative;\r\n  margin: auto;\r\n  left: 1px;\r\n  right: 1px;\r\n  bottom: 0px;\r\n  height: 100%;\r\n  border-style: solid;\r\n  border-width: 1px;\r\n}\r\n\r\n#editor #BpmnCanvas {\r\n  /* 主窗口区域 */\r\n  width: 100%;\r\n  height: 100%;\r\n}\r\n#editor #BpmnProperties {\r\n  /* 右侧元素属性菜单 */\r\n  position:absolute;\r\n  top:10px;\r\n  right:0px;\r\n  width:00px;\r\n  height:0px;\r\n  overflow-y:scroll;\r\n  background-color: rgba(0, 0, 0, 0);\r\n}\r\n\r\n@import \"~bpmn-js/dist/assets/diagram-js.css\";\r\n@import \"~bpmn-js/dist/assets/bpmn-font/css/bpmn.css\";\r\n@import \"~bpmn-js/dist/assets/bpmn-font/css/bpmn-embedded.css\";\r\n@import \"~bpmn-js-bpmnlint/dist/assets/css/bpmn-js-bpmnlint.css\";\r\n@import '~bpmn-js-properties-panel/dist/assets/bpmn-js-properties-panel.css';\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Editor.vue?vue&type=template&id=6ff140a8&\"\nimport script from \"./Editor.vue?vue&type=script&lang=js&\"\nexport * from \"./Editor.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Editor.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","'use strict';\n\nvar findExtension = require('../Helper').findExtension,\n    findExtensions = require('../Helper').findExtensions;\n\nvar createCamundaProperty = require('../CreateHelper').createCamundaProperty,\n    createInputParameter = require('../CreateHelper').createInputParameter,\n    createOutputParameter = require('../CreateHelper').createOutputParameter,\n    createCamundaIn = require('../CreateHelper').createCamundaIn,\n    createCamundaOut = require('../CreateHelper').createCamundaOut,\n    createCamundaInWithBusinessKey = require('../CreateHelper').createCamundaInWithBusinessKey,\n    createCamundaExecutionListenerScript = require('../CreateHelper').createCamundaExecutionListenerScript,\n    createCamundaFieldInjection = require('../CreateHelper').createCamundaFieldInjection;\n\nvar forEach = require('lodash/forEach');\n\nvar CAMUNDA_SERVICE_TASK_LIKE = [\n  'camunda:class',\n  'camunda:delegateExpression',\n  'camunda:expression'\n];\n\n/**\n * A handler that changes the modeling template of a BPMN element.\n */\nfunction ChangeElementTemplateHandler(modeling, commandStack, bpmnFactory) {\n\n  function getOrCreateExtensionElements(element) {\n\n    var bo = element.businessObject;\n\n    var extensionElements = bo.extensionElements;\n\n    // add extension elements\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      modeling.updateProperties(element, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  function updateModelerTemplate(element, newTemplate) {\n    modeling.updateProperties(element, {\n      'camunda:modelerTemplate': newTemplate && newTemplate.id\n    });\n  }\n\n  function updateIoMappings(element, newTemplate, context) {\n\n    var newMappings = createInputOutputMappings(newTemplate, bpmnFactory),\n        oldMappings;\n\n    if (!newMappings) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { inputOutput: newMappings }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldMappings = findExtension(element, 'camunda:InputOutput');\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: [ newMappings ],\n        objectsToRemove: oldMappings ? [ oldMappings ] : []\n      });\n    }\n  }\n\n  function updateCamundaField(element, newTemplate, context) {\n\n    var newMappings = createCamundaFieldInjections(newTemplate, bpmnFactory),\n        oldMappings;\n\n    if (!newMappings) {\n      return;\n    }\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { field: newMappings }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldMappings = findExtensions(element, ['camunda:Field']);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newMappings,\n        objectsToRemove: oldMappings ? oldMappings : []\n      });\n    }\n  }\n\n\n  function updateCamundaProperties(element, newTemplate, context) {\n\n    var newProperties = createCamundaProperties(newTemplate, bpmnFactory),\n        oldProperties;\n\n    if (!newProperties) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { properties: newProperties }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldProperties = findExtension(element, 'camunda:Properties');\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: [ newProperties ],\n        objectsToRemove: oldProperties ? [ oldProperties ] : []\n      });\n    }\n  }\n\n  function updateProperties(element, newTemplate, context) {\n\n    var newProperties = createBpmnPropertyUpdates(newTemplate, bpmnFactory);\n\n    var newPropertiesCount = Object.keys(newProperties).length;\n\n    if (!newPropertiesCount) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: newProperties\n      });\n    } else {\n      modeling.updateProperties(element, newProperties);\n    }\n  }\n\n  function updateInOut(element, newTemplate, context) {\n\n    var newInOut = createCamundaInOut(newTemplate, bpmnFactory),\n        oldInOut;\n\n    if (!newInOut) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { inout: newInOut }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldInOut = findExtensions(context, [ 'camunda:In', 'camunda:Out' ]);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newInOut,\n        objectsToRemove: oldInOut\n      });\n    }\n  }\n\n  function updateExecutionListener(element, newTemplate, context) {\n\n    var newExecutionListeners = createCamundaExecutionListeners(newTemplate, bpmnFactory),\n        oldExecutionsListeners;\n\n    if (!newExecutionListeners.length) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { executionListener: newExecutionListeners }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldExecutionsListeners = findExtensions(context, [ 'camunda:ExecutionListener' ]);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newExecutionListeners,\n        objectsToRemove: oldExecutionsListeners\n      });\n    }\n  }\n\n  /**\n   * Update / recreate a scoped element.\n   *\n   * @param {djs.model.Base} element the diagram parent element\n   * @param {String} scopeName name of the scope, i.e. camunda:Connector\n   * @param {Object} scopeDefinition\n   */\n  function updateScopeElements(element, scopeName, scopeDefinition) {\n\n    var scopeElement = bpmnFactory.create(scopeName);\n\n    // update camunda:inputOutput\n    updateIoMappings(element, scopeDefinition, scopeElement);\n\n    // update camunda:field\n    updateCamundaField(element, scopeDefinition, scopeElement);\n\n    // update camunda:properties\n    updateCamundaProperties(element, scopeDefinition, scopeElement);\n\n    // update other properties (bpmn:condition, camunda:async, ...)\n    updateProperties(element, scopeDefinition, scopeElement);\n\n    // update camunda:in and camunda:out\n    updateInOut(element, scopeDefinition, scopeElement);\n\n    // update camunda:executionListener\n    updateExecutionListener(element, scopeDefinition, scopeElement);\n\n    var extensionElements = getOrCreateExtensionElements(element);\n    var oldScope = findExtension(extensionElements, scopeName);\n\n    commandStack.execute('properties-panel.update-businessobject-list', {\n      element: element,\n      currentObject: extensionElements,\n      propertyName: 'values',\n      objectsToAdd: [ scopeElement ],\n      objectsToRemove: oldScope ? [ oldScope ] : []\n    });\n  }\n\n  /**\n   * Compose an element template change action, updating all\n   * necessary underlying properties.\n   *\n   * @param {Object} context\n   * @param {Object} context.element\n   * @param {Object} context.oldTemplate\n   * @param {Object} context.newTemplate\n   */\n  this.preExecute = function(context) {\n\n    var element = context.element,\n        newTemplate = context.newTemplate;\n\n    // update camunda:modelerTemplate attribute\n    updateModelerTemplate(element, newTemplate);\n\n    if (newTemplate) {\n\n      // update camunda:inputOutput\n      updateIoMappings(element, newTemplate);\n\n      // update camunda:field\n      updateCamundaField(element, newTemplate);\n\n      // update camunda:properties\n      updateCamundaProperties(element, newTemplate);\n\n      // update other properties (bpmn:condition, camunda:async, ...)\n      updateProperties(element, newTemplate);\n\n      // update camunda:in and camunda:out\n      updateInOut(element, newTemplate);\n\n      // update camunda:executionListener\n      updateExecutionListener(element, newTemplate);\n\n      // loop on scopes properties\n      forEach(newTemplate.scopes, function(scopeDefinition, scopeName) {\n        updateScopeElements(element, scopeName, scopeDefinition);\n      });\n\n    }\n  };\n}\n\nChangeElementTemplateHandler.$inject = [ 'modeling', 'commandStack', 'bpmnFactory' ];\n\nmodule.exports = ChangeElementTemplateHandler;\n\n\n\n// helpers /////////////////////////////\n\nfunction createBpmnPropertyUpdates(template, bpmnFactory) {\n\n  var propertyUpdates = {};\n\n  template.properties.forEach(function(p) {\n\n    var binding = p.binding,\n        bindingTarget = binding.name,\n        propertyValue;\n\n    if (binding.type === 'property') {\n\n      if (bindingTarget === 'conditionExpression') {\n        propertyValue = bpmnFactory.create('bpmn:FormalExpression', {\n          body: p.value,\n          language: binding.scriptFormat\n        });\n      } else {\n        propertyValue = p.value;\n      }\n\n      // assigning camunda:async to true|false\n      // assigning bpmn:conditionExpression to { $type: 'bpmn:FormalExpression', ... }\n      propertyUpdates[bindingTarget] = propertyValue;\n\n      // make sure we unset other \"implementation types\"\n      // when applying a camunda:class template onto a preconfigured\n      // camunda:delegateExpression element\n      if (CAMUNDA_SERVICE_TASK_LIKE.indexOf(bindingTarget) !== -1) {\n        CAMUNDA_SERVICE_TASK_LIKE.forEach(function(prop) {\n          if (prop !== bindingTarget) {\n            propertyUpdates[prop] = undefined;\n          }\n        });\n      }\n    }\n  });\n\n  return propertyUpdates;\n}\n\nfunction createCamundaFieldInjections(template, bpmnFactory) {\n  var injections = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n    if (bindingType === 'camunda:field') {\n      injections.push(createCamundaFieldInjection(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  if (injections.length) {\n    return injections;\n  }\n}\n\nfunction createCamundaProperties(template, bpmnFactory) {\n\n  var properties = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:property') {\n      properties.push(createCamundaProperty(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  if (properties.length) {\n    return bpmnFactory.create('camunda:Properties', {\n      values: properties\n    });\n  }\n}\n\nfunction createInputOutputMappings(template, bpmnFactory) {\n\n  var inputParameters = [],\n      outputParameters = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:inputParameter') {\n      inputParameters.push(createInputParameter(\n        binding, p.value, bpmnFactory\n      ));\n    }\n\n    if (bindingType === 'camunda:outputParameter') {\n      outputParameters.push(createOutputParameter(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  // do we need to create new ioMappings (?)\n  if (outputParameters.length || inputParameters.length) {\n    return bpmnFactory.create('camunda:InputOutput', {\n      inputParameters: inputParameters,\n      outputParameters: outputParameters\n    });\n  }\n}\n\nfunction createCamundaInOut(template, bpmnFactory) {\n\n  var inOuts = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:in') {\n      inOuts.push(createCamundaIn(\n        binding, p.value, bpmnFactory\n      ));\n    } else\n    if (bindingType === 'camunda:out') {\n      inOuts.push(createCamundaOut(\n        binding, p.value, bpmnFactory\n      ));\n    } else\n    if (bindingType === 'camunda:in:businessKey') {\n      inOuts.push(createCamundaInWithBusinessKey(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  return inOuts;\n}\n\n\nfunction createCamundaExecutionListeners(template, bpmnFactory) {\n\n  var executionListener = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:executionListener') {\n      executionListener.push(createCamundaExecutionListenerScript(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  return executionListener;\n}\n","var toFinite = require('./toFinite');\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nmodule.exports = toInteger;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar multiInstanceLoopCharacteristics = require('./implementation/MultiInstanceLoopCharacteristics');\n\nvar jobRetryTimeCycle = require('./implementation/JobRetryTimeCycle'),\n    asyncContinuation = require('./implementation/AsyncContinuation');\n\n\nfunction getLoopCharacteristics(element) {\n  var bo = getBusinessObject(element);\n  return bo.loopCharacteristics;\n}\n\n\nfunction ensureMultiInstanceSupported(element) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n  return !!loopCharacteristics && is(loopCharacteristics, 'camunda:Collectable');\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!ensureMultiInstanceSupported(element)) {\n    return;\n  }\n\n  // multi instance properties\n  group.entries = group.entries.concat(multiInstanceLoopCharacteristics(element, bpmnFactory, translate));\n\n  // async continuation ///////////////////////////////////////////////////////\n  group.entries = group.entries.concat(asyncContinuation(element, bpmnFactory, {\n    getBusinessObject: getLoopCharacteristics,\n    idPrefix: 'multiInstance-',\n    labelPrefix: translate('Multi Instance ')\n  }, translate));\n\n\n  // retry time cycle //////////////////////////////////////////////////////////\n  group.entries = group.entries.concat(jobRetryTimeCycle(element, bpmnFactory, {\n    getBusinessObject: getLoopCharacteristics,\n    idPrefix: 'multiInstance-',\n    labelPrefix: translate('Multi Instance ')\n  }, translate));\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textBox = function(options, defaultParameters) {\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      canBeShown = !!options.show && typeof options.show === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' + label + '</label>' +\n    '<div class=\"bpp-field-wrapper\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' +\n      '<div contenteditable=\"true\" id=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n            'name=\"' + escapeHTML(options.modelProperty) + '\" />' +\n    '</div>';\n\n  // add description below text box entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  if (canBeShown) {\n    resource.isShown = function() {\n      return options.show.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-textbox'];\n\n  return resource;\n};\n\nmodule.exports = textBox;\n","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n// Edge 14- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","'use strict';\nvar bind = require('../internals/function-bind-context');\nvar toObject = require('../internals/to-object');\nvar callWithSafeIterationClosing = require('../internals/call-with-safe-iteration-closing');\nvar isArrayIteratorMethod = require('../internals/is-array-iterator-method');\nvar toLength = require('../internals/to-length');\nvar createProperty = require('../internals/create-property');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\n// `Array.from` method implementation\n// https://tc39.github.io/ecma262/#sec-array.from\nmodule.exports = function from(arrayLike /* , mapfn = undefined, thisArg = undefined */) {\n  var O = toObject(arrayLike);\n  var C = typeof this == 'function' ? this : Array;\n  var argumentsLength = arguments.length;\n  var mapfn = argumentsLength > 1 ? arguments[1] : undefined;\n  var mapping = mapfn !== undefined;\n  var iteratorMethod = getIteratorMethod(O);\n  var index = 0;\n  var length, result, step, iterator, next, value;\n  if (mapping) mapfn = bind(mapfn, argumentsLength > 2 ? arguments[2] : undefined, 2);\n  // if the target is not iterable or it's an array with the default iterator - use a simple case\n  if (iteratorMethod != undefined && !(C == Array && isArrayIteratorMethod(iteratorMethod))) {\n    iterator = iteratorMethod.call(O);\n    next = iterator.next;\n    result = new C();\n    for (;!(step = next.call(iterator)).done; index++) {\n      value = mapping ? callWithSafeIterationClosing(iterator, mapfn, [step.value, index], true) : step.value;\n      createProperty(result, index, value);\n    }\n  } else {\n    length = toLength(O.length);\n    result = new C(length);\n    for (;length > index; index++) {\n      value = mapping ? mapfn(O[index], index) : O[index];\n      createProperty(result, index, value);\n    }\n  }\n  result.length = index;\n  return result;\n};\n","var getWrapDetails = require('./_getWrapDetails'),\n    insertWrapDetails = require('./_insertWrapDetails'),\n    setToString = require('./_setToString'),\n    updateWrapDetails = require('./_updateWrapDetails');\n\n/**\n * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n * with wrapper details in a comment at the top of the source body.\n *\n * @private\n * @param {Function} wrapper The function to modify.\n * @param {Function} reference The reference function.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Function} Returns `wrapper`.\n */\nfunction setWrapToString(wrapper, reference, bitmask) {\n  var source = (reference + '');\n  return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n}\n\nmodule.exports = setWrapToString;\n","'use strict';\n\nvar map = require('lodash/map');\n\nvar extensionElementsHelper = require('./ExtensionElementsHelper');\n\n/**\n * Returns true if the attribute 'camunda:asyncBefore' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isAsyncBefore(bo) {\n  return !!(bo.get('camunda:asyncBefore') || bo.get('camunda:async'));\n}\n\nmodule.exports.isAsyncBefore = isAsyncBefore;\n\n/**\n * Returns true if the attribute 'camunda:asyncAfter' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isAsyncAfter(bo) {\n  return !!bo.get('camunda:asyncAfter');\n}\n\nmodule.exports.isAsyncAfter = isAsyncAfter;\n\n/**\n * Returns true if the attribute 'camunda:exclusive' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isExclusive(bo) {\n  return !!bo.get('camunda:exclusive');\n}\n\nmodule.exports.isExclusive = isExclusive;\n\n/**\n * Get first 'camunda:FailedJobRetryTimeCycle' from the business object.\n *\n * @param  {ModdleElement} bo\n *\n * @return {Array<ModdleElement>} a list of 'camunda:FailedJobRetryTimeCycle'\n */\nfunction getFailedJobRetryTimeCycle(bo) {\n  return (extensionElementsHelper.getExtensionElements(bo, 'camunda:FailedJobRetryTimeCycle') || [])[0];\n}\n\nmodule.exports.getFailedJobRetryTimeCycle = getFailedJobRetryTimeCycle;\n\n/**\n * Removes all existing 'camunda:FailedJobRetryTimeCycle' from the business object\n *\n * @param  {ModdleElement} bo\n *\n * @return {Array<ModdleElement>} a list of 'camunda:FailedJobRetryTimeCycle'\n */\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  var retryTimeCycles = extensionElementsHelper.getExtensionElements(bo, 'camunda:FailedJobRetryTimeCycle');\n  return map(retryTimeCycles, function(cycle) {\n    return extensionElementsHelper.removeEntry(bo, element, cycle);\n  });\n}\n\nmodule.exports.removeFailedJobRetryTimeCycle = removeFailedJobRetryTimeCycle;","var arrayAggregator = require('./_arrayAggregator'),\n    baseAggregator = require('./_baseAggregator'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Creates a function like `_.groupBy`.\n *\n * @private\n * @param {Function} setter The function to set accumulator values.\n * @param {Function} [initializer] The accumulator object initializer.\n * @returns {Function} Returns the new aggregator function.\n */\nfunction createAggregator(setter, initializer) {\n  return function(collection, iteratee) {\n    var func = isArray(collection) ? arrayAggregator : baseAggregator,\n        accumulator = initializer ? initializer() : {};\n\n    return func(collection, setter, baseIteratee(iteratee, 2), accumulator);\n  };\n}\n\nmodule.exports = createAggregator;\n","var arrayEach = require('./_arrayEach'),\n    baseCreate = require('./_baseCreate'),\n    baseForOwn = require('./_baseForOwn'),\n    baseIteratee = require('./_baseIteratee'),\n    getPrototype = require('./_getPrototype'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isTypedArray = require('./isTypedArray');\n\n/**\n * An alternative to `_.reduce`; this method transforms `object` to a new\n * `accumulator` object which is the result of running each of its own\n * enumerable string keyed properties thru `iteratee`, with each invocation\n * potentially mutating the `accumulator` object. If `accumulator` is not\n * provided, a new object with the same `[[Prototype]]` will be used. The\n * iteratee is invoked with four arguments: (accumulator, value, key, object).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 1.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @param {*} [accumulator] The custom accumulator value.\n * @returns {*} Returns the accumulated value.\n * @example\n *\n * _.transform([2, 3, 4], function(result, n) {\n *   result.push(n *= n);\n *   return n % 2 == 0;\n * }, []);\n * // => [4, 9]\n *\n * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n *   (result[value] || (result[value] = [])).push(key);\n * }, {});\n * // => { '1': ['a', 'c'], '2': ['b'] }\n */\nfunction transform(object, iteratee, accumulator) {\n  var isArr = isArray(object),\n      isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n  iteratee = baseIteratee(iteratee, 4);\n  if (accumulator == null) {\n    var Ctor = object && object.constructor;\n    if (isArrLike) {\n      accumulator = isArr ? new Ctor : [];\n    }\n    else if (isObject(object)) {\n      accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n    }\n    else {\n      accumulator = {};\n    }\n  }\n  (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n    return iteratee(accumulator, value, index, object);\n  });\n  return accumulator;\n}\n\nmodule.exports = transform;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIteratee = require('./_baseIteratee'),\n    toInteger = require('./toInteger');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This method is like `_.find` except that it returns the index of the first\n * element `predicate` returns truthy for instead of the element itself.\n *\n * @static\n * @memberOf _\n * @since 1.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': false },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': true }\n * ];\n *\n * _.findIndex(users, function(o) { return o.user == 'barney'; });\n * // => 0\n *\n * // The `_.matches` iteratee shorthand.\n * _.findIndex(users, { 'user': 'fred', 'active': false });\n * // => 1\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findIndex(users, ['active', false]);\n * // => 0\n *\n * // The `_.property` iteratee shorthand.\n * _.findIndex(users, 'active');\n * // => 2\n */\nfunction findIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = fromIndex == null ? 0 : toInteger(fromIndex);\n  if (index < 0) {\n    index = nativeMax(length + index, 0);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index);\n}\n\nmodule.exports = findIndex;\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, signalEventDefinition, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, signalEventDefinition, bpmnFactory, {\n    label: translate('Signal'),\n    elementName: 'signal',\n    elementType: 'bpmn:Signal',\n    referenceProperty: 'signalRef',\n    newElementIdPrefix: 'Signal_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, signalEventDefinition, bpmnFactory, {\n    id: 'signal-element-name',\n    label: translate('Signal Name'),\n    referenceProperty: 'signalRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n};\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business object lists which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectListHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nUpdateBusinessObjectListHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = UpdateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + 'required');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a element under a provided parent.\n */\nUpdateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      updatedObjectList = context.updatedObjectList,\n      objectsToRemove = context.objectsToRemove || [],\n      objectsToAdd = context.objectsToAdd || [],\n      changed = [ context.element], // this will not change any diagram-js elements\n      referencePropertyName;\n\n  if (context.referencePropertyName) {\n    referencePropertyName = context.referencePropertyName;\n  }\n\n  var objectList = currentObject[propertyName];\n  // adjust array reference in the parent business object\n  context.previousList = currentObject[propertyName];\n\n  if (updatedObjectList) {\n    currentObject[propertyName] = updatedObjectList;\n  } else {\n    var listCopy = [];\n    // remove all objects which should be removed\n    forEach(objectList, function(object) {\n      if (objectsToRemove.indexOf(object) == -1) {\n        listCopy.push(object);\n      }\n    });\n    // add all objects which should be added\n    listCopy = listCopy.concat(objectsToAdd);\n\n    // set property to new list\n    if (listCopy.length > 0 || !referencePropertyName) {\n\n      // as long as there are elements in the list update the list\n      currentObject[propertyName] = listCopy;\n    } else if (referencePropertyName) {\n\n      // remove the list when it is empty\n      var parentObject = currentObject.$parent;\n      parentObject.set(referencePropertyName, undefined);\n    }\n  }\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousList = context.previousList,\n      parentObject = currentObject.$parent;\n\n  if (context.referencePropertyName) {\n    parentObject.set(context.referencePropertyName, currentObject);\n  }\n\n  // remove new element\n  currentObject.set(propertyName, previousList);\n\n  return context.changed;\n};\n","'use strict';\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar extensionElementsHelper = require('./ExtensionElementsHelper'),\n    implementationTypeHelper = require('./ImplementationTypeHelper');\n\nvar InputOutputHelper = {};\n\nmodule.exports = InputOutputHelper;\n\nfunction getElements(bo, type, prop) {\n  var elems = extensionElementsHelper.getExtensionElements(bo, type) || [];\n  return !prop ? elems : (elems[0] || {})[prop] || [];\n}\n\nfunction getParameters(element, prop, insideConnector) {\n  var inputOutput = InputOutputHelper.getInputOutput(element, insideConnector);\n  return (inputOutput && inputOutput.get(prop)) || [];\n}\n\n/**\n * Get a inputOutput from the business object\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {ModdleElement} the inputOutput object\n */\nInputOutputHelper.getInputOutput = function(element, insideConnector) {\n  if (!insideConnector) {\n    var bo = getBusinessObject(element);\n    return (getElements(bo, 'camunda:InputOutput') || [])[0];\n  }\n  var connector = this.getConnector(element);\n  return connector && connector.get('inputOutput');\n};\n\n/**\n * Get a connector from the business object\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement} the connector object\n */\nInputOutputHelper.getConnector = function(element) {\n  var bo = implementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n  return bo && (getElements(bo, 'camunda:Connector') || [])[0];\n};\n\n/**\n * Return all input parameters existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {Array} a list of input parameter objects\n */\nInputOutputHelper.getInputParameters = function(element, insideConnector) {\n  return getParameters.apply(this, [ element, 'inputParameters', insideConnector ]);\n};\n\n/**\n * Return all output parameters existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {Array} a list of output parameter objects\n */\nInputOutputHelper.getOutputParameters = function(element, insideConnector) {\n  return getParameters.apply(this, [ element, 'outputParameters', insideConnector ]);\n};\n\n/**\n * Get a input parameter from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n * @param {number} idx\n *\n * @return {ModdleElement} input parameter\n */\nInputOutputHelper.getInputParameter = function(element, insideConnector, idx) {\n  return this.getInputParameters(element, insideConnector)[idx];\n};\n\n/**\n * Get a output parameter from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n * @param {number} idx\n *\n * @return {ModdleElement} output parameter\n */\nInputOutputHelper.getOutputParameter = function(element, insideConnector, idx) {\n  return this.getOutputParameters(element, insideConnector)[idx];\n};\n\n/**\n * Returns 'true' if the given element supports inputOutput\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {boolean} a boolean value\n */\nInputOutputHelper.isInputOutputSupported = function(element, insideConnector) {\n\n  if (insideConnector) {\n    return true;\n  }\n\n  var bo = getBusinessObject(element);\n\n  return (\n    is(bo, 'bpmn:FlowNode') && !(\n      is(bo, 'bpmn:StartEvent') ||\n      is(bo, 'bpmn:Gateway') ||\n      is(bo, 'bpmn:BoundaryEvent') ||\n      (\n        is(bo, 'bpmn:SubProcess') && bo.get('triggeredByEvent')\n      )\n    )\n  );\n};\n\n/**\n * Returns 'true' if the given element supports output parameters\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {boolean} a boolean value\n */\nInputOutputHelper.areOutputParametersSupported = function(element, insideConnector) {\n  var bo = getBusinessObject(element);\n  return insideConnector || (!is(bo, 'bpmn:EndEvent') && !bo.loopCharacteristics);\n};\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementReferenceProperty = require('../../../bpmn/parts/implementation/ElementReferenceProperty');\n\nmodule.exports = function(\n    group, element, bpmnFactory, errorEventDefinition,\n    showErrorCodeVariable, showErrorMessageVariable, translate\n) {\n\n\n  var getValue = function(modelProperty) {\n    return function(element) {\n      var modelPropertyValue = errorEventDefinition.get('camunda:' + modelProperty);\n      var value = {};\n\n      value[modelProperty] = modelPropertyValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values) {\n      var props = {};\n\n      props['camunda:' + modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, errorEventDefinition, props);\n    };\n  };\n\n\n  group.entries = group.entries.concat(\n    elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n      id: 'error-element-message',\n      label: translate('Error Message'),\n      referenceProperty: 'errorRef',\n      modelProperty: 'errorMessage'\n    })\n  );\n\n  if (showErrorCodeVariable) {\n    group.entries.push(entryFactory.textField({\n      id: 'errorCodeVariable',\n      label: translate('Error Code Variable'),\n      modelProperty : 'errorCodeVariable',\n\n      get: getValue('errorCodeVariable'),\n      set: setValue('errorCodeVariable')\n    }));\n  }\n\n  if (showErrorMessageVariable) {\n    group.entries.push(entryFactory.textField({\n      id: 'errorMessageVariable',\n      label: translate('Error Message Variable'),\n      modelProperty: 'errorMessageVariable',\n\n      get: getValue('errorMessageVariable'),\n      set: setValue('errorMessageVariable')\n    }));\n  }\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar cmdHelper = require('../helper/CmdHelper');\n\nvar domQuery = require('min-dom').query,\n    domAttr = require('min-dom').attr,\n    domClosest = require('min-dom').closest;\n\nvar filter = require('lodash/filter'),\n    forEach = require('lodash/forEach'),\n    keys = require('lodash/keys');\n\nvar domify = require('min-dom').domify;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\nvar updateSelection = require('selection-update');\n\nvar TABLE_ROW_DIV_SNIPPET = '<div class=\"bpp-field-wrapper bpp-table-row\">';\nvar DELETE_ROW_BUTTON_SNIPPET = '<button class=\"clear\" data-action=\"deleteElement\">' +\n                                  '<span>X</span>' +\n                                '</button>';\n\nfunction createInputRowTemplate(properties, canRemove) {\n  var template = TABLE_ROW_DIV_SNIPPET;\n  template += createInputTemplate(properties, canRemove);\n  template += canRemove ? DELETE_ROW_BUTTON_SNIPPET : '';\n  template += '</div>';\n\n  return template;\n}\n\nfunction createInputTemplate(properties, canRemove) {\n  var columns = properties.length;\n  var template = '';\n  forEach(properties, function(prop) {\n    template += '<input class=\"bpp-table-row-columns-' + columns + ' ' +\n                               (canRemove ? 'bpp-table-row-removable' : '') + '\" ' +\n                       'id=\"camunda-table-row-cell-input-value\" ' +\n                       'type=\"text\" ' +\n                       'name=\"' + escapeHTML(prop) + '\" />';\n  });\n  return template;\n}\n\nfunction createLabelRowTemplate(labels) {\n  var template = TABLE_ROW_DIV_SNIPPET;\n  template += createLabelTemplate(labels);\n  template += '</div>';\n\n  return template;\n}\n\nfunction createLabelTemplate(labels) {\n  var columns = labels.length;\n  var template = '';\n  forEach(labels, function(label) {\n    template += '<label class=\"bpp-table-row-columns-' + columns + '\">' + escapeHTML(label) + '</label>';\n  });\n  return template;\n}\n\nfunction pick(elements, properties) {\n  return (elements || []).map(function(elem) {\n    var newElement = {};\n    forEach(properties, function(prop) {\n      newElement[prop] = elem[prop] || '';\n    });\n    return newElement;\n  });\n}\n\nfunction diff(element, node, values, oldValues, editable) {\n  return filter(values, function(value, idx) {\n    return !valueEqual(element, node, value, oldValues[idx], editable, idx);\n  });\n}\n\nfunction valueEqual(element, node, value, oldValue, editable, idx) {\n  if (value && !oldValue) {\n    return false;\n  }\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    var n = value[key] || undefined;\n    var o = oldValue[key] || undefined;\n    return !editable(element, node, key, idx) || n === o;\n  });\n}\n\nfunction getEntryNode(node) {\n  return domClosest(node, '[data-entry]', true);\n}\n\nfunction getContainer(node) {\n  return domQuery('div[data-list-entry-container]', node);\n}\n\nfunction getSelection(node) {\n  return {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction setSelection(node, selection) {\n  node.selectionStart = selection.start;\n  node.selectionEnd = selection.end;\n}\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} options.description\n * @param  {Array<string>} options.modelProperties\n * @param  {Array<string>} options.labels\n * @param  {Function} options.getElements - this callback function must return a list of business object items\n * @param  {Function} options.removeElement\n * @param  {Function} options.addElement\n * @param  {Function} options.updateElement\n * @param  {Function} options.editable\n * @param  {Function} options.setControlValue\n * @param  {Function} options.show\n *\n * @return {Object}\n */\nmodule.exports = function(options) {\n\n  var id = options.id,\n      modelProperties = options.modelProperties,\n      labels = options.labels,\n      description = options.description;\n\n  var labelRow = createLabelRowTemplate(labels);\n\n  var getElements = options.getElements;\n\n  var removeElement = options.removeElement,\n      canRemove = typeof removeElement === 'function';\n\n  var addElement = options.addElement,\n      canAdd = typeof addElement === 'function',\n      addLabel = options.addLabel || 'Add Value';\n\n  var updateElement = options.updateElement,\n      canUpdate = typeof updateElement === 'function';\n\n  var editable = options.editable || function() { return true; },\n      setControlValue = options.setControlValue;\n\n  var show = options.show,\n      canBeShown = typeof show === 'function';\n\n  var elements = function(element, node) {\n    return pick(getElements(element, node), modelProperties);\n  };\n\n  var factory = {\n    id: id,\n    html: (canAdd ?\n      '<div class=\"bpp-table-add-row\" ' + (canBeShown ? 'data-show=\"show\"' : '') + '>' +\n            '<label>' + escapeHTML(addLabel) + '</label>' +\n            '<button class=\"add\" data-action=\"addElement\"><span>+</span></button>' +\n          '</div>' : '') +\n          '<div class=\"bpp-table\" data-show=\"showTable\">' +\n            '<div class=\"bpp-field-wrapper bpp-table-row\">' +\n               labelRow +\n            '</div>' +\n            '<div data-list-entry-container>' +\n            '</div>' +\n          '</div>' +\n\n          // add description below table entry field\n          (description ? entryFieldDescription(description) : ''),\n\n    get: function(element, node) {\n      var boElements = elements(element, node, this.__invalidValues);\n\n      var invalidValues = this.__invalidValues;\n\n      delete this.__invalidValues;\n\n      forEach(invalidValues, function(value, idx) {\n        var element = boElements[idx];\n\n        forEach(modelProperties, function(prop) {\n          element[prop] = value[prop];\n        });\n      });\n\n      return boElements;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action || {};\n      delete this.__action;\n\n      if (action.id === 'delete-element') {\n        return removeElement(element, node, action.idx);\n      }\n      else if (action.id === 'add-element') {\n        return addElement(element, node);\n      }\n      else if (canUpdate) {\n        var commands = [],\n            valuesToValidate = values;\n\n        if (typeof options.validate !== 'function') {\n          valuesToValidate = diff(element, node, values, elements(element, node), editable);\n        }\n\n        var self = this;\n\n        forEach(valuesToValidate, function(value) {\n          var validationError,\n              idx = values.indexOf(value);\n\n          if (typeof options.validate === 'function') {\n            validationError = options.validate(element, value, node, idx);\n          }\n\n          if (!validationError) {\n            var cmd = updateElement(element, value, node, idx);\n\n            if (cmd) {\n              commands.push(cmd);\n            }\n          } else {\n            // cache invalid value in an object by index as key\n            self.__invalidValues = self.__invalidValues || {};\n            self.__invalidValues[idx] = value;\n\n            // execute a command, which does not do anything\n            commands.push(cmdHelper.updateProperties(element, {}));\n          }\n        });\n\n        return commands;\n      }\n    },\n    createListEntryTemplate: function(value, index, selectBox) {\n      return createInputRowTemplate(modelProperties, canRemove);\n    },\n\n    addElement: function(element, node, event, scopeNode) {\n      var template = domify(createInputRowTemplate(modelProperties, canRemove));\n\n      var container = getContainer(node);\n      container.appendChild(template);\n\n      this.__action = {\n        id: 'add-element'\n      };\n\n      return true;\n    },\n\n    deleteElement: function(element, node, event, scopeNode) {\n      var container = getContainer(node);\n      var rowToDelete = event.delegateTarget.parentNode;\n      var idx = parseInt(domAttr(rowToDelete, 'data-index'), 10);\n\n      container.removeChild(rowToDelete);\n\n      this.__action = {\n        id: 'delete-element',\n        idx: idx\n      };\n\n      return true;\n    },\n\n    editable: function(element, rowNode, input, prop, value, idx) {\n      var entryNode = domClosest(rowNode, '[data-entry]');\n      return editable(element, entryNode, prop, idx);\n    },\n\n    show: function(element, entryNode, node, scopeNode) {\n      entryNode = getEntryNode(entryNode);\n      return show(element, entryNode, node, scopeNode);\n    },\n\n    showTable: function(element, entryNode, node, scopeNode) {\n      entryNode = getEntryNode(entryNode);\n      var elems = elements(element, entryNode);\n      return elems && elems.length && (!canBeShown || show(element, entryNode, node, scopeNode));\n    },\n\n    validateListItem: function(element, value, node, idx) {\n      if (typeof options.validate === 'function') {\n        return options.validate(element, value, node, idx);\n      }\n    }\n\n  };\n\n  // Update/set the selection on the correct position.\n  // It's the same code like for an input value in the PropertiesPanel.js.\n  if (setControlValue) {\n    factory.setControlValue = function(element, rowNode, input, prop, value, idx) {\n      var entryNode = getEntryNode(rowNode);\n\n      var isReadOnly = domAttr(input, 'readonly');\n      var oldValue = input.value;\n\n      var selection;\n\n      // prevents input fields from having the value 'undefined'\n      if (value === undefined) {\n        value = '';\n      }\n\n      // when the attribute 'readonly' exists, ignore the comparison\n      // with 'oldValue' and 'value'\n      if (!!isReadOnly && oldValue === value) {\n        return;\n      }\n\n      // update selection on undo/redo\n      if (document.activeElement === input) {\n        selection = updateSelection(getSelection(input), oldValue, value);\n      }\n\n      setControlValue(element, entryNode, input, prop, value, idx);\n\n      if (selection) {\n        setSelection(input, selection);\n      }\n\n    };\n  }\n\n  return factory;\n\n};\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * Gets the argument placeholder value for `func`.\n *\n * @private\n * @param {Function} func The function to inspect.\n * @returns {*} Returns the placeholder value.\n */\nfunction getHolder(func) {\n  var object = func;\n  return object.placeholder;\n}\n\nmodule.exports = getHolder;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper');\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var bo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  var fieldInjectionEntry = fieldInjection(element, bpmnFactory, translate, { businessObject: bo });\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var baseIteratee = require('./_baseIteratee'),\n    isArrayLike = require('./isArrayLike'),\n    keys = require('./keys');\n\n/**\n * Creates a `_.find` or `_.findLast` function.\n *\n * @private\n * @param {Function} findIndexFunc The function to find the collection index.\n * @returns {Function} Returns the new find function.\n */\nfunction createFind(findIndexFunc) {\n  return function(collection, predicate, fromIndex) {\n    var iterable = Object(collection);\n    if (!isArrayLike(collection)) {\n      var iteratee = baseIteratee(predicate, 3);\n      collection = keys(collection);\n      predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n    }\n    var index = findIndexFunc(collection, predicate, fromIndex);\n    return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n  };\n}\n\nmodule.exports = createFind;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    scriptImplementation = require('./implementation/Script');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var bo;\n\n  if (is(element, 'bpmn:ScriptTask')) {\n    bo = getBusinessObject(element);\n  }\n\n  if (!bo) {\n    return;\n  }\n\n  var script = scriptImplementation('scriptFormat', 'script', false, translate);\n  group.entries.push({\n    id: 'script-implementation',\n    label: translate('Script'),\n    html: script.template,\n\n    get: function(element) {\n      return script.get(element, bo);\n    },\n\n    set: function(element, values, containerElement) {\n      var properties = script.set(element, values, containerElement);\n\n      return cmdHelper.updateProperties(element, properties);\n    },\n\n    validate: function(element, values) {\n      return script.validate(element, values);\n    },\n\n    script : script,\n\n    cssClasses: ['bpp-textfield']\n\n  });\n\n  group.entries.push(entryFactory.textField({\n    id : 'scriptResultVariable',\n    label : translate('Result Variable'),\n    modelProperty : 'scriptResultVariable',\n\n    get: function(element, propertyName) {\n      var boResultVariable = bo.get('camunda:resultVariable');\n\n      return { scriptResultVariable : boResultVariable };\n    },\n\n    set: function(element, values, containerElement) {\n      return cmdHelper.updateProperties(element, {\n        'camunda:resultVariable': values.scriptResultVariable.length\n          ? values.scriptResultVariable\n          : undefined\n      });\n    }\n\n  }));\n\n};\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n","'use strict';\n// based on https://github.com/bestiejs/punycode.js/blob/master/punycode.js\nvar maxInt = 2147483647; // aka. 0x7FFFFFFF or 2^31-1\nvar base = 36;\nvar tMin = 1;\nvar tMax = 26;\nvar skew = 38;\nvar damp = 700;\nvar initialBias = 72;\nvar initialN = 128; // 0x80\nvar delimiter = '-'; // '\\x2D'\nvar regexNonASCII = /[^\\0-\\u007E]/; // non-ASCII chars\nvar regexSeparators = /[.\\u3002\\uFF0E\\uFF61]/g; // RFC 3490 separators\nvar OVERFLOW_ERROR = 'Overflow: input needs wider integers to process';\nvar baseMinusTMin = base - tMin;\nvar floor = Math.floor;\nvar stringFromCharCode = String.fromCharCode;\n\n/**\n * Creates an array containing the numeric code points of each Unicode\n * character in the string. While JavaScript uses UCS-2 internally,\n * this function will convert a pair of surrogate halves (each of which\n * UCS-2 exposes as separate characters) into a single code point,\n * matching UTF-16.\n */\nvar ucs2decode = function (string) {\n  var output = [];\n  var counter = 0;\n  var length = string.length;\n  while (counter < length) {\n    var value = string.charCodeAt(counter++);\n    if (value >= 0xD800 && value <= 0xDBFF && counter < length) {\n      // It's a high surrogate, and there is a next character.\n      var extra = string.charCodeAt(counter++);\n      if ((extra & 0xFC00) == 0xDC00) { // Low surrogate.\n        output.push(((value & 0x3FF) << 10) + (extra & 0x3FF) + 0x10000);\n      } else {\n        // It's an unmatched surrogate; only append this code unit, in case the\n        // next code unit is the high surrogate of a surrogate pair.\n        output.push(value);\n        counter--;\n      }\n    } else {\n      output.push(value);\n    }\n  }\n  return output;\n};\n\n/**\n * Converts a digit/integer into a basic code point.\n */\nvar digitToBasic = function (digit) {\n  //  0..25 map to ASCII a..z or A..Z\n  // 26..35 map to ASCII 0..9\n  return digit + 22 + 75 * (digit < 26);\n};\n\n/**\n * Bias adaptation function as per section 3.4 of RFC 3492.\n * https://tools.ietf.org/html/rfc3492#section-3.4\n */\nvar adapt = function (delta, numPoints, firstTime) {\n  var k = 0;\n  delta = firstTime ? floor(delta / damp) : delta >> 1;\n  delta += floor(delta / numPoints);\n  for (; delta > baseMinusTMin * tMax >> 1; k += base) {\n    delta = floor(delta / baseMinusTMin);\n  }\n  return floor(k + (baseMinusTMin + 1) * delta / (delta + skew));\n};\n\n/**\n * Converts a string of Unicode symbols (e.g. a domain name label) to a\n * Punycode string of ASCII-only symbols.\n */\n// eslint-disable-next-line  max-statements\nvar encode = function (input) {\n  var output = [];\n\n  // Convert the input in UCS-2 to an array of Unicode code points.\n  input = ucs2decode(input);\n\n  // Cache the length.\n  var inputLength = input.length;\n\n  // Initialize the state.\n  var n = initialN;\n  var delta = 0;\n  var bias = initialBias;\n  var i, currentValue;\n\n  // Handle the basic code points.\n  for (i = 0; i < input.length; i++) {\n    currentValue = input[i];\n    if (currentValue < 0x80) {\n      output.push(stringFromCharCode(currentValue));\n    }\n  }\n\n  var basicLength = output.length; // number of basic code points.\n  var handledCPCount = basicLength; // number of code points that have been handled;\n\n  // Finish the basic string with a delimiter unless it's empty.\n  if (basicLength) {\n    output.push(delimiter);\n  }\n\n  // Main encoding loop:\n  while (handledCPCount < inputLength) {\n    // All non-basic code points < n have been handled already. Find the next larger one:\n    var m = maxInt;\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue >= n && currentValue < m) {\n        m = currentValue;\n      }\n    }\n\n    // Increase `delta` enough to advance the decoder's <n,i> state to <m,0>, but guard against overflow.\n    var handledCPCountPlusOne = handledCPCount + 1;\n    if (m - n > floor((maxInt - delta) / handledCPCountPlusOne)) {\n      throw RangeError(OVERFLOW_ERROR);\n    }\n\n    delta += (m - n) * handledCPCountPlusOne;\n    n = m;\n\n    for (i = 0; i < input.length; i++) {\n      currentValue = input[i];\n      if (currentValue < n && ++delta > maxInt) {\n        throw RangeError(OVERFLOW_ERROR);\n      }\n      if (currentValue == n) {\n        // Represent delta as a generalized variable-length integer.\n        var q = delta;\n        for (var k = base; /* no condition */; k += base) {\n          var t = k <= bias ? tMin : (k >= bias + tMax ? tMax : k - bias);\n          if (q < t) break;\n          var qMinusT = q - t;\n          var baseMinusT = base - t;\n          output.push(stringFromCharCode(digitToBasic(t + qMinusT % baseMinusT)));\n          q = floor(qMinusT / baseMinusT);\n        }\n\n        output.push(stringFromCharCode(digitToBasic(q)));\n        bias = adapt(delta, handledCPCountPlusOne, handledCPCount == basicLength);\n        delta = 0;\n        ++handledCPCount;\n      }\n    }\n\n    ++delta;\n    ++n;\n  }\n  return output.join('');\n};\n\nmodule.exports = function (input) {\n  var encoded = [];\n  var labels = input.toLowerCase().replace(regexSeparators, '\\u002E').split('.');\n  var i, label;\n  for (i = 0; i < labels.length; i++) {\n    label = labels[i];\n    encoded.push(regexNonASCII.test(label) ? 'xn--' + encode(label) : label);\n  }\n  return encoded.join('.');\n};\n","'use strict';\n\n/**\n * The label factory provides a label entry. For the label text\n * it expects either a string provided by the options.labelText\n * parameter or it could be generated programmatically using a\n * function passed as the options.get parameter.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.labelText]\n * @param  {Function} [options.get]\n * @param  {Function} [options.showLabel]\n * @param  {Boolean} [options.divider] adds a divider at the top of the label if true; default: false\n */\nvar label = function(options) {\n  return {\n    id: options.id,\n    html: '<label data-value=\"label\" ' +\n            'data-show=\"showLabel\" ' +\n            'class=\"entry-label' + (options.divider ? ' divider' : '') + '\">' +\n          '</label>',\n    get: function(element, node) {\n      if (typeof options.get === 'function') {\n        return options.get(element, node);\n      }\n      return { label: options.labelText };\n    },\n    showLabel: function(element, node) {\n      if (typeof options.showLabel === 'function') {\n        return options.showLabel(element, node);\n      }\n      return true;\n    }\n  };\n};\n\nmodule.exports = label;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/** Used as references for the maximum length and index of an array. */\nvar MAX_ARRAY_LENGTH = 4294967295;\n\n/**\n * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n *\n * @private\n * @constructor\n * @param {*} value The value to wrap.\n */\nfunction LazyWrapper(value) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__dir__ = 1;\n  this.__filtered__ = false;\n  this.__iteratees__ = [];\n  this.__takeCount__ = MAX_ARRAY_LENGTH;\n  this.__views__ = [];\n}\n\n// Ensure `LazyWrapper` is an instance of `baseLodash`.\nLazyWrapper.prototype = baseCreate(baseLodash.prototype);\nLazyWrapper.prototype.constructor = LazyWrapper;\n\nmodule.exports = LazyWrapper;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var toNumber = require('./toNumber');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nmodule.exports = toFinite;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    escapeHTML = require('../../../Utils').escapeHTML,\n    domQuery = require('min-dom').query,\n    cmdHelper = require('../../../helper/CmdHelper'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper'),\n    scriptImplementation = require('./implementation/Script');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n  if (!(is(element, 'bpmn:SequenceFlow') && isConditionalSource(element.source))\n    && !conditionalEventDefinition) {\n    return;\n  }\n\n  var script = scriptImplementation('language', 'body', true, translate);\n  group.entries.push({\n    id: 'condition',\n    label: translate('Condition'),\n    html: '<div class=\"bpp-row\">' +\n              '<label for=\"cam-condition-type\">'+ escapeHTML(translate('Condition Type')) + '</label>' +\n              '<div class=\"bpp-field-wrapper\">' +\n                '<select id=\"cam-condition-type\" name=\"conditionType\" data-value>' +\n                  '<option value=\"expression\">'+ escapeHTML(translate('Expression')) + '</option>' +\n                  '<option value=\"script\">'+ escapeHTML(translate('Script')) + '</option>' +\n                  '<option value=\"\" selected></option>' +\n                '</select>' +\n              '</div>' +\n            '</div>' +\n\n            // expression\n            '<div class=\"bpp-row\">' +\n              '<label for=\"cam-condition\" data-show=\"isExpression\">' + escapeHTML(translate('Expression')) + '</label>' +\n              '<div class=\"bpp-field-wrapper\" data-show=\"isExpression\">' +\n                '<input id=\"cam-condition\" type=\"text\" name=\"condition\" />' +\n                '<button class=\"clear\" data-action=\"clear\" data-show=\"canClear\">' +\n                  '<span>X</span>' +\n                '</button>' +\n              '</div>' +\n              '<div data-show=\"isScript\">' +\n                script.template +\n              '</div>' +\n            '</div>',\n\n    get: function(element, propertyName) {\n      var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n      var conditionExpression = conditionalEventDefinition\n        ? conditionalEventDefinition.condition\n        : bo.conditionExpression;\n\n      var values = {},\n          conditionType = '';\n\n      if (conditionExpression) {\n        var conditionLanguage = conditionExpression.language;\n        if (typeof conditionLanguage !== 'undefined') {\n          conditionType = 'script';\n          values = script.get(element, conditionExpression);\n        } else {\n          conditionType = 'expression';\n          values.condition = conditionExpression.get('body');\n        }\n      }\n\n      values.conditionType = conditionType;\n\n      return values;\n\n    },\n\n    set: function(element, values, containerElement) {\n      var conditionType = values.conditionType;\n      var commands = [];\n\n      var conditionProps = {\n        body: undefined\n      };\n\n      if (conditionType === 'script') {\n        conditionProps = script.set(element, values, containerElement);\n      } else {\n        var condition = values.condition;\n\n        conditionProps.body = condition;\n      }\n\n      var conditionOrConditionExpression;\n\n      if (conditionType) {\n        conditionOrConditionExpression = elementHelper.createElement(\n          'bpmn:FormalExpression',\n          conditionProps,\n          conditionalEventDefinition || bo,\n          bpmnFactory\n        );\n\n        var source = element.source;\n\n        // if default-flow, remove default-property from source\n        if (source && source.businessObject.default === bo) {\n          commands.push(cmdHelper.updateProperties(source, { 'default': undefined }));\n        }\n      }\n\n      var update = conditionalEventDefinition\n        ? { condition: conditionOrConditionExpression }\n        : { conditionExpression: conditionOrConditionExpression };\n\n      commands.push(cmdHelper.updateBusinessObject(element, conditionalEventDefinition || bo, update));\n\n      return commands;\n    },\n\n    validate: function(element, values) {\n      var validationResult = {};\n\n      if (!values.condition && values.conditionType === 'expression') {\n        validationResult.condition = translate('Must provide a value');\n      }\n      else if (values.conditionType === 'script') {\n        validationResult = script.validate(element, values);\n      }\n\n      return validationResult;\n    },\n\n    isExpression: function(element, inputNode) {\n      var conditionType = domQuery('select[name=conditionType]', inputNode);\n      if (conditionType.selectedIndex >= 0) {\n        return conditionType.options[conditionType.selectedIndex].value === 'expression';\n      }\n    },\n\n    isScript: function(element, inputNode) {\n      var conditionType = domQuery('select[name=conditionType]', inputNode);\n      if (conditionType.selectedIndex >= 0) {\n        return conditionType.options[conditionType.selectedIndex].value === 'script';\n      }\n    },\n\n    clear: function(element, inputNode) {\n      // clear text input\n      domQuery('input[name=condition]', inputNode).value='';\n\n      return true;\n    },\n\n    canClear: function(element, inputNode) {\n      var input = domQuery('input[name=condition]', inputNode);\n\n      return input.value !== '';\n    },\n\n    script : script,\n\n    cssClasses: [ 'bpp-textfield' ]\n  });\n};\n\n\n// utilities //////////////////////////\n\nvar CONDITIONAL_SOURCES = [\n  'bpmn:Activity',\n  'bpmn:ExclusiveGateway',\n  'bpmn:InclusiveGateway',\n  'bpmn:ComplexGateway'\n];\n\nfunction isConditionalSource(element) {\n  return isAny(element, CONDITIONAL_SOURCES);\n}\n","var toInteger = require('../internals/to-integer');\nvar requireObjectCoercible = require('../internals/require-object-coercible');\n\n// `String.prototype.{ codePointAt, at }` methods implementation\nvar createMethod = function (CONVERT_TO_STRING) {\n  return function ($this, pos) {\n    var S = String(requireObjectCoercible($this));\n    var position = toInteger(pos);\n    var size = S.length;\n    var first, second;\n    if (position < 0 || position >= size) return CONVERT_TO_STRING ? '' : undefined;\n    first = S.charCodeAt(position);\n    return first < 0xD800 || first > 0xDBFF || position + 1 === size\n      || (second = S.charCodeAt(position + 1)) < 0xDC00 || second > 0xDFFF\n        ? CONVERT_TO_STRING ? S.charAt(position) : first\n        : CONVERT_TO_STRING ? S.slice(position, position + 2) : (first - 0xD800 << 10) + (second - 0xDC00) + 0x10000;\n  };\n};\n\nmodule.exports = {\n  // `String.prototype.codePointAt` method\n  // https://tc39.github.io/ecma262/#sec-string.prototype.codepointat\n  codeAt: createMethod(false),\n  // `String.prototype.at` method\n  // https://github.com/mathiasbynens/String.prototype.at\n  charAt: createMethod(true)\n};\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var jobPriorityEntry = entryFactory.textField({\n    id: 'jobPriority',\n    label: translate('Job Priority'),\n    modelProperty: 'jobPriority',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        jobPriority: bo.get('camunda:jobPriority')\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:jobPriority': values.jobPriority || undefined\n      });\n    }\n\n  });\n\n  return [ jobPriorityEntry ];\n\n};\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","module.exports = {\n  __depends__: [\n    require('./cmd'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [\n    'customElementsPropertiesActivator',\n    'elementTemplatesLoader'\n  ],\n  customElementsPropertiesActivator: [ 'type', require('./CustomElementsPropertiesActivator') ],\n  elementTemplates: [ 'type', require('./ElementTemplates') ],\n  elementTemplatesLoader: [ 'type', require('./ElementTemplatesLoader') ]\n};\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that verifies that there are no disconnected\n * flow elements, i.e. elements without incoming\n * _or_ outgoing sequence flows\n */\nmodule.exports = function() {\n\n  const keyed = {};\n\n  const outgoingReported = {};\n  const incomingReported = {};\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SequenceFlow')) {\n      return;\n    }\n\n    const key = flowKey(node);\n\n    if (key in keyed) {\n      reporter.report(node.id, 'SequenceFlow is a duplicate');\n\n      const sourceId = node.sourceRef.id;\n      const targetId = node.targetRef.id;\n\n      console.log(sourceId, targetId);\n\n      if (!outgoingReported[sourceId]) {\n        reporter.report(sourceId, 'Duplicate outgoing sequence flows');\n\n        outgoingReported[sourceId] = true;\n      }\n\n      if (!incomingReported[targetId]) {\n        reporter.report(targetId, 'Duplicate incoming sequence flows');\n\n        incomingReported[targetId] = true;\n      }\n    } else {\n      keyed[key] = node;\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////\n\nfunction flowKey(flow) {\n  const conditionExpression = flow.conditionExpression;\n\n  const condition = conditionExpression ? conditionExpression.body : '';\n  const source = flow.sourceRef ? flow.sourceRef.id : flow.id;\n  const target = flow.targetRef ? flow.targetRef.id : flow.id;\n\n  return source + '#' + target + '#' + condition;\n}","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks that start events inside an event sub-process\n * are typed.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SubProcess') || !node.triggeredByEvent) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    flowElements.forEach(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      if (eventDefinitions.length === 0) {\n        reporter.report(flowElement.id, 'Start event is missing event definition');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    countHolders = require('./_countHolders'),\n    createCtor = require('./_createCtor'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    reorder = require('./_reorder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_ARY_FLAG = 128,\n    WRAP_FLIP_FLAG = 512;\n\n/**\n * Creates a function that wraps `func` to invoke it with optional `this`\n * binding of `thisArg`, partial application, and currying.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [partialsRight] The arguments to append to those provided\n *  to the new function.\n * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n  var isAry = bitmask & WRAP_ARY_FLAG,\n      isBind = bitmask & WRAP_BIND_FLAG,\n      isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n      isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n      isFlip = bitmask & WRAP_FLIP_FLAG,\n      Ctor = isBindKey ? undefined : createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length;\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    if (isCurried) {\n      var placeholder = getHolder(wrapper),\n          holdersCount = countHolders(args, placeholder);\n    }\n    if (partials) {\n      args = composeArgs(args, partials, holders, isCurried);\n    }\n    if (partialsRight) {\n      args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n    }\n    length -= holdersCount;\n    if (isCurried && length < arity) {\n      var newHolders = replaceHolders(args, placeholder);\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n        args, newHolders, argPos, ary, arity - length\n      );\n    }\n    var thisBinding = isBind ? thisArg : this,\n        fn = isBindKey ? thisBinding[func] : func;\n\n    length = args.length;\n    if (argPos) {\n      args = reorder(args, argPos);\n    } else if (isFlip && length > 1) {\n      args.reverse();\n    }\n    if (isAry && ary < length) {\n      args.length = ary;\n    }\n    if (this && this !== root && this instanceof wrapper) {\n      fn = Ctor || createCtor(fn);\n    }\n    return fn.apply(thisBinding, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createHybrid;\n","var WeakMap = require('./_WeakMap');\n\n/** Used to store function metadata. */\nvar metaMap = WeakMap && new WeakMap;\n\nmodule.exports = metaMap;\n","var arrayEach = require('./_arrayEach'),\n    baseEach = require('./_baseEach'),\n    castFunction = require('./_castFunction'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nmodule.exports = forEach;\n","/**\n * Traverse a moddle tree, depth first from top to bottom\n * and call the passed visitor fn.\n *\n * @param {ModdleElement} element\n * @param {Function} fn\n */\nmodule.exports = function traverse(element, fn) {\n  fn(element);\n\n  var descriptor = element.$descriptor;\n\n  if (descriptor.isGeneric) {\n    return;\n  }\n\n  var containedProperties = descriptor.properties.filter(p => {\n    return !p.isAttr && !p.isReference && p.type !== 'String';\n  });\n\n  containedProperties.forEach(p => {\n    if (p.name in element) {\n      const propertyValue = element[p.name];\n\n      if (p.isMany) {\n        propertyValue.forEach(child => {\n          traverse(child, fn);\n        });\n      } else {\n        traverse(propertyValue, fn);\n      }\n    }\n  });\n};\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","'use strict';\r\n\r\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\r\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\r\n\r\nvar tasklist = require('./implementation/Tasklist');\r\n\r\nmodule.exports = function(group, element, bpmnFactory, translate) {\r\n  var businessObject = getBusinessObject(element);\r\n\r\n  if (is(element, 'camunda:Process') ||\r\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\r\n\r\n    group.entries = group.entries.concat(tasklist(element, bpmnFactory, {\r\n      getBusinessObject: function(element) {\r\n        var bo = getBusinessObject(element);\r\n\r\n        if (!is(bo, 'bpmn:Participant')) {\r\n          return bo;\r\n        }\r\n\r\n        return bo.get('processRef');\r\n      }\r\n    }, translate));\r\n\r\n  }\r\n};\r\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nvar forEach = require('lodash/forEach');\n\nfunction getLinkEventDefinition(element) {\n\n  var bo = getBusinessObject(element);\n\n  var linkEventDefinition = null;\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function(eventDefinition) {\n      if (is(eventDefinition, 'bpmn:LinkEventDefinition')) {\n        linkEventDefinition = eventDefinition;\n      }\n    });\n  }\n\n  return linkEventDefinition;\n}\n\nmodule.exports = function(group, element, translate) {\n  var linkEvents = [ 'bpmn:IntermediateThrowEvent', 'bpmn:IntermediateCatchEvent' ];\n\n  forEach(linkEvents, function(event) {\n    if (is(element, event)) {\n\n      var linkEventDefinition = getLinkEventDefinition(element);\n\n      if (linkEventDefinition) {\n        var entry = entryFactory.textField({\n          id: 'link-event',\n          label: translate('Link Name'),\n          modelProperty: 'link-name'\n        });\n\n        entry.get = function() {\n          return { 'link-name': linkEventDefinition.get('name') };\n        };\n\n        entry.set = function(element, values) {\n          var newProperties = {\n            name: values['link-name']\n          };\n          return cmdHelper.updateBusinessObject(element, linkEventDefinition, newProperties);\n        };\n\n        group.entries.push(entry);\n      }\n    }\n  });\n};\n\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","'use strict';\n\nvar Validator = require('./Validator');\n\n/**\n * The guy responsible for template loading.\n *\n * Provide the actual templates via the `config.elementTemplates`.\n *\n * That configuration can either be an array of template\n * descriptors or a node style callback to retrieve\n * the templates asynchronously.\n *\n * @param {Array<TemplateDescriptor>|Function} loadTemplates\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n */\nfunction ElementTemplatesLoader(loadTemplates, eventBus, elementTemplates) {\n  this._loadTemplates = loadTemplates;\n  this._eventBus = eventBus;\n  this._elementTemplates = elementTemplates;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n    self.reload();\n  });\n}\n\nmodule.exports = ElementTemplatesLoader;\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates'\n];\n\n\nElementTemplatesLoader.prototype.reload = function() {\n\n  var self = this;\n\n  var loadTemplates = this._loadTemplates;\n\n  // no templates specified\n  if (typeof loadTemplates === 'undefined') {\n    return;\n  }\n\n  // template loader function specified\n  if (typeof loadTemplates === 'function') {\n\n    return loadTemplates(function(err, templates) {\n\n      if (err) {\n        return self.templateErrors([ err ]);\n      }\n\n      self.setTemplates(templates);\n    });\n  }\n\n  // templates array specified\n  if (loadTemplates.length) {\n    return this.setTemplates(loadTemplates);\n  }\n\n};\n\nElementTemplatesLoader.prototype.setTemplates = function(templates) {\n\n  var elementTemplates = this._elementTemplates;\n\n  var validator = new Validator().addAll(templates);\n\n  var errors = validator.getErrors(),\n      validTemplates = validator.getValidTemplates();\n\n  elementTemplates.set(validTemplates);\n\n  if (errors.length) {\n    this.templateErrors(errors);\n  }\n\n  this.templatesChanged();\n};\n\nElementTemplatesLoader.prototype.templatesChanged = function() {\n  this._eventBus.fire('elementTemplates.changed');\n};\n\nElementTemplatesLoader.prototype.templateErrors = function(errors) {\n  this._eventBus.fire('elementTemplates.errors', {\n    errors: errors\n  });\n};","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","'use strict';\n\nvar assign = require('lodash/assign'),\n    find = require('lodash/find');\n\nvar domQuery = require('min-dom').query;\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar selectEntryFactory = require('./SelectEntryFactory'),\n    entryFieldDescription = require('./EntryFieldDescription');\n\n\n/**\n * The combo box is a special implementation of the select entry and adds the option 'custom' to the\n * select box. If 'custom' is selected, an additional text input field is shown which allows to define\n * a custom value.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} options.label\n * @param  {Array<Object>} options.selectOptions list of name/value pairs\n * @param  {string} options.modelProperty\n * @param  {function} options.get\n * @param  {function} options.set\n * @param  {string} [options.customValue] custom select option value (default: 'custom')\n * @param  {string} [options.customName] custom select option name visible in the select box (default: 'custom')\n *\n * @return {Object}\n */\nvar comboBox = function(options) {\n\n  var selectOptions = options.selectOptions,\n      modelProperty = options.modelProperty,\n      customValue = options.customValue || 'custom',\n      customName = options.customName || 'custom ' + modelProperty,\n      description = options.description;\n\n  // check if a value is not a built in value\n  var isCustomValue = function(value) {\n    if (typeof value[modelProperty] === 'undefined') {\n      return false;\n    }\n\n    var isCustom = !find(selectOptions, function(option) {\n      return value[modelProperty] === option.value;\n    });\n\n    return isCustom;\n  };\n\n  var comboOptions = assign({}, options);\n\n  // true if the selected value in the select box is customValue\n  comboOptions.showCustomInput = function(element, node) {\n    var selectBox = domQuery('[data-entry=\"'+ options.id +'\"] select', node.parentNode);\n\n    if (selectBox) {\n      return selectBox.value === customValue;\n    }\n\n    return false;\n  };\n\n  comboOptions.get = function(element, node) {\n    var value = options.get(element, node);\n\n    var modifiedValues = {};\n\n    if (!isCustomValue(value)) {\n      modifiedValues[modelProperty] = value[modelProperty] || '';\n\n      return modifiedValues;\n    }\n\n    modifiedValues[modelProperty] = customValue;\n    modifiedValues['custom-'+modelProperty] = value[modelProperty];\n\n    return modifiedValues;\n  };\n\n  comboOptions.set = function(element, values, node) {\n    var modifiedValues = {};\n\n    // if the custom select option has been selected\n    // take the value from the text input field\n    if (values[modelProperty] === customValue) {\n      modifiedValues[modelProperty] = values['custom-' + modelProperty] || '';\n    }\n    else if (options.emptyParameter && values[modelProperty] === '') {\n      modifiedValues[modelProperty] = undefined;\n    } else {\n      modifiedValues[modelProperty] = values[modelProperty];\n    }\n    return options.set(element, modifiedValues, node);\n  };\n\n  comboOptions.selectOptions.push({ name: customName, value: customValue });\n\n  var comboBoxEntry = assign({}, selectEntryFactory(comboOptions, comboOptions));\n\n  comboBoxEntry.html += '<div class=\"bpp-field-wrapper bpp-combo-input\" ' +\n    'data-show=\"showCustomInput\"' +\n    '>' +\n    '<input id=\"camunda-' + escapeHTML(options.id) + '-input\" type=\"text\" name=\"custom-' +\n      escapeHTML(modelProperty) + '\" ' +\n    ' />' +\n  '</div>';\n\n  // add description below combo box entry field\n  if (description) {\n    comboBoxEntry.html += entryFieldDescription(description);\n  }\n\n  return comboBoxEntry;\n};\n\nmodule.exports = comboBox;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper');\n\nvar externalTaskPriority = require('./implementation/ExternalTaskPriority');\n\nfunction getServiceTaskLikeBusinessObject(element) {\n  var bo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n\n  // if the element is not a serviceTaskLike element, fetch the normal business object\n  // This avoids the loss of the process / participant business object\n  if (!bo) {\n    bo = getBusinessObject(element);\n  }\n\n  return bo;\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var bo = getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(bo, 'camunda:TaskPriorized') || (is(bo, 'bpmn:Participant')) && bo.get('processRef')) {\n    group.entries = group.entries.concat(externalTaskPriority(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n        return bo.get('processRef');\n      }\n    }, translate));\n  }\n};","var Set = require('./_Set'),\n    noop = require('./noop'),\n    setToArray = require('./_setToArray');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nmodule.exports = createSet;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domify = require('min-dom').domify,\n    forEach = require('lodash/forEach');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils'),\n    escapeHTML = utils.escapeHTML;\n\nfunction getSelectBox(node, id) {\n  var currentTab = domClosest(node, 'div.bpp-properties-tab');\n  var query = 'select[name=selectedExtensionElement]' + (id ? '[id=cam-extensionElements-' + id + ']' : '');\n  return domQuery(query, currentTab);\n}\n\nfunction getSelected(node, id) {\n  var selectBox = getSelectBox(node, id);\n  return {\n    value: (selectBox || {}).value,\n    idx: (selectBox || {}).selectedIndex\n  };\n}\n\nfunction generateElementId(prefix) {\n  prefix = prefix + '_';\n  return utils.nextId(prefix);\n}\n\nvar CREATE_EXTENSION_ELEMENT_ACTION = 'create-extension-element',\n    REMOVE_EXTENSION_ELEMENT_ACTION = 'remove-extension-element';\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var id = options.id,\n      prefix = options.prefix || 'elem',\n      label = options.label || id,\n      idGeneration = (options.idGeneration === false) ? options.idGeneration : true,\n      businessObject = options.businessObject || getBusinessObject(element);\n\n  var modelProperty = options.modelProperty || 'id';\n\n  var getElements = options.getExtensionElements;\n\n  var createElement = options.createExtensionElement,\n      canCreate = typeof createElement === 'function';\n\n  var removeElement = options.removeExtensionElement,\n      canRemove = typeof removeElement === 'function';\n\n  var onSelectionChange = options.onSelectionChange;\n\n  var hideElements = options.hideExtensionElements,\n      canBeHidden = typeof hideElements === 'function';\n\n  var setOptionLabelValue = options.setOptionLabelValue;\n\n  var defaultSize = options.size || 5,\n      resizable = options.resizable;\n\n  var reference = options.reference || undefined;\n\n  var selectionChanged = function(element, node, event, scope) {\n    if (typeof onSelectionChange === 'function') {\n      return onSelectionChange(element, node, event, scope);\n    }\n  };\n\n  var createOption = function(value) {\n    return '<option value=\"' + escapeHTML(value) + '\" data-value data-name=\"extensionElementValue\">' + escapeHTML(value) + '</option>';\n  };\n\n  var initSelectionSize = function(selectBox, optionsLength) {\n    if (resizable) {\n      selectBox.size = optionsLength > defaultSize ? optionsLength : defaultSize;\n    }\n  };\n\n  return {\n    id: id,\n    html: '<div class=\"bpp-row bpp-element-list\" ' +\n            (canBeHidden ? 'data-show=\"hideElements\"' : '') + '>' +\n            '<label for=\"cam-extensionElements-' + escapeHTML(id) + '\">' + escapeHTML(label) + '</label>' +\n            '<div class=\"bpp-field-wrapper\">' +\n              '<select id=\"cam-extensionElements-' + escapeHTML(id) + '\"' +\n                      'name=\"selectedExtensionElement\" ' +\n                      'size=\"' + escapeHTML(defaultSize) + '\" ' +\n                      'data-list-entry-container ' +\n                      'data-on-change=\"selectElement\">' +\n              '</select>' +\n              (canCreate ? '<button class=\"add\" ' +\n                                   'id=\"cam-extensionElements-create-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"createElement\">' +\n                             '<span>+</span>' +\n                           '</button>' : '') +\n              (canRemove ? '<button class=\"clear\" ' +\n                                   'id=\"cam-extensionElements-remove-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"removeElement\" ' +\n                                   'data-disable=\"disableRemove\">' +\n                             '<span>-</span>' +\n                           '</button>' : '') +\n            '</div>' +\n          '</div>',\n\n    get: function(element, node) {\n      var elements = getElements(element, node);\n\n      var result = [];\n      forEach(elements, function(elem) {\n        result.push({\n          extensionElementValue: elem.get(modelProperty)\n        });\n      });\n\n      var selectBox = getSelectBox(node.parentNode, id);\n      initSelectionSize(selectBox, result.length);\n\n      return result;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action;\n      delete this.__action;\n\n      businessObject = businessObject || getBusinessObject(element);\n\n      var bo =\n        (reference && businessObject.get(reference))\n          ? businessObject.get(reference)\n          : businessObject;\n\n      var extensionElements = bo.get('extensionElements');\n\n      if (action.id === CREATE_EXTENSION_ELEMENT_ACTION) {\n        var commands = [];\n        if (!extensionElements) {\n          extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n        commands.push(createElement(element, extensionElements, action.value, node));\n        return commands;\n\n      }\n      else if (action.id === REMOVE_EXTENSION_ELEMENT_ACTION) {\n        return removeElement(element, extensionElements, action.value, action.idx, node);\n      }\n\n    },\n\n    createListEntryTemplate: function(value, index, selectBox) {\n      initSelectionSize(selectBox, selectBox.options.length + 1);\n      return createOption(value.extensionElementValue);\n    },\n\n    deselect: function(element, node) {\n      var selectBox = getSelectBox(node, id);\n      selectBox.selectedIndex = -1;\n    },\n\n    getSelected: function(element, node) {\n      return getSelected(node, id);\n    },\n\n    setControlValue: function(element, node, option, property, value, idx) {\n      node.value = value;\n\n      if (!setOptionLabelValue) {\n        node.text = value;\n      } else {\n        setOptionLabelValue(element, node, option, property, value, idx);\n      }\n    },\n\n    createElement: function(element, node) {\n      // create option template\n      var generatedId;\n      if (idGeneration) {\n        generatedId = generateElementId(prefix);\n      }\n\n      var selectBox = getSelectBox(node, id);\n      var template = domify(createOption(generatedId));\n\n      // add new empty option as last child element\n      selectBox.appendChild(template);\n\n      // select last child element\n      selectBox.lastChild.selected = 'selected';\n      selectionChanged(element, node);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: CREATE_EXTENSION_ELEMENT_ACTION,\n        value: generatedId\n      };\n\n      return true;\n    },\n\n    removeElement: function(element, node) {\n      var selection = getSelected(node, id);\n\n      var selectBox = getSelectBox(node, id);\n      selectBox.removeChild(selectBox.options[selection.idx]);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: REMOVE_EXTENSION_ELEMENT_ACTION,\n        value: selection.value,\n        idx: selection.idx\n      };\n\n      return true;\n    },\n\n    hideElements: function(element, entryNode, node, scopeNode) {\n      return !hideElements(element, entryNode, node, scopeNode);\n    },\n\n    disableRemove: function(element, entryNode, node, scopeNode) {\n      return (getSelected(entryNode, id) || {}).idx < 0;\n    },\n\n    selectElement: selectionChanged\n  };\n\n};\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar extensionElementsEntry = require('./ExtensionElements'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    ImplementationTypeHelper = require('../../../../helper/ImplementationTypeHelper');\n\n\nfunction getListeners(bo, type) {\n  return bo && extensionElementsHelper.getExtensionElements(bo, type) || [];\n}\n\nvar CAMUNDA_EXECUTION_LISTENER_ELEMENT = 'camunda:ExecutionListener';\nvar CAMUNDA_TASK_LISTENER_ELEMENT = 'camunda:TaskListener';\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var LISTENER_TYPE_LABEL = {\n    class: translate('Java Class'),\n    expression: translate('Expression'),\n    delegateExpression: translate('Delegate Expression'),\n    script: translate('Script')\n  };\n\n  var bo;\n\n  var result = {\n    getSelectedListener: getSelectedListener\n  };\n\n  var entries = result.entries = [];\n\n  var isSequenceFlow = ImplementationTypeHelper.isSequenceFlow(element);\n\n  function getSelectedListener(element, node) {\n    var selection = (executionListenerEntry && executionListenerEntry.getSelected(element, node)) || { idx: -1 };\n\n    var listener = getListeners(bo, CAMUNDA_EXECUTION_LISTENER_ELEMENT)[selection.idx];\n    if (!listener && taskListenerEntry) {\n      selection = taskListenerEntry.getSelected(element, node);\n      listener = getListeners(bo, CAMUNDA_TASK_LISTENER_ELEMENT)[selection.idx];\n    }\n    return listener;\n  }\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx) {\n      var listeners = getListeners(bo, type);\n      var listener = listeners[idx];\n      var listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      var event = (listener.get('event')) ? listener.get('event') : '<empty>';\n\n      var label = (event || '*') + ' : ' + (LISTENER_TYPE_LABEL[listenerType] || '');\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(element, type, initialEvent) {\n    return function(element, extensionElements, value) {\n      var props = {\n        event: initialEvent,\n        class: ''\n      };\n\n      var newElem = elementHelper.createElement(type, props, extensionElements, bpmnFactory);\n\n      return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newElem ]);\n    };\n  };\n\n  var removeElement = function(element, type) {\n    return function(element, extensionElements, value, idx) {\n      var listeners = getListeners(bo, type);\n      var listener = listeners[idx];\n      if (listener) {\n        return extensionElementsHelper.removeEntry(bo, element, listener);\n      }\n    };\n  };\n\n\n  // Execution Listener\n\n  if (is(element, 'bpmn:FlowElement') || is(element, 'bpmn:Process') || is(element, 'bpmn:Participant')) {\n    bo = getBusinessObject(element);\n    if (is(element, 'bpmn:Participant')) {\n      element = element.processRef;\n      bo = bo.get('processRef');\n    }\n\n    if (bo) {\n\n      var executionListenerEntry = extensionElementsEntry(element, bpmnFactory, {\n        id : 'executionListeners',\n        label : translate('Execution Listener'),\n        modelProperty: 'name',\n        idGeneration: 'false',\n        reference: 'processRef',\n\n        createExtensionElement: newElement(element, CAMUNDA_EXECUTION_LISTENER_ELEMENT, (isSequenceFlow) ? 'take' : 'start'),\n        removeExtensionElement: removeElement(element, CAMUNDA_EXECUTION_LISTENER_ELEMENT),\n\n        getExtensionElements: function(element) {\n          return getListeners(bo, CAMUNDA_EXECUTION_LISTENER_ELEMENT);\n        },\n\n        onSelectionChange: function(element, node, event, scope) {\n          taskListenerEntry && taskListenerEntry.deselect(element, node);\n        },\n\n        setOptionLabelValue: setOptionLabelValue(CAMUNDA_EXECUTION_LISTENER_ELEMENT)\n\n      });\n      entries.push(executionListenerEntry);\n\n    }\n  }\n\n\n  // Task Listener\n\n  if (is(element, 'bpmn:UserTask')) {\n    bo = getBusinessObject(element);\n\n    var taskListenerEntry = extensionElementsEntry(element, bpmnFactory, {\n      id : 'taskListeners',\n      label : translate('Task Listener'),\n      modelProperty: 'name',\n      idGeneration: 'false',\n\n      createExtensionElement: newElement(element, CAMUNDA_TASK_LISTENER_ELEMENT, 'create'),\n      removeExtensionElement: removeElement(element, CAMUNDA_TASK_LISTENER_ELEMENT),\n\n      getExtensionElements: function(element) {\n        return getListeners(bo, CAMUNDA_TASK_LISTENER_ELEMENT);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        executionListenerEntry.deselect(element, node);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(CAMUNDA_TASK_LISTENER_ELEMENT)\n\n    });\n    entries.push(taskListenerEntry);\n  }\n\n  return result;\n\n};\n","'use strict';\n\nvar ChangeElementTemplateHandler = require('./ChangeElementTemplateHandler');\n\nvar getTemplate = require('../Helper').getTemplate,\n    getDefaultTemplate = require('../Helper').getDefaultTemplate;\n\nfunction registerHandlers(commandStack, elementTemplates, eventBus, elementRegistry) {\n  commandStack.registerHandler(\n    'propertiesPanel.camunda.changeTemplate',\n    ChangeElementTemplateHandler\n  );\n\n  // apply default element templates on shape creation\n  eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(context) {\n    applyDefaultTemplate(context.context.shape, elementTemplates, commandStack);\n  });\n\n  // apply default element templates on connection creation\n  eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(context) {\n    applyDefaultTemplate(context.context.connection, elementTemplates, commandStack);\n  });\n}\n\nregisterHandlers.$inject = [ 'commandStack', 'elementTemplates', 'eventBus', 'elementRegistry' ];\n\n\nmodule.exports = {\n  __init__: [ registerHandlers ]\n};\n\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!getTemplate(element, elementTemplates)\n      && getDefaultTemplate(element, elementTemplates)) {\n\n    var command = 'propertiesPanel.camunda.changeTemplate';\n    var commandContext = {\n      element: element,\n      newTemplate: getDefaultTemplate(element, elementTemplates)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","/**\n * Checks whether node is of specific bpmn type.\n *\n * @param {ModdleElement} node\n * @param {String} type\n *\n * @return {Boolean}\n */\nfunction is(node, type) {\n\n  if (type.indexOf(':') === -1) {\n    type = 'bpmn:' + type;\n  }\n\n  return (\n    (typeof node.$instanceOf === 'function')\n      ? node.$instanceOf(type)\n      : node.$type === type\n  );\n}\n\n/**\n * Checks whether node has any of the specified types.\n *\n * @param {ModdleElement} node\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nfunction isAny(node, types) {\n  return types.some(function(type) {\n    return is(node, type);\n  });\n}\n\nexport { is, isAny };\n//# sourceMappingURL=index.esm.js.map\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","'use strict';\n\nvar inputOutput = require('./implementation/InputOutput');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inputOutputEntry = inputOutput(element, bpmnFactory, {}, translate);\n\n  group.entries = group.entries.concat(inputOutputEntry.entries);\n\n  return {\n    getSelectedParameter: inputOutputEntry.getSelectedParameter\n  };\n\n};\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","'use strict';\n\n/**\n * Calculate the selection update for the given\n * current and new input values.\n *\n * @param {Object} currentSelection as {start, end}\n * @param {String} currentValue\n * @param {String} newValue\n *\n * @return {Object} newSelection as {start, end}\n */\nfunction calculateUpdate(currentSelection, currentValue, newValue) {\n\n  var currentCursor = currentSelection.start,\n      newCursor = currentCursor,\n      diff = newValue.length - currentValue.length,\n      idx;\n\n  var lengthDelta = newValue.length - currentValue.length;\n\n  var currentTail = currentValue.substring(currentCursor);\n\n  // check if we can remove common ending from the equation\n  // to be able to properly detect a selection change for\n  // the following scenarios:\n  //\n  //  * (AAATTT|TF) => (AAAT|TF)\n  //  * (AAAT|TF) =>  (AAATTT|TF)\n  //\n  if (newValue.lastIndexOf(currentTail) === newValue.length - currentTail.length) {\n    currentValue = currentValue.substring(0, currentValue.length - currentTail.length);\n    newValue = newValue.substring(0, newValue.length - currentTail.length);\n  }\n\n  // diff\n  var diff = createDiff(currentValue, newValue);\n\n  if (diff) {\n    if (diff.type === 'remove') {\n      newCursor = diff.newStart;\n    } else {\n      newCursor = diff.newEnd;\n    }\n  }\n\n  return range(newCursor);\n}\n\nmodule.exports = calculateUpdate;\n\n\nfunction createDiff(currentValue, newValue) {\n\n  var insert;\n\n  var l_str, l_char, l_idx = 0,\n      s_str, s_char, s_idx = 0;\n\n  if (newValue.length > currentValue.length) {\n    l_str = newValue;\n    s_str = currentValue;\n  } else {\n    l_str = currentValue;\n    s_str = newValue;\n  }\n\n  // assume there will be only one insert / remove and\n  // detect that _first_ edit operation only\n  while (l_idx < l_str.length) {\n\n    l_char = l_str.charAt(l_idx);\n    s_char = s_str.charAt(s_idx);\n\n    // chars no not equal\n    if (l_char !== s_char) {\n\n      if (!insert) {\n        insert = {\n          l_start: l_idx,\n          s_start: s_idx\n        };\n      }\n\n      l_idx++;\n    }\n\n    // chars equal (again?)\n    else {\n\n      if (insert && !insert.complete) {\n        insert.l_end = l_idx;\n        insert.s_end = s_idx;\n        insert.complete = true;\n      }\n\n      s_idx++;\n      l_idx++;\n    }\n  }\n\n  if (insert && !insert.complete) {\n    insert.complete = true;\n    insert.s_end = s_str.length;\n    insert.l_end = l_str.length;\n  }\n\n  // no diff\n  if (!insert) {\n    return;\n  }\n\n  if (newValue.length > currentValue.length) {\n    return {\n      newStart: insert.l_start,\n      newEnd: insert.l_end,\n      type: 'add'\n    };\n  } else {\n    return {\n      newStart: insert.s_start,\n      newEnd: insert.s_end,\n      type: newValue.length < currentValue.length ? 'remove' : 'replace'\n    };\n  }\n}\n\n/**\n * Utility method for creating a new selection range {start, end} object.\n *\n * @param {Number} start\n * @param {Number} [end]\n *\n * @return {Object} selection range as {start, end}\n */\nfunction range(start, end) {\n  return {\n    start: start,\n    end: end === undefined ? start : end\n  };\n}\n\nmodule.exports.range = range;\n\n\nfunction splitStr(str, position) {\n  return {\n    before: str.substring(0, position),\n    after: str.substring(position)\n  };\n}","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","module.exports = {\n  __depends__: [\n    require('./cmd'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [ 'propertiesPanel' ],\n  propertiesPanel: [ 'type', require('./PropertiesPanel') ]\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar PropertiesActivator = require('../../PropertiesActivator');\n\nvar asyncCapableHelper = require('../../helper/AsyncCapableHelper'),\n    ImplementationTypeHelper = require('../../helper/ImplementationTypeHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\n// bpmn properties\nvar processProps = require('../bpmn/parts/ProcessProps'),\n    eventProps = require('../bpmn/parts/EventProps'),\n    linkProps = require('../bpmn/parts/LinkProps'),\n    documentationProps = require('../bpmn/parts/DocumentationProps'),\n    idProps = require('../bpmn/parts/IdProps'),\n    nameProps = require('../bpmn/parts/NameProps'),\n    executableProps = require('../bpmn/parts/ExecutableProps');\n\n// camunda properties\nvar serviceTaskDelegateProps = require('./parts/ServiceTaskDelegateProps'),\n    userTaskProps = require('./parts/UserTaskProps'),\n    asynchronousContinuationProps = require('./parts/AsynchronousContinuationProps'),\n    callActivityProps = require('./parts/CallActivityProps'),\n    multiInstanceProps = require('./parts/MultiInstanceLoopProps'),\n    conditionalProps = require('./parts/ConditionalProps'),\n    scriptProps = require('./parts/ScriptTaskProps'),\n    errorProps = require('./parts/ErrorEventProps'),\n    formProps = require('./parts/FormProps'),\n    startEventInitiator = require('./parts/StartEventInitiator'),\n    variableMapping = require('./parts/VariableMappingProps'),\n    versionTag = require('./parts/VersionTagProps');\n\nvar listenerProps = require('./parts/ListenerProps'),\n    listenerDetails = require('./parts/ListenerDetailProps'),\n    listenerFields = require('./parts/ListenerFieldInjectionProps');\n\nvar elementTemplateChooserProps = require('./element-templates/parts/ChooserProps'),\n    elementTemplateCustomProps = require('./element-templates/parts/CustomProps');\n\n// Input/Output\nvar inputOutput = require('./parts/InputOutputProps'),\n    inputOutputParameter = require('./parts/InputOutputParameterProps');\n\n// Connector\nvar connectorDetails = require('./parts/ConnectorDetailProps'),\n    connectorInputOutput = require('./parts/ConnectorInputOutputProps'),\n    connectorInputOutputParameter = require('./parts/ConnectorInputOutputParameterProps');\n\n// properties\nvar properties = require('./parts/PropertiesProps');\n\n// job configuration\nvar jobConfiguration = require('./parts/JobConfigurationProps');\n\n// history time to live\nvar historyTimeToLive = require('./parts/HistoryTimeToLiveProps');\n\n// candidate starter groups/users\nvar candidateStarter = require('./parts/CandidateStarterProps');\n\n// tasklist\nvar tasklist = require('./parts/TasklistProps');\n\n// external task configuration\nvar externalTaskConfiguration = require('./parts/ExternalTaskConfigurationProps');\n\n// field injection\nvar fieldInjections = require('./parts/FieldInjectionProps');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    eventDefinitionHelper = require('../../helper/EventDefinitionHelper'),\n    implementationTypeHelper = require('../../helper/ImplementationTypeHelper');\n\n// helpers ////////////////////////////////////////\n\nvar isExternalTaskPriorityEnabled = function(element) {\n  var businessObject = getBusinessObject(element);\n\n  // show only if element is a process, a participant ...\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n    return true;\n  }\n\n  var externalBo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element),\n      isExternalTask = ImplementationTypeHelper.getImplementationType(externalBo) === 'external';\n\n  // ... or an external task with selected external implementation type\n  return !!ImplementationTypeHelper.isExternalCapable(externalBo) && isExternalTask;\n};\n\nvar isJobConfigEnabled = function(element) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n    return true;\n  }\n\n  // async behavior\n  var bo = getBusinessObject(element);\n  if (asyncCapableHelper.isAsyncBefore(bo) || asyncCapableHelper.isAsyncAfter(bo)) {\n    return true;\n  }\n\n  // timer definition\n  if (is(element, 'bpmn:Event')) {\n    return !!eventDefinitionHelper.getTimerEventDefinition(element);\n  }\n\n  return false;\n};\n\nvar getInputOutputParameterLabel = function(param, translate) {\n\n  if (is(param, 'camunda:InputParameter')) {\n    return translate('Input Parameter');\n  }\n\n  if (is(param, 'camunda:OutputParameter')) {\n    return translate('Output Parameter');\n  }\n\n  return '';\n};\n\nvar getListenerLabel = function(param, translate) {\n\n  if (is(param, 'camunda:ExecutionListener')) {\n    return translate('Execution Listener');\n  }\n\n  if (is(param, 'camunda:TaskListener')) {\n    return translate('Task Listener');\n  }\n\n  return '';\n};\n\nvar PROCESS_KEY_HINT = 'This maps to the process definition key.';\nvar TASK_KEY_HINT = 'This maps to the task definition key.';\n\nfunction createGeneralTabGroups(\n    element, canvas, bpmnFactory,\n    elementRegistry, elementTemplates, translate) {\n\n  // refer to target element for external labels\n  element = element.labelTarget || element;\n\n  var generalGroup = {\n    id: 'general',\n    label: translate('General'),\n    entries: []\n  };\n\n  var idOptions;\n  var processOptions;\n\n  if (is(element, 'bpmn:Process')) {\n    idOptions = { description: PROCESS_KEY_HINT };\n  }\n\n  if (is(element, 'bpmn:UserTask')) {\n    idOptions = { description: TASK_KEY_HINT };\n  }\n\n  if (is(element, 'bpmn:Participant')) {\n    processOptions = { processIdDescription: PROCESS_KEY_HINT };\n  }\n\n  idProps(generalGroup, element, translate, idOptions);\n  nameProps(generalGroup, element, bpmnFactory, canvas, translate);\n  processProps(generalGroup, element, translate, processOptions);\n  versionTag(generalGroup, element, translate);\n  executableProps(generalGroup, element, translate);\n  elementTemplateChooserProps(generalGroup, element, elementTemplates, translate);\n\n  var customFieldsGroups = elementTemplateCustomProps(element, elementTemplates, bpmnFactory, translate);\n\n  var detailsGroup = {\n    id: 'details',\n    label: translate('Details'),\n    entries: []\n  };\n  serviceTaskDelegateProps(detailsGroup, element, bpmnFactory, translate);\n  userTaskProps(detailsGroup, element, translate);\n  scriptProps(detailsGroup, element, bpmnFactory, translate);\n  linkProps(detailsGroup, element, translate);\n  callActivityProps(detailsGroup, element, bpmnFactory, translate);\n  eventProps(detailsGroup, element, bpmnFactory, elementRegistry, translate);\n  errorProps(detailsGroup, element, bpmnFactory, translate);\n  conditionalProps(detailsGroup, element, bpmnFactory, translate);\n  startEventInitiator(detailsGroup, element, translate); // this must be the last element of the details group!\n\n  var multiInstanceGroup = {\n    id: 'multiInstance',\n    label: translate('Multi Instance'),\n    entries: []\n  };\n  multiInstanceProps(multiInstanceGroup, element, bpmnFactory, translate);\n\n  var asyncGroup = {\n    id : 'async',\n    label: translate('Asynchronous Continuations'),\n    entries : []\n  };\n  asynchronousContinuationProps(asyncGroup, element, bpmnFactory, translate);\n\n  var jobConfigurationGroup = {\n    id : 'jobConfiguration',\n    label : translate('Job Configuration'),\n    entries : [],\n    enabled: isJobConfigEnabled\n  };\n  jobConfiguration(jobConfigurationGroup, element, bpmnFactory, translate);\n\n  var externalTaskGroup = {\n    id : 'externalTaskConfiguration',\n    label : translate('External Task Configuration'),\n    entries : [],\n    enabled: isExternalTaskPriorityEnabled\n  };\n  externalTaskConfiguration(externalTaskGroup, element, bpmnFactory, translate);\n\n\n  var candidateStarterGroup = {\n    id: 'candidateStarterConfiguration',\n    label: translate('Candidate Starter Configuration'),\n    entries: []\n  };\n  candidateStarter(candidateStarterGroup, element, bpmnFactory, translate);\n\n  var historyTimeToLiveGroup = {\n    id: 'historyConfiguration',\n    label: translate('History Configuration'),\n    entries: []\n  };\n  historyTimeToLive(historyTimeToLiveGroup, element, bpmnFactory, translate);\n\n  var tasklistGroup = {\n    id: 'tasklist',\n    label: translate('Tasklist Configuration'),\n    entries: []\n  };\n  tasklist(tasklistGroup, element, bpmnFactory, translate);\n\n  var documentationGroup = {\n    id: 'documentation',\n    label: translate('Documentation'),\n    entries: []\n  };\n  documentationProps(documentationGroup, element, bpmnFactory, translate);\n\n  var groups = [];\n  groups.push(generalGroup);\n  customFieldsGroups.forEach(function(group) {\n    groups.push(group);\n  });\n  groups.push(detailsGroup);\n  groups.push(externalTaskGroup);\n  groups.push(multiInstanceGroup);\n  groups.push(asyncGroup);\n  groups.push(jobConfigurationGroup);\n  groups.push(candidateStarterGroup);\n  groups.push(historyTimeToLiveGroup);\n  groups.push(tasklistGroup);\n  groups.push(documentationGroup);\n\n  return groups;\n}\n\nfunction createVariablesTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var variablesGroup = {\n    id : 'variables',\n    label : translate('Variables'),\n    entries: []\n  };\n  variableMapping(variablesGroup, element, bpmnFactory, translate);\n\n  return [\n    variablesGroup\n  ];\n}\n\nfunction createFormsTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var formGroup = {\n    id : 'forms',\n    label : translate('Forms'),\n    entries: []\n  };\n  formProps(formGroup, element, bpmnFactory, translate);\n\n  return [\n    formGroup\n  ];\n}\n\nfunction createListenersTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var listenersGroup = {\n    id : 'listeners',\n    label: translate('Listeners'),\n    entries: []\n  };\n\n  var options = listenerProps(listenersGroup, element, bpmnFactory, translate);\n\n  var listenerDetailsGroup = {\n    id: 'listener-details',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedListener(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedListener(element, node);\n      return getListenerLabel(param, translate);\n    }\n  };\n\n  listenerDetails(listenerDetailsGroup, element, bpmnFactory, options, translate);\n\n  var listenerFieldsGroup = {\n    id: 'listener-fields',\n    label: translate('Field Injection'),\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedListener(element, node);\n    }\n  };\n\n  listenerFields(listenerFieldsGroup, element, bpmnFactory, options, translate);\n\n  return [\n    listenersGroup,\n    listenerDetailsGroup,\n    listenerFieldsGroup\n  ];\n}\n\nfunction createInputOutputTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var inputOutputGroup = {\n    id: 'input-output',\n    label: translate('Parameters'),\n    entries: []\n  };\n\n  var options = inputOutput(inputOutputGroup, element, bpmnFactory, translate);\n\n  var inputOutputParameterGroup = {\n    id: 'input-output-parameter',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedParameter(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedParameter(element, node);\n      return getInputOutputParameterLabel(param, translate);\n    }\n  };\n\n  inputOutputParameter(inputOutputParameterGroup, element, bpmnFactory, options, translate);\n\n  return [\n    inputOutputGroup,\n    inputOutputParameterGroup\n  ];\n}\n\nfunction createConnectorTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var connectorDetailsGroup = {\n    id: 'connector-details',\n    label: translate('Details'),\n    entries: []\n  };\n\n  connectorDetails(connectorDetailsGroup, element, bpmnFactory, translate);\n\n  var connectorInputOutputGroup = {\n    id: 'connector-input-output',\n    label: translate('Input/Output'),\n    entries: []\n  };\n\n  var options = connectorInputOutput(connectorInputOutputGroup, element, bpmnFactory, translate);\n\n  var connectorInputOutputParameterGroup = {\n    id: 'connector-input-output-parameter',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedParameter(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedParameter(element, node);\n      return getInputOutputParameterLabel(param, translate);\n    }\n  };\n\n  connectorInputOutputParameter(connectorInputOutputParameterGroup, element, bpmnFactory, options, translate);\n\n  return [\n    connectorDetailsGroup,\n    connectorInputOutputGroup,\n    connectorInputOutputParameterGroup\n  ];\n}\n\nfunction createFieldInjectionsTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var fieldGroup = {\n    id: 'field-injections-properties',\n    label: translate('Field Injections'),\n    entries: []\n  };\n\n  fieldInjections(fieldGroup, element, bpmnFactory, translate);\n\n  return [\n    fieldGroup\n  ];\n}\n\nfunction createExtensionElementsGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var propertiesGroup = {\n    id : 'extensionElements-properties',\n    label: translate('Properties'),\n    entries: []\n  };\n  properties(propertiesGroup, element, bpmnFactory, translate);\n\n  return [\n    propertiesGroup\n  ];\n}\n\n// Camunda Properties Provider /////////////////////////////////////\n\n\n/**\n * A properties provider for Camunda related properties.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {BpmnFactory} bpmnFactory\n * @param {ElementRegistry} elementRegistry\n * @param {ElementTemplates} elementTemplates\n * @param {Translate} translate\n */\nfunction CamundaPropertiesProvider(\n    eventBus, canvas, bpmnFactory,\n    elementRegistry, elementTemplates, translate) {\n\n  PropertiesActivator.call(this, eventBus);\n\n  this.getTabs = function(element) {\n\n    var generalTab = {\n      id: 'general',\n      label: translate('General'),\n      groups: createGeneralTabGroups(\n        element, canvas, bpmnFactory,\n        elementRegistry, elementTemplates, translate)\n    };\n\n    var variablesTab = {\n      id: 'variables',\n      label: translate('Variables'),\n      groups: createVariablesTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var formsTab = {\n      id: 'forms',\n      label: translate('Forms'),\n      groups: createFormsTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var listenersTab = {\n      id: 'listeners',\n      label: translate('Listeners'),\n      groups: createListenersTabGroups(element, bpmnFactory, elementRegistry, translate),\n      enabled: function(element) {\n        return !eventDefinitionHelper.getLinkEventDefinition(element)\n          || (!is(element, 'bpmn:IntermediateThrowEvent')\n          && eventDefinitionHelper.getLinkEventDefinition(element));\n      }\n    };\n\n    var inputOutputTab = {\n      id: 'input-output',\n      label: translate('Input/Output'),\n      groups: createInputOutputTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var connectorTab = {\n      id: 'connector',\n      label: translate('Connector'),\n      groups: createConnectorTabGroups(element, bpmnFactory, elementRegistry, translate),\n      enabled: function(element) {\n        var bo = implementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n        return bo && implementationTypeHelper.getImplementationType(bo) === 'connector';\n      }\n    };\n\n    var fieldInjectionsTab = {\n      id: 'field-injections',\n      label: translate('Field Injections'),\n      groups: createFieldInjectionsTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var extensionsTab = {\n      id: 'extensionElements',\n      label: translate('Extensions'),\n      groups: createExtensionElementsGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    return [\n      generalTab,\n      variablesTab,\n      connectorTab,\n      formsTab,\n      listenersTab,\n      inputOutputTab,\n      fieldInjectionsTab,\n      extensionsTab\n    ];\n  };\n\n}\n\nCamundaPropertiesProvider.$inject = [\n  'eventBus',\n  'canvas',\n  'bpmnFactory',\n  'elementRegistry',\n  'elementTemplates',\n  'translate'\n];\n\ninherits(CamundaPropertiesProvider, PropertiesActivator);\n\nmodule.exports = CamundaPropertiesProvider;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar HANDLERS = {\n  'properties-panel.update-businessobject': require('./UpdateBusinessObjectHandler'),\n  'properties-panel.create-and-reference': require('./CreateAndReferenceHandler'),\n  'properties-panel.create-businessobject-list': require('./CreateBusinessObjectListHandler'),\n  'properties-panel.update-businessobject-list': require('./UpdateBusinessObjectListHandler'),\n  'properties-panel.multi-command-executor': require('./MultiCommandHandler')\n};\n\n\nfunction CommandInitializer(eventBus, commandStack) {\n\n  eventBus.on('diagram.init', function() {\n    forEach(HANDLERS, function(handler, id) {\n      commandStack.registerHandler(id, handler);\n    });\n  });\n}\n\nCommandInitializer.$inject = [ 'eventBus', 'commandStack' ];\n\nmodule.exports = {\n  __init__: [ CommandInitializer ]\n};","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\n/**\n * Create a linkified and HTML escaped entry field description.\n *\n * As a special feature, this description may contain both markdown,\n * plain <a href> links and <br />\n *\n * @param {String} description\n */\nmodule.exports = function entryFieldDescription(description) {\n\n  // we tokenize the description to extract text, HTML and markdown links\n  // text, links and new lines are handled seperately\n\n  var escaped = [];\n\n  // match markdown [{TEXT}]({URL}) and HTML links <a href=\"{URL}\">{TEXT}</a>\n  var pattern = /(?:\\[([^\\]]+)\\]\\((https?:\\/\\/[^)]+)\\))|(?:<a href=\"(https?:\\/\\/[^\"]+)\">(.+?(?=<\\/))<\\/a>)/gi;\n\n  var index = 0;\n  var match;\n  var link, text;\n\n  while ((match = pattern.exec(description))) {\n\n    // escape + insert text before match\n    if (match.index > index) {\n      escaped.push(escapeText(description.substring(index, match.index)));\n    }\n\n    link = match[2] && encodeURI(match[2]) || match[3];\n    text = match[1] || match[4];\n\n    // insert safe link\n    escaped.push('<a href=\"' + link + '\" target=\"_blank\">' + escapeText(text) + '</a>');\n\n    index = match.index + match[0].length;\n  }\n\n  // escape and insert text after last match\n  if (index < description.length) {\n    escaped.push(escapeText(description.substring(index)));\n  }\n\n  return '<div class=\"bpp-field-description\">' + escaped.join('') + '</div>';\n};\n\nfunction escapeText(text) {\n  var match, index = 0, escaped = [];\n\n  // match new line <br/> <br /> <br.... /> etc.\n  var pattern = /<br\\s*\\/?>/gi;\n\n  while ((match = pattern.exec(text))) {\n\n    if (match.index > index) {\n      escaped.push(escapeHTML(text.substring(index, match.index)));\n    }\n\n    escaped.push('<br />');\n\n    index = match.index + match[0].length;\n  }\n\n  if (index < text.length) {\n    escaped.push(escapeHTML(text.substring(index)));\n  }\n\n  return escaped.join('');\n}\n","'use strict';\nvar toPrimitive = require('../internals/to-primitive');\nvar definePropertyModule = require('../internals/object-define-property');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\n\nmodule.exports = function (object, key, value) {\n  var propertyKey = toPrimitive(key);\n  if (propertyKey in object) definePropertyModule.f(object, propertyKey, createPropertyDescriptor(0, value));\n  else object[propertyKey] = value;\n};\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    escapeHTML = require('../../../../Utils').escapeHTML;\n\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar domClasses = require('min-dom').classes;\n\n/**\n * Get a property value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n * @param {string} propertyName\n *\n * @return {any} the property value\n */\nfunction getProperty(element, propertyName) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n  return loopCharacteristics && loopCharacteristics.get(propertyName);\n}\n\n/**\n * Get the body of a given expression.\n *\n * @param {ModdleElement<bpmn:FormalExpression>} expression\n *\n * @return {string} the body (value) of the expression\n */\nfunction getBody(expression) {\n  return expression && expression.get('body');\n}\n\n\n/**\n * Get the loop characteristics of an element.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:MultiInstanceLoopCharacteristics>} the loop characteristics\n */\nfunction getLoopCharacteristics(element) {\n  var bo = getBusinessObject(element);\n  return bo.loopCharacteristics;\n}\n\n/**\n * Get the loop cardinality of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:FormalExpression>} an expression representing the loop cardinality\n */\nfunction getLoopCardinality(element) {\n  return getProperty(element, 'loopCardinality');\n}\n\n/**\n * Get the loop cardinality value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the loop cardinality value\n */\nfunction getLoopCardinalityValue(element) {\n  var loopCardinality = getLoopCardinality(element);\n  return getBody(loopCardinality);\n}\n\n/**\n * Get the completion condition of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:FormalExpression>} an expression representing the completion condition\n */\nfunction getCompletionCondition(element) {\n  return getProperty(element, 'completionCondition');\n}\n\n/**\n * Get the completion condition value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the completion condition value\n */\nfunction getCompletionConditionValue(element) {\n  var completionCondition = getCompletionCondition(element);\n  return getBody(completionCondition);\n}\n\n/**\n * Get the 'camunda:collection' attribute value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the 'camunda:collection' value\n */\nfunction getCollection(element) {\n  return getProperty(element, 'camunda:collection');\n}\n\n/**\n * Get the 'camunda:elementVariable' attribute value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the 'camunda:elementVariable' value\n */\nfunction getElementVariable(element) {\n  return getProperty(element, 'camunda:elementVariable');\n}\n\n\n/**\n * Creates 'bpmn:FormalExpression' element.\n *\n * @param {ModdleElement} parent\n * @param {string} body\n * @param {BpmnFactory} bpmnFactory\n *\n * @result {ModdleElement<bpmn:FormalExpression>} a formal expression\n */\nfunction createFormalExpression(parent, body, bpmnFactory) {\n  return elementHelper.createElement('bpmn:FormalExpression', { body: body }, parent, bpmnFactory);\n}\n\n/**\n * Updates a specific formal expression of the loop characteristics.\n *\n * @param {djs.model.Base} element\n * @param {string} propertyName\n * @param {string} newValue\n * @param {BpmnFactory} bpmnFactory\n */\nfunction updateFormalExpression(element, propertyName, newValue, bpmnFactory) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n\n  var expressionProps = {};\n\n  if (!newValue) {\n    // remove formal expression\n    expressionProps[propertyName] = undefined;\n    return cmdHelper.updateBusinessObject(element, loopCharacteristics, expressionProps);\n  }\n\n  var existingExpression = loopCharacteristics.get(propertyName);\n\n  if (!existingExpression) {\n    // add formal expression\n    expressionProps[propertyName] = createFormalExpression(loopCharacteristics, newValue, bpmnFactory);\n    return cmdHelper.updateBusinessObject(element, loopCharacteristics, expressionProps);\n  }\n\n  // edit existing formal expression\n  return cmdHelper.updateBusinessObject(element, existingExpression, {\n    body: newValue\n  });\n}\n\n\nmodule.exports = function(element, bpmnFactory, translate) {\n\n  var entries = [];\n\n  // error message /////////////////////////////////////////////////////////////////\n\n  entries.push({\n    id: 'multiInstance-errorMessage',\n    html: '<div data-show=\"isValid\">' +\n             '<span class=\"bpp-icon-warning\"></span> ' +\n             escapeHTML(translate('Must provide either loop cardinality or collection')) +\n          '</div>',\n\n    isValid: function(element, node, notification, scope) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n\n      var isValid = true;\n      if (loopCharacteristics) {\n        var loopCardinality = getLoopCardinalityValue(element);\n        var collection = getCollection(element);\n\n        isValid = !loopCardinality && !collection;\n      }\n\n      domClasses(node).toggle('bpp-hidden', !isValid);\n      domClasses(notification).toggle('bpp-error-message', isValid);\n\n      return isValid;\n    }\n  });\n\n  // loop cardinality //////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-loopCardinality',\n    label: translate('Loop Cardinality'),\n    modelProperty: 'loopCardinality',\n\n    get: function(element, node) {\n      return {\n        loopCardinality: getLoopCardinalityValue(element)\n      };\n    },\n\n    set: function(element, values) {\n      return updateFormalExpression(element, 'loopCardinality', values.loopCardinality, bpmnFactory);\n    }\n  }));\n\n\n  // collection //////////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-collection',\n    label: translate('Collection'),\n    modelProperty: 'collection',\n\n    get: function(element, node) {\n      return {\n        collection: getCollection(element)\n      };\n    },\n\n    set: function(element, values) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n      return cmdHelper.updateBusinessObject(element, loopCharacteristics, {\n        'camunda:collection': values.collection || undefined\n      });\n    },\n\n    validate: function(element, values, node) {\n      var collection = getCollection(element);\n      var elementVariable = getElementVariable(element);\n\n      if (!collection && elementVariable) {\n        return { collection : 'Must provide a value' };\n      }\n    }\n  }));\n\n\n  // element variable ////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-elementVariable',\n    label: translate('Element Variable'),\n    modelProperty: 'elementVariable',\n\n    get: function(element, node) {\n      return {\n        elementVariable: getElementVariable(element)\n      };\n    },\n\n    set: function(element, values) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n      return cmdHelper.updateBusinessObject(element, loopCharacteristics, {\n        'camunda:elementVariable': values.elementVariable || undefined\n      });\n    }\n  }));\n\n\n  // Completion Condition //////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-completionCondition',\n    label: translate('Completion Condition'),\n    modelProperty: 'completionCondition',\n\n    get: function(element) {\n      return {\n        completionCondition: getCompletionConditionValue(element)\n      };\n    },\n\n    set: function(element, values) {\n      return updateFormalExpression(element, 'completionCondition', values.completionCondition, bpmnFactory);\n    }\n  }));\n\n  return entries;\n\n};\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the optional `this`\n * binding of `thisArg`.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createBind(func, bitmask, thisArg) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return fn.apply(isBind ? thisArg : this, arguments);\n  }\n  return wrapper;\n}\n\nmodule.exports = createBind;\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, errorEventDefinition, translate) {\n\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, errorEventDefinition, bpmnFactory, {\n    label: translate('Error'),\n    elementName: 'error',\n    elementType: 'bpmn:Error',\n    referenceProperty: 'errorRef',\n    newElementIdPrefix: 'Error_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n    id: 'error-element-name',\n    label: translate('Error Name'),\n    referenceProperty: 'errorRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n    id: 'error-element-code',\n    label: translate('Error Code'),\n    referenceProperty: 'errorRef',\n    modelProperty: 'errorCode'\n  }));\n\n};\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('../helper/CmdHelper'),\n    escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar checkbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      id = resource.id,\n      label = options.label || id,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n  resource.html =\n    '<input id=\"camunda-' + escapeHTML(id) + '\" ' +\n         'type=\"checkbox\" ' +\n         'name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n         (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n         (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n         ' />' +\n    '<label for=\"camunda-' + escapeHTML(id) + '\" ' +\n         (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n         (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n         '>' + escapeHTML(label) + '</label>';\n\n  // add description below checkbox entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.get = function(element) {\n    var bo = getBusinessObject(element),\n        res = {};\n\n    res[options.modelProperty] = bo.get(options.modelProperty);\n\n    return res;\n  };\n\n  resource.set = function(element, values) {\n    var res = {};\n\n    res[options.modelProperty] = !!values[options.modelProperty];\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  if (typeof options.set === 'function') {\n    resource.set = options.set;\n  }\n\n  if (typeof options.get === 'function') {\n    resource.get = options.get;\n  }\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-checkbox'];\n\n  return resource;\n};\n\nmodule.exports = checkbox;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks, whether a gateway forks and joins\n * at the same time.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:Gateway')) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n    const outgoing = node.outgoing || [];\n\n    if (incoming.length > 1 && outgoing.length > 1) {\n      reporter.report(node.id, 'Gateway forks and joins');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nmodule.exports = arrayIncludes;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var arrayFilter = require('./_arrayFilter'),\n    baseFilter = require('./_baseFilter'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection`, returning an array of all elements\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * **Note:** Unlike `_.remove`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n * @see _.reject\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': true },\n *   { 'user': 'fred',   'age': 40, 'active': false }\n * ];\n *\n * _.filter(users, function(o) { return !o.active; });\n * // => objects for ['fred']\n *\n * // The `_.matches` iteratee shorthand.\n * _.filter(users, { 'age': 36, 'active': true });\n * // => objects for ['barney']\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.filter(users, ['active', false]);\n * // => objects for ['fred']\n *\n * // The `_.property` iteratee shorthand.\n * _.filter(users, 'active');\n * // => objects for ['barney']\n */\nfunction filter(collection, predicate) {\n  var func = isArray(collection) ? arrayFilter : baseFilter;\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nmodule.exports = filter;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    asyncContinuation = require('./implementation/AsyncContinuation');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (is(element, 'camunda:AsyncCapable')) {\n\n    group.entries = group.entries.concat(asyncContinuation(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject\n    }, translate));\n\n  }\n};","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","'use strict';\n\nvar collectionAdd = require('diagram-js/lib/util/Collections').add,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar CategoryHelper = {};\n\nmodule.exports = CategoryHelper;\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nCategoryHelper.createCategoryValue = function(definitions, bpmnFactory) {\n  var categoryValue = bpmnFactory.create('bpmn:CategoryValue'),\n      category = bpmnFactory.create('bpmn:Category', {\n        categoryValue: [ categoryValue ]\n      });\n\n  // add to correct place\n  collectionAdd(definitions.get('rootElements'), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n\n};","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper');\n\nvar assign = require('lodash/assign');\nvar map = require('lodash/map');\n\nvar DEFAULT_DELEGATE_PROPS = [ 'class', 'expression', 'delegateExpression' ];\n\nvar DELEGATE_PROPS = {\n  'camunda:class': undefined,\n  'camunda:expression': undefined,\n  'camunda:delegateExpression': undefined,\n  'camunda:resultVariable': undefined\n};\n\nvar DMN_CAPABLE_PROPS = {\n  'camunda:decisionRef': undefined,\n  'camunda:decisionRefBinding': 'latest',\n  'camunda:decisionRefVersion': undefined,\n  'camunda:mapDecisionResult': 'resultList',\n  'camunda:decisionRefTenantId': undefined\n};\n\n\nvar EXTERNAL_CAPABLE_PROPS = {\n  'camunda:type': undefined,\n  'camunda:topic': undefined\n};\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var DEFAULT_OPTIONS = [\n    { value: 'class', name: translate('Java Class') },\n    { value: 'expression', name: translate('Expression') },\n    { value: 'delegateExpression', name: translate('Delegate Expression') }\n  ];\n\n  var DMN_OPTION = [\n    { value: 'dmn', name: translate('DMN') }\n  ];\n\n  var EXTERNAL_OPTION = [\n    { value: 'external', name: translate('External') }\n  ];\n\n  var CONNECTOR_OPTION = [\n    { value: 'connector', name: translate('Connector') }\n  ];\n\n  var SCRIPT_OPTION = [\n    { value: 'script', name: translate('Script') }\n  ];\n\n  var getType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  var hasDmnSupport = options.hasDmnSupport,\n      hasExternalSupport = options.hasExternalSupport,\n      hasServiceTaskLikeSupport = options.hasServiceTaskLikeSupport,\n      hasScriptSupport = options.hasScriptSupport;\n\n  var entries = [];\n\n  var selectOptions = DEFAULT_OPTIONS.concat([]);\n\n  if (hasDmnSupport) {\n    selectOptions = selectOptions.concat(DMN_OPTION);\n  }\n\n  if (hasExternalSupport) {\n    selectOptions = selectOptions.concat(EXTERNAL_OPTION);\n  }\n\n  if (hasServiceTaskLikeSupport) {\n    selectOptions = selectOptions.concat(CONNECTOR_OPTION);\n  }\n\n  if (hasScriptSupport) {\n    selectOptions = selectOptions.concat(SCRIPT_OPTION);\n  }\n\n  selectOptions.push({ value: '' });\n\n  entries.push(entryFactory.selectBox({\n    id : 'implementation',\n    label: translate('Implementation'),\n    selectOptions: selectOptions,\n    modelProperty: 'implType',\n\n    get: function(element, node) {\n      return {\n        implType: getType(element) || ''\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var oldType = getType(element);\n      var newType = values.implType;\n\n      var props = assign({}, DELEGATE_PROPS);\n\n      if (DEFAULT_DELEGATE_PROPS.indexOf(newType) !== -1) {\n\n        var newValue = '';\n        if (DEFAULT_DELEGATE_PROPS.indexOf(oldType) !== -1) {\n          newValue = bo.get('camunda:' + oldType);\n        }\n        props['camunda:' + newType] = newValue;\n      }\n\n      if (hasDmnSupport) {\n        props = assign(props, DMN_CAPABLE_PROPS);\n        if (newType === 'dmn') {\n          props['camunda:decisionRef'] = '';\n        }\n      }\n\n      if (hasExternalSupport) {\n        props = assign(props, EXTERNAL_CAPABLE_PROPS);\n        if (newType === 'external') {\n          props['camunda:type'] = 'external';\n          props['camunda:topic'] = '';\n        }\n      }\n\n      if (hasScriptSupport) {\n        props['camunda:script'] = undefined;\n\n        if (newType === 'script') {\n          props['camunda:script'] = elementHelper.createElement('camunda:Script', {}, bo, bpmnFactory);\n        }\n      }\n\n      var commands = [];\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n\n      if (hasServiceTaskLikeSupport) {\n        var connectors = extensionElementsHelper.getExtensionElements(bo, 'camunda:Connector');\n        commands.push(map(connectors, function(connector) {\n          return extensionElementsHelper.removeEntry(bo, element, connector);\n        }));\n\n        if (newType === 'connector') {\n          var extensionElements = bo.get('extensionElements');\n          if (!extensionElements) {\n            extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n            commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n          }\n          var connector = elementHelper.createElement('camunda:Connector', {}, extensionElements, bpmnFactory);\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            extensionElements,\n            'values',\n            'extensionElements',\n            [ connector ],\n            []\n          ));\n        }\n      }\n\n      return commands;\n\n    }\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory'),\n    participantHelper = require('../../../helper/ParticipantHelper'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    nameEntryFactory = require('./implementation/Name'),\n    utils = require('../../../Utils');\n\nmodule.exports = function(group, element, translate, options) {\n  var businessObject = getBusinessObject(element);\n\n  var processIdDescription = options && options.processIdDescription;\n\n  if (is(element, 'bpmn:Process') || (is(element, 'bpmn:Participant') && businessObject.get('processRef'))) {\n\n    /**\n     * processId\n     */\n    if (is(element, 'bpmn:Participant')) {\n      var idEntry = entryFactory.validationAwareTextField({\n        id: 'process-id',\n        label: translate('Process Id'),\n        description: processIdDescription && translate(processIdDescription),\n        modelProperty: 'processId'\n      });\n\n      // in participants we have to change the default behavior of set and get\n      idEntry.get = function(element) {\n        var properties = participantHelper.getProcessBusinessObject(element, 'id');\n        return { processId: properties.id };\n      };\n\n      idEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'id', { id: values.processId });\n      };\n\n      idEntry.validate = function(element, values) {\n        var idValue = values.processId;\n\n        var bo = getBusinessObject(element);\n\n        var processIdError = utils.isIdValid(bo.processRef, idValue, translate);\n\n        return processIdError ? { processId: processIdError } : {};\n      };\n\n      group.entries.push(idEntry);\n\n\n      /**\n       * process name\n       */\n      var processNameEntry = nameEntryFactory(element, {\n        id: 'process-name',\n        label: translate('Process Name')\n      })[0];\n\n      // in participants we have to change the default behavior of set and get\n      processNameEntry.get = function(element) {\n        return participantHelper.getProcessBusinessObject(element, 'name');\n      };\n\n      processNameEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'name', values);\n      };\n\n      group.entries.push(processNameEntry);\n    }\n  }\n};\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getExtensionElements = require('./ExtensionElementsHelper').getExtensionElements;\n\nvar FormHelper = {};\n\nmodule.exports = FormHelper;\n\n/**\n * Return form data from business object or undefined if none exist\n *\n * @param  {djs.model.Base} element\n *\n * @return {ModdleElement|undefined} formData\n */\nFormHelper.getFormData = function(element) {\n  var bo = getBusinessObject(element);\n\n  var formData = getExtensionElements(bo, 'camunda:FormData');\n\n  if (typeof formData !== 'undefined') {\n    return formData[0];\n  }\n};\n\n\n/**\n * Return all form fields existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array} a list of form field objects\n */\nFormHelper.getFormFields = function(element) {\n  var formData = this.getFormData(element);\n\n  if (typeof formData === 'undefined') {\n    return [];\n  }\n\n  return formData.fields || [];\n};\n\n\n/**\n * Get a form field from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param {number} idx\n *\n * @return {ModdleElement} the form field\n */\nFormHelper.getFormField = function(element, idx) {\n\n  var formFields = this.getFormFields(element);\n\n  return formFields[idx];\n};\n\n\n/**\n * Get all constraints for a specific form field from the business object\n *\n * @param  {ModdleElement} formField\n *\n * @return {Array<ModdleElement>} a list of constraint objects\n */\nFormHelper.getConstraints = function(formField) {\n  if (formField && formField.validation && formField.validation.constraints) {\n    return formField.validation.constraints;\n  }\n  return [];\n};\n\n\n/**\n * Get all camunda:value objects for a specific form field from the business object\n *\n * @param  {ModdleElement} formField\n *\n * @return {Array<ModdleElement>} a list of camunda:value objects\n */\nFormHelper.getEnumValues = function(formField) {\n  if (formField && formField.values) {\n    return formField.values;\n  }\n  return [];\n};\n\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","'use strict';\n// TODO: in core-js@4, move /modules/ dependencies to public entries for better optimization by tools like `preset-env`\nrequire('../modules/es.array.iterator');\nvar $ = require('../internals/export');\nvar getBuiltIn = require('../internals/get-built-in');\nvar USE_NATIVE_URL = require('../internals/native-url');\nvar redefine = require('../internals/redefine');\nvar redefineAll = require('../internals/redefine-all');\nvar setToStringTag = require('../internals/set-to-string-tag');\nvar createIteratorConstructor = require('../internals/create-iterator-constructor');\nvar InternalStateModule = require('../internals/internal-state');\nvar anInstance = require('../internals/an-instance');\nvar hasOwn = require('../internals/has');\nvar bind = require('../internals/function-bind-context');\nvar classof = require('../internals/classof');\nvar anObject = require('../internals/an-object');\nvar isObject = require('../internals/is-object');\nvar create = require('../internals/object-create');\nvar createPropertyDescriptor = require('../internals/create-property-descriptor');\nvar getIterator = require('../internals/get-iterator');\nvar getIteratorMethod = require('../internals/get-iterator-method');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar $fetch = getBuiltIn('fetch');\nvar Headers = getBuiltIn('Headers');\nvar ITERATOR = wellKnownSymbol('iterator');\nvar URL_SEARCH_PARAMS = 'URLSearchParams';\nvar URL_SEARCH_PARAMS_ITERATOR = URL_SEARCH_PARAMS + 'Iterator';\nvar setInternalState = InternalStateModule.set;\nvar getInternalParamsState = InternalStateModule.getterFor(URL_SEARCH_PARAMS);\nvar getInternalIteratorState = InternalStateModule.getterFor(URL_SEARCH_PARAMS_ITERATOR);\n\nvar plus = /\\+/g;\nvar sequences = Array(4);\n\nvar percentSequence = function (bytes) {\n  return sequences[bytes - 1] || (sequences[bytes - 1] = RegExp('((?:%[\\\\da-f]{2}){' + bytes + '})', 'gi'));\n};\n\nvar percentDecode = function (sequence) {\n  try {\n    return decodeURIComponent(sequence);\n  } catch (error) {\n    return sequence;\n  }\n};\n\nvar deserialize = function (it) {\n  var result = it.replace(plus, ' ');\n  var bytes = 4;\n  try {\n    return decodeURIComponent(result);\n  } catch (error) {\n    while (bytes) {\n      result = result.replace(percentSequence(bytes--), percentDecode);\n    }\n    return result;\n  }\n};\n\nvar find = /[!'()~]|%20/g;\n\nvar replace = {\n  '!': '%21',\n  \"'\": '%27',\n  '(': '%28',\n  ')': '%29',\n  '~': '%7E',\n  '%20': '+'\n};\n\nvar replacer = function (match) {\n  return replace[match];\n};\n\nvar serialize = function (it) {\n  return encodeURIComponent(it).replace(find, replacer);\n};\n\nvar parseSearchParams = function (result, query) {\n  if (query) {\n    var attributes = query.split('&');\n    var index = 0;\n    var attribute, entry;\n    while (index < attributes.length) {\n      attribute = attributes[index++];\n      if (attribute.length) {\n        entry = attribute.split('=');\n        result.push({\n          key: deserialize(entry.shift()),\n          value: deserialize(entry.join('='))\n        });\n      }\n    }\n  }\n};\n\nvar updateSearchParams = function (query) {\n  this.entries.length = 0;\n  parseSearchParams(this.entries, query);\n};\n\nvar validateArgumentsLength = function (passed, required) {\n  if (passed < required) throw TypeError('Not enough arguments');\n};\n\nvar URLSearchParamsIterator = createIteratorConstructor(function Iterator(params, kind) {\n  setInternalState(this, {\n    type: URL_SEARCH_PARAMS_ITERATOR,\n    iterator: getIterator(getInternalParamsState(params).entries),\n    kind: kind\n  });\n}, 'Iterator', function next() {\n  var state = getInternalIteratorState(this);\n  var kind = state.kind;\n  var step = state.iterator.next();\n  var entry = step.value;\n  if (!step.done) {\n    step.value = kind === 'keys' ? entry.key : kind === 'values' ? entry.value : [entry.key, entry.value];\n  } return step;\n});\n\n// `URLSearchParams` constructor\n// https://url.spec.whatwg.org/#interface-urlsearchparams\nvar URLSearchParamsConstructor = function URLSearchParams(/* init */) {\n  anInstance(this, URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n  var init = arguments.length > 0 ? arguments[0] : undefined;\n  var that = this;\n  var entries = [];\n  var iteratorMethod, iterator, next, step, entryIterator, entryNext, first, second, key;\n\n  setInternalState(that, {\n    type: URL_SEARCH_PARAMS,\n    entries: entries,\n    updateURL: function () { /* empty */ },\n    updateSearchParams: updateSearchParams\n  });\n\n  if (init !== undefined) {\n    if (isObject(init)) {\n      iteratorMethod = getIteratorMethod(init);\n      if (typeof iteratorMethod === 'function') {\n        iterator = iteratorMethod.call(init);\n        next = iterator.next;\n        while (!(step = next.call(iterator)).done) {\n          entryIterator = getIterator(anObject(step.value));\n          entryNext = entryIterator.next;\n          if (\n            (first = entryNext.call(entryIterator)).done ||\n            (second = entryNext.call(entryIterator)).done ||\n            !entryNext.call(entryIterator).done\n          ) throw TypeError('Expected sequence with length 2');\n          entries.push({ key: first.value + '', value: second.value + '' });\n        }\n      } else for (key in init) if (hasOwn(init, key)) entries.push({ key: key, value: init[key] + '' });\n    } else {\n      parseSearchParams(entries, typeof init === 'string' ? init.charAt(0) === '?' ? init.slice(1) : init : init + '');\n    }\n  }\n};\n\nvar URLSearchParamsPrototype = URLSearchParamsConstructor.prototype;\n\nredefineAll(URLSearchParamsPrototype, {\n  // `URLSearchParams.prototype.appent` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-append\n  append: function append(name, value) {\n    validateArgumentsLength(arguments.length, 2);\n    var state = getInternalParamsState(this);\n    state.entries.push({ key: name + '', value: value + '' });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.delete` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-delete\n  'delete': function (name) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var key = name + '';\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index].key === key) entries.splice(index, 1);\n      else index++;\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.get` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-get\n  get: function get(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = name + '';\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) return entries[index].value;\n    }\n    return null;\n  },\n  // `URLSearchParams.prototype.getAll` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-getall\n  getAll: function getAll(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = name + '';\n    var result = [];\n    var index = 0;\n    for (; index < entries.length; index++) {\n      if (entries[index].key === key) result.push(entries[index].value);\n    }\n    return result;\n  },\n  // `URLSearchParams.prototype.has` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-has\n  has: function has(name) {\n    validateArgumentsLength(arguments.length, 1);\n    var entries = getInternalParamsState(this).entries;\n    var key = name + '';\n    var index = 0;\n    while (index < entries.length) {\n      if (entries[index++].key === key) return true;\n    }\n    return false;\n  },\n  // `URLSearchParams.prototype.set` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-set\n  set: function set(name, value) {\n    validateArgumentsLength(arguments.length, 1);\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    var found = false;\n    var key = name + '';\n    var val = value + '';\n    var index = 0;\n    var entry;\n    for (; index < entries.length; index++) {\n      entry = entries[index];\n      if (entry.key === key) {\n        if (found) entries.splice(index--, 1);\n        else {\n          found = true;\n          entry.value = val;\n        }\n      }\n    }\n    if (!found) entries.push({ key: key, value: val });\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.sort` method\n  // https://url.spec.whatwg.org/#dom-urlsearchparams-sort\n  sort: function sort() {\n    var state = getInternalParamsState(this);\n    var entries = state.entries;\n    // Array#sort is not stable in some engines\n    var slice = entries.slice();\n    var entry, entriesIndex, sliceIndex;\n    entries.length = 0;\n    for (sliceIndex = 0; sliceIndex < slice.length; sliceIndex++) {\n      entry = slice[sliceIndex];\n      for (entriesIndex = 0; entriesIndex < sliceIndex; entriesIndex++) {\n        if (entries[entriesIndex].key > entry.key) {\n          entries.splice(entriesIndex, 0, entry);\n          break;\n        }\n      }\n      if (entriesIndex === sliceIndex) entries.push(entry);\n    }\n    state.updateURL();\n  },\n  // `URLSearchParams.prototype.forEach` method\n  forEach: function forEach(callback /* , thisArg */) {\n    var entries = getInternalParamsState(this).entries;\n    var boundFunction = bind(callback, arguments.length > 1 ? arguments[1] : undefined, 3);\n    var index = 0;\n    var entry;\n    while (index < entries.length) {\n      entry = entries[index++];\n      boundFunction(entry.value, entry.key, this);\n    }\n  },\n  // `URLSearchParams.prototype.keys` method\n  keys: function keys() {\n    return new URLSearchParamsIterator(this, 'keys');\n  },\n  // `URLSearchParams.prototype.values` method\n  values: function values() {\n    return new URLSearchParamsIterator(this, 'values');\n  },\n  // `URLSearchParams.prototype.entries` method\n  entries: function entries() {\n    return new URLSearchParamsIterator(this, 'entries');\n  }\n}, { enumerable: true });\n\n// `URLSearchParams.prototype[@@iterator]` method\nredefine(URLSearchParamsPrototype, ITERATOR, URLSearchParamsPrototype.entries);\n\n// `URLSearchParams.prototype.toString` method\n// https://url.spec.whatwg.org/#urlsearchparams-stringification-behavior\nredefine(URLSearchParamsPrototype, 'toString', function toString() {\n  var entries = getInternalParamsState(this).entries;\n  var result = [];\n  var index = 0;\n  var entry;\n  while (index < entries.length) {\n    entry = entries[index++];\n    result.push(serialize(entry.key) + '=' + serialize(entry.value));\n  } return result.join('&');\n}, { enumerable: true });\n\nsetToStringTag(URLSearchParamsConstructor, URL_SEARCH_PARAMS);\n\n$({ global: true, forced: !USE_NATIVE_URL }, {\n  URLSearchParams: URLSearchParamsConstructor\n});\n\n// Wrap `fetch` for correct work with polyfilled `URLSearchParams`\n// https://github.com/zloirock/core-js/issues/674\nif (!USE_NATIVE_URL && typeof $fetch == 'function' && typeof Headers == 'function') {\n  $({ global: true, enumerable: true, forced: true }, {\n    fetch: function fetch(input /* , init */) {\n      var args = [input];\n      var init, body, headers;\n      if (arguments.length > 1) {\n        init = arguments[1];\n        if (isObject(init)) {\n          body = init.body;\n          if (classof(body) === URL_SEARCH_PARAMS) {\n            headers = init.headers ? new Headers(init.headers) : new Headers();\n            if (!headers.has('content-type')) {\n              headers.set('content-type', 'application/x-www-form-urlencoded;charset=UTF-8');\n            }\n            init = create(init, {\n              body: createPropertyDescriptor(0, String(body)),\n              headers: createPropertyDescriptor(0, headers)\n            });\n          }\n        }\n        args.push(init);\n      } return $fetch.apply(this, args);\n    }\n  });\n}\n\nmodule.exports = {\n  URLSearchParams: URLSearchParamsConstructor,\n  getState: getInternalParamsState\n};\n","var baseFlatten = require('./_baseFlatten');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Recursively flattens `array`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flattenDeep([1, [2, [3, [4]], 5]]);\n * // => [1, 2, 3, 4, 5]\n */\nfunction flattenDeep(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, INFINITY) : [];\n}\n\nmodule.exports = flattenDeep;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","var anObject = require('../internals/an-object');\nvar getIteratorMethod = require('../internals/get-iterator-method');\n\nmodule.exports = function (it) {\n  var iteratorMethod = getIteratorMethod(it);\n  if (typeof iteratorMethod != 'function') {\n    throw TypeError(String(it) + ' is not iterable');\n  } return anObject(iteratorMethod.call(it));\n};\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getTemplate = require('../Helper').getTemplate,\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementHelper = require('../../../../helper/ElementHelper');\n\nvar findExtension = require('../Helper').findExtension,\n    findExtensions = require('../Helper').findExtensions,\n    findInputParameter = require('../Helper').findInputParameter,\n    findOutputParameter = require('../Helper').findOutputParameter,\n    findCamundaProperty = require('../Helper').findCamundaProperty,\n    findCamundaInOut = require('../Helper').findCamundaInOut;\n\nvar createCamundaProperty = require('../CreateHelper').createCamundaProperty,\n    createInputParameter = require('../CreateHelper').createInputParameter,\n    createOutputParameter = require('../CreateHelper').createOutputParameter,\n    createCamundaIn = require('../CreateHelper').createCamundaIn,\n    createCamundaOut = require('../CreateHelper').createCamundaOut,\n    createCamundaInWithBusinessKey = require('../CreateHelper').createCamundaInWithBusinessKey,\n    createCamundaFieldInjection = require('../CreateHelper').createCamundaFieldInjection;\n\nvar CAMUNDA_PROPERTY_TYPE = 'camunda:property',\n    CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n    CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter',\n    CAMUNDA_IN_TYPE = 'camunda:in',\n    CAMUNDA_OUT_TYPE = 'camunda:out',\n    CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey',\n    CAMUNDA_EXECUTION_LISTENER_TYPE = 'camunda:executionListener',\n    CAMUNDA_FIELD = 'camunda:field';\n\nvar BASIC_MODDLE_TYPES = [\n  'Boolean',\n  'Integer',\n  'String'\n];\n\nvar EXTENSION_BINDING_TYPES = [\n  CAMUNDA_PROPERTY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_FIELD\n];\n\nvar IO_BINDING_TYPES = [\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE\n];\n\nvar IN_OUT_BINDING_TYPES = [\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE\n];\n\n/**\n * Injects custom properties into the given group.\n *\n * @param {djs.model.Base} element\n * @param {ElementTemplates} elementTemplates\n * @param {BpmnFactory} bpmnFactory\n * @param {Function} translate\n */\nmodule.exports = function(element, elementTemplates, bpmnFactory, translate) {\n\n  var template = getTemplate(element, elementTemplates);\n\n  if (!template) {\n    return [];\n  }\n\n  var renderCustomField = function(id, p, idx) {\n    var propertyType = p.type;\n\n    var entryOptions = {\n      id: id,\n      description: p.description,\n      label: p.label ? translate(p.label) : p.label,\n      modelProperty: id,\n      get: propertyGetter(id, p),\n      set: propertySetter(id, p, bpmnFactory),\n      validate: propertyValidator(id, p, translate)\n    };\n\n    var entry;\n\n    if (propertyType === 'Boolean') {\n      entry = entryFactory.checkbox(entryOptions);\n    }\n\n    if (propertyType === 'String') {\n      entry = entryFactory.textField(entryOptions);\n    }\n\n    if (propertyType === 'Text') {\n      entry = entryFactory.textBox(entryOptions);\n    }\n\n    if (propertyType === 'Dropdown') {\n      entryOptions.selectOptions = p.choices;\n\n      entry = entryFactory.selectBox(entryOptions);\n    }\n\n    return entry;\n  };\n\n  var groups = [];\n  var id, entry;\n\n  var customFieldsGroup = {\n    id: 'customField',\n    label: translate('Custom Fields'),\n    entries: []\n  };\n  template.properties.forEach(function(p, idx) {\n\n    id = 'custom-' + template.id + '-' + idx;\n\n    entry = renderCustomField(id, p, idx);\n    if (entry) {\n      customFieldsGroup.entries.push(entry);\n    }\n  });\n  if (customFieldsGroup.entries.length > 0) {\n    groups.push(customFieldsGroup);\n  }\n\n  if (template.scopes) {\n    for (var scopeName in template.scopes) {\n\n      var scope = template.scopes[scopeName];\n      var idScopeName = scopeName.replace(/:/g, '_');\n\n      var customScopeFieldsGroup = {\n        id: 'customField-' + idScopeName,\n        label: translate('Custom Fields for scope: ') + scopeName,\n        entries: []\n      };\n\n      scope.properties.forEach(function(p, idx) {\n\n        var propertyId = 'custom-' + template.id + '-' + idScopeName + '-' + idx;\n\n        var scopedProperty = propertyWithScope(p, scopeName);\n\n        entry = renderCustomField(propertyId, scopedProperty, idx);\n        if (entry) {\n          customScopeFieldsGroup.entries.push(entry);\n        }\n      });\n\n      if (customScopeFieldsGroup.entries.length > 0) {\n        groups.push(customScopeFieldsGroup);\n      }\n    }\n  }\n\n  return groups;\n};\n\n\n// getters, setters and validators ///////////////\n\n\n/**\n * Return a getter that retrieves the given property.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n *\n * @return {Function}\n */\nfunction propertyGetter(name, property) {\n\n  /* getter */\n  return function get(element) {\n    var value = getPropertyValue(element, property);\n\n    return objectWithKey(name, value);\n  };\n}\n\n/**\n * Return a setter that updates the given property.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {Function}\n */\nfunction propertySetter(name, property, bpmnFactory) {\n\n  /* setter */\n  return function set(element, values) {\n\n    var value = values[name];\n\n    return setPropertyValue(element, property, value, bpmnFactory);\n  };\n}\n\n/**\n * Return a validator that ensures the property is ok.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n * @param {Function} translate\n *\n * @return {Function}\n */\nfunction propertyValidator(name, property, translate) {\n\n  /* validator */\n  return function validate(element, values) {\n    var value = values[name];\n\n    var error = validateValue(value, property, translate);\n\n    if (error) {\n      return objectWithKey(name, error);\n    }\n  };\n}\n\n\n// get, set and validate helpers ///////////////////\n\n/**\n * Return the value of the specified property descriptor,\n * on the passed diagram element.\n *\n * @param {djs.model.Base} element\n * @param {PropertyDescriptor} property\n *\n * @return {Any}\n */\nfunction getPropertyValue(element, property) {\n\n  var bo = getBusinessObject(element);\n\n  var binding = property.binding,\n      scope = property.scope;\n\n  var bindingType = binding.type,\n      bindingName = binding.name;\n\n  var propertyValue = property.value || '';\n\n  if (scope) {\n    bo = findExtension(bo, scope.name);\n    if (!bo) {\n      return propertyValue;\n    }\n  }\n\n  // property\n  if (bindingType === 'property') {\n\n    var value = bo.get(bindingName);\n\n    if (bindingName === 'conditionExpression') {\n      if (value) {\n        return value.body;\n      } else {\n        // return defined default\n        return propertyValue;\n      }\n    } else {\n      // return value; default to defined default\n      return typeof value !== 'undefined' ? value : propertyValue;\n    }\n  }\n\n  var camundaProperties,\n      camundaProperty;\n\n  if (bindingType === CAMUNDA_PROPERTY_TYPE) {\n    if (scope) {\n      camundaProperties = bo.get('properties');\n    } else {\n      camundaProperties = findExtension(bo, 'camunda:Properties');\n    }\n\n    if (camundaProperties) {\n      camundaProperty = findCamundaProperty(camundaProperties, binding);\n\n      if (camundaProperty) {\n        return camundaProperty.value;\n      }\n    }\n\n    return propertyValue;\n  }\n\n  var inputOutput,\n      ioParameter;\n\n  if (IO_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    if (scope) {\n      inputOutput = bo.get('inputOutput');\n    } else {\n      inputOutput = findExtension(bo, 'camunda:InputOutput');\n    }\n\n    if (!inputOutput) {\n      // ioParameter cannot exist yet, return property value\n      return propertyValue;\n    }\n  }\n\n  // camunda input parameter\n  if (bindingType === CAMUNDA_INPUT_PARAMETER_TYPE) {\n    ioParameter = findInputParameter(inputOutput, binding);\n\n    if (ioParameter) {\n      if (binding.scriptFormat) {\n        if (ioParameter.definition) {\n          return ioParameter.definition.value;\n        }\n      } else {\n        return ioParameter.value || '';\n      }\n    }\n\n    return propertyValue;\n  }\n\n  // camunda output parameter\n  if (binding.type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n    ioParameter = findOutputParameter(inputOutput, binding);\n\n    if (ioParameter) {\n      return ioParameter.name;\n    }\n\n    return propertyValue;\n  }\n\n\n  var ioElement;\n\n  if (IN_OUT_BINDING_TYPES.indexOf(bindingType) != -1) {\n    ioElement = findCamundaInOut(bo, binding);\n\n    if (ioElement) {\n      if (bindingType === CAMUNDA_IN_BUSINESS_KEY_TYPE) {\n        return ioElement.businessKey;\n      } else\n      if (bindingType === CAMUNDA_OUT_TYPE) {\n        return ioElement.target;\n      } else\n      if (bindingType === CAMUNDA_IN_TYPE) {\n        return ioElement[binding.expression ? 'sourceExpression' : 'source'];\n      }\n    }\n\n    return propertyValue;\n  }\n\n  if (bindingType === CAMUNDA_EXECUTION_LISTENER_TYPE) {\n    var executionListener;\n    if (scope) {\n      executionListener = bo.get('executionListener');\n    } else {\n      executionListener = findExtension(bo, 'camunda:ExecutionListener');\n    }\n\n    return executionListener.script.value;\n  }\n\n  var fieldInjection;\n  if (CAMUNDA_FIELD === bindingType) {\n    var fieldInjections = findExtensions(bo, [ 'camunda:Field' ]);\n    fieldInjections.forEach(function(item) {\n      if (item.name === binding.name) {\n        fieldInjection = item;\n      }\n    });\n    if (fieldInjection) {\n      return fieldInjection.string || fieldInjection.expression;\n    } else {\n      return '';\n    }\n  }\n\n  throw unknownPropertyBinding(property);\n}\n\nmodule.exports.getPropertyValue = getPropertyValue;\n\n\n/**\n * Return an update operation that changes the diagram\n * element's custom property to the given value.\n *\n * The response of this method will be processed via\n * {@link PropertiesPanel#applyChanges}.\n *\n * @param {djs.model.Base} element\n * @param {PropertyDescriptor} property\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {Object|Array<Object>} results to be processed\n */\nfunction setPropertyValue(element, property, value, bpmnFactory) {\n  var bo = getBusinessObject(element);\n\n  var binding = property.binding,\n      scope = property.scope;\n\n  var bindingType = binding.type,\n      bindingName = binding.name;\n\n  var propertyValue;\n\n  var updates = [];\n\n  var extensionElements;\n\n  if (EXTENSION_BINDING_TYPES.indexOf(bindingType) !== -1) {\n    extensionElements = bo.get('extensionElements');\n\n    // create extension elements, if they do not exist (yet)\n    if (!extensionElements) {\n      extensionElements = elementHelper.createElement('bpmn:ExtensionElements', null, element, bpmnFactory);\n\n      updates.push(cmdHelper.updateBusinessObject(\n        element, bo, objectWithKey('extensionElements', extensionElements)\n      ));\n    }\n  }\n\n  if (scope) {\n    bo = findExtension(bo, scope.name);\n    if (!bo) {\n      bo = elementHelper.createElement(scope.name, null, element, bpmnFactory);\n\n      updates.push(cmdHelper.addElementsTolist(\n        bo, extensionElements, 'values', [ bo ]\n      ));\n    }\n  }\n\n  // property\n  if (bindingType === 'property') {\n\n    if (bindingName === 'conditionExpression') {\n\n      propertyValue = elementHelper.createElement('bpmn:FormalExpression', {\n        body: value,\n        language: binding.scriptFormat\n      }, bo, bpmnFactory);\n    } else {\n\n      var moddlePropertyDescriptor = bo.$descriptor.propertiesByName[bindingName];\n\n      var moddleType = moddlePropertyDescriptor.type;\n\n      // make sure we only update String, Integer, Real and\n      // Boolean properties (do not accidentally override complex objects...)\n      if (BASIC_MODDLE_TYPES.indexOf(moddleType) === -1) {\n        throw new Error('cannot set moddle type <' + moddleType + '>');\n      }\n\n      if (moddleType === 'Boolean') {\n        propertyValue = !!value;\n      } else\n      if (moddleType === 'Integer') {\n        propertyValue = parseInt(value, 10);\n\n        if (isNaN(propertyValue)) {\n          // do not write NaN value\n          propertyValue = undefined;\n        }\n      } else {\n        propertyValue = value;\n      }\n    }\n\n    if (propertyValue !== undefined) {\n      updates.push(cmdHelper.updateBusinessObject(\n        element, bo, objectWithKey(bindingName, propertyValue)\n      ));\n    }\n  }\n\n  // camunda:property\n  var camundaProperties,\n      existingCamundaProperty,\n      newCamundaProperty;\n\n  if (bindingType === CAMUNDA_PROPERTY_TYPE) {\n\n    if (scope) {\n      camundaProperties = bo.get('properties');\n    } else {\n      camundaProperties = findExtension(extensionElements, 'camunda:Properties');\n    }\n\n    if (!camundaProperties) {\n      camundaProperties = elementHelper.createElement('camunda:Properties', null, bo, bpmnFactory);\n\n      if (scope) {\n        updates.push(cmdHelper.updateBusinessObject(\n          element, bo, { properties: camundaProperties }\n        ));\n      }\n      else {\n        updates.push(cmdHelper.addElementsTolist(\n          element, extensionElements, 'values', [ camundaProperties ]\n        ));\n      }\n    }\n\n    existingCamundaProperty = findCamundaProperty(camundaProperties, binding);\n\n    newCamundaProperty = createCamundaProperty(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      camundaProperties,\n      'values',\n      null,\n      [ newCamundaProperty ],\n      existingCamundaProperty ? [ existingCamundaProperty ] : []\n    ));\n  }\n\n  // camunda:inputParameter\n  // camunda:outputParameter\n  var inputOutput,\n      existingIoParameter,\n      newIoParameter;\n\n  if (IO_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    if (scope) {\n      inputOutput = bo.get('inputOutput');\n    } else {\n      inputOutput = findExtension(extensionElements, 'camunda:InputOutput');\n    }\n\n    // create inputOutput element, if it do not exist (yet)\n    if (!inputOutput) {\n      inputOutput = elementHelper.createElement('camunda:InputOutput', null, bo, bpmnFactory);\n\n      if (scope) {\n        updates.push(cmdHelper.updateBusinessObject(\n          element, bo, { inputOutput: inputOutput }\n        ));\n      }\n      else {\n        updates.push(cmdHelper.addElementsTolist(\n          element, extensionElements, 'values', inputOutput\n        ));\n      }\n    }\n  }\n\n  if (bindingType === CAMUNDA_INPUT_PARAMETER_TYPE) {\n\n    existingIoParameter = findInputParameter(inputOutput, binding);\n\n    newIoParameter = createInputParameter(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      inputOutput,\n      'inputParameters',\n      null,\n      [ newIoParameter ],\n      existingIoParameter ? [ existingIoParameter ] : []\n    ));\n  }\n\n  if (bindingType === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n\n    existingIoParameter = findOutputParameter(inputOutput, binding);\n\n    newIoParameter = createOutputParameter(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      inputOutput,\n      'outputParameters',\n      null,\n      [ newIoParameter ],\n      existingIoParameter ? [ existingIoParameter ] : []\n    ));\n  }\n\n\n  // camunda:in\n  // camunda:out\n  // camunda:in:businessKey\n  var existingInOut,\n      newInOut;\n\n  if (IN_OUT_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    existingInOut = findCamundaInOut(bo, binding);\n\n    if (bindingType === CAMUNDA_IN_TYPE) {\n      newInOut = createCamundaIn(binding, value, bpmnFactory);\n    } else\n    if (bindingType === CAMUNDA_OUT_TYPE) {\n      newInOut = createCamundaOut(binding, value, bpmnFactory);\n    } else {\n      newInOut = createCamundaInWithBusinessKey(binding, value, bpmnFactory);\n    }\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      null,\n      [ newInOut ],\n      existingInOut ? [ existingInOut ] : []\n    ));\n  }\n\n  if (bindingType === CAMUNDA_FIELD) {\n    var existingFieldInjections = findExtensions(bo, [ 'camunda:Field' ]);\n    var newFieldInjections = [];\n\n    if (existingFieldInjections.length > 0) {\n      existingFieldInjections.forEach(function(item) {\n        if (item.name === binding.name) {\n          newFieldInjections.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n        } else {\n          newFieldInjections.push(item);\n        }\n      });\n    } else {\n      newFieldInjections.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n    }\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      null,\n      newFieldInjections,\n      existingFieldInjections ? existingFieldInjections : []\n    ));\n  }\n\n  if (updates.length) {\n    return updates;\n  }\n\n  // quick warning for better debugging\n  console.warn('no update', element, property, value);\n}\n\nmodule.exports.setPropertyValue = setPropertyValue;\n\n/**\n * Validate value of a given property.\n *\n * @param {String} value\n * @param {PropertyDescriptor} property\n * @param {Function} translate\n *\n * @return {Object} with validation errors\n */\nfunction validateValue(value, property, translate) {\n\n  var constraints = property.constraints || {};\n\n  if (constraints.notEmpty && isEmpty(value)) {\n    return translate('Must not be empty');\n  }\n\n  if (constraints.maxLength && value.length > constraints.maxLength) {\n    return translate('Must have max length {length}', { length: constraints.maxLength });\n  }\n\n  if (constraints.minLength && value.length < constraints.minLength) {\n    return translate('Must have min length {length}', { length: constraints.minLength });\n  }\n\n  var pattern = constraints.pattern,\n      message;\n\n  if (pattern) {\n\n    if (typeof pattern !== 'string') {\n      message = pattern.message;\n      pattern = pattern.value;\n    }\n\n    if (!matchesPattern(value, pattern)) {\n      return message || translate('Must match pattern {pattern}', { pattern: pattern });\n    }\n  }\n}\n\n\n// misc helpers ///////////////////////////////\n\nfunction propertyWithScope(property, scopeName) {\n  if (!scopeName) {\n    return property;\n  }\n\n  return assign({}, property, {\n    scope: {\n      name: scopeName\n    }\n  });\n}\n\n/**\n * Return an object with a single key -> value association.\n *\n * @param {String} key\n * @param {Any} value\n *\n * @return {Object}\n */\nfunction objectWithKey(key, value) {\n  var obj = {};\n\n  obj[key] = value;\n\n  return obj;\n}\n\n/**\n * Does the given string match the specified pattern?\n *\n * @param {String} str\n * @param {String} pattern\n *\n * @return {Boolean}\n */\nfunction matchesPattern(str, pattern) {\n  var regexp = new RegExp(pattern);\n\n  return regexp.test(str);\n}\n\nfunction isEmpty(str) {\n  return !str || /^\\s*$/.test(str);\n}\n\n/**\n * Create a new {@link Error} indicating an unknown\n * property binding.\n *\n * @param {PropertyDescriptor} property\n *\n * @return {Error}\n */\nfunction unknownPropertyBinding(property) {\n  var binding = property.binding;\n\n  return new Error('unknown binding: <' + binding.type + '>');\n}\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction getFailedJobRetryTimeCycle(bo) {\n  return asyncCapableHelper.getFailedJobRetryTimeCycle(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction createExtensionElements(parent, bpmnFactory) {\n  return elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, parent, bpmnFactory);\n}\n\nfunction createFailedJobRetryTimeCycle(parent, bpmnFactory, cycle) {\n  return elementHelper.createElement('camunda:FailedJobRetryTimeCycle', { body: cycle }, parent, bpmnFactory);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n  var retryTimeCycleEntry = entryFactory.textField({\n    id: idPrefix + 'retryTimeCycle',\n    label: labelPrefix + translate('Retry Time Cycle'),\n    modelProperty: 'cycle',\n\n    get: function(element, node) {\n      var retryTimeCycle = getFailedJobRetryTimeCycle(getBusinessObject(element));\n      var value = retryTimeCycle && retryTimeCycle.get('body');\n      return {\n        cycle: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCycle = values.cycle;\n      var bo = getBusinessObject(element);\n\n      if (newCycle === '' || typeof newCycle === 'undefined') {\n        // remove retry time cycle element(s)\n        return removeFailedJobRetryTimeCycle(bo, element);\n      }\n\n      var retryTimeCycle = getFailedJobRetryTimeCycle(bo);\n\n      if (!retryTimeCycle) {\n        // add new retry time cycle element\n        var commands = [];\n\n        var extensionElements = bo.get('extensionElements');\n        if (!extensionElements) {\n          extensionElements = createExtensionElements(bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n\n        retryTimeCycle = createFailedJobRetryTimeCycle(extensionElements, bpmnFactory, newCycle);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [ retryTimeCycle ],\n          []\n        ));\n\n        return commands;\n      }\n\n      // update existing retry time cycle element\n      return cmdHelper.updateBusinessObject(element, retryTimeCycle, { body: newCycle });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n\n      if (bo && (isAsyncBefore(bo) || isAsyncAfter(bo))) {\n        return false;\n      }\n\n      if (is(element, 'bpmn:Event')) {\n        return !eventDefinitionHelper.getTimerEventDefinition(element);\n      }\n\n      return true;\n    }\n\n  });\n\n  return [ retryTimeCycleEntry ];\n\n};\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar defaults = {\n    allowDots: false,\n    allowPrototypes: false,\n    arrayLimit: 20,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    parameterLimit: 1000,\n    plainObjects: false,\n    strictNullHandling: false\n};\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = {};\n    var cleanStr = options.ignoreQueryPrefix ? str.replace(/^\\?/, '') : str;\n    var limit = options.parameterLimit === Infinity ? undefined : options.parameterLimit;\n    var parts = cleanStr.split(options.delimiter, limit);\n\n    for (var i = 0; i < parts.length; ++i) {\n        var part = parts[i];\n\n        var bracketEqualsPos = part.indexOf(']=');\n        var pos = bracketEqualsPos === -1 ? part.indexOf('=') : bracketEqualsPos + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part, defaults.decoder);\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos), defaults.decoder);\n            val = options.decoder(part.slice(pos + 1), defaults.decoder);\n        }\n        if (has.call(obj, key)) {\n            obj[key] = [].concat(obj[key]).concat(val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function (chain, val, options) {\n    var leaf = val;\n\n    for (var i = chain.length - 1; i >= 0; --i) {\n        var obj;\n        var root = chain[i];\n\n        if (root === '[]') {\n            obj = [];\n            obj = obj.concat(leaf);\n        } else {\n            obj = options.plainObjects ? Object.create(null) : {};\n            var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n            var index = parseInt(cleanRoot, 10);\n            if (\n                !isNaN(index)\n                && root !== cleanRoot\n                && String(index) === cleanRoot\n                && index >= 0\n                && (options.parseArrays && index <= options.arrayLimit)\n            ) {\n                obj = [];\n                obj[index] = leaf;\n            } else {\n                obj[cleanRoot] = leaf;\n            }\n        }\n\n        leaf = obj;\n    }\n\n    return leaf;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys\n        // that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while ((segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options);\n};\n\nmodule.exports = function (str, opts) {\n    var options = opts ? utils.assign({}, opts) : {};\n\n    if (options.decoder !== null && options.decoder !== undefined && typeof options.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    options.ignoreQueryPrefix = options.ignoreQueryPrefix === true;\n    options.delimiter = typeof options.delimiter === 'string' || utils.isRegExp(options.delimiter) ? options.delimiter : defaults.delimiter;\n    options.depth = typeof options.depth === 'number' ? options.depth : defaults.depth;\n    options.arrayLimit = typeof options.arrayLimit === 'number' ? options.arrayLimit : defaults.arrayLimit;\n    options.parseArrays = options.parseArrays !== false;\n    options.decoder = typeof options.decoder === 'function' ? options.decoder : defaults.decoder;\n    options.allowDots = typeof options.allowDots === 'boolean' ? options.allowDots : defaults.allowDots;\n    options.plainObjects = typeof options.plainObjects === 'boolean' ? options.plainObjects : defaults.plainObjects;\n    options.allowPrototypes = typeof options.allowPrototypes === 'boolean' ? options.allowPrototypes : defaults.allowPrototypes;\n    options.parameterLimit = typeof options.parameterLimit === 'number' ? options.parameterLimit : defaults.parameterLimit;\n    options.strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options);\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    return utils.compact(obj);\n};\n","var baseEach = require('./_baseEach');\n\n/**\n * The base implementation of `_.filter` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction baseFilter(collection, predicate) {\n  var result = [];\n  baseEach(collection, function(value, index, collection) {\n    if (predicate(value, index, collection)) {\n      result.push(value);\n    }\n  });\n  return result;\n}\n\nmodule.exports = baseFilter;\n","'use strict';\n\nvar domQuery = require('min-dom').query,\n    escapeHTML = require('../../../../Utils').escapeHTML,\n    utils = require('../../../../Utils');\n\n\nfunction getScriptType(node) {\n  return utils.selectedType('select[name=scriptType]', node.parentElement);\n}\n\n\nmodule.exports = function(scriptLanguagePropName, scriptValuePropName, isFormatRequired, translate) {\n\n  return {\n    template:\n    '<div class=\"bpp-row bpp-textfield\">' +\n      '<label for=\"cam-script-format\">' + escapeHTML(translate('Script Format')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\">' +\n        '<input id=\"cam-script-format\" type=\"text\" name=\"scriptFormat\" />' +\n        '<button class=\"clear\" data-action=\"script.clearScriptFormat\" data-show=\"script.canClearScriptFormat\">' +\n          '<span>X</span>' +\n        '</button>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row\">' +\n      '<label for=\"cam-script-type\">' + escapeHTML(translate('Script Type')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\">' +\n        '<select id=\"cam-script-type\" name=\"scriptType\" data-value>' +\n          '<option value=\"script\" selected>' + escapeHTML(translate('Inline Script')) + '</option>' +\n          '<option value=\"scriptResource\">' + escapeHTML(translate('External Resource')) + '</option>' +\n        '</select>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row bpp-textfield\">' +\n      '<label for=\"cam-script-resource-val\" data-show=\"script.isScriptResource\">' + escapeHTML(translate('Resource')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\" data-show=\"script.isScriptResource\">' +\n        '<input id=\"cam-script-resource-val\" type=\"text\" name=\"scriptResourceValue\" />' +\n        '<button class=\"clear\" data-action=\"script.clearScriptResource\" data-show=\"script.canClearScriptResource\">' +\n          '<span>X</span>' +\n        '</button>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row\">' +\n      '<label for=\"cam-script-val\" data-show=\"script.isScript\">' + escapeHTML(translate('Script')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\" data-show=\"script.isScript\">' +\n        '<textarea id=\"cam-script-val\" type=\"text\" name=\"scriptValue\"></textarea>' +\n      '</div>'+\n    '</div>',\n\n    get: function(element, bo) {\n      var values = {};\n\n      // read values from xml:\n      var boScriptResource = bo.get('camunda:resource'),\n          boScript = bo.get(scriptValuePropName),\n          boScriptFormat = bo.get(scriptLanguagePropName);\n\n      if (typeof boScriptResource !== 'undefined') {\n        values.scriptResourceValue = boScriptResource;\n        values.scriptType = 'scriptResource';\n      } else {\n        values.scriptValue = boScript;\n        values.scriptType = 'script';\n      }\n\n      values.scriptFormat = boScriptFormat;\n\n      return values;\n    },\n\n    set: function(element, values, containerElement) {\n      var scriptFormat = values.scriptFormat,\n          scriptType = values.scriptType,\n          scriptResourceValue = values.scriptResourceValue,\n          scriptValue = values.scriptValue;\n\n      // init update\n      var update = {\n        'camunda:resource': undefined\n      };\n      update[scriptValuePropName] = undefined;\n      update[scriptLanguagePropName] = undefined;\n\n      if (isFormatRequired) {\n        // always set language\n        update[scriptLanguagePropName] = scriptFormat || '';\n      } else\n      // set language only when scriptFormat has a value\n      if (scriptFormat !== '') {\n        update[scriptLanguagePropName] = scriptFormat;\n      }\n\n      // set either inline script or resource\n      if ('scriptResource' === scriptType) {\n        update['camunda:resource'] = scriptResourceValue || '';\n      } else {\n        update[scriptValuePropName] = scriptValue || '';\n      }\n\n      return update;\n    },\n\n    validate: function(element, values) {\n      var validationResult = {};\n\n      if (values.scriptType === 'script' && !values.scriptValue) {\n        validationResult.scriptValue = translate('Must provide a value');\n      }\n\n      if (values.scriptType === 'scriptResource' && !values.scriptResourceValue) {\n        validationResult.scriptResourceValue = translate('Must provide a value');\n      }\n\n      if (isFormatRequired && (!values.scriptFormat || values.scriptFormat.length === 0)) {\n        validationResult.scriptFormat = translate('Must provide a value');\n      }\n\n      return validationResult;\n    },\n\n    clearScriptFormat: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('input[name=scriptFormat]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScriptFormat: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('input[name=scriptFormat]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    clearScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('input[name=scriptResourceValue]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('input[name=scriptResourceValue]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    clearScript: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('textarea[name=scriptValue]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScript: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('textarea[name=scriptValue]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    isScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      var scriptType = getScriptType(scopeNode);\n      return scriptType === 'scriptResource';\n    },\n\n    isScript: function(element, inputNode, btnNode, scopeNode) {\n      var scriptType = getScriptType(scopeNode);\n      return scriptType === 'script';\n    }\n\n  };\n\n};\n","/**\n * A specialized version of `baseAggregator` for arrays.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform keys.\n * @param {Object} accumulator The initial aggregated object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction arrayAggregator(array, setter, iteratee, accumulator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    var value = array[index];\n    setter(accumulator, value, iteratee(value), array);\n  }\n  return accumulator;\n}\n\nmodule.exports = arrayAggregator;\n","const traverse = require('./traverse');\n\nclass Reporter {\n  constructor({ moddleRoot, rule }) {\n    this.rule = rule;\n    this.moddleRoot = moddleRoot;\n    this.messages = [];\n    this.report = this.report.bind(this);\n  }\n\n  report(id, message) {\n    this.messages.push({ id, message });\n  }\n}\n\nmodule.exports = function testRule({ moddleRoot, rule }) {\n  const reporter = new Reporter({ rule, moddleRoot });\n  traverse(moddleRoot, node => rule.check(node, reporter));\n  return reporter.messages;\n};\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    utils = require('../../../../Utils');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar forEach = require('lodash/forEach'),\n    find = require('lodash/find'),\n    filter = require('lodash/filter');\n\n\nfunction getContainedActivities(element) {\n  return getFlowElements(element, 'bpmn:Activity');\n}\n\nfunction getContainedBoundaryEvents(element) {\n  return getFlowElements(element, 'bpmn:BoundaryEvent');\n}\n\nfunction getFlowElements(element, type) {\n  return utils.filterElementsByType(element.flowElements, type);\n}\n\nfunction isCompensationEventAttachedToActivity(activity, boundaryEvents) {\n  var activityId = activity.id;\n  var boundaryEvent = find(boundaryEvents, function(boundaryEvent) {\n    var compensateEventDefinition = eventDefinitionHelper.getCompensateEventDefinition(boundaryEvent);\n    var attachedToRef = boundaryEvent.attachedToRef;\n    return compensateEventDefinition && attachedToRef && attachedToRef.id === activityId;\n  });\n  return !!boundaryEvent;\n}\n\n// subprocess: only when it is not triggeredByEvent\n// activity: only when it attach a compensation boundary event\n// callActivity: no limitation\nfunction canActivityBeCompensated(activity, boundaryEvents) {\n  return (is(activity, 'bpmn:SubProcess') && !activity.triggeredByEvent) ||\n          is(activity, 'bpmn:CallActivity') ||\n          isCompensationEventAttachedToActivity(activity, boundaryEvents);\n}\n\nfunction getActivitiesForCompensation(element) {\n  var boundaryEvents = getContainedBoundaryEvents(element);\n  return filter(getContainedActivities(element), function(activity) {\n    return canActivityBeCompensated(activity, boundaryEvents);\n  });\n}\n\nfunction getActivitiesForActivityRef(element) {\n  var bo = getBusinessObject(element);\n  var parent = bo.$parent;\n\n  var activitiesForActivityRef = getActivitiesForCompensation(parent);\n\n  // if throwing compensation event is in an event sub process:\n  // get also all activities outside of the event sub process\n  if (is(parent, 'bpmn:SubProcess') && parent.triggeredByEvent) {\n    parent = parent.$parent;\n    if (parent) {\n      activitiesForActivityRef = activitiesForActivityRef.concat(getActivitiesForCompensation(parent));\n    }\n\n  }\n\n  return activitiesForActivityRef;\n}\n\nfunction createActivityRefOptions(element) {\n  var options = [ { value: '' } ];\n\n  var activities = getActivitiesForActivityRef(element);\n  forEach(activities, function(activity) {\n    var activityId = activity.id;\n    var name = (activity.name ? (activity.name + ' ') : '') + '(id=' + activityId + ')';\n    options.push({ value: activityId, name: name });\n  });\n\n  return options;\n}\n\n\nmodule.exports = function(group, element, bpmnFactory, compensateEventDefinition, elementRegistry, translate) {\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'wait-for-completion',\n    label: translate('Wait for Completion'),\n    modelProperty: 'waitForCompletion',\n\n    get: function(element, node) {\n      return {\n        waitForCompletion: compensateEventDefinition.waitForCompletion\n      };\n    },\n\n    set: function(element, values) {\n      values.waitForCompletion = values.waitForCompletion || false;\n      return cmdHelper.updateBusinessObject(element, compensateEventDefinition, values);\n    }\n  }));\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'activity-ref',\n    label: translate('Activity Ref'),\n    selectOptions: createActivityRefOptions(element),\n    modelProperty: 'activityRef',\n\n    get: function(element, node) {\n      var activityRef = compensateEventDefinition.activityRef;\n      activityRef = activityRef && activityRef.id;\n      return {\n        activityRef: activityRef || ''\n      };\n    },\n\n    set: function(element, values) {\n      var activityRef = values.activityRef || undefined;\n      activityRef = activityRef && getBusinessObject(elementRegistry.get(activityRef));\n      return cmdHelper.updateBusinessObject(element, compensateEventDefinition, {\n        activityRef: activityRef\n      });\n    }\n  }));\n\n};\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar DELEGATE_TYPES = [\n  'class',\n  'expression',\n  'delegateExpression'\n];\n\nvar PROPERTIES = {\n  class: 'camunda:class',\n  expression: 'camunda:expression',\n  delegateExpression: 'camunda:delegateExpression'\n};\n\nfunction isDelegate(type) {\n  return DELEGATE_TYPES.indexOf(type) !== -1;\n}\n\nfunction getAttribute(type) {\n  return PROPERTIES[type];\n}\n\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getImplementationType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  function getDelegationLabel(type) {\n    switch (type) {\n    case 'class':\n      return translate('Java Class');\n    case 'expression':\n      return translate('Expression');\n    case 'delegateExpression':\n      return translate('Delegate Expression');\n    default:\n      return '';\n    }\n  }\n\n  var delegateEntry = entryFactory.textField({\n    id: 'delegate',\n    label: translate('Value'),\n    dataValueLabel: 'delegationLabel',\n    modelProperty: 'delegate',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var type = getImplementationType(element);\n      var attr = getAttribute(type);\n      var label = getDelegationLabel(type);\n      return {\n        delegate: bo.get(attr),\n        delegationLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var type = getImplementationType(element);\n      var attr = getAttribute(type);\n      var prop = {};\n      prop[attr] = values.delegate || '';\n      return cmdHelper.updateBusinessObject(element, bo, prop);\n    },\n\n    validate: function(element, values, node) {\n      return isDelegate(getImplementationType(element)) && !values.delegate ? { delegate: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isDelegate(getImplementationType(element));\n    }\n\n  });\n\n  return [ delegateEntry ];\n\n};\n","var copyArray = require('./_copyArray'),\n    isIndex = require('./_isIndex');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Reorder `array` according to the specified indexes where the element at\n * the first index is assigned as the first element, the element at\n * the second index is assigned as the second element, and so on.\n *\n * @private\n * @param {Array} array The array to reorder.\n * @param {Array} indexes The arranged array indexes.\n * @returns {Array} Returns `array`.\n */\nfunction reorder(array, indexes) {\n  var arrLength = array.length,\n      length = nativeMin(indexes.length, arrLength),\n      oldArray = copyArray(array);\n\n  while (length--) {\n    var index = indexes[length];\n    array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n  }\n  return array;\n}\n\nmodule.exports = reorder;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\n/**\n * Create an entry to modify a property of an element which\n * is referenced by a event definition.\n *\n * @param  {djs.model.Base} element\n * @param  {ModdleElement} definition\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n * @param  {string} options.referenceProperty the name of referencing property\n * @param  {string} options.modelProperty the name of property to modify\n * @param  {string} options.shouldValidate a flag indicate whether to validate or not\n *\n * @return {Array<Object>} return an array containing the entries\n */\nmodule.exports = function(element, definition, bpmnFactory, options) {\n\n  var id = options.id || 'element-property';\n  var label = options.label;\n  var referenceProperty = options.referenceProperty;\n  var modelProperty = options.modelProperty || 'name';\n  var shouldValidate = options.shouldValidate || false;\n\n  var entry = entryFactory.textField({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n\n    get: function(element, node) {\n      var reference = definition.get(referenceProperty);\n      var props = {};\n      props[modelProperty] = reference && reference.get(modelProperty);\n      return props;\n    },\n\n    set: function(element, values, node) {\n      var reference = definition.get(referenceProperty);\n      var props = {};\n      props[modelProperty] = values[modelProperty] || undefined;\n      return cmdHelper.updateBusinessObject(element, reference, props);\n    },\n\n    hidden: function(element, node) {\n      return !definition.get(referenceProperty);\n    }\n  });\n\n  if (shouldValidate) {\n    entry.validate = function(element, values, node) {\n      var reference = definition.get(referenceProperty);\n      if (reference && !values[modelProperty]) {\n        var validationErrors = {};\n        validationErrors[modelProperty] = 'Must provide a value';\n        return validationErrors;\n      }\n    };\n  }\n\n  return [ entry ];\n};\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    inputOutputHelper = require('../../../../helper/InputOutputHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    scriptImplementation = require('./Script');\n\n\nfunction createElement(type, parent, factory, properties) {\n  return elementHelper.createElement(type, properties, parent, factory);\n}\n\nfunction isScript(elem) {\n  return is(elem, 'camunda:Script');\n}\n\nfunction isList(elem) {\n  return is(elem, 'camunda:List');\n}\n\nfunction isMap(elem) {\n  return is(elem, 'camunda:Map');\n}\n\nfunction ensureInputOutputSupported(element, insideConnector) {\n  return inputOutputHelper.isInputOutputSupported(element, insideConnector);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var typeInfo = {\n    'camunda:Map': {\n      value: 'map',\n      label: translate('Map')\n    },\n    'camunda:List': {\n      value: 'list',\n      label: translate('List')\n    },\n    'camunda:Script': {\n      value: 'script',\n      label: translate('Script')\n    }\n  };\n\n  options = options || {};\n\n  var insideConnector = !!options.insideConnector,\n      idPrefix = options.idPrefix || '';\n\n  var getSelected = options.getSelectedParameter;\n\n  if (!ensureInputOutputSupported(element, insideConnector)) {\n    return [];\n  }\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelected(element, node);\n  };\n\n\n  // parameter name ////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: idPrefix + 'parameterName',\n    label: translate('Name'),\n    modelProperty: 'name',\n\n    getProperty: function(element, node) {\n      return (getSelected(element, node) || {}).name;\n    },\n\n    setProperty: function(element, values, node) {\n      var param = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, param, values);\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelected(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.name;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.name = translate('Name must not contain spaces');\n          }\n        } else {\n          validation.name = translate('Parameter must have a name');\n        }\n      }\n\n      return validation;\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n  }));\n\n\n  // parameter type //////////////////////////////////////////////////////\n\n  var selectOptions = [\n    { value: 'text', name: translate('Text') },\n    { value: 'script', name: translate('Script') },\n    { value: 'list', name: translate('List') },\n    { value: 'map', name: translate('Map') }\n  ];\n\n  entries.push(entryFactory.selectBox({\n    id : idPrefix + 'parameterType',\n    label: translate('Type'),\n    selectOptions: selectOptions,\n    modelProperty: 'parameterType',\n\n    get: function(element, node) {\n      var bo = getSelected(element, node);\n\n      var parameterType = 'text';\n\n      if (typeof bo !== 'undefined') {\n        var definition = bo.get('definition');\n        if (typeof definition !== 'undefined') {\n          var type = definition.$type;\n          parameterType = typeInfo[type].value;\n        }\n      }\n\n      return {\n        parameterType: parameterType\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelected(element, node);\n\n      var properties = {\n        value: undefined,\n        definition: undefined\n      };\n\n      var createParameterTypeElem = function(type) {\n        return createElement(type, bo, bpmnFactory);\n      };\n\n      var parameterType = values.parameterType;\n\n      if (parameterType === 'script') {\n        properties.definition = createParameterTypeElem('camunda:Script');\n      }\n      else if (parameterType === 'list') {\n        properties.definition = createParameterTypeElem('camunda:List');\n      }\n      else if (parameterType === 'map') {\n        properties.definition = createParameterTypeElem('camunda:Map');\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, properties);\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n\n  // parameter value (type = text) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textBox({\n    id : idPrefix + 'parameterType-text',\n    label : translate('Value'),\n    modelProperty: 'value',\n    get: function(element, node) {\n      return {\n        value: (getSelected(element, node) || {}).value\n      };\n    },\n\n    set: function(element, values, node) {\n      var param = getSelected(element, node);\n      values.value = values.value || undefined;\n      return cmdHelper.updateBusinessObject(element, param, values);\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && !bo.definition;\n    }\n\n  }));\n\n\n  // parameter value (type = script) ///////////////////////////////////////////////////////\n  var script = scriptImplementation('scriptFormat', 'value', true, translate);\n  entries.push({\n    id: idPrefix + 'parameterType-script',\n    html: '<div data-show=\"isScript\">' +\n            script.template +\n          '</div>',\n    get: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition) ? script.get(element, bo.definition) : {};\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelected(element, node);\n      var update = script.set(element, values);\n      return cmdHelper.updateBusinessObject(element, bo.definition, update);\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition) ? script.validate(element, bo.definition) : {};\n    },\n\n    isScript: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition);\n    },\n\n    script: script\n\n  });\n\n\n  // parameter value (type = list) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.table({\n    id: idPrefix + 'parameterType-list',\n    modelProperties: [ 'value' ],\n    labels: [ translate('Value') ],\n    addLabel: translate('Add Value'),\n\n    getElements: function(element, node) {\n      var bo = getSelected(element, node);\n\n      if (bo && isList(bo.definition)) {\n        return bo.definition.items;\n      }\n\n      return [];\n    },\n\n    updateElement: function(element, values, node, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n      return cmdHelper.updateBusinessObject(element, item, values);\n    },\n\n    addElement: function(element, node) {\n      var bo = getSelected(element, node);\n      var newValue = createElement('camunda:Value', bo.definition, bpmnFactory, { value: undefined });\n      return cmdHelper.addElementsTolist(element, bo.definition, 'items', [ newValue ]);\n    },\n\n    removeElement: function(element, node, idx) {\n      var bo = getSelected(element, node);\n      return cmdHelper.removeElementsFromList(element, bo.definition, 'items', null, [ bo.definition.items[idx] ]);\n    },\n\n    editable: function(element, node, prop, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n      return !isMap(item) && !isList(item) && !isScript(item);\n    },\n\n    setControlValue: function(element, node, input, prop, value, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n\n      if (!isMap(item) && !isList(item) && !isScript(item)) {\n        input.value = value;\n      } else {\n        input.value = typeInfo[item.$type].label;\n      }\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && bo.definition && isList(bo.definition);\n    }\n\n  }));\n\n\n  // parameter value (type = map) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.table({\n    id: idPrefix + 'parameterType-map',\n    modelProperties: [ 'key', 'value' ],\n    labels: [ translate('Key'), translate('Value') ],\n    addLabel: translate('Add Entry'),\n\n    getElements: function(element, node) {\n      var bo = getSelected(element, node);\n\n      if (bo && isMap(bo.definition)) {\n        return bo.definition.entries;\n      }\n\n      return [];\n    },\n\n    updateElement: function(element, values, node, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n\n      if (isMap(entry.definition) || isList(entry.definition) || isScript(entry.definition)) {\n        values = {\n          key: values.key\n        };\n      }\n\n      return cmdHelper.updateBusinessObject(element, entry, values);\n    },\n\n    addElement: function(element, node) {\n      var bo = getSelected(element, node);\n      var newEntry = createElement('camunda:Entry', bo.definition, bpmnFactory, { key: undefined, value: undefined });\n      return cmdHelper.addElementsTolist(element, bo.definition, 'entries', [ newEntry ]);\n    },\n\n    removeElement: function(element, node, idx) {\n      var bo = getSelected(element, node);\n      return cmdHelper.removeElementsFromList(element, bo.definition, 'entries', null, [ bo.definition.entries[idx] ]);\n    },\n\n    editable: function(element, node, prop, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n      return prop === 'key' || (!isMap(entry.definition) && !isList(entry.definition) && !isScript(entry.definition));\n    },\n\n    setControlValue: function(element, node, input, prop, value, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n\n      if (prop === 'key' || (!isMap(entry.definition) && !isList(entry.definition) && !isScript(entry.definition))) {\n        input.value = value;\n      } else {\n        input.value = typeInfo[entry.definition.$type].label;\n      }\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && bo.definition && isMap(bo.definition);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar inputOutputParameter = require('./implementation/InputOutputParameter');\n\nvar assign = require('lodash/assign');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  group.entries = group.entries.concat(inputOutputParameter(element, bpmnFactory, assign({}, options), translate));\n\n};\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Merges the function metadata of `source` into `data`.\n *\n * Merging metadata reduces the number of wrappers used to invoke a function.\n * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n * may be applied regardless of execution order. Methods like `_.ary` and\n * `_.rearg` modify function arguments, making the order in which they are\n * executed important, preventing the merging of metadata. However, we make\n * an exception for a safe combined case where curried functions have `_.ary`\n * and or `_.rearg` applied.\n *\n * @private\n * @param {Array} data The destination metadata.\n * @param {Array} source The source metadata.\n * @returns {Array} Returns `data`.\n */\nfunction mergeData(data, source) {\n  var bitmask = data[1],\n      srcBitmask = source[1],\n      newBitmask = bitmask | srcBitmask,\n      isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n  var isCombo =\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n    ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n  // Exit early if metadata can't be merged.\n  if (!(isCommon || isCombo)) {\n    return data;\n  }\n  // Use source `thisArg` if available.\n  if (srcBitmask & WRAP_BIND_FLAG) {\n    data[2] = source[2];\n    // Set when currying a bound function.\n    newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n  }\n  // Compose partial arguments.\n  var value = source[3];\n  if (value) {\n    var partials = data[3];\n    data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n    data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n  }\n  // Compose partial right arguments.\n  value = source[5];\n  if (value) {\n    partials = data[5];\n    data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n    data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n  }\n  // Use source `argPos` if available.\n  value = source[7];\n  if (value) {\n    data[7] = value;\n  }\n  // Use source `ary` if it's smaller.\n  if (srcBitmask & WRAP_ARY_FLAG) {\n    data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n  }\n  // Use source `arity` if one is not provided.\n  if (data[9] == null) {\n    data[9] = source[9];\n  }\n  // Use source `func` and merge bitmasks.\n  data[0] = source[0];\n  data[1] = newBitmask;\n\n  return data;\n}\n\nmodule.exports = mergeData;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject,\n      hideResultVariable = options.hideResultVariable,\n      id = options.id || 'resultVariable';\n\n\n  var resultVariableEntry = entryFactory.textField({\n    id: id,\n    label: translate('Result Variable'),\n    modelProperty: 'resultVariable',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { resultVariable: bo.get('camunda:resultVariable') };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n\n      var resultVariable = values.resultVariable || undefined;\n\n      var props = {\n        'camunda:resultVariable': resultVariable\n      };\n\n      if (is(bo, 'camunda:DmnCapable') && !resultVariable) {\n        props = assign({ 'camunda:mapDecisionResult': 'resultList' }, props);\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n    },\n\n    hidden: function(element, node) {\n      if (typeof hideResultVariable === 'function') {\n        return hideResultVariable.apply(resultVariableEntry, arguments);\n      }\n    }\n\n  });\n\n  return [ resultVariableEntry ];\n\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar has = require('../internals/has');\n\nvar defineProperty = Object.defineProperty;\nvar cache = {};\n\nvar thrower = function (it) { throw it; };\n\nmodule.exports = function (METHOD_NAME, options) {\n  if (has(cache, METHOD_NAME)) return cache[METHOD_NAME];\n  if (!options) options = {};\n  var method = [][METHOD_NAME];\n  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n  var argument0 = has(options, 0) ? options[0] : thrower;\n  var argument1 = has(options, 1) ? options[1] : undefined;\n\n  return cache[METHOD_NAME] = !!method && !fails(function () {\n    if (ACCESSORS && !DESCRIPTORS) return true;\n    var O = { length: -1 };\n\n    if (ACCESSORS) defineProperty(O, 1, { enumerable: true, get: thrower });\n    else O[1] = 1;\n\n    method.call(O, argument0, argument1);\n  });\n};\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'camunda:Initiator') && !is(element.parent, 'bpmn:SubProcess')) {\n    group.entries.push(entryFactory.textField({\n      id: 'initiator',\n      label: translate('Initiator'),\n      modelProperty: 'initiator'\n    }));\n  }\n};\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper'),\n    error = require('./implementation/ErrorEventDefinition');\n\nvar forEach = require('lodash/forEach');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var errorEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(errorEvents, function(event) {\n    if (is(element, event)) {\n\n      var errorEventDefinition = eventDefinitionHelper.getErrorEventDefinition(element);\n\n      if (errorEventDefinition) {\n        var isCatchingErrorEvent = is(element, 'bpmn:StartEvent') || is (element, 'bpmn:BoundaryEvent');\n\n        var showErrorCodeVariable = isCatchingErrorEvent,\n            showErrorMessageVariable = isCatchingErrorEvent;\n\n        error(\n          group,\n          element,\n          bpmnFactory,\n          errorEventDefinition,\n          showErrorCodeVariable,\n          showErrorMessageVariable,\n          translate);\n      }\n    }\n  });\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","'use strict';\n\nvar replace = String.prototype.replace;\nvar percentTwenties = /%20/g;\n\nmodule.exports = {\n    'default': 'RFC3986',\n    formatters: {\n        RFC1738: function (value) {\n            return replace.call(value, percentTwenties, '+');\n        },\n        RFC3986: function (value) {\n            return value;\n        }\n    },\n    RFC1738: 'RFC1738',\n    RFC3986: 'RFC3986'\n};\n","var identity = require('./identity'),\n    metaMap = require('./_metaMap');\n\n/**\n * The base implementation of `setData` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar baseSetData = !metaMap ? identity : function(func, data) {\n  metaMap.set(func, data);\n  return func;\n};\n\nmodule.exports = baseSetData;\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks that no implicit split is modeled\n * starting from a task.\n *\n * users should model the parallel splitting gateway\n * explicitly instead.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Event'\n    ])) {\n      return;\n    }\n\n    const outgoing = node.outgoing || [];\n\n    const outgoingWithoutCondition = outgoing.filter((flow) => {\n      return !hasCondition(flow) && !isDefaultFlow(node, flow);\n    });\n\n    if (outgoingWithoutCondition.length > 1) {\n      reporter.report(node.id, 'Flow splits implicitly');\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////////////////\n\nfunction hasCondition(flow) {\n  return !!flow.conditionExpression;\n}\n\nfunction isDefaultFlow(node, flow) {\n  return node['default'] === flow;\n}","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var bind = require('../internals/function-bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","/**\n * Gets the number of `placeholder` occurrences in `array`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} placeholder The placeholder to search for.\n * @returns {number} Returns the placeholder count.\n */\nfunction countHolders(array, placeholder) {\n  var length = array.length,\n      result = 0;\n\n  while (length--) {\n    if (array[length] === placeholder) {\n      ++result;\n    }\n  }\n  return result;\n}\n\nmodule.exports = countHolders;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && bo.get('processRef')) {\n    var versionTagEntry = entryFactory.textField({\n      id: 'versionTag',\n      label: translate('Version Tag'),\n      modelProperty: 'versionTag'\n    });\n\n    // in participants we have to change the default behavior of set and get\n    if (is(element, 'bpmn:Participant')) {\n      versionTagEntry.get = function(element) {\n        var processBo = bo.get('processRef');\n\n        return {\n          versionTag: processBo.get('camunda:versionTag')\n        };\n      };\n\n      versionTagEntry.set = function(element, values) {\n        var processBo = bo.get('processRef');\n\n        return cmdHelper.updateBusinessObject(element, processBo, {\n          'camunda:versionTag': values.versionTag || undefined\n        });\n      };\n    }\n\n    group.entries.push(versionTagEntry);\n\n  }\n};\n","'use strict';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A component that decides upon the visibility / editable\n * state of properties in the properties panel.\n *\n * Implementors must subclass this component and override\n * {@link PropertiesActivator#isEntryVisible} and\n * {@link PropertiesActivator#isPropertyEditable} to provide\n * custom behavior.\n *\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Number} [priority] at which priority to hook into the activation\n */\nfunction PropertiesActivator(eventBus, priority) {\n  var self = this;\n\n  priority = priority || DEFAULT_PRIORITY;\n\n  eventBus.on('propertiesPanel.isEntryVisible', priority, function(e) {\n    return self.isEntryVisible(e.entry, e.element);\n  });\n\n  eventBus.on('propertiesPanel.isPropertyEditable', priority, function(e) {\n    return self.isPropertyEditable(e.entry, e.propertyName, e.element);\n  });\n}\n\nPropertiesActivator.$inject = [ 'eventBus' ];\n\nmodule.exports = PropertiesActivator;\n\n\n/**\n * Should the given entry be visible for the specified element.\n *\n * @method  PropertiesActivator#isEntryVisible\n *\n * @param {EntryDescriptor} entry\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isEntryVisible = function(entry, element) {\n  return true;\n};\n\n/**\n * Should the given property be editable for the specified element\n *\n * @method  PropertiesActivator#isPropertyEditable\n *\n * @param {EntryDescriptor} entry\n * @param {String} propertyName\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isPropertyEditable = function(entry, propertyName, element) {\n  return true;\n};","'use strict';\n\nvar properties = require('./implementation/Properties'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var propertiesEntry = properties(element, bpmnFactory, {\n    id: 'properties',\n    modelProperties: [ 'name', 'value' ],\n    labels: [ translate('Name'), translate('Value') ],\n\n    getParent: function(element, node, bo) {\n      return bo.extensionElements;\n    },\n\n    createParent: function(element, bo) {\n      var parent = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n      var cmd = cmdHelper.updateBusinessObject(element, bo, { extensionElements: parent });\n      return {\n        cmd: cmd,\n        parent: parent\n      };\n    }\n  }, translate);\n\n  if (propertiesEntry) {\n    group.entries.push(propertiesEntry);\n  }\n\n};\n","/** Used to match wrap detail comments. */\nvar reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n    reSplitDetails = /,? & /;\n\n/**\n * Extracts wrapper details from the `source` body comment.\n *\n * @private\n * @param {string} source The source to inspect.\n * @returns {Array} Returns the wrapper details.\n */\nfunction getWrapDetails(source) {\n  var match = source.match(reWrapDetails);\n  return match ? match[1].split(reSplitDetails) : [];\n}\n\nmodule.exports = getWrapDetails;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n","const disallowNodeType = require('./helper').disallowNodeType;\n\nmodule.exports = disallowNodeType('bpmn:ComplexGateway');","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var externalTaskPriorityEntry = entryFactory.textField({\n    id: 'externalTaskPriority',\n    label: translate('Task Priority'),\n    modelProperty: 'taskPriority',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        taskPriority: bo.get('camunda:taskPriority')\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:taskPriority': values.taskPriority || undefined\n      });\n    }\n\n  });\n\n  return [ externalTaskPriorityEntry ];\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domQuery = require('min-dom').query;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textField = function(options, defaultParameters) {\n\n  // Default action for the button next to the input-field\n  var defaultButtonAction = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n    input.value = '';\n\n    return true;\n  };\n\n  // default method to determine if the button should be visible\n  var defaultButtonShow = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n\n    return input.value !== '';\n  };\n\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      dataValueLabel = options.dataValueLabel,\n      buttonLabel = (options.buttonLabel || 'X'),\n      actionName = (typeof options.buttonAction != 'undefined') ? options.buttonAction.name : 'clear',\n      actionMethod = (typeof options.buttonAction != 'undefined') ? options.buttonAction.method : defaultButtonAction,\n      showName = (typeof options.buttonShow != 'undefined') ? options.buttonShow.name : 'canClear',\n      showMethod = (typeof options.buttonShow != 'undefined') ? options.buttonShow.method : defaultButtonShow,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n      (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n      (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n      (dataValueLabel ? 'data-value=\"' + escapeHTML(dataValueLabel) + '\"' : '') + '>'+ escapeHTML(label) +'</label>' +\n    '<div class=\"bpp-field-wrapper\" ' +\n      (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n      (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n      '>' +\n      '<input id=\"camunda-' + escapeHTML(resource.id) + '\" type=\"text\" name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n        (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n        (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n        ' />' +\n      '<button class=\"' + escapeHTML(actionName) + '\" data-action=\"' + escapeHTML(actionName) + '\" data-show=\"' + escapeHTML(showName) + '\" ' +\n        (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n        (canBeHidden ? ' data-show=\"isHidden\"' : '') + '>' +\n        '<span>' + escapeHTML(buttonLabel) + '</span>' +\n      '</button>' +\n    '</div>';\n\n  // add description below text input entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource[actionName] = actionMethod;\n  resource[showName] = showMethod;\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-textfield'];\n\n  return resource;\n};\n\nmodule.exports = textField;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var getValue = function(businessObject) {\n    return function(element) {\n      var documentations = businessObject && businessObject.get('documentation'),\n          text = (documentations && documentations.length > 0) ? documentations[0].text : '';\n\n      return { documentation: text };\n    };\n  };\n\n  var setValue = function(businessObject) {\n    return function(element, values) {\n      var newObjectList = [];\n\n      if (typeof values.documentation !== 'undefined' && values.documentation !== '') {\n        newObjectList.push(bpmnFactory.create('bpmn:Documentation', {\n          text: values.documentation\n        }));\n      }\n\n      return cmdHelper.setList(element, businessObject, 'documentation', newObjectList);\n    };\n  };\n\n  // Element Documentation\n  var elementDocuEntry = entryFactory.textBox({\n    id: 'documentation',\n    label: translate('Element Documentation'),\n    modelProperty: 'documentation'\n  });\n\n  elementDocuEntry.set = setValue(getBusinessObject(element));\n\n  elementDocuEntry.get = getValue(getBusinessObject(element));\n\n  group.entries.push(elementDocuEntry);\n\n\n  var processRef;\n\n  // Process Documentation when having a Collaboration Diagram\n  if (is(element, 'bpmn:Participant')) {\n\n    processRef = getBusinessObject(element).processRef;\n\n    // do not show for collapsed Pools/Participants\n    if (processRef) {\n      var processDocuEntry = entryFactory.textBox({\n        id: 'process-documentation',\n        label: translate('Process Documentation'),\n        modelProperty: 'documentation'\n      });\n\n      processDocuEntry.set = setValue(processRef);\n\n      processDocuEntry.get = getValue(processRef);\n\n      group.entries.push(processDocuEntry);\n    }\n  }\n\n};\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isEventSubProcess = require('bpmn-js/lib/util/DiUtil').isEventSubProcess;\n\nmodule.exports = function(group, element, bpmnFactory, conditionalEventDefinition, elementRegistry, translate) {\n\n  var getValue = function(modelProperty) {\n    return function(element) {\n      var modelPropertyValue = conditionalEventDefinition.get('camunda:' + modelProperty);\n      var value = {};\n\n      value[modelProperty] = modelPropertyValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values) {\n      var props = {};\n\n      props['camunda:' + modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, conditionalEventDefinition, props);\n    };\n  };\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableName',\n    label: translate('Variable Name'),\n    modelProperty : 'variableName',\n\n    get: getValue('variableName'),\n    set: setValue('variableName')\n  }));\n\n  var isConditionalStartEvent =\n    is(element, 'bpmn:StartEvent') && !isEventSubProcess(element.parent);\n\n  if (!isConditionalStartEvent) {\n    group.entries.push(entryFactory.textField({\n      id: 'variableEvent',\n      label: translate('Variable Event'),\n      description: translate('Specify more than one variable change event as a comma separated list.'),\n      modelProperty : 'variableEvent',\n\n      get: getValue('variableEvent'),\n      set: setValue('variableEvent')\n    }));\n  }\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * Create a checker that disallows the given element type.\n *\n * @param {String} type\n *\n * @return {Function} ruleImpl\n */\nfunction disallowNodeType(type) {\n\n  return function() {\n\n    function check(node, reporter) {\n\n      if (is(node, type)) {\n        reporter.report(node.id, 'Element has disallowed type <' + type + '>');\n      }\n    }\n\n    return {\n      check\n    };\n\n  };\n\n}\n\nmodule.exports.disallowNodeType = disallowNodeType;","'use strict';\n\nvar elementHelper = require('../helper/ElementHelper');\n\n/**\n * A handler capable of creating a new element under a provided parent\n * and updating / creating a reference to it in one atomic action.\n *\n * @class\n * @constructor\n */\nfunction CreateAndReferenceElementHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nCreateAndReferenceElementHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = CreateAndReferenceElementHandler;\n\n\n// api ////////////////////\n\n/**\n * Creates a new element under a provided parent and updates / creates a reference to it in\n * one atomic action.\n *\n * @method  CreateAndReferenceElementHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element which is the context for the reference\n * @param {moddle.referencingObject} context.referencingObject the object which creates the reference\n * @param {String} context.referenceProperty the property of the referencingObject which makes the reference\n * @param {moddle.newObject} context.newObject the new object to add\n * @param {moddle.newObjectContainer} context.newObjectContainer the container for the new object\n *\n * @returns {Array<djs.mode.Base>} the updated element\n */\nCreateAndReferenceElementHandler.prototype.execute = function(context) {\n\n  var referencingObject = ensureNotNull(context.referencingObject, 'referencingObject'),\n      referenceProperty = ensureNotNull(context.referenceProperty, 'referenceProperty'),\n      newObject = ensureNotNull(context.newObject, 'newObject'),\n      newObjectContainer = ensureNotNull(context.newObjectContainer, 'newObjectContainer'),\n      newObjectParent = ensureNotNull(context.newObjectParent, 'newObjectParent'),\n      changed = [ context.element ]; // this will not change any diagram-js elements\n\n  // create new object\n  var referencedObject = elementHelper\n    .createElement(newObject.type, newObject.properties, newObjectParent, this._bpmnFactory);\n  context.referencedObject = referencedObject;\n\n  // add to containing list\n  newObjectContainer.push(referencedObject);\n\n  // adjust reference attribute\n  context.previousReference = referencingObject[referenceProperty];\n  referencingObject[referenceProperty] = referencedObject;\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateAndReferenceElementHandler#revert\n *\n * @param {Object} context\n *\n * @returns {djs.mode.Base} the updated element\n */\nCreateAndReferenceElementHandler.prototype.revert = function(context) {\n\n  var referencingObject = context.referencingObject,\n      referenceProperty = context.referenceProperty,\n      previousReference = context.previousReference,\n      referencedObject = context.referencedObject,\n      newObjectContainer = context.newObjectContainer;\n\n  // reset reference\n  referencingObject.set(referenceProperty, previousReference);\n\n  // remove new element\n  newObjectContainer.splice(newObjectContainer.indexOf(referencedObject), 1);\n\n  return context.changed;\n};\n\n\n\n// helpers //////////////\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + ' required');\n  }\n  return prop;\n}\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks whether not more than one blank start event\n * exists per scope.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:FlowElementsContainer')) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    const blankStartEvents = flowElements.filter(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      return eventDefinitions.length === 0;\n    });\n\n    if (blankStartEvents.length > 1) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' has multiple blank start events');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Editor.vue?vue&type=style&index=0&lang=css&\"","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    copyArray = require('./_copyArray');\n\n/**\n * Creates a clone of `wrapper`.\n *\n * @private\n * @param {Object} wrapper The wrapper to clone.\n * @returns {Object} Returns the cloned wrapper.\n */\nfunction wrapperClone(wrapper) {\n  if (wrapper instanceof LazyWrapper) {\n    return wrapper.clone();\n  }\n  var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n  result.__actions__ = copyArray(wrapper.__actions__);\n  result.__index__  = wrapper.__index__;\n  result.__values__ = wrapper.__values__;\n  return result;\n}\n\nmodule.exports = wrapperClone;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar filter = require('lodash/filter');\n\nvar extensionElementsHelper = require('../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper');\n\nvar extensionElementsEntry = require('./implementation/ExtensionElements');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  */\nfunction getCamundaInOutMappings(element, type) {\n  var bo = getBusinessObject(element);\n\n  var signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(bo);\n\n  return extensionElementsHelper.getExtensionElements(signalEventDefinition || bo, type) || [];\n}\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  * with source or sourceExpression attribute\n  */\nfunction getVariableMappings(element, type) {\n  var camundaMappings = getCamundaInOutMappings(element, type);\n\n  return filter(camundaMappings, function(mapping) {\n    return !mapping.businessKey;\n  });\n}\n\nfunction getInOutType(mapping) {\n  var inOutType = 'source';\n\n  if (mapping.variables === 'all') {\n    inOutType = 'variables';\n  }\n  else if (typeof mapping.source !== 'undefined') {\n    inOutType = 'source';\n  }\n  else if (typeof mapping.sourceExpression !== 'undefined') {\n    inOutType = 'sourceExpression';\n  }\n\n  return inOutType;\n}\n\nvar CAMUNDA_IN_EXTENSION_ELEMENT = 'camunda:In',\n    CAMUNDA_OUT_EXTENSION_ELEMENT = 'camunda:Out';\n\nvar WHITESPACE_REGEX = /\\s/;\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inOutTypeOptions = [\n    {\n      name: translate('Source'),\n      value: 'source'\n    },\n    {\n      name: translate('Source Expression'),\n      value: 'sourceExpression'\n    },\n    {\n      name: translate('All'),\n      value: 'variables'\n    }\n  ];\n\n  var signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(element);\n\n  if (!is(element, 'camunda:CallActivity') && !signalEventDefinition) {\n    return;\n  }\n\n  if (signalEventDefinition && !(isAny(element, [\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:EndEvent'\n  ]))) {\n    return;\n  }\n\n  var isSelected = function(element, node) {\n    return !!getSelected(element, node);\n  };\n\n  var getSelected = function(element, node) {\n    var parentNode = node.parentNode;\n    var selection = inEntry.getSelected(element, parentNode);\n\n    var parameter = getVariableMappings(element, CAMUNDA_IN_EXTENSION_ELEMENT)[selection.idx];\n\n    if (!parameter && outEntry) {\n      selection = outEntry.getSelected(element, parentNode);\n      parameter = getVariableMappings(element, CAMUNDA_OUT_EXTENSION_ELEMENT)[selection.idx];\n    }\n\n    return parameter;\n  };\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx) {\n      var variableMappings = getVariableMappings(element, type);\n      var mappingValue = variableMappings[idx];\n      var label = (mappingValue.target || '<undefined>') + ' := ';\n      var mappingType = getInOutType(mappingValue);\n\n      if (mappingType === 'variables') {\n        label = 'all';\n      }\n      else if (mappingType === 'source') {\n        label = label + (mappingValue.source || '<empty>');\n      }\n      else if (mappingType === 'sourceExpression') {\n        label = label + (mappingValue.sourceExpression || '<empty>');\n      } else {\n        label = label + '<empty>';\n      }\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(type) {\n    return function(element, extensionElements, value) {\n      var newElem = elementHelper.createElement(type, { source: '' }, extensionElements, bpmnFactory);\n\n      return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newElem ]);\n    };\n  };\n\n  var removeElement = function(type) {\n    return function(element, extensionElements, value, idx) {\n      var variablesMappings= getVariableMappings(element, type);\n      var mapping = variablesMappings[idx];\n\n      if (mapping) {\n        return extensionElementsHelper\n          .removeEntry(signalEventDefinition || getBusinessObject(element), element, mapping);\n      }\n    };\n  };\n\n  // in mapping for source and sourceExpression ///////////////////////////////////////////////////////////////\n\n  var inEntry = extensionElementsEntry(element, bpmnFactory, {\n    id: 'variableMapping-in',\n    label: translate('In Mapping'),\n    modelProperty: 'source',\n    prefix: 'In',\n    idGeneration: false,\n    resizable: true,\n    businessObject: signalEventDefinition || getBusinessObject(element),\n\n    createExtensionElement: newElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n    removeExtensionElement: removeElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n\n    getExtensionElements: function(element) {\n      return getVariableMappings(element, CAMUNDA_IN_EXTENSION_ELEMENT);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outEntry && outEntry.deselect(element, node.parentNode);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(CAMUNDA_IN_EXTENSION_ELEMENT)\n  });\n  group.entries.push(inEntry);\n\n  // out mapping for source and sourceExpression ///////////////////////////////////////////////////////\n\n  if (!signalEventDefinition) {\n    var outEntry = extensionElementsEntry(element, bpmnFactory, {\n      id: 'variableMapping-out',\n      label: translate('Out Mapping'),\n      modelProperty: 'source',\n      prefix: 'Out',\n      idGeneration: false,\n      resizable: true,\n\n      createExtensionElement: newElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n      removeExtensionElement: removeElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n\n      getExtensionElements: function(element) {\n        return getVariableMappings(element, CAMUNDA_OUT_EXTENSION_ELEMENT);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        inEntry.deselect(element, node.parentNode);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(CAMUNDA_OUT_EXTENSION_ELEMENT)\n    });\n    group.entries.push(outEntry);\n  }\n\n  // label for selected mapping ///////////////////////////////////////////////////////\n\n  group.entries.push(entryFactory.label({\n    id: 'variableMapping-typeLabel',\n    get: function(element, node) {\n      var mapping = getSelected(element, node);\n\n      var value = '';\n      if (is(mapping, CAMUNDA_IN_EXTENSION_ELEMENT)) {\n        value = translate('In Mapping');\n      }\n      else if (is(mapping, CAMUNDA_OUT_EXTENSION_ELEMENT)) {\n        value = translate('Out Mapping');\n      }\n\n      return {\n        label: value\n      };\n    },\n\n    showLabel: function(element, node) {\n      return isSelected(element, node);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'variableMapping-inOutType',\n    label: translate('Type'),\n    selectOptions: inOutTypeOptions,\n    modelProperty: 'inOutType',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n      return {\n        inOutType: getInOutType(mapping)\n      };\n    },\n    set: function(element, values, node) {\n      var inOutType = values.inOutType;\n\n      var props = {\n        'source' : undefined,\n        'sourceExpression' : undefined,\n        'variables' : undefined\n      };\n\n      if (inOutType === 'source') {\n        props.source = '';\n      }\n      else if (inOutType === 'sourceExpression') {\n        props.sourceExpression = '';\n      }\n      else if (inOutType === 'variables') {\n        props.variables = 'all';\n        props.target = undefined;\n      }\n\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-source',\n    dataValueLabel: 'sourceLabel',\n    modelProperty: 'source',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n\n      var label = '';\n      var inOutType = getInOutType(mapping);\n      if (inOutType === 'source') {\n        label = translate('Source');\n      }\n      else if (inOutType === 'sourceExpression') {\n        label = translate('Source Expression');\n      }\n\n      return {\n        source: mapping[inOutType],\n        sourceLabel: label\n      };\n    },\n    set: function(element, values, node) {\n      values.source = values.source || undefined;\n\n      var mapping = getSelected(element, node);\n      var inOutType = getInOutType(mapping);\n\n      var props = {};\n      props[inOutType] = values.source || '';\n\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    // one of both (source or sourceExpression) must have a value to make\n    // the configuration easier and more understandable\n    // it is not engine conform\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        if (!values.source) {\n          validation.source =\n          validation.source = values.sourceLabel ?\n            translate('Mapping must have a {value}', { value: values.sourceLabel.toLowerCase() }) :\n            translate('Mapping must have a value');\n        }\n\n        var inOutType = getInOutType(mapping);\n\n        if (WHITESPACE_REGEX.test(values.source) && inOutType !== 'sourceExpression') {\n          validation.source = translate('{label} must not contain whitespace', { label: values.sourceLabel });\n        }\n      }\n\n      return validation;\n    },\n    hidden: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-target',\n    label: translate('Target'),\n    modelProperty: 'target',\n    get: function(element, node) {\n      return {\n        target: (getSelected(element, node) || {}).target\n      };\n    },\n    set: function(element, values, node) {\n      values.target = values.target || undefined;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        var mappingType = getInOutType(mapping);\n\n        if (!values.target && mappingType !== 'variables') {\n          validation.target = translate('Mapping must have a target');\n        }\n\n        if (values.target\n          && WHITESPACE_REGEX.test(values.target)\n          && mappingType !== 'variables') {\n          validation.target = translate('Target must not contain whitespace');\n        }\n      }\n\n      return validation;\n    },\n    hidden: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'variableMapping-local',\n    label: translate('Local'),\n    modelProperty: 'local',\n    get: function(element, node) {\n      return {\n        local: (getSelected(element, node) || {}).local\n      };\n    },\n    set: function(element, values, node) {\n      values.local = values.local || false;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n  }));\n\n};\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that verifies that there exists no disconnected\n * flow elements, i.e. elements without incoming\n * _or_ outgoing sequence flows\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Gateway',\n      'bpmn:SubProcess',\n      'bpmn:Event'\n    ]) || node.triggeredByEvent) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n    const outgoing = node.outgoing || [];\n\n    if (!incoming.length && !outgoing.length) {\n      reporter.report(node.id, 'Element is not connected');\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks the presence of a label.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (isAny(node, [\n      'bpmn:ParallelGateway',\n      'bpmn:EventBasedGateway'\n    ])) {\n      return;\n    }\n\n    // ignore joining gateways\n    if (is(node, 'bpmn:Gateway') && !isForking(node)) {\n      return;\n    }\n\n    if (is(node, 'bpmn:BoundaryEvent')) {\n      return;\n    }\n\n    // ignore sub-processes\n    if (is(node, 'bpmn:SubProcess')) {\n      // TODO(nikku): better ignore expanded sub-processes only\n      return;\n    }\n\n    // ignore sequence flow without condition\n    if (is(node, 'bpmn:SequenceFlow') && !hasCondition(node)) {\n      return;\n    }\n\n    // ignore data objects and artifacts for now\n    if (isAny(node, [\n      'bpmn:FlowNode',\n      'bpmn:SequenceFlow',\n      'bpmn:Participant',\n      'bpmn:Lane'\n    ])) {\n\n      const name = (node.name || '').trim();\n\n      if (name.length === 0) {\n        reporter.report(node.id, 'Element is missing label/name');\n      }\n    }\n  }\n\n  return { check };\n};\n\n\n// helpers ////////////////////////\n\nfunction isForking(node) {\n  const outgoing = node.outgoing || [];\n\n  return outgoing.length > 1;\n}\n\nfunction hasCondition(node) {\n  return node.conditionExpression;\n}","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates an array that is the composition of partially applied arguments,\n * placeholders, and provided arguments into a single array of arguments.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to prepend to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgs(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersLength = holders.length,\n      leftIndex = -1,\n      leftLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(leftLength + rangeLength),\n      isUncurried = !isCurried;\n\n  while (++leftIndex < leftLength) {\n    result[leftIndex] = partials[leftIndex];\n  }\n  while (++argsIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[holders[argsIndex]] = args[argsIndex];\n    }\n  }\n  while (rangeLength--) {\n    result[leftIndex++] = args[argsIndex++];\n  }\n  return result;\n}\n\nmodule.exports = composeArgs;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the `this` binding\n * of `thisArg` and `partials` prepended to the arguments it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} partials The arguments to prepend to those provided to\n *  the new function.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createPartial(func, bitmask, thisArg, partials) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var argsIndex = -1,\n        argsLength = arguments.length,\n        leftIndex = -1,\n        leftLength = partials.length,\n        args = Array(leftLength + argsLength),\n        fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n    while (++leftIndex < leftLength) {\n      args[leftIndex] = partials[leftIndex];\n    }\n    while (argsLength--) {\n      args[leftIndex++] = arguments[++argsIndex];\n    }\n    return apply(fn, isBind ? thisArg : this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createPartial;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","'use strict';\n\nvar escapeHTML = require('./Utils').escapeHTML;\n\nvar domify = require('min-dom').domify,\n    domQuery = require('min-dom').query,\n    domQueryAll = require('min-dom').queryAll,\n    domRemove = require('min-dom').remove,\n    domClasses = require('min-dom').classes,\n    domClosest = require('min-dom').closest,\n    domAttr = require('min-dom').attr,\n    domDelegate = require('min-dom').delegate,\n    domMatches = require('min-dom').matches;\n\nvar forEach = require('lodash/forEach'),\n    filter = require('lodash/filter'),\n    get = require('lodash/get'),\n    keys = require('lodash/keys'),\n    isEmpty = require('lodash/isEmpty'),\n    isArray = require('lodash/isArray'),\n    xor = require('lodash/xor'),\n    debounce = require('lodash/debounce');\n\nvar updateSelection = require('selection-update');\n\nvar scrollTabs = require('scroll-tabs').default;\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar HIDE_CLASS = 'bpp-hidden';\nvar DEBOUNCE_DELAY = 300;\n\n\nfunction isToggle(node) {\n  return node.type === 'checkbox' || node.type === 'radio';\n}\n\nfunction isSelect(node) {\n  return node.type === 'select-one';\n}\n\nfunction isContentEditable(node) {\n  return domAttr(node, 'contenteditable');\n}\n\nfunction getPropertyPlaceholders(node) {\n  var selector = 'input[name], textarea[name], [data-value], [contenteditable]';\n  var placeholders = domQueryAll(selector, node);\n  if ((!placeholders || !placeholders.length) && domMatches(node, selector)) {\n    placeholders = [ node ];\n  }\n  return placeholders;\n}\n\n/**\n * Return all active form controls.\n * This excludes the invisible controls unless all is true\n *\n * @param {Element} node\n * @param {Boolean} [all=false]\n */\nfunction getFormControls(node, all) {\n  var controls = domQueryAll('input[name], textarea[name], select[name], [contenteditable]', node);\n\n  if (!controls || !controls.length) {\n    controls = domMatches(node, 'option') ? [ node ] : controls;\n  }\n\n  if (!all) {\n    controls = filter(controls, function(node) {\n      return !domClosest(node, '.' + HIDE_CLASS);\n    });\n  }\n\n  return controls;\n}\n\nfunction getFormControlValuesInScope(entryNode) {\n  var values = {};\n\n  var controlNodes = getFormControls(entryNode);\n\n  forEach(controlNodes, function(controlNode) {\n    var value = controlNode.value;\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    // take toggle state into account for radio / checkboxes\n    if (isToggle(controlNode)) {\n      if (controlNode.checked) {\n        if (!domAttr(controlNode, 'value')) {\n          value = true;\n        } else {\n          value = controlNode.value;\n        }\n      } else {\n        value = null;\n      }\n    } else\n    if (isContentEditable(controlNode)) {\n      value = controlNode.innerText;\n    }\n\n    if (value !== null) {\n      // return the actual value\n      // handle serialization in entry provider\n      // (ie. if empty string should be serialized or not)\n      values[name] = value;\n    }\n  });\n\n  return values;\n\n}\n\n/**\n * Extract input values from entry node\n *\n * @param  {DOMElement} entryNode\n * @returns {Object}\n */\nfunction getFormControlValues(entryNode) {\n\n  var values;\n\n  var listContainer = domQuery('[data-list-entry-container]', entryNode);\n  if (listContainer) {\n    values = [];\n    var listNodes = listContainer.children || [];\n    forEach(listNodes, function(listNode) {\n      values.push(getFormControlValuesInScope(listNode));\n    });\n  } else {\n    values = getFormControlValuesInScope(entryNode);\n  }\n\n  return values;\n}\n\n/**\n * Return true if the given form extracted value equals\n * to an old cached version.\n *\n * @param {Object} value\n * @param {Object} oldValue\n * @return {Boolean}\n */\nfunction valueEqual(value, oldValue) {\n\n  if (value && !oldValue) {\n    return false;\n  }\n\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    return value[key] === oldValue[key];\n  });\n}\n\n/**\n * Return true if the given form extracted value(s)\n * equal an old cached version.\n *\n * @param {Array<Object>|Object} values\n * @param {Array<Object>|Object} oldValues\n * @return {Boolean}\n */\nfunction valuesEqual(values, oldValues) {\n\n  if (isArray(values)) {\n\n    if (values.length !== oldValues.length) {\n      return false;\n    }\n\n    return values.every(function(v, idx) {\n      return valueEqual(v, oldValues[idx]);\n    });\n  }\n\n  return valueEqual(values, oldValues);\n}\n\n/**\n * Return a mapping of { id: entry } for all entries in the given groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractEntries(tabs) {\n  return keyBy(flattenDeep(map(flattenDeep(map(tabs, 'groups')), 'entries')), 'id');\n}\n\n/**\n * Return a mapping of { id: group } for all groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractGroups(tabs) {\n  return keyBy(flattenDeep(map(tabs, 'groups')), 'id');\n}\n\n/**\n * A properties panel implementation.\n *\n * To use it provide a `propertiesProvider` component that knows\n * about which properties to display.\n *\n * Properties edit state / visibility can be intercepted\n * via a custom {@link PropertiesActivator}.\n *\n * @class\n * @constructor\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {PropertiesProvider} propertiesProvider\n * @param {Canvas} canvas\n * @param {CommandStack} commandStack\n */\nfunction PropertiesPanel(config, eventBus, modeling, propertiesProvider, commandStack, canvas) {\n\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._commandStack = commandStack;\n  this._canvas = canvas;\n  this._propertiesProvider = propertiesProvider;\n\n  this._init(config);\n}\n\nPropertiesPanel.$inject = [\n  'config.propertiesPanel',\n  'eventBus',\n  'modeling',\n  'propertiesProvider',\n  'commandStack',\n  'canvas'\n];\n\nmodule.exports = PropertiesPanel;\n\n\nPropertiesPanel.prototype._init = function(config) {\n\n  var canvas = this._canvas,\n      eventBus = this._eventBus;\n\n  var self = this;\n\n  /**\n   * Select the root element once it is added to the canvas\n   */\n  eventBus.on('root.added', function(e) {\n    var element = e.element;\n\n    if (isImplicitRoot(element)) {\n      return;\n    }\n\n    self.update(element);\n  });\n\n  eventBus.on('selection.changed', function(e) {\n    var newElement = e.newSelection[0];\n\n    var rootElement = canvas.getRootElement();\n\n    if (isImplicitRoot(rootElement)) {\n      return;\n    }\n\n    self.update(newElement);\n  });\n\n  // add / update tab-bar scrolling\n  eventBus.on([\n    'propertiesPanel.changed',\n    'propertiesPanel.resized'\n  ], function(event) {\n\n    var tabBarNode = domQuery('.bpp-properties-tab-bar', self._container);\n\n    if (!tabBarNode) {\n      return;\n    }\n\n    var scroller = scrollTabs.get(tabBarNode);\n\n    if (!scroller) {\n\n      // we did not initialize yet, do that\n      // now and make sure we select the active\n      // tab on scroll update\n      scroller = scrollTabs(tabBarNode, {\n        selectors: {\n          tabsContainer: '.bpp-properties-tabs-links',\n          tab: '.bpp-properties-tabs-links li',\n          ignore: '.bpp-hidden',\n          active: '.bpp-active'\n        }\n      });\n\n\n      scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n\n        var linkNode = domQuery('[data-tab-target]', newActiveNode);\n\n        var tabId = domAttr(linkNode, 'data-tab-target');\n\n        self.activateTab(tabId);\n      });\n    }\n\n    // react on tab changes and or tabContainer resize\n    // and make sure the active tab is shown completely\n    scroller.update();\n  });\n\n  eventBus.on('elements.changed', function(e) {\n\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      if (e.elements.indexOf(element) !== -1) {\n        self.update(element);\n      }\n    }\n  });\n\n  eventBus.on('elementTemplates.changed', function() {\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      self.update(element);\n    }\n  });\n\n  eventBus.on('diagram.destroy', function() {\n    self.detach();\n  });\n\n  this._container = domify('<div class=\"bpp-properties-panel\"></div>');\n\n  this._bindListeners(this._container);\n\n  if (config && config.parent) {\n    this.attachTo(config.parent);\n  }\n};\n\n\nPropertiesPanel.prototype.attachTo = function(parentNode) {\n\n  if (!parentNode) {\n    throw new Error('parentNode required');\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\n    parentNode = parentNode.get(0);\n  }\n\n  if (typeof parentNode === 'string') {\n    parentNode = domQuery(parentNode);\n  }\n\n  var container = this._container;\n\n  parentNode.appendChild(container);\n\n  this._emit('attach');\n};\n\nPropertiesPanel.prototype.detach = function() {\n\n  var container = this._container,\n      parentNode = container.parentNode;\n\n  if (!parentNode) {\n    return;\n  }\n\n  this._emit('detach');\n\n  parentNode.removeChild(container);\n};\n\n\n/**\n * Select the given tab within the properties panel.\n *\n * @param {Object|String} tab\n */\nPropertiesPanel.prototype.activateTab = function(tab) {\n\n  var tabId = typeof tab === 'string' ? tab : tab.id;\n\n  var current = this._current;\n\n  var panelNode = current.panel;\n\n  var allTabNodes = domQueryAll('.bpp-properties-tab', panelNode),\n      allTabLinkNodes = domQueryAll('.bpp-properties-tab-link', panelNode);\n\n  forEach(allTabNodes, function(tabNode) {\n\n    var currentTabId = domAttr(tabNode, 'data-tab');\n\n    domClasses(tabNode).toggle('bpp-active', tabId === currentTabId);\n  });\n\n  forEach(allTabLinkNodes, function(tabLinkNode) {\n\n    var tabLink = domQuery('[data-tab-target]', tabLinkNode),\n        currentTabId = domAttr(tabLink, 'data-tab-target');\n\n    domClasses(tabLinkNode).toggle('bpp-active', tabId === currentTabId);\n  });\n};\n\n/**\n * Update the DOM representation of the properties panel\n */\nPropertiesPanel.prototype.update = function(element) {\n  var current = this._current;\n\n  // no actual selection change\n  var needsCreate = true;\n\n  if (typeof element === 'undefined') {\n\n    // use RootElement of BPMN diagram to generate properties panel if no element is selected\n    element = this._canvas.getRootElement();\n  }\n\n  var newTabs = this._propertiesProvider.getTabs(element);\n\n  if (current && current.element === element) {\n    // see if we can reuse the existing panel\n\n    needsCreate = this._entriesChanged(current, newTabs);\n  }\n\n  if (needsCreate) {\n\n    if (current) {\n\n      // get active tab from the existing panel before remove it\n      var activeTabNode = domQuery('.bpp-properties-tab.bpp-active', current.panel);\n\n      var activeTabId;\n      if (activeTabNode) {\n        activeTabId = domAttr(activeTabNode, 'data-tab');\n      }\n\n      // remove old panel\n      domRemove(current.panel);\n    }\n\n    this._current = this._create(element, newTabs);\n\n    // activate the saved active tab from the remove panel or the first tab\n    (activeTabId) ? this.activateTab(activeTabId) : this.activateTab(this._current.tabs[0]);\n\n  }\n\n  if (this._current) {\n    // make sure correct tab contents are visible\n    this._updateActivation(this._current);\n\n  }\n\n  this._emit('changed');\n};\n\n\n/**\n * Returns true if one of two groups has different entries than the other.\n *\n * @param  {Object} current\n * @param  {Object} newTabs\n * @return {Boolean}\n */\nPropertiesPanel.prototype._entriesChanged = function(current, newTabs) {\n\n  var oldEntryIds = keys(current.entries),\n      newEntryIds = keys(extractEntries(newTabs));\n\n  return !isEmpty(xor(oldEntryIds, newEntryIds));\n};\n\nPropertiesPanel.prototype._emit = function(event) {\n  this._eventBus.fire('propertiesPanel.' + event, { panel: this, current: this._current });\n};\n\nPropertiesPanel.prototype._bindListeners = function(container) {\n\n  var self = this;\n\n  // handles a change for a given event\n  var handleChange = function handleChange(event) {\n\n    // see if we handle a change inside a [data-entry] element.\n    // if not, drop out\n    var inputNode = event.delegateTarget,\n        entryNode = domClosest(inputNode, '[data-entry]'),\n        entryId, entry;\n\n    // change from outside a [data-entry] element, simply ignore\n    if (!entryNode) {\n      return;\n    }\n\n    entryId = domAttr(entryNode, 'data-entry');\n    entry = self.getEntry(entryId);\n\n    var values = getFormControlValues(entryNode);\n\n    if (event.type === 'change') {\n\n      // - if the \"data-on-change\" attribute is present and a value is changed,\n      //   then the associated action is performed.\n      // - if the associated action returns \"true\" then an update to the business\n      //   object is done\n      // - if it does not return \"true\", then only the DOM content is updated\n      var onChangeAction = domAttr(inputNode, 'data-on-change');\n\n      if (onChangeAction) {\n        var isEntryDirty = self.executeAction(entry, entryNode, onChangeAction, event);\n\n        if (!isEntryDirty) {\n          return self.update(self._current.element);\n        }\n      }\n    }\n    self.applyChanges(entry, values, entryNode);\n    self.updateState(entry, entryNode);\n  };\n\n  // debounce update only elements that are target of key events,\n  // i.e. INPUT and TEXTAREA. SELECTs will trigger an immediate update anyway.\n  domDelegate.bind(container, 'input, textarea, [contenteditable]', 'input', debounce(handleChange, DEBOUNCE_DELAY));\n  domDelegate.bind(container, 'input, textarea, select, [contenteditable]', 'change', handleChange);\n\n  // paste as plain text only\n  domDelegate.bind(container, '[contenteditable]', 'paste', handlePaste);\n\n  function handlePaste(event) {\n    var text = (event.clipboardData || window.clipboardData).getData('text');\n    document.execCommand('insertText', false, text);\n\n    event.preventDefault();\n  }\n\n  // handle key events\n  domDelegate.bind(container, 'select', 'keydown', function(e) {\n\n    // DEL\n    if (e.keyCode === 46) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n\n  domDelegate.bind(container, '[data-action]', 'click', function onClick(event) {\n\n    // triggers on all inputs\n    var inputNode = event.delegateTarget,\n        entryNode = domClosest(inputNode, '[data-entry]');\n\n    var actionId = domAttr(inputNode, 'data-action'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, actionId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  });\n\n  function handleInput(event, element) {\n    // triggers on all inputs\n    var inputNode = event.delegateTarget;\n\n    var entryNode = domClosest(inputNode, '[data-entry]');\n\n    // only work on data entries\n    if (!entryNode) {\n      return;\n    }\n\n    var eventHandlerId = domAttr(inputNode, 'data-blur'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, eventHandlerId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  }\n\n  domDelegate.bind(container, '[data-blur]', 'blur', handleInput, true);\n\n  // make tab links interactive\n  domDelegate.bind(container, '.bpp-properties-tabs-links [data-tab-target]', 'click', function(event) {\n    event.preventDefault();\n\n    var delegateTarget = event.delegateTarget;\n\n    var tabId = domAttr(delegateTarget, 'data-tab-target');\n\n    // activate tab on link click\n    self.activateTab(tabId);\n  });\n\n};\n\nPropertiesPanel.prototype.updateState = function(entry, entryNode) {\n  this.updateShow(entry, entryNode);\n  this.updateDisable(entry, entryNode);\n};\n\n/**\n * Update the visibility of the entry node in the DOM\n */\nPropertiesPanel.prototype.updateShow = function(entry, node) {\n\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var showNodes = domQueryAll('[data-show]', node) || [];\n\n  forEach(showNodes, function(showNode) {\n\n    var expr = domAttr(showNode, 'data-show');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(showNode, '[data-scope]') || node;\n      var shouldShow = fn(current.element, node, showNode, scope) || false;\n      if (shouldShow) {\n        domClasses(showNode).remove(HIDE_CLASS);\n      } else {\n        domClasses(showNode).add(HIDE_CLASS);\n      }\n    }\n  });\n};\n\n/**\n * Evaluates a given function. If it returns true, then the\n * node is marked as \"disabled\".\n */\nPropertiesPanel.prototype.updateDisable = function(entry, node) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var nodes = domQueryAll('[data-disable]', node) || [];\n\n  forEach(nodes, function(currentNode) {\n    var expr = domAttr(currentNode, 'data-disable');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(currentNode, '[data-scope]') || node;\n      var shouldDisable = fn(current.element, node, currentNode, scope) || false;\n      domAttr(currentNode, 'disabled', shouldDisable ? '' : null);\n    }\n  });\n};\n\nPropertiesPanel.prototype.executeAction = function(entry, entryNode, actionId, event) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var fn = get(entry, actionId);\n  if (fn) {\n    var scopeNode = domClosest(event.target, '[data-scope]') || entryNode;\n    return fn.apply(entry, [ current.element, entryNode, event, scopeNode ]);\n  }\n};\n\n/**\n * Apply changes to the business object by executing a command\n */\nPropertiesPanel.prototype.applyChanges = function(entry, values, containerElement) {\n\n  var element = this._current.element;\n\n  // ensure we only update the model if we got dirty changes\n  if (valuesEqual(values, entry.oldValues)) {\n    return;\n  }\n\n  var command = entry.set(element, values, containerElement);\n\n  var commandToExecute;\n\n  if (isArray(command)) {\n    if (command.length) {\n      commandToExecute = {\n        cmd: 'properties-panel.multi-command-executor',\n        context: flattenDeep(command)\n      };\n    }\n  } else {\n    commandToExecute = command;\n  }\n\n  if (commandToExecute) {\n    this._commandStack.execute(commandToExecute.cmd, commandToExecute.context || { element : element });\n  } else {\n    this.update(element);\n  }\n};\n\n\n/**\n * apply validation errors in the DOM and show or remove an error message near the entry node.\n */\nPropertiesPanel.prototype.applyValidationErrors = function(validationErrors, entryNode) {\n\n  var valid = true;\n\n  var controlNodes = getFormControls(entryNode, true);\n\n  forEach(controlNodes, function(controlNode) {\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    var error = validationErrors && validationErrors[name];\n\n    var errorMessageNode = domQuery('.bpp-error-message', controlNode.parentNode);\n\n    if (error) {\n      valid = false;\n\n      if (!errorMessageNode) {\n        errorMessageNode = domify('<div></div>');\n\n        domClasses(errorMessageNode).add('bpp-error-message');\n\n        // insert errorMessageNode after controlNode\n        controlNode.parentNode.insertBefore(errorMessageNode, controlNode.nextSibling);\n      }\n\n      errorMessageNode.textContent = error;\n\n      domClasses(controlNode).add('invalid');\n    } else {\n      domClasses(controlNode).remove('invalid');\n\n      if (errorMessageNode) {\n        controlNode.parentNode.removeChild(errorMessageNode);\n      }\n    }\n  });\n\n  return valid;\n};\n\n\n/**\n * Check if the entry contains valid input\n */\nPropertiesPanel.prototype.validate = function(entry, values, entryNode) {\n  var self = this;\n\n  var current = this._current;\n\n  var valid = true;\n\n  entryNode = entryNode || domQuery('[data-entry=\"' + entry.id + '\"]', current.panel);\n\n  if (values instanceof Array) {\n    var listContainer = domQuery('[data-list-entry-container]', entryNode),\n        listEntryNodes = listContainer.children || [];\n\n    // create new elements\n    for (var i = 0; i < values.length; i++) {\n      var listValue = values[i];\n\n      if (entry.validateListItem) {\n\n        var validationErrors = entry.validateListItem(current.element, listValue, entryNode, i),\n            listEntryNode = listEntryNodes[i];\n\n        valid = self.applyValidationErrors(validationErrors, listEntryNode) && valid;\n      }\n    }\n  } else {\n    if (entry.validate) {\n      this.validationErrors = entry.validate(current.element, values, entryNode);\n\n      valid = self.applyValidationErrors(this.validationErrors, entryNode) && valid;\n    }\n  }\n\n  return valid;\n};\n\nPropertiesPanel.prototype.getEntry = function(id) {\n  return this._current && this._current.entries[id];\n};\n\nvar flattenDeep = require('lodash/flattenDeep'),\n    keyBy = require('lodash/keyBy'),\n    map = require('lodash/map');\n\nPropertiesPanel.prototype._create = function(element, tabs) {\n\n  if (!element) {\n    return null;\n  }\n\n  var containerNode = this._container;\n\n  var panelNode = this._createPanel(element, tabs);\n\n  containerNode.appendChild(panelNode);\n\n  var entries = extractEntries(tabs);\n  var groups = extractGroups(tabs);\n\n  return {\n    tabs: tabs,\n    groups: groups,\n    entries: entries,\n    element: element,\n    panel: panelNode\n  };\n};\n\n/**\n * Update variable parts of the entry node on element changes.\n *\n * @param {djs.model.Base} element\n * @param {EntryDescriptor} entry\n * @param {Object} values\n * @param {HTMLElement} entryNode\n * @param {Number} idx\n */\nPropertiesPanel.prototype._bindTemplate = function(element, entry, values, entryNode, idx) {\n\n  var eventBus = this._eventBus;\n\n  function isPropertyEditable(entry, propertyName) {\n    return eventBus.fire('propertiesPanel.isPropertyEditable', {\n      entry: entry,\n      propertyName: propertyName,\n      element: element\n    });\n  }\n\n  var inputNodes = getPropertyPlaceholders(entryNode);\n\n  forEach(inputNodes, function(node) {\n\n    var name,\n        newValue,\n        editable;\n\n    // we deal with an input element\n    if ('value' in node || isContentEditable(node) === 'true') {\n      name = domAttr(node, 'name') || domAttr(node, 'data-name');\n      newValue = values[name];\n\n      editable = isPropertyEditable(entry, name);\n      if (editable && entry.editable) {\n        editable = entry.editable(element, entryNode, node, name, newValue, idx);\n      }\n\n      domAttr(node, 'readonly', editable ? null : '');\n      domAttr(node, 'disabled', editable ? null : '');\n\n      // take full control over setting the value\n      // and possibly updating the input in entry#setControlValue\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else if (isToggle(node)) {\n        setToggleValue(node, newValue);\n      } else if (isSelect(node)) {\n        setSelectValue(node, newValue);\n      } else {\n        setInputValue(node, newValue);\n      }\n    }\n\n    // we deal with some non-editable html element\n    else {\n      name = domAttr(node, 'data-value');\n      newValue = values[name];\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else {\n        setTextValue(node, newValue);\n      }\n    }\n  });\n};\n\n// TODO(nikku): WTF freaking name? Change / clarify.\nPropertiesPanel.prototype._updateActivation = function(current) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var element = current.element;\n\n  function isEntryVisible(entry) {\n    return eventBus.fire('propertiesPanel.isEntryVisible', {\n      entry: entry,\n      element: element\n    });\n  }\n\n  function isGroupVisible(group, element, groupNode) {\n    if (typeof group.enabled === 'function') {\n      return group.enabled(element, groupNode);\n    } else {\n      return true;\n    }\n  }\n\n  function isTabVisible(tab, element) {\n    if (typeof tab.enabled === 'function') {\n      return tab.enabled(element);\n    } else {\n      return true;\n    }\n  }\n\n  function toggleVisible(node, visible) {\n    domClasses(node).toggle(HIDE_CLASS, !visible);\n  }\n\n  // check whether the active tab is visible\n  // if not: set the first tab as active tab\n  function checkActiveTabVisibility(node, visible) {\n    var isActive = domClasses(node).has('bpp-active');\n    if (!visible && isActive) {\n      self.activateTab(current.tabs[0]);\n    }\n  }\n\n  function updateLabel(element, selector, text) {\n    var labelNode = domQuery(selector, element);\n\n    if (!labelNode) {\n      return;\n    }\n\n    labelNode.textContent = text;\n  }\n\n  var panelNode = current.panel;\n\n  forEach(current.tabs, function(tab) {\n\n    var tabNode = domQuery('[data-tab=' + tab.id + ']', panelNode);\n    var tabLinkNode = domQuery('[data-tab-target=' + tab.id + ']', panelNode).parentNode;\n\n    var tabVisible = false;\n\n    forEach(tab.groups, function(group) {\n\n      var groupVisible = false;\n\n      var groupNode = domQuery('[data-group=' + group.id + ']', tabNode);\n\n      forEach(group.entries, function(entry) {\n\n        var entryNode = domQuery('[data-entry=\"' + entry.id + '\"]', groupNode);\n\n        var entryVisible = isEntryVisible(entry);\n\n        groupVisible = groupVisible || entryVisible;\n\n        toggleVisible(entryNode, entryVisible);\n\n        var values = 'get' in entry ? entry.get(element, entryNode) : {};\n\n        if (values instanceof Array) {\n          var listEntryContainer = domQuery('[data-list-entry-container]', entryNode);\n          var existingElements = listEntryContainer.children || [];\n\n          for (var i = 0; i < values.length; i++) {\n            var listValue = values[i];\n            var listItemNode = existingElements[i];\n            if (!listItemNode) {\n              listItemNode = domify(entry.createListEntryTemplate(listValue, i, listEntryContainer));\n              listEntryContainer.appendChild(listItemNode);\n            }\n            domAttr(listItemNode, 'data-index', i);\n\n            self._bindTemplate(element, entry, listValue, listItemNode, i);\n          }\n\n          var entriesToRemove = existingElements.length - values.length;\n\n          for (var j = 0; j < entriesToRemove; j++) {\n            // remove orphaned element\n            listEntryContainer.removeChild(listEntryContainer.lastChild);\n          }\n\n        } else {\n          self._bindTemplate(element, entry, values, entryNode);\n        }\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n        self.validate(entry, values, entryNode);\n\n        // remember initial state for later dirty checking\n        entry.oldValues = getFormControlValues(entryNode);\n      });\n\n      if (typeof group.label === 'function') {\n        updateLabel(groupNode, '.group-label', group.label(element, groupNode));\n      }\n\n      groupVisible = groupVisible && isGroupVisible(group, element, groupNode);\n\n      tabVisible = tabVisible || groupVisible;\n\n      toggleVisible(groupNode, groupVisible);\n    });\n\n    tabVisible = tabVisible && isTabVisible(tab, element);\n\n    toggleVisible(tabNode, tabVisible);\n    toggleVisible(tabLinkNode, tabVisible);\n\n    checkActiveTabVisibility(tabNode, tabVisible);\n  });\n\n  // inject elements id into header\n  updateLabel(panelNode, '[data-label-id]', getBusinessObject(element).id || '');\n};\n\nPropertiesPanel.prototype._createPanel = function(element, tabs) {\n  var self = this;\n\n  var panelNode = domify('<div class=\"bpp-properties\"></div>'),\n      headerNode = domify('<div class=\"bpp-properties-header\">' +\n        '<div class=\"label\" data-label-id></div>' +\n        '<div class=\"search\">' +\n          '<input type=\"search\" placeholder=\"Search for property\" />' +\n          '<button><span>Search</span></button>' +\n        '</div>' +\n      '</div>'),\n      tabBarNode = domify('<div class=\"bpp-properties-tab-bar\"></div>'),\n      tabLinksNode = domify('<ul class=\"bpp-properties-tabs-links\"></ul>'),\n      tabContainerNode = domify('<div class=\"bpp-properties-tabs-container\"></div>');\n\n  panelNode.appendChild(headerNode);\n\n  forEach(tabs, function(tab, tabIndex) {\n\n    if (!tab.id) {\n      throw new Error('tab must have an id');\n    }\n\n    var tabNode = domify('<div class=\"bpp-properties-tab\" data-tab=\"' + escapeHTML(tab.id) + '\"></div>'),\n        tabLinkNode = domify('<li class=\"bpp-properties-tab-link\">' +\n          '<a href data-tab-target=\"' + escapeHTML(tab.id) + '\">' + escapeHTML(tab.label) + '</a>' +\n        '</li>');\n\n    var groups = tab.groups;\n\n    forEach(groups, function(group) {\n\n      if (!group.id) {\n        throw new Error('group must have an id');\n      }\n\n      var groupNode = domify('<div class=\"bpp-properties-group\" data-group=\"' + escapeHTML(group.id) + '\">' +\n          '<span class=\"group-toggle\"></span>' +\n          '<span class=\"group-label\">' + escapeHTML(group.label) + '</span>' +\n        '</div>');\n\n      // TODO(nre): use event delegation to handle that...\n      groupNode.querySelector('.group-toggle').addEventListener('click', function(evt) {\n        domClasses(groupNode).toggle('group-closed');\n        evt.preventDefault();\n        evt.stopPropagation();\n      });\n      groupNode.addEventListener('click', function(evt) {\n        if (!evt.defaultPrevented && domClasses(groupNode).has('group-closed')) {\n          domClasses(groupNode).remove('group-closed');\n        }\n      });\n\n      forEach(group.entries, function(entry) {\n\n        if (!entry.id) {\n          throw new Error('entry must have an id');\n        }\n\n        var html = entry.html;\n\n        if (typeof html === 'string') {\n          html = domify(html);\n        }\n\n        // unwrap jquery\n        if (html.get && html.constructor.prototype.jquery) {\n          html = html.get(0);\n        }\n\n        var entryNode = domify('<div class=\"bpp-properties-entry\" data-entry=\"' + escapeHTML(entry.id) + '\"></div>');\n\n        forEach(entry.cssClasses || [], function(cssClass) {\n          domClasses(entryNode).add(cssClass);\n        });\n\n        entryNode.appendChild(html);\n\n        groupNode.appendChild(entryNode);\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n      });\n\n      tabNode.appendChild(groupNode);\n    });\n\n    tabLinksNode.appendChild(tabLinkNode);\n    tabContainerNode.appendChild(tabNode);\n  });\n\n  tabBarNode.appendChild(tabLinksNode);\n\n  panelNode.appendChild(tabBarNode);\n  panelNode.appendChild(tabContainerNode);\n\n  return panelNode;\n};\n\n\n\nfunction setInputValue(node, value) {\n\n  var contentEditable = isContentEditable(node);\n\n  var oldValue = contentEditable ? node.innerText : node.value;\n\n  var selection;\n\n  // prevents input fields from having the value 'undefined'\n  if (value === undefined) {\n    value = '';\n  }\n\n  if (oldValue === value) {\n    return;\n  }\n\n  // update selection on undo/redo\n  if (document.activeElement === node) {\n    selection = updateSelection(getSelection(node), oldValue, value);\n  }\n\n  if (contentEditable) {\n    node.innerText = value;\n  } else {\n    node.value = value;\n  }\n\n  if (selection) {\n    setSelection(node, selection);\n  }\n}\n\nfunction setSelectValue(node, value) {\n  if (value !== undefined) {\n    node.value = value;\n  }\n}\n\nfunction setToggleValue(node, value) {\n  var nodeValue = node.value;\n\n  node.checked = (value === nodeValue) || (!domAttr(node, 'value') && value);\n}\n\nfunction setTextValue(node, value) {\n  node.textContent = value;\n}\n\nfunction getSelection(node) {\n\n  return isContentEditable(node) ? getContentEditableSelection(node) : {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction getContentEditableSelection(node) {\n\n  var selection = window.getSelection();\n\n  var focusNode = selection.focusNode,\n      focusOffset = selection.focusOffset,\n      anchorOffset = selection.anchorOffset;\n\n  if (!focusNode) {\n    throw new Error('not selected');\n  }\n\n  // verify we have selection on the current element\n  if (!node.contains(focusNode)) {\n    throw new Error('not selected');\n  }\n\n  return {\n    start: Math.min(focusOffset, anchorOffset),\n    end: Math.max(focusOffset, anchorOffset)\n  };\n}\n\nfunction setSelection(node, selection) {\n\n  if (isContentEditable(node)) {\n    setContentEditableSelection(node, selection);\n  } else {\n    node.selectionStart = selection.start;\n    node.selectionEnd = selection.end;\n  }\n}\n\nfunction setContentEditableSelection(node, selection) {\n\n  var focusNode,\n      domRange,\n      domSelection;\n\n  focusNode = node.firstChild || node,\n  domRange = document.createRange();\n  domRange.setStart(focusNode, selection.start);\n  domRange.setEnd(focusNode, selection.end);\n\n  domSelection = window.getSelection();\n  domSelection.removeAllRanges();\n  domSelection.addRange(domRange);\n}\n\nfunction isImplicitRoot(element) {\n  return element.id === '__implicitroot';\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar hexTable = (function () {\n    var array = [];\n    for (var i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n\n    return array;\n}());\n\nvar compactQueue = function compactQueue(queue) {\n    var obj;\n\n    while (queue.length) {\n        var item = queue.pop();\n        obj = item.obj[item.prop];\n\n        if (Array.isArray(obj)) {\n            var compacted = [];\n\n            for (var j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n\n            item.obj[item.prop] = compacted;\n        }\n    }\n\n    return obj;\n};\n\nvar arrayToObject = function arrayToObject(source, options) {\n    var obj = options && options.plainObjects ? Object.create(null) : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nvar merge = function merge(target, source, options) {\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object') {\n        if (Array.isArray(target)) {\n            target.push(source);\n        } else if (typeof target === 'object') {\n            if (options.plainObjects || options.allowPrototypes || !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (Array.isArray(target) && !Array.isArray(source)) {\n        mergeTarget = arrayToObject(target, options);\n    }\n\n    if (Array.isArray(target) && Array.isArray(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                if (target[i] && typeof target[i] === 'object') {\n                    target[i] = merge(target[i], item, options);\n                } else {\n                    target.push(item);\n                }\n            } else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nvar assign = function assignSingleSource(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n};\n\nvar decode = function (str) {\n    try {\n        return decodeURIComponent(str.replace(/\\+/g, ' '));\n    } catch (e) {\n        return str;\n    }\n};\n\nvar encode = function encode(str) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = typeof str === 'string' ? str : String(str);\n\n    var out = '';\n    for (var i = 0; i < string.length; ++i) {\n        var c = string.charCodeAt(i);\n\n        if (\n            c === 0x2D // -\n            || c === 0x2E // .\n            || c === 0x5F // _\n            || c === 0x7E // ~\n            || (c >= 0x30 && c <= 0x39) // 0-9\n            || (c >= 0x41 && c <= 0x5A) // a-z\n            || (c >= 0x61 && c <= 0x7A) // A-Z\n        ) {\n            out += string.charAt(i);\n            continue;\n        }\n\n        if (c < 0x80) {\n            out = out + hexTable[c];\n            continue;\n        }\n\n        if (c < 0x800) {\n            out = out + (hexTable[0xC0 | (c >> 6)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        if (c < 0xD800 || c >= 0xE000) {\n            out = out + (hexTable[0xE0 | (c >> 12)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        i += 1;\n        c = 0x10000 + (((c & 0x3FF) << 10) | (string.charCodeAt(i) & 0x3FF));\n        out += hexTable[0xF0 | (c >> 18)]\n            + hexTable[0x80 | ((c >> 12) & 0x3F)]\n            + hexTable[0x80 | ((c >> 6) & 0x3F)]\n            + hexTable[0x80 | (c & 0x3F)];\n    }\n\n    return out;\n};\n\nvar compact = function compact(value) {\n    var queue = [{ obj: { o: value }, prop: 'o' }];\n    var refs = [];\n\n    for (var i = 0; i < queue.length; ++i) {\n        var item = queue[i];\n        var obj = item.obj[item.prop];\n\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; ++j) {\n            var key = keys[j];\n            var val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n\n    return compactQueue(queue);\n};\n\nvar isRegExp = function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar isBuffer = function isBuffer(obj) {\n    if (obj === null || typeof obj === 'undefined') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n\nmodule.exports = {\n    arrayToObject: arrayToObject,\n    assign: assign,\n    compact: compact,\n    decode: decode,\n    encode: encode,\n    isBuffer: isBuffer,\n    isRegExp: isRegExp,\n    merge: merge\n};\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","const disallowNodeType = require('./helper').disallowNodeType;\n\nmodule.exports = disallowNodeType('bpmn:InclusiveGateway');","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that combines and executes multiple commands.\n *\n * All updates are bundled on the command stack and executed in one step.\n * This also makes it possible to revert the changes in one step.\n *\n * Example use case: remove the camunda:formKey attribute and in addition\n * add all form fields needed for the camunda:formData property.\n *\n * @class\n * @constructor\n */\nfunction MultiCommandHandler(commandStack) {\n  this._commandStack = commandStack;\n}\n\nMultiCommandHandler.$inject = [ 'commandStack' ];\n\nmodule.exports = MultiCommandHandler;\n\nMultiCommandHandler.prototype.preExecute = function(context) {\n\n  var commandStack = this._commandStack;\n\n  forEach(context, function(command) {\n    commandStack.execute(command.cmd, command.context);\n  });\n};","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks for the presence of a start event per scope.\n */\nmodule.exports = function() {\n\n  function hasStartEvent(node) {\n    const flowElements = node.flowElements || [];\n\n    return (\n      flowElements.some(node => is(node, 'bpmn:StartEvent'))\n    );\n  }\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Process',\n      'bpmn:SubProcess'\n    ])) {\n      return;\n    }\n\n    if (!hasStartEvent(node)) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' is missing start event');\n    }\n  }\n\n  return { check };\n};\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    forEach = require('lodash/forEach');\n\nvar EventDefinitionHelper = {};\n\nmodule.exports = EventDefinitionHelper;\n\nEventDefinitionHelper.getEventDefinition = function(element, eventType) {\n\n  var bo = getBusinessObject(element),\n      eventDefinition = null;\n\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function(event) {\n      if (is(event, eventType)) {\n        eventDefinition = event;\n      }\n    });\n  }\n\n  return eventDefinition;\n};\n\nEventDefinitionHelper.getTimerEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:TimerEventDefinition');\n};\n\nEventDefinitionHelper.getMessageEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:MessageEventDefinition');\n};\n\nEventDefinitionHelper.getSignalEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:SignalEventDefinition');\n};\n\nEventDefinitionHelper.getErrorEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:ErrorEventDefinition');\n};\n\nEventDefinitionHelper.getEscalationEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:EscalationEventDefinition');\n};\n\nEventDefinitionHelper.getCompensateEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:CompensateEventDefinition');\n};\n\nEventDefinitionHelper.getLinkEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:LinkEventDefinition');\n};\n\nEventDefinitionHelper.getConditionalEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:ConditionalEventDefinition');\n};\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nmodule.exports = baseIsNaN;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","/** Used to match wrap detail comments. */\nvar reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/;\n\n/**\n * Inserts wrapper `details` in a comment at the top of the `source` body.\n *\n * @private\n * @param {string} source The source to modify.\n * @returns {Array} details The details to insert.\n * @returns {string} Returns the modified source.\n */\nfunction insertWrapDetails(source, details) {\n  var length = details.length;\n  if (!length) {\n    return source;\n  }\n  var lastIndex = length - 1;\n  details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n  details = details.join(length > 2 ? ', ' : ' ');\n  return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n}\n\nmodule.exports = insertWrapDetails;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('./CmdHelper');\n\n\nvar ParticipantHelper = {};\n\nmodule.exports = ParticipantHelper;\n\nParticipantHelper.modifyProcessBusinessObject = function(element, property, values) {\n  if (!is(element, 'bpmn:Participant')) {\n    return {};\n  }\n\n  var bo = getBusinessObject(element).get('processRef'),\n      properties = {};\n\n  properties[property] = values[property];\n\n  return cmdHelper.updateBusinessObject(element, bo, properties);\n};\n\nParticipantHelper.getProcessBusinessObject = function(element, propertyName) {\n  if (!is(element, 'bpmn:Participant')) {\n    return {};\n  }\n\n  var bo = getBusinessObject(element).get('processRef'),\n      properties = {};\n\n  properties[propertyName] = bo.get(propertyName);\n\n  return properties;\n};","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","var global = require('../internals/global');\nvar DOMIterables = require('../internals/dom-iterables');\nvar ArrayIteratorMethods = require('../modules/es.array.iterator');\nvar createNonEnumerableProperty = require('../internals/create-non-enumerable-property');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar ITERATOR = wellKnownSymbol('iterator');\nvar TO_STRING_TAG = wellKnownSymbol('toStringTag');\nvar ArrayValues = ArrayIteratorMethods.values;\n\nfor (var COLLECTION_NAME in DOMIterables) {\n  var Collection = global[COLLECTION_NAME];\n  var CollectionPrototype = Collection && Collection.prototype;\n  if (CollectionPrototype) {\n    // some Chrome versions have non-configurable methods on DOMTokenList\n    if (CollectionPrototype[ITERATOR] !== ArrayValues) try {\n      createNonEnumerableProperty(CollectionPrototype, ITERATOR, ArrayValues);\n    } catch (error) {\n      CollectionPrototype[ITERATOR] = ArrayValues;\n    }\n    if (!CollectionPrototype[TO_STRING_TAG]) {\n      createNonEnumerableProperty(CollectionPrototype, TO_STRING_TAG, COLLECTION_NAME);\n    }\n    if (DOMIterables[COLLECTION_NAME]) for (var METHOD_NAME in ArrayIteratorMethods) {\n      // some Chrome versions have non-configurable methods on DOMTokenList\n      if (CollectionPrototype[METHOD_NAME] !== ArrayIteratorMethods[METHOD_NAME]) try {\n        createNonEnumerableProperty(CollectionPrototype, METHOD_NAME, ArrayIteratorMethods[METHOD_NAME]);\n      } catch (error) {\n        CollectionPrototype[METHOD_NAME] = ArrayIteratorMethods[METHOD_NAME];\n      }\n    }\n  }\n}\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domify = require('min-dom').domify;\n\nvar forEach = require('lodash/forEach');\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar isList = function(list) {\n  return !(!list || Object.prototype.toString.call(list) !== '[object Array]');\n};\n\nvar addEmptyParameter = function(list) {\n  return list.concat([ { name: '', value: '' } ]);\n};\n\nvar createOption = function(option) {\n  return '<option value=\"' + option.value + '\">' + option.name + '</option>';\n};\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.label]\n * @param  {Array<Object>} options.selectOptions\n * @param  {string} options.modelProperty\n * @param  {boolean} options.emptyParameter\n * @param  {function} options.disabled\n * @param  {function} options.hidden\n * @param  {Object} defaultParameters\n *\n * @return {Object}\n */\nvar selectbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      selectOptions = options.selectOptions || [ { name: '', value: '' } ],\n      modelProperty = options.modelProperty,\n      emptyParameter = options.emptyParameter,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n\n  if (emptyParameter) {\n    selectOptions = addEmptyParameter(selectOptions);\n  }\n\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\"' +\n    (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n    (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n    '>' + escapeHTML(label) + '</label>' +\n    '<select id=\"camunda-' + escapeHTML(resource.id) + '-select\" name=\"' +\n    escapeHTML(modelProperty) + '\"' +\n    (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n    (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n    ' data-value>';\n\n  if (isList(selectOptions)) {\n    forEach(selectOptions, function(option) {\n      resource.html += '<option value=\"' + escapeHTML(option.value) + '\">' +\n      (option.name ? escapeHTML(option.name) : '') + '</option>';\n    });\n  }\n\n  resource.html += '</select>';\n\n  // add description below select box entry field\n  if (description && typeof options.showCustomInput !== 'function') {\n    resource.html += entryFieldDescription(description);\n  }\n\n  /**\n   * Fill the select box options dynamically.\n   *\n   * Calls the defined function #selectOptions in the entry to get the\n   * values for the options and set the value to the inputNode.\n   *\n   * @param {djs.model.Base} element\n   * @param {HTMLElement} entryNode\n   * @param {EntryDescriptor} inputNode\n   * @param {Object} inputName\n   * @param {Object} newValue\n   */\n  resource.setControlValue = function(element, entryNode, inputNode, inputName, newValue) {\n    if (typeof selectOptions === 'function') {\n\n      var options = selectOptions(element, inputNode);\n\n      if (options) {\n\n        // remove existing options\n        while (inputNode.firstChild) {\n          inputNode.removeChild(inputNode.firstChild);\n        }\n\n        // add options\n        forEach(options, function(option) {\n          var template = domify(createOption(option));\n\n          inputNode.appendChild(template);\n        });\n\n\n      }\n    }\n\n    // set select value\n    if (newValue !== undefined) {\n      inputNode.value = newValue;\n    }\n\n  };\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-dropdown'];\n\n  return resource;\n};\n\nmodule.exports = selectbox;\n","'use strict';\n\nvar reduce = require('lodash/transform'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    keys = require('lodash/keys'),\n    forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateBusinessObjectHandler.$inject = [ 'elementRegistry' ];\n\nmodule.exports = UpdateBusinessObjectHandler;\n\n/**\n * returns the root element\n */\nfunction getRoot(businessObject) {\n  var parent = businessObject;\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n  return parent;\n}\n\nfunction getProperties(businessObject, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = businessObject.get(key);\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n    businessObject.set(key, value);\n  });\n}\n\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a business object with a list of new properties\n *\n * @method  UpdateBusinessObjectHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element which has a child business object updated\n * @param {moddle.businessObject} context.businessObject the businessObject to update\n * @param {Object} context.properties a list of properties to set on the businessObject\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nUpdateBusinessObjectHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      businessObject = context.businessObject,\n      rootElements = getRoot(businessObject).rootElements,\n      referenceType = context.referenceType,\n      referenceProperty = context.referenceProperty,\n      changed = [ element ]; // this will not change any diagram-js elements\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  if (!businessObject) {\n    throw new Error('businessObject required');\n  }\n\n  var properties = context.properties,\n      oldProperties = context.oldProperties || getProperties(businessObject, keys(properties));\n\n  // check if there the update needs an external element for reference\n  if (typeof referenceType !== 'undefined' && typeof referenceProperty !== 'undefined') {\n    forEach(rootElements, function(rootElement) {\n      if (is(rootElement, referenceType)) {\n        if (rootElement.id === properties[referenceProperty]) {\n          properties[referenceProperty] = rootElement;\n        }\n      }\n    });\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  UpdateBusinessObjectHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectHandler.prototype.revert = function(context) {\n\n  var oldProperties = context.oldProperties,\n      businessObject = context.businessObject;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  return context.changed;\n};\n","'use strict';\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar eventDefinitionHelper = require('./EventDefinitionHelper');\nvar extensionsElementHelper = require('./ExtensionElementsHelper');\n\nvar ImplementationTypeHelper = {};\n\nmodule.exports = ImplementationTypeHelper;\n\n/**\n * Returns 'true' if the given element is 'camunda:ServiceTaskLike'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isServiceTaskLike = function(element) {\n  return is(element, 'camunda:ServiceTaskLike');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:DmnCapable'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isDmnCapable = function(element) {\n  return is(element, 'camunda:DmnCapable');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExternalCapable'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isExternalCapable = function(element) {\n  return is(element, 'camunda:ExternalCapable');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:TaskListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isTaskListener = function(element) {\n  return is(element, 'camunda:TaskListener');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExecutionListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isExecutionListener = function(element) {\n  return is(element, 'camunda:ExecutionListener');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExecutionListener' or\n * 'camunda:TaskListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isListener = function(element) {\n  return this.isTaskListener(element) || this.isExecutionListener(element);\n};\n\n/**\n * Returns 'true' if the given element is 'bpmn:SequenceFlow'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isSequenceFlow = function(element) {\n  return is(element, 'bpmn:SequenceFlow');\n};\n\n/**\n * Get a 'camunda:ServiceTaskLike' business object.\n *\n * If the given element is not a 'camunda:ServiceTaskLike', then 'false'\n * is returned.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement} the 'camunda:ServiceTaskLike' business object\n */\nImplementationTypeHelper.getServiceTaskLikeBusinessObject = function(element) {\n\n  if (is(element, 'bpmn:IntermediateThrowEvent') || is(element, 'bpmn:EndEvent')) {\n\n    // change business object to 'messageEventDefinition' when\n    // the element is a message intermediate throw event or message end event\n    // because the camunda extensions (e.g. camunda:class) are in the message\n    // event definition tag and not in the intermediate throw event or end event tag\n    var messageEventDefinition = eventDefinitionHelper.getMessageEventDefinition(element);\n    if (messageEventDefinition) {\n      element = messageEventDefinition;\n    }\n  }\n\n  return this.isServiceTaskLike(element) && getBusinessObject(element);\n\n};\n\n/**\n * Returns the implementation type of the given element.\n *\n * Possible implementation types are:\n * - dmn\n * - connector\n * - external\n * - class\n * - expression\n * - delegateExpression\n * - script\n * - or undefined, when no matching implementation type is found\n *\n * @param  {djs.model.Base} element\n *\n * @return {String} the implementation type\n */\nImplementationTypeHelper.getImplementationType = function(element) {\n\n  var bo = this.getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    if (this.isListener(element)) {\n      bo = element;\n    } else {\n      return;\n    }\n  }\n\n  if (this.isDmnCapable(bo)) {\n    var decisionRef = bo.get('camunda:decisionRef');\n    if (typeof decisionRef !== 'undefined') {\n      return 'dmn';\n    }\n  }\n\n  if (this.isServiceTaskLike(bo)) {\n    var connectors = extensionsElementHelper.getExtensionElements(bo, 'camunda:Connector');\n    if (typeof connectors !== 'undefined') {\n      return 'connector';\n    }\n  }\n\n  if (this.isExternalCapable(bo)) {\n    var type = bo.get('camunda:type');\n    if (type === 'external') {\n      return 'external';\n    }\n  }\n\n  var cls = bo.get('camunda:class');\n  if (typeof cls !== 'undefined') {\n    return 'class';\n  }\n\n  var expression = bo.get('camunda:expression');\n  if (typeof expression !== 'undefined') {\n    return 'expression';\n  }\n\n  var delegateExpression = bo.get('camunda:delegateExpression');\n  if (typeof delegateExpression !== 'undefined') {\n    return 'delegateExpression';\n  }\n\n  if (this.isListener(bo)) {\n    var script = bo.get('script');\n    if (typeof script !== 'undefined') {\n      return 'script';\n    }\n  }\n\n};\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction isExclusive(bo) {\n  return asyncCapableHelper.isExclusive(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction canRemoveFailedJobRetryTimeCycle(element) {\n  return !eventDefinitionHelper.getTimerEventDefinition(element);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n\n  var asyncBeforeEntry = entryFactory.checkbox({\n    id: idPrefix + 'asyncBefore',\n    label: labelPrefix + translate('Asynchronous Before'),\n    modelProperty: 'asyncBefore',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        asyncBefore: isAsyncBefore(bo)\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      var asyncBefore = !!values.asyncBefore;\n\n      var props = {\n        'camunda:asyncBefore': asyncBefore,\n        'camunda:async': false\n      };\n\n      var commands = [];\n      if (!isAsyncAfter(bo) && !asyncBefore) {\n        props = assign({ 'camunda:exclusive' : true }, props);\n        if (canRemoveFailedJobRetryTimeCycle(element)) {\n          commands.push(removeFailedJobRetryTimeCycle(bo, element));\n        }\n      }\n\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n      return commands;\n    }\n  });\n\n\n  var asyncAfterEntry = entryFactory.checkbox({\n    id: idPrefix + 'asyncAfter',\n    label: labelPrefix + translate('Asynchronous After'),\n    modelProperty: 'asyncAfter',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        asyncAfter: isAsyncAfter(bo)\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      var asyncAfter = !!values.asyncAfter;\n\n      var props = {\n        'camunda:asyncAfter': asyncAfter\n      };\n\n      var commands = [];\n      if (!isAsyncBefore(bo) && !asyncAfter) {\n        props = assign({ 'camunda:exclusive' : true }, props);\n        if (canRemoveFailedJobRetryTimeCycle(element)) {\n          commands.push(removeFailedJobRetryTimeCycle(bo, element));\n        }\n      }\n\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n      return commands;\n    }\n  });\n\n\n  var exclusiveEntry = entryFactory.checkbox({\n    id: idPrefix + 'exclusive',\n    label: labelPrefix + translate('Exclusive'),\n    modelProperty: 'exclusive',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { exclusive: isExclusive(bo) };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, { 'camunda:exclusive': !!values.exclusive });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n      return bo && !isAsyncAfter(bo) && !isAsyncBefore(bo);\n    }\n  });\n\n  return [ asyncBeforeEntry, asyncAfterEntry, exclusiveEntry ];\n};\n","const Linter = require('./linter');\n\nmodule.exports = {\n  Linter\n};","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny;\n\nvar find = require('lodash/find');\n\n\nvar TEMPLATE_ATTR = 'camunda:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template is stored.\n *\n * @type {String}\n */\nmodule.exports.TEMPLATE_ATTR = TEMPLATE_ATTR;\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nfunction getTemplateId(element) {\n\n  var bo = getBusinessObject(element);\n\n  if (bo) {\n    return bo.get(TEMPLATE_ATTR);\n  }\n}\n\nmodule.exports.getTemplateId = getTemplateId;\n\n\n/**\n * Get template of a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getTemplate(element, elementTemplates) {\n  var id = getTemplateId(element);\n\n  return id && elementTemplates.get(id);\n}\n\nmodule.exports.getTemplate = getTemplate;\n\n/**\n * Get default template for a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getDefaultTemplate(element, elementTemplates) {\n\n  // return first default template, if any exists\n  return (\n    elementTemplates.getAll().filter(function(t) {\n      return isAny(element, t.appliesTo) && t.isDefault;\n    })\n  )[0];\n}\n\nmodule.exports.getDefaultTemplate = getDefaultTemplate;\n\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nfunction findExtension(element, type) {\n  var bo = getBusinessObject(element);\n\n  var extensionElements;\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    extensionElements = bo;\n  } else {\n    extensionElements = bo.extensionElements;\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return find(extensionElements.get('values'), function(e) {\n    return is(e, type);\n  });\n}\n\nmodule.exports.findExtension = findExtension;\n\n\nfunction findExtensions(element, types) {\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter(function(e) {\n    return isAny(e, types);\n  });\n}\n\nmodule.exports.findExtensions = findExtensions;\n\n\nfunction findCamundaInOut(element, binding) {\n\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  var matcher;\n\n  if (binding.type === 'camunda:in') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:out') {\n    matcher = function(e) {\n      return is(e, 'camunda:Out') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:in:businessKey') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && 'businessKey' in e;\n    };\n  }\n\n  return find(extensionElements.get('values'), matcher);\n}\n\nmodule.exports.findCamundaInOut = findCamundaInOut;\n\nfunction findCamundaProperty(camundaProperties, binding) {\n  return find(camundaProperties.get('values'), function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findCamundaProperty = findCamundaProperty;\n\n\nfunction findInputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('inputParameters');\n\n  return find(parameters, function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findInputParameter = findInputParameter;\n\n\nfunction findOutputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('outputParameters');\n\n  return find(parameters, function(p) {\n    var value = p.value;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    var definition = p.definition;\n\n    if (!definition || binding.scriptFormat !== definition.scriptFormat) {\n      return false;\n    }\n\n    return definition.value === binding.source;\n  });\n}\n\nmodule.exports.findOutputParameter = findOutputParameter;\n\n\n\n// helpers /////////////////////////////////\n\nfunction getExtensionElements(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    return bo;\n  } else {\n    return bo.extensionElements;\n  }\n}\n\n\nfunction isInOut(element, binding) {\n\n  if (binding.type === 'camunda:in') {\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  }\n\n  // find based variables / local combination\n  if (binding.variables) {\n    return element.variables === 'all' && (\n      binding.variables !== 'local' || element.local\n    );\n  }\n}\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","var isLaziable = require('./_isLaziable'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/**\n * Creates a function that wraps `func` to continue currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {Function} wrapFunc The function to create the `func` wrapper.\n * @param {*} placeholder The placeholder value.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n  var isCurry = bitmask & WRAP_CURRY_FLAG,\n      newHolders = isCurry ? holders : undefined,\n      newHoldersRight = isCurry ? undefined : holders,\n      newPartials = isCurry ? partials : undefined,\n      newPartialsRight = isCurry ? undefined : partials;\n\n  bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n  bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n  if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n    bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n  }\n  var newData = [\n    func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n    newHoldersRight, argPos, ary, arity\n  ];\n\n  var result = wrapFunc.apply(undefined, newData);\n  if (isLaziable(func)) {\n    setData(result, newData);\n  }\n  result.placeholder = placeholder;\n  return setWrapToString(result, func, bitmask);\n}\n\nmodule.exports = createRecurry;\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, […]\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), […]\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, […]\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\n// input entities\nvar textInputField = require('./TextInputEntryFactory'),\n    checkboxField = require('./CheckboxEntryFactory'),\n    selectBoxField = require('./SelectEntryFactory'),\n    comboBoxField = require('./ComboEntryFactory'),\n    textBoxField = require('./TextBoxEntryFactory'),\n    validationAwareTextInputField = require('./ValidationAwareTextInput'),\n    tableField = require('./TableEntryFactory'),\n    labelEntry = require('./LabelFactory'),\n    link = require('./LinkEntryFactory');\n\nvar cmdHelper = require('../helper/CmdHelper');\n\n// helpers ////////////////////////////////////////\n\nfunction ensureNotNull(prop) {\n  if (!prop) {\n    throw new Error(prop + ' must be set.');\n  }\n\n  return prop;\n}\n\n/**\n * sets the default parameters which are needed to create an entry\n *\n * @param options\n * @returns {{id: *, description: (*|string), get: (*|Function), set: (*|Function),\n *            validate: (*|Function), html: string}}\n */\nvar setDefaultParameters = function(options) {\n\n  // default method to fetch the current value of the input field\n  var defaultGet = function(element) {\n    var bo = getBusinessObject(element),\n        res = {},\n        prop = ensureNotNull(options.modelProperty);\n    res[prop] = bo.get(prop);\n\n    return res;\n  };\n\n  // default method to set a new value to the input field\n  var defaultSet = function(element, values) {\n    var res = {},\n        prop = ensureNotNull(options.modelProperty);\n    if (values[prop] !== '') {\n      res[prop] = values[prop];\n    } else {\n      res[prop] = undefined;\n    }\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  // default validation method\n  var defaultValidate = function() {\n    return {};\n  };\n\n  return {\n    id : options.id,\n    description : (options.description || ''),\n    get : (options.get || defaultGet),\n    set : (options.set || defaultSet),\n    validate : (options.validate || defaultValidate),\n    html: ''\n  };\n};\n\nfunction EntryFactory() {\n\n}\n\n/**\n * Generates an text input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation mehtod - Function\n *\n * - modelProperty: name of the model property - String\n *\n * - buttonAction: Object which contains the following properties: - Object\n * ---- name: name of the [data-action] callback - String\n * ---- method: callback function for [data-action] - Function\n *\n * - buttonShow: Object which contains the following properties: - Object\n * ---- name: name of the [data-show] callback - String\n * ---- method: callback function for [data-show] - Function\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.textField = function(options) {\n  return textInputField(options, setDefaultParameters(options));\n};\n\nEntryFactory.validationAwareTextField = function(options) {\n  return validationAwareTextInputField(options, setDefaultParameters(options));\n};\n\n/**\n * Generates a checkbox input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation method - Function\n *\n * - modelProperty: name of the model property - String\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.checkbox = function(options) {\n  return checkboxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.textBox = function(options) {\n  return textBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.selectBox = function(options) {\n  return selectBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.comboBox = function(options) {\n  return comboBoxField(options);\n};\n\nEntryFactory.table = function(options) {\n  return tableField(options);\n};\n\nEntryFactory.label = function(options) {\n  return labelEntry(options);\n};\n\nEntryFactory.link = function(options) {\n  return link(options);\n};\n\nmodule.exports = EntryFactory;\n","/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/**\n * Replaces all `placeholder` elements in `array` with an internal placeholder\n * and returns an array of their indexes.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {*} placeholder The placeholder to replace.\n * @returns {Array} Returns the new array of placeholder indexes.\n */\nfunction replaceHolders(array, placeholder) {\n  var index = -1,\n      length = array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (value === placeholder || value === PLACEHOLDER) {\n      array[index] = PLACEHOLDER;\n      result[resIndex++] = index;\n    }\n  }\n  return result;\n}\n\nmodule.exports = replaceHolders;\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","var baseSetData = require('./_baseSetData'),\n    createBind = require('./_createBind'),\n    createCurry = require('./_createCurry'),\n    createHybrid = require('./_createHybrid'),\n    createPartial = require('./_createPartial'),\n    getData = require('./_getData'),\n    mergeData = require('./_mergeData'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString'),\n    toInteger = require('./toInteger');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates a function that either curries or invokes `func` with optional\n * `this` binding and partially applied arguments.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags.\n *    1 - `_.bind`\n *    2 - `_.bindKey`\n *    4 - `_.curry` or `_.curryRight` of a bound function\n *    8 - `_.curry`\n *   16 - `_.curryRight`\n *   32 - `_.partial`\n *   64 - `_.partialRight`\n *  128 - `_.rearg`\n *  256 - `_.ary`\n *  512 - `_.flip`\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to be partially applied.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n  var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n  if (!isBindKey && typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var length = partials ? partials.length : 0;\n  if (!length) {\n    bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n    partials = holders = undefined;\n  }\n  ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n  arity = arity === undefined ? arity : toInteger(arity);\n  length -= holders ? holders.length : 0;\n\n  if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n    var partialsRight = partials,\n        holdersRight = holders;\n\n    partials = holders = undefined;\n  }\n  var data = isBindKey ? undefined : getData(func);\n\n  var newData = [\n    func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n    argPos, ary, arity\n  ];\n\n  if (data) {\n    mergeData(newData, data);\n  }\n  func = newData[0];\n  bitmask = newData[1];\n  thisArg = newData[2];\n  partials = newData[3];\n  holders = newData[4];\n  arity = newData[9] = newData[9] === undefined\n    ? (isBindKey ? 0 : func.length)\n    : nativeMax(newData[9] - length, 0);\n\n  if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n    bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n  }\n  if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n    var result = createBind(func, bitmask, thisArg);\n  } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n    result = createCurry(func, bitmask, arity);\n  } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n    result = createPartial(func, bitmask, thisArg, partials);\n  } else {\n    result = createHybrid.apply(undefined, newData);\n  }\n  var setter = data ? baseSetData : setData;\n  return setWrapToString(setter(result, newData), func, bitmask);\n}\n\nmodule.exports = createWrap;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar inputOutputParameter = require('./implementation/InputOutputParameter');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  options = assign({\n    idPrefix: 'connector-',\n    insideConnector: true\n  }, options);\n\n  group.entries = group.entries.concat(inputOutputParameter(element, bpmnFactory, options, translate));\n\n};\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/**\n * The base constructor for creating `lodash` wrapper objects.\n *\n * @private\n * @param {*} value The value to wrap.\n * @param {boolean} [chainAll] Enable explicit method chain sequences.\n */\nfunction LodashWrapper(value, chainAll) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__chain__ = !!chainAll;\n  this.__index__ = 0;\n  this.__values__ = undefined;\n}\n\nLodashWrapper.prototype = baseCreate(baseLodash.prototype);\nLodashWrapper.prototype.constructor = LodashWrapper;\n\nmodule.exports = LodashWrapper;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar candidateStarter = require('./implementation/CandidateStarter');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:Process') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(candidateStarter(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n\n  }\n};\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getExtensionElements = require('../../../helper/ExtensionElementsHelper').getExtensionElements,\n    removeEntry = require('../../../helper/ExtensionElementsHelper').removeEntry,\n    extensionElements = require('./implementation/ExtensionElements'),\n    properties = require('./implementation/Properties'),\n    entryFactory = require('../../../factory/EntryFactory'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    formHelper = require('../../../helper/FormHelper'),\n    utils = require('../../../Utils'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    find = require('lodash/find'),\n    each = require('lodash/forEach');\n\nfunction generateValueId() {\n  return utils.nextId('Value_');\n}\n\n/**\n * Generate a form field specific textField using entryFactory.\n *\n * @param  {string} options.id\n * @param  {string} options.label\n * @param  {string} options.modelProperty\n * @param  {function} options.validate\n *\n * @return {Object} an entryFactory.textField object\n */\nfunction formFieldTextField(options, getSelectedFormField) {\n\n  var id = options.id,\n      label = options.label,\n      modelProperty = options.modelProperty,\n      validate = options.validate;\n\n  return entryFactory.textField({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    get: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node) || {},\n          values = {};\n\n      values[modelProperty] = selectedFormField[modelProperty];\n\n      return values;\n    },\n\n    set: function(element, values, node) {\n      var commands = [];\n\n      if (typeof options.set === 'function') {\n        var cmd = options.set(element, values, node);\n\n        if (cmd) {\n          commands.push(cmd);\n        }\n      }\n\n      var formField = getSelectedFormField(element, node),\n          properties = {};\n\n      properties[modelProperty] = values[modelProperty] || undefined;\n\n      commands.push(cmdHelper.updateBusinessObject(element, formField, properties));\n\n      return commands;\n    },\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    },\n    validate: validate\n  });\n}\n\nfunction ensureFormKeyAndDataSupported(element) {\n  return (\n    is(element, 'bpmn:StartEvent') && !is(element.parent, 'bpmn:SubProcess')\n  ) || is(element, 'bpmn:UserTask');\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!ensureFormKeyAndDataSupported(element)) {\n    return;\n  }\n\n\n  /**\n   * Return the currently selected form field querying the form field select box\n   * from the DOM.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {DOMElement} node - DOM element of any form field text input\n   *\n   * @return {ModdleElement} the currently selected form field\n   */\n  function getSelectedFormField(element, node) {\n    var selected = formFieldsEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    return formHelper.getFormField(element, selected.idx);\n  }\n\n  // [FormKey] form key text input field\n  group.entries.push(entryFactory.textField({\n    id : 'form-key',\n    label : translate('Form Key'),\n    modelProperty: 'formKey',\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n\n      return {\n        formKey: bo.get('camunda:formKey')\n      };\n    },\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element),\n          formKey = values.formKey || undefined;\n\n      return cmdHelper.updateBusinessObject(element, bo, { 'camunda:formKey': formKey });\n    }\n  }));\n\n  // [FormData] form field select box\n  var formFieldsEntry = extensionElements(element, bpmnFactory, {\n    id: 'form-fields',\n    label: translate('Form Fields'),\n    modelProperty: 'id',\n    prefix: 'FormField',\n    createExtensionElement: function(element, extensionElements, value) {\n      var bo = getBusinessObject(element), commands = [];\n\n      if (!extensionElements) {\n        extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n        commands.push(cmdHelper.updateProperties(element, { extensionElements: extensionElements }));\n      }\n\n      var formData = formHelper.getFormData(element);\n\n      if (!formData) {\n        formData = elementHelper.createElement('camunda:FormData', { fields: [] }, extensionElements, bpmnFactory);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [formData],\n          []\n        ));\n      }\n\n      var field = elementHelper.createElement('camunda:FormField', { id: value }, formData, bpmnFactory);\n      if (typeof formData.fields !== 'undefined') {\n        commands.push(cmdHelper.addElementsTolist(element, formData, 'fields', [ field ]));\n      } else {\n        commands.push(cmdHelper.updateBusinessObject(element, formData, {\n          fields: [ field ]\n        }));\n      }\n      return commands;\n    },\n    removeExtensionElement: function(element, extensionElements, value, idx) {\n      var formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0],\n          entry = formData.fields[idx],\n          commands = [];\n\n      if (formData.fields.length < 2) {\n        commands.push(removeEntry(getBusinessObject(element), element, formData));\n      } else {\n        commands.push(cmdHelper.removeElementsFromList(element, formData, 'fields', null, [entry]));\n\n        if (entry.id === formData.get('businessKey')) {\n          commands.push(cmdHelper.updateBusinessObject(element, formData, { 'businessKey': undefined }));\n        }\n      }\n\n      return commands;\n    },\n    getExtensionElements: function(element) {\n      return formHelper.getFormFields(element);\n    },\n    hideExtensionElements: function(element, node) {\n      return false;\n    }\n  });\n  group.entries.push(formFieldsEntry);\n\n  // [FormData] business key form field select box\n  var formBusinessKeyFormFieldEntry = entryFactory.selectBox({\n    id: 'form-business-key',\n    label: translate('Business Key'),\n    modelProperty: 'businessKey',\n    selectOptions: function(element, inputNode) {\n      var selectOptions = [{ name: '', value: '' }];\n      var formFields = formHelper.getFormFields(element);\n      each(formFields, function(field) {\n        if (field.type !== 'boolean') {\n          selectOptions.push({ name: field.id, value: field.id });\n        }\n      });\n      return selectOptions;\n    },\n    get: function(element, node) {\n      var result = { businessKey: '' };\n      var bo = getBusinessObject(element);\n      var formDataExtension = getExtensionElements(bo, 'camunda:FormData');\n      if (formDataExtension) {\n        var formData = formDataExtension[0];\n        var storedValue = formData.get('businessKey');\n        result = { businessKey: storedValue };\n      }\n      return result;\n    },\n    set: function(element, values, node) {\n      var formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0];\n      return cmdHelper.updateBusinessObject(element, formData, { 'businessKey': values.businessKey || undefined });\n    },\n    hidden: function(element, node) {\n      var isStartEvent = is(element,'bpmn:StartEvent');\n      return !(isStartEvent && formHelper.getFormFields(element).length > 0);\n    }\n  });\n  group.entries.push(formBusinessKeyFormFieldEntry);\n\n  // [FormData] Form Field label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-header',\n    labelText: translate('Form Field'),\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field id text input field\n  group.entries.push(entryFactory.validationAwareTextField({\n    id: 'form-field-id',\n    label: translate('ID'),\n    modelProperty: 'id',\n\n    getProperty: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node) || {};\n\n      return selectedFormField.id;\n    },\n\n    setProperty: function(element, properties, node) {\n      var formField = getSelectedFormField(element, node);\n\n      return cmdHelper.updateBusinessObject(element, formField, properties);\n    },\n\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    },\n\n    validate: function(element, values, node) {\n\n      var formField = getSelectedFormField(element, node);\n\n      if (formField) {\n\n        var idValue = values.id;\n\n        if (!idValue || idValue.trim() === '') {\n          return { id: 'Form field id must not be empty' };\n        }\n\n        var formFields = formHelper.getFormFields(element);\n\n        var existingFormField = find(formFields, function(f) {\n          return f !== formField && f.id === idValue;\n        });\n\n        if (existingFormField) {\n          return { id: 'Form field id already used in form data.' };\n        }\n      }\n    }\n  }));\n\n  // [FormData] form field type combo box\n  group.entries.push(entryFactory.comboBox({\n    id: 'form-field-type',\n    label: translate('Type'),\n    selectOptions: [\n      { name: 'string', value: 'string' },\n      { name: 'long', value: 'long' },\n      { name: 'boolean', value: 'boolean' },\n      { name: 'date', value: 'date' },\n      { name: 'enum', value: 'enum' }\n    ],\n    modelProperty: 'type',\n    emptyParameter: true,\n\n    get: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      if (selectedFormField) {\n        return { type: selectedFormField.type };\n      } else {\n        return {};\n      }\n    },\n    set: function(element, values, node) {\n      var selectedFormField = getSelectedFormField(element, node),\n          formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0],\n          commands = [];\n\n      if (selectedFormField.type === 'enum' && values.type !== 'enum') {\n        // delete camunda:value objects from formField.values when switching from type enum\n        commands.push(cmdHelper.updateBusinessObject(element, selectedFormField, { values: undefined }));\n      }\n      if (values.type === 'boolean' && selectedFormField.get('id') === formData.get('businessKey')) {\n        commands.push(cmdHelper.updateBusinessObject(element, formData, { 'businessKey': undefined }));\n      }\n      commands.push(cmdHelper.updateBusinessObject(element, selectedFormField, values));\n\n      return commands;\n    },\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field label text input field\n  group.entries.push(formFieldTextField({\n    id: 'form-field-label',\n    label: translate('Label'),\n    modelProperty: 'label'\n  }, getSelectedFormField));\n\n  // [FormData] form field defaultValue text input field\n  group.entries.push(formFieldTextField({\n    id: 'form-field-defaultValue',\n    label: translate('Default Value'),\n    modelProperty: 'defaultValue'\n  }, getSelectedFormField));\n\n\n  // [FormData] form field enum values label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-enum-values-header',\n    labelText: translate('Values'),\n    divider: true,\n    showLabel: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return selectedFormField && selectedFormField.type === 'enum';\n    }\n  }));\n\n  // [FormData] form field enum values table\n  group.entries.push(entryFactory.table({\n    id: 'form-field-enum-values',\n    labels: [ translate('Id'), translate('Name') ],\n    modelProperties: [ 'id', 'name' ],\n    show: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return selectedFormField && selectedFormField.type === 'enum';\n    },\n    getElements: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return formHelper.getEnumValues(selectedFormField);\n    },\n    addElement: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node),\n          id = generateValueId();\n\n      var enumValue = elementHelper.createElement(\n        'camunda:Value',\n        { id: id, name: undefined },\n        getBusinessObject(element),\n        bpmnFactory\n      );\n\n      return cmdHelper.addElementsTolist(element, selectedFormField, 'values', [enumValue]);\n    },\n    removeElement: function(element, node, idx) {\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      return cmdHelper.removeElementsFromList(element, selectedFormField, 'values', null, [enumValue]);\n    },\n    updateElement: function(element, value, node, idx) {\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      value.name = value.name || undefined;\n      return cmdHelper.updateBusinessObject(element, enumValue, value);\n    },\n    validate: function(element, value, node, idx) {\n\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      if (enumValue) {\n        // check if id is valid\n        var validationError = utils.isIdValid(enumValue, value.id, translate);\n\n        if (validationError) {\n          return { id: validationError };\n        }\n      }\n    }\n  }));\n\n  // [FormData] Validation label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-validation-header',\n    labelText: translate('Validation'),\n    divider: true,\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field constraints table\n  group.entries.push(entryFactory.table({\n    id: 'constraints-list',\n    modelProperties: [ 'name', 'config' ],\n    labels: [ translate('Name'), translate('Config') ],\n    addLabel: translate('Add Constraint'),\n    getElements: function(element, node) {\n      var formField = getSelectedFormField(element, node);\n\n      return formHelper.getConstraints(formField);\n    },\n    addElement: function(element, node) {\n\n      var commands = [],\n          formField = getSelectedFormField(element, node),\n          validation = formField.validation;\n\n      if (!validation) {\n        // create validation business object and add it to form data, if it doesn't exist\n        validation = elementHelper.createElement('camunda:Validation', {}, getBusinessObject(element), bpmnFactory);\n\n        commands.push(cmdHelper.updateBusinessObject(element, formField, { 'validation': validation }));\n      }\n\n      var newConstraint = elementHelper.createElement(\n        'camunda:Constraint',\n        { name: undefined, config: undefined },\n        validation,\n        bpmnFactory\n      );\n\n      commands.push(cmdHelper.addElementsTolist(element, validation, 'constraints', [ newConstraint ]));\n\n      return commands;\n    },\n    updateElement: function(element, value, node, idx) {\n      var formField = getSelectedFormField(element, node),\n          constraint = formHelper.getConstraints(formField)[idx];\n\n      value.name = value.name || undefined;\n      value.config = value.config || undefined;\n\n      return cmdHelper.updateBusinessObject(element, constraint, value);\n    },\n    removeElement: function(element, node, idx) {\n      var commands = [],\n          formField = getSelectedFormField(element, node),\n          constraints = formHelper.getConstraints(formField),\n          currentConstraint = constraints[idx];\n\n      commands.push(cmdHelper.removeElementsFromList(\n        element,\n        formField.validation,\n        'constraints',\n        null,\n        [ currentConstraint ]\n      ));\n\n      if (constraints.length === 1) {\n        // remove camunda:validation if the last existing constraint has been removed\n        commands.push(cmdHelper.updateBusinessObject(element, formField, { validation: undefined }));\n      }\n\n      return commands;\n    },\n    show: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] Properties label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-properties-header',\n    labelText: translate('Properties'),\n    divider: true,\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] camunda:properties table\n  group.entries.push(properties(element, bpmnFactory, {\n    id: 'form-field-properties',\n    modelProperties: [ 'id', 'value' ],\n    labels: [ translate('Id'), translate('Value') ],\n    getParent: function(element, node) {\n      return getSelectedFormField(element, node);\n    },\n    show: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }, translate));\n};\n","'use strict';\r\n\r\nvar entryFactory = require('../../../../factory/EntryFactory');\r\n\r\nvar cmdHelper = require('../../../../helper/CmdHelper');\r\n\r\nmodule.exports = function(element, bpmnFactory, options, translate) {\r\n\r\n  var getBusinessObject = options.getBusinessObject;\r\n\r\n  var isStartableInTasklistEntry = entryFactory.checkbox({\r\n    id: 'isStartableInTasklist',\r\n    label: translate('Startable'),\r\n    modelProperty: 'isStartableInTasklist',\r\n\r\n    get: function(element, node) {\r\n      var bo = getBusinessObject(element);\r\n      var isStartableInTasklist = bo.get('camunda:isStartableInTasklist');\r\n\r\n      return {\r\n        isStartableInTasklist: isStartableInTasklist ? isStartableInTasklist : ''\r\n      };\r\n    },\r\n\r\n    set: function(element, values) {\r\n      var bo = getBusinessObject(element);\r\n      return cmdHelper.updateBusinessObject(element, bo, {\r\n        'camunda:isStartableInTasklist': !!values.isStartableInTasklist\r\n      });\r\n    }\r\n\r\n  });\r\n\r\n  return [\r\n    isStartableInTasklistEntry\r\n  ];\r\n};\r\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar participantHelper = require('../../../helper/ParticipantHelper');\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'bpmn:Process') || (is(element, 'bpmn:Participant') && bo.get('processRef'))) {\n\n    var executableEntry = entryFactory.checkbox({\n      id: 'process-is-executable',\n      label: translate('Executable'),\n      modelProperty: 'isExecutable'\n    });\n\n    // in participants we have to change the default behavior of set and get\n    if (is(element, 'bpmn:Participant')) {\n      executableEntry.get = function(element) {\n        return participantHelper.getProcessBusinessObject(element, 'isExecutable');\n      };\n\n      executableEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'isExecutable', values);\n      };\n    }\n\n    group.entries.push(executableEntry);\n  }\n\n};\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, escalationEventDefinition, showEscalationCodeVariable, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, escalationEventDefinition, bpmnFactory, {\n    label: translate('Escalation'),\n    elementName: 'escalation',\n    elementType: 'bpmn:Escalation',\n    referenceProperty: 'escalationRef',\n    newElementIdPrefix: 'Escalation_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, escalationEventDefinition, bpmnFactory, {\n    id: 'escalation-element-name',\n    label: translate('Escalation Name'),\n    referenceProperty: 'escalationRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, escalationEventDefinition, bpmnFactory, {\n    id: 'escalation-element-code',\n    label: translate('Escalation Code'),\n    referenceProperty: 'escalationRef',\n    modelProperty: 'escalationCode'\n  }));\n\n\n  if (showEscalationCodeVariable) {\n    group.entries.push(entryFactory.textField({\n      id : 'escalationCodeVariable',\n      label : translate('Escalation Code Variable'),\n      modelProperty : 'escalationCodeVariable',\n\n      get: function(element) {\n        var codeVariable = escalationEventDefinition.get('camunda:escalationCodeVariable');\n        return {\n          escalationCodeVariable: codeVariable\n        };\n      },\n\n      set: function(element, values) {\n        return cmdHelper.updateBusinessObject(element, escalationEventDefinition, {\n          'camunda:escalationCodeVariable': values.escalationCodeVariable || undefined\n        });\n      }\n    }));\n  }\n};\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","var baseSetData = require('./_baseSetData'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets metadata for `func`.\n *\n * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n * period of time, it will trip its breaker and transition to an identity\n * function to avoid garbage collection pauses in V8. See\n * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n * for more details.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar setData = shortOut(baseSetData);\n\nmodule.exports = setData;\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nvar domQuery = require('min-dom').query,\n    domify = require('min-dom').domify,\n    domAttr = require('min-dom').attr;\n\nvar forEach = require('lodash/forEach'),\n    find = require('lodash/find');\n\nvar elementHelper = require('../../../../helper/ElementHelper');\nvar utils = require('../../../../Utils'),\n    escapeHTML = utils.escapeHTML;\n\nvar selector = 'select[name=selectedElement]';\n\n/**\n * Get select box containing all elements.\n *\n * @param {DOMElement} node\n *\n * @return {DOMElement} the select box\n */\nfunction getSelectBox(node) {\n  return domQuery(selector, node.parentElement);\n}\n\n/**\n * Find element by given id.\n *\n * @param {ModdleElement} eventDefinition\n *\n * @return {ModdleElement} an element\n */\nfunction findElementById(eventDefinition, type, id) {\n  var elements = utils.findRootElementsByType(eventDefinition, type);\n  return find(elements, function(element) {\n    return element.id === id;\n  });\n}\n\n/**\n * Create an entry to modify the reference to an element from an\n * event definition.\n *\n * @param  {djs.model.Base} element\n * @param  {ModdleElement} definition\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.label the label of the entry\n * @param  {string} options.description the description of the entry\n * @param  {string} options.elementName the name of the element\n * @param  {string} options.elementType the type of the element\n * @param  {string} options.referenceProperty the name of referencing property\n * @param  {string} options.newElementIdPrefix the prefix of a new created element\n *\n * @return {Array<Object>} return an array containing the entries\n */\nmodule.exports = function(element, definition, bpmnFactory, options) {\n\n  var elementName = options.elementName || '',\n      elementType = options.elementType,\n      referenceProperty = options.referenceProperty;\n\n  var newElementIdPrefix = options.newElementIdPrefix || 'elem_';\n\n  var label = options.label || '',\n      description = options.description || '';\n\n  var entries = [];\n\n  entries.push({\n\n    id: 'event-definitions-' + elementName,\n    description: description,\n    html: '<div class=\"bpp-row bpp-select\">' +\n             '<label for=\"camunda-' + escapeHTML(elementName) + '\">' + escapeHTML(label) + '</label>' +\n             '<div class=\"bpp-field-wrapper\">' +\n               '<select id=\"camunda-' + escapeHTML(elementName) + '\" name=\"selectedElement\" data-value>' +\n               '</select>' +\n               '<button class=\"add\" id=\"addElement\" data-action=\"addElement\"><span>+</span></button>' +\n             '</div>' +\n          '</div>',\n\n    get: function(element, entryNode) {\n      utils.updateOptionsDropDown(selector, definition, elementType, entryNode);\n      var reference = definition.get(referenceProperty);\n      return {\n        selectedElement: (reference && reference.id) || ''\n      };\n    },\n\n    set: function(element, values) {\n      var selection = values.selectedElement;\n\n      var props = {};\n\n      if (!selection || typeof selection === 'undefined') {\n        // remove reference to element\n        props[referenceProperty] = undefined;\n        return cmdHelper.updateBusinessObject(element, definition, props);\n      }\n\n      var commands = [];\n\n      var selectedElement = findElementById(definition, elementType, selection);\n      if (!selectedElement) {\n        var root = utils.getRoot(definition);\n\n        // create a new element\n        selectedElement = elementHelper.createElement(elementType, { name: selection }, root, bpmnFactory);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(element, root, 'rootElements', null, [ selectedElement ]));\n      }\n\n      // update reference to element\n      props[referenceProperty] = selectedElement;\n      commands.push(cmdHelper.updateBusinessObject(element, definition, props));\n\n      return commands;\n    },\n\n    addElement: function(element, inputNode) {\n      // note: this generated id will be used as name\n      // of the element and not as id\n      var id = utils.nextId(newElementIdPrefix);\n\n      var optionTemplate = domify('<option value=\"' + escapeHTML(id) + '\"> (id='+escapeHTML(id)+')' + '</option>');\n\n      // add new option\n      var selectBox = getSelectBox(inputNode);\n      selectBox.insertBefore(optionTemplate, selectBox.firstChild);\n\n      // select new element in the select box\n      forEach(selectBox, function(option) {\n        if (option.value === id) {\n          domAttr(option, 'selected', 'selected');\n        } else {\n          domAttr(option, 'selected', null);\n        }\n      });\n\n      return true;\n    }\n\n  });\n\n  return entries;\n\n};\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, messageEventDefinition, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, messageEventDefinition, bpmnFactory, {\n    label: translate('Message'),\n    elementName: 'message',\n    elementType: 'bpmn:Message',\n    referenceProperty: 'messageRef',\n    newElementIdPrefix: 'Message_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, messageEventDefinition, bpmnFactory, {\n    id: 'message-element-name',\n    label: translate('Message Name'),\n    referenceProperty: 'messageRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n};\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar jobPriority = require('./implementation/JobPriority'),\n    jobRetryTimeCycle = require('./implementation/JobRetryTimeCycle');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:JobPriorized') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(jobPriority(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n  }\n\n  if (is(element, 'camunda:AsyncCapable')) {\n    group.entries = group.entries.concat(jobRetryTimeCycle(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject\n    }, translate));\n  }\n\n};\n","'use strict';\n\nvar extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar assign = require('lodash/assign');\n\n\nvar DEFAULT_PROPS = {\n  'stringValue': undefined,\n  'string': undefined,\n  'expression': undefined\n};\n\nvar CAMUNDA_FIELD_EXTENSION_ELEMENT = 'camunda:Field';\n\nmodule.exports = function(element, bpmnFactory, translate, options) {\n\n  options = options || {};\n\n  var insideListener = !!options.insideListener,\n      idPrefix = options.idPrefix || '',\n      getSelectedListener = options.getSelectedListener,\n      businessObject = options.businessObject || getBusinessObject(element);\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelectedField(element, node);\n  };\n\n  function getSelectedField(element, node) {\n    var selected = fieldEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    var fields = getCamundaFields(element, node);\n\n    return fields[selected.idx];\n  }\n\n  function getCamundaFields(element, node) {\n    if (!insideListener) {\n      return (\n        businessObject &&\n        extensionElementsHelper.getExtensionElements(businessObject, CAMUNDA_FIELD_EXTENSION_ELEMENT)\n      ) || [];\n    }\n    return getCamundaListenerFields(element, node);\n  }\n\n  function getCamundaListenerFields(element, node) {\n    var selectedListener = getSelectedListener(element, node);\n    return selectedListener && selectedListener.fields || [];\n  }\n\n  function getFieldType(bo) {\n    var fieldType = 'string';\n\n    var expressionValue = bo && bo.expression;\n    var stringValue = bo && (bo.string || bo.stringValue);\n\n    if (typeof stringValue !== 'undefined') {\n      fieldType = 'string';\n    } else if (typeof expressionValue !== 'undefined') {\n      fieldType = 'expression';\n    }\n\n    return fieldType;\n  }\n\n  var setOptionLabelValue = function() {\n    return function(element, node, option, property, value, idx) {\n      var camundaFields = getCamundaFields(element, node);\n      var field = camundaFields[idx];\n\n      value = (field.name) ? field.name : '<empty>';\n\n      var label = idx + ' : ' + value;\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function() {\n    return function(element, extensionElements, value, node) {\n\n      var props = {\n        name: '',\n        string: ''\n      };\n\n      var newFieldElem;\n\n      if (!insideListener) {\n\n        newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, extensionElements, bpmnFactory);\n        return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newFieldElem ]);\n\n      } else {\n\n        var selectedListener = getSelectedListener(element, node);\n        newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, selectedListener, bpmnFactory);\n        return cmdHelper.addElementsTolist(element, selectedListener, 'fields', [ newFieldElem ]);\n\n      }\n\n    };\n  };\n\n  var removeElement = function() {\n    return function(element, extensionElements, value, idx, node) {\n      var camundaFields= getCamundaFields(element, node);\n      var field = camundaFields[idx];\n      if (field) {\n        if (!insideListener) {\n          return extensionElementsHelper.removeEntry(businessObject, element, field);\n        }\n        var selectedListener = getSelectedListener(element, node);\n        return cmdHelper.removeElementsFromList(element, selectedListener, 'fields', null, [ field ]);\n      }\n    };\n  };\n\n\n  var fieldEntry = extensionElementsEntry(element, bpmnFactory, {\n    id : idPrefix + 'fields',\n    label : translate('Fields'),\n    modelProperty: 'fieldName',\n    idGeneration: 'false',\n\n    businessObject: businessObject,\n\n    createExtensionElement: newElement(),\n    removeExtensionElement: removeElement(),\n\n    getExtensionElements: function(element, node) {\n      return getCamundaFields(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue()\n\n  });\n  entries.push(fieldEntry);\n\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: idPrefix + 'field-name',\n    label: translate('Name'),\n    modelProperty: 'fieldName',\n\n    getProperty: function(element, node) {\n      return (getSelectedField(element, node) || {}).name;\n    },\n\n    setProperty: function(element, values, node) {\n      var selectedField = getSelectedField(element, node);\n      return cmdHelper.updateBusinessObject(element, selectedField, { name : values.fieldName });\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.fieldName;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.fieldName = translate('Name must not contain spaces');\n          }\n        } else {\n          validation.fieldName = translate('Parameter must have a name');\n        }\n      }\n\n      return validation;\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n  var fieldTypeOptions = [\n    {\n      name: translate('String'),\n      value: 'string'\n    },\n    {\n      name: translate('Expression'),\n      value: 'expression'\n    }\n  ];\n\n  entries.push(entryFactory.selectBox({\n    id: idPrefix + 'field-type',\n    label: translate('Type'),\n    selectOptions: fieldTypeOptions,\n    modelProperty: 'fieldType',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n\n      var fieldType = getFieldType(bo);\n\n      return {\n        fieldType: fieldType\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldType = values.fieldType;\n\n      if (fieldType === 'string') {\n        props.string = '';\n      }\n      else if (fieldType === 'expression') {\n        props.expression = '';\n      }\n\n      return cmdHelper.updateBusinessObject(element, getSelectedField(element, node), props);\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  entries.push(entryFactory.textBox({\n    id: idPrefix + 'field-value',\n    label: translate('Value'),\n    modelProperty: 'fieldValue',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var fieldValue;\n\n      if (fieldType === 'string') {\n        fieldValue = bo && (bo.string || bo.stringValue);\n      }\n      else if (fieldType === 'expression') {\n        fieldValue = bo && bo.expression;\n      }\n\n      return {\n        fieldValue: fieldValue\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldValue = values.fieldValue || undefined;\n\n      if (fieldType === 'string') {\n        props.string = fieldValue;\n      }\n      else if (fieldType === 'expression') {\n        props.expression = fieldValue;\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        if (!values.fieldValue) {\n          validation.fieldValue = translate('Must provide a value');\n        }\n      }\n\n      return validation;\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar textField = require('./TextInputEntryFactory');\n\n/**\n * This function is a wrapper around TextInputEntryFactory.\n * It adds functionality to cache an invalid value entered in the\n * text input, instead of setting it on the business object.\n */\nvar validationAwareTextField = function(options, defaultParameters) {\n\n  var modelProperty = options.modelProperty;\n\n  defaultParameters.get = function(element, node) {\n    var value = this.__lastInvalidValue;\n\n    delete this.__lastInvalidValue;\n\n    var properties = {};\n\n    properties[modelProperty] = value !== undefined ? value : options.getProperty(element, node);\n\n    return properties;\n  };\n\n  defaultParameters.set = function(element, values, node) {\n    var validationErrors = validate.apply(this, [ element, values, node ]),\n        propertyValue = values[modelProperty];\n\n    // make sure we do not update the id\n    if (validationErrors && validationErrors[modelProperty]) {\n      this.__lastInvalidValue = propertyValue;\n\n      return options.setProperty(element, {}, node);\n    } else {\n      var properties = {};\n\n      properties[modelProperty] = propertyValue;\n\n      return options.setProperty(element, properties, node);\n    }\n  };\n\n  var validate = defaultParameters.validate = function(element, values, node) {\n    var value = values[modelProperty] || this.__lastInvalidValue;\n\n    var property = {};\n    property[modelProperty] = value;\n\n    return options.validate(element, property, node);\n  };\n\n  return textField(options, defaultParameters);\n};\n\nmodule.exports = validationAwareTextField;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=style&index=0&id=8d3627ba&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=style&index=0&id=8d3627ba&scoped=true&lang=css&\"","// iterable DOM collections\n// flag - `iterable` interface - 'entries', 'keys', 'values', 'forEach' methods\nmodule.exports = {\n  CSSRuleList: 0,\n  CSSStyleDeclaration: 0,\n  CSSValueList: 0,\n  ClientRectList: 0,\n  DOMRectList: 0,\n  DOMStringList: 0,\n  DOMTokenList: 1,\n  DataTransferItemList: 0,\n  FileList: 0,\n  HTMLAllCollection: 0,\n  HTMLCollection: 0,\n  HTMLFormElement: 0,\n  HTMLSelectElement: 0,\n  MediaList: 0,\n  MimeTypeArray: 0,\n  NamedNodeMap: 0,\n  NodeList: 1,\n  PaintRequestList: 0,\n  Plugin: 0,\n  PluginArray: 0,\n  SVGLengthList: 0,\n  SVGNumberList: 0,\n  SVGPathSegList: 0,\n  SVGPointList: 0,\n  SVGStringList: 0,\n  SVGTransformList: 0,\n  SourceBufferList: 0,\n  StyleSheetList: 0,\n  TextTrackCueList: 0,\n  TextTrackList: 0,\n  TouchList: 0\n};\n","var arrayEach = require('./_arrayEach'),\n    arrayIncludes = require('./_arrayIncludes');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256,\n    WRAP_FLIP_FLAG = 512;\n\n/** Used to associate wrap methods with their bit flags. */\nvar wrapFlags = [\n  ['ary', WRAP_ARY_FLAG],\n  ['bind', WRAP_BIND_FLAG],\n  ['bindKey', WRAP_BIND_KEY_FLAG],\n  ['curry', WRAP_CURRY_FLAG],\n  ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n  ['flip', WRAP_FLIP_FLAG],\n  ['partial', WRAP_PARTIAL_FLAG],\n  ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n  ['rearg', WRAP_REARG_FLAG]\n];\n\n/**\n * Updates wrapper `details` based on `bitmask` flags.\n *\n * @private\n * @returns {Array} details The details to modify.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Array} Returns `details`.\n */\nfunction updateWrapDetails(details, bitmask) {\n  arrayEach(wrapFlags, function(pair) {\n    var value = '_.' + pair[0];\n    if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n      details.push(value);\n    }\n  });\n  return details.sort();\n}\n\nmodule.exports = updateWrapDetails;\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks that no fake join is modeled by attempting\n * to give a task or event join semantics.\n *\n * Users should model a parallel joining gateway\n * to achieve the desired behavior.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Event'\n    ])) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n\n    if (incoming.length > 1) {\n      reporter.report(node.id, 'Incoming flows do not join');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","//      \n// An event handler can take an optional event argument\n// and should not return a value\n                                          \n                                                               \n\n// An array of all currently registered event handlers for a type\n                                            \n                                                            \n// A map of event types and their corresponding event handlers.\n                        \n                                 \n                                   \n  \n\n/** Mitt: Tiny (~200b) functional event emitter / pubsub.\n *  @name mitt\n *  @returns {Mitt}\n */\nfunction mitt(all                 ) {\n\tall = all || Object.create(null);\n\n\treturn {\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to listen for, or `\"*\"` for all events\n\t\t * @param  {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton: function on(type        , handler              ) {\n\t\t\t(all[type] || (all[type] = [])).push(handler);\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to unregister `handler` from, or `\"*\"`\n\t\t * @param  {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff: function off(type        , handler              ) {\n\t\t\tif (all[type]) {\n\t\t\t\tall[type].splice(all[type].indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * @param {String} type  The event type to invoke\n\t\t * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit: function emit(type        , evt     ) {\n\t\t\t(all[type] || []).slice().map(function (handler) { handler(evt); });\n\t\t\t(all['*'] || []).slice().map(function (handler) { handler(type, evt); });\n\t\t}\n\t};\n}\n\nexport default mitt;\n//# sourceMappingURL=mitt.es.js.map\n","import {\n  domify,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  query as domQuery,\n  queryAll as domQueryAll,\n  event as domEvent,\n  attr as domAttr\n} from 'min-dom';\n\nimport {\n  filter,\n  assign\n} from 'min-dash';\n\nimport createEmitter from 'mitt';\n\nvar DEFAULT_OPTIONS = {\n  scrollSymbolLeft: '‹',\n  scrollSymbolRight: '›'\n};\n\n\n/**\n * This component adds the functionality to scroll over a list of tabs.\n *\n * It adds scroll buttons on the left and right side of the tabs container\n * if not all tabs are visible. It also adds a mouse wheel listener on the\n * container.\n *\n * If either a button is clicked or the mouse wheel is used over the tabs,\n * a 'scroll' event is being fired. This event contains the node elements\n * of the new and old active tab, and the direction in which the tab has\n * changed relative to the old active tab.\n *\n * @example:\n * (1) provide a tabs-container:\n *\n * var $el = (\n *   <div>\n *     <!-- button added by scrollTabs -->\n *     <span class=\"scroll-tabs-button scroll-tabs-left\"></span>\n *     <ul class=\"my-tabs-container\">\n *       <li class=\"my-tab i-am-active\"></li>\n *       <li class=\"my-tab\"></li>\n *       <li class=\"my-tab ignore-me\"></li>\n *     </ul>\n *     <!-- button added by scrollTabs -->\n *     <span class=\"scroll-tabs-button scroll-tabs-right\"></span>\n *   </div>\n * );\n *\n *\n * (2) initialize scrollTabs:\n *\n *  var scroller = scrollTabs(tabBarNode, {\n *    selectors: {\n *      tabsContainer: '.my-tabs-container',\n *      tab: '.my-tab',\n *      ignore: '.ignore-me',\n *      active: '.i-am-active'\n *    }\n *  });\n *\n *\n * (3) listen to the scroll event:\n *\n * scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n *   // direction is any of (-1: left, 1: right)\n *   // activate the new active tab\n * });\n *\n *\n * (4) update the scroller if tabs change and or the tab container resizes:\n *\n * scroller.update();\n *\n *\n * @param  {DOMElement} el\n * @param  {Object} options\n * @param  {Object} options.selectors\n * @param  {String} options.selectors.tabsContainer the container all tabs are contained in\n * @param  {String} options.selectors.tab a single tab inside the tab container\n * @param  {String} options.selectors.ignore tabs that should be ignored during scroll left/right\n * @param  {String} options.selectors.active selector for the current active tab\n * @param  {String} [options.scrollSymbolLeft]\n * @param  {String} [options.scrollSymbolRight]\n */\nfunction ScrollTabs($el, options) {\n\n  // we are an event emitter\n  assign(this, createEmitter());\n\n  this.options = options = assign({}, DEFAULT_OPTIONS, options);\n  this.container = $el;\n\n  this._createScrollButtons($el, options);\n\n  this._bindEvents($el);\n}\n\n\n/**\n * Create a clickable scroll button\n *\n * @param {Object} options\n * @param {String} options.className\n * @param {String} options.label\n * @param {Number} options.direction\n *\n * @return {DOMElement} The created scroll button node\n */\nScrollTabs.prototype._createButton = function(parentNode, options) {\n\n  var className = options.className,\n      direction = options.direction;\n\n\n  var button = domQuery('.' + className, parentNode);\n\n  if (!button) {\n    button = domify('<span class=\"scroll-tabs-button ' + className + '\">' +\n                                options.label +\n                              '</span>');\n\n    parentNode.insertBefore(button, parentNode.childNodes[0]);\n  }\n\n  domAttr(button, 'data-direction', direction);\n\n  return button;\n};\n\n/**\n * Create both scroll buttons\n *\n * @param  {DOMElement} parentNode\n * @param  {Object} options\n * @param  {String} options.scrollSymbolLeft\n * @param  {String} options.scrollSymbolRight\n */\nScrollTabs.prototype._createScrollButtons = function(parentNode, options) {\n\n  // Create a button that scrolls to the tab left to the currently active tab\n  this._createButton(parentNode, {\n    className: 'scroll-tabs-left',\n    label: options.scrollSymbolLeft,\n    direction: -1\n  });\n\n  // Create a button that scrolls to the tab right to the currently active tab\n  this._createButton(parentNode, {\n    className: 'scroll-tabs-right',\n    label: options.scrollSymbolRight,\n    direction: 1\n  });\n};\n\n/**\n * Get the current active tab\n *\n * @return {DOMElement}\n */\nScrollTabs.prototype.getActiveTabNode = function() {\n  return domQuery(this.options.selectors.active, this.container);\n};\n\n\n/**\n * Get the container all tabs are contained in\n *\n * @return {DOMElement}\n */\nScrollTabs.prototype.getTabsContainerNode = function() {\n  return domQuery(this.options.selectors.tabsContainer, this.container);\n};\n\n\n/**\n * Get all tabs (visible and invisible ones)\n *\n * @return {Array<DOMElement>}\n */\nScrollTabs.prototype.getAllTabNodes = function() {\n  return domQueryAll(this.options.selectors.tab, this.container);\n};\n\n\n/**\n * Gets all tabs that don't have the ignore class set\n *\n * @return {Array<DOMElement>}\n */\nScrollTabs.prototype.getVisibleTabs = function() {\n  var allTabs = this.getAllTabNodes();\n\n  var ignore = this.options.selectors.ignore;\n\n  return filter(allTabs, function(tabNode) {\n    return !domMatches(tabNode, ignore);\n  });\n};\n\n\n/**\n * Get a tab relative to a reference tab.\n *\n * @param  {DOMElement} referenceTabNode\n * @param  {Number} n gets the nth tab next or previous to the reference tab\n *\n * @return {DOMElement}\n *\n * @example:\n * Visible tabs: [ A | B | C | D | E ]\n * Assume tab 'C' is the reference tab:\n * If direction === -1, it returns tab 'B',\n * if direction ===  2, it returns tab 'E'\n */\nScrollTabs.prototype.getAdjacentTab = function(referenceTabNode, n) {\n  var visibleTabs = this.getVisibleTabs();\n\n  var index = visibleTabs.indexOf(referenceTabNode);\n\n  return visibleTabs[index + n];\n};\n\nScrollTabs.prototype._bindEvents = function(node) {\n  this._bindWheelEvent(node);\n  this._bindTabClickEvents(node);\n  this._bindScrollButtonEvents(node);\n};\n\n/**\n *  Bind a click listener to a DOM node.\n *  Make sure a tab link is entirely visible after onClick.\n *\n * @param {DOMElement} node\n */\nScrollTabs.prototype._bindTabClickEvents = function(node) {\n  var selector = this.options.selectors.tab;\n\n  var self = this;\n\n  domDelegate.bind(node, selector, 'click', function onClick(event) {\n    self.scrollToTabNode(event.delegateTarget);\n  });\n};\n\n\n/**\n * Bind the wheel event listener to a DOM node\n *\n * @param {DOMElement} node\n */\nScrollTabs.prototype._bindWheelEvent = function(node) {\n  var self = this;\n\n  domEvent.bind(node, 'wheel', function(e) {\n\n    // scroll direction (-1: left, 1: right)\n    var direction = Math.sign(e.deltaY);\n\n    var oldActiveTab = self.getActiveTabNode();\n\n    var newActiveTab = self.getAdjacentTab(oldActiveTab, direction);\n\n    if (newActiveTab) {\n      self.scrollToTabNode(newActiveTab);\n      self.emit('scroll', newActiveTab, oldActiveTab, direction);\n    }\n\n    e.preventDefault();\n  });\n};\n\n/**\n * Bind scroll button events to a DOM node\n *\n * @param  {DOMElement} node\n */\nScrollTabs.prototype._bindScrollButtonEvents = function(node) {\n\n  var self = this;\n\n  domDelegate.bind(node, '.scroll-tabs-button', 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    // data-direction is either -1 or 1\n    var direction = parseInt(domAttr(target, 'data-direction'), 10);\n\n    var oldActiveTabNode = self.getActiveTabNode();\n\n    var newActiveTabNode = self.getAdjacentTab(oldActiveTabNode, direction);\n\n    if (newActiveTabNode) {\n      self.scrollToTabNode(newActiveTabNode);\n      self.emit('scroll', newActiveTabNode, oldActiveTabNode, direction);\n    }\n\n    event.preventDefault();\n  });\n};\n\n\n/**\n* Scroll to a tab if it is not entirely visible\n*\n* @param  {DOMElement} tabNode tab node to scroll to\n*/\nScrollTabs.prototype.scrollToTabNode = function(tabNode) {\n  if (!tabNode) {\n    return;\n  }\n\n  var tabsContainerNode = tabNode.parentNode;\n\n  var tabWidth = tabNode.offsetWidth,\n      tabOffsetLeft = tabNode.offsetLeft,\n      tabOffsetRight = tabOffsetLeft + tabWidth,\n      containerWidth = tabsContainerNode.offsetWidth,\n      containerScrollLeft = tabsContainerNode.scrollLeft;\n\n  if (containerScrollLeft > tabOffsetLeft) {\n    // scroll to the left, if the tab is overflowing on the left side\n    tabsContainerNode.scrollLeft = 0;\n  } else if (tabOffsetRight > containerWidth) {\n    // scroll to the right, if the tab is overflowing on the right side\n    tabsContainerNode.scrollLeft = tabOffsetRight - containerWidth;\n  }\n};\n\n\n/**\n * React on tab changes from outside (resize/show/hide/add/remove),\n * update scroll button visibility.\n */\nScrollTabs.prototype.update = function() {\n\n  var tabsContainerNode = this.getTabsContainerNode();\n\n  // check if tabs fit in container\n  var overflow = tabsContainerNode.scrollWidth > tabsContainerNode.offsetWidth;\n\n  // TODO(nikku): distinguish overflow left / overflow right?\n  var overflowClass = 'scroll-tabs-overflow';\n\n  domClasses(this.container).toggle(overflowClass, overflow);\n\n  if (overflow) {\n    // make sure the current active tab is always visible\n    this.scrollToTabNode(this.getActiveTabNode());\n  }\n};\n\n\n// exports ////////////////\n\n/**\n * Create a scrollTabs instance on the given element.\n *\n * @param {DOMElement} $el\n * @param {Object} options\n *\n * @return {ScrollTabs}\n */\nexport default function create($el, options) {\n\n  var scrollTabs = get($el);\n\n  if (!scrollTabs) {\n    scrollTabs = new ScrollTabs($el, options);\n\n    $el.__scrollTabs = scrollTabs;\n  }\n\n  return scrollTabs;\n}\n\n\n/**\n * Return the scrollTabs instance that has been previously\n * initialized on the element.\n *\n * @param {DOMElement} $el\n * @return {ScrollTabs}\n */\nfunction get($el) {\n  return $el.__scrollTabs;\n}\n\ncreate.get = get;","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n"],"sourceRoot":""}