{"version":3,"sources":["webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerDetailProps.js","webpack:///./node_modules/lodash/_getRawTag.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/CallActivityProps.js","webpack:///./node_modules/lodash/_baseKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorInputOutputProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorDetailProps.js","webpack:///./node_modules/lodash/_isFlattenable.js","webpack:///./src/components/Search.vue?528b","webpack:///./node_modules/lodash/stubFalse.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Properties.js","webpack:///./node_modules/lodash/_arrayPush.js","webpack:///./node_modules/lodash/_isStrictComparable.js","webpack:///./node_modules/lodash/_strictIndexOf.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/CreateHelper.js","webpack:///./node_modules/lodash/_getNative.js","webpack:///./node_modules/lodash/isBuffer.js","webpack:///./node_modules/lodash/_baseRest.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/EventProps.js","webpack:///./node_modules/lodash/_getFuncName.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ElementHelper.js","webpack:///./node_modules/bpmnlint/rules/conditional-flows.js","webpack:///./node_modules/lodash/_createCtor.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/HistoryTimeToLiveProps.js","webpack:///./node_modules/lodash/_isKeyable.js","webpack:///./node_modules/lodash/_castFunction.js","webpack:///./node_modules/lodash/isObjectLike.js","webpack:///./node_modules/lodash/_isMasked.js","webpack:///./node_modules/lodash/isEmpty.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/util/ModelingUtil.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/CandidateStarter.js","webpack:///./node_modules/lodash/_baseMatchesProperty.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/LinkEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Callable.js","webpack:///./node_modules/lodash/_stringToPath.js","webpack:///./node_modules/lodash/isObject.js","webpack:///./src/network/request.js","webpack:///./node_modules/lodash/_equalByTag.js","webpack:///./node_modules/bpmn-js-properties-panel/index.js","webpack:///./node_modules/lodash/_Promise.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/CreateBusinessObjectListHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/TimerEventDefinition.js","webpack:///./node_modules/core-js/internals/array-method-has-species-support.js","webpack:///./node_modules/lodash/_hashDelete.js","webpack:///./node_modules/lodash/_mapCacheSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/External.js","webpack:///./node_modules/lodash/_matchesStrictComparable.js","webpack:///./node_modules/lodash/_overRest.js","webpack:///./node_modules/lodash/_memoizeCapped.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/CustomElementsPropertiesActivator.js","webpack:///./node_modules/lodash/_baseForOwn.js","webpack:///./node_modules/lodash/_baseAggregator.js","webpack:///./node_modules/lodash/_Uint8Array.js","webpack:///./node_modules/lodash/_mapCacheGet.js","webpack:///./node_modules/lodash/_hashSet.js","webpack:///./node_modules/lodash/_baseIsArguments.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerFieldInjectionProps.js","webpack:///./node_modules/lodash/_realNames.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/NameProps.js","webpack:///./node_modules/lodash/_baseValues.js","webpack:///./node_modules/lodash/bind.js","webpack:///./node_modules/lodash/_baseHasIn.js","webpack:///./node_modules/lodash/find.js","webpack:///./node_modules/lodash/_getData.js","webpack:///./node_modules/lodash/_listCacheClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/Name.js","webpack:///./src/components/Editor/fileLoader.vue?4c5e","webpack:///src/components/Editor/fileLoader.vue","webpack:///./src/components/Editor/fileLoader.vue?38e7","webpack:///./src/components/Editor/fileLoader.vue","webpack:///./node_modules/lodash/_objectToString.js","webpack:///./node_modules/lodash/wrapperLodash.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/ElementTemplates.js","webpack:///./node_modules/bpmnlint/lib/linter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/CmdHelper.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ExtensionElementsHelper.js","webpack:///./node_modules/lodash/_baseFindIndex.js","webpack:///./node_modules/lodash/_root.js","webpack:///./node_modules/lodash/_baseUniq.js","webpack:///./node_modules/lodash/_arrayFilter.js","webpack:///./node_modules/lodash/_getPrototype.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/UserTaskProps.js","webpack:///./node_modules/lodash/_baseDifference.js","webpack:///./node_modules/lodash/_createAssigner.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ListenerProps.js","webpack:///./node_modules/lodash/_stackDelete.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/IdProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/Utils.js","webpack:///./node_modules/lodash/_composeArgsRight.js","webpack:///./node_modules/lodash/isArrayLike.js","webpack:///./node_modules/bpmnlint/rules/single-event-definition.js","webpack:///./node_modules/lodash/_assignValue.js","webpack:///./node_modules/lodash/_getSymbols.js","webpack:///./node_modules/lodash/_baseIsNative.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Validator.js","webpack:///./node_modules/lodash/_getValue.js","webpack:///./node_modules/lodash/_baseGetTag.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/InputOutput.js","webpack:///./node_modules/lodash/_isLaziable.js","webpack:///./node_modules/bpmnlint/rules/end-event-required.js","webpack:///./node_modules/lodash/_WeakMap.js","webpack:///./node_modules/lodash/_defineProperty.js","webpack:///./node_modules/lodash/_getMatchData.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/HistoryTimeToLive.js","webpack:///./node_modules/lodash/values.js","webpack:///./node_modules/lodash/now.js","webpack:///./node_modules/bpmnlint/rules/sub-process-blank-start-event.js","webpack:///./node_modules/qs/lib/stringify.js","webpack:///./node_modules/lodash/keyBy.js","webpack:///./node_modules/lodash/xor.js","webpack:///./node_modules/lodash/_getMapData.js","webpack:///./node_modules/lodash/_arraySome.js","webpack:///./node_modules/lodash/_getTag.js","webpack:///./node_modules/qs/lib/index.js","webpack:///./node_modules/lodash/_copyArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ServiceTaskDelegateProps.js","webpack:///./node_modules/lodash/_baseLodash.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/parts/ChooserProps.js","webpack:///./node_modules/lodash/_createCurry.js","webpack:///./node_modules/lodash/_baseIndexOf.js","webpack:///./node_modules/lodash/_baseEach.js","webpack:///./node_modules/lodash/_hashClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/cmd/ChangeElementTemplateHandler.js","webpack:///./node_modules/lodash/toInteger.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/MultiInstanceLoopProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TextBoxEntryFactory.js","webpack:///./node_modules/core-js/modules/es.array.filter.js","webpack:///./node_modules/lodash/_setWrapToString.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/AsyncCapableHelper.js","webpack:///./node_modules/lodash/_createAggregator.js","webpack:///./node_modules/lodash/transform.js","webpack:///./node_modules/lodash/_baseTimes.js","webpack:///./node_modules/lodash/findIndex.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/SignalEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/UpdateBusinessObjectListHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/InputOutputHelper.js","webpack:///./node_modules/lodash/_stackHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ErrorEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TableEntryFactory.js","webpack:///./node_modules/lodash/_nativeKeys.js","webpack:///./node_modules/lodash/_getHolder.js","webpack:///./node_modules/lodash/_freeGlobal.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/FieldInjectionProps.js","webpack:///./node_modules/lodash/_baseFlatten.js","webpack:///./node_modules/lodash/_createFind.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ScriptTaskProps.js","webpack:///./node_modules/lodash/_ListCache.js","webpack:///./node_modules/lodash/_arrayIncludesWith.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/LabelFactory.js","webpack:///./node_modules/lodash/_nativeCreate.js","webpack:///./node_modules/lodash/_LazyWrapper.js","webpack:///(webpack)/buildin/module.js","webpack:///./node_modules/lodash/toFinite.js","webpack:///./node_modules/lodash/_baseMatches.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConditionalProps.js","webpack:///./node_modules/lodash/_baseGet.js","webpack:///./node_modules/core-js/internals/array-species-create.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobPriority.js","webpack:///./node_modules/lodash/isArray.js","webpack:///./node_modules/lodash/_listCacheSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/index.js","webpack:///./node_modules/bpmnlint/rules/no-duplicate-sequence-flows.js","webpack:///./node_modules/bpmnlint/rules/event-sub-process-typed-start-event.js","webpack:///./src/components/FileUpload.vue?7528","webpack:///src/components/FileUpload.vue","webpack:///./src/components/FileUpload.vue?cda3","webpack:///./src/components/FileUpload.vue","webpack:///./node_modules/lodash/_listCacheDelete.js","webpack:///./node_modules/lodash/_createHybrid.js","webpack:///./node_modules/lodash/_metaMap.js","webpack:///./node_modules/lodash/forEach.js","webpack:///./node_modules/bpmnlint/lib/traverse.js","webpack:///./node_modules/lodash/_arrayLikeKeys.js","webpack:///./node_modules/bpmn-js/lib/BaseModeler.js","webpack:///./node_modules/diagram-js/lib/features/touch/TouchInteractionEvents.js","webpack:///./node_modules/diagram-js/lib/features/touch/TouchFix.js","webpack:///./node_modules/diagram-js/lib/features/touch/index.js","webpack:///./node_modules/diagram-js/lib/navigation/touch/index.js","webpack:///./node_modules/diagram-js/lib/features/align-elements/AlignElements.js","webpack:///./node_modules/diagram-js/lib/features/align-elements/index.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlaceUtil.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlace.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/AutoPlaceSelectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/auto-place/index.js","webpack:///./node_modules/diagram-js/lib/command/CommandInterceptor.js","webpack:///./node_modules/diagram-js/lib/features/auto-resize/AutoResize.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/BpmnAutoResize.js","webpack:///./node_modules/diagram-js/lib/features/rules/RuleProvider.js","webpack:///./node_modules/diagram-js/lib/features/auto-resize/AutoResizeProvider.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/BpmnAutoResizeProvider.js","webpack:///./node_modules/bpmn-js/lib/features/auto-resize/index.js","webpack:///./node_modules/diagram-js/lib/features/dragging/Dragging.js","webpack:///./node_modules/diagram-js/lib/features/dragging/HoverFix.js","webpack:///./node_modules/diagram-js/lib/features/dragging/index.js","webpack:///./node_modules/diagram-js/lib/features/auto-scroll/AutoScroll.js","webpack:///./node_modules/diagram-js/lib/features/auto-scroll/index.js","webpack:///./node_modules/diagram-js/lib/features/rules/Rules.js","webpack:///./node_modules/diagram-js/lib/features/rules/index.js","webpack:///./node_modules/diagram-js/lib/util/LineIntersection.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointUtil.js","webpack:///./node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/Bendpoints.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointMove.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointMovePreview.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/ConnectionSegmentMove.js","webpack:///./node_modules/diagram-js/lib/features/snapping/SnapUtil.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/BendpointSnapping.js","webpack:///./node_modules/diagram-js/lib/features/bendpoints/index.js","webpack:///./node_modules/diagram-js/lib/features/connect/Connect.js","webpack:///./node_modules/diagram-js/lib/features/connect/ConnectPreview.js","webpack:///./node_modules/diagram-js/lib/features/connect/index.js","webpack:///./node_modules/diagram-js/lib/features/connection-preview/ConnectionPreview.js","webpack:///./node_modules/diagram-js/lib/features/connection-preview/index.js","webpack:///./node_modules/diagram-js-direct-editing/lib/TextBox.js","webpack:///./node_modules/diagram-js-direct-editing/lib/DirectEditing.js","webpack:///./node_modules/diagram-js-direct-editing/index.js","webpack:///./node_modules/diagram-js/lib/features/context-pad/ContextPad.js","webpack:///./node_modules/diagram-js/lib/features/context-pad/index.js","webpack:///./node_modules/diagram-js/lib/features/preview-support/PreviewSupport.js","webpack:///./node_modules/diagram-js/lib/features/preview-support/index.js","webpack:///./node_modules/diagram-js/lib/features/create/Create.js","webpack:///./node_modules/diagram-js/lib/features/create/CreatePreview.js","webpack:///./node_modules/diagram-js/lib/features/create/index.js","webpack:///./node_modules/diagram-js/lib/features/popup-menu/PopupMenu.js","webpack:///./node_modules/diagram-js/lib/features/popup-menu/index.js","webpack:///./node_modules/diagram-js/lib/features/clipboard/Clipboard.js","webpack:///./node_modules/diagram-js/lib/features/clipboard/index.js","webpack:///./node_modules/diagram-js/lib/features/mouse/Mouse.js","webpack:///./node_modules/diagram-js/lib/features/mouse/index.js","webpack:///./node_modules/diagram-js/lib/features/copy-paste/CopyPaste.js","webpack:///./node_modules/diagram-js/lib/features/copy-paste/index.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/BpmnCopyPaste.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/ModdleCopy.js","webpack:///./node_modules/bpmn-js/lib/features/copy-paste/index.js","webpack:///./node_modules/diagram-js/lib/features/replace/Replace.js","webpack:///./node_modules/diagram-js/lib/features/replace/index.js","webpack:///./node_modules/bpmn-js/lib/features/replace/BpmnReplace.js","webpack:///./node_modules/bpmn-js/lib/features/replace/index.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/util/TypeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/replace/ReplaceOptions.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/ReplaceMenuProvider.js","webpack:///./node_modules/bpmn-js/lib/features/popup-menu/index.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/util/LaneUtil.js","webpack:///./node_modules/bpmn-js/lib/features/context-pad/ContextPadProvider.js","webpack:///./node_modules/bpmn-js/lib/features/context-pad/index.js","webpack:///./node_modules/diagram-js/lib/features/distribute-elements/DistributeElements.js","webpack:///./node_modules/diagram-js/lib/features/distribute-elements/index.js","webpack:///./node_modules/bpmn-js/lib/features/distribute-elements/BpmnDistributeElements.js","webpack:///./node_modules/bpmn-js/lib/features/distribute-elements/index.js","webpack:///./node_modules/diagram-js/lib/features/editor-actions/EditorActions.js","webpack:///./node_modules/diagram-js/lib/features/editor-actions/index.js","webpack:///./node_modules/bpmn-js/lib/features/editor-actions/BpmnEditorActions.js","webpack:///./node_modules/bpmn-js/lib/features/editor-actions/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/BpmnGridSnapping.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/GridUtil.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/GridSnapping.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/ResizeBehavior.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/SpaceToolBehavior.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/behavior/index.js","webpack:///./node_modules/diagram-js/lib/features/grid-snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/AutoPlaceBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/CreateParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/LayoutConnectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/behavior/index.js","webpack:///./node_modules/bpmn-js/lib/features/grid-snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/interaction-events/BpmnInteractionEvents.js","webpack:///./node_modules/bpmn-js/lib/features/interaction-events/index.js","webpack:///./node_modules/bpmn-js/lib/features/keyboard/BpmnKeyboardBindings.js","webpack:///./node_modules/bpmn-js/lib/features/keyboard/index.js","webpack:///./node_modules/diagram-js/lib/features/keyboard-move-selection/KeyboardMoveSelection.js","webpack:///./node_modules/diagram-js/lib/features/keyboard-move-selection/index.js","webpack:///./node_modules/diagram-js/lib/features/change-support/ChangeSupport.js","webpack:///./node_modules/diagram-js/lib/features/change-support/index.js","webpack:///./node_modules/diagram-js/lib/features/resize/Resize.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizePreview.js","webpack:///./node_modules/diagram-js/lib/features/resize/ResizeHandles.js","webpack:///./node_modules/diagram-js/lib/features/resize/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/CategoryUtil.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/LabelEditingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/LabelEditingPreview.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AdaptiveLabelPositioningBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AppendBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AssociationBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/AttachEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/BoundaryEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RootElementReferenceBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/FixHoverBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateDataObjectBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/CreateParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DataInputAssociationBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateSemanticParentHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DataStoreBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DeleteLaneBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DetachEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/DropOnFlowBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/EventBasedGatewayBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/GroupBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LineIntersect.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ImportDockingFix.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/IsHorizontalFix.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/GeometricUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LineAttachmentUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/LabelLayoutUtil.js","webpack:///./node_modules/diagram-js/lib/util/AttachUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/LabelBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ModelingFeedback.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ReplaceConnectionBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RemoveParticipantBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ReplaceElementBehaviour.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/util/ResizeUtil.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ResizeBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ResizeLaneBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/RemoveElementBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/SpaceToolBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/SubProcessStartEventBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/ToggleElementCollapseBehaviour.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UnclaimIdBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UpdateFlowNodeRefsBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/UnsetDefaultFlowBehavior.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/behavior/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnSnappingUtil.js","webpack:///./node_modules/bpmn-js/lib/features/rules/BpmnRules.js","webpack:///./node_modules/bpmn-js/lib/features/rules/index.js","webpack:///./node_modules/diagram-js/lib/features/ordering/OrderingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/ordering/BpmnOrderingProvider.js","webpack:///./node_modules/bpmn-js/lib/features/ordering/index.js","webpack:///./node_modules/diagram-js/lib/command/CommandStack.js","webpack:///./node_modules/diagram-js/lib/command/index.js","webpack:///./node_modules/diagram-js/lib/features/tooltips/Tooltips.js","webpack:///./node_modules/diagram-js/lib/features/tooltips/index.js","webpack:///./node_modules/diagram-js/lib/util/Removal.js","webpack:///./node_modules/diagram-js/lib/features/label-support/LabelSupport.js","webpack:///./node_modules/diagram-js/lib/features/label-support/index.js","webpack:///./node_modules/diagram-js/lib/features/attach-support/AttachSupport.js","webpack:///./node_modules/diagram-js/lib/features/attach-support/index.js","webpack:///./node_modules/diagram-js/lib/features/tool-manager/ToolManager.js","webpack:///./node_modules/diagram-js/lib/features/tool-manager/index.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceUtil.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceTool.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/SpaceToolPreview.js","webpack:///./node_modules/diagram-js/lib/features/space-tool/index.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnFactory.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnUpdater.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/ElementFactory.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/AlignElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/AppendShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/CreateLabelHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DeleteShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/DistributeElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/LayoutConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/AnchorsHelper.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveClosure.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/helper/MoveHelper.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveElementsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/MoveShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ReconnectConnectionHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ReplaceShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ResizeShapeHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/SpaceToolHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/ToggleShapeCollapseHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/UpdateAttachmentHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/cmd/UpdateWaypointsHandler.js","webpack:///./node_modules/diagram-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdatePropertiesHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateCanvasRootHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/AddLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/SplitLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/ResizeLaneHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/UpdateFlowNodeRefsHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/IdClaimHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/cmd/SetColorHandler.js","webpack:///./node_modules/bpmn-js/lib/features/label-editing/cmd/UpdateLabelHandler.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/Modeling.js","webpack:///./node_modules/diagram-js/lib/layout/BaseLayouter.js","webpack:///./node_modules/diagram-js/lib/layout/ManhattanLayout.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/BpmnLayouter.js","webpack:///./node_modules/diagram-js/lib/layout/CroppingConnectionDocking.js","webpack:///./node_modules/bpmn-js/lib/features/modeling/index.js","webpack:///./node_modules/diagram-js/lib/features/move/Move.js","webpack:///./node_modules/diagram-js/lib/features/move/MovePreview.js","webpack:///./node_modules/diagram-js/lib/features/move/index.js","webpack:///./node_modules/diagram-js/lib/features/palette/Palette.js","webpack:///./node_modules/diagram-js/lib/features/palette/index.js","webpack:///./node_modules/diagram-js/lib/features/lasso-tool/LassoTool.js","webpack:///./node_modules/diagram-js/lib/features/lasso-tool/index.js","webpack:///./node_modules/diagram-js/lib/features/hand-tool/HandTool.js","webpack:///./node_modules/diagram-js/lib/features/hand-tool/index.js","webpack:///./node_modules/diagram-js/lib/features/global-connect/GlobalConnect.js","webpack:///./node_modules/diagram-js/lib/features/global-connect/index.js","webpack:///./node_modules/bpmn-js/lib/features/palette/PaletteProvider.js","webpack:///./node_modules/bpmn-js/lib/features/palette/index.js","webpack:///./node_modules/bpmn-js/lib/features/replace-preview/BpmnReplacePreview.js","webpack:///./node_modules/bpmn-js/lib/features/replace-preview/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnConnectSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/SnapContext.js","webpack:///./node_modules/diagram-js/lib/features/snapping/CreateMoveSnapping.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/BpmnCreateMoveSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/ResizeSnapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/Snapping.js","webpack:///./node_modules/diagram-js/lib/features/snapping/index.js","webpack:///./node_modules/bpmn-js/lib/features/snapping/index.js","webpack:///./node_modules/diagram-js/lib/features/search-pad/SearchPad.js","webpack:///./node_modules/diagram-js/lib/features/search-pad/index.js","webpack:///./node_modules/bpmn-js/lib/features/search/BpmnSearchProvider.js","webpack:///./node_modules/bpmn-js/lib/features/search/index.js","webpack:///./node_modules/bpmn-js/lib/Modeler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/TasklistProps.js","webpack:///./node_modules/lodash/_baseFor.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/LinkProps.js","webpack:///./node_modules/lodash/constant.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/ElementTemplatesLoader.js","webpack:///./node_modules/lodash/isTypedArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/ComboEntryFactory.js","webpack:///./node_modules/lodash/_baseIsTypedArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ExternalTaskConfigurationProps.js","webpack:///./node_modules/lodash/_createSet.js","webpack:///./node_modules/lodash/_baseCreate.js","webpack:///./node_modules/lodash/toString.js","webpack:///./node_modules/lodash/_arrayMap.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExtensionElements.js","webpack:///./node_modules/lodash/_Map.js","webpack:///./node_modules/lodash/_hashHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Listener.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/cmd/index.js","webpack:///./node_modules/lodash/_MapCache.js","webpack:///./node_modules/bpmnlint-utils/dist/index.esm.js","webpack:///./node_modules/lodash/_baseIsEqualDeep.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/InputOutputProps.js","webpack:///./node_modules/lodash/_mapCacheClear.js","webpack:///./node_modules/selection-update/index.js","webpack:///./node_modules/lodash/_baseGetAllKeys.js","webpack:///./node_modules/lodash/_Stack.js","webpack:///./node_modules/lodash/_setCacheAdd.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/CamundaPropertiesProvider.js","webpack:///./node_modules/lodash/_stackGet.js","webpack:///./node_modules/lodash/_arrayEach.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/EntryFieldDescription.js","webpack:///./node_modules/lodash/_apply.js","webpack:///./node_modules/lodash/hasIn.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/MultiInstanceLoopCharacteristics.js","webpack:///./node_modules/lodash/_baseAssignValue.js","webpack:///./node_modules/lodash/_createBind.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ErrorEventDefinition.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/CheckboxEntryFactory.js","webpack:///./node_modules/bpmnlint/rules/no-gateway-join-fork.js","webpack:///./node_modules/lodash/_arrayIncludes.js","webpack:///./node_modules/lodash/_copyObject.js","webpack:///./node_modules/lodash/_overArg.js","webpack:///./node_modules/lodash/filter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/AsynchronousContinuationProps.js","webpack:///./node_modules/lodash/_mapCacheDelete.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/CategoryHelper.js","webpack:///./node_modules/lodash/_createBaseEach.js","webpack:///./node_modules/lodash/isFunction.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ImplementationType.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/ProcessProps.js","webpack:///./node_modules/lodash/eq.js","webpack:///./node_modules/lodash/_baseIsMatch.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/FormHelper.js","webpack:///./node_modules/lodash/_baseMap.js","webpack:///./node_modules/lodash/flattenDeep.js","webpack:///./node_modules/lodash/_createBaseFor.js","webpack:///./node_modules/lodash/_nodeUtil.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/parts/CustomProps.js","webpack:///./node_modules/lodash/_isIterateeCall.js","webpack:///./node_modules/lodash/get.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/JobRetryTimeCycle.js","webpack:///./node_modules/lodash/_Symbol.js","webpack:///./node_modules/qs/lib/parse.js","webpack:///./node_modules/lodash/_baseFilter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Script.js","webpack:///./node_modules/lodash/_arrayAggregator.js","webpack:///./node_modules/bpmnlint/lib/test-rule.js","webpack:///./node_modules/lodash/_equalArrays.js","webpack:///./node_modules/lodash/_baseSetToString.js","webpack:///./node_modules/lodash/_mapCacheHas.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/CompensateEventDefinition.js","webpack:///./node_modules/core-js/internals/array-method-is-strict.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Delegate.js","webpack:///./node_modules/lodash/_reorder.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ElementReferenceProperty.js","webpack:///./node_modules/lodash/_getAllKeys.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/InputOutputParameter.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/InputOutputParameterProps.js","webpack:///./node_modules/lodash/_mergeData.js","webpack:///./node_modules/lodash/_setToArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ResultVariable.js","webpack:///./node_modules/core-js/internals/array-method-uses-to-length.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/StartEventInitiator.js","webpack:///./node_modules/lodash/_baseUnary.js","webpack:///./node_modules/lodash/debounce.js","webpack:///./node_modules/lodash/_equalObjects.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ErrorEventProps.js","webpack:///./node_modules/lodash/isLength.js","webpack:///./node_modules/qs/lib/formats.js","webpack:///./node_modules/lodash/_baseSetData.js","webpack:///./node_modules/bpmnlint/rules/no-implicit-split.js","webpack:///./node_modules/lodash/toNumber.js","webpack:///./node_modules/lodash/_listCacheGet.js","webpack:///./node_modules/lodash/_DataView.js","webpack:///./node_modules/core-js/internals/array-iteration.js","webpack:///./node_modules/lodash/_countHolders.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/VersionTagProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/PropertiesActivator.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/PropertiesProps.js","webpack:///./node_modules/lodash/_getWrapDetails.js","webpack:///./node_modules/lodash/_baseIteratee.js","webpack:///./node_modules/lodash/_hashGet.js","webpack:///./node_modules/lodash/noop.js","webpack:///./node_modules/bpmnlint/rules/no-complex-gateway.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/ExternalTaskPriority.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/TextInputEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/DocumentationProps.js","webpack:///./node_modules/lodash/_baseIsEqual.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/ConditionalEventDefinition.js","webpack:///./node_modules/lodash/_isIndex.js","webpack:///./src/components/Search.vue?7c84","webpack:///src/components/Search.vue","webpack:///./src/components/Search.vue?329d","webpack:///./src/components/Search.vue","webpack:///./node_modules/bpmnlint/rules/helper.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/CreateAndReferenceHandler.js","webpack:///./node_modules/bpmnlint/rules/single-blank-start-event.js","webpack:///./node_modules/lodash/_setToString.js","webpack:///./src/bpmn/lint/.bpmnlintrc","webpack:///./node_modules/lodash/_wrapperClone.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/VariableMappingProps.js","webpack:///./node_modules/bpmnlint/rules/no-disconnected.js","webpack:///./node_modules/lodash/_cacheHas.js","webpack:///./node_modules/lodash/_Set.js","webpack:///./node_modules/hammerjs/hammer.js","webpack:///./node_modules/core-js/modules/es.array.index-of.js","webpack:///./node_modules/bpmnlint/rules/label-required.js","webpack:///./node_modules/lodash/_assocIndexOf.js","webpack:///./node_modules/lodash/_composeArgs.js","webpack:///./node_modules/lodash/identity.js","webpack:///./node_modules/lodash/_baseToString.js","webpack:///./node_modules/lodash/_createPartial.js","webpack:///./node_modules/lodash/_stackSet.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/PropertiesPanel.js","webpack:///./node_modules/qs/lib/utils.js","webpack:///./node_modules/lodash/stubArray.js","webpack:///./node_modules/lodash/isArguments.js","webpack:///./node_modules/bpmnlint/rules/no-inclusive-gateway.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/MultiCommandHandler.js","webpack:///./node_modules/bpmnlint/rules/start-event-required.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/EventDefinitionHelper.js","webpack:///./node_modules/lodash/_SetCache.js","webpack:///./node_modules/lodash/_baseIsNaN.js","webpack:///./node_modules/lodash/_coreJsData.js","webpack:///./node_modules/lodash/_insertWrapDetails.js","webpack:///./node_modules/lodash/_setCacheHas.js","webpack:///./node_modules/lodash/_toSource.js","webpack:///./node_modules/lodash/isArrayLikeObject.js","webpack:///./node_modules/lodash/assign.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ParticipantHelper.js","webpack:///./node_modules/lodash/map.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/SelectEntryFactory.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/cmd/UpdateBusinessObjectHandler.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/helper/ImplementationTypeHelper.js","webpack:///./node_modules/lodash/_Hash.js","webpack:///./node_modules/lodash/_hasPath.js","webpack:///./node_modules/lodash/_castPath.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/AsyncContinuation.js","webpack:///./node_modules/bpmnlint/lib/index.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/element-templates/Helper.js","webpack:///./node_modules/lodash/memoize.js","webpack:///./node_modules/lodash/_basePropertyDeep.js","webpack:///./node_modules/bpmn-js-bpmnlint/node_modules/diagram-js/lib/util/EscapeUtil.js","webpack:///./node_modules/bpmn-js-bpmnlint/dist/index.esm.js","webpack:///./node_modules/lodash/_createRecurry.js","webpack:///./node_modules/css.escape/css.escape.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/EntryFactory.js","webpack:///./node_modules/lodash/_replaceHolders.js","webpack:///./node_modules/core-js/internals/is-array.js","webpack:///./node_modules/lodash/_createWrap.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/ConnectorInputOutputParameterProps.js","webpack:///./node_modules/lodash/_LodashWrapper.js","webpack:///./node_modules/lodash/_isPrototype.js","webpack:///./node_modules/lodash/keys.js","webpack:///./node_modules/lodash/_baseXor.js","webpack:///./node_modules/lodash/_mapToArray.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/CandidateStarterProps.js","webpack:///./node_modules/lodash/_baseProperty.js","webpack:///./node_modules/lodash/_stackClear.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/FormProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/Tasklist.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/ExecutableProps.js","webpack:///./node_modules/lodash/_shortOut.js","webpack:///./node_modules/lodash/_toKey.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/EscalationEventDefinition.js","webpack:///./node_modules/lodash/_isKey.js","webpack:///./node_modules/lodash/_setData.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/EventDefinitionReference.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/bpmn/parts/implementation/MessageEventDefinition.js","webpack:///./node_modules/lodash/property.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/JobConfigurationProps.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/provider/camunda/parts/implementation/FieldInjection.js","webpack:///./node_modules/bpmn-js-properties-panel/lib/factory/ValidationAwareTextInput.js","webpack:///./node_modules/lodash/_listCacheHas.js","webpack:///./src/components/FileUpload.vue?6704","webpack:///./node_modules/lodash/_updateWrapDetails.js","webpack:///./node_modules/bpmnlint/rules/fake-join.js","webpack:///./node_modules/mitt/dist/mitt.es.js","webpack:///./node_modules/scroll-tabs/index.js","webpack:///./node_modules/lodash/isSymbol.js"],"names":["is","find","entryFactory","cmdHelper","ImplementationTypeHelper","scriptImplementation","timerImplementation","isTimeoutTaskListener","listener","eventType","event","getTimerEventDefinition","bo","eventDefinitions","module","exports","group","element","bpmnFactory","options","translate","LISTENER_TYPE_LABEL","class","expression","delegateExpression","script","getSelectedListener","classProp","expressionProp","delegateExpressionProp","scriptProp","executionListenerEventTypeOptions","isSequenceFlow","name","value","taskListenerEventTypeOptions","isSelected","node","entries","push","selectBox","id","label","modelProperty","emptyParameter","get","set","values","updateBusinessObject","selectOptions","eventTypeOptions","selectedListener","isTaskListener","isExecutionListener","hidden","textField","listenerId","undefined","update","validate","listenerType","getImplementationType","create","dataValueLabel","listenerValueLabel","listenerValue","html","template","isScript","timerEventDefinitionHandler","timerEventDefinition","createTimerEventDefinition","timerOptions","idPrefix","Symbol","objectProto","Object","prototype","hasOwnProperty","nativeObjectToString","toString","symToStringTag","toStringTag","getRawTag","isOwn","call","tag","unmasked","e","result","getBusinessObject","callable","flattenDeep","assign","getCallableType","boCalledElement","boCaseRef","callActivityType","DEFAULT_PROPS","calledElement","type","props","updateProperties","isPrototype","nativeKeys","baseKeys","object","key","__depends__","default","__init__","propertiesProvider","inputOutput","inputOutputEntry","insideConnector","concat","getSelectedParameter","InputOutputHelper","getServiceTaskLikeBusinessObject","getConnector","isConnector","connector","connectorId","isArguments","isArray","spreadableSymbol","isConcatSpreadable","isFlattenable","stubFalse","factory","elementHelper","extensionElementsHelper","utils","forEach","generatePropertyId","nextId","getPropertyValues","parent","properties","getPropertiesElement","isExtensionElements","getPropertiesElementInsideExtensionElements","extensionElements","elem","getParent","modelProperties","createParent","addLabel","getElements","addElement","commands","cmd","createElement","addAndRemoveElementsFromList","propertyProps","prop","indexOf","property","addElementsTolist","updateElement","idx","validationError","isIdValid","removeElement","propertyValues","currentProperty","removeElementsFromList","length","removeEntry","table","arrayPush","array","index","offset","isObject","isStrictComparable","strictIndexOf","fromIndex","createInputParameter","binding","parameterValue","parameterDefinition","scriptFormat","definition","createOutputParameter","source","createCamundaProperty","createCamundaIn","createCamundaInOutAttrs","createCamundaInWithBusinessKey","businessKey","createCamundaOut","createCamundaExecutionListenerScript","createCamundaFieldInjection","string","target","sourceExpression","variables","local","k","baseIsNative","getValue","getNative","freeExports","nodeType","freeModule","moduleExports","Buffer","root","nativeIsBuffer","isBuffer","identity","overRest","setToString","baseRest","func","start","isAny","eventDefinitionHelper","message","signal","error","escalation","timer","compensation","condition","elementRegistry","events","messageEventDefinition","getMessageEventDefinition","signalEventDefinition","getSignalEventDefinition","errorEvents","errorEventDefinition","getErrorEventDefinition","escalationEvents","showEscalationCodeVariable","escalationEventDefinition","getEscalationEventDefinition","timerEvents","compensationEvents","compensateEventDefinition","getCompensateEventDefinition","conditionalEvents","conditionalEventDefinition","getConditionalEventDefinition","realNames","getFuncName","data","otherFunc","ElementHelper","elementType","$parent","isConditionalForking","defaultFlow","outgoing","hasCondition","flow","conditionExpression","isDefaultFlow","check","reporter","missingCondition","report","baseCreate","createCtor","Ctor","args","arguments","thisBinding","apply","historyTimeToLive","businessObject","isKeyable","castFunction","isObjectLike","coreJsData","maskSrcKey","uid","exec","keys","IE_PROTO","isMasked","getTag","isArrayLike","isTypedArray","mapTag","setTag","isEmpty","splice","size","types","t","anyType","candidateStarterGroupsEntry","description","candidateStarterGroups","candidateStarterUsersEntry","candidateStarterUsers","baseIsEqual","hasIn","isKey","matchesStrictComparable","toKey","COMPARE_PARTIAL_FLAG","COMPARE_UNORDERED_FLAG","baseMatchesProperty","path","srcValue","objValue","escapeHTML","entryFieldDescription","bind","link","showLink","handleClick","Error","resource","cssClasses","resultVariable","attributeInfo","bpmn","version","versionTag","tenantId","cmmn","dmn","mapDecisionResultOptions","delegateVariableMappingOptions","getCamundaInWithBusinessKey","camundaIn","camundaInParams","getExtensionElements","param","setBusinessKey","text","camundaInWithBusinessKey","deleteBusinessKey","camundaInExtensions","isSupportedCallableType","bindingOptions","getAttribute","getCallActivityBindingValue","attr","getDelegateVariableMappingType","boVariableMappingClass","boVariableMappingDelegateExpression","delegateVariableMappingType","callableElementRef","callableElementLabel","newCallableElementRef","elementRef","filter","bindingOption","callableBinding","attrVer","attrVerTag","callableVersion","checkbox","callableBusinessKey","hideResultVariable","mapDecisionResult","delegateVariableMapping","delegateVariableMappingLabel","memoizeCapped","rePropName","reEscapeChar","stringToPath","charCodeAt","replace","match","number","quote","subString","request","config","instance","axios","baseURL","requestForChatbot","Uint8Array","eq","equalArrays","mapToArray","setToArray","boolTag","dateTag","errorTag","numberTag","regexpTag","stringTag","symbolTag","arrayBufferTag","dataViewTag","symbolProto","symbolValueOf","valueOf","equalByTag","other","bitmask","customizer","equalFunc","stack","byteLength","byteOffset","buffer","convert","isPartial","stacked","Promise","CreateBusinessObjectListHandler","this","_elementRegistry","_bpmnFactory","ensureNotNull","ensureList","$inject","execute","context","currentObject","propertyName","newObjects","changed","childObjects","self","obj","childObject","previousChilds","revert","getTimerDefinitionType","timeDate","timeCycle","timeDuration","getTimerDefinition","timerOrFunction","createFormalExpression","body","TimerEventDefinition","prefix","timerDefinition","timerDefinitionType","newType","oldType","fails","wellKnownSymbol","V8_VERSION","SPECIES","METHOD_NAME","constructor","foo","Boolean","hashDelete","has","__data__","getMapData","mapCacheSet","isExternal","topicEntry","externalTopic","nativeMax","Math","max","transform","Array","otherArgs","memoize","MAX_MEMOIZE_SIZE","cache","clear","inherits","getTemplate","PropertiesActivator","HIGHER_PRIORITY","CustomElementsPropertiesActivator","eventBus","elementTemplates","isEntryVisible","entry","isPropertyEditable","isEntryEditable","CUSTOM_PROPERTIES_PATTERN","DEFAULT_ENTRIES_VISIBLE","_all","isCustomEntry","test","entryId","entriesVisible","defaultVisible","entryVisible","getProperty","editable","indexes","split","scopeName","parseInt","isNaN","scopes","baseFor","baseForOwn","iteratee","baseEach","baseAggregator","collection","setter","accumulator","mapCacheGet","nativeCreate","HASH_UNDEFINED","hashSet","baseGetTag","argsTag","baseIsArguments","fieldInjection","insideListener","fieldInjectionEntry","nameEntryFactory","createCategoryValue","canvas","initializeCategory","semantic","rootElement","getRootElement","definitions","categoryValue","categoryValueRef","setGroupName","newLabel","getGroupName","arrayMap","baseValues","createWrap","getHolder","replaceHolders","WRAP_BIND_FLAG","WRAP_PARTIAL_FLAG","thisArg","partials","holders","placeholder","baseHasIn","createFind","findIndex","metaMap","noop","getData","listCacheClear","nameEntry","textBox","render","_vm","_h","$createElement","_c","_self","staticStyle","attrs","on","loadTextFromFile","staticRenderFns","component","objectToString","LazyWrapper","LodashWrapper","baseLodash","wrapperClone","lodash","ElementTemplates","_templates","descriptors","templates","descriptor","getAll","testRule","categoryMap","0","1","2","Linter","resolver","cachedRules","cachedConfigs","prefixPackage","pkg","startsWith","unprefixPackage","substring","applyRule","moddleRoot","ruleDefinition","rule","category","reports","map","console","resolveRule","ruleName","parseRuleName","resolve","then","ruleFactory","resolveConfig","configName","parseConfigName","actualConfig","normalizeConfig","resolveRules","resolveConfiguredRules","rulesConfig","parsedRules","parseRuleValue","enabledRules","loaders","all","parents","extends","inheritedRules","overrideRules","rules","reduce","currentRules","lint","ruleDefinitions","allReports","toLowerCase","localPackage","_","ns","packageName","getSimplePackageName","validatedRules","normalizedRules","normalizedName","CmdHelper","newProperties","listPropertyName","objectsToAdd","referencePropertyName","objectsToRemove","setList","updatedObjectList","ExtensionElementsHelper","extensionValues","elements","addEntry","baseFindIndex","predicate","fromRight","freeGlobal","freeSelf","Function","SetCache","arrayIncludes","arrayIncludesWith","cacheHas","createSet","LARGE_ARRAY_SIZE","baseUniq","comparator","includes","isCommon","seen","outer","computed","seenIndex","arrayFilter","resIndex","overArg","getPrototype","getPrototypeOf","baseUnary","baseDifference","valuesLength","valuesIndex","isIterateeCall","createAssigner","assigner","sources","guard","listenerEntry","stackDelete","validationAwareTextField","setProperty","labelTarget","idValue","idError","domQuery","query","domClear","domify","Ids","SPACE_REGEX","QNAME_REGEX","ID_REGEX","HTML_ESCAPE_MAP","'","selectedOption","selectedIndex","selectedType","elementSyntax","inputNode","typeSelect","getRoot","filterElementsByType","objectList","list","findRootElementsByType","referencedType","rootElements","removeAllChildren","domElement","firstChild","removeChild","addEmptyParameter","refreshOptionsModel","model","referableObjects","updateOptionsDropDown","domSelector","entryNode","option","optionEntry","appendChild","assigned","$model","ids","idExists","validateId","containsSpace","nextPrefixed","triggerClickEvent","evt","document","createEvent","MouseEvent","view","window","bubbles","cancelable","initEvent","dispatchEvent","createEventObject","fireEvent","str","composeArgsRight","isCurried","argsIndex","argsLength","holdersIndex","holdersLength","rightIndex","rightLength","rangeLength","isUncurried","isFunction","isLength","baseAssignValue","assignValue","stubArray","propertyIsEnumerable","nativeGetSymbols","getOwnPropertySymbols","getSymbols","symbol","toSource","reRegExpChar","reIsHostCtor","funcProto","funcToString","reIsNative","RegExp","pattern","DROPDOWN_TYPE","VALID_TYPES","PROPERTY_TYPE","CAMUNDA_PROPERTY_TYPE","CAMUNDA_INPUT_PARAMETER_TYPE","CAMUNDA_OUTPUT_PARAMETER_TYPE","CAMUNDA_IN_TYPE","CAMUNDA_OUT_TYPE","CAMUNDA_IN_BUSINESS_KEY_TYPE","CAMUNDA_EXECUTION_LISTENER","CAMUNDA_FIELD","VALID_BINDING_TYPES","Validator","_templatesById","_validTemplates","_errors","addAll","add","_logError","err","_validateTemplate","appliesTo","_validateProperties","_validateScopes","scope","validProperties","_validateProperty","bindingType","join","choices","every","isDropdownChoiceValid","getErrors","getValidTemplates","c","nullTag","undefinedTag","inputOutputHelper","extensionElementsEntry","getInputOutput","getInputParameters","getOutputParameters","getInputParameter","getOutputParameter","createInputOutput","createParameter","ensureInputOutputSupported","isInputOutputSupported","ensureOutparameterSupported","areOutputParametersSupported","TYPE_LABEL","getSelected","selection","inputEntry","parameter","outputEntry","newElement","inputParameters","outputParameters","newElem","getter","otherProp","firstLength","secondLength","setOptionLabelValue","suffix","$type","resizable","createExtensionElement","removeExtensionElement","onSelectionChange","deselect","isLaziable","funcName","hasEndEvent","flowElements","some","WeakMap","defineProperty","getMatchData","historyTimeToLiveEntry","now","Date","triggeredByEvent","flowElement","formats","arrayPrefixGenerators","brackets","indices","repeat","toISO","toISOString","defaults","delimiter","encode","encoder","encodeValuesOnly","serializeDate","date","skipNulls","strictNullHandling","stringify","generateArrayPrefix","sort","allowDots","formatter","keyValue","String","objKeys","i","opts","TypeError","format","formatters","arrayFormat","joined","addQueryPrefix","createAggregator","keyBy","baseXor","isArrayLikeObject","xor","arrays","arraySome","DataView","Map","Set","objectTag","promiseTag","weakMapTag","dataViewCtorString","mapCtorString","promiseCtorString","setCtorString","weakMapCtorString","ArrayBuffer","ctorString","parse","copyArray","implementationType","delegate","external","domClosest","closest","domClasses","classes","isDmnCapable","isExternalCapable","isServiceTaskLike","getTabNode","el","containerEl","hasDmnSupport","hasExternalSupport","hasServiceTaskLikeSupport","connectorTabEl","textContent","remove","innerHTML","getTemplateId","TEMPLATE_ATTR","applyTemplate","newTemplateId","oldTemplate","newTemplate","getTemplateOptions","currentTemplateId","emptyOption","allOptions","isDefault","defaultOption","isDefaultTemplate","currentOption","unknownTemplate","templateId","elementTemplate","disabled","createHybrid","createRecurry","createCurry","arity","wrapper","fn","baseIsNaN","baseIndexOf","createBaseEach","hashClear","findExtension","findExtensions","CAMUNDA_SERVICE_TASK_LIKE","ChangeElementTemplateHandler","modeling","commandStack","getOrCreateExtensionElements","updateModelerTemplate","updateIoMappings","oldMappings","newMappings","createInputOutputMappings","updateCamundaField","createCamundaFieldInjections","field","updateCamundaProperties","oldProperties","createCamundaProperties","createBpmnPropertyUpdates","newPropertiesCount","updateInOut","oldInOut","newInOut","createCamundaInOut","inout","updateExecutionListener","oldExecutionsListeners","newExecutionListeners","createCamundaExecutionListeners","executionListener","updateScopeElements","scopeDefinition","scopeElement","oldScope","preExecute","propertyUpdates","p","propertyValue","bindingTarget","language","injections","inOuts","toFinite","toInteger","remainder","multiInstanceLoopCharacteristics","jobRetryTimeCycle","asyncContinuation","getLoopCharacteristics","loopCharacteristics","ensureMultiInstanceSupported","labelPrefix","defaultParameters","canBeShown","show","isShown","$","$filter","arrayMethodHasSpeciesSupport","arrayMethodUsesToLength","HAS_SPECIES_SUPPORT","USES_TO_LENGTH","proto","forced","callbackfn","getWrapDetails","insertWrapDetails","updateWrapDetails","setWrapToString","reference","isAsyncBefore","isAsyncAfter","isExclusive","getFailedJobRetryTimeCycle","removeFailedJobRetryTimeCycle","retryTimeCycles","cycle","arrayAggregator","baseIteratee","initializer","arrayEach","isArr","isArrLike","baseTimes","n","eventDefinitionReference","elementReferenceProperty","elementName","referenceProperty","newElementIdPrefix","shouldValidate","UpdateBusinessObjectListHandler","previousList","listCopy","parentObject","ModelUtil","implementationTypeHelper","elems","getParameters","stackHas","showErrorCodeVariable","showErrorMessageVariable","modelPropertyValue","setValue","domAttr","updateSelection","TABLE_ROW_DIV_SNIPPET","DELETE_ROW_BUTTON_SNIPPET","createInputRowTemplate","canRemove","createInputTemplate","columns","createLabelRowTemplate","labels","createLabelTemplate","pick","diff","oldValues","valueEqual","oldValue","allKeys","o","getEntryNode","getContainer","getSelection","selectionStart","end","selectionEnd","setSelection","labelRow","canAdd","canUpdate","setControlValue","boElements","__invalidValues","invalidValues","action","__action","valuesToValidate","createListEntryTemplate","scopeNode","container","deleteElement","rowToDelete","delegateTarget","parentNode","rowNode","input","showTable","validateListItem","isReadOnly","activeElement","global","baseFlatten","depth","isStrict","findIndexFunc","iterable","containerElement","boResultVariable","scriptResultVariable","listCacheDelete","listCacheGet","listCacheHas","listCacheSet","ListCache","divider","labelText","showLabel","MAX_ARRAY_LENGTH","__wrapped__","__actions__","__dir__","__filtered__","__iteratees__","__takeCount__","__views__","webpackPolyfill","deprecate","paths","children","enumerable","l","toNumber","INFINITY","MAX_INTEGER","sign","baseIsMatch","baseMatches","matchData","isConditionalSource","conditionType","conditionLanguage","conditionOrConditionExpression","conditionProps","validationResult","isExpression","canClear","CONDITIONAL_SOURCES","castPath","baseGet","originalArray","C","jobPriorityEntry","jobPriority","assocIndexOf","customElementsPropertiesActivator","elementTemplatesLoader","flowKey","sourceRef","targetRef","keyed","outgoingReported","incomingReported","sourceId","targetId","log","staticClass","ref","uploadSectionFile","fileList","slot","_v","submitUpload","arrayProto","lastIndex","pop","composeArgs","countHolders","reorder","WRAP_BIND_KEY_FLAG","WRAP_CURRY_FLAG","WRAP_CURRY_RIGHT_FLAG","WRAP_ARY_FLAG","WRAP_FLIP_FLAG","partialsRight","holdersRight","argPos","ary","isAry","isBind","isBindKey","isFlip","holdersCount","newHolders","reverse","traverse","$descriptor","isGeneric","containedProperties","isAttr","isReference","isMany","child","isIndex","arrayLikeKeys","inherited","isArg","isBuff","isType","skipIndexes","BaseModeler","BaseViewer","_collectIds","_createModdle","moddle","elementsById","claim","MIN_ZOOM","MAX_ZOOM","mouseEvents","service","injector","stopEvent","preventDefault","stopPropagation","stopImmediatePropagation","createTouchRecognizer","stopMouse","allowMouse","setTimeout","unbind","recognizer","Manager","inputClass","TouchInput","recognizers","tap","Tap","pan","Pan","threshold","press","Press","pinch","Pinch","doubleTap","taps","requireFailure","reset","force","session","stopped","stop","r","state","curRecognizer","srcEvent","defaultPrevented","TouchInteractionEvents","interactionEvents","dragging","move","contextPad","palette","handler","fire","getGfx","initEvents","svg","startGrabCanvas","lx","ly","dx","deltaX","dy","deltaY","scroll","off","startGrab","gfx","startZoom","zoom","mid","center","ratio","scale","newZoom","min","originalEvent","position","elementFromPoint","x","y","hover","out","hoverGfx","pad","padRecognizer","trigger","TouchFix","addBBoxMarker","markerStyle","fill","rect1","width","height","rect2","touchInteractionEvents","touchFix","last","arr","sortTopOrMiddle","sortLeftOrCenter","ALIGNMENT_SORTING","left","right","top","middle","bottom","AlignElements","_modeling","_getOrientationDetails","vertical","axis","dimension","_isType","_alignmentPosition","sortedElements","centeredElements","firstElement","lastElement","orientation","alignment","centers","hasSharedCenters","getMiddleOrTop","first","round","filteredElements","waypoints","host","sortFn","alignElements","DEFAULT_HORIZONTAL_DISTANCE","MAX_HORIZONTAL_DISTANCE","PLACEMENT_DETECTION_PAD","getNewShapePosition","getTextAnnotationPosition","getDataElementPosition","getFlowNodePosition","getDefaultPosition","sourceTrbl","sourceMid","horizontalDistance","getFlowNodeDistance","rowSize","margin","getVerticalDistance","orient","escapeDirection","deconflictPosition","toTargetNode","weight","shape","distanceTo","shapeTrbl","toSourceNode","nodes","getTargets","getSources","distancesGrouped","currentDistance","currentDistanceCount","currentDistanceEntry","fav","count","getAutoPlaceClosure","allConnected","getConnected","attachers","shapes","attacher","getConnectedAtPosition","bounds","closure","escapeDelta","nextPosition","existingElement","newPosition","axisDelta","existingTarget","noneFilter","connectionFilter","incoming","AutoPlace","emit","payload","append","newShape","appendShape","AutoPlaceSelectionBehavior","select","autoPlace","autoPlaceSelectionBehavior","DEFAULT_PRIORITY","CommandInterceptor","_eventBus","unwrapEvent","that","command","hook","priority","handlerFn","unwrap","fullEvent","hooks","AutoResize","_rules","postExecuted","hints","newParent","autoResize","_expand","topLevel","expandings","parentId","collapsed","boundsChanged","newBounds","oldBounds","getResizeDirections","directions","BpmnAutoResize","invoke","RuleProvider","init","AutoResizeProvider","addRule","canResize","BpmnAutoResizeProvider","_getOptimalBounds","getOffset","padding","getPadding","elementsTrbl","targetTrbl","newTrbl","allowed","resizeDirections","resize","resizeShape","resizeLane","actions","canExecute","bpmnAutoResize","bpmnAutoResizeProvider","DRAG_ACTIVE_CLS","isTouchEvent","TouchEvent","getLength","point","sqrt","pow","Dragging","defaultOptions","trapClick","toLocalPoint","globalPosition","viewbox","clientRect","_container","getBoundingClientRect","dragContext","isTouch","restoreSelection","previousSelection","existingSelection","activate","displacement","globalStart","globalCurrent","globalDelta","localStart","localCurrent","localDelta","active","cancel","keepSelection","cursor","addMarker","previousContext","returnValue","cleanup","checkCancel","which","trapClickAndEnd","untrap","trapTouch","restore","wasActive","endDrag","removeMarker","relativeTo","manual","autoActivate","setOptions","HIGH_PRIORITY","HoverFix","ensureHover","_findTargetGfx","once","setDragHover","unsetHover","ensureOut","hoverFix","AutoScroll","_canvas","_opts","scrollThresholdIn","scrollThresholdOut","scrollRepeatTimeout","scrollStep","_toBorderPoint","startScroll","stopScroll","between","val","_scrolling","clearTimeout","autoScroll","Rules","_commandStack","circlePath","linePath","points","segments","INTERSECTION_THRESHOLD","getBendpointIntersection","w","bendpoint","getPathIntersection","intersections","a","b","segment2","getApproxIntersection","BENDPOINT_CLS","SEGMENT_DRAGGER_CLS","toCanvasCoordinates","getConnectionIntersection","localPosition","intersection","addBendpoint","parentGfx","cls","groupGfx","visual","cx","cy","hit","createParallelDragger","segmentStart","segmentEnd","draggerGfx","hitWidth","calculateHitWidth","hitHeight","addSegmentDragger","calculateSegmentMoveRegion","segmentLength","abs","segmentLengthXAxis","segmentLengthYAxis","Bendpoints","bendpointMove","connectionSegmentMove","isIntersectionMiddle","treshold","p0","p1","aligned","xDelta","yDelta","calculateIntersectionThreshold","connection","relevantSegment","activateBendpointMove","bindInteractionEvents","eventName","triggerMouseEvent","getBendpointsContainer","layer","getLayer","getSegmentDragger","createBendpoints","createSegmentDraggers","segmentDraggerGfx","clearBendpoints","clearSegmentDraggers","addHandles","updateHandles","updateFloatingBendpointPosition","floating","updateSegmentDraggerPosition","draggerVisual","relativePosition","getDraggerVisual","bendpointsGfx","marker","newSelection","primary","registerEvent","unregisterEvent","newId","bendpointContainer","RECONNECT_START","RECONNECT_END","UPDATE_WAYPOINTS","BendpointMove","_injector","bendpointIndex","insert","getGraphics","connectionGfx","newWaypoints","slice","docking","cropWaypoints","updateWaypoints","isReverse","reconnect","connectionDocking","getCroppedWaypoints","MARKER_OK","MARKER_NOT_OK","MARKER_CONNECT_HOVER","MARKER_CONNECT_UPDATING","MARKER_ELEMENT_HIDDEN","BendpointMovePreview","connectionPreview","connectionEnd","connectionStart","noCropping","noLayout","drawPreview","cleanUp","axisAdd","delta","axisSet","axisFenced","maxValue","minValue","fencedValue","flipAxis","getDocking","referenceElement","moveAxis","referenceMid","inverseAxis","original","ConnectionSegmentMove","graphicsFactory","cropConnection","croppedWaypoints","oldWaypoints","redrawConnection","updateDragger","segmentOffset","segmentStartIndex","segmentEndIndex","draggerPosition","filterRedundantWaypoints","filteredWaypoints","direction","dragPosition","originalWaypoints","sourceToSegmentOrientation","targetToSegmentOrientation","newSegmentStart","newSegmentEnd","waypointCount","shift","unshift","newSegmentStartIndex","filtered","segmentMove","tolerance","snapValue","topLeft","bottomRight","defaultValue","isSnapped","snapped","setSnapped","previousValue","getChildren","TOLERANCE","BendpointSnapping","snapTo","rem","getConnectionSegmentSnaps","snapPoints","referenceWaypoints","horizontal","getBendpointSnaps","sx","sy","hoverMid","bendpoints","bendpointMovePreview","bendpointSnapping","Connect","canConnect","canConnectReverse","connect","LOW_PRIORITY","ConnectPreview","startPosition","connectPreview","MARKER_CONNECTION_PREVIEW","ConnectionPreview","elementFactory","_graphicsFactory","_elementFactory","_connectionDocking","_layouter","cacheReturnValues","returnValues","firstArgument","JSON","ensureConnectionAttrs","connectionPreviewGfx","getConnection","noNoop","createConnectionPreviewGfx","layoutConnection","drawConnection","drawNoopPreview","createNoopConnection","sourcePath","getShapePath","targetPath","connectionPath","getConnectionPath","createConnection","pointerEvents","getDefaultLayer","isTextNode","Node","TEXT_NODE","toArray","nodeList","TextBox","content","keyHandler","resizeHandler","handlePaste","DirectEditing","_providers","_textbox","_handleKey","_handleResize","style","parentStyle","maxWidth","maxHeight","minWidth","minHeight","backgroundColor","overflow","border","boxSizing","wordWrap","textAlign","outline","contentStyle","centerVertically","innerText","lastChild","clipboardData","insertText","hasResized","success","execCommand","_insertTextIE","range","startContainer","endContainer","startOffset","endOffset","commonAncestorContainer","childNodesArray","childNodes","containerTextContent","textNode","createTextNode","insertBefore","startContainerChildIndex","endContainerChildIndex","childNode","fontSize","scrollHeight","offsetHeight","resizeHandle","Infinity","startX","startY","startWidth","startHeight","onMouseDown","clientX","clientY","onMouseMove","onMouseUp","newWidth","newHeight","borderTop","borderRight","borderBottom","borderLeft","destroy","removeAttribute","trim","getRangeAt","createRange","selectNodeContents","setStart","setEnd","removeAllRanges","addRange","registerProvider","provider","isActive","_active","_fire","close","complete","containerBounds","previousBounds","$textbox","newText","previousText","keyCode","charCode","shiftKey","directEditing","entrySelector","ContextPad","overlays","_overlays","_overlaysConfig","_current","_init","addClasses","classNames","actualClassNames","open","isOpen","current","providers","getEntries","_getProviders","entriesOrUpdater","getContextPadEntries","button","_updateAndOpen","getPad","grouping","control","className","title","imageUrl","overlaysConfig","_overlayId","MARKER_TYPES","NODES_CAN_HAVE_MARKER","PreviewSupport","styles","_styles","_clonedMarkers","clonedMarker","getMarker","markerType","referenceToId","idToReference","canHaveMarker","nodeName","addDragger","dragger","bbox","_cloneMarkers","addFrame","frame","_cloneMarker","markerId","clonedMarkerId","defs","_svg","previewSupport","MARKER_ATTACH","MARKER_NEW_PARENT","PREFIX","Create","canCreate","isLabel","isConnection","attach","isSingleShape","targetParent","targetAttach","setMarker","m","ensureConstraints","createElements","waypoint","createConstraints","CreatePreview","createDragGroup","dragGroup","childrenGfx","_createContainer","drawShape","defaultLayer","createPreview","DATA_REF","CLOSE_EVENTS","PopupMenu","_config","setTransform","providerId","_getEntries","headerEntries","_getHeaderEntries","hasEntries","hasHeaderEntries","_emit","_createEntries","_attachContainer","_bindAutoClose","_unbindAutoClose","_getEntry","getPopupMenuEntries","getPopupMenuHeaderEntries","getHeaderEntries","visibility","_updateScale","_assureIsInbounds","minScale","maxScale","scaleConfig","containerX","offsetLeft","containerY","offsetTop","containerWidth","scrollWidth","containerHeight","overAxis","cursorPosition","entriesContainer","entryContainer","_createEntry","entryClasses","popupMenu","Clipboard","_data","clipboard","Mouse","setLastMoveEvent","mousemoveEvent","_lastMoveEvent","addEventListener","_lastMouseEvent","removeEventListener","createMoveEvent","screenX","screenY","initMouseEvent","getLastMoveEvent","mouse","CopyPaste","_create","_clipboard","_mouse","parentCopied","isAttacher","copyWaypoints","createElementsBehavior","copyWaypoint","copy","tree","createTree","paste","_createElements","_paste","branch","createLabel","createShape","hasRelations","elementsData","canCopy","addElementData","foundElementData","removeElementData","elementData","_index","addRelatedElements","copyPaste","copyProperties","removeProperties","BpmnCopyPaste","moddleCopy","references","resolveReferences","attachedToRef","oldBusinessObject","di","bpmnProcess","copyElement","newBusinessObject","DISALLOWED_PROPERTIES","ModdleCopy","_moddle","propertyNames","parentDescriptor","getPropertyNames","keepDefaultProperties","$instanceOf","sourceElement","targetElement","canCopyProperties","sourceProperty","copiedProperty","copyProperty","canSetProperty","propertyDescriptor","getPropertyDescriptor","isId","childProperties","childProperty","getElementDescriptor","bpmnCopyPaste","Replace","replaceElement","oldElement","newElementData","centerX","centerY","replaceShape","CUSTOM_PROPERTIES","toggeling","targetCollapsed","oldCollapsed","isExpanded","BpmnReplace","isSubProcess","toggleCollapse","elementProps","newElementProps","copyProps","hasEventDefinition","eventDefinitionType","moveChildren","processRef","_getDefaultSize","a1","a2","bpmnReplace","isDifferentType","eventDefinition","isTypeEqual","isEventDefinitionEqual","isTriggeredByEventEqual","isExpandedEqual","START_EVENT","actionName","INTERMEDIATE_EVENT","END_EVENT","GATEWAY","instantiate","eventGatewayType","SUBPROCESS_EXPANDED","TRANSACTION","EVENT_SUB_PROCESS","TASK","BOUNDARY_EVENT","cancelActivity","EVENT_SUB_PROCESS_START_EVENT","isInterrupting","SEQUENCE_FLOW","PARTICIPANT","ReplaceMenuProvider","_popupMenu","_bpmnReplace","_translate","register","differentType","isInterruptingEqual","isCancelActivityEqual","isTargetSubProcess","isTargetExpanded","_createSequenceFlowEntries","_getLoopEntries","_getAdHocEntry","replaceOptions","menuEntries","_createMenuEntry","replaceAction","menuEntry","toggleLoopEntry","isSequential","isLoop","isParallel","loopEntries","isAdHoc","adHocEntry","replaceMenuProvider","DEFAULT_CHILD_BOX_PADDING","substractTRBL","trblA","trblB","resizeBounds","resizeTRBL","applyConstraints","trbl","resizeConstraints","currentBounds","currentTrbl","getMinResizeBounds","minDimensions","childrenBounds","currentBox","minBox","childrenBox","combinedBox","asPadding","mayBePadding","addPadding","isBBoxChild","computeChildrenBBox","shapeOrChildren","getTRBLResize","LANE_PARENTS","LANE_INDENTATION","collectLanes","collectedShapes","s","getChildLanes","getLanesRoot","computeLanesResize","initialShapes","allLanes","shapeNewTrbl","trblResize","resizeNeeded","topResize","rightResize","bottomResize","leftResize","otherTrbl","ContextPadProvider","_contextPad","_connect","_autoPlace","click","isEventType","eventBo","isDefinition","def","startConnect","removeElements","getReplaceMenuPosition","Y_OFFSET","diagramContainer","diagramRect","padRect","pos","appendAction","appendStart","dragstart","splitLaneHandler","splitLane","childLanes","addLane","isForCompensation","deleteAllowed","contextPadProvider","AXIS_DIMENSIONS","THRESHOLD","DistributeElements","_filters","registerFilter","avgDimension","elementsSize","numOfShapes","filterFn","groups","distributableElements","_setOrientation","_filterElements","_createGroups","distributeElements","_axis","_dimension","filters","rangeGroups","elementRange","_findRange","previous","_hasIntersection","rangeA","rangeB","BpmnDistributeElements","cannotDistribute","bpmnDistributeElements","NOT_REGISTERED_ERROR","IS_REGISTERED_ERROR","EditorActions","_actions","_registerDefaultActions","editorActions","zoomScroll","keyboardMove","keyboardMoveSelection","undo","redo","selectedElements","stepZoom","removableElements","moveCanvas","moveSelection","accelerated","_registerAction","isRegistered","unregister","getActions","BpmnEditorActions","spaceTool","lassoTool","handTool","globalConnect","searchPad","toggle","currentSelection","aligneableElements","setColor","boundingBox","moveElements","BpmnGridSnapping","gridSnappingContext","snapLocation","SPACING","quantize","quantum","LOWER_PRIORITY","GridSnapping","setActive","snapOffset","getSnapOffset","snapConstraints","getSnapConstraints","snapEvent","isHorizontal","minResizeConstraints","maxResizeConstraints","isWest","isNorth","ResizeBehavior","gridSnapping","_gridSnapping","snapComplex","snapSimple","snappedValue","getGridSpacing","toggleActive","snapHorizontally","snapVertically","west","east","snappedNewBounds","north","south","SpaceToolBehavior","initialized","gridSnappingResizeBehavior","gridSnappingSpaceToolBehavior","AutoPlaceBehavior","CreateParticipantBehavior","LayoutConnectionBehavior","hasMiddleSegments","snapMiddleSegments","horizontallyAligned","verticallyAligned","snapSegment","gridSnappingAutoPlaceBehavior","gridSnappingCreateParticipantBehavior","gridSnappingLayoutConnectionBehavior","bpmnGridSnapping","LABEL_WIDTH","LABEL_HEIGHT","BpmnInteractionEvents","_interactionEvents","createParticipantHit","createDefaultHit","createSubProcessHit","removeHits","createBoxHit","bpmnInteractionEvents","BpmnKeyboardBindings","KeyboardBindings","registerBindings","keyboard","addListener","keyEvent","isCmd","hasModifier","keyboardBindings","DEFAULT_CONFIG","moveSpeed","moveSpeedAccelerated","LEFT","UP","RIGHT","DOWN","KEY_TO_DIRECTION","ArrowLeft","Left","ArrowUp","Up","ArrowRight","Right","ArrowDown","Down","DIRECTIONS_DELTA","speed","up","down","KeyboardMoveSelection","isShift","canMove","ChangeSupport","updateContainments","changeSupport","DEFAULT_MIN_WIDTH","Resize","_dragging","handleMove","handleStart","minBounds","computeMinResizeBox","handleEnd","getReferencePoint","referencePoint","getCursor","ctx","contextOrDirection","childrenBoxPadding","MARKER_RESIZING","MARKER_RESIZE_NOT_OK","ResizePreview","updateFrame","removeFrame","HANDLE_OFFSET","HANDLE_SIZE","HANDLE_HIT_SIZE","CLS_RESIZER","ResizeHandles","_resize","removeResizers","addResizer","getHandleOffset","makeDraggable","startResize","_createResizer","resizersParent","_getResizersParent","createResizer","resizer","resizePreview","resizeHandles","LabelEditingProvider","textRenderer","activateDirectEdit","isCollapsedSubProcess","_textRenderer","isExpandedSubProcess","isCollapsedPool","isExpandedPool","isEmptyText","getEditingBBox","getAbsoluteBBox","defaultStyle","getDefaultStyle","externalStyle","getExternalStyle","externalFontSize","externalLineHeight","lineHeight","defaultFontSize","defaultLineHeight","fontFamily","fontWeight","paddingTop","paddingBottom","paddingLeft","paddingRight","externalLabelMid","absoluteBBox","activeContextText","updateLabel","MARKER_HIDDEN","MARKER_LABEL_HIDDEN","LabelEditingPreview","pathMap","absoluteElementBBox","activeProvider","textPathData","getScaledPath","xScaleFactor","yScaleFactor","mx","my","d","strokeWidth","stroke","getStrokeColor","newElementHeight","defaultColor","labelEditingProvider","labelEditingPreview","ALIGNMENTS","ELEMENT_LABEL_DISTANCE","AdaptiveLabelPositioningBehavior","checkLabelAdjustment","optimalPosition","getOptimalPosition","adjustLabelPosition","elementMid","labelMid","newLabelMid","elementTrbl","moveShape","getTakenHostAlignments","freeAlignments","hostElement","hostOrientation","takenAlignments","getTakenConnectionAlignments","getApproximateOrientation","labelOrientation","isAligned","takenHostAlignments","AppendBehavior","bpmnRules","AssociationBehavior","postExecute","associations","association","moveConnection","AttachEventBehavior","shouldReplace","newHost","getEventDefinition","BoundaryEventBehavior","getBoundaryEvents","boundaryEvents","oldSource","newSource","attachedboundaryEvents","boundaryEvent","RootElementReferenceBehavior","bpmnjs","canHaveRootElementReference","hasAnyEventDefinition","hasRootElement","getDefinitions","getRootElementReferencePropertyName","setRootElement","executed","addedRootElement","reverted","referencedRootElement","CreateBehavior","HIGHEST_PRIORITY","FixHoverBehavior","CreateDataObjectBehavior","dataObject","dataObjectRef","HORIZONTAL_PARTICIPANT_PADDING","VERTICAL_PARTICIPANT_PADDING","PARTICIPANT_BORDER_WIDTH","ensureCollaboration","collaboration","makeCollaboration","process","childrenBBox","participantBounds","getParticipantBounds","getParticipantCreateConstraints","rootElementGfx","ensureHoveringProcess","oldProcessRef","processChildren","participant","hasParticipants","findParticipant","TARGET_REF_PLACEHOLDER_NAME","DataInputAssociationBehavior","usesTargetRef","removedConnection","inputAssociations","getTargetRef","targetRefProp","cleanupTargetRef","fixTargetRef","connectionBo","targetBo","newTarget","newTargetBo","oldTarget","oldTargetBo","dataAssociation","ifDataInputAssociation","UpdateSemanticParentHandler","bpmnUpdater","_bpmnUpdater","DataStoreBehavior","getFirstParticipant","getDataStores","updateDataStoreParent","dataStore","newDataStoreParent","dataStoreBo","newDataStoreParentBo","newSemanticParent","newDiParent","registerHandler","dataStoreReferences","oldParent","getAncestor","isDescendant","oldRoot","newRoot","dataStores","descendant","ancestor","descendantBo","ancestorBo","oldSemanticParent","oldDiParent","updateSemanticParent","updateDiParent","DeleteLaneBehavior","compensateLaneDelete","topAdjustments","bottomAdjustments","siblings","topAffected","bottomAffected","calculateAdjustments","makeSpace","movingShapes","resizingShapes","nested","DetachEventBehavior","item","DropOnFlowBehavior","insertShape","targetFlow","positionOrBounds","waypointsBefore","waypointsAfter","dockingPoint","incomingConnection","outgoingConnection","oldOutgoing","oldIncoming","isPointInsideBBox","reconnectEnd","reconnectStart","duplicateConnections","shapeMid","newShapeMid","canInsert","EventBasedGatewayBehavior","preExecuted","existingIncomingConnections","sequenceFlow","removeConnection","newShapeTargets","newShapeTargetsIncomingSequenceFlows","sequenceFlows","incomingSequenceFlows","intermediateEvent","GroupBehavior","removeReferencedCategoryValue","removeCategory","getGroupElements","isReferenced","groupElements","lineIntersect","l1s","l1e","l2s","l2e","denominator","numerator","ImportDockingFix","adjustDocking","startPoint","nextPoint","centerIntersect","elementTop","elementLeft","verticalIntersect","horizontalIntersect","getDistance","fixDockings","p2","IsHorizontalFix","elementTypesToUpdate","vectorLength","v","getAngle","line","atan","rotateVector","vector","angle","cos","sin","solveLambaSystem","system","lambda","perpendicularFoot","bd","getDistancePointLine","pfPoint","connectionVector","getDistancePointPoint","point1","point2","sq","getAttachment","segmentStartDistance","segmentEndDistance","attachmentPosition","minDistance","attachment","attachmentDistance","closestAttachmentDistance","closestAttachment","pointsEqual","getCircleSegmentIntersections","segmentIndex","relativeLocation","s1","s2","cc","cr","baX","baY","caX","caY","bBy2","pBy2","q","disc","tmpSqrt","abScalingFactor1","abScalingFactor2","i1","i2","isPointInSegment","fenced","rangeStart","rangeEnd","EQUAL_THRESHOLD","findNewLabelLineStartIndex","oldSegmentStartIndex","newIndex","rel","relativePositionMidWaypoint","getLabelAdjustment","labelPosition","getLabelMid","oldLabelLineIndex","newLabelLineIndex","oldLabelLine","getLine","newLabelLine","oldFoot","relativeFootPosition","getRelativeFootPosition","angleDelta","getAngleDelta","oldBendpointIndex","oldBendpoint","newBendpoint","newFoot","newLabelVector","distanceSegment1","distanceSegment2","l1","l2","foot","lengthToFoot","getNewAttachPoint","oldCenter","newCenter","oldDelta","newDelta","getNewAttachShapeDelta","shapeCenter","shapeDelta","oldCenterDelta","newCenterDelta","newShapeCenter","DEFAULT_LABEL_DIMENSIONS","NAME_PROPERTY","TEXT_PROPERTY","LabelBehavior","getVisibleLabelAdjustment","startChanged","endChanged","getTextAnnotationBounds","labelCenter","labelDimensions","getExternalLabelBounds","unsetLabel","removeShape","labelBehavior","labelAdjustment","oldShape","edges","asEdges","getReferencePointDelta","newReferencePoint","lines","nearestLine","getNearestLine","distances","distance","sorted","COLLAB_ERR_MSG","PROCESS_ERR_MSG","ModelingFeedback","tooltips","showError","timeout","ReplaceConnectionBehavior","fixConnection","replacementType","canConnectSequenceFlow","canConnectMessageFlow","canConnectAssociation","replaceReconnectedConnection","replacement","cleanDraggingSelection","oldConnection","newConnection","allConnections","RemoveParticipantBehavior","collaborationRoot","participants","makeProcess","ReplaceElementBehaviour","_selection","topLevelElements","canReplace","replaceElements","replacements","unclaimId","newElements","newElementType","oldElementId","addToTrbl","choice","addMin","addMax","LANE_MIN_HEIGHT","LANE_MIN_WIDTH","LANE_RIGHT_PADDING","LANE_LEFT_PADDING","LANE_TOP_PADDING","LANE_BOTTOM_PADDING","getParticipantResizeConstraints","laneShape","resizeDirection","balanced","lanesRoot","isFirst","isLast","laneTrbl","maxTrbl","minTrbl","flowElementTrbl","PARTICIPANT_MIN_DIMENSIONS","SUB_PROCESS_MIN_DIMENSIONS","TEXT_ANNOTATION_MIN_DIMENSIONS","SLIGHTLY_HIGHER_PRIORITY","ResizeLaneBehavior","RemoveElementBehavior","inConnection","outConnection","getNewWaypoints","inWaypoints","outWaypoints","SubProcessStartEventBehavior","getStartEventPosition","ToggleElementCollapseBehaviour","hideEmptyLabels","expandedBounds","defaultSize","visibleElements","visibleBBox","filterVisible","collapsedBounds","UnclaimIdBehavior","shapeBo","unclaim","rootElementBo","UpdateFlowNodeRefsBehavior","initContext","UpdateContext","enter","getContext","releaseContext","triggerUpdate","leave","updateLaneRefs","flowNodes","lanes","laneRefUpdateEvents","updateContext","addFlowNode","counter","lane","flowNode","DeleteSequenceFlowBehavior","sourceBo","adaptiveLabelPositioningBehavior","appendBehavior","associationBehavior","attachEventBehavior","boundaryEventBehavior","rootElementReferenceBehavior","createBehavior","fixHoverBehavior","createDataObjectBehavior","createParticipantBehavior","dataInputAssociationBehavior","dataStoreBehavior","deleteLaneBehavior","detachEventBehavior","dropOnFlowBehavior","eventBasedGatewayBehavior","groupBehavior","importDockingFix","isHorizontalFix","modelingFeedback","replaceConnectionBehavior","removeParticipantBehavior","replaceElementBehaviour","resizeBehavior","resizeLaneBehavior","removeElementBehavior","toggleElementCollapseBehaviour","spaceToolBehavior","subProcessStartEventBehavior","unclaimIdBehavior","updateFlowNodeRefsBehavior","unsetDefaultFlowBehavior","getBoundaryAttachment","targetBounds","BpmnRules","canStartConnection","nonExistingOrLabel","isSame","getOrganizationalParent","isTextAnnotation","isGroup","isCompensationBoundary","isSameOrganization","parentA","parentB","isMessageFlowSource","hasEventDefinitionOrNone","isMessageFlowTarget","getScopeParent","isSameScope","scopeParentA","scopeParentB","isSequenceFlowSource","isSequenceFlowTarget","isEventBasedTarget","getParents","isParent","possibleParent","allParents","connectDataAssociation","canConnectDataAssociation","associationDirection","canDrop","isDroppableBoundaryEvent","hasNoEventDefinition","hasCommonBoundaryIntermediateEventDefinition","isBoundaryEvent","isLane","isBoundaryCandidate","hasOneOfEventDefinitions","isReceiveTaskAfterEventBasedGateway","isOneTextAnnotation","sourceTextAnnotation","targetTextAnnotation","areOutgoingEventBasedGatewayConnections","isOutgoingEventBasedGatewayConnection","connections","canAttach","OrderingProvider","ordering","getOrdering","parentIndex","newParentIndex","BpmnOrderingProvider","orders","order","level","containers","computeOrder","getOrder","findActualParent","actualParent","elementOrder","currentIndex","insertIndex","bpmnOrderingProvider","CommandStack","_handlerMap","_stack","_stackIdx","_currentExecution","dirty","_uid","_pushAction","_internalExecute","_popAction","_getHandler","next","_getUndoAction","_internalUndo","_getRedoAction","_setHandler","handlerCls","canUndo","canRedo","_atomicDo","_markDirty","_revertedAction","qualifier","names","cancelBubble","_createId","execution","atomic","_executedAction","baseAction","stackIdx","createRoot","setPosition","setVisible","visible","display","tooltipClass","tooltipSelector","Tooltips","_ids","_tooltipDefaults","minZoom","maxZoom","_tooltips","_tooltipRoot","tooltip","_addTooltip","removeTimer","htmlContainer","hide","_updateRoot","matrix","tooltipRoot","jquery","_updateTooltip","_updateTooltipVisibilty","updateViewbox","saveClear","removeFn","LabelSupport","movePreview","validatedShapes","removeLabels","enclosedElements","enclosedLabels","labelTargetIndex","labelSupport","AttachSupport","addAttached","removeAttached","getAttachers","updateAttachment","attachSupport","ToolManager","_tools","registerTool","tools","bindEvents","tool","eventsToRegister","reactivate","toolManager","getDirection","getWaypointsUpdatingConnections","waypointsUpdatingConnections","AXIS_TO_DIMENSION","CURSOR_CROSSHAIR","DIRECTION_TO_TRBL","DIRECTION_TO_OPPOSITE","PADDING","SpaceTool","_toolManager","activateMakeSpace","activateSelection","spaceToolConstraints","getSpaceToolConstraints","resizingShape","minOrMax","nonMovingResizingChildrenBBox","movingChildrenBBox","resizingShapeBBox","nonMovingResizingChildren","movingChildren","resizingShapeMinDimensions","createSpace","shapeStart","shapeEnd","MARKER_DRAGGING","SpaceToolPreview","addPreviewGfx","space","crosshairGroup","pathX","pathY","spaceLayer","movingConnections","sourceIsMoving","targetIsMoving","sourceIsResizing","targetIsResizing","frameGroup","frames","initialBounds","getBBox","opposite","spaceToolPreview","BpmnFactory","_model","_needsId","_ensureId","createDiLabel","createDiBounds","createDiShape","bpmnElement","createDiWaypoints","createDiWaypoint","createDiEdge","createDiPlane","BpmnUpdater","cropped","updateParent","reverseUpdateParent","updateRoot","updateBounds","updateConnection","updateConnectionWaypoints","ifBpmn","oldSourceBo","newSourceBo","oldConditionExpression","oldDefault","parentShape","parentBusinessObject","parentDi","updateFlowNodeRefs","_getLabel","newContainment","oldContainment","oldRefs","newRefs","updateDiConnection","planeElements","getLaneSet","laneSet","laneSets","childLaneSet","visualParent","containment","ioSpecification","diChildren","inverseSet","applyAttributes","attributeNames","applyAttribute","attributeName","AppendShapeHandler","existsConnection","CreateConnectionHandler","layouter","createBpmnElement","newEventDefinition","isFrame","isMarkerVisible","createParticipantShape","connectionParent","addConnection","CreateElementsHandler","createShapeHints","CreateShapeHandler","CreateLabelHandler","addShape","originalExecute","ensureValidDimensions","originalRevert","DeleteConnectionHandler","DeleteElementsHandler","DeleteShapeHandler","oldParentIndex","OFF_AXIS","LayoutConnectionHandler","MoveConnectionHandler","getResizedSourceAnchor","safeGetWaypoints","oldAnchor","getResizedTargetAnchor","getMovedSourceAnchor","moveDelta","substractPosition","getMovedTargetAnchor","MoveClosure","allShapes","enclosedConnections","MoveHelper","MoveElementsHandler","_helper","MoveShapeHandler","ReconnectConnectionHandler","ReplaceShapeHandler","ResizeShapeHandler","SpaceToolHandler","getAxisFromDirection","ToggleShapeCollapseHandler","getElementsVisibilityRecursive","setHiddenRecursive","newHidden","restoreVisibilityRecursive","lastState","UpdateAttachmentHandler","removeAttacher","addAttacher","UpdateWaypointsHandler","Modeling","registerHandlers","updateRange","lastIdx","rangeDiff","centerElement","refCenter","spaceInBetween","firstGroup","lastGroupIdx","lastGroup","groupsSize","refElem","groupIdx","prevGroup","isTopLevel","newClosure","moveRecursive","moveClosure","getClosure","primaryShape","keepParent","recurse","layout","sourceMoved","targetMoved","getNewParent","dockingOrPoints","layoutConnectionHints","newData","canReconnect","moveShapes","resizeShapes","isFirstWaypoint","isLastWaypoint","oldChildrenVisibility","oldHost","attacherIdx","getHandlers","DEFAULT_FLOW","ID","DI","NULL_DIMENSIONS","UpdatePropertiesHandler","isIdChange","getProperties","getDiProperties","setProperties","setDiProperties","unwrapBusinessObjects","updateId","newLabelBounds","referencePropertyNames","unwrappedProps","UpdateCanvasRootHandler","AddLaneHandler","_spaceTool","SplitLaneHandler","ResizeLaneHandler","newRootBusinessObject","oldRootBusinessObject","bpmnDefinitions","diPlane","location","isRoot","laneParent","existingChildLanes","allAffected","lanePosition","spacePos","adjustments","newLane","newLanesCount","existingLanesCount","laneY","laneHeight","laneBounds","newLaneAttrs","newLanesHeight","resizeBalanced","resizeSpace","change","trblDiff","FLOW_NODE_REFS_ATTR","LANES_ATTR","UpdateFlowNodeRefsHandler","IdClaimHandler","computeUpdates","flowNodeShapes","laneShapes","handledNodes","updates","participantCache","allFlowNodeShapes","isInLaneShape","addFlowNodeShape","flowNodeShape","getAllLaneShapes","getNewLanes","allLaneShapes","oldLane","claiming","DEFAULT_COLORS","SetColorHandler","colors","UpdateLabelHandler","setText","oldLabel","_bpmnRules","BaseLayouter","handlers","targetLaneShape","targetLane","collaborationElement","processElement","claimId","moddleElement","MIN_SEGMENT_LENGTH","POINT_ORIENTATION_PADDING","ORIENTATION_THRESHOLD","needsTurn","startDirection","h","canLayoutStraight","targetOrientation","getSegmentBendpoints","segmentDirections","xmid","ymid","layoutStraight","layoutHorizontal","layoutTurn","turnNextDirections","getBendpoints","getStartSegment","getEndSegment","invertedSegment","invertDirections","getMidSegment","startSegment","endSegment","endDirection","getSimpleBendpoints","isValidDirections","isExplicitDirections","midSegment","connectPoints","withoutRedundantPoints","connectRectangles","preferredLayouts","preferredLayout","getDirections","directionSplit","startDocking","getDockingPoint","invertOrientation","endDocking","repairConnection","repairedWaypoints","preferStraight","tryLayoutStraight","tryRepairConnectionEnd","tryRepairConnectionStart","inRange","isInRange","primaryAxis","preserveDocking","moved","newDocking","_tryRepairConnectionSide","needsRelayout","repairBendpoint","candidate","oldPeer","newPeer","removeOverlapping","slicedPoints","oldDocking","newPoints","defaultLayout","rectangle","dockingDirection","ATTACH_ORIENTATION_PADDING","BOUNDARY_TO_HOST_THRESHOLD","oppositeOrientationMapping","orientationDirectionMapping","BpmnLayouter","getAttachOrientation","attachedElement","getMessageFlowManhattanOptions","getMessageFlowPreserveDocking","getConnectionDocking","isCompensationAssociation","isAnyOrientation","orientations","getHorizontalOrientation","matches","getVerticalOrientation","isOppositeOrientation","isOppositeHorizontalOrientation","horizontalOrientation","oppositeHorizontalOrientation","isOppositeVerticalOrientation","verticalOrientation","oppositeVerticalOrientation","isHorizontalOrientation","getLoopPreferredLayout","getBoundaryEventPreferredLayouts","sourceLayout","targetLayout","targetMid","attachOrientation","attachedToSide","getBoundaryEventLoopLayout","getBoundaryEventSourceLayout","getBoundaryEventTargetLayout","shouldConnectToSameSide","areCloseOnAxis","dockingToPoint","actual","CroppingConnectionDocking","manhattanOptions","updatedWaypoints","sourceDocking","targetDocking","dockStart","dockingIdx","croppedPoint","_getIntersection","takeFirst","shapePath","_getShapePath","_getConnectionPath","_getGfx","MEDIUM_PRIORITY","MoveEvents","removeNested","isAttach","MovePreview","getVisualDragShapes","getAllDraggedElements","removeEdges","allDraggedElements","dragShapes","visuallyDraggedShapes","differentParents","haveDifferentParents","TOGGLE_SELECTOR","ENTRY_SELECTOR","ELEMENT_SELECTOR","PALETTE_OPEN_CLS","PALETTE_TWO_COLUMN_CLS","Palette","updateToolHighlight","_update","_diagramInitialized","_rebuild","addPaletteEntries","getPaletteEntries","parentContainer","_getParentContainer","HTML_MARKUP","_layoutChanged","_toggleState","twoColumn","_needsCollapse","clientHeight","_entries","separator","availableHeight","entriesHeight","isActiveTool","_activeTool","toolsContainer","_toolsContainer","toolClasses","contains","LASSO_TOOL_CURSOR","LassoTool","visuals","SVGElement","activateLasso","toBBox","HAND_CURSOR","HandTool","activateMove","deactivateMove","isSpace","removeListener","activateHand","GlobalConnect","startTarget","canStartConnect","PaletteProvider","_palette","_lassoTool","_handTool","_globalConnect","createAction","createListener","shortType","createSubprocess","subProcess","startEvent","autoSelect","createParticipant","paletteProvider","BpmnReplacePreview","replaceVisual","visualReplacements","tempShape","restoreVisual","originalGfx","bpmnReplacePreview","TARGET_BOUNDS_PADDING","TASK_BOUNDS_PADDING","TARGET_CENTER_PADDING","AXES","BpmnConnectSnapping","initialConnectionStart","snapToShape","getTargetBoundsPadding","isAnyType","snapToPosition","snapToTargetMid","snapBoundaryEventLoop","dimensionForAxis","getDimensionForAxis","isMid","axes","newCoordinate","coordinate","SnapContext","_targets","_snapOrigins","_snapLocations","_defaultSnaps","SnapPoints","defaultSnaps","_snapValues","getSnapOrigin","setSnapOrigin","initialValue","addDefaultSnap","snapValues","getSnapLocations","setSnapLocations","snapLocations","pointsForTarget","initDefaults","snap","snappingValues","CreateMoveSnapping","snapping","initSnap","snapContext","addSnapTargetPoints","isHidden","shapeTopLeft","shapeBottomRight","snapTargets","getSnapTargets","snapTarget","BpmnCreateMoveSnapping","setSnappedIfConstrained","snapBoundaryEvent","targetTRBL","areAll","isContainer","getDockingSnapOrigin","isMove","ResizeSnapping","isVertical","snapOrigin","isAttached","SNAP_TOLERANCE","SNAP_LINE_HIDE_DELAY","Snapping","_asyncHide","snapCurrent","locationSnapping","originValue","showSnapLine","axisSnapping","_createLine","_createSnapLines","_snapLines","getSnapLine","snapLine","createMoveSnapping","resizeSnapping","connectSnapping","SearchPad","_open","_results","_eventMaps","BOX_HTML","_searchInput","INPUT_SELECTOR","_resultsContainer","RESULTS_CONTAINER_SELECTOR","constructOverlay","box","OVERLAY_CLASS","createInnerTextNode","tokens","createHtmlText","htmlText","matched","RESULT_HIGHLIGHT_CLASS","normal","_bindEvents","listen","selector","focus","RESULT_SELECTOR","_scrollToNode","_preselect","_select","selected","_getCurrentResult","_scrollToDirection","_search","_unbindEvents","_clearResults","searchResults","_searchProvider","_createResultNode","previousElementSibling","nextElementSibling","nodeOffset","containerScroll","scrollTop","bottomScroll","_resetOverlay","RESULT_SELECTED_SELECTOR","RESULT_HTML","primaryTokens","RESULT_PRIMARY_HTML","secondaryTokens","RESULT_SECONDARY_HTML","RESULT_ID_ATTRIBUTE","blur","selectedNode","RESULT_SELECTED_CLASS","_centerViewbox","newViewbox","overlay","CONTAINER_SELECTOR","BpmnSearchProvider","hasMatched","matchAndSplit","originalText","substr","bpmnSearch","initialDiagram","Modeler","Viewer","NavigatedViewer","createDiagram","done","importXML","_interactionModules","_modelingModules","_modules","tasklist","createBaseFor","getLinkEventDefinition","linkEventDefinition","linkEvents","constant","ElementTemplatesLoader","loadTemplates","_loadTemplates","_elementTemplates","reload","templateErrors","setTemplates","validator","errors","validTemplates","templatesChanged","baseIsTypedArray","nodeUtil","nodeIsTypedArray","selectEntryFactory","comboBox","customValue","customName","isCustomValue","isCustom","comboOptions","showCustomInput","modifiedValues","comboBoxEntry","arrayTag","funcTag","float32Tag","float64Tag","int8Tag","int16Tag","int32Tag","uint8Tag","uint8ClampedTag","uint16Tag","uint32Tag","typedArrayTags","externalTaskPriority","objectCreate","baseToString","getSelectBox","currentTab","generateElementId","CREATE_EXTENSION_ELEMENT_ACTION","REMOVE_EXTENSION_ELEMENT_ACTION","idGeneration","hideElements","hideExtensionElements","canBeHidden","selectionChanged","createOption","initSelectionSize","optionsLength","extensionElementValue","generatedId","disableRemove","selectElement","hashHas","getListeners","CAMUNDA_EXECUTION_LISTENER_ELEMENT","CAMUNDA_TASK_LISTENER_ELEMENT","executionListenerEntry","taskListenerEntry","listeners","initialEvent","getDefaultTemplate","applyDefaultTemplate","commandContext","mapCacheClear","mapCacheDelete","mapCacheHas","MapCache","Stack","equalObjects","baseIsEqualDeep","objIsArr","othIsArr","objTag","othTag","objIsObj","othIsObj","isSameTag","objIsWrapped","othIsWrapped","objUnwrapped","othUnwrapped","Hash","calculateUpdate","currentValue","newValue","currentCursor","newCursor","currentTail","lastIndexOf","createDiff","newStart","newEnd","l_str","l_char","s_str","s_char","l_idx","s_idx","charAt","l_start","s_start","l_end","s_end","baseGetAllKeys","keysFunc","symbolsFunc","stackClear","stackGet","stackSet","setCacheAdd","propertiesPanel","asyncCapableHelper","processProps","eventProps","linkProps","documentationProps","idProps","nameProps","executableProps","serviceTaskDelegateProps","userTaskProps","asynchronousContinuationProps","callActivityProps","multiInstanceProps","conditionalProps","scriptProps","errorProps","formProps","startEventInitiator","variableMapping","listenerProps","listenerDetails","listenerFields","elementTemplateChooserProps","elementTemplateCustomProps","inputOutputParameter","connectorDetails","connectorInputOutput","connectorInputOutputParameter","jobConfiguration","candidateStarter","externalTaskConfiguration","fieldInjections","isExternalTaskPriorityEnabled","externalBo","isExternalTask","isJobConfigEnabled","getInputOutputParameterLabel","getListenerLabel","PROCESS_KEY_HINT","TASK_KEY_HINT","createGeneralTabGroups","idOptions","processOptions","generalGroup","processIdDescription","customFieldsGroups","detailsGroup","multiInstanceGroup","asyncGroup","jobConfigurationGroup","enabled","externalTaskGroup","candidateStarterGroup","historyTimeToLiveGroup","tasklistGroup","documentationGroup","createVariablesTabGroups","variablesGroup","createFormsTabGroups","formGroup","createListenersTabGroups","listenersGroup","listenerDetailsGroup","listenerFieldsGroup","createInputOutputTabGroups","inputOutputGroup","inputOutputParameterGroup","createConnectorTabGroups","connectorDetailsGroup","connectorInputOutputGroup","connectorInputOutputParameterGroup","createFieldInjectionsTabGroups","fieldGroup","createExtensionElementsGroups","propertiesGroup","CamundaPropertiesProvider","getTabs","generalTab","variablesTab","formsTab","listenersTab","inputOutputTab","connectorTab","fieldInjectionsTab","extensionsTab","HANDLERS","CommandInitializer","escapeText","escaped","encodeURI","hasPath","getBody","getLoopCardinality","getLoopCardinalityValue","loopCardinality","getCompletionCondition","getCompletionConditionValue","completionCondition","getCollection","getElementVariable","updateFormalExpression","expressionProps","existingExpression","isValid","notification","elementVariable","createBind","canBeDisabled","res","isDisabled","copyObject","isNew","arg","baseFilter","collectionAdd","CategoryHelper","eachFunc","asyncTag","genTag","proxyTag","DEFAULT_DELEGATE_PROPS","DELEGATE_PROPS","DMN_CAPABLE_PROPS","EXTERNAL_CAPABLE_PROPS","DEFAULT_OPTIONS","DMN_OPTION","EXTERNAL_OPTION","CONNECTOR_OPTION","SCRIPT_OPTION","getType","hasScriptSupport","implType","connectors","participantHelper","idEntry","getProcessBusinessObject","processId","modifyProcessBusinessObject","processIdError","processNameEntry","noCustomizer","FormHelper","getFormData","formData","getFormFields","fields","getFormField","formFields","getConstraints","formField","validation","constraints","getEnumValues","baseMap","freeProcess","require","findInputParameter","findOutputParameter","findCamundaProperty","findCamundaInOut","CAMUNDA_EXECUTION_LISTENER_TYPE","BASIC_MODDLE_TYPES","EXTENSION_BINDING_TYPES","IO_BINDING_TYPES","IN_OUT_BINDING_TYPES","propertyGetter","getPropertyValue","objectWithKey","propertySetter","setPropertyValue","propertyValidator","validateValue","camundaProperties","camundaProperty","ioParameter","ioElement","bindingName","unknownPropertyBinding","existingCamundaProperty","newCamundaProperty","existingIoParameter","newIoParameter","existingInOut","moddlePropertyDescriptor","propertiesByName","moddleType","existingFieldInjections","newFieldInjections","warn","notEmpty","maxLength","minLength","matchesPattern","propertyWithScope","regexp","renderCustomField","propertyType","entryOptions","customFieldsGroup","idScopeName","customScopeFieldsGroup","propertyId","scopedProperty","createExtensionElements","createFailedJobRetryTimeCycle","retryTimeCycleEntry","retryTimeCycle","newCycle","allowPrototypes","arrayLimit","decoder","decode","parameterLimit","plainObjects","parseValues","cleanStr","ignoreQueryPrefix","limit","parts","part","bracketEqualsPos","parseObject","chain","leaf","cleanRoot","parseArrays","parseKeys","givenKey","segment","isRegExp","tempObj","newObj","merge","compact","getScriptType","parentElement","scriptLanguagePropName","scriptValuePropName","isFormatRequired","boScriptResource","boScript","boScriptFormat","scriptResourceValue","scriptType","scriptValue","clearScriptFormat","btnNode","canClearScriptFormat","clearScriptResource","canClearScriptResource","clearScript","canClearScript","isScriptResource","Reporter","messages","arrLength","othLength","arrValue","othValue","compared","othIndex","baseSetToString","getContainedActivities","getFlowElements","getContainedBoundaryEvents","isCompensationEventAttachedToActivity","activity","activityId","canActivityBeCompensated","getActivitiesForCompensation","getActivitiesForActivityRef","activitiesForActivityRef","createActivityRefOptions","activities","waitForCompletion","activityRef","argument","method","DELEGATE_TYPES","PROPERTIES","isDelegate","getDelegationLabel","delegateEntry","delegationLabel","nativeMin","oldArray","validationErrors","getAllKeys","isList","isMap","typeInfo","nameValue","parameterType","createParameterTypeElem","items","newEntry","PLACEHOLDER","WRAP_CURRY_BOUND_FLAG","WRAP_REARG_FLAG","mergeData","srcBitmask","newBitmask","isCombo","resultVariableEntry","DESCRIPTORS","thrower","it","ACCESSORS","argument0","argument1","O","FUNC_ERROR_TEXT","debounce","wait","lastArgs","lastThis","maxWait","timerId","lastCallTime","lastInvokeTime","leading","maxing","trailing","invokeFunc","time","leadingEdge","timerExpired","remainingWait","timeSinceLastCall","timeSinceLastInvoke","timeWaiting","shouldInvoke","trailingEdge","flush","debounced","isInvoking","objProps","objLength","othProps","skipCtor","objCtor","othCtor","isCatchingErrorEvent","MAX_SAFE_INTEGER","percentTwenties","RFC1738","RFC3986","baseSetData","outgoingWithoutCondition","isSymbol","NAN","reTrim","reIsBadHex","reIsBinary","reIsOctal","freeParseInt","isBinary","IndexedObject","toObject","toLength","arraySpeciesCreate","createMethod","TYPE","IS_MAP","IS_FILTER","IS_SOME","IS_EVERY","IS_FIND_INDEX","NO_HOLES","$this","specificCreate","boundFunction","versionTagEntry","processBo","propertiesEntry","reWrapDetails","reSplitDetails","hashGet","disallowNodeType","externalTaskPriorityEntry","taskPriority","defaultButtonAction","defaultButtonShow","buttonLabel","buttonAction","actionMethod","showName","buttonShow","showMethod","documentations","documentation","newObjectList","elementDocuEntry","processDocuEntry","isEventSubProcess","isConditionalStartEvent","reIsUint","querySearchAsync","handleSelect","nativeOn","$event","_k","search","scopedSlots","_u","_s","address","callback","$$v","CreateAndReferenceElementHandler","referencingObject","newObject","newObjectContainer","newObjectParent","referencedObject","previousReference","blankStartEvents","shortOut","Resolver","bundle","clone","__chain__","__index__","__values__","getCamundaInOutMappings","getVariableMappings","camundaMappings","mapping","getInOutType","inOutType","CAMUNDA_IN_EXTENSION_ELEMENT","CAMUNDA_OUT_EXTENSION_ELEMENT","WHITESPACE_REGEX","inOutTypeOptions","inEntry","outEntry","variableMappings","mappingValue","mappingType","variablesMappings","sourceLabel","selectedMapping","exportName","VENDOR_PREFIXES","TEST_ELEMENT","TYPE_FUNCTION","setTimeoutContext","bindFn","invokeArrayArg","each","iterator","deprecationMessage","output","nextKey","extend","dest","src","inherit","base","childP","baseP","_super","boolOrFn","ifUndefined","val1","val2","addEventListeners","splitStr","removeEventListeners","hasParent","inStr","inArray","findByKey","uniqueArray","results","prefixed","camelProp","toUpperCase","_uniqueId","uniqueId","getWindowForElement","doc","ownerDocument","defaultView","parentWindow","MOBILE_REGEX","SUPPORT_TOUCH","SUPPORT_POINTER_EVENTS","SUPPORT_ONLY_TOUCH","navigator","userAgent","INPUT_TYPE_TOUCH","INPUT_TYPE_PEN","INPUT_TYPE_MOUSE","INPUT_TYPE_KINECT","COMPUTE_INTERVAL","INPUT_START","INPUT_MOVE","INPUT_END","INPUT_CANCEL","DIRECTION_NONE","DIRECTION_LEFT","DIRECTION_RIGHT","DIRECTION_UP","DIRECTION_DOWN","DIRECTION_HORIZONTAL","DIRECTION_VERTICAL","DIRECTION_ALL","PROPS_XY","PROPS_CLIENT_XY","Input","manager","inputTarget","domHandler","ev","enable","createInputInstance","Type","PointerEventInput","TouchMouseInput","MouseInput","inputHandler","pointersLen","pointers","changedPointersLen","changedPointers","isFinal","computeInputData","recognize","prevInput","pointersLength","firstInput","simpleCloneInputData","firstMultiple","offsetCenter","getCenter","timeStamp","deltaTime","computeDeltaXY","offsetDirection","overallVelocity","getVelocity","overallVelocityX","overallVelocityY","getScale","rotation","getRotation","maxPointers","computeIntervalInputData","offsetDelta","prevDelta","velocity","velocityX","velocityY","lastInterval","atan2","PI","evEl","evTarget","evWin","MOUSE_INPUT_MAP","mousedown","mousemove","mouseup","MOUSE_ELEMENT_EVENTS","MOUSE_WINDOW_EVENTS","pressed","pointerType","POINTER_INPUT_MAP","pointerdown","pointermove","pointerup","pointercancel","pointerout","IE10_POINTER_TYPE_ENUM","3","4","5","POINTER_ELEMENT_EVENTS","POINTER_WINDOW_EVENTS","store","MSPointerEvent","PointerEvent","removePointer","eventTypeNormalized","storeIndex","pointerId","SINGLE_TOUCH_INPUT_MAP","touchstart","touchmove","touchend","touchcancel","SINGLE_TOUCH_TARGET_EVENTS","SINGLE_TOUCH_WINDOW_EVENTS","SingleTouchInput","started","normalizeSingleTouches","touches","changedTouches","TOUCH_INPUT_MAP","TOUCH_TARGET_EVENTS","targetIds","getTouches","allTouches","identifier","targetTouches","changedTargetTouches","touch","DEDUP_TIMEOUT","DEDUP_DISTANCE","primaryTouch","lastTouches","recordTouches","eventData","setLastTouch","lastTouch","lts","removeLastTouch","isSyntheticEvent","inputEvent","inputData","isMouse","sourceCapabilities","firesTouchEvents","PREFIXED_TOUCH_ACTION","NATIVE_TOUCH_ACTION","TOUCH_ACTION_COMPUTE","TOUCH_ACTION_AUTO","TOUCH_ACTION_MANIPULATION","TOUCH_ACTION_NONE","TOUCH_ACTION_PAN_X","TOUCH_ACTION_PAN_Y","TOUCH_ACTION_MAP","getTouchActionProps","TouchAction","cleanTouchActions","hasPanX","hasPanY","touchMap","cssSupports","CSS","supports","compute","touchAction","getTouchAction","preventDefaults","prevented","hasNone","isTapPointer","isTapMovement","isTapTouchTime","preventSrc","STATE_POSSIBLE","STATE_BEGAN","STATE_CHANGED","STATE_ENDED","STATE_RECOGNIZED","STATE_CANCELLED","STATE_FAILED","Recognizer","simultaneous","requireFail","stateStr","directionStr","getRecognizerByNameIfManager","otherRecognizer","AttrRecognizer","PanRecognizer","pX","pY","PinchRecognizer","PressRecognizer","_timer","_input","RotateRecognizer","SwipeRecognizer","TapRecognizer","pTime","pCenter","Hammer","preset","recognizeWith","dropRecognizeWith","dropRequireFailure","hasRequireFailures","canRecognizeWith","additionalEvent","tryEmit","canEmit","inputDataClone","attrTest","optionPointers","isRecognized","directionTest","hasMoved","inOut","validPointers","validMovement","validTime","interval","posThreshold","validTouchTime","failTimeout","validInterval","validMultiTap","tapCount","VERSION","domEvents","cssProps","userSelect","touchSelect","touchCallout","contentZooming","userDrag","tapHighlightColor","STOP","FORCED_STOP","oldCssProps","toggleCssProps","triggerDomEvent","gestureEvent","gesture","existing","Swipe","Rotate","$indexOf","arrayMethodIsStrict","nativeIndexOf","NEGATIVE_ZERO","STRICT_METHOD","searchElement","isForking","leftIndex","leftLength","symbolToString","createPartial","pairs","domQueryAll","queryAll","domRemove","domDelegate","domMatches","scrollTabs","HIDE_CLASS","DEBOUNCE_DELAY","isToggle","isSelect","isContentEditable","getPropertyPlaceholders","placeholders","getFormControls","controls","getFormControlValuesInScope","controlNodes","controlNode","checked","getFormControlValues","listContainer","listNodes","listNode","valuesEqual","extractEntries","tabs","extractGroups","PropertiesPanel","_propertiesProvider","isImplicitRoot","tabBarNode","scroller","selectors","tabsContainer","tab","ignore","newActiveNode","oldActiveNode","linkNode","tabId","activateTab","detach","_bindListeners","attachTo","panelNode","panel","allTabNodes","allTabLinkNodes","tabNode","currentTabId","tabLinkNode","tabLink","needsCreate","newTabs","_entriesChanged","activeTabId","activeTabNode","_updateActivation","oldEntryIds","newEntryIds","handleChange","getEntry","onChangeAction","isEntryDirty","executeAction","applyChanges","updateState","handleInput","eventHandlerId","actionId","updateShow","updateDisable","showNodes","showNode","expr","shouldShow","currentNode","shouldDisable","commandToExecute","applyValidationErrors","valid","errorMessageNode","nextSibling","listEntryNodes","listValue","listEntryNode","setInputValue","contentEditable","setSelectValue","setToggleValue","nodeValue","setTextValue","getContentEditableSelection","focusNode","focusOffset","anchorOffset","setContentEditableSelection","domRange","domSelection","containerNode","_createPanel","_bindTemplate","inputNodes","isGroupVisible","groupNode","isTabVisible","toggleVisible","checkActiveTabVisibility","labelNode","tabVisible","groupVisible","listEntryContainer","existingElements","listItemNode","entriesToRemove","j","headerNode","tabLinksNode","tabContainerNode","tabIndex","querySelector","cssClass","hexTable","compactQueue","queue","compacted","arrayToObject","mergeTarget","acc","decodeURIComponent","refs","MultiCommandHandler","hasStartEvent","EventDefinitionHelper","setCacheHas","reWrapComment","details","ParticipantHelper","selectbox","inputName","UpdateBusinessObjectHandler","referenceType","extensionsElementHelper","isListener","decisionRef","hasFunc","canRemoveFailedJobRetryTimeCycle","asyncBeforeEntry","asyncBefore","asyncAfterEntry","asyncAfter","exclusiveEntry","exclusive","matcher","isInOut","parameters","memoized","Cache","basePropertyDeep","linting","toggleLinting","ErrorSvg","WarningSvg","SuccessSvg","OFFSET_TOP","OFFSET_RIGHT","emptyConfig","stateToIcon","warning","inactive","Linting","_bpmnjs","_issues","_linterConfig","_overlayIds","_clearIssues","_updateButton","linterConfig","bpmnlint","getLinterConfig","setLinterConfig","_createButton","_formatIssues","issues","ruleReports","newActive","_setActive","lintStart","_lintStart","random","newIssues","id1","id2","_clearOverlays","_createIssues","_fireComplete","_createElementIssues","elementId","elementIssues","menuPosition","issuesByType","elementIssue","warnings","$html","$icon","$dropdown","$dropdownContent","$issues","$issueList","_addErrors","_addWarnings","$ul","_addEntry","icon","$entry","_setButtonState","_button","classList","issue","linter","lintingEditorActions","setData","WRAP_PARTIAL_RIGHT_FLAG","wrapFunc","isCurry","newHoldersRight","newPartials","newPartialsRight","escape","cssEscape","codeUnit","firstCodeUnit","textInputField","checkboxField","selectBoxField","comboBoxField","textBoxField","validationAwareTextInputField","tableField","labelEntry","setDefaultParameters","defaultGet","defaultSet","defaultValidate","EntryFactory","classof","chainAll","baseProperty","formHelper","generateValueId","formFieldTextField","getSelectedFormField","selectedFormField","ensureFormKeyAndDataSupported","formKey","formFieldsEntry","formBusinessKeyFormFieldEntry","formDataExtension","storedValue","isStartEvent","existingFormField","f","enumValue","newConstraint","constraint","currentConstraint","isStartableInTasklistEntry","isStartableInTasklist","executableEntry","HOT_COUNT","HOT_SPAN","nativeNow","lastCalled","stamp","remaining","codeVariable","escalationCodeVariable","reIsDeepProp","reIsPlainProp","findElementById","selectedElement","optionTemplate","CAMUNDA_FIELD_EXTENSION_ELEMENT","getSelectedField","fieldEntry","getCamundaFields","getCamundaListenerFields","getFieldType","fieldType","expressionValue","stringValue","camundaFields","newFieldElem","selectedField","fieldName","fieldTypeOptions","fieldValue","__lastInvalidValue","wrapFlags","pair","mitt","scrollSymbolLeft","scrollSymbolRight","ScrollTabs","$el","_createScrollButtons","__scrollTabs","getActiveTabNode","getTabsContainerNode","getAllTabNodes","getVisibleTabs","allTabs","getAdjacentTab","referenceTabNode","visibleTabs","_bindWheelEvent","_bindTabClickEvents","_bindScrollButtonEvents","scrollToTabNode","oldActiveTab","newActiveTab","oldActiveTabNode","newActiveTabNode","tabsContainerNode","tabWidth","offsetWidth","tabOffsetLeft","tabOffsetRight","containerScrollLeft","scrollLeft","overflowClass"],"mappings":"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","file":"js/chunk-3f5258dc.ad3c4921.js","sourcesContent":["'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar find = require('min-dash').find;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../helper/CmdHelper'),\n    ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    scriptImplementation = require('./implementation/Script'),\n    timerImplementation = require('../../bpmn/parts/implementation/TimerEventDefinition');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  var LISTENER_TYPE_LABEL = {\n    class: translate('Java Class'),\n    expression: translate('Expression'),\n    delegateExpression: translate('Delegate Expression'),\n    script: translate('Script')\n  };\n\n  options = options || {};\n\n  var getSelectedListener = options.getSelectedListener;\n\n  var classProp = 'class',\n      expressionProp = 'expression',\n      delegateExpressionProp = 'delegateExpression',\n      scriptProp = 'script';\n\n  var executionListenerEventTypeOptions = ImplementationTypeHelper.isSequenceFlow(element) ? [\n    { name: translate('take'), value: 'take' }\n  ] : [\n    { name: translate('start'), value: 'start' },\n    { name: translate('end'), value: 'end' }\n  ];\n\n  var taskListenerEventTypeOptions = [\n    { name: translate('create'), value: 'create' },\n    { name: translate('assignment'), value: 'assignment' },\n    { name: translate('complete'), value: 'complete' },\n    { name: translate('delete'), value: 'delete' },\n    { name: translate('update'), value: 'update' },\n    { name: translate('timeout'), value: 'timeout' }\n  ];\n\n  var isSelected = function(element, node) {\n    return getSelectedListener(element, node);\n  };\n\n\n  // eventType ////////////////\n  group.entries.push(entryFactory.selectBox({\n    id: 'listener-event-type',\n    label: translate('Event Type'),\n    modelProperty: 'eventType',\n    emptyParameter: false,\n\n    get: function(element, node) {\n\n      var listener = getSelectedListener(element, node);\n\n      var eventType = listener && listener.get('event');\n\n      return {\n        eventType: eventType\n      };\n    },\n\n    set: function(element, values, node) {\n      var eventType = values.eventType,\n          listener = getSelectedListener(element, node),\n          eventDefinitions = listener && listener.eventDefinitions;\n\n      // ensure only timeout events can have timer event definitions\n      if (eventDefinitions && eventType !== 'timeout') {\n        eventDefinitions = [];\n      }\n\n      return cmdHelper.updateBusinessObject(element, listener,\n        {\n          event: eventType,\n          eventDefinitions: eventDefinitions\n        }\n      );\n    },\n\n    selectOptions: function(element, node) {\n      var eventTypeOptions;\n\n      var selectedListener = getSelectedListener(element, node);\n      if (ImplementationTypeHelper.isTaskListener(selectedListener)) {\n        eventTypeOptions = taskListenerEventTypeOptions;\n      } else if (ImplementationTypeHelper.isExecutionListener(selectedListener)) {\n        eventTypeOptions = executionListenerEventTypeOptions;\n      }\n\n      return eventTypeOptions;\n\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  // listenerId ///////////////\n  group.entries.push(entryFactory.textField({\n    id: 'listener-id',\n    label: translate('Listener Id'),\n    modelProperty: 'listenerId',\n\n    get: function(element, node) {\n      var value = {},\n          listener = getSelectedListener(element, node);\n\n      value.listenerId = (listener && listener.get('id')) || undefined;\n\n      return value;\n    },\n\n    set: function(element, values, node) {\n      var update = {},\n          listener = getSelectedListener(element, node);\n\n      update['id'] = values.listenerId || '';\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      var listener = getSelectedListener(element, node);\n\n      return !ImplementationTypeHelper.isTaskListener(listener);\n    },\n\n    validate: function(element, values, node) {\n      var value = values.listenerId,\n          listener = getSelectedListener(element, node),\n          validate = {};\n\n      if (!value && isTimeoutTaskListener(listener)) {\n        validate.listenerId = translate('Must provide a value for timeout task listener');\n      }\n\n      return validate;\n    }\n\n  }));\n\n\n  // listenerType ///////////////\n  group.entries.push(entryFactory.selectBox({\n    id: 'listener-type',\n    label: translate('Listener Type'),\n    selectOptions: [\n      { value: classProp, name: translate('Java Class') },\n      { value: expressionProp, name: translate('Expression') },\n      { value: delegateExpressionProp, name: translate('Delegate Expression') },\n      { value: scriptProp, name: translate('Script') }\n    ],\n    modelProperty: 'listenerType',\n    emptyParameter: false,\n\n    get: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return {\n        listenerType: ImplementationTypeHelper.getImplementationType(listener)\n      };\n    },\n\n    set: function(element, values, node) {\n      var listener = getSelectedListener(element, node),\n          listenerType = values.listenerType || undefined,\n          update = {};\n\n      update[classProp] = listenerType === classProp ? '' : undefined;\n      update[expressionProp] = listenerType === expressionProp ? '' : undefined;\n      update[delegateExpressionProp] = listenerType === delegateExpressionProp ? '' : undefined;\n      update[scriptProp] = listenerType === scriptProp ? bpmnFactory.create('camunda:Script') : undefined;\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  // listenerValue //////////////\n  group.entries.push(entryFactory.textField({\n    id: 'listener-value',\n    dataValueLabel: 'listenerValueLabel',\n    modelProperty: 'listenerValue',\n\n    get: function(element, node) {\n      var value = {},\n          listener = getSelectedListener(element, node),\n          listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      value.listenerValueLabel = LISTENER_TYPE_LABEL[listenerType] || '';\n      value.listenerValue = (listener && listener.get(listenerType)) || undefined;\n\n      return value;\n    },\n\n    set: function(element, values, node) {\n      var update = {},\n          listener = getSelectedListener(element, node),\n          listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      update[listenerType] = values.listenerValue || '';\n\n      return cmdHelper.updateBusinessObject(element, listener, update);\n    },\n\n    hidden: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return !listener || listener.script;\n    },\n\n    validate: function(element, values) {\n      var value = values.listenerValue,\n          validate = {};\n\n      if (!value) {\n        validate.listenerValue = translate('Must provide a value');\n      }\n\n      return validate;\n    }\n\n  }));\n\n\n  // script ////////////////////\n  var script = scriptImplementation('scriptFormat', 'value', true, translate);\n\n  group.entries.push({\n    id: 'listener-script-value',\n    html: '<div data-show=\"isScript\">' +\n            script.template +\n          '</div>',\n\n    get: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script ? script.get(element, listener.script) : {};\n    },\n\n    set: function(element, values, node) {\n      var listener = getSelectedListener(element, node);\n      var update = script.set(element, values, listener);\n      return cmdHelper.updateBusinessObject(element, listener.script, update);\n    },\n\n    validate: function(element, values, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script ? script.validate(element, values) : {};\n    },\n\n    isScript: function(element, node) {\n      var listener = getSelectedListener(element, node);\n      return listener && listener.script;\n    },\n\n    script: script\n\n  });\n\n\n  // timerEventDefinition //////\n  var timerEventDefinitionHandler = function(element, node) {\n    var listener = getSelectedListener(element, node);\n\n    if (!listener || !isTimeoutTaskListener(listener)) {\n      return;\n    }\n\n    var timerEventDefinition = getTimerEventDefinition(listener);\n\n    if (!timerEventDefinition) {\n      return false;\n    }\n\n    return timerEventDefinition;\n  };\n\n  function createTimerEventDefinition(element, node) {\n\n    var listener = getSelectedListener(element, node);\n\n    if (!listener || !isTimeoutTaskListener(listener)) {\n      return;\n    }\n\n    var eventDefinitions = listener.get('eventDefinitions') || [],\n        timerEventDefinition = bpmnFactory.create('bpmn:TimerEventDefinition');\n\n    eventDefinitions.push(timerEventDefinition);\n\n    listener.eventDefinitions = eventDefinitions;\n\n    return timerEventDefinition;\n  }\n\n  var timerOptions = {\n    idPrefix: 'listener-',\n    createTimerEventDefinition: createTimerEventDefinition\n  };\n\n  timerImplementation(group, element, bpmnFactory, timerEventDefinitionHandler, translate, timerOptions);\n\n};\n\n\n// helpers //////////////\n\nfunction isTimeoutTaskListener(listener) {\n  var eventType = listener && listener.event;\n  return eventType === 'timeout';\n}\n\nfunction getTimerEventDefinition(bo) {\n  var eventDefinitions = bo.eventDefinitions || [];\n\n  return find(eventDefinitions, function(event) {\n    return is(event, 'bpmn:TimerEventDefinition');\n  });\n\n}\n","var Symbol = require('./_Symbol');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * A specialized version of `baseGetTag` which ignores `Symbol.toStringTag` values.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the raw `toStringTag`.\n */\nfunction getRawTag(value) {\n  var isOwn = hasOwnProperty.call(value, symToStringTag),\n      tag = value[symToStringTag];\n\n  try {\n    value[symToStringTag] = undefined;\n    var unmasked = true;\n  } catch (e) {}\n\n  var result = nativeObjectToString.call(value);\n  if (unmasked) {\n    if (isOwn) {\n      value[symToStringTag] = tag;\n    } else {\n      delete value[symToStringTag];\n    }\n  }\n  return result;\n}\n\nmodule.exports = getRawTag;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar callable = require('./implementation/Callable');\n\nvar cmdHelper = require('../../../helper/CmdHelper');\n\nvar flattenDeep = require('lodash/flattenDeep');\nvar assign = require('lodash/assign');\n\nfunction getCallableType(element) {\n  var bo = getBusinessObject(element);\n\n  var boCalledElement = bo.get('calledElement'),\n      boCaseRef = bo.get('camunda:caseRef');\n\n  var callActivityType = '';\n  if (typeof boCalledElement !== 'undefined') {\n    callActivityType = 'bpmn';\n  } else\n\n  if (typeof boCaseRef !== 'undefined') {\n    callActivityType = 'cmmn';\n  }\n\n  return callActivityType;\n}\n\nvar DEFAULT_PROPS = {\n  calledElement: undefined,\n  'camunda:calledElementBinding': 'latest',\n  'camunda:calledElementVersion': undefined,\n  'camunda:calledElementTenantId': undefined,\n  'camunda:variableMappingClass' : undefined,\n  'camunda:variableMappingDelegateExpression' : undefined,\n  'camunda:caseRef': undefined,\n  'camunda:caseBinding': 'latest',\n  'camunda:caseVersion': undefined,\n  'camunda:caseTenantId': undefined\n};\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!is(element, 'camunda:CallActivity')) {\n    return;\n  }\n\n  group.entries.push(entryFactory.selectBox({\n    id : 'callActivity',\n    label: translate('CallActivity Type'),\n    selectOptions: [\n      { name: 'BPMN', value: 'bpmn' },\n      { name: 'CMMN', value: 'cmmn' }\n    ],\n    emptyParameter: true,\n    modelProperty: 'callActivityType',\n\n    get: function(element, node) {\n      return {\n        callActivityType: getCallableType(element)\n      };\n    },\n\n    set: function(element, values, node) {\n      var type = values.callActivityType;\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      if (type === 'bpmn') {\n        props.calledElement = '';\n      }\n      else if (type === 'cmmn') {\n        props['camunda:caseRef'] = '';\n      }\n\n      return cmdHelper.updateProperties(element, props);\n    }\n\n  }));\n\n  group.entries.push(callable(element, bpmnFactory, {\n    getCallableType: getCallableType\n  }, translate));\n\n  group.entries = flattenDeep(group.entries);\n};\n","var isPrototype = require('./_isPrototype'),\n    nativeKeys = require('./_nativeKeys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * The base implementation of `_.keys` which doesn't treat sparse arrays as dense.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n */\nfunction baseKeys(object) {\n  if (!isPrototype(object)) {\n    return nativeKeys(object);\n  }\n  var result = [];\n  for (var key in Object(object)) {\n    if (hasOwnProperty.call(object, key) && key != 'constructor') {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseKeys;\n","module.exports = {\n  __depends__: [\n    require('./element-templates'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [ 'propertiesProvider' ],\n  propertiesProvider: [ 'type', require('./CamundaPropertiesProvider') ]\n};\n","'use strict';\n\nvar inputOutput = require('./implementation/InputOutput');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inputOutputEntry = inputOutput(element, bpmnFactory, {\n    idPrefix: 'connector-',\n    insideConnector: true\n  }, translate);\n\n  group.entries = group.entries.concat(inputOutputEntry.entries);\n\n  return {\n    getSelectedParameter: inputOutputEntry.getSelectedParameter\n  };\n\n};\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    InputOutputHelper = require('../../../helper/InputOutputHelper');\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nfunction getImplementationType(element) {\n  return ImplementationTypeHelper.getImplementationType(element);\n}\n\nfunction getBusinessObject(element) {\n  return ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n}\n\nfunction getConnector(bo) {\n  return InputOutputHelper.getConnector(bo);\n}\n\nfunction isConnector(element) {\n  return getImplementationType(element) === 'connector';\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  group.entries.push(entryFactory.textField({\n    id: 'connectorId',\n    label: translate('Connector Id'),\n    modelProperty: 'connectorId',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var connector = bo && getConnector(bo);\n      var value = connector && connector.get('connectorId');\n      return { connectorId: value };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var connector = getConnector(bo);\n      return cmdHelper.updateBusinessObject(element, connector, {\n        connectorId: values.connectorId || undefined\n      });\n    },\n\n    validate: function(element, values, node) {\n      return isConnector(element) && !values.connectorId ? { connectorId: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isConnector(element);\n    }\n\n  }));\n\n};\n","var Symbol = require('./_Symbol'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray');\n\n/** Built-in value references. */\nvar spreadableSymbol = Symbol ? Symbol.isConcatSpreadable : undefined;\n\n/**\n * Checks if `value` is a flattenable `arguments` object or array.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is flattenable, else `false`.\n */\nfunction isFlattenable(value) {\n  return isArray(value) || isArguments(value) ||\n    !!(spreadableSymbol && value && value[spreadableSymbol]);\n}\n\nmodule.exports = isFlattenable;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=style&index=0&lang=css&\"","/**\n * This method returns `false`.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {boolean} Returns `false`.\n * @example\n *\n * _.times(2, _.stubFalse);\n * // => [false, false]\n */\nfunction stubFalse() {\n  return false;\n}\n\nmodule.exports = stubFalse;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar factory = require('../../../../factory/EntryFactory');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nvar assign = require('lodash/assign'),\n    forEach = require('lodash/forEach'),\n    find = require('lodash/find');\n\nfunction generatePropertyId() {\n  return utils.nextId('Property_');\n}\n\n/**\n * Get all camunda:property objects for a specific business object\n *\n * @param  {ModdleElement} parent\n *\n * @return {Array<ModdleElement>} a list of camunda:property objects\n */\nfunction getPropertyValues(parent) {\n  var properties = parent && getPropertiesElement(parent);\n  if (properties && properties.values) {\n    return properties.values;\n  }\n  return [];\n}\n\n/**\n * Get all camunda:Properties object for a specific business object\n *\n * @param  {ModdleElement} parent\n *\n * @return {ModdleElement} a camunda:Properties object\n */\nfunction getPropertiesElement(element) {\n  if (!isExtensionElements(element)) {\n    return element.properties;\n  } else {\n    return getPropertiesElementInsideExtensionElements(element);\n  }\n}\n\n/**\n * Get first camunda:Properties object for a specific bpmn:ExtensionElements\n * business object.\n *\n * @param {ModdleElement} extensionElements\n *\n * @return {ModdleElement} a camunda:Properties object\n */\nfunction getPropertiesElementInsideExtensionElements(extensionElements) {\n  return find(extensionElements.values, function(elem) {\n    return is(elem, 'camunda:Properties');\n  });\n}\n\n/**\n * Returns true, if the given business object is a bpmn:ExtensionElements.\n *\n * @param {ModdleElement} element\n *\n * @return {boolean} a boolean value\n */\nfunction isExtensionElements(element) {\n  return is(element, 'bpmn:ExtensionElements');\n}\n\n/**\n * Create a camunda:property entry using tableEntryFactory\n *\n * @param  {djs.model.Base} element\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {Array<string>} options.modelProperties\n * @param  {Array<string>} options.labels\n * @param  {function} options.getParent Gets the parent business object\n * @param  {function} options.show Indicate when the entry will be shown, should return boolean\n */\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getParent = options.getParent;\n\n  var modelProperties = options.modelProperties,\n      createParent = options.createParent;\n\n  var bo = getBusinessObject(element);\n  if (is(element, 'bpmn:Participant')) {\n    bo = bo.get('processRef');\n  }\n\n  // build properties group only when the participant have a processRef\n  if (!bo) {\n    return;\n  }\n\n  assign(options, {\n    addLabel: translate('Add Property'),\n    getElements: function(element, node) {\n      var parent = getParent(element, node, bo);\n      return getPropertyValues(parent);\n    },\n    addElement: function(element, node) {\n      var commands = [],\n          parent = getParent(element, node, bo);\n\n      if (!parent && typeof createParent === 'function') {\n        var result = createParent(element, bo);\n        parent = result.parent;\n        commands.push(result.cmd);\n      }\n\n      var properties = getPropertiesElement(parent);\n      if (!properties) {\n        properties = elementHelper.createElement('camunda:Properties', {}, parent, bpmnFactory);\n\n        if (!isExtensionElements(parent)) {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { 'properties': properties }));\n        } else {\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            parent,\n            'values',\n            'extensionElements',\n            [ properties ],\n            []\n          ));\n        }\n      }\n\n      var propertyProps = {};\n      forEach(modelProperties, function(prop) {\n        propertyProps[prop] = undefined;\n      });\n\n      // create id if necessary\n      if (modelProperties.indexOf('id') >= 0) {\n        propertyProps.id = generatePropertyId();\n      }\n\n      var property = elementHelper.createElement('camunda:Property', propertyProps, properties, bpmnFactory);\n      commands.push(cmdHelper.addElementsTolist(element, properties, 'values', [ property ]));\n\n      return commands;\n    },\n    updateElement: function(element, value, node, idx) {\n      var parent = getParent(element, node, bo),\n          property = getPropertyValues(parent)[idx];\n\n      forEach(modelProperties, function(prop) {\n        value[prop] = value[prop] || undefined;\n      });\n\n      return cmdHelper.updateBusinessObject(element, property, value);\n    },\n    validate: function(element, value, node, idx) {\n      // validate id if necessary\n      if (modelProperties.indexOf('id') >= 0) {\n\n        var parent = getParent(element, node, bo),\n            properties = getPropertyValues(parent),\n            property = properties[idx];\n\n        if (property) {\n          // check if id is valid\n          var validationError = utils.isIdValid(property, value.id, translate);\n\n          if (validationError) {\n            return { id: validationError };\n          }\n        }\n      }\n    },\n    removeElement: function(element, node, idx) {\n      var commands = [],\n          parent = getParent(element, node, bo),\n          properties = getPropertiesElement(parent),\n          propertyValues = getPropertyValues(parent),\n          currentProperty = propertyValues[idx];\n\n      commands.push(cmdHelper.removeElementsFromList(element, properties, 'values', null, [ currentProperty ]));\n\n      if (propertyValues.length === 1) {\n        // remove camunda:properties if the last existing property has been removed\n        if (!isExtensionElements(parent)) {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { properties: undefined }));\n        } else {\n          forEach(parent.values, function(value) {\n            if (is(value, 'camunda:Properties')) {\n              commands.push(extensionElementsHelper.removeEntry(bo, element, value));\n            }\n          });\n        }\n      }\n\n      return commands;\n    }\n  });\n\n  return factory.table(options);\n};\n","/**\n * Appends the elements of `values` to `array`.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {Array} values The values to append.\n * @returns {Array} Returns `array`.\n */\nfunction arrayPush(array, values) {\n  var index = -1,\n      length = values.length,\n      offset = array.length;\n\n  while (++index < length) {\n    array[offset + index] = values[index];\n  }\n  return array;\n}\n\nmodule.exports = arrayPush;\n","var isObject = require('./isObject');\n\n/**\n * Checks if `value` is suitable for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` if suitable for strict\n *  equality comparisons, else `false`.\n */\nfunction isStrictComparable(value) {\n  return value === value && !isObject(value);\n}\n\nmodule.exports = isStrictComparable;\n","/**\n * A specialized version of `_.indexOf` which performs strict equality\n * comparisons of values, i.e. `===`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction strictIndexOf(array, value, fromIndex) {\n  var index = fromIndex - 1,\n      length = array.length;\n\n  while (++index < length) {\n    if (array[index] === value) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = strictIndexOf;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\n/**\n * Create an input parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createInputParameter(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:InputParameter', {\n    name: binding.name,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\nmodule.exports.createInputParameter = createInputParameter;\n\n\n/**\n * Create an output parameter representing the given\n * binding and value.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createOutputParameter(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: binding.source\n    });\n  } else {\n    parameterValue = binding.source;\n  }\n\n  return bpmnFactory.create('camunda:OutputParameter', {\n    name: value,\n    value: parameterValue,\n    definition: parameterDefinition\n  });\n}\n\nmodule.exports.createOutputParameter = createOutputParameter;\n\n\n/**\n * Create camunda property from the given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaProperty(binding, value, bpmnFactory) {\n  return bpmnFactory.create('camunda:Property', {\n    name: binding.name,\n    value: value || ''\n  });\n}\n\nmodule.exports.createCamundaProperty = createCamundaProperty;\n\n\n/**\n * Create camunda:in element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaIn(binding, value, bpmnFactory) {\n\n  var properties = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:In', properties);\n}\n\nmodule.exports.createCamundaIn = createCamundaIn;\n\n\n/**\n * Create camunda:in with businessKey element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaInWithBusinessKey(binding, value, bpmnFactory) {\n  return bpmnFactory.create('camunda:In', {\n    businessKey: value\n  });\n}\n\nmodule.exports.createCamundaInWithBusinessKey = createCamundaInWithBusinessKey;\n\n\n/**\n * Create camunda:out element from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaOut(binding, value, bpmnFactory) {\n  var properties = createCamundaInOutAttrs(binding, value);\n\n  return bpmnFactory.create('camunda:Out', properties);\n}\n\nmodule.exports.createCamundaOut = createCamundaOut;\n\n\n/**\n * Create camunda:executionListener element containing an inline script from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaExecutionListenerScript(binding, value, bpmnFactory) {\n  var scriptFormat = binding.scriptFormat,\n      parameterValue,\n      parameterDefinition;\n\n  if (scriptFormat) {\n    parameterDefinition = bpmnFactory.create('camunda:Script', {\n      scriptFormat: scriptFormat,\n      value: value\n    });\n  } else {\n    parameterValue = value;\n  }\n\n  return bpmnFactory.create('camunda:ExecutionListener', {\n    event: binding.event,\n    value: parameterValue,\n    script: parameterDefinition\n  });\n}\n\nmodule.exports.createCamundaExecutionListenerScript = createCamundaExecutionListenerScript;\n\n/**\n * Create camunda:field element containing string or expression from given binding.\n *\n * @param {PropertyBinding} binding\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement}\n */\nfunction createCamundaFieldInjection(binding, value, bpmnFactory) {\n  var DEFAULT_PROPS = {\n    'string': undefined,\n    'expression': undefined,\n    'name': undefined\n  };\n\n  var props = assign({}, DEFAULT_PROPS);\n\n  if (!binding.expression) {\n    props.string = value;\n  } else {\n    props.expression = value;\n  }\n  props.name = binding.name;\n\n  return bpmnFactory.create('camunda:Field', props);\n}\nmodule.exports.createCamundaFieldInjection = createCamundaFieldInjection;\n\n\n// helpers ////////////////////////////\n\n/**\n * Create properties for camunda:in and camunda:out types.\n */\nfunction createCamundaInOutAttrs(binding, value) {\n\n  var properties = {};\n\n  // camunda:in source(Expression) target\n  if (binding.target) {\n\n    properties.target = binding.target;\n\n    if (binding.expression) {\n      properties.sourceExpression = value;\n    } else {\n      properties.source = value;\n    }\n  } else\n\n  // camunda:(in|out) variables local\n  if (binding.variables) {\n    properties.variables = 'all';\n\n    if (binding.variables === 'local') {\n      properties.local = true;\n    }\n  }\n\n  // camunda:out source(Expression) target\n  else {\n    properties.target = value;\n\n    [ 'source', 'sourceExpression' ].forEach(function(k) {\n      if (binding[k]) {\n        properties[k] = binding[k];\n      }\n    });\n  }\n\n  return properties;\n}\n","var baseIsNative = require('./_baseIsNative'),\n    getValue = require('./_getValue');\n\n/**\n * Gets the native function at `key` of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {string} key The key of the method to get.\n * @returns {*} Returns the function if it's native, else `undefined`.\n */\nfunction getNative(object, key) {\n  var value = getValue(object, key);\n  return baseIsNative(value) ? value : undefined;\n}\n\nmodule.exports = getNative;\n","var root = require('./_root'),\n    stubFalse = require('./stubFalse');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Built-in value references. */\nvar Buffer = moduleExports ? root.Buffer : undefined;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeIsBuffer = Buffer ? Buffer.isBuffer : undefined;\n\n/**\n * Checks if `value` is a buffer.\n *\n * @static\n * @memberOf _\n * @since 4.3.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a buffer, else `false`.\n * @example\n *\n * _.isBuffer(new Buffer(2));\n * // => true\n *\n * _.isBuffer(new Uint8Array(2));\n * // => false\n */\nvar isBuffer = nativeIsBuffer || stubFalse;\n\nmodule.exports = isBuffer;\n","var identity = require('./identity'),\n    overRest = require('./_overRest'),\n    setToString = require('./_setToString');\n\n/**\n * The base implementation of `_.rest` which doesn't validate or coerce arguments.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @returns {Function} Returns the new function.\n */\nfunction baseRest(func, start) {\n  return setToString(overRest(func, start, identity), func + '');\n}\n\nmodule.exports = baseRest;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper');\n\nvar forEach = require('lodash/forEach');\n\nvar message = require('./implementation/MessageEventDefinition'),\n    signal = require('./implementation/SignalEventDefinition'),\n    error = require('./implementation/ErrorEventDefinition'),\n    escalation = require('./implementation/EscalationEventDefinition'),\n    timer = require('./implementation/TimerEventDefinition'),\n    compensation = require('./implementation/CompensateEventDefinition'),\n    condition = require('./implementation/ConditionalEventDefinition');\n\n\nmodule.exports = function(group, element, bpmnFactory, elementRegistry, translate) {\n  var events = [\n    'bpmn:StartEvent',\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  // Message and Signal Event Definition\n  forEach(events, function(event) {\n    if (is(element, event)) {\n\n      var messageEventDefinition = eventDefinitionHelper.getMessageEventDefinition(element),\n          signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(element);\n\n      if (messageEventDefinition) {\n        message(group, element, bpmnFactory, messageEventDefinition, translate);\n      }\n\n      if (signalEventDefinition) {\n        signal(group, element, bpmnFactory, signalEventDefinition, translate);\n      }\n\n    }\n  });\n\n  // Special Case: Receive Task\n  if (is(element, 'bpmn:ReceiveTask')) {\n    message(group, element, bpmnFactory, getBusinessObject(element), translate);\n  }\n\n  // Error Event Definition\n  var errorEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(errorEvents, function(event) {\n    if (is(element, event)) {\n\n      var errorEventDefinition = eventDefinitionHelper.getErrorEventDefinition(element);\n\n      if (errorEventDefinition) {\n\n        error(group, element, bpmnFactory, errorEventDefinition, translate);\n      }\n    }\n  });\n\n  // Escalation Event Definition\n  var escalationEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(escalationEvents, function(event) {\n    if (is(element, event)) {\n\n      var showEscalationCodeVariable = is(element, 'bpmn:StartEvent') || is(element, 'bpmn:BoundaryEvent');\n\n      // get business object\n      var escalationEventDefinition = eventDefinitionHelper.getEscalationEventDefinition(element);\n\n      if (escalationEventDefinition) {\n        escalation(group, element, bpmnFactory, escalationEventDefinition, showEscalationCodeVariable,\n          translate);\n      }\n    }\n\n  });\n\n  // Timer Event Definition\n  var timerEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  forEach(timerEvents, function(event) {\n    if (is(element, event)) {\n\n      // get business object\n      var timerEventDefinition = eventDefinitionHelper.getTimerEventDefinition(element);\n\n      if (timerEventDefinition) {\n        timer(group, element, bpmnFactory, timerEventDefinition, translate);\n      }\n    }\n  });\n\n  // Compensate Event Definition\n  var compensationEvents = [\n    'bpmn:EndEvent',\n    'bpmn:IntermediateThrowEvent'\n  ];\n\n  forEach(compensationEvents, function(event) {\n    if (is(element, event)) {\n\n      // get business object\n      var compensateEventDefinition = eventDefinitionHelper.getCompensateEventDefinition(element);\n\n      if (compensateEventDefinition) {\n        compensation(group, element, bpmnFactory, compensateEventDefinition, elementRegistry, translate);\n      }\n    }\n  });\n\n\n  // Conditional Event Definition\n  var conditionalEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:IntermediateCatchEvent'\n  ];\n\n  if (isAny(element, conditionalEvents)) {\n\n    // get business object\n    var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n    if (conditionalEventDefinition) {\n      condition(group, element, bpmnFactory, conditionalEventDefinition, elementRegistry, translate);\n    }\n  }\n\n};\n","var realNames = require('./_realNames');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the name of `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {string} Returns the function name.\n */\nfunction getFuncName(func) {\n  var result = (func.name + ''),\n      array = realNames[result],\n      length = hasOwnProperty.call(realNames, result) ? array.length : 0;\n\n  while (length--) {\n    var data = array[length],\n        otherFunc = data.func;\n    if (otherFunc == null || otherFunc == func) {\n      return data.name;\n    }\n  }\n  return result;\n}\n\nmodule.exports = getFuncName;\n","'use strict';\n\nvar ElementHelper = {};\nmodule.exports = ElementHelper;\n\n/**\n * Creates a new element and set the parent to it\n *\n * @method ElementHelper#createElement\n *\n * @param {String} elementType of the new element\n * @param {Object} properties of the new element in key-value pairs\n * @param {moddle.object} parent of the new element\n * @param {BpmnFactory} factory which creates the new element\n *\n * @returns {djs.model.Base} element which is created\n */\nElementHelper.createElement = function(elementType, properties, parent, factory) {\n  var element = factory.create(elementType, properties);\n  element.$parent = parent;\n\n  return element;\n};\n","/**\n * A rule that checks that sequence flows outgoing from a\n * conditional forking gateway or activity are\n * either default flows _or_ have a condition attached\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isConditionalForking(node)) {\n      return;\n    }\n\n    const outgoing = node.outgoing || [];\n\n    outgoing.forEach((flow) => {\n      const missingCondition = (\n        !hasCondition(flow) &&\n        !isDefaultFlow(node, flow)\n      );\n\n      if (missingCondition) {\n        reporter.report(flow.id, 'Sequence flow is missing condition');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////////////////\n\nfunction isConditionalForking(node) {\n\n  const defaultFlow = node['default'];\n  const outgoing = node.outgoing || [];\n\n  return defaultFlow || outgoing.find(hasCondition);\n}\n\nfunction hasCondition(flow) {\n  return !!flow.conditionExpression;\n}\n\nfunction isDefaultFlow(node, flow) {\n  return node['default'] === flow;\n}","var baseCreate = require('./_baseCreate'),\n    isObject = require('./isObject');\n\n/**\n * Creates a function that produces an instance of `Ctor` regardless of\n * whether it was invoked as part of a `new` expression or by `call` or `apply`.\n *\n * @private\n * @param {Function} Ctor The constructor to wrap.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCtor(Ctor) {\n  return function() {\n    // Use a `switch` statement to work with class constructors. See\n    // http://ecma-international.org/ecma-262/7.0/#sec-ecmascript-function-objects-call-thisargument-argumentslist\n    // for more details.\n    var args = arguments;\n    switch (args.length) {\n      case 0: return new Ctor;\n      case 1: return new Ctor(args[0]);\n      case 2: return new Ctor(args[0], args[1]);\n      case 3: return new Ctor(args[0], args[1], args[2]);\n      case 4: return new Ctor(args[0], args[1], args[2], args[3]);\n      case 5: return new Ctor(args[0], args[1], args[2], args[3], args[4]);\n      case 6: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5]);\n      case 7: return new Ctor(args[0], args[1], args[2], args[3], args[4], args[5], args[6]);\n    }\n    var thisBinding = baseCreate(Ctor.prototype),\n        result = Ctor.apply(thisBinding, args);\n\n    // Mimic the constructor's `return` behavior.\n    // See https://es5.github.io/#x13.2.2 for more details.\n    return isObject(result) ? result : thisBinding;\n  };\n}\n\nmodule.exports = createCtor;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar historyTimeToLive = require('./implementation/HistoryTimeToLive');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:Process') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(historyTimeToLive(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n\n  }\n};\n","/**\n * Checks if `value` is suitable for use as unique object key.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is suitable, else `false`.\n */\nfunction isKeyable(value) {\n  var type = typeof value;\n  return (type == 'string' || type == 'number' || type == 'symbol' || type == 'boolean')\n    ? (value !== '__proto__')\n    : (value === null);\n}\n\nmodule.exports = isKeyable;\n","var identity = require('./identity');\n\n/**\n * Casts `value` to `identity` if it's not a function.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {Function} Returns cast function.\n */\nfunction castFunction(value) {\n  return typeof value == 'function' ? value : identity;\n}\n\nmodule.exports = castFunction;\n","/**\n * Checks if `value` is object-like. A value is object-like if it's not `null`\n * and has a `typeof` result of \"object\".\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is object-like, else `false`.\n * @example\n *\n * _.isObjectLike({});\n * // => true\n *\n * _.isObjectLike([1, 2, 3]);\n * // => true\n *\n * _.isObjectLike(_.noop);\n * // => false\n *\n * _.isObjectLike(null);\n * // => false\n */\nfunction isObjectLike(value) {\n  return value != null && typeof value == 'object';\n}\n\nmodule.exports = isObjectLike;\n","var coreJsData = require('./_coreJsData');\n\n/** Used to detect methods masquerading as native. */\nvar maskSrcKey = (function() {\n  var uid = /[^.]+$/.exec(coreJsData && coreJsData.keys && coreJsData.keys.IE_PROTO || '');\n  return uid ? ('Symbol(src)_1.' + uid) : '';\n}());\n\n/**\n * Checks if `func` has its source masked.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` is masked, else `false`.\n */\nfunction isMasked(func) {\n  return !!maskSrcKey && (maskSrcKey in func);\n}\n\nmodule.exports = isMasked;\n","var baseKeys = require('./_baseKeys'),\n    getTag = require('./_getTag'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isArrayLike = require('./isArrayLike'),\n    isBuffer = require('./isBuffer'),\n    isPrototype = require('./_isPrototype'),\n    isTypedArray = require('./isTypedArray');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    setTag = '[object Set]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if `value` is an empty object, collection, map, or set.\n *\n * Objects are considered empty if they have no own enumerable string keyed\n * properties.\n *\n * Array-like values such as `arguments` objects, arrays, buffers, strings, or\n * jQuery-like collections are considered empty if they have a `length` of `0`.\n * Similarly, maps and sets are considered empty if they have a `size` of `0`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is empty, else `false`.\n * @example\n *\n * _.isEmpty(null);\n * // => true\n *\n * _.isEmpty(true);\n * // => true\n *\n * _.isEmpty(1);\n * // => true\n *\n * _.isEmpty([1, 2, 3]);\n * // => false\n *\n * _.isEmpty({ 'a': 1 });\n * // => false\n */\nfunction isEmpty(value) {\n  if (value == null) {\n    return true;\n  }\n  if (isArrayLike(value) &&\n      (isArray(value) || typeof value == 'string' || typeof value.splice == 'function' ||\n        isBuffer(value) || isTypedArray(value) || isArguments(value))) {\n    return !value.length;\n  }\n  var tag = getTag(value);\n  if (tag == mapTag || tag == setTag) {\n    return !value.size;\n  }\n  if (isPrototype(value)) {\n    return !baseKeys(value).length;\n  }\n  for (var key in value) {\n    if (hasOwnProperty.call(value, key)) {\n      return false;\n    }\n  }\n  return true;\n}\n\nmodule.exports = isEmpty;\n","import {\n  some\n} from 'min-dash';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * Return true if element has any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nexport function isAny(element, types) {\n  return some(types, function(t) {\n    return is(element, t);\n  });\n}\n\n\n/**\n * Return the parent of the element with any of the given types.\n *\n * @param {djs.model.Base} element\n * @param {String|Array<String>} anyType\n *\n * @return {djs.model.Base}\n */\nexport function getParent(element, anyType) {\n\n  if (typeof anyType === 'string') {\n    anyType = [ anyType ];\n  }\n\n  while ((element = element.parent)) {\n    if (isAny(element, anyType)) {\n      return element;\n    }\n  }\n\n  return null;\n}","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var candidateStarterGroupsEntry = entryFactory.textField({\n    id: 'candidateStarterGroups',\n    label: translate('Candidate Starter Groups'),\n    modelProperty: 'candidateStarterGroups',\n    description: translate('Specify more than one group as a comma separated list.'),\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var candidateStarterGroups = bo.get('camunda:candidateStarterGroups');\n\n      return {\n        candidateStarterGroups: candidateStarterGroups ? candidateStarterGroups : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:candidateStarterGroups': values.candidateStarterGroups || undefined\n      });\n    }\n\n  });\n\n  var candidateStarterUsersEntry = entryFactory.textField({\n    id: 'candidateStarterUsers',\n    label: translate('Candidate Starter Users'),\n    modelProperty: 'candidateStarterUsers',\n    description: translate('Specify more than one user as a comma separated list.'),\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var candidateStarterUsers = bo.get('camunda:candidateStarterUsers');\n\n      return {\n        candidateStarterUsers: candidateStarterUsers ? candidateStarterUsers : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:candidateStarterUsers': values.candidateStarterUsers || undefined\n      });\n    }\n\n  });\n\n  return [\n    candidateStarterGroupsEntry,\n    candidateStarterUsersEntry\n  ];\n};\n","var baseIsEqual = require('./_baseIsEqual'),\n    get = require('./get'),\n    hasIn = require('./hasIn'),\n    isKey = require('./_isKey'),\n    isStrictComparable = require('./_isStrictComparable'),\n    matchesStrictComparable = require('./_matchesStrictComparable'),\n    toKey = require('./_toKey');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.matchesProperty` which doesn't clone `srcValue`.\n *\n * @private\n * @param {string} path The path of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatchesProperty(path, srcValue) {\n  if (isKey(path) && isStrictComparable(srcValue)) {\n    return matchesStrictComparable(toKey(path), srcValue);\n  }\n  return function(object) {\n    var objValue = get(object, path);\n    return (objValue === undefined && objValue === srcValue)\n      ? hasIn(object, path)\n      : baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG);\n  };\n}\n\nmodule.exports = baseMatchesProperty;\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\nvar bind = require('lodash/bind');\n\n/**\n * An entry that renders a clickable link.\n *\n * A passed {@link options#handleClick} handler is responsible\n * to process the click.\n *\n * The link may be conditionally shown or hidden. This can be\n * controlled via the {@link options.showLink}.\n *\n * @param {Object} options\n * @param {String} options.id\n * @param {String} [options.label]\n * @param {Function} options.handleClick\n * @param {Function} [options.showLink] returning false to hide link\n * @param {String} [options.description]\n *\n * @example\n *\n * var linkEntry = link({\n *   id: 'foo',\n *   description: 'Some Description',\n *   handleClick: function(element, node, event) { ... },\n *   showLink: function(element, node) { ... }\n * });\n *\n * @return {Entry} the newly created entry\n */\nfunction link(options) {\n\n  var id = options.id,\n      label = options.label || id,\n      showLink = options.showLink,\n      handleClick = options.handleClick,\n      description = options.description;\n\n  if (showLink && typeof showLink !== 'function') {\n    throw new Error('options.showLink must be a function');\n  }\n\n  if (typeof handleClick !== 'function') {\n    throw new Error('options.handleClick must be a function');\n  }\n\n  var resource = {\n    id: id\n  };\n\n  resource.html =\n    '<a data-action=\"handleClick\" ' +\n    (showLink ? 'data-show=\"showLink\" ' : '') +\n    'class=\"bpp-entry-link' + (options.cssClasses ? ' ' + escapeHTML(options.cssClasses) : '') +\n    '\">' + escapeHTML(label) + '</a>';\n\n  // add description below link entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.handleClick = bind(handleClick, resource);\n\n  if (typeof showLink === 'function') {\n    resource.showLink = function() {\n      return showLink.apply(resource, arguments);\n    };\n  }\n\n  return resource;\n}\n\nmodule.exports = link;\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    entryFactory = require('../../../../factory/EntryFactory'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper');\n\n\nvar resultVariable = require('./ResultVariable');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar forEach = require('lodash/forEach');\n\nvar attributeInfo = {\n  bpmn: {\n    element: 'calledElement',\n    binding: 'camunda:calledElementBinding',\n    version: 'camunda:calledElementVersion',\n    versionTag: 'camunda:calledElementVersionTag',\n    tenantId: 'camunda:calledElementTenantId'\n  },\n\n  cmmn: {\n    element: 'camunda:caseRef',\n    binding: 'camunda:caseBinding',\n    version: 'camunda:caseVersion',\n    tenantId: 'camunda:caseTenantId'\n  },\n\n  dmn: {\n    element: 'camunda:decisionRef',\n    binding: 'camunda:decisionRefBinding',\n    version: 'camunda:decisionRefVersion',\n    versionTag: 'camunda:decisionRefVersionTag',\n    tenantId: 'camunda:decisionRefTenantId'\n  }\n};\n\nvar mapDecisionResultOptions = [\n  {\n    name: 'singleEntry (TypedValue)',\n    value: 'singleEntry'\n  },\n  {\n    name:'singleResult (Map<String, Object>)',\n    value:'singleResult'\n  },\n  {\n    name:'collectEntries (List<Object>)',\n    value:'collectEntries'\n  },\n  {\n    name:'resultList (List<Map<String, Object>>)',\n    value:'resultList'\n  }\n];\n\nvar delegateVariableMappingOptions = [\n  {\n    name: 'variableMappingClass',\n    value: 'variableMappingClass'\n  },\n  {\n    name: 'variableMappingDelegateExpression',\n    value: 'variableMappingDelegateExpression'\n  }\n];\n\nfunction getCamundaInWithBusinessKey(element) {\n  var camundaIn = [],\n      bo = getBusinessObject(element);\n\n  var camundaInParams = extensionElementsHelper.getExtensionElements(bo, 'camunda:In');\n  if (camundaInParams) {\n    forEach(camundaInParams, function(param) {\n      if (param.businessKey !== undefined) {\n        camundaIn.push(param);\n      }\n    });\n  }\n  return camundaIn;\n}\n\nfunction setBusinessKey(element, text, bpmnFactory) {\n  var commands = [];\n\n  var camundaInWithBusinessKey = getCamundaInWithBusinessKey(element);\n\n  if (camundaInWithBusinessKey.length) {\n    commands.push(cmdHelper.updateBusinessObject(element, camundaInWithBusinessKey[0], {\n      businessKey: text\n    }));\n  } else {\n    var bo = getBusinessObject(element),\n        extensionElements = bo.extensionElements;\n\n    if (!extensionElements) {\n      extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n      commands.push(cmdHelper.updateProperties(element, { extensionElements: extensionElements }));\n    }\n\n    var camundaIn = elementHelper.createElement(\n      'camunda:In',\n      { 'businessKey': text },\n      extensionElements,\n      bpmnFactory\n    );\n\n    commands.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      'extensionElements',\n      [ camundaIn ],[]\n    ));\n  }\n\n  return commands;\n}\n\nfunction deleteBusinessKey(element) {\n  var camundaInExtensions = getCamundaInWithBusinessKey(element);\n  var commands = [];\n  forEach(camundaInExtensions, function(elem) {\n    commands.push(extensionElementsHelper.removeEntry(getBusinessObject(element), element, elem));\n  });\n  return commands;\n}\n\nfunction isSupportedCallableType(type) {\n  return [ 'bpmn', 'cmmn', 'dmn' ].indexOf(type) !== -1;\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var bindingOptions = [\n    {\n      name: translate('latest'),\n      value: 'latest'\n    },\n    {\n      name: translate('deployment'),\n      value: 'deployment'\n    },\n    {\n      name: translate('version'),\n      value: 'version'\n    },\n    {\n      name: translate('versionTag'),\n      value: 'versionTag'\n    }\n  ];\n\n  var getCallableType = options.getCallableType;\n\n  var entries = [];\n\n  function getAttribute(element, prop) {\n    var type = getCallableType(element);\n    return (attributeInfo[type] || {})[prop];\n  }\n\n  function getCallActivityBindingValue(element) {\n    var type = getCallableType(element);\n    var bo = getBusinessObject(element);\n    var attr = (attributeInfo[type] || {}).binding;\n    return bo.get(attr);\n  }\n\n  function getDelegateVariableMappingType(element) {\n    var bo = getBusinessObject(element);\n\n    var boVariableMappingClass = bo.get('camunda:variableMappingClass'),\n        boVariableMappingDelegateExpression = bo.get('camunda:variableMappingDelegateExpression');\n\n    var delegateVariableMappingType = '';\n    if (typeof boVariableMappingClass !== 'undefined') {\n      delegateVariableMappingType = 'variableMappingClass';\n    } else\n\n    if (typeof boVariableMappingDelegateExpression !== 'undefined') {\n      delegateVariableMappingType = 'variableMappingDelegateExpression';\n    }\n\n    return delegateVariableMappingType;\n  }\n\n\n  entries.push(entryFactory.textField({\n    id: 'callable-element-ref',\n    dataValueLabel: 'callableElementLabel',\n    modelProperty: 'callableElementRef',\n\n    get: function(element, node) {\n      var callableElementRef;\n\n      var attr = getAttribute(element, 'element');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableElementRef = bo.get(attr);\n      }\n\n      var label = '';\n      var type = getCallableType(element);\n      if (type === 'bpmn') {\n        label = translate('Called Element');\n      }\n      else if (type === 'cmmn') {\n        label = translate('Case Ref');\n      }\n      else if (type === 'dmn') {\n        label = translate('Decision Ref');\n      }\n\n      return {\n        callableElementRef: callableElementRef,\n        callableElementLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCallableElementRef = values.callableElementRef;\n      var attr = getAttribute(element, 'element');\n\n      var props = {};\n      props[attr] = newCallableElementRef || '';\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var elementRef = values.callableElementRef;\n      var type = getCallableType(element);\n      return isSupportedCallableType(type) && !elementRef ? { callableElementRef: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isSupportedCallableType(getCallableType(element));\n    }\n\n  }));\n\n  entries.push(entryFactory.selectBox({\n    id: 'callable-binding',\n    label: translate('Binding'),\n    selectOptions: function(element) {\n      var type = getCallableType(element);\n      var options;\n\n      if (type === 'cmmn') {\n        options = bindingOptions.filter(function(bindingOption) {\n          return bindingOption.value !== 'versionTag';\n        });\n      } else {\n        options = bindingOptions;\n      }\n      return options;\n    },\n    modelProperty: 'callableBinding',\n\n    get: function(element, node) {\n      var callableBinding;\n\n      var attr = getAttribute(element, 'binding');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableBinding = bo.get(attr) || 'latest';\n      }\n\n      return {\n        callableBinding: callableBinding\n      };\n    },\n\n    set: function(element, values, node) {\n      var binding = values.callableBinding;\n      var attr = getAttribute(element, 'binding'),\n          attrVer = getAttribute(element, 'version'),\n          attrVerTag = getAttribute(element, 'versionTag');\n\n      var props = {};\n      props[attr] = binding;\n\n      // set version and versionTag values always to undefined to delete the existing value\n      props[attrVer] = undefined;\n      props[attrVerTag] = undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      return !isSupportedCallableType(getCallableType(element));\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'callable-version',\n    label: translate('Version'),\n    modelProperty: 'callableVersion',\n\n    get: function(element, node) {\n      var callableVersion;\n\n      var attr = getAttribute(element, 'version');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        callableVersion = bo.get(attr);\n      }\n\n      return {\n        callableVersion: callableVersion\n      };\n    },\n\n    set: function(element, values, node) {\n      var version = values.callableVersion;\n      var attr = getAttribute(element, 'version');\n\n      var props = {};\n      props[attr] = version || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var version = values.callableVersion;\n\n      var type = getCallableType(element);\n      return (\n        isSupportedCallableType(type) &&\n        getCallActivityBindingValue(element) === 'version' && (\n          !version ? { callableVersion: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n      return !isSupportedCallableType(type) || getCallActivityBindingValue(element) !== 'version';\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'callable-version-tag',\n    label: translate('Version Tag'),\n    modelProperty: 'versionTag',\n\n    get: function(element, node) {\n      var versionTag;\n\n      var attr = getAttribute(element, 'versionTag');\n\n      if (attr) {\n        var bo = getBusinessObject(element);\n\n        versionTag = bo.get(attr);\n      }\n\n      return {\n        versionTag: versionTag\n      };\n    },\n\n    set: function(element, values, node) {\n      var versionTag = values.versionTag;\n\n      var attr = getAttribute(element, 'versionTag');\n\n      var props = {};\n\n      props[attr] = versionTag || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var versionTag = values.versionTag;\n\n      var type = getCallableType(element);\n\n      return (\n        isSupportedCallableType(type) &&\n        getCallActivityBindingValue(element) === 'versionTag' && (\n          !versionTag ? { versionTag: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n\n      return !isSupportedCallableType(type) || getCallActivityBindingValue(element) !== 'versionTag';\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'tenant-id',\n    label: translate('Tenant Id'),\n    modelProperty: 'tenantId',\n\n    get: function(element, node) {\n      var tenantId;\n\n      var attr = getAttribute(element, 'tenantId');\n      if (attr) {\n        var bo = getBusinessObject(element);\n        tenantId = bo.get(attr);\n      }\n\n      return {\n        tenantId: tenantId\n      };\n    },\n\n    set: function(element, values, node) {\n      var tenantId = values.tenantId;\n      var attr = getAttribute(element, 'tenantId');\n\n      var props = {};\n      props[attr] = tenantId || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      var type = getCallableType(element);\n      return !isSupportedCallableType(type);\n    }\n\n  }));\n\n  if (is(getBusinessObject(element), 'bpmn:CallActivity')) {\n    entries.push(entryFactory.checkbox({\n      id: 'callable-business-key',\n      label: translate('Business Key'),\n      modelProperty: 'callableBusinessKey',\n\n      get: function(element, node) {\n        var camundaIn = getCamundaInWithBusinessKey(element);\n\n        return {\n          callableBusinessKey: !!(camundaIn && camundaIn.length > 0)\n        };\n      },\n\n      set: function(element, values, node) {\n        if (values.callableBusinessKey) {\n          return setBusinessKey(element, '#{execution.processBusinessKey}', bpmnFactory);\n        } else {\n          return deleteBusinessKey(element);\n        }\n      }\n    }));\n  }\n\n  entries.push(entryFactory.textField({\n    id: 'business-key-expression',\n    label: translate('Business Key Expression'),\n    modelProperty: 'businessKey',\n\n    get: function(element, node) {\n      var camundaInWithBusinessKey = getCamundaInWithBusinessKey(element);\n\n      return {\n        businessKey: (\n          camundaInWithBusinessKey.length ?\n            camundaInWithBusinessKey[0].get('camunda:businessKey') :\n            undefined\n        )\n      };\n    },\n\n    set: function(element, values, node) {\n      var businessKey = values.businessKey;\n\n      return setBusinessKey(element, businessKey, bpmnFactory);\n    },\n\n    validate: function(element, values, node) {\n      var businessKey = values.businessKey;\n\n      return businessKey === '' ? { businessKey: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !getCamundaInWithBusinessKey(element).length;\n    }\n\n  }));\n\n  entries = entries.concat(resultVariable(element, bpmnFactory, {\n    id: 'dmn-resultVariable',\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getCallableType,\n    hideResultVariable: function(element, node) {\n      return getCallableType(element) !== 'dmn';\n    }\n  }, translate));\n\n  entries.push(entryFactory.selectBox({\n    id: 'dmn-map-decision-result',\n    label: translate('Map Decision Result'),\n    selectOptions: mapDecisionResultOptions,\n    modelProperty: 'mapDecisionResult',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        mapDecisionResult: bo.get('camunda:mapDecisionResult') || 'resultList'\n      };\n    },\n\n    set: function(element, values, node) {\n      return cmdHelper.updateProperties(element, {\n        'camunda:mapDecisionResult': values.mapDecisionResult || 'resultList'\n      });\n    },\n\n    hidden: function(element, node) {\n      var bo = getBusinessObject(element);\n      var resultVariable = bo.get('camunda:resultVariable');\n      return !(getCallableType(element) === 'dmn' && typeof resultVariable !== 'undefined');\n    }\n\n  }));\n\n\n  entries.push(entryFactory.selectBox({\n    id: 'delegateVariableMappingType',\n    label: translate('Delegate Variable Mapping'),\n    selectOptions: delegateVariableMappingOptions,\n    emptyParameter: true,\n    modelProperty: 'delegateVariableMappingType',\n\n    get: function(element, node) {\n      return {\n        delegateVariableMappingType : getDelegateVariableMappingType(element)\n      };\n    },\n\n    set: function(element, values, node) {\n      var delegateVariableMappingType = values.delegateVariableMappingType;\n\n      var props = {\n        'camunda:variableMappingClass' : undefined,\n        'camunda:variableMappingDelegateExpression' : undefined\n      };\n\n      if (delegateVariableMappingType === 'variableMappingClass') {\n        props['camunda:variableMappingClass'] = '';\n      }\n      else if (delegateVariableMappingType === 'variableMappingDelegateExpression') {\n        props['camunda:variableMappingDelegateExpression'] = '';\n      }\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    hidden: function(element, node) {\n      return (getCallableType(element) !== 'bpmn');\n    }\n\n  }));\n\n  entries.push(entryFactory.textField({\n    id: 'delegateVariableMapping',\n    dataValueLabel: 'delegateVariableMappingLabel',\n    modelProperty: 'delegateVariableMapping',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n\n      var label = '';\n      var delegateVariableMapping = undefined;\n      var type = getDelegateVariableMappingType(element);\n\n      if (type === 'variableMappingClass') {\n        label = translate('Class');\n        delegateVariableMapping = bo.get('camunda:variableMappingClass');\n      }\n      else if (type === 'variableMappingDelegateExpression') {\n        label = translate('Delegate Expression');\n        delegateVariableMapping = bo.get('camunda:variableMappingDelegateExpression');\n      }\n\n      return {\n        delegateVariableMapping: delegateVariableMapping,\n        delegateVariableMappingLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var delegateVariableMapping = values.delegateVariableMapping;\n\n      var attr = 'camunda:' + getDelegateVariableMappingType(element);\n\n      var props = {};\n      props[attr] = delegateVariableMapping || undefined;\n\n      return cmdHelper.updateProperties(element, props);\n    },\n\n    validate: function(element, values, node) {\n      var delegateVariableMapping = values.delegateVariableMapping;\n      return (\n        getCallableType(element) === 'bpmn' && (\n          !delegateVariableMapping ? { delegateVariableMapping: translate('Must provide a value') } : {}\n        )\n      );\n    },\n\n    hidden: function(element, node) {\n      return !(getCallableType(element) === 'bpmn' && getDelegateVariableMappingType(element) !== '');\n    }\n\n  }));\n\n  return entries;\n};\n","var memoizeCapped = require('./_memoizeCapped');\n\n/** Used to match property names within property paths. */\nvar rePropName = /[^.[\\]]+|\\[(?:(-?\\d+(?:\\.\\d+)?)|([\"'])((?:(?!\\2)[^\\\\]|\\\\.)*?)\\2)\\]|(?=(?:\\.|\\[\\])(?:\\.|\\[\\]|$))/g;\n\n/** Used to match backslashes in property paths. */\nvar reEscapeChar = /\\\\(\\\\)?/g;\n\n/**\n * Converts `string` to a property path array.\n *\n * @private\n * @param {string} string The string to convert.\n * @returns {Array} Returns the property path array.\n */\nvar stringToPath = memoizeCapped(function(string) {\n  var result = [];\n  if (string.charCodeAt(0) === 46 /* . */) {\n    result.push('');\n  }\n  string.replace(rePropName, function(match, number, quote, subString) {\n    result.push(quote ? subString.replace(reEscapeChar, '$1') : (number || match));\n  });\n  return result;\n});\n\nmodule.exports = stringToPath;\n","/**\n * Checks if `value` is the\n * [language type](http://www.ecma-international.org/ecma-262/7.0/#sec-ecmascript-language-types)\n * of `Object`. (e.g. arrays, functions, objects, regexes, `new Number(0)`, and `new String('')`)\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an object, else `false`.\n * @example\n *\n * _.isObject({});\n * // => true\n *\n * _.isObject([1, 2, 3]);\n * // => true\n *\n * _.isObject(_.noop);\n * // => true\n *\n * _.isObject(null);\n * // => false\n */\nfunction isObject(value) {\n  var type = typeof value;\n  return value != null && (type == 'object' || type == 'function');\n}\n\nmodule.exports = isObject;\n","import axios from 'axios'\r\n\r\nexport function request(config) {\r\n  //1.创建实例\r\n  const instance = axios.create({\r\n    baseURL: \"http://localhost:5000\" ,\r\n    //http://backend-py:8000/\r\n    //baseURL: \"http://backend-java:8090\",\r\n    //baseURL: \"http://lxc-backend-java.ingress.isa.buaanlsde.cn\",\r\n    //timeout: 5000\r\n  })\r\n\r\n  //2.发送真正的网络请求\r\n  return instance(config)\r\n\r\n}\r\n\r\nexport function requestForChatbot(config){\r\n  const instance = axios.create({\r\n    baseURL: \"http://localhost:5001\" ,\r\n    //http://backend-py:8000/\r\n    //baseURL: \"http://backend-java:8090\",\r\n    //baseURL: \"http://lxc-backend-java.ingress.isa.buaanlsde.cn\",\r\n    //timeout: 5000\r\n  })\r\n\r\n  //2.发送真正的网络请求\r\n  return instance(config)\r\n}\r\n","var Symbol = require('./_Symbol'),\n    Uint8Array = require('./_Uint8Array'),\n    eq = require('./eq'),\n    equalArrays = require('./_equalArrays'),\n    mapToArray = require('./_mapToArray'),\n    setToArray = require('./_setToArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/** `Object#toString` result references. */\nvar boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    symbolTag = '[object Symbol]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]';\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolValueOf = symbolProto ? symbolProto.valueOf : undefined;\n\n/**\n * A specialized version of `baseIsEqualDeep` for comparing objects of\n * the same `toStringTag`.\n *\n * **Note:** This function only supports comparing values with tags of\n * `Boolean`, `Date`, `Error`, `Number`, `RegExp`, or `String`.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {string} tag The `toStringTag` of the objects to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalByTag(object, other, tag, bitmask, customizer, equalFunc, stack) {\n  switch (tag) {\n    case dataViewTag:\n      if ((object.byteLength != other.byteLength) ||\n          (object.byteOffset != other.byteOffset)) {\n        return false;\n      }\n      object = object.buffer;\n      other = other.buffer;\n\n    case arrayBufferTag:\n      if ((object.byteLength != other.byteLength) ||\n          !equalFunc(new Uint8Array(object), new Uint8Array(other))) {\n        return false;\n      }\n      return true;\n\n    case boolTag:\n    case dateTag:\n    case numberTag:\n      // Coerce booleans to `1` or `0` and dates to milliseconds.\n      // Invalid dates are coerced to `NaN`.\n      return eq(+object, +other);\n\n    case errorTag:\n      return object.name == other.name && object.message == other.message;\n\n    case regexpTag:\n    case stringTag:\n      // Coerce regexes to strings and treat strings, primitives and objects,\n      // as equal. See http://www.ecma-international.org/ecma-262/7.0/#sec-regexp.prototype.tostring\n      // for more details.\n      return object == (other + '');\n\n    case mapTag:\n      var convert = mapToArray;\n\n    case setTag:\n      var isPartial = bitmask & COMPARE_PARTIAL_FLAG;\n      convert || (convert = setToArray);\n\n      if (object.size != other.size && !isPartial) {\n        return false;\n      }\n      // Assume cyclic values are equal.\n      var stacked = stack.get(object);\n      if (stacked) {\n        return stacked == other;\n      }\n      bitmask |= COMPARE_UNORDERED_FLAG;\n\n      // Recursively compare objects (susceptible to call stack limits).\n      stack.set(object, other);\n      var result = equalArrays(convert(object), convert(other), bitmask, customizer, equalFunc, stack);\n      stack['delete'](object);\n      return result;\n\n    case symbolTag:\n      if (symbolValueOf) {\n        return symbolValueOf.call(object) == symbolValueOf.call(other);\n      }\n  }\n  return false;\n}\n\nmodule.exports = equalByTag;\n","module.exports = require('./lib');\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Promise = getNative(root, 'Promise');\n\nmodule.exports = Promise;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar elementHelper = require('../helper/ElementHelper');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction CreateBusinessObjectListHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nCreateBusinessObjectListHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = CreateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + ' required');\n  }\n  return prop;\n\n}\nfunction ensureList(prop, name) {\n  if (!prop || Object.prototype.toString.call(prop) !== '[object Array]') {\n    throw new Error(name + ' needs to be a list');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Creates a new element under a provided parent and updates / creates a reference to it in\n * one atomic action.\n *\n * @method  CreateBusinessObjectListHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element which is the context for the reference\n * @param {moddle.referencingObject} context.referencingObject the object which creates the reference\n * @param {String} context.referenceProperty the property of the referencingObject which makes the reference\n * @param {moddle.newObject} context.newObject the new object to add\n * @param {moddle.newObjectContainer} context.newObjectContainer the container for the new object\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nCreateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      newObjects = ensureList(context.newObjects, 'newObjects'),\n      changed = [ context.element ]; // this will not change any diagram-js elements\n\n\n  var childObjects = [];\n  var self = this;\n\n  // create new array of business objects\n  forEach(newObjects, function(obj) {\n    var element = elementHelper.createElement(obj.type, obj.properties, currentObject, self._bpmnFactory);\n\n    childObjects.push(element);\n  });\n  context.childObject = childObjects;\n\n  // adjust array reference in the parent business object\n  context.previousChilds = currentObject[propertyName];\n  currentObject[propertyName] = childObjects;\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nCreateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousChilds = context.previousChilds;\n\n  // remove new element\n  currentObject.set(propertyName, previousChilds);\n\n  return context.changed;\n};\n","'use strict';\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Get the timer definition type for a given timer event definition.\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>} timer\n *\n * @return {string|undefined} the timer definition type\n */\nfunction getTimerDefinitionType(timer) {\n\n  if (!timer) {\n    return;\n  }\n\n  var timeDate = timer.get('timeDate');\n  if (typeof timeDate !== 'undefined') {\n    return 'timeDate';\n  }\n\n  var timeCycle = timer.get('timeCycle');\n  if (typeof timeCycle !== 'undefined') {\n    return 'timeCycle';\n  }\n\n  var timeDuration = timer.get('timeDuration');\n  if (typeof timeDuration !== 'undefined') {\n    return 'timeDuration';\n  }\n}\n\n/**\n * Get the actual timer event definition based on option, whether it's a getter\n * to fetch the timer event definition or the exact event definition itself\n *\n * @param {ModdleElement<bpmn:TimerEventDefinition>|Function} timerOrFunction\n * @param {Shape} element\n * @param {HTMLElement} node\n *\n * @return ModdleElement<bpmn:TimerEventDefinition>\n */\nfunction getTimerDefinition(timerOrFunction, element, node) {\n  if (typeof timerOrFunction === 'function') {\n    return timerOrFunction(element, node);\n  }\n\n  return timerOrFunction;\n}\n\n/**\n * Creates 'bpmn:FormalExpression' element.\n *\n * @param {ModdleElement} parent\n * @param {string} body\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement<bpmn:FormalExpression>} a formal expression\n */\nfunction createFormalExpression(parent, body, bpmnFactory) {\n  body = body || undefined;\n  return elementHelper.createElement('bpmn:FormalExpression', { body: body }, parent, bpmnFactory);\n}\n\nfunction TimerEventDefinition(group, element, bpmnFactory, timerEventDefinition, translate, options) {\n\n  var selectOptions = [\n    { value: 'timeDate', name: translate('Date') },\n    { value: 'timeDuration', name: translate('Duration') },\n    { value: 'timeCycle', name: translate('Cycle') }\n  ];\n\n  var prefix = options && options.idPrefix,\n      createTimerEventDefinition = options && options.createTimerEventDefinition;\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: prefix + 'timer-event-definition-type',\n    label: translate('Timer Definition Type'),\n    selectOptions: selectOptions,\n    emptyParameter: true,\n    modelProperty: 'timerDefinitionType',\n\n    get: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node);\n\n      return {\n        timerDefinitionType: getTimerDefinitionType(timerDefinition) || ''\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = {\n        timeDuration: undefined,\n        timeDate: undefined,\n        timeCycle: undefined\n      };\n\n\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          newType = values.timerDefinitionType;\n\n      if (!timerDefinition && typeof createTimerEventDefinition === 'function') {\n        timerDefinition = createTimerEventDefinition(element, node);\n      }\n\n      if (values.timerDefinitionType) {\n        var oldType = getTimerDefinitionType(timerDefinition);\n\n        var value;\n        if (oldType) {\n          var definition = timerDefinition.get(oldType);\n          value = definition.get('body');\n        }\n\n        props[newType] = createFormalExpression(timerDefinition, value, bpmnFactory);\n      }\n\n      return cmdHelper.updateBusinessObject(element, timerDefinition, props);\n    },\n\n    hidden: function(element, node) {\n      return getTimerDefinition(timerEventDefinition, element, node) === undefined;\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: prefix + 'timer-event-definition',\n    label: translate('Timer Definition'),\n    modelProperty: 'timerDefinition',\n\n    get: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type),\n          value = definition && definition.get('body');\n\n      return {\n        timerDefinition: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type);\n\n      if (definition) {\n        return cmdHelper.updateBusinessObject(element, definition, {\n          body: values.timerDefinition || undefined\n        });\n      }\n    },\n\n    validate: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node),\n          type = getTimerDefinitionType(timerDefinition),\n          definition = type && timerDefinition.get(type);\n\n      if (definition) {\n        var value = definition.get('body');\n        if (!value) {\n          return {\n            timerDefinition: translate('Must provide a value')\n          };\n        }\n      }\n    },\n\n    hidden: function(element, node) {\n      var timerDefinition = getTimerDefinition(timerEventDefinition, element, node);\n\n      return !getTimerDefinitionType(timerDefinition);\n    }\n\n  }));\n\n}\n\nmodule.exports = TimerEventDefinition;\n","var fails = require('../internals/fails');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\nvar V8_VERSION = require('../internals/engine-v8-version');\n\nvar SPECIES = wellKnownSymbol('species');\n\nmodule.exports = function (METHOD_NAME) {\n  // We can't use this feature detection in V8 since it causes\n  // deoptimization and serious performance degradation\n  // https://github.com/zloirock/core-js/issues/677\n  return V8_VERSION >= 51 || !fails(function () {\n    var array = [];\n    var constructor = array.constructor = {};\n    constructor[SPECIES] = function () {\n      return { foo: 1 };\n    };\n    return array[METHOD_NAME](Boolean).foo !== 1;\n  });\n};\n","/**\n * Removes `key` and its value from the hash.\n *\n * @private\n * @name delete\n * @memberOf Hash\n * @param {Object} hash The hash to modify.\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction hashDelete(key) {\n  var result = this.has(key) && delete this.__data__[key];\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = hashDelete;\n","var getMapData = require('./_getMapData');\n\n/**\n * Sets the map `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf MapCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the map cache instance.\n */\nfunction mapCacheSet(key, value) {\n  var data = getMapData(this, key),\n      size = data.size;\n\n  data.set(key, value);\n  this.size += data.size == size ? 0 : 1;\n  return this;\n}\n\nmodule.exports = mapCacheSet;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getImplementationType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  function isExternal(element) {\n    return getImplementationType(element) === 'external';\n  }\n\n  var topicEntry = entryFactory.textField({\n    id: 'externalTopic',\n    label: translate('Topic'),\n    modelProperty: 'externalTopic',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { externalTopic: bo.get('camunda:topic') };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:topic': values.externalTopic\n      });\n    },\n\n    validate: function(element, values, node) {\n      return isExternal(element) && !values.externalTopic ? { externalTopic: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isExternal(element);\n    }\n\n  });\n\n  return [ topicEntry ];\n\n};\n","/**\n * A specialized version of `matchesProperty` for source values suitable\n * for strict equality comparisons, i.e. `===`.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @param {*} srcValue The value to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction matchesStrictComparable(key, srcValue) {\n  return function(object) {\n    if (object == null) {\n      return false;\n    }\n    return object[key] === srcValue &&\n      (srcValue !== undefined || (key in Object(object)));\n  };\n}\n\nmodule.exports = matchesStrictComparable;\n","var apply = require('./_apply');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * A specialized version of `baseRest` which transforms the rest array.\n *\n * @private\n * @param {Function} func The function to apply a rest parameter to.\n * @param {number} [start=func.length-1] The start position of the rest parameter.\n * @param {Function} transform The rest array transform.\n * @returns {Function} Returns the new function.\n */\nfunction overRest(func, start, transform) {\n  start = nativeMax(start === undefined ? (func.length - 1) : start, 0);\n  return function() {\n    var args = arguments,\n        index = -1,\n        length = nativeMax(args.length - start, 0),\n        array = Array(length);\n\n    while (++index < length) {\n      array[index] = args[start + index];\n    }\n    index = -1;\n    var otherArgs = Array(start + 1);\n    while (++index < start) {\n      otherArgs[index] = args[index];\n    }\n    otherArgs[start] = transform(array);\n    return apply(func, this, otherArgs);\n  };\n}\n\nmodule.exports = overRest;\n","var memoize = require('./memoize');\n\n/** Used as the maximum memoize cache size. */\nvar MAX_MEMOIZE_SIZE = 500;\n\n/**\n * A specialized version of `_.memoize` which clears the memoized function's\n * cache when it exceeds `MAX_MEMOIZE_SIZE`.\n *\n * @private\n * @param {Function} func The function to have its output memoized.\n * @returns {Function} Returns the new memoized function.\n */\nfunction memoizeCapped(func) {\n  var result = memoize(func, function(key) {\n    if (cache.size === MAX_MEMOIZE_SIZE) {\n      cache.clear();\n    }\n    return key;\n  });\n\n  var cache = result.cache;\n  return result;\n}\n\nmodule.exports = memoizeCapped;\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar getTemplate = require('./Helper').getTemplate;\n\nvar PropertiesActivator = require('../../../PropertiesActivator');\n\nvar HIGHER_PRIORITY = 1100;\n\n/**\n * Applies template visibility settings.\n *\n * Controlled using `entriesVisible` on template config object:\n *\n * ```json\n *     \"entriesVisible\": {\n *       \"_all\": true|false,\n *       \"entryName\": true|false,\n *       ...\n *     }\n * ```\n *\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n */\nfunction CustomElementsPropertiesActivator(eventBus, elementTemplates) {\n  PropertiesActivator.call(this, eventBus, HIGHER_PRIORITY);\n\n  this.isEntryVisible = function(entry, element) {\n\n    var template = getTemplate(element, elementTemplates);\n\n    if (template && !isEntryVisible(entry, template)) {\n      return false;\n    }\n  };\n\n  this.isPropertyEditable = function(entry, propertyName, element) {\n\n    var template = getTemplate(element, elementTemplates);\n\n    if (template && !isEntryEditable(entry, template)) {\n      return false;\n    }\n  };\n}\n\nCustomElementsPropertiesActivator.$inject = [ 'eventBus', 'elementTemplates' ];\n\ninherits(CustomElementsPropertiesActivator, PropertiesActivator);\n\nmodule.exports = CustomElementsPropertiesActivator;\n\n\n\n// helpers ////////////////////////////////////\n\n\nvar CUSTOM_PROPERTIES_PATTERN = /^custom-/;\n\nvar DEFAULT_ENTRIES_VISIBLE = {\n  _all: false,\n  id: true,\n  name: true\n};\n\nfunction isCustomEntry(entry) {\n  return CUSTOM_PROPERTIES_PATTERN.test(entry.id);\n}\n\nfunction isEntryVisible(entry, template) {\n\n  var entryId = entry.id;\n\n  if (entryId === 'elementTemplate-chooser' || isCustomEntry(entry)) {\n    return true;\n  }\n\n  var entriesVisible = template.entriesVisible || DEFAULT_ENTRIES_VISIBLE;\n\n  if (typeof entriesVisible === 'boolean') {\n    return entriesVisible;\n  }\n\n  var defaultVisible = entriesVisible._all || false,\n      entryVisible = entriesVisible[entryId];\n\n  // d = true, e = false => false\n  // d = false, e = true => true\n  // d = false, e = false\n  return (\n    (defaultVisible === true && entryVisible !== false) ||\n    (defaultVisible === false && entryVisible === true)\n  );\n}\n\nfunction isEntryEditable(entry, template) {\n\n  var property;\n\n  if (isCustomEntry(entry)) {\n    property = getProperty(template, entry);\n\n    return property && property.editable !== false;\n  }\n\n  return true;\n}\n\nfunction getProperty(template, entry) {\n\n  var index;\n  var idx = entry.id.replace('custom-' + template.id + '-', '');\n  if (idx.indexOf('-') !== -1) {\n    var indexes = idx.split('-');\n    if (indexes.length == 2) {\n      var scopeName = indexes[0].replace(/_/g, ':');\n      index = parseInt(indexes[1], 10);\n      if (scopeName && !isNaN(index)) {\n        return template.scopes[scopeName].properties[index];\n      }\n    }\n  } else {\n    index = parseInt(idx, 10);\n    if (!isNaN(index)) {\n      return template.properties[index];\n    }\n  }\n\n  throw new Error('cannot extract property index for entry <' + entry.id + '>');\n}\n","var baseFor = require('./_baseFor'),\n    keys = require('./keys');\n\n/**\n * The base implementation of `_.forOwn` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Object} Returns `object`.\n */\nfunction baseForOwn(object, iteratee) {\n  return object && baseFor(object, iteratee, keys);\n}\n\nmodule.exports = baseForOwn;\n","var baseEach = require('./_baseEach');\n\n/**\n * Aggregates elements of `collection` on `accumulator` with keys transformed\n * by `iteratee` and values set by `setter`.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform keys.\n * @param {Object} accumulator The initial aggregated object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction baseAggregator(collection, setter, iteratee, accumulator) {\n  baseEach(collection, function(value, key, collection) {\n    setter(accumulator, value, iteratee(value), collection);\n  });\n  return accumulator;\n}\n\nmodule.exports = baseAggregator;\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Uint8Array = root.Uint8Array;\n\nmodule.exports = Uint8Array;\n","var getMapData = require('./_getMapData');\n\n/**\n * Gets the map value for `key`.\n *\n * @private\n * @name get\n * @memberOf MapCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction mapCacheGet(key) {\n  return getMapData(this, key).get(key);\n}\n\nmodule.exports = mapCacheGet;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Sets the hash `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Hash\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the hash instance.\n */\nfunction hashSet(key, value) {\n  var data = this.__data__;\n  this.size += this.has(key) ? 0 : 1;\n  data[key] = (nativeCreate && value === undefined) ? HASH_UNDEFINED : value;\n  return this;\n}\n\nmodule.exports = hashSet;\n","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]';\n\n/**\n * The base implementation of `_.isArguments`.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n */\nfunction baseIsArguments(value) {\n  return isObjectLike(value) && baseGetTag(value) == argsTag;\n}\n\nmodule.exports = baseIsArguments;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  options = assign({\n    idPrefix: 'listener-',\n    insideListener: true\n  }, options);\n\n  var fieldInjectionEntry = fieldInjection(element, bpmnFactory, translate, options);\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","/** Used to lookup unminified function names. */\nvar realNames = {};\n\nmodule.exports = realNames;\n","'use strict';\n\nvar nameEntryFactory = require('./implementation/Name'),\n    createCategoryValue = require('../../../helper/CategoryHelper').createCategoryValue,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(group, element, bpmnFactory, canvas, translate) {\n\n  function initializeCategory(semantic) {\n    var rootElement = canvas.getRootElement(),\n        definitions = getBusinessObject(rootElement).$parent,\n        categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n    semantic.categoryValueRef = categoryValue;\n\n  }\n\n  function setGroupName(element, values) {\n    var bo = getBusinessObject(element),\n        categoryValueRef = bo.categoryValueRef;\n\n    if (!categoryValueRef) {\n      initializeCategory(bo);\n    }\n\n    // needs direct call to update categoryValue properly\n    return {\n      cmd: 'element.updateLabel',\n      context: {\n        element: element,\n        newLabel: values.categoryValue\n      }\n    };\n  }\n\n  function getGroupName(element) {\n    var bo = getBusinessObject(element),\n        value = (bo.categoryValueRef || {}).value;\n\n    return { categoryValue: value };\n  }\n\n  if (!is(element, 'bpmn:Collaboration')) {\n\n    var options;\n    if (is(element, 'bpmn:TextAnnotation')) {\n      options = { modelProperty: 'text', label: translate('Text') };\n    } else if (is(element, 'bpmn:Group')) {\n      options = {\n        modelProperty: 'categoryValue',\n        label: translate('Category Value'),\n        get: getGroupName,\n        set: setGroupName\n      };\n    }\n\n    // name\n    group.entries = group.entries.concat(nameEntryFactory(element, options, translate));\n\n  }\n\n};\n","var arrayMap = require('./_arrayMap');\n\n/**\n * The base implementation of `_.values` and `_.valuesIn` which creates an\n * array of `object` property values corresponding to the property names\n * of `props`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array} props The property names to get values for.\n * @returns {Object} Returns the array of property values.\n */\nfunction baseValues(object, props) {\n  return arrayMap(props, function(key) {\n    return object[key];\n  });\n}\n\nmodule.exports = baseValues;\n","var baseRest = require('./_baseRest'),\n    createWrap = require('./_createWrap'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_PARTIAL_FLAG = 32;\n\n/**\n * Creates a function that invokes `func` with the `this` binding of `thisArg`\n * and `partials` prepended to the arguments it receives.\n *\n * The `_.bind.placeholder` value, which defaults to `_` in monolithic builds,\n * may be used as a placeholder for partially applied arguments.\n *\n * **Note:** Unlike native `Function#bind`, this method doesn't set the \"length\"\n * property of bound functions.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to bind.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {...*} [partials] The arguments to be partially applied.\n * @returns {Function} Returns the new bound function.\n * @example\n *\n * function greet(greeting, punctuation) {\n *   return greeting + ' ' + this.user + punctuation;\n * }\n *\n * var object = { 'user': 'fred' };\n *\n * var bound = _.bind(greet, object, 'hi');\n * bound('!');\n * // => 'hi fred!'\n *\n * // Bound with placeholders.\n * var bound = _.bind(greet, object, _, '!');\n * bound('hi');\n * // => 'hi fred!'\n */\nvar bind = baseRest(function(func, thisArg, partials) {\n  var bitmask = WRAP_BIND_FLAG;\n  if (partials.length) {\n    var holders = replaceHolders(partials, getHolder(bind));\n    bitmask |= WRAP_PARTIAL_FLAG;\n  }\n  return createWrap(func, bitmask, thisArg, partials, holders);\n});\n\n// Assign default placeholders.\nbind.placeholder = {};\n\nmodule.exports = bind;\n","/**\n * The base implementation of `_.hasIn` without support for deep paths.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {Array|string} key The key to check.\n * @returns {boolean} Returns `true` if `key` exists, else `false`.\n */\nfunction baseHasIn(object, key) {\n  return object != null && key in Object(object);\n}\n\nmodule.exports = baseHasIn;\n","var createFind = require('./_createFind'),\n    findIndex = require('./findIndex');\n\n/**\n * Iterates over elements of `collection`, returning the first element\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {*} Returns the matched element, else `undefined`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'age': 36, 'active': true },\n *   { 'user': 'fred',    'age': 40, 'active': false },\n *   { 'user': 'pebbles', 'age': 1,  'active': true }\n * ];\n *\n * _.find(users, function(o) { return o.age < 40; });\n * // => object for 'barney'\n *\n * // The `_.matches` iteratee shorthand.\n * _.find(users, { 'age': 1, 'active': true });\n * // => object for 'pebbles'\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.find(users, ['active', false]);\n * // => object for 'fred'\n *\n * // The `_.property` iteratee shorthand.\n * _.find(users, 'active');\n * // => object for 'barney'\n */\nvar find = createFind(findIndex);\n\nmodule.exports = find;\n","var metaMap = require('./_metaMap'),\n    noop = require('./noop');\n\n/**\n * Gets metadata for `func`.\n *\n * @private\n * @param {Function} func The function to query.\n * @returns {*} Returns the metadata for `func`.\n */\nvar getData = !metaMap ? noop : function(func) {\n  return metaMap.get(func);\n};\n\nmodule.exports = getData;\n","/**\n * Removes all key-value entries from the list cache.\n *\n * @private\n * @name clear\n * @memberOf ListCache\n */\nfunction listCacheClear() {\n  this.__data__ = [];\n  this.size = 0;\n}\n\nmodule.exports = listCacheClear;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\n/**\n * Create an entry to modify the name of an an element.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n *\n * @return {Array<Object>} return an array containing\n *                         the entry to modify the name\n */\nmodule.exports = function(element, options, translate) {\n\n  options = options || {};\n  var id = options.id || 'name',\n      label = options.label || translate('Name'),\n      modelProperty = options.modelProperty || 'name';\n\n  var nameEntry = entryFactory.textBox({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    get: options.get,\n    set: options.set\n  });\n\n  return [ nameEntry ];\n\n};\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('input',{staticStyle:{\"visibility\":\"hidden\",\"position\":\"absolute\"},attrs:{\"type\":\"file\",\"id\":\"fileLoader\"},on:{\"change\":_vm.loadTextFromFile}})}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n\t<input type=\"file\" @change=\"loadTextFromFile\"  id=\"fileLoader\" style=\"visibility: hidden; position: absolute;\">\r\n</template>\r\n\r\n<script>\r\n\texport default {\r\n\t\tdata: function() {\r\n\t\t\treturn {\r\n\t\t\t\tvalue: ''\r\n\t\t\t}\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tloadTextFromFile: function(e) {\r\n\t\t\t\tconst ele = document.querySelector('#fileLoader')\r\n\t\t\t\tif (ele.value != \"\") {\r\n\t\t\t\t\tconst reader = new FileReader\r\n\t\t\t\t\treader.onload = (e) => {\r\n\t\t\t\t\t\tthis.$emit('loadFile', e.target.result)\r\n\t\t\t\t\t\tele.value = \"\"//每次使用后，将组件值恢复为空，这样能解决第二次导入无法打开的问题\r\n\t\t\t\t\t}\r\n\t\t\t\t\tconst file = e.target.files[0]\r\n\t\t\t\t\treader.readAsText(file)\r\n\t\t\t\t}\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style>\r\n</style>\r\n","import mod from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fileLoader.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../../node_modules/thread-loader/dist/cjs.js!../../../node_modules/babel-loader/lib/index.js!../../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../../node_modules/vue-loader/lib/index.js??vue-loader-options!./fileLoader.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./fileLoader.vue?vue&type=template&id=3e4a7882&\"\nimport script from \"./fileLoader.vue?vue&type=script&lang=js&\"\nexport * from \"./fileLoader.vue?vue&type=script&lang=js&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Used to resolve the\n * [`toStringTag`](http://ecma-international.org/ecma-262/7.0/#sec-object.prototype.tostring)\n * of values.\n */\nvar nativeObjectToString = objectProto.toString;\n\n/**\n * Converts `value` to a string using `Object.prototype.toString`.\n *\n * @private\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n */\nfunction objectToString(value) {\n  return nativeObjectToString.call(value);\n}\n\nmodule.exports = objectToString;\n","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    baseLodash = require('./_baseLodash'),\n    isArray = require('./isArray'),\n    isObjectLike = require('./isObjectLike'),\n    wrapperClone = require('./_wrapperClone');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates a `lodash` object which wraps `value` to enable implicit method\n * chain sequences. Methods that operate on and return arrays, collections,\n * and functions can be chained together. Methods that retrieve a single value\n * or may return a primitive value will automatically end the chain sequence\n * and return the unwrapped value. Otherwise, the value must be unwrapped\n * with `_#value`.\n *\n * Explicit chain sequences, which must be unwrapped with `_#value`, may be\n * enabled using `_.chain`.\n *\n * The execution of chained methods is lazy, that is, it's deferred until\n * `_#value` is implicitly or explicitly called.\n *\n * Lazy evaluation allows several methods to support shortcut fusion.\n * Shortcut fusion is an optimization to merge iteratee calls; this avoids\n * the creation of intermediate arrays and can greatly reduce the number of\n * iteratee executions. Sections of a chain sequence qualify for shortcut\n * fusion if the section is applied to an array and iteratees accept only\n * one argument. The heuristic for whether a section qualifies for shortcut\n * fusion is subject to change.\n *\n * Chaining is supported in custom builds as long as the `_#value` method is\n * directly or indirectly included in the build.\n *\n * In addition to lodash methods, wrappers have `Array` and `String` methods.\n *\n * The wrapper `Array` methods are:\n * `concat`, `join`, `pop`, `push`, `shift`, `sort`, `splice`, and `unshift`\n *\n * The wrapper `String` methods are:\n * `replace` and `split`\n *\n * The wrapper methods that support shortcut fusion are:\n * `at`, `compact`, `drop`, `dropRight`, `dropWhile`, `filter`, `find`,\n * `findLast`, `head`, `initial`, `last`, `map`, `reject`, `reverse`, `slice`,\n * `tail`, `take`, `takeRight`, `takeRightWhile`, `takeWhile`, and `toArray`\n *\n * The chainable wrapper methods are:\n * `after`, `ary`, `assign`, `assignIn`, `assignInWith`, `assignWith`, `at`,\n * `before`, `bind`, `bindAll`, `bindKey`, `castArray`, `chain`, `chunk`,\n * `commit`, `compact`, `concat`, `conforms`, `constant`, `countBy`, `create`,\n * `curry`, `debounce`, `defaults`, `defaultsDeep`, `defer`, `delay`,\n * `difference`, `differenceBy`, `differenceWith`, `drop`, `dropRight`,\n * `dropRightWhile`, `dropWhile`, `extend`, `extendWith`, `fill`, `filter`,\n * `flatMap`, `flatMapDeep`, `flatMapDepth`, `flatten`, `flattenDeep`,\n * `flattenDepth`, `flip`, `flow`, `flowRight`, `fromPairs`, `functions`,\n * `functionsIn`, `groupBy`, `initial`, `intersection`, `intersectionBy`,\n * `intersectionWith`, `invert`, `invertBy`, `invokeMap`, `iteratee`, `keyBy`,\n * `keys`, `keysIn`, `map`, `mapKeys`, `mapValues`, `matches`, `matchesProperty`,\n * `memoize`, `merge`, `mergeWith`, `method`, `methodOf`, `mixin`, `negate`,\n * `nthArg`, `omit`, `omitBy`, `once`, `orderBy`, `over`, `overArgs`,\n * `overEvery`, `overSome`, `partial`, `partialRight`, `partition`, `pick`,\n * `pickBy`, `plant`, `property`, `propertyOf`, `pull`, `pullAll`, `pullAllBy`,\n * `pullAllWith`, `pullAt`, `push`, `range`, `rangeRight`, `rearg`, `reject`,\n * `remove`, `rest`, `reverse`, `sampleSize`, `set`, `setWith`, `shuffle`,\n * `slice`, `sort`, `sortBy`, `splice`, `spread`, `tail`, `take`, `takeRight`,\n * `takeRightWhile`, `takeWhile`, `tap`, `throttle`, `thru`, `toArray`,\n * `toPairs`, `toPairsIn`, `toPath`, `toPlainObject`, `transform`, `unary`,\n * `union`, `unionBy`, `unionWith`, `uniq`, `uniqBy`, `uniqWith`, `unset`,\n * `unshift`, `unzip`, `unzipWith`, `update`, `updateWith`, `values`,\n * `valuesIn`, `without`, `wrap`, `xor`, `xorBy`, `xorWith`, `zip`,\n * `zipObject`, `zipObjectDeep`, and `zipWith`\n *\n * The wrapper methods that are **not** chainable by default are:\n * `add`, `attempt`, `camelCase`, `capitalize`, `ceil`, `clamp`, `clone`,\n * `cloneDeep`, `cloneDeepWith`, `cloneWith`, `conformsTo`, `deburr`,\n * `defaultTo`, `divide`, `each`, `eachRight`, `endsWith`, `eq`, `escape`,\n * `escapeRegExp`, `every`, `find`, `findIndex`, `findKey`, `findLast`,\n * `findLastIndex`, `findLastKey`, `first`, `floor`, `forEach`, `forEachRight`,\n * `forIn`, `forInRight`, `forOwn`, `forOwnRight`, `get`, `gt`, `gte`, `has`,\n * `hasIn`, `head`, `identity`, `includes`, `indexOf`, `inRange`, `invoke`,\n * `isArguments`, `isArray`, `isArrayBuffer`, `isArrayLike`, `isArrayLikeObject`,\n * `isBoolean`, `isBuffer`, `isDate`, `isElement`, `isEmpty`, `isEqual`,\n * `isEqualWith`, `isError`, `isFinite`, `isFunction`, `isInteger`, `isLength`,\n * `isMap`, `isMatch`, `isMatchWith`, `isNaN`, `isNative`, `isNil`, `isNull`,\n * `isNumber`, `isObject`, `isObjectLike`, `isPlainObject`, `isRegExp`,\n * `isSafeInteger`, `isSet`, `isString`, `isUndefined`, `isTypedArray`,\n * `isWeakMap`, `isWeakSet`, `join`, `kebabCase`, `last`, `lastIndexOf`,\n * `lowerCase`, `lowerFirst`, `lt`, `lte`, `max`, `maxBy`, `mean`, `meanBy`,\n * `min`, `minBy`, `multiply`, `noConflict`, `noop`, `now`, `nth`, `pad`,\n * `padEnd`, `padStart`, `parseInt`, `pop`, `random`, `reduce`, `reduceRight`,\n * `repeat`, `result`, `round`, `runInContext`, `sample`, `shift`, `size`,\n * `snakeCase`, `some`, `sortedIndex`, `sortedIndexBy`, `sortedLastIndex`,\n * `sortedLastIndexBy`, `startCase`, `startsWith`, `stubArray`, `stubFalse`,\n * `stubObject`, `stubString`, `stubTrue`, `subtract`, `sum`, `sumBy`,\n * `template`, `times`, `toFinite`, `toInteger`, `toJSON`, `toLength`,\n * `toLower`, `toNumber`, `toSafeInteger`, `toString`, `toUpper`, `trim`,\n * `trimEnd`, `trimStart`, `truncate`, `unescape`, `uniqueId`, `upperCase`,\n * `upperFirst`, `value`, and `words`\n *\n * @name _\n * @constructor\n * @category Seq\n * @param {*} value The value to wrap in a `lodash` instance.\n * @returns {Object} Returns the new `lodash` wrapper instance.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * var wrapped = _([1, 2, 3]);\n *\n * // Returns an unwrapped value.\n * wrapped.reduce(_.add);\n * // => 6\n *\n * // Returns a wrapped value.\n * var squares = wrapped.map(square);\n *\n * _.isArray(squares);\n * // => false\n *\n * _.isArray(squares.value());\n * // => true\n */\nfunction lodash(value) {\n  if (isObjectLike(value) && !isArray(value) && !(value instanceof LazyWrapper)) {\n    if (value instanceof LodashWrapper) {\n      return value;\n    }\n    if (hasOwnProperty.call(value, '__wrapped__')) {\n      return wrapperClone(value);\n    }\n  }\n  return new LodashWrapper(value);\n}\n\n// Ensure wrappers are instances of `baseLodash`.\nlodash.prototype = baseLodash.prototype;\nlodash.prototype.constructor = lodash;\n\nmodule.exports = lodash;\n","'use strict';\n\nvar values = require('lodash/values');\n\n/**\n * The guy knowing all configured element templates.\n *\n * This registry won't validate. Use the {@link Validator}\n * to verify a template is valid prior to adding it to\n * this registry.\n */\nfunction ElementTemplates() {\n\n  this._templates = {};\n\n  /**\n   * Sets the known element templates.\n   *\n   * @param {Array<TemplateDescriptor>} descriptors\n   *\n   * @return {ElementTemplates}\n   */\n  this.set = function(descriptors) {\n\n    var templates = this._templates = {};\n\n    descriptors.forEach(function(descriptor) {\n      templates[descriptor.id] = descriptor;\n    });\n\n    return this;\n  };\n\n  /**\n   * Get template descriptor with given id.\n   *\n   * @param {String} id\n   *\n   * @return {TemplateDescriptor}\n   */\n  this.get = function(id) {\n    return this._templates[id];\n  };\n\n  /**\n   * Return all known template descriptors.\n   *\n   * @return {Array<TemplateDescriptor>}\n   */\n  this.getAll = function() {\n    return values(this._templates);\n  };\n\n}\n\nmodule.exports = ElementTemplates;","const testRule = require('./test-rule');\n\nconst categoryMap = {\n  0: 'off',\n  1: 'warn',\n  2: 'error'\n};\n\n\nfunction Linter(options = {}) {\n\n  const {\n    config,\n    resolver\n  } = options;\n\n  if (typeof resolver === 'undefined') {\n    throw new Error('must provide <options.resolver>');\n  }\n\n  this.config = config;\n  this.resolver = resolver;\n\n  this.cachedRules = {};\n  this.cachedConfigs = {};\n}\n\n\nmodule.exports = Linter;\n\n/**\n * Applies a rule on the moddleRoot and adds reports to the finalReport\n *\n * @param {ModdleElement} moddleRoot\n *\n * @param {Object} ruleDefinition.name\n * @param {Object} ruleDefinition.config\n * @param {Object} ruleDefinition.category\n * @param {Rule} ruleDefinition.rule\n *\n * @return {Array<ValidationErrors>} rule reports\n */\nLinter.prototype.applyRule = function applyRule(moddleRoot, ruleDefinition) {\n\n  const {\n    config,\n    rule,\n    category,\n    name\n  } = ruleDefinition;\n\n  try {\n\n    const reports = testRule({\n      moddleRoot,\n      rule,\n      config\n    });\n\n    return reports.map(function(report) {\n      return {\n        ...report,\n        category\n      };\n    });\n  } catch (e) {\n    console.error('rule <' + name + '> failed with error: ', e);\n\n    return [\n      {\n        message: 'Rule error: ' + e.message,\n        category: 'error'\n      }\n    ];\n  }\n\n};\n\n\nLinter.prototype.resolveRule = function(name) {\n\n  const {\n    pkg,\n    ruleName\n  } = this.parseRuleName(name);\n\n  const id = `${pkg}-${ruleName}`;\n\n  const rule = this.cachedRules[id];\n\n  if (rule) {\n    return Promise.resolve(rule);\n  }\n\n  return Promise.resolve(this.resolver.resolveRule(pkg, ruleName)).then((ruleFactory) => {\n\n    if (!ruleFactory) {\n      throw new Error(`unknown rule <${name}>`);\n    }\n\n    const rule = this.cachedRules[id] = ruleFactory();\n\n    return rule;\n  });\n};\n\nLinter.prototype.resolveConfig = function(name) {\n\n  const {\n    pkg,\n    configName\n  } = this.parseConfigName(name);\n\n  const id = `${pkg}-${configName}`;\n\n  const config = this.cachedConfigs[id];\n\n  if (config) {\n    return Promise.resolve(config);\n  }\n\n  return Promise.resolve(this.resolver.resolveConfig(pkg, configName)).then((config) => {\n\n    if (!config) {\n      throw new Error(`unknown config <${name}>`);\n    }\n\n    const actualConfig = this.cachedConfigs[id] = this.normalizeConfig(config, pkg);\n\n    return actualConfig;\n  });\n};\n\n/**\n * Take a linter config and return list of resolved rules.\n *\n * @param {Object} config\n *\n * @return {Array<RuleDefinition>}\n */\nLinter.prototype.resolveRules = function(config) {\n\n  return this.resolveConfiguredRules(config).then((rulesConfig) => {\n\n    // parse rule values\n    const parsedRules = Object.entries(rulesConfig).map(([ name, value ]) => {\n      const {\n        category,\n        config\n      } = this.parseRuleValue(value);\n\n      return {\n        name,\n        category,\n        config\n      };\n    });\n\n    // filter only for enabled rules\n    const enabledRules = parsedRules.filter(definition => definition.category !== 'off');\n\n    // load enabled rules\n    const loaders = enabledRules.map((definition) => {\n\n      const {\n        name\n      } = definition;\n\n      return this.resolveRule(name).then(function(rule) {\n        return {\n          ...definition,\n          rule\n        };\n      });\n    });\n\n    return Promise.all(loaders);\n  });\n};\n\n\nLinter.prototype.resolveConfiguredRules = function(config) {\n\n  let parents = config.extends;\n\n  if (typeof parents === 'string') {\n    parents = [ parents ];\n  }\n\n  if (typeof parents === 'undefined') {\n    parents = [];\n  }\n\n  return Promise.all(\n    parents.map((configName) => {\n      return this.resolveConfig(configName).then((config) => {\n        return this.resolveConfiguredRules(config);\n      });\n    })\n  ).then((inheritedRules) => {\n\n    const overrideRules = this.normalizeConfig(config, 'bpmnlint').rules;\n\n    const rules = [ ...inheritedRules, overrideRules ].reduce((rules, currentRules) => {\n      return {\n        ...rules,\n        ...currentRules\n      };\n    }, {});\n\n    return rules;\n  });\n};\n\n\n/**\n * Lint the given model root, using the specified linter config.\n *\n * @param {ModdleElement} moddleRoot\n * @param {Object} [config] the bpmnlint configuration to use\n *\n * @return {Object} lint results, keyed by category names\n */\nLinter.prototype.lint = function(moddleRoot, config) {\n\n  config = config || this.config;\n\n  // load rules\n  return this.resolveRules(config).then((ruleDefinitions) => {\n\n    const allReports = {};\n\n    ruleDefinitions.forEach((ruleDefinition) => {\n\n      const {\n        name\n      } = ruleDefinition;\n\n      const reports = this.applyRule(moddleRoot, ruleDefinition);\n\n      if (reports.length) {\n        allReports[name] = reports;\n      }\n    });\n\n    return allReports;\n  });\n};\n\n\nLinter.prototype.parseRuleValue = function(value) {\n\n  let category;\n  let config;\n\n  if (Array.isArray(value)) {\n    category = value[0];\n    config = value[1];\n  } else {\n    category = value;\n    config = {};\n  }\n\n  // normalize rule flag to <error> and <warn> which\n  // may be upper case or a number at this point\n  if (typeof category === 'string') {\n    category = category.toLowerCase();\n  }\n\n  category = categoryMap[category] || category;\n\n  return {\n    config,\n    category\n  };\n};\n\nLinter.prototype.parseRuleName = function(name, localPackage = 'bpmnlint') {\n\n  /**\n   * We recognize the following rule name patterns:\n   *\n   * {RULE_NAME} => PKG = 'bpmnlint'\n   * bpmnlint/{RULE_NAME} => PKG = 'bpmnlint'\n   * {PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * bpmnlint-plugin-{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * @scope/{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * @scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}/{RULE_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   */\n\n  const match = /^(?:(?:(@[^/]+)\\/)?([^@]{1}[^/]*)\\/)?([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable rule name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName,\n    ruleName\n  ] = match;\n\n  if (!packageName) {\n    return {\n      pkg: localPackage,\n      ruleName\n    };\n  }\n\n  const pkg = `${ns ? ns + '/' : '' }${prefixPackage(packageName)}`;\n\n  return {\n    pkg,\n    ruleName\n  };\n};\n\n\nLinter.prototype.parseConfigName = function(name) {\n\n  /**\n   * We recognize the following config name patterns:\n   *\n   * bpmnlint:{CONFIG_NAME} => PKG = 'bpmnlint'\n   * plugin:{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:bpmnlint-plugin-{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = 'bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:@scope/{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   * plugin:@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}/{CONFIG_NAME} => PKG = '@scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}'\n   */\n\n  const match = /^(?:(?:plugin:(?:(@[^/]+)\\/)?([^@]{1}[^/]*)\\/)|bpmnlint:)([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable config name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName,\n    configName\n  ] = match;\n\n  if (!packageName) {\n    return {\n      pkg: 'bpmnlint',\n      configName\n    };\n  }\n\n  const pkg = `${ns ? ns + '/' : '' }${prefixPackage(packageName)}`;\n\n  return {\n    pkg,\n    configName\n  };\n};\n\n\nLinter.prototype.getSimplePackageName = function(name) {\n\n  /**\n   * We recognize the following package name patterns:\n   *\n   * bpmnlint => PKG = 'bpmnlint'\n   * {PACKAGE_SHORTCUT} => PKG = PACKAGE_SHORTCUT\n   * bpmnlint-plugin-{PACKAGE_SHORTCUT}' => PKG = PACKAGE_SHORTCUT\n   * @scope/{PACKAGE_SHORTCUT} => PKG = '@scope/{PACKAGE_SHORTCUT}'\n   * @scope/bpmnlint-plugin-{PACKAGE_SHORTCUT}' => PKG = '@scope/PACKAGE_SHORTCUT'\n   */\n\n  const match = /^(?:(@[^/]+)\\/)?([^/]+)$/.exec(name);\n\n  if (!match) {\n    throw new Error(`unparseable package name <${name}>`);\n  }\n\n  const [\n    _,\n    ns,\n    packageName\n  ] = match;\n\n  return `${ns ? ns + '/' : '' }${unprefixPackage(packageName)}`;\n};\n\n\n/**\n * Validate and return validated config.\n *\n * @param  {Object} config\n * @param  {String} localPackage\n *\n * @return {Object} validated config\n */\nLinter.prototype.normalizeConfig = function(config, localPackage) {\n\n  const rules = config.rules || {};\n\n  const validatedRules = Object.keys(rules).reduce((normalizedRules, name) => {\n\n    const value = rules[name];\n\n    const {\n      pkg,\n      ruleName\n    } = this.parseRuleName(name, localPackage);\n\n    const normalizedName = (\n      pkg === 'bpmnlint'\n        ? ruleName\n        : `${this.getSimplePackageName(pkg)}/${ruleName}`\n    );\n\n    normalizedRules[normalizedName] = value;\n\n    return normalizedRules;\n  }, {});\n\n  return {\n    ...config,\n    rules: validatedRules\n  };\n};\n\n\n// helpers ///////////////////////////\n\nfunction prefixPackage(pkg) {\n\n  if (pkg === 'bpmnlint') {\n    return 'bpmnlint';\n  }\n\n  if (pkg.startsWith('bpmnlint-plugin-')) {\n    return pkg;\n  }\n\n  return `bpmnlint-plugin-${pkg}`;\n}\n\n\nfunction unprefixPackage(pkg) {\n\n  if (pkg.startsWith('bpmnlint-plugin-')) {\n    return pkg.substring('bpmnlint-plugin-'.length);\n  }\n\n  return pkg;\n}","'use strict';\n\nvar CmdHelper = {};\nmodule.exports = CmdHelper;\n\nCmdHelper.updateProperties = function(element, properties) {\n  return {\n    cmd: 'element.updateProperties',\n    context: { element: element, properties: properties }\n  };\n};\n\nCmdHelper.updateBusinessObject = function(element, businessObject, newProperties) {\n  return {\n    cmd: 'properties-panel.update-businessobject',\n    context: {\n      element: element,\n      businessObject: businessObject,\n      properties: newProperties\n    }\n  };\n};\n\nCmdHelper.addElementsTolist = function(element, businessObject, listPropertyName, objectsToAdd) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      objectsToAdd: objectsToAdd\n    }\n  };\n};\n\nCmdHelper.removeElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.addAndRemoveElementsFromList = function(element, businessObject, listPropertyName, referencePropertyName, objectsToAdd, objectsToRemove) {\n\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      referencePropertyName: referencePropertyName,\n      objectsToAdd: objectsToAdd,\n      objectsToRemove: objectsToRemove\n    }\n  };\n};\n\n\nCmdHelper.setList = function(element, businessObject, listPropertyName, updatedObjectList) {\n  return {\n    cmd: 'properties-panel.update-businessobject-list',\n    context: {\n      element: element,\n      currentObject: businessObject,\n      propertyName: listPropertyName,\n      updatedObjectList: updatedObjectList\n    }\n  };\n};\n","'use strict';\n\nvar cmdHelper = require('./CmdHelper'),\n    elementHelper = require('./ElementHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar ExtensionElementsHelper = {};\n\nvar getExtensionElements = function(bo) {\n  return bo.get('extensionElements');\n};\n\nExtensionElementsHelper.getExtensionElements = function(bo, type) {\n  var extensionElements = getExtensionElements(bo);\n  if (typeof extensionElements !== 'undefined') {\n    var extensionValues = extensionElements.get('values');\n    if (typeof extensionValues !== 'undefined') {\n      var elements = extensionValues.filter(function(value) {\n        return is(value, type);\n      });\n      if (elements.length) {\n        return elements;\n      }\n    }\n  }\n};\n\nExtensionElementsHelper.addEntry = function(bo, element, entry, bpmnFactory) {\n  var extensionElements = bo.get('extensionElements');\n\n  // if there is no extensionElements list, create one\n  if (!extensionElements) {\n    // TODO: Ask Daniel which operation costs more\n    extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [entry] }, bo, bpmnFactory);\n    return { extensionElements : extensionElements };\n  } else {\n    // add new failedJobRetryExtensionElement to existing extensionElements list\n    return cmdHelper.addElementsTolist(element, extensionElements, 'values', [entry]);\n  }\n};\n\nExtensionElementsHelper.removeEntry = function(bo, element, entry) {\n  var extensionElements = bo.get('extensionElements');\n\n  if (!extensionElements) {\n\n    // return an empty command when there is no extensionElements list\n    return {};\n  }\n\n  return cmdHelper.removeElementsFromList(element, extensionElements, 'values', 'extensionElements', [entry]);\n};\n\nmodule.exports = ExtensionElementsHelper;\n","/**\n * The base implementation of `_.findIndex` and `_.findLastIndex` without\n * support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} predicate The function invoked per iteration.\n * @param {number} fromIndex The index to search from.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseFindIndex(array, predicate, fromIndex, fromRight) {\n  var length = array.length,\n      index = fromIndex + (fromRight ? 1 : -1);\n\n  while ((fromRight ? index-- : ++index < length)) {\n    if (predicate(array[index], index, array)) {\n      return index;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = baseFindIndex;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `self`. */\nvar freeSelf = typeof self == 'object' && self && self.Object === Object && self;\n\n/** Used as a reference to the global object. */\nvar root = freeGlobal || freeSelf || Function('return this')();\n\nmodule.exports = root;\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    cacheHas = require('./_cacheHas'),\n    createSet = require('./_createSet'),\n    setToArray = require('./_setToArray');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of `_.uniqBy` without support for iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new duplicate free array.\n */\nfunction baseUniq(array, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      length = array.length,\n      isCommon = true,\n      result = [],\n      seen = result;\n\n  if (comparator) {\n    isCommon = false;\n    includes = arrayIncludesWith;\n  }\n  else if (length >= LARGE_ARRAY_SIZE) {\n    var set = iteratee ? null : createSet(array);\n    if (set) {\n      return setToArray(set);\n    }\n    isCommon = false;\n    includes = cacheHas;\n    seen = new SetCache;\n  }\n  else {\n    seen = iteratee ? [] : result;\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee ? iteratee(value) : value;\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var seenIndex = seen.length;\n      while (seenIndex--) {\n        if (seen[seenIndex] === computed) {\n          continue outer;\n        }\n      }\n      if (iteratee) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n    else if (!includes(seen, computed, comparator)) {\n      if (seen !== result) {\n        seen.push(computed);\n      }\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseUniq;\n","/**\n * A specialized version of `_.filter` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction arrayFilter(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (predicate(value, index, array)) {\n      result[resIndex++] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayFilter;\n","var overArg = require('./_overArg');\n\n/** Built-in value references. */\nvar getPrototype = overArg(Object.getPrototypeOf, Object);\n\nmodule.exports = getPrototype;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory');\n\n\nmodule.exports = function(group, element, translate) {\n  if (is(element, 'camunda:Assignable')) {\n\n    // Assignee\n    group.entries.push(entryFactory.textField({\n      id : 'assignee',\n      label : translate('Assignee'),\n      modelProperty : 'assignee'\n    }));\n\n    // Candidate Users\n    group.entries.push(entryFactory.textField({\n      id : 'candidateUsers',\n      label : translate('Candidate Users'),\n      modelProperty : 'candidateUsers'\n    }));\n\n    // Candidate Groups\n    group.entries.push(entryFactory.textField({\n      id : 'candidateGroups',\n      label : translate('Candidate Groups'),\n      modelProperty : 'candidateGroups'\n    }));\n\n    // Due Date\n    group.entries.push(entryFactory.textField({\n      id : 'dueDate',\n      description : translate('The due date as an EL expression (e.g. ${someDate} or an ISO date (e.g. 2015-06-26T09:54:00)'),\n      label : translate('Due Date'),\n      modelProperty : 'dueDate'\n    }));\n\n    // FollowUp Date\n    group.entries.push(entryFactory.textField({\n      id : 'followUpDate',\n      description : translate('The follow up date as an EL expression (e.g. ${someDate} or an ' +\n                    'ISO date (e.g. 2015-06-26T09:54:00)'),\n      label : translate('Follow Up Date'),\n      modelProperty : 'followUpDate'\n    }));\n\n    // priority\n    group.entries.push(entryFactory.textField({\n      id : 'priority',\n      label : translate('Priority'),\n      modelProperty : 'priority'\n    }));\n  }\n};\n","var SetCache = require('./_SetCache'),\n    arrayIncludes = require('./_arrayIncludes'),\n    arrayIncludesWith = require('./_arrayIncludesWith'),\n    arrayMap = require('./_arrayMap'),\n    baseUnary = require('./_baseUnary'),\n    cacheHas = require('./_cacheHas');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * The base implementation of methods like `_.difference` without support\n * for excluding multiple arrays or iteratee shorthands.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {Array} values The values to exclude.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of filtered values.\n */\nfunction baseDifference(array, values, iteratee, comparator) {\n  var index = -1,\n      includes = arrayIncludes,\n      isCommon = true,\n      length = array.length,\n      result = [],\n      valuesLength = values.length;\n\n  if (!length) {\n    return result;\n  }\n  if (iteratee) {\n    values = arrayMap(values, baseUnary(iteratee));\n  }\n  if (comparator) {\n    includes = arrayIncludesWith;\n    isCommon = false;\n  }\n  else if (values.length >= LARGE_ARRAY_SIZE) {\n    includes = cacheHas;\n    isCommon = false;\n    values = new SetCache(values);\n  }\n  outer:\n  while (++index < length) {\n    var value = array[index],\n        computed = iteratee == null ? value : iteratee(value);\n\n    value = (comparator || value !== 0) ? value : 0;\n    if (isCommon && computed === computed) {\n      var valuesIndex = valuesLength;\n      while (valuesIndex--) {\n        if (values[valuesIndex] === computed) {\n          continue outer;\n        }\n      }\n      result.push(value);\n    }\n    else if (!includes(values, computed, comparator)) {\n      result.push(value);\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseDifference;\n","var baseRest = require('./_baseRest'),\n    isIterateeCall = require('./_isIterateeCall');\n\n/**\n * Creates a function like `_.assign`.\n *\n * @private\n * @param {Function} assigner The function to assign values.\n * @returns {Function} Returns the new assigner function.\n */\nfunction createAssigner(assigner) {\n  return baseRest(function(object, sources) {\n    var index = -1,\n        length = sources.length,\n        customizer = length > 1 ? sources[length - 1] : undefined,\n        guard = length > 2 ? sources[2] : undefined;\n\n    customizer = (assigner.length > 3 && typeof customizer == 'function')\n      ? (length--, customizer)\n      : undefined;\n\n    if (guard && isIterateeCall(sources[0], sources[1], guard)) {\n      customizer = length < 3 ? undefined : customizer;\n      length = 1;\n    }\n    object = Object(object);\n    while (++index < length) {\n      var source = sources[index];\n      if (source) {\n        assigner(object, source, index, customizer);\n      }\n    }\n    return object;\n  });\n}\n\nmodule.exports = createAssigner;\n","'use strict';\n\nvar listener = require('./implementation/Listener');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var listenerEntry = listener(element, bpmnFactory, {}, translate);\n\n  group.entries = group.entries.concat(listenerEntry.entries);\n\n  return {\n    getSelectedListener: listenerEntry.getSelectedListener\n  };\n\n};\n","/**\n * Removes `key` and its value from the stack.\n *\n * @private\n * @name delete\n * @memberOf Stack\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction stackDelete(key) {\n  var data = this.__data__,\n      result = data['delete'](key);\n\n  this.size = data.size;\n  return result;\n}\n\nmodule.exports = stackDelete;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    utils = require('../../../Utils'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nmodule.exports = function(group, element, translate, options) {\n\n  var description = options && options.description;\n\n  // Id\n  group.entries.push(entryFactory.validationAwareTextField({\n    id: 'id',\n    label: translate('Id'),\n    description: description && translate(description),\n    modelProperty: 'id',\n    getProperty: function(element) {\n      return getBusinessObject(element).id;\n    },\n    setProperty: function(element, properties) {\n\n      element = element.labelTarget || element;\n\n      return cmdHelper.updateProperties(element, properties);\n    },\n    validate: function(element, values) {\n      var idValue = values.id;\n\n      var bo = getBusinessObject(element);\n\n      var idError = utils.isIdValid(bo, idValue, translate);\n\n      return idError ? { id: idError } : {};\n    }\n  }));\n\n};\n","'use strict';\n\nvar domQuery = require('min-dom').query,\n    domClear = require('min-dom').clear,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    forEach = require('lodash/forEach'),\n    domify = require('min-dom').domify,\n    Ids = require('ids').default;\n\nvar SPACE_REGEX = /\\s/;\n\n// for QName validation as per http://www.w3.org/TR/REC-xml/#NT-NameChar\nvar QNAME_REGEX = /^([a-z][\\w-.]*:)?[a-z_][\\w-.]*$/i;\n\n// for ID validation as per BPMN Schema (QName - Namespace)\nvar ID_REGEX = /^[a-z_][\\w-.]*$/i;\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nfunction selectedOption(selectBox) {\n  if (selectBox.selectedIndex >= 0) {\n    return selectBox.options[selectBox.selectedIndex].value;\n  }\n}\n\nmodule.exports.selectedOption = selectedOption;\n\n\nfunction selectedType(elementSyntax, inputNode) {\n  var typeSelect = domQuery(elementSyntax, inputNode);\n  return selectedOption(typeSelect);\n}\n\nmodule.exports.selectedType = selectedType;\n\n\n/**\n * Retrieve the root element the document this\n * business object is contained in.\n *\n * @return {ModdleElement}\n */\nfunction getRoot(businessObject) {\n  var parent = businessObject;\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n  return parent;\n}\n\nmodule.exports.getRoot = getRoot;\n\n\n/**\n * filters all elements in the list which have a given type.\n * removes a new list\n */\nfunction filterElementsByType(objectList, type) {\n  var list = objectList || [];\n  var result = [];\n  forEach(list, function(obj) {\n    if (is(obj, type)) {\n      result.push(obj);\n    }\n  });\n  return result;\n}\n\nmodule.exports.filterElementsByType = filterElementsByType;\n\n\nfunction findRootElementsByType(businessObject, referencedType) {\n  var root = getRoot(businessObject);\n\n  return filterElementsByType(root.rootElements, referencedType);\n}\n\nmodule.exports.findRootElementsByType = findRootElementsByType;\n\n\nfunction removeAllChildren(domElement) {\n  while (domElement.firstChild) {\n    domElement.removeChild(domElement.firstChild);\n  }\n}\n\nmodule.exports.removeAllChildren = removeAllChildren;\n\n\n/**\n * adds an empty option to the list\n */\nfunction addEmptyParameter(list) {\n  return list.push({ 'label': '', 'value': '', 'name': '' });\n}\n\nmodule.exports.addEmptyParameter = addEmptyParameter;\n\n\n/**\n * returns a list with all root elements for the given parameter 'referencedType'\n */\nfunction refreshOptionsModel(businessObject, referencedType) {\n  var model = [];\n  var referableObjects = findRootElementsByType(businessObject, referencedType);\n  forEach(referableObjects, function(obj) {\n    model.push({\n      label: (obj.name || '') + ' (id='+obj.id+')',\n      value: obj.id,\n      name: obj.name\n    });\n  });\n  return model;\n}\n\nmodule.exports.refreshOptionsModel = refreshOptionsModel;\n\n\n/**\n * fills the drop down with options\n */\nfunction updateOptionsDropDown(domSelector, businessObject, referencedType, entryNode) {\n  var options = refreshOptionsModel(businessObject, referencedType);\n  addEmptyParameter(options);\n  var selectBox = domQuery(domSelector, entryNode);\n  domClear(selectBox);\n\n  forEach(options, function(option) {\n    var optionEntry = domify('<option value=\"' + escapeHTML(option.value) + '\">' + escapeHTML(option.label) + '</option>');\n    selectBox.appendChild(optionEntry);\n  });\n  return options;\n}\n\nmodule.exports.updateOptionsDropDown = updateOptionsDropDown;\n\n\n/**\n * checks whether the id value is valid\n *\n * @param {ModdleElement} bo\n * @param {String} idValue\n * @param {Function} translate\n *\n * @return {String} error message\n */\nfunction isIdValid(bo, idValue, translate) {\n  var assigned = bo.$model.ids.assigned(idValue);\n\n  var idExists = assigned && assigned !== bo;\n\n  if (!idValue || idExists) {\n    return translate('Element must have an unique id.');\n  }\n\n  return validateId(idValue, translate);\n}\n\nmodule.exports.isIdValid = isIdValid;\n\n\nfunction validateId(idValue, translate) {\n\n  if (containsSpace(idValue)) {\n    return translate('Id must not contain spaces.');\n  }\n\n  if (!ID_REGEX.test(idValue)) {\n\n    if (QNAME_REGEX.test(idValue)) {\n      return translate('Id must not contain prefix.');\n    }\n\n    return translate('Id must be a valid QName.');\n  }\n}\n\nmodule.exports.validateId = validateId;\n\n\nfunction containsSpace(value) {\n  return SPACE_REGEX.test(value);\n}\n\nmodule.exports.containsSpace = containsSpace;\n\n/**\n * generate a semantic id with given prefix\n */\nfunction nextId(prefix) {\n  var ids = new Ids([32,32,1]);\n\n  return ids.nextPrefixed(prefix);\n}\n\nmodule.exports.nextId = nextId;\n\n\nfunction triggerClickEvent(element) {\n  var evt;\n  var eventType = 'click';\n\n  if (document.createEvent) {\n    try {\n      // Chrome, Safari, Firefox\n      evt = new MouseEvent((eventType), { view: window, bubbles: true, cancelable: true });\n    } catch (e) {\n      // IE 11, PhantomJS (wat!)\n      evt = document.createEvent('MouseEvent');\n\n      evt.initEvent((eventType), true, true);\n    }\n    return element.dispatchEvent(evt);\n  } else {\n    // Welcome IE\n    evt = document.createEventObject();\n\n    return element.fireEvent('on' + eventType, evt);\n  }\n}\n\nmodule.exports.triggerClickEvent = triggerClickEvent;\n\n\nfunction escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n\nmodule.exports.escapeHTML = escapeHTML;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This function is like `composeArgs` except that the arguments composition\n * is tailored for `_.partialRight`.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to append to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgsRight(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersIndex = -1,\n      holdersLength = holders.length,\n      rightIndex = -1,\n      rightLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(rangeLength + rightLength),\n      isUncurried = !isCurried;\n\n  while (++argsIndex < rangeLength) {\n    result[argsIndex] = args[argsIndex];\n  }\n  var offset = argsIndex;\n  while (++rightIndex < rightLength) {\n    result[offset + rightIndex] = partials[rightIndex];\n  }\n  while (++holdersIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[offset + holders[holdersIndex]] = args[argsIndex++];\n    }\n  }\n  return result;\n}\n\nmodule.exports = composeArgsRight;\n","var isFunction = require('./isFunction'),\n    isLength = require('./isLength');\n\n/**\n * Checks if `value` is array-like. A value is considered array-like if it's\n * not a function and has a `value.length` that's an integer greater than or\n * equal to `0` and less than or equal to `Number.MAX_SAFE_INTEGER`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is array-like, else `false`.\n * @example\n *\n * _.isArrayLike([1, 2, 3]);\n * // => true\n *\n * _.isArrayLike(document.body.children);\n * // => true\n *\n * _.isArrayLike('abc');\n * // => true\n *\n * _.isArrayLike(_.noop);\n * // => false\n */\nfunction isArrayLike(value) {\n  return value != null && isLength(value.length) && !isFunction(value);\n}\n\nmodule.exports = isArrayLike;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that verifies that an event contains maximum one event definition.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:Event')) {\n      return;\n    }\n\n    const eventDefinitions = node.eventDefinitions || [];\n\n    if (eventDefinitions.length > 1) {\n      reporter.report(node.id, 'Event has multiple event definitions');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseAssignValue = require('./_baseAssignValue'),\n    eq = require('./eq');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns `value` to `key` of `object` if the existing value is not equivalent\n * using [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * for equality comparisons.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction assignValue(object, key, value) {\n  var objValue = object[key];\n  if (!(hasOwnProperty.call(object, key) && eq(objValue, value)) ||\n      (value === undefined && !(key in object))) {\n    baseAssignValue(object, key, value);\n  }\n}\n\nmodule.exports = assignValue;\n","var arrayFilter = require('./_arrayFilter'),\n    stubArray = require('./stubArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeGetSymbols = Object.getOwnPropertySymbols;\n\n/**\n * Creates an array of the own enumerable symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of symbols.\n */\nvar getSymbols = !nativeGetSymbols ? stubArray : function(object) {\n  if (object == null) {\n    return [];\n  }\n  object = Object(object);\n  return arrayFilter(nativeGetSymbols(object), function(symbol) {\n    return propertyIsEnumerable.call(object, symbol);\n  });\n};\n\nmodule.exports = getSymbols;\n","var isFunction = require('./isFunction'),\n    isMasked = require('./_isMasked'),\n    isObject = require('./isObject'),\n    toSource = require('./_toSource');\n\n/**\n * Used to match `RegExp`\n * [syntax characters](http://ecma-international.org/ecma-262/7.0/#sec-patterns).\n */\nvar reRegExpChar = /[\\\\^$.*+?()[\\]{}|]/g;\n\n/** Used to detect host constructors (Safari). */\nvar reIsHostCtor = /^\\[object .+?Constructor\\]$/;\n\n/** Used for built-in method references. */\nvar funcProto = Function.prototype,\n    objectProto = Object.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Used to detect if a method is native. */\nvar reIsNative = RegExp('^' +\n  funcToString.call(hasOwnProperty).replace(reRegExpChar, '\\\\$&')\n  .replace(/hasOwnProperty|(function).*?(?=\\\\\\()| for .+?(?=\\\\\\])/g, '$1.*?') + '$'\n);\n\n/**\n * The base implementation of `_.isNative` without bad shim checks.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a native function,\n *  else `false`.\n */\nfunction baseIsNative(value) {\n  if (!isObject(value) || isMasked(value)) {\n    return false;\n  }\n  var pattern = isFunction(value) ? reIsNative : reIsHostCtor;\n  return pattern.test(toSource(value));\n}\n\nmodule.exports = baseIsNative;\n","'use strict';\n\nvar isArray = require('lodash/isArray');\nvar isObject = require('lodash/isObject');\n\nvar DROPDOWN_TYPE = 'Dropdown';\n\nvar VALID_TYPES = [ 'String', 'Text', 'Boolean', 'Hidden', DROPDOWN_TYPE ];\n\nvar PROPERTY_TYPE = 'property',\n    CAMUNDA_PROPERTY_TYPE = 'camunda:property',\n    CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n    CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter',\n    CAMUNDA_IN_TYPE = 'camunda:in',\n    CAMUNDA_OUT_TYPE = 'camunda:out',\n    CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey',\n    CAMUNDA_EXECUTION_LISTENER = 'camunda:executionListener',\n    CAMUNDA_FIELD = 'camunda:field';\n\nvar VALID_BINDING_TYPES = [\n  PROPERTY_TYPE,\n  CAMUNDA_PROPERTY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_EXECUTION_LISTENER,\n  CAMUNDA_FIELD\n];\n\n\n/**\n * A element template validator.\n */\nfunction Validator() {\n\n  this._templatesById = {};\n\n  this._validTemplates = [];\n  this._errors = [];\n\n\n  /**\n   * Adds the templates.\n   *\n   * @param {Array<TemplateDescriptor>} templates\n   *\n   * @return {Validator} self\n   */\n  this.addAll = function(templates) {\n\n    if (!isArray(templates)) {\n      this._logError('templates must be []');\n    } else {\n      templates.forEach(this.add, this);\n    }\n\n    return this;\n  };\n\n  /**\n   * Add the given element template, if it is valid.\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Validator} self\n   */\n  this.add = function(template) {\n\n    var err = this._validateTemplate(template);\n\n    if (!err) {\n      this._templatesById[template.id] = template;\n\n      this._validTemplates.push(template);\n    }\n\n    return this;\n  };\n\n  /**\n   * Validate given template and return error (if any).\n   *\n   * @param {TemplateDescriptor} template\n   *\n   * @return {Error} validation error, if any\n   */\n  this._validateTemplate = function(template) {\n\n    var err,\n        id = template.id,\n        appliesTo = template.appliesTo,\n        properties = template.properties,\n        scopes = template.scopes;\n\n    if (!id) {\n      return this._logError('missing template id');\n    }\n\n    if (id in this._templatesById) {\n      return this._logError('template id <' + id + '> already used');\n    }\n\n    if (!isArray(appliesTo)) {\n      err = this._logError('missing appliesTo=[]', template);\n    }\n\n    if (!isArray(properties)) {\n      err = this._logError('missing properties=[]', template);\n    } else {\n      if (!this._validateProperties(properties)) {\n        err = new Error('invalid properties');\n      }\n    }\n\n    if (scopes) {\n      err = this._validateScopes(template, scopes);\n    }\n\n    return err;\n  };\n\n  this._validateScopes = function(template, scopes) {\n\n    var err,\n        scope,\n        scopeName;\n\n    if (!isObject(scopes) || isArray(scopes)) {\n      return this._logError('invalid scopes, should be scopes={}', template);\n    }\n\n    for (scopeName in scopes) {\n      scope = scopes[scopeName];\n\n      if (!isObject(scope) || isArray(scope)) {\n        err = this._logError('invalid scope, should be scope={}', template);\n      }\n\n      if (!isArray(scope.properties)) {\n        err = this._logError(\n          'missing properties=[] in scope <' + scopeName + '>', template\n        );\n      } else {\n        if (!this._validateProperties(scope.properties)) {\n          err = new Error('invalid properties in scope <' + scopeName + '>');\n        }\n      }\n    }\n\n    return err;\n  };\n\n  /**\n   * Validate properties and return false if any is invalid.\n   *\n   * @param {Array<PropertyDescriptor>} properties\n   *\n   * @return {Boolean} true if all properties are valid\n   */\n  this._validateProperties = function(properties) {\n    var validProperties = properties.filter(this._validateProperty, this);\n\n    return properties.length === validProperties.length;\n  };\n\n  /**\n   * Validate property and return false, if there was\n   * a validation error.\n   *\n   * @param {PropertyDescriptor} property\n   *\n   * @return {Boolean} true if property is valid\n   */\n  this._validateProperty = function(property) {\n\n    var type = property.type,\n        binding = property.binding;\n\n    var err;\n\n    var bindingType = binding.type;\n\n    if (VALID_TYPES.indexOf(type) === -1) {\n      err = this._logError(\n        'invalid property type <' + type + '>; ' +\n        'must be any of { ' + VALID_TYPES.join(', ') + ' }'\n      );\n    }\n\n    if (type === DROPDOWN_TYPE && bindingType !== CAMUNDA_EXECUTION_LISTENER) {\n      if (!isArray(property.choices)) {\n        err = this._logError(\n          'must provide choices=[] with ' + DROPDOWN_TYPE + ' type'\n        );\n      } else\n\n      if (!property.choices.every(isDropdownChoiceValid)) {\n        err = this._logError(\n          '{ name, value } must be specified for ' +\n          DROPDOWN_TYPE + ' choices'\n        );\n      }\n    }\n\n    if (!binding) {\n      return this._logError('property missing binding');\n    }\n\n    if (VALID_BINDING_TYPES.indexOf(bindingType) === -1) {\n      err = this._logError(\n        'invalid property.binding type <' + bindingType + '>; ' +\n        'must be any of { ' + VALID_BINDING_TYPES.join(', ') + ' }'\n      );\n    }\n\n    if (bindingType === PROPERTY_TYPE ||\n        bindingType === CAMUNDA_PROPERTY_TYPE ||\n        bindingType === CAMUNDA_INPUT_PARAMETER_TYPE ||\n        bindingType === CAMUNDA_FIELD) {\n\n      if (!binding.name) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires name'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n      if (!binding.source) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires source'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_IN_TYPE) {\n\n      if (!binding.variables && !binding.target) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires ' +\n          'variables or target'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_OUT_TYPE) {\n\n      if (!binding.variables && !binding.source && !binding.sourceExpression) {\n        err = this._logError(\n          'property.binding <' + bindingType + '> requires ' +\n          'variables, sourceExpression or source'\n        );\n      }\n    }\n\n    if (bindingType === CAMUNDA_EXECUTION_LISTENER) {\n\n      if (type !== 'Hidden') {\n        err = this._logError(\n          'invalid property type <' + type + '> for ' + CAMUNDA_EXECUTION_LISTENER + '; ' +\n          'must be <Hidden>'\n        );\n      }\n    }\n\n    return !err;\n  };\n\n\n  this._logError = function(err, template) {\n\n    if (typeof err === 'string') {\n      if (template) {\n        err = 'template(id: ' + template.id + ') ' + err;\n      }\n\n      err = new Error(err);\n    }\n\n    this._errors.push(err);\n\n    return err;\n  };\n\n  this.getErrors = function() {\n    return this._errors;\n  };\n\n  this.getValidTemplates = function() {\n    return this._validTemplates;\n  };\n}\n\nmodule.exports = Validator;\n\n\n// helpers ///////////////////////////////////\n\nfunction isDropdownChoiceValid(c) {\n  return 'name' in c && 'value' in c;\n}\n","/**\n * Gets the value at `key` of `object`.\n *\n * @private\n * @param {Object} [object] The object to query.\n * @param {string} key The key of the property to get.\n * @returns {*} Returns the property value.\n */\nfunction getValue(object, key) {\n  return object == null ? undefined : object[key];\n}\n\nmodule.exports = getValue;\n","var Symbol = require('./_Symbol'),\n    getRawTag = require('./_getRawTag'),\n    objectToString = require('./_objectToString');\n\n/** `Object#toString` result references. */\nvar nullTag = '[object Null]',\n    undefinedTag = '[object Undefined]';\n\n/** Built-in value references. */\nvar symToStringTag = Symbol ? Symbol.toStringTag : undefined;\n\n/**\n * The base implementation of `getTag` without fallbacks for buggy environments.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nfunction baseGetTag(value) {\n  if (value == null) {\n    return value === undefined ? undefinedTag : nullTag;\n  }\n  return (symToStringTag && symToStringTag in Object(value))\n    ? getRawTag(value)\n    : objectToString(value);\n}\n\nmodule.exports = baseGetTag;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    inputOutputHelper = require('../../../../helper/InputOutputHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\n\nfunction getInputOutput(element, insideConnector) {\n  return inputOutputHelper.getInputOutput(element, insideConnector);\n}\n\nfunction getConnector(element) {\n  return inputOutputHelper.getConnector(element);\n}\n\nfunction getInputParameters(element, insideConnector) {\n  return inputOutputHelper.getInputParameters(element, insideConnector);\n}\n\nfunction getOutputParameters(element, insideConnector) {\n  return inputOutputHelper.getOutputParameters(element, insideConnector);\n}\n\nfunction getInputParameter(element, insideConnector, idx) {\n  return inputOutputHelper.getInputParameter(element, insideConnector, idx);\n}\n\nfunction getOutputParameter(element, insideConnector, idx) {\n  return inputOutputHelper.getOutputParameter(element, insideConnector, idx);\n}\n\n\nfunction createElement(type, parent, factory, properties) {\n  return elementHelper.createElement(type, properties, parent, factory);\n}\n\nfunction createInputOutput(parent, bpmnFactory, properties) {\n  return createElement('camunda:InputOutput', parent, bpmnFactory, properties);\n}\n\nfunction createParameter(type, parent, bpmnFactory, properties) {\n  return createElement(type, parent, bpmnFactory, properties);\n}\n\n\nfunction ensureInputOutputSupported(element, insideConnector) {\n  return inputOutputHelper.isInputOutputSupported(element, insideConnector);\n}\n\nfunction ensureOutparameterSupported(element, insideConnector) {\n  return inputOutputHelper.areOutputParametersSupported(element, insideConnector);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var TYPE_LABEL = {\n    'camunda:Map': translate('Map'),\n    'camunda:List': translate('List'),\n    'camunda:Script': translate('Script')\n  };\n\n  options = options || {};\n\n  var insideConnector = !!options.insideConnector,\n      idPrefix = options.idPrefix || '';\n\n  var getSelected = function(element, node) {\n    var selection = (inputEntry && inputEntry.getSelected(element, node)) || { idx: -1 };\n\n    var parameter = getInputParameter(element, insideConnector, selection.idx);\n    if (!parameter && outputEntry) {\n      selection = outputEntry.getSelected(element, node);\n      parameter = getOutputParameter(element, insideConnector, selection.idx);\n    }\n    return parameter;\n  };\n\n  var result = {\n    getSelectedParameter: getSelected\n  };\n\n  var entries = result.entries = [];\n\n  if (!ensureInputOutputSupported(element)) {\n    return result;\n  }\n\n  var newElement = function(type, prop, factory) {\n\n    return function(element, extensionElements, value) {\n      var commands = [];\n\n      var inputOutput = getInputOutput(element, insideConnector);\n      if (!inputOutput) {\n        var parent = !insideConnector ? extensionElements : getConnector(element);\n        inputOutput = createInputOutput(parent, bpmnFactory, {\n          inputParameters: [],\n          outputParameters: []\n        });\n\n        if (!insideConnector) {\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            extensionElements,\n            'values',\n            'extensionElements',\n            [ inputOutput ],\n            []\n          ));\n        } else {\n          commands.push(cmdHelper.updateBusinessObject(element, parent, { inputOutput: inputOutput }));\n        }\n      }\n\n      var newElem = createParameter(type, inputOutput, bpmnFactory, { name: value });\n      commands.push(cmdHelper.addElementsTolist(element, inputOutput, prop, [ newElem ]));\n\n      return commands;\n    };\n  };\n\n  var removeElement = function(getter, prop, otherProp) {\n    return function(element, extensionElements, value, idx) {\n      var inputOutput = getInputOutput(element, insideConnector);\n      var parameter = getter(element, insideConnector, idx);\n\n      var commands = [];\n      commands.push(cmdHelper.removeElementsFromList(element, inputOutput, prop, null, [ parameter ]));\n\n      var firstLength = inputOutput.get(prop).length-1;\n      var secondLength = (inputOutput.get(otherProp) || []).length;\n\n      if (!firstLength && !secondLength) {\n\n        if (!insideConnector) {\n          commands.push(extensionElementsHelper.removeEntry(getBusinessObject(element), element, inputOutput));\n        } else {\n          var connector = getConnector(element);\n          commands.push(cmdHelper.updateBusinessObject(element, connector, { inputOutput: undefined }));\n        }\n\n      }\n\n      return commands;\n    };\n  };\n\n  var setOptionLabelValue = function(getter) {\n    return function(element, node, option, property, value, idx) {\n      var parameter = getter(element, insideConnector, idx);\n\n      var suffix = 'Text';\n\n      var definition = parameter.get('definition');\n      if (typeof definition !== 'undefined') {\n        var type = definition.$type;\n        suffix = TYPE_LABEL[type];\n      }\n\n      option.text = (value || '') + ' : ' + suffix;\n    };\n  };\n\n\n  // input parameters ///////////////////////////////////////////////////////////////\n\n  var inputEntry = extensionElementsEntry(element, bpmnFactory, {\n    id: idPrefix + 'inputs',\n    label: translate('Input Parameters'),\n    modelProperty: 'name',\n    prefix: 'Input',\n    resizable: true,\n\n    createExtensionElement: newElement('camunda:InputParameter', 'inputParameters'),\n    removeExtensionElement: removeElement(getInputParameter, 'inputParameters', 'outputParameters'),\n\n    getExtensionElements: function(element) {\n      return getInputParameters(element, insideConnector);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outputEntry && outputEntry.deselect(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(getInputParameter)\n\n  });\n  entries.push(inputEntry);\n\n\n  // output parameters ///////////////////////////////////////////////////////\n\n  if (ensureOutparameterSupported(element, insideConnector)) {\n    var outputEntry = extensionElementsEntry(element, bpmnFactory, {\n      id: idPrefix + 'outputs',\n      label: translate('Output Parameters'),\n      modelProperty: 'name',\n      prefix: 'Output',\n      resizable: true,\n\n      createExtensionElement: newElement('camunda:OutputParameter', 'outputParameters'),\n      removeExtensionElement: removeElement(getOutputParameter, 'outputParameters', 'inputParameters'),\n\n      getExtensionElements: function(element) {\n        return getOutputParameters(element, insideConnector);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        inputEntry.deselect(element, node);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(getOutputParameter)\n\n    });\n    entries.push(outputEntry);\n  }\n\n  return result;\n\n};\n","var LazyWrapper = require('./_LazyWrapper'),\n    getData = require('./_getData'),\n    getFuncName = require('./_getFuncName'),\n    lodash = require('./wrapperLodash');\n\n/**\n * Checks if `func` has a lazy counterpart.\n *\n * @private\n * @param {Function} func The function to check.\n * @returns {boolean} Returns `true` if `func` has a lazy counterpart,\n *  else `false`.\n */\nfunction isLaziable(func) {\n  var funcName = getFuncName(func),\n      other = lodash[funcName];\n\n  if (typeof other != 'function' || !(funcName in LazyWrapper.prototype)) {\n    return false;\n  }\n  if (func === other) {\n    return true;\n  }\n  var data = getData(other);\n  return !!data && func === data[0];\n}\n\nmodule.exports = isLaziable;\n","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks the presence of an end event per scope.\n */\nmodule.exports = function() {\n\n  function hasEndEvent(node) {\n    const flowElements = node.flowElements || [];\n\n    return (\n      flowElements.some(node => is(node, 'bpmn:EndEvent'))\n    );\n  }\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Process',\n      'bpmn:SubProcess'\n    ])) {\n      return;\n    }\n\n    if (!hasEndEvent(node)) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' is missing end event');\n    }\n  }\n\n  return { check };\n};\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar WeakMap = getNative(root, 'WeakMap');\n\nmodule.exports = WeakMap;\n","var getNative = require('./_getNative');\n\nvar defineProperty = (function() {\n  try {\n    var func = getNative(Object, 'defineProperty');\n    func({}, '', {});\n    return func;\n  } catch (e) {}\n}());\n\nmodule.exports = defineProperty;\n","var isStrictComparable = require('./_isStrictComparable'),\n    keys = require('./keys');\n\n/**\n * Gets the property names, values, and compare flags of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the match data of `object`.\n */\nfunction getMatchData(object) {\n  var result = keys(object),\n      length = result.length;\n\n  while (length--) {\n    var key = result[length],\n        value = object[key];\n\n    result[length] = [key, value, isStrictComparable(value)];\n  }\n  return result;\n}\n\nmodule.exports = getMatchData;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var historyTimeToLiveEntry = entryFactory.textField({\n    id: 'historyTimeToLive',\n    label: translate('History Time To Live'),\n    modelProperty: 'historyTimeToLive',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var historyTimeToLive = bo.get('camunda:historyTimeToLive');\n\n      return {\n        historyTimeToLive: historyTimeToLive ? historyTimeToLive : ''\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:historyTimeToLive': values.historyTimeToLive || undefined\n      });\n    }\n\n  });\n\n  return [ historyTimeToLiveEntry ];\n};\n","var baseValues = require('./_baseValues'),\n    keys = require('./keys');\n\n/**\n * Creates an array of the own enumerable string keyed property values of `object`.\n *\n * **Note:** Non-object values are coerced to objects.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property values.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.values(new Foo);\n * // => [1, 2] (iteration order is not guaranteed)\n *\n * _.values('hi');\n * // => ['h', 'i']\n */\nfunction values(object) {\n  return object == null ? [] : baseValues(object, keys(object));\n}\n\nmodule.exports = values;\n","var root = require('./_root');\n\n/**\n * Gets the timestamp of the number of milliseconds that have elapsed since\n * the Unix epoch (1 January 1970 00:00:00 UTC).\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Date\n * @returns {number} Returns the timestamp.\n * @example\n *\n * _.defer(function(stamp) {\n *   console.log(_.now() - stamp);\n * }, _.now());\n * // => Logs the number of milliseconds it took for the deferred invocation.\n */\nvar now = function() {\n  return root.Date.now();\n};\n\nmodule.exports = now;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks that start events inside a normal sub-processes\n * are blank (do not have an event definition).\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SubProcess') || node.triggeredByEvent) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    flowElements.forEach(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      if (eventDefinitions.length > 0) {\n        reporter.report(flowElement.id, 'Start event must be blank');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};","'use strict';\n\nvar utils = require('./utils');\nvar formats = require('./formats');\n\nvar arrayPrefixGenerators = {\n    brackets: function brackets(prefix) { // eslint-disable-line func-name-matching\n        return prefix + '[]';\n    },\n    indices: function indices(prefix, key) { // eslint-disable-line func-name-matching\n        return prefix + '[' + key + ']';\n    },\n    repeat: function repeat(prefix) { // eslint-disable-line func-name-matching\n        return prefix;\n    }\n};\n\nvar toISO = Date.prototype.toISOString;\n\nvar defaults = {\n    delimiter: '&',\n    encode: true,\n    encoder: utils.encode,\n    encodeValuesOnly: false,\n    serializeDate: function serializeDate(date) { // eslint-disable-line func-name-matching\n        return toISO.call(date);\n    },\n    skipNulls: false,\n    strictNullHandling: false\n};\n\nvar stringify = function stringify( // eslint-disable-line func-name-matching\n    object,\n    prefix,\n    generateArrayPrefix,\n    strictNullHandling,\n    skipNulls,\n    encoder,\n    filter,\n    sort,\n    allowDots,\n    serializeDate,\n    formatter,\n    encodeValuesOnly\n) {\n    var obj = object;\n    if (typeof filter === 'function') {\n        obj = filter(prefix, obj);\n    } else if (obj instanceof Date) {\n        obj = serializeDate(obj);\n    } else if (obj === null) {\n        if (strictNullHandling) {\n            return encoder && !encodeValuesOnly ? encoder(prefix, defaults.encoder) : prefix;\n        }\n\n        obj = '';\n    }\n\n    if (typeof obj === 'string' || typeof obj === 'number' || typeof obj === 'boolean' || utils.isBuffer(obj)) {\n        if (encoder) {\n            var keyValue = encodeValuesOnly ? prefix : encoder(prefix, defaults.encoder);\n            return [formatter(keyValue) + '=' + formatter(encoder(obj, defaults.encoder))];\n        }\n        return [formatter(prefix) + '=' + formatter(String(obj))];\n    }\n\n    var values = [];\n\n    if (typeof obj === 'undefined') {\n        return values;\n    }\n\n    var objKeys;\n    if (Array.isArray(filter)) {\n        objKeys = filter;\n    } else {\n        var keys = Object.keys(obj);\n        objKeys = sort ? keys.sort(sort) : keys;\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        if (Array.isArray(obj)) {\n            values = values.concat(stringify(\n                obj[key],\n                generateArrayPrefix(prefix, key),\n                generateArrayPrefix,\n                strictNullHandling,\n                skipNulls,\n                encoder,\n                filter,\n                sort,\n                allowDots,\n                serializeDate,\n                formatter,\n                encodeValuesOnly\n            ));\n        } else {\n            values = values.concat(stringify(\n                obj[key],\n                prefix + (allowDots ? '.' + key : '[' + key + ']'),\n                generateArrayPrefix,\n                strictNullHandling,\n                skipNulls,\n                encoder,\n                filter,\n                sort,\n                allowDots,\n                serializeDate,\n                formatter,\n                encodeValuesOnly\n            ));\n        }\n    }\n\n    return values;\n};\n\nmodule.exports = function (object, opts) {\n    var obj = object;\n    var options = opts ? utils.assign({}, opts) : {};\n\n    if (options.encoder !== null && options.encoder !== undefined && typeof options.encoder !== 'function') {\n        throw new TypeError('Encoder has to be a function.');\n    }\n\n    var delimiter = typeof options.delimiter === 'undefined' ? defaults.delimiter : options.delimiter;\n    var strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n    var skipNulls = typeof options.skipNulls === 'boolean' ? options.skipNulls : defaults.skipNulls;\n    var encode = typeof options.encode === 'boolean' ? options.encode : defaults.encode;\n    var encoder = typeof options.encoder === 'function' ? options.encoder : defaults.encoder;\n    var sort = typeof options.sort === 'function' ? options.sort : null;\n    var allowDots = typeof options.allowDots === 'undefined' ? false : options.allowDots;\n    var serializeDate = typeof options.serializeDate === 'function' ? options.serializeDate : defaults.serializeDate;\n    var encodeValuesOnly = typeof options.encodeValuesOnly === 'boolean' ? options.encodeValuesOnly : defaults.encodeValuesOnly;\n    if (typeof options.format === 'undefined') {\n        options.format = formats['default'];\n    } else if (!Object.prototype.hasOwnProperty.call(formats.formatters, options.format)) {\n        throw new TypeError('Unknown format option provided.');\n    }\n    var formatter = formats.formatters[options.format];\n    var objKeys;\n    var filter;\n\n    if (typeof options.filter === 'function') {\n        filter = options.filter;\n        obj = filter('', obj);\n    } else if (Array.isArray(options.filter)) {\n        filter = options.filter;\n        objKeys = filter;\n    }\n\n    var keys = [];\n\n    if (typeof obj !== 'object' || obj === null) {\n        return '';\n    }\n\n    var arrayFormat;\n    if (options.arrayFormat in arrayPrefixGenerators) {\n        arrayFormat = options.arrayFormat;\n    } else if ('indices' in options) {\n        arrayFormat = options.indices ? 'indices' : 'repeat';\n    } else {\n        arrayFormat = 'indices';\n    }\n\n    var generateArrayPrefix = arrayPrefixGenerators[arrayFormat];\n\n    if (!objKeys) {\n        objKeys = Object.keys(obj);\n    }\n\n    if (sort) {\n        objKeys.sort(sort);\n    }\n\n    for (var i = 0; i < objKeys.length; ++i) {\n        var key = objKeys[i];\n\n        if (skipNulls && obj[key] === null) {\n            continue;\n        }\n\n        keys = keys.concat(stringify(\n            obj[key],\n            key,\n            generateArrayPrefix,\n            strictNullHandling,\n            skipNulls,\n            encode ? encoder : null,\n            filter,\n            sort,\n            allowDots,\n            serializeDate,\n            formatter,\n            encodeValuesOnly\n        ));\n    }\n\n    var joined = keys.join(delimiter);\n    var prefix = options.addQueryPrefix === true ? '?' : '';\n\n    return joined.length > 0 ? prefix + joined : '';\n};\n","var baseAssignValue = require('./_baseAssignValue'),\n    createAggregator = require('./_createAggregator');\n\n/**\n * Creates an object composed of keys generated from the results of running\n * each element of `collection` thru `iteratee`. The corresponding value of\n * each key is the last element responsible for generating the key. The\n * iteratee is invoked with one argument: (value).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The iteratee to transform keys.\n * @returns {Object} Returns the composed aggregate object.\n * @example\n *\n * var array = [\n *   { 'dir': 'left', 'code': 97 },\n *   { 'dir': 'right', 'code': 100 }\n * ];\n *\n * _.keyBy(array, function(o) {\n *   return String.fromCharCode(o.code);\n * });\n * // => { 'a': { 'dir': 'left', 'code': 97 }, 'd': { 'dir': 'right', 'code': 100 } }\n *\n * _.keyBy(array, 'dir');\n * // => { 'left': { 'dir': 'left', 'code': 97 }, 'right': { 'dir': 'right', 'code': 100 } }\n */\nvar keyBy = createAggregator(function(result, value, key) {\n  baseAssignValue(result, key, value);\n});\n\nmodule.exports = keyBy;\n","var arrayFilter = require('./_arrayFilter'),\n    baseRest = require('./_baseRest'),\n    baseXor = require('./_baseXor'),\n    isArrayLikeObject = require('./isArrayLikeObject');\n\n/**\n * Creates an array of unique values that is the\n * [symmetric difference](https://en.wikipedia.org/wiki/Symmetric_difference)\n * of the given arrays. The order of result values is determined by the order\n * they occur in the arrays.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Array\n * @param {...Array} [arrays] The arrays to inspect.\n * @returns {Array} Returns the new array of filtered values.\n * @see _.difference, _.without\n * @example\n *\n * _.xor([2, 1], [2, 3]);\n * // => [1, 3]\n */\nvar xor = baseRest(function(arrays) {\n  return baseXor(arrayFilter(arrays, isArrayLikeObject));\n});\n\nmodule.exports = xor;\n","var isKeyable = require('./_isKeyable');\n\n/**\n * Gets the data for `map`.\n *\n * @private\n * @param {Object} map The map to query.\n * @param {string} key The reference key.\n * @returns {*} Returns the map data.\n */\nfunction getMapData(map, key) {\n  var data = map.__data__;\n  return isKeyable(key)\n    ? data[typeof key == 'string' ? 'string' : 'hash']\n    : data.map;\n}\n\nmodule.exports = getMapData;\n","/**\n * A specialized version of `_.some` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {boolean} Returns `true` if any element passes the predicate check,\n *  else `false`.\n */\nfunction arraySome(array, predicate) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (predicate(array[index], index, array)) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arraySome;\n","var DataView = require('./_DataView'),\n    Map = require('./_Map'),\n    Promise = require('./_Promise'),\n    Set = require('./_Set'),\n    WeakMap = require('./_WeakMap'),\n    baseGetTag = require('./_baseGetTag'),\n    toSource = require('./_toSource');\n\n/** `Object#toString` result references. */\nvar mapTag = '[object Map]',\n    objectTag = '[object Object]',\n    promiseTag = '[object Promise]',\n    setTag = '[object Set]',\n    weakMapTag = '[object WeakMap]';\n\nvar dataViewTag = '[object DataView]';\n\n/** Used to detect maps, sets, and weakmaps. */\nvar dataViewCtorString = toSource(DataView),\n    mapCtorString = toSource(Map),\n    promiseCtorString = toSource(Promise),\n    setCtorString = toSource(Set),\n    weakMapCtorString = toSource(WeakMap);\n\n/**\n * Gets the `toStringTag` of `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @returns {string} Returns the `toStringTag`.\n */\nvar getTag = baseGetTag;\n\n// Fallback for data views, maps, sets, and weak maps in IE 11 and promises in Node.js < 6.\nif ((DataView && getTag(new DataView(new ArrayBuffer(1))) != dataViewTag) ||\n    (Map && getTag(new Map) != mapTag) ||\n    (Promise && getTag(Promise.resolve()) != promiseTag) ||\n    (Set && getTag(new Set) != setTag) ||\n    (WeakMap && getTag(new WeakMap) != weakMapTag)) {\n  getTag = function(value) {\n    var result = baseGetTag(value),\n        Ctor = result == objectTag ? value.constructor : undefined,\n        ctorString = Ctor ? toSource(Ctor) : '';\n\n    if (ctorString) {\n      switch (ctorString) {\n        case dataViewCtorString: return dataViewTag;\n        case mapCtorString: return mapTag;\n        case promiseCtorString: return promiseTag;\n        case setCtorString: return setTag;\n        case weakMapCtorString: return weakMapTag;\n      }\n    }\n    return result;\n  };\n}\n\nmodule.exports = getTag;\n","'use strict';\n\nvar stringify = require('./stringify');\nvar parse = require('./parse');\nvar formats = require('./formats');\n\nmodule.exports = {\n    formats: formats,\n    parse: parse,\n    stringify: stringify\n};\n","/**\n * Copies the values of `source` to `array`.\n *\n * @private\n * @param {Array} source The array to copy values from.\n * @param {Array} [array=[]] The array to copy values to.\n * @returns {Array} Returns `array`.\n */\nfunction copyArray(source, array) {\n  var index = -1,\n      length = source.length;\n\n  array || (array = Array(length));\n  while (++index < length) {\n    array[index] = source[index];\n  }\n  return array;\n}\n\nmodule.exports = copyArray;\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper'),\n    InputOutputHelper = require('../../../helper/InputOutputHelper');\n\nvar utils = require('../../../Utils'),\n    escapeHTML = utils.escapeHTML,\n    triggerClickEvent = utils.triggerClickEvent;\n\nvar implementationType = require('./implementation/ImplementationType'),\n    delegate = require('./implementation/Delegate'),\n    external = require('./implementation/External'),\n    callable = require('./implementation/Callable'),\n    resultVariable = require('./implementation/ResultVariable');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domClasses = require('min-dom').classes;\n\nfunction getImplementationType(element) {\n  return ImplementationTypeHelper.getImplementationType(element);\n}\n\nfunction getBusinessObject(element) {\n  return ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n}\n\nfunction isDmnCapable(element) {\n  return ImplementationTypeHelper.isDmnCapable(element);\n}\n\nfunction isExternalCapable(element) {\n  return ImplementationTypeHelper.isExternalCapable(element);\n}\n\nfunction isServiceTaskLike(element) {\n  return ImplementationTypeHelper.isServiceTaskLike(element);\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!isServiceTaskLike(getBusinessObject(element))) {\n    return;\n  }\n\n  var hasDmnSupport = isDmnCapable(element);\n  var hasExternalSupport = isExternalCapable(getBusinessObject(element));\n\n  // implementation type ////////////////////////////////////\n\n  group.entries = group.entries.concat(implementationType(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType,\n    hasDmnSupport: hasDmnSupport,\n    hasExternalSupport: hasExternalSupport,\n    hasServiceTaskLikeSupport: true\n  }, translate));\n\n\n  // delegate (class, expression, delegateExpression) //////////\n\n  group.entries = group.entries.concat(delegate(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType\n  }, translate));\n\n\n  // result variable /////////////////////////////////////////\n\n  group.entries = group.entries.concat(resultVariable(element, bpmnFactory, {\n    getBusinessObject: getBusinessObject,\n    getImplementationType: getImplementationType,\n    hideResultVariable: function(element, node) {\n      return getImplementationType(element) !== 'expression';\n    }\n  }, translate));\n\n  // external //////////////////////////////////////////////////\n\n  if (hasExternalSupport) {\n    group.entries = group.entries.concat(external(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject,\n      getImplementationType: getImplementationType\n    }, translate));\n  }\n\n\n  // dmn ////////////////////////////////////////////////////////\n\n  if (hasDmnSupport) {\n    group.entries = group.entries.concat(callable(element, bpmnFactory, {\n      getCallableType: getImplementationType\n    }, translate));\n  }\n\n\n  // connector ////////////////////////////////////////////////\n\n  var isConnector = function(element) {\n    return getImplementationType(element) === 'connector';\n  };\n\n  group.entries.push(entryFactory.link({\n    id: 'configureConnectorLink',\n    label: translate('Configure Connector'),\n    handleClick: function(element, node, event) {\n\n      var connectorTabEl = getTabNode(node, 'connector');\n\n      if (connectorTabEl) {\n        triggerClickEvent(connectorTabEl);\n      }\n\n      // suppress actual link click\n      return false;\n    },\n    showLink: function(element, node) {\n      var link = domQuery('a', node);\n      link.textContent = '';\n\n      domClasses(link).remove('bpp-error-message');\n\n      if (isConnector(element)) {\n        var connectorId = InputOutputHelper.getConnector(element).get('connectorId');\n        if (connectorId) {\n          link.textContent = translate('Configure Connector');\n        } else {\n          link.innerHTML = '<span class=\"bpp-icon-warning\"></span> ' + escapeHTML(translate('Must configure Connector'));\n          domClasses(link).add('bpp-error-message');\n        }\n\n        return true;\n      }\n\n      return false;\n    }\n  }));\n\n};\n\n\n\n// helpers ///////////////////////////\n\nfunction getTabNode(el, id) {\n  var containerEl = domClosest(el, '.bpp-properties-panel');\n\n  return domQuery('a[data-tab-target=\"' + id + '\"]', containerEl);\n}","/**\n * The function whose prototype chain sequence wrappers inherit from.\n *\n * @private\n */\nfunction baseLodash() {\n  // No operation performed.\n}\n\nmodule.exports = baseLodash;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getTemplate = require('../Helper').getTemplate,\n    getTemplateId = require('../Helper').getTemplateId;\n\nvar find = require('lodash/find');\n\nvar TEMPLATE_ATTR = require('../Helper').TEMPLATE_ATTR;\n\nfunction isAny(element, types) {\n  return types.reduce(function(result, type) {\n    return result || is(element, type);\n  }, false);\n}\n\n\nmodule.exports = function(group, element, elementTemplates, translate) {\n\n  var options = getTemplateOptions(element, elementTemplates, translate);\n\n  if (options.length === 1 && !options[0].isDefault) {\n    return;\n  }\n\n  // select element template (via dropdown)\n  group.entries.push(entryFactory.selectBox({\n    id: 'elementTemplate-chooser',\n    label: translate('Element Template'),\n    modelProperty: 'camunda:modelerTemplate',\n    selectOptions: options,\n    set: function(element, properties) {\n      return applyTemplate(element, properties[TEMPLATE_ATTR], elementTemplates);\n    },\n    disabled: function() {\n      var template = getTemplate(element, elementTemplates);\n\n      return template && isDefaultTemplate(template);\n    }\n  }));\n\n};\n\n\n// helpers //////////////////////////////////////\n\nfunction applyTemplate(element, newTemplateId, elementTemplates) {\n\n  // cleanup\n  // clear input output mappings\n  // undo changes to properties defined in template\n\n  // re-establish\n  // set input output mappings\n  // apply changes to properties as defined in new template\n\n  var oldTemplate = getTemplate(element, elementTemplates),\n      newTemplate = elementTemplates.get(newTemplateId);\n\n  if (oldTemplate === newTemplate) {\n    return;\n  }\n\n  return {\n    cmd: 'propertiesPanel.camunda.changeTemplate',\n    context: {\n      element: element,\n      oldTemplate: oldTemplate,\n      newTemplate: newTemplate\n    }\n  };\n}\n\nfunction getTemplateOptions(element, elementTemplates, translate) {\n\n  var currentTemplateId = getTemplateId(element);\n\n  var emptyOption = {\n    name: '',\n    value: ''\n  };\n\n  var allOptions = elementTemplates.getAll().reduce(function(templates, t) {\n    if (!isAny(element, t.appliesTo)) {\n      return templates;\n    }\n\n    return templates.concat({\n      name: translate(t.name),\n      value: t.id,\n      isDefault: t.isDefault\n    });\n  }, [ emptyOption ]);\n\n\n  var defaultOption = find(allOptions, function(option) {\n    return isDefaultTemplate(option);\n  });\n\n  var currentOption = find(allOptions, function(option) {\n    return option.value === currentTemplateId;\n  });\n\n  if (currentTemplateId && !currentOption) {\n    currentOption = unknownTemplate(currentTemplateId, translate);\n\n    allOptions.push(currentOption);\n  }\n\n  if (!defaultOption) {\n\n    // return all options, including empty\n    // and optionally unknownTemplate option\n    return allOptions;\n  }\n\n  // special limited handling for\n  // default options\n\n  var options = [];\n\n  // current template not set\n  if (!currentTemplateId) {\n    options.push({\n      name: '',\n      value: ''\n    });\n  }\n\n  // current template not default\n  if (currentOption && currentOption !== defaultOption) {\n    options.push(currentOption);\n  }\n\n  options.push(defaultOption);\n\n  // [ (empty), (current), defaultOption ]\n  return options;\n}\n\nfunction unknownTemplate(templateId, translate) {\n  return {\n    name: translate('[unknown template: {templateId}]', { templateId: templateId }),\n    value: templateId\n  };\n}\n\nfunction isDefaultTemplate(elementTemplate) {\n  return elementTemplate.isDefault;\n}","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    createHybrid = require('./_createHybrid'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/**\n * Creates a function that wraps `func` to enable currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {number} arity The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createCurry(func, bitmask, arity) {\n  var Ctor = createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length,\n        placeholder = getHolder(wrapper);\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    var holders = (length < 3 && args[0] !== placeholder && args[length - 1] !== placeholder)\n      ? []\n      : replaceHolders(args, placeholder);\n\n    length -= holders.length;\n    if (length < arity) {\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, undefined,\n        args, holders, undefined, undefined, arity - length);\n    }\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return apply(fn, this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createCurry;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIsNaN = require('./_baseIsNaN'),\n    strictIndexOf = require('./_strictIndexOf');\n\n/**\n * The base implementation of `_.indexOf` without `fromIndex` bounds checks.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} value The value to search for.\n * @param {number} fromIndex The index to search from.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction baseIndexOf(array, value, fromIndex) {\n  return value === value\n    ? strictIndexOf(array, value, fromIndex)\n    : baseFindIndex(array, baseIsNaN, fromIndex);\n}\n\nmodule.exports = baseIndexOf;\n","var baseForOwn = require('./_baseForOwn'),\n    createBaseEach = require('./_createBaseEach');\n\n/**\n * The base implementation of `_.forEach` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n */\nvar baseEach = createBaseEach(baseForOwn);\n\nmodule.exports = baseEach;\n","var nativeCreate = require('./_nativeCreate');\n\n/**\n * Removes all key-value entries from the hash.\n *\n * @private\n * @name clear\n * @memberOf Hash\n */\nfunction hashClear() {\n  this.__data__ = nativeCreate ? nativeCreate(null) : {};\n  this.size = 0;\n}\n\nmodule.exports = hashClear;\n","'use strict';\n\nvar findExtension = require('../Helper').findExtension,\n    findExtensions = require('../Helper').findExtensions;\n\nvar createCamundaProperty = require('../CreateHelper').createCamundaProperty,\n    createInputParameter = require('../CreateHelper').createInputParameter,\n    createOutputParameter = require('../CreateHelper').createOutputParameter,\n    createCamundaIn = require('../CreateHelper').createCamundaIn,\n    createCamundaOut = require('../CreateHelper').createCamundaOut,\n    createCamundaInWithBusinessKey = require('../CreateHelper').createCamundaInWithBusinessKey,\n    createCamundaExecutionListenerScript = require('../CreateHelper').createCamundaExecutionListenerScript,\n    createCamundaFieldInjection = require('../CreateHelper').createCamundaFieldInjection;\n\nvar forEach = require('lodash/forEach');\n\nvar CAMUNDA_SERVICE_TASK_LIKE = [\n  'camunda:class',\n  'camunda:delegateExpression',\n  'camunda:expression'\n];\n\n/**\n * A handler that changes the modeling template of a BPMN element.\n */\nfunction ChangeElementTemplateHandler(modeling, commandStack, bpmnFactory) {\n\n  function getOrCreateExtensionElements(element) {\n\n    var bo = element.businessObject;\n\n    var extensionElements = bo.extensionElements;\n\n    // add extension elements\n    if (!extensionElements) {\n      extensionElements = bpmnFactory.create('bpmn:ExtensionElements', {\n        values: []\n      });\n\n      modeling.updateProperties(element, {\n        extensionElements: extensionElements\n      });\n    }\n\n    return extensionElements;\n  }\n\n  function updateModelerTemplate(element, newTemplate) {\n    modeling.updateProperties(element, {\n      'camunda:modelerTemplate': newTemplate && newTemplate.id\n    });\n  }\n\n  function updateIoMappings(element, newTemplate, context) {\n\n    var newMappings = createInputOutputMappings(newTemplate, bpmnFactory),\n        oldMappings;\n\n    if (!newMappings) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { inputOutput: newMappings }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldMappings = findExtension(element, 'camunda:InputOutput');\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: [ newMappings ],\n        objectsToRemove: oldMappings ? [ oldMappings ] : []\n      });\n    }\n  }\n\n  function updateCamundaField(element, newTemplate, context) {\n\n    var newMappings = createCamundaFieldInjections(newTemplate, bpmnFactory),\n        oldMappings;\n\n    if (!newMappings) {\n      return;\n    }\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { field: newMappings }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldMappings = findExtensions(element, ['camunda:Field']);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newMappings,\n        objectsToRemove: oldMappings ? oldMappings : []\n      });\n    }\n  }\n\n\n  function updateCamundaProperties(element, newTemplate, context) {\n\n    var newProperties = createCamundaProperties(newTemplate, bpmnFactory),\n        oldProperties;\n\n    if (!newProperties) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { properties: newProperties }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldProperties = findExtension(element, 'camunda:Properties');\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: [ newProperties ],\n        objectsToRemove: oldProperties ? [ oldProperties ] : []\n      });\n    }\n  }\n\n  function updateProperties(element, newTemplate, context) {\n\n    var newProperties = createBpmnPropertyUpdates(newTemplate, bpmnFactory);\n\n    var newPropertiesCount = Object.keys(newProperties).length;\n\n    if (!newPropertiesCount) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: newProperties\n      });\n    } else {\n      modeling.updateProperties(element, newProperties);\n    }\n  }\n\n  function updateInOut(element, newTemplate, context) {\n\n    var newInOut = createCamundaInOut(newTemplate, bpmnFactory),\n        oldInOut;\n\n    if (!newInOut) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { inout: newInOut }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldInOut = findExtensions(context, [ 'camunda:In', 'camunda:Out' ]);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newInOut,\n        objectsToRemove: oldInOut\n      });\n    }\n  }\n\n  function updateExecutionListener(element, newTemplate, context) {\n\n    var newExecutionListeners = createCamundaExecutionListeners(newTemplate, bpmnFactory),\n        oldExecutionsListeners;\n\n    if (!newExecutionListeners.length) {\n      return;\n    }\n\n    if (context) {\n      commandStack.execute('properties-panel.update-businessobject', {\n        element: element,\n        businessObject: context,\n        properties: { executionListener: newExecutionListeners }\n      });\n    } else {\n      context = getOrCreateExtensionElements(element);\n      oldExecutionsListeners = findExtensions(context, [ 'camunda:ExecutionListener' ]);\n\n      commandStack.execute('properties-panel.update-businessobject-list', {\n        element: element,\n        currentObject: context,\n        propertyName: 'values',\n        objectsToAdd: newExecutionListeners,\n        objectsToRemove: oldExecutionsListeners\n      });\n    }\n  }\n\n  /**\n   * Update / recreate a scoped element.\n   *\n   * @param {djs.model.Base} element the diagram parent element\n   * @param {String} scopeName name of the scope, i.e. camunda:Connector\n   * @param {Object} scopeDefinition\n   */\n  function updateScopeElements(element, scopeName, scopeDefinition) {\n\n    var scopeElement = bpmnFactory.create(scopeName);\n\n    // update camunda:inputOutput\n    updateIoMappings(element, scopeDefinition, scopeElement);\n\n    // update camunda:field\n    updateCamundaField(element, scopeDefinition, scopeElement);\n\n    // update camunda:properties\n    updateCamundaProperties(element, scopeDefinition, scopeElement);\n\n    // update other properties (bpmn:condition, camunda:async, ...)\n    updateProperties(element, scopeDefinition, scopeElement);\n\n    // update camunda:in and camunda:out\n    updateInOut(element, scopeDefinition, scopeElement);\n\n    // update camunda:executionListener\n    updateExecutionListener(element, scopeDefinition, scopeElement);\n\n    var extensionElements = getOrCreateExtensionElements(element);\n    var oldScope = findExtension(extensionElements, scopeName);\n\n    commandStack.execute('properties-panel.update-businessobject-list', {\n      element: element,\n      currentObject: extensionElements,\n      propertyName: 'values',\n      objectsToAdd: [ scopeElement ],\n      objectsToRemove: oldScope ? [ oldScope ] : []\n    });\n  }\n\n  /**\n   * Compose an element template change action, updating all\n   * necessary underlying properties.\n   *\n   * @param {Object} context\n   * @param {Object} context.element\n   * @param {Object} context.oldTemplate\n   * @param {Object} context.newTemplate\n   */\n  this.preExecute = function(context) {\n\n    var element = context.element,\n        newTemplate = context.newTemplate;\n\n    // update camunda:modelerTemplate attribute\n    updateModelerTemplate(element, newTemplate);\n\n    if (newTemplate) {\n\n      // update camunda:inputOutput\n      updateIoMappings(element, newTemplate);\n\n      // update camunda:field\n      updateCamundaField(element, newTemplate);\n\n      // update camunda:properties\n      updateCamundaProperties(element, newTemplate);\n\n      // update other properties (bpmn:condition, camunda:async, ...)\n      updateProperties(element, newTemplate);\n\n      // update camunda:in and camunda:out\n      updateInOut(element, newTemplate);\n\n      // update camunda:executionListener\n      updateExecutionListener(element, newTemplate);\n\n      // loop on scopes properties\n      forEach(newTemplate.scopes, function(scopeDefinition, scopeName) {\n        updateScopeElements(element, scopeName, scopeDefinition);\n      });\n\n    }\n  };\n}\n\nChangeElementTemplateHandler.$inject = [ 'modeling', 'commandStack', 'bpmnFactory' ];\n\nmodule.exports = ChangeElementTemplateHandler;\n\n\n\n// helpers /////////////////////////////\n\nfunction createBpmnPropertyUpdates(template, bpmnFactory) {\n\n  var propertyUpdates = {};\n\n  template.properties.forEach(function(p) {\n\n    var binding = p.binding,\n        bindingTarget = binding.name,\n        propertyValue;\n\n    if (binding.type === 'property') {\n\n      if (bindingTarget === 'conditionExpression') {\n        propertyValue = bpmnFactory.create('bpmn:FormalExpression', {\n          body: p.value,\n          language: binding.scriptFormat\n        });\n      } else {\n        propertyValue = p.value;\n      }\n\n      // assigning camunda:async to true|false\n      // assigning bpmn:conditionExpression to { $type: 'bpmn:FormalExpression', ... }\n      propertyUpdates[bindingTarget] = propertyValue;\n\n      // make sure we unset other \"implementation types\"\n      // when applying a camunda:class template onto a preconfigured\n      // camunda:delegateExpression element\n      if (CAMUNDA_SERVICE_TASK_LIKE.indexOf(bindingTarget) !== -1) {\n        CAMUNDA_SERVICE_TASK_LIKE.forEach(function(prop) {\n          if (prop !== bindingTarget) {\n            propertyUpdates[prop] = undefined;\n          }\n        });\n      }\n    }\n  });\n\n  return propertyUpdates;\n}\n\nfunction createCamundaFieldInjections(template, bpmnFactory) {\n  var injections = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n    if (bindingType === 'camunda:field') {\n      injections.push(createCamundaFieldInjection(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  if (injections.length) {\n    return injections;\n  }\n}\n\nfunction createCamundaProperties(template, bpmnFactory) {\n\n  var properties = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:property') {\n      properties.push(createCamundaProperty(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  if (properties.length) {\n    return bpmnFactory.create('camunda:Properties', {\n      values: properties\n    });\n  }\n}\n\nfunction createInputOutputMappings(template, bpmnFactory) {\n\n  var inputParameters = [],\n      outputParameters = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:inputParameter') {\n      inputParameters.push(createInputParameter(\n        binding, p.value, bpmnFactory\n      ));\n    }\n\n    if (bindingType === 'camunda:outputParameter') {\n      outputParameters.push(createOutputParameter(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  // do we need to create new ioMappings (?)\n  if (outputParameters.length || inputParameters.length) {\n    return bpmnFactory.create('camunda:InputOutput', {\n      inputParameters: inputParameters,\n      outputParameters: outputParameters\n    });\n  }\n}\n\nfunction createCamundaInOut(template, bpmnFactory) {\n\n  var inOuts = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:in') {\n      inOuts.push(createCamundaIn(\n        binding, p.value, bpmnFactory\n      ));\n    } else\n    if (bindingType === 'camunda:out') {\n      inOuts.push(createCamundaOut(\n        binding, p.value, bpmnFactory\n      ));\n    } else\n    if (bindingType === 'camunda:in:businessKey') {\n      inOuts.push(createCamundaInWithBusinessKey(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  return inOuts;\n}\n\n\nfunction createCamundaExecutionListeners(template, bpmnFactory) {\n\n  var executionListener = [];\n\n  template.properties.forEach(function(p) {\n    var binding = p.binding,\n        bindingType = binding.type;\n\n    if (bindingType === 'camunda:executionListener') {\n      executionListener.push(createCamundaExecutionListenerScript(\n        binding, p.value, bpmnFactory\n      ));\n    }\n  });\n\n  return executionListener;\n}\n","var toFinite = require('./toFinite');\n\n/**\n * Converts `value` to an integer.\n *\n * **Note:** This method is loosely based on\n * [`ToInteger`](http://www.ecma-international.org/ecma-262/7.0/#sec-tointeger).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted integer.\n * @example\n *\n * _.toInteger(3.2);\n * // => 3\n *\n * _.toInteger(Number.MIN_VALUE);\n * // => 0\n *\n * _.toInteger(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toInteger('3.2');\n * // => 3\n */\nfunction toInteger(value) {\n  var result = toFinite(value),\n      remainder = result % 1;\n\n  return result === result ? (remainder ? result - remainder : result) : 0;\n}\n\nmodule.exports = toInteger;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar multiInstanceLoopCharacteristics = require('./implementation/MultiInstanceLoopCharacteristics');\n\nvar jobRetryTimeCycle = require('./implementation/JobRetryTimeCycle'),\n    asyncContinuation = require('./implementation/AsyncContinuation');\n\n\nfunction getLoopCharacteristics(element) {\n  var bo = getBusinessObject(element);\n  return bo.loopCharacteristics;\n}\n\n\nfunction ensureMultiInstanceSupported(element) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n  return !!loopCharacteristics && is(loopCharacteristics, 'camunda:Collectable');\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!ensureMultiInstanceSupported(element)) {\n    return;\n  }\n\n  // multi instance properties\n  group.entries = group.entries.concat(multiInstanceLoopCharacteristics(element, bpmnFactory, translate));\n\n  // async continuation ///////////////////////////////////////////////////////\n  group.entries = group.entries.concat(asyncContinuation(element, bpmnFactory, {\n    getBusinessObject: getLoopCharacteristics,\n    idPrefix: 'multiInstance-',\n    labelPrefix: translate('Multi Instance ')\n  }, translate));\n\n\n  // retry time cycle //////////////////////////////////////////////////////////\n  group.entries = group.entries.concat(jobRetryTimeCycle(element, bpmnFactory, {\n    getBusinessObject: getLoopCharacteristics,\n    idPrefix: 'multiInstance-',\n    labelPrefix: translate('Multi Instance ')\n  }, translate));\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textBox = function(options, defaultParameters) {\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      canBeShown = !!options.show && typeof options.show === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' + label + '</label>' +\n    '<div class=\"bpp-field-wrapper\" ' +\n    (canBeShown ? 'data-show=\"isShown\"' : '') +\n    '>' +\n      '<div contenteditable=\"true\" id=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n            'name=\"' + escapeHTML(options.modelProperty) + '\" />' +\n    '</div>';\n\n  // add description below text box entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  if (canBeShown) {\n    resource.isShown = function() {\n      return options.show.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-textbox'];\n\n  return resource;\n};\n\nmodule.exports = textBox;\n","'use strict';\nvar $ = require('../internals/export');\nvar $filter = require('../internals/array-iteration').filter;\nvar arrayMethodHasSpeciesSupport = require('../internals/array-method-has-species-support');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar HAS_SPECIES_SUPPORT = arrayMethodHasSpeciesSupport('filter');\n// Edge 14- issue\nvar USES_TO_LENGTH = arrayMethodUsesToLength('filter');\n\n// `Array.prototype.filter` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.filter\n// with adding support of @@species\n$({ target: 'Array', proto: true, forced: !HAS_SPECIES_SUPPORT || !USES_TO_LENGTH }, {\n  filter: function filter(callbackfn /* , thisArg */) {\n    return $filter(this, callbackfn, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","var getWrapDetails = require('./_getWrapDetails'),\n    insertWrapDetails = require('./_insertWrapDetails'),\n    setToString = require('./_setToString'),\n    updateWrapDetails = require('./_updateWrapDetails');\n\n/**\n * Sets the `toString` method of `wrapper` to mimic the source of `reference`\n * with wrapper details in a comment at the top of the source body.\n *\n * @private\n * @param {Function} wrapper The function to modify.\n * @param {Function} reference The reference function.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Function} Returns `wrapper`.\n */\nfunction setWrapToString(wrapper, reference, bitmask) {\n  var source = (reference + '');\n  return setToString(wrapper, insertWrapDetails(source, updateWrapDetails(getWrapDetails(source), bitmask)));\n}\n\nmodule.exports = setWrapToString;\n","'use strict';\n\nvar map = require('lodash/map');\n\nvar extensionElementsHelper = require('./ExtensionElementsHelper');\n\n/**\n * Returns true if the attribute 'camunda:asyncBefore' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isAsyncBefore(bo) {\n  return !!(bo.get('camunda:asyncBefore') || bo.get('camunda:async'));\n}\n\nmodule.exports.isAsyncBefore = isAsyncBefore;\n\n/**\n * Returns true if the attribute 'camunda:asyncAfter' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isAsyncAfter(bo) {\n  return !!bo.get('camunda:asyncAfter');\n}\n\nmodule.exports.isAsyncAfter = isAsyncAfter;\n\n/**\n * Returns true if the attribute 'camunda:exclusive' is set\n * to true.\n *\n * @param  {ModdleElement} bo\n *\n * @return {boolean} a boolean value\n */\nfunction isExclusive(bo) {\n  return !!bo.get('camunda:exclusive');\n}\n\nmodule.exports.isExclusive = isExclusive;\n\n/**\n * Get first 'camunda:FailedJobRetryTimeCycle' from the business object.\n *\n * @param  {ModdleElement} bo\n *\n * @return {Array<ModdleElement>} a list of 'camunda:FailedJobRetryTimeCycle'\n */\nfunction getFailedJobRetryTimeCycle(bo) {\n  return (extensionElementsHelper.getExtensionElements(bo, 'camunda:FailedJobRetryTimeCycle') || [])[0];\n}\n\nmodule.exports.getFailedJobRetryTimeCycle = getFailedJobRetryTimeCycle;\n\n/**\n * Removes all existing 'camunda:FailedJobRetryTimeCycle' from the business object\n *\n * @param  {ModdleElement} bo\n *\n * @return {Array<ModdleElement>} a list of 'camunda:FailedJobRetryTimeCycle'\n */\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  var retryTimeCycles = extensionElementsHelper.getExtensionElements(bo, 'camunda:FailedJobRetryTimeCycle');\n  return map(retryTimeCycles, function(cycle) {\n    return extensionElementsHelper.removeEntry(bo, element, cycle);\n  });\n}\n\nmodule.exports.removeFailedJobRetryTimeCycle = removeFailedJobRetryTimeCycle;","var arrayAggregator = require('./_arrayAggregator'),\n    baseAggregator = require('./_baseAggregator'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Creates a function like `_.groupBy`.\n *\n * @private\n * @param {Function} setter The function to set accumulator values.\n * @param {Function} [initializer] The accumulator object initializer.\n * @returns {Function} Returns the new aggregator function.\n */\nfunction createAggregator(setter, initializer) {\n  return function(collection, iteratee) {\n    var func = isArray(collection) ? arrayAggregator : baseAggregator,\n        accumulator = initializer ? initializer() : {};\n\n    return func(collection, setter, baseIteratee(iteratee, 2), accumulator);\n  };\n}\n\nmodule.exports = createAggregator;\n","var arrayEach = require('./_arrayEach'),\n    baseCreate = require('./_baseCreate'),\n    baseForOwn = require('./_baseForOwn'),\n    baseIteratee = require('./_baseIteratee'),\n    getPrototype = require('./_getPrototype'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isFunction = require('./isFunction'),\n    isObject = require('./isObject'),\n    isTypedArray = require('./isTypedArray');\n\n/**\n * An alternative to `_.reduce`; this method transforms `object` to a new\n * `accumulator` object which is the result of running each of its own\n * enumerable string keyed properties thru `iteratee`, with each invocation\n * potentially mutating the `accumulator` object. If `accumulator` is not\n * provided, a new object with the same `[[Prototype]]` will be used. The\n * iteratee is invoked with four arguments: (accumulator, value, key, object).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @static\n * @memberOf _\n * @since 1.3.0\n * @category Object\n * @param {Object} object The object to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @param {*} [accumulator] The custom accumulator value.\n * @returns {*} Returns the accumulated value.\n * @example\n *\n * _.transform([2, 3, 4], function(result, n) {\n *   result.push(n *= n);\n *   return n % 2 == 0;\n * }, []);\n * // => [4, 9]\n *\n * _.transform({ 'a': 1, 'b': 2, 'c': 1 }, function(result, value, key) {\n *   (result[value] || (result[value] = [])).push(key);\n * }, {});\n * // => { '1': ['a', 'c'], '2': ['b'] }\n */\nfunction transform(object, iteratee, accumulator) {\n  var isArr = isArray(object),\n      isArrLike = isArr || isBuffer(object) || isTypedArray(object);\n\n  iteratee = baseIteratee(iteratee, 4);\n  if (accumulator == null) {\n    var Ctor = object && object.constructor;\n    if (isArrLike) {\n      accumulator = isArr ? new Ctor : [];\n    }\n    else if (isObject(object)) {\n      accumulator = isFunction(Ctor) ? baseCreate(getPrototype(object)) : {};\n    }\n    else {\n      accumulator = {};\n    }\n  }\n  (isArrLike ? arrayEach : baseForOwn)(object, function(value, index, object) {\n    return iteratee(accumulator, value, index, object);\n  });\n  return accumulator;\n}\n\nmodule.exports = transform;\n","/**\n * The base implementation of `_.times` without support for iteratee shorthands\n * or max array length checks.\n *\n * @private\n * @param {number} n The number of times to invoke `iteratee`.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the array of results.\n */\nfunction baseTimes(n, iteratee) {\n  var index = -1,\n      result = Array(n);\n\n  while (++index < n) {\n    result[index] = iteratee(index);\n  }\n  return result;\n}\n\nmodule.exports = baseTimes;\n","var baseFindIndex = require('./_baseFindIndex'),\n    baseIteratee = require('./_baseIteratee'),\n    toInteger = require('./toInteger');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * This method is like `_.find` except that it returns the index of the first\n * element `predicate` returns truthy for instead of the element itself.\n *\n * @static\n * @memberOf _\n * @since 1.1.0\n * @category Array\n * @param {Array} array The array to inspect.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @param {number} [fromIndex=0] The index to search from.\n * @returns {number} Returns the index of the found element, else `-1`.\n * @example\n *\n * var users = [\n *   { 'user': 'barney',  'active': false },\n *   { 'user': 'fred',    'active': false },\n *   { 'user': 'pebbles', 'active': true }\n * ];\n *\n * _.findIndex(users, function(o) { return o.user == 'barney'; });\n * // => 0\n *\n * // The `_.matches` iteratee shorthand.\n * _.findIndex(users, { 'user': 'fred', 'active': false });\n * // => 1\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.findIndex(users, ['active', false]);\n * // => 0\n *\n * // The `_.property` iteratee shorthand.\n * _.findIndex(users, 'active');\n * // => 2\n */\nfunction findIndex(array, predicate, fromIndex) {\n  var length = array == null ? 0 : array.length;\n  if (!length) {\n    return -1;\n  }\n  var index = fromIndex == null ? 0 : toInteger(fromIndex);\n  if (index < 0) {\n    index = nativeMax(length + index, 0);\n  }\n  return baseFindIndex(array, baseIteratee(predicate, 3), index);\n}\n\nmodule.exports = findIndex;\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, signalEventDefinition, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, signalEventDefinition, bpmnFactory, {\n    label: translate('Signal'),\n    elementName: 'signal',\n    elementType: 'bpmn:Signal',\n    referenceProperty: 'signalRef',\n    newElementIdPrefix: 'Signal_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, signalEventDefinition, bpmnFactory, {\n    id: 'signal-element-name',\n    label: translate('Signal Name'),\n    referenceProperty: 'signalRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n};\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business object lists which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectListHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nUpdateBusinessObjectListHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = UpdateBusinessObjectListHandler;\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + 'required');\n  }\n  return prop;\n}\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a element under a provided parent.\n */\nUpdateBusinessObjectListHandler.prototype.execute = function(context) {\n\n  var currentObject = ensureNotNull(context.currentObject, 'currentObject'),\n      propertyName = ensureNotNull(context.propertyName, 'propertyName'),\n      updatedObjectList = context.updatedObjectList,\n      objectsToRemove = context.objectsToRemove || [],\n      objectsToAdd = context.objectsToAdd || [],\n      changed = [ context.element], // this will not change any diagram-js elements\n      referencePropertyName;\n\n  if (context.referencePropertyName) {\n    referencePropertyName = context.referencePropertyName;\n  }\n\n  var objectList = currentObject[propertyName];\n  // adjust array reference in the parent business object\n  context.previousList = currentObject[propertyName];\n\n  if (updatedObjectList) {\n    currentObject[propertyName] = updatedObjectList;\n  } else {\n    var listCopy = [];\n    // remove all objects which should be removed\n    forEach(objectList, function(object) {\n      if (objectsToRemove.indexOf(object) == -1) {\n        listCopy.push(object);\n      }\n    });\n    // add all objects which should be added\n    listCopy = listCopy.concat(objectsToAdd);\n\n    // set property to new list\n    if (listCopy.length > 0 || !referencePropertyName) {\n\n      // as long as there are elements in the list update the list\n      currentObject[propertyName] = listCopy;\n    } else if (referencePropertyName) {\n\n      // remove the list when it is empty\n      var parentObject = currentObject.$parent;\n      parentObject.set(referencePropertyName, undefined);\n    }\n  }\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateBusinessObjectListHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectListHandler.prototype.revert = function(context) {\n\n  var currentObject = context.currentObject,\n      propertyName = context.propertyName,\n      previousList = context.previousList,\n      parentObject = currentObject.$parent;\n\n  if (context.referencePropertyName) {\n    parentObject.set(context.referencePropertyName, currentObject);\n  }\n\n  // remove new element\n  currentObject.set(propertyName, previousList);\n\n  return context.changed;\n};\n","'use strict';\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar extensionElementsHelper = require('./ExtensionElementsHelper'),\n    implementationTypeHelper = require('./ImplementationTypeHelper');\n\nvar InputOutputHelper = {};\n\nmodule.exports = InputOutputHelper;\n\nfunction getElements(bo, type, prop) {\n  var elems = extensionElementsHelper.getExtensionElements(bo, type) || [];\n  return !prop ? elems : (elems[0] || {})[prop] || [];\n}\n\nfunction getParameters(element, prop, insideConnector) {\n  var inputOutput = InputOutputHelper.getInputOutput(element, insideConnector);\n  return (inputOutput && inputOutput.get(prop)) || [];\n}\n\n/**\n * Get a inputOutput from the business object\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {ModdleElement} the inputOutput object\n */\nInputOutputHelper.getInputOutput = function(element, insideConnector) {\n  if (!insideConnector) {\n    var bo = getBusinessObject(element);\n    return (getElements(bo, 'camunda:InputOutput') || [])[0];\n  }\n  var connector = this.getConnector(element);\n  return connector && connector.get('inputOutput');\n};\n\n/**\n * Get a connector from the business object\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement} the connector object\n */\nInputOutputHelper.getConnector = function(element) {\n  var bo = implementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n  return bo && (getElements(bo, 'camunda:Connector') || [])[0];\n};\n\n/**\n * Return all input parameters existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {Array} a list of input parameter objects\n */\nInputOutputHelper.getInputParameters = function(element, insideConnector) {\n  return getParameters.apply(this, [ element, 'inputParameters', insideConnector ]);\n};\n\n/**\n * Return all output parameters existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {Array} a list of output parameter objects\n */\nInputOutputHelper.getOutputParameters = function(element, insideConnector) {\n  return getParameters.apply(this, [ element, 'outputParameters', insideConnector ]);\n};\n\n/**\n * Get a input parameter from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n * @param {number} idx\n *\n * @return {ModdleElement} input parameter\n */\nInputOutputHelper.getInputParameter = function(element, insideConnector, idx) {\n  return this.getInputParameters(element, insideConnector)[idx];\n};\n\n/**\n * Get a output parameter from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n * @param {number} idx\n *\n * @return {ModdleElement} output parameter\n */\nInputOutputHelper.getOutputParameter = function(element, insideConnector, idx) {\n  return this.getOutputParameters(element, insideConnector)[idx];\n};\n\n/**\n * Returns 'true' if the given element supports inputOutput\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {boolean} a boolean value\n */\nInputOutputHelper.isInputOutputSupported = function(element, insideConnector) {\n\n  if (insideConnector) {\n    return true;\n  }\n\n  var bo = getBusinessObject(element);\n\n  return (\n    is(bo, 'bpmn:FlowNode') && !(\n      is(bo, 'bpmn:StartEvent') ||\n      is(bo, 'bpmn:Gateway') ||\n      is(bo, 'bpmn:BoundaryEvent') ||\n      (\n        is(bo, 'bpmn:SubProcess') && bo.get('triggeredByEvent')\n      )\n    )\n  );\n};\n\n/**\n * Returns 'true' if the given element supports output parameters\n *\n * @param {djs.model.Base} element\n * @param  {boolean} insideConnector\n *\n * @return {boolean} a boolean value\n */\nInputOutputHelper.areOutputParametersSupported = function(element, insideConnector) {\n  var bo = getBusinessObject(element);\n  return insideConnector || (!is(bo, 'bpmn:EndEvent') && !bo.loopCharacteristics);\n};\n","/**\n * Checks if a stack value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Stack\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction stackHas(key) {\n  return this.__data__.has(key);\n}\n\nmodule.exports = stackHas;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementReferenceProperty = require('../../../bpmn/parts/implementation/ElementReferenceProperty');\n\nmodule.exports = function(\n    group, element, bpmnFactory, errorEventDefinition,\n    showErrorCodeVariable, showErrorMessageVariable, translate\n) {\n\n\n  var getValue = function(modelProperty) {\n    return function(element) {\n      var modelPropertyValue = errorEventDefinition.get('camunda:' + modelProperty);\n      var value = {};\n\n      value[modelProperty] = modelPropertyValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values) {\n      var props = {};\n\n      props['camunda:' + modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, errorEventDefinition, props);\n    };\n  };\n\n\n  group.entries = group.entries.concat(\n    elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n      id: 'error-element-message',\n      label: translate('Error Message'),\n      referenceProperty: 'errorRef',\n      modelProperty: 'errorMessage'\n    })\n  );\n\n  if (showErrorCodeVariable) {\n    group.entries.push(entryFactory.textField({\n      id: 'errorCodeVariable',\n      label: translate('Error Code Variable'),\n      modelProperty : 'errorCodeVariable',\n\n      get: getValue('errorCodeVariable'),\n      set: setValue('errorCodeVariable')\n    }));\n  }\n\n  if (showErrorMessageVariable) {\n    group.entries.push(entryFactory.textField({\n      id: 'errorMessageVariable',\n      label: translate('Error Message Variable'),\n      modelProperty: 'errorMessageVariable',\n\n      get: getValue('errorMessageVariable'),\n      set: setValue('errorMessageVariable')\n    }));\n  }\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar cmdHelper = require('../helper/CmdHelper');\n\nvar domQuery = require('min-dom').query,\n    domAttr = require('min-dom').attr,\n    domClosest = require('min-dom').closest;\n\nvar filter = require('lodash/filter'),\n    forEach = require('lodash/forEach'),\n    keys = require('lodash/keys');\n\nvar domify = require('min-dom').domify;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\nvar updateSelection = require('selection-update');\n\nvar TABLE_ROW_DIV_SNIPPET = '<div class=\"bpp-field-wrapper bpp-table-row\">';\nvar DELETE_ROW_BUTTON_SNIPPET = '<button class=\"clear\" data-action=\"deleteElement\">' +\n                                  '<span>X</span>' +\n                                '</button>';\n\nfunction createInputRowTemplate(properties, canRemove) {\n  var template = TABLE_ROW_DIV_SNIPPET;\n  template += createInputTemplate(properties, canRemove);\n  template += canRemove ? DELETE_ROW_BUTTON_SNIPPET : '';\n  template += '</div>';\n\n  return template;\n}\n\nfunction createInputTemplate(properties, canRemove) {\n  var columns = properties.length;\n  var template = '';\n  forEach(properties, function(prop) {\n    template += '<input class=\"bpp-table-row-columns-' + columns + ' ' +\n                               (canRemove ? 'bpp-table-row-removable' : '') + '\" ' +\n                       'id=\"camunda-table-row-cell-input-value\" ' +\n                       'type=\"text\" ' +\n                       'name=\"' + escapeHTML(prop) + '\" />';\n  });\n  return template;\n}\n\nfunction createLabelRowTemplate(labels) {\n  var template = TABLE_ROW_DIV_SNIPPET;\n  template += createLabelTemplate(labels);\n  template += '</div>';\n\n  return template;\n}\n\nfunction createLabelTemplate(labels) {\n  var columns = labels.length;\n  var template = '';\n  forEach(labels, function(label) {\n    template += '<label class=\"bpp-table-row-columns-' + columns + '\">' + escapeHTML(label) + '</label>';\n  });\n  return template;\n}\n\nfunction pick(elements, properties) {\n  return (elements || []).map(function(elem) {\n    var newElement = {};\n    forEach(properties, function(prop) {\n      newElement[prop] = elem[prop] || '';\n    });\n    return newElement;\n  });\n}\n\nfunction diff(element, node, values, oldValues, editable) {\n  return filter(values, function(value, idx) {\n    return !valueEqual(element, node, value, oldValues[idx], editable, idx);\n  });\n}\n\nfunction valueEqual(element, node, value, oldValue, editable, idx) {\n  if (value && !oldValue) {\n    return false;\n  }\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    var n = value[key] || undefined;\n    var o = oldValue[key] || undefined;\n    return !editable(element, node, key, idx) || n === o;\n  });\n}\n\nfunction getEntryNode(node) {\n  return domClosest(node, '[data-entry]', true);\n}\n\nfunction getContainer(node) {\n  return domQuery('div[data-list-entry-container]', node);\n}\n\nfunction getSelection(node) {\n  return {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction setSelection(node, selection) {\n  node.selectionStart = selection.start;\n  node.selectionEnd = selection.end;\n}\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} options.description\n * @param  {Array<string>} options.modelProperties\n * @param  {Array<string>} options.labels\n * @param  {Function} options.getElements - this callback function must return a list of business object items\n * @param  {Function} options.removeElement\n * @param  {Function} options.addElement\n * @param  {Function} options.updateElement\n * @param  {Function} options.editable\n * @param  {Function} options.setControlValue\n * @param  {Function} options.show\n *\n * @return {Object}\n */\nmodule.exports = function(options) {\n\n  var id = options.id,\n      modelProperties = options.modelProperties,\n      labels = options.labels,\n      description = options.description;\n\n  var labelRow = createLabelRowTemplate(labels);\n\n  var getElements = options.getElements;\n\n  var removeElement = options.removeElement,\n      canRemove = typeof removeElement === 'function';\n\n  var addElement = options.addElement,\n      canAdd = typeof addElement === 'function',\n      addLabel = options.addLabel || 'Add Value';\n\n  var updateElement = options.updateElement,\n      canUpdate = typeof updateElement === 'function';\n\n  var editable = options.editable || function() { return true; },\n      setControlValue = options.setControlValue;\n\n  var show = options.show,\n      canBeShown = typeof show === 'function';\n\n  var elements = function(element, node) {\n    return pick(getElements(element, node), modelProperties);\n  };\n\n  var factory = {\n    id: id,\n    html: (canAdd ?\n      '<div class=\"bpp-table-add-row\" ' + (canBeShown ? 'data-show=\"show\"' : '') + '>' +\n            '<label>' + escapeHTML(addLabel) + '</label>' +\n            '<button class=\"add\" data-action=\"addElement\"><span>+</span></button>' +\n          '</div>' : '') +\n          '<div class=\"bpp-table\" data-show=\"showTable\">' +\n            '<div class=\"bpp-field-wrapper bpp-table-row\">' +\n               labelRow +\n            '</div>' +\n            '<div data-list-entry-container>' +\n            '</div>' +\n          '</div>' +\n\n          // add description below table entry field\n          (description ? entryFieldDescription(description) : ''),\n\n    get: function(element, node) {\n      var boElements = elements(element, node, this.__invalidValues);\n\n      var invalidValues = this.__invalidValues;\n\n      delete this.__invalidValues;\n\n      forEach(invalidValues, function(value, idx) {\n        var element = boElements[idx];\n\n        forEach(modelProperties, function(prop) {\n          element[prop] = value[prop];\n        });\n      });\n\n      return boElements;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action || {};\n      delete this.__action;\n\n      if (action.id === 'delete-element') {\n        return removeElement(element, node, action.idx);\n      }\n      else if (action.id === 'add-element') {\n        return addElement(element, node);\n      }\n      else if (canUpdate) {\n        var commands = [],\n            valuesToValidate = values;\n\n        if (typeof options.validate !== 'function') {\n          valuesToValidate = diff(element, node, values, elements(element, node), editable);\n        }\n\n        var self = this;\n\n        forEach(valuesToValidate, function(value) {\n          var validationError,\n              idx = values.indexOf(value);\n\n          if (typeof options.validate === 'function') {\n            validationError = options.validate(element, value, node, idx);\n          }\n\n          if (!validationError) {\n            var cmd = updateElement(element, value, node, idx);\n\n            if (cmd) {\n              commands.push(cmd);\n            }\n          } else {\n            // cache invalid value in an object by index as key\n            self.__invalidValues = self.__invalidValues || {};\n            self.__invalidValues[idx] = value;\n\n            // execute a command, which does not do anything\n            commands.push(cmdHelper.updateProperties(element, {}));\n          }\n        });\n\n        return commands;\n      }\n    },\n    createListEntryTemplate: function(value, index, selectBox) {\n      return createInputRowTemplate(modelProperties, canRemove);\n    },\n\n    addElement: function(element, node, event, scopeNode) {\n      var template = domify(createInputRowTemplate(modelProperties, canRemove));\n\n      var container = getContainer(node);\n      container.appendChild(template);\n\n      this.__action = {\n        id: 'add-element'\n      };\n\n      return true;\n    },\n\n    deleteElement: function(element, node, event, scopeNode) {\n      var container = getContainer(node);\n      var rowToDelete = event.delegateTarget.parentNode;\n      var idx = parseInt(domAttr(rowToDelete, 'data-index'), 10);\n\n      container.removeChild(rowToDelete);\n\n      this.__action = {\n        id: 'delete-element',\n        idx: idx\n      };\n\n      return true;\n    },\n\n    editable: function(element, rowNode, input, prop, value, idx) {\n      var entryNode = domClosest(rowNode, '[data-entry]');\n      return editable(element, entryNode, prop, idx);\n    },\n\n    show: function(element, entryNode, node, scopeNode) {\n      entryNode = getEntryNode(entryNode);\n      return show(element, entryNode, node, scopeNode);\n    },\n\n    showTable: function(element, entryNode, node, scopeNode) {\n      entryNode = getEntryNode(entryNode);\n      var elems = elements(element, entryNode);\n      return elems && elems.length && (!canBeShown || show(element, entryNode, node, scopeNode));\n    },\n\n    validateListItem: function(element, value, node, idx) {\n      if (typeof options.validate === 'function') {\n        return options.validate(element, value, node, idx);\n      }\n    }\n\n  };\n\n  // Update/set the selection on the correct position.\n  // It's the same code like for an input value in the PropertiesPanel.js.\n  if (setControlValue) {\n    factory.setControlValue = function(element, rowNode, input, prop, value, idx) {\n      var entryNode = getEntryNode(rowNode);\n\n      var isReadOnly = domAttr(input, 'readonly');\n      var oldValue = input.value;\n\n      var selection;\n\n      // prevents input fields from having the value 'undefined'\n      if (value === undefined) {\n        value = '';\n      }\n\n      // when the attribute 'readonly' exists, ignore the comparison\n      // with 'oldValue' and 'value'\n      if (!!isReadOnly && oldValue === value) {\n        return;\n      }\n\n      // update selection on undo/redo\n      if (document.activeElement === input) {\n        selection = updateSelection(getSelection(input), oldValue, value);\n      }\n\n      setControlValue(element, entryNode, input, prop, value, idx);\n\n      if (selection) {\n        setSelection(input, selection);\n      }\n\n    };\n  }\n\n  return factory;\n\n};\n","var overArg = require('./_overArg');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeKeys = overArg(Object.keys, Object);\n\nmodule.exports = nativeKeys;\n","/**\n * Gets the argument placeholder value for `func`.\n *\n * @private\n * @param {Function} func The function to inspect.\n * @returns {*} Returns the placeholder value.\n */\nfunction getHolder(func) {\n  var object = func;\n  return object.placeholder;\n}\n\nmodule.exports = getHolder;\n","/** Detect free variable `global` from Node.js. */\nvar freeGlobal = typeof global == 'object' && global && global.Object === Object && global;\n\nmodule.exports = freeGlobal;\n","'use strict';\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper');\n\nvar fieldInjection = require('./implementation/FieldInjection');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var bo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  var fieldInjectionEntry = fieldInjection(element, bpmnFactory, translate, { businessObject: bo });\n\n  if (fieldInjectionEntry && fieldInjectionEntry.length > 0) {\n    group.entries = group.entries.concat(fieldInjectionEntry);\n  }\n\n};\n","var arrayPush = require('./_arrayPush'),\n    isFlattenable = require('./_isFlattenable');\n\n/**\n * The base implementation of `_.flatten` with support for restricting flattening.\n *\n * @private\n * @param {Array} array The array to flatten.\n * @param {number} depth The maximum recursion depth.\n * @param {boolean} [predicate=isFlattenable] The function invoked per iteration.\n * @param {boolean} [isStrict] Restrict to values that pass `predicate` checks.\n * @param {Array} [result=[]] The initial result value.\n * @returns {Array} Returns the new flattened array.\n */\nfunction baseFlatten(array, depth, predicate, isStrict, result) {\n  var index = -1,\n      length = array.length;\n\n  predicate || (predicate = isFlattenable);\n  result || (result = []);\n\n  while (++index < length) {\n    var value = array[index];\n    if (depth > 0 && predicate(value)) {\n      if (depth > 1) {\n        // Recursively flatten arrays (susceptible to call stack limits).\n        baseFlatten(value, depth - 1, predicate, isStrict, result);\n      } else {\n        arrayPush(result, value);\n      }\n    } else if (!isStrict) {\n      result[result.length] = value;\n    }\n  }\n  return result;\n}\n\nmodule.exports = baseFlatten;\n","var baseIteratee = require('./_baseIteratee'),\n    isArrayLike = require('./isArrayLike'),\n    keys = require('./keys');\n\n/**\n * Creates a `_.find` or `_.findLast` function.\n *\n * @private\n * @param {Function} findIndexFunc The function to find the collection index.\n * @returns {Function} Returns the new find function.\n */\nfunction createFind(findIndexFunc) {\n  return function(collection, predicate, fromIndex) {\n    var iterable = Object(collection);\n    if (!isArrayLike(collection)) {\n      var iteratee = baseIteratee(predicate, 3);\n      collection = keys(collection);\n      predicate = function(key) { return iteratee(iterable[key], key, iterable); };\n    }\n    var index = findIndexFunc(collection, predicate, fromIndex);\n    return index > -1 ? iterable[iteratee ? collection[index] : index] : undefined;\n  };\n}\n\nmodule.exports = createFind;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    scriptImplementation = require('./implementation/Script');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var bo;\n\n  if (is(element, 'bpmn:ScriptTask')) {\n    bo = getBusinessObject(element);\n  }\n\n  if (!bo) {\n    return;\n  }\n\n  var script = scriptImplementation('scriptFormat', 'script', false, translate);\n  group.entries.push({\n    id: 'script-implementation',\n    label: translate('Script'),\n    html: script.template,\n\n    get: function(element) {\n      return script.get(element, bo);\n    },\n\n    set: function(element, values, containerElement) {\n      var properties = script.set(element, values, containerElement);\n\n      return cmdHelper.updateProperties(element, properties);\n    },\n\n    validate: function(element, values) {\n      return script.validate(element, values);\n    },\n\n    script : script,\n\n    cssClasses: ['bpp-textfield']\n\n  });\n\n  group.entries.push(entryFactory.textField({\n    id : 'scriptResultVariable',\n    label : translate('Result Variable'),\n    modelProperty : 'scriptResultVariable',\n\n    get: function(element, propertyName) {\n      var boResultVariable = bo.get('camunda:resultVariable');\n\n      return { scriptResultVariable : boResultVariable };\n    },\n\n    set: function(element, values, containerElement) {\n      return cmdHelper.updateProperties(element, {\n        'camunda:resultVariable': values.scriptResultVariable.length\n          ? values.scriptResultVariable\n          : undefined\n      });\n    }\n\n  }));\n\n};\n","var listCacheClear = require('./_listCacheClear'),\n    listCacheDelete = require('./_listCacheDelete'),\n    listCacheGet = require('./_listCacheGet'),\n    listCacheHas = require('./_listCacheHas'),\n    listCacheSet = require('./_listCacheSet');\n\n/**\n * Creates an list cache object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction ListCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `ListCache`.\nListCache.prototype.clear = listCacheClear;\nListCache.prototype['delete'] = listCacheDelete;\nListCache.prototype.get = listCacheGet;\nListCache.prototype.has = listCacheHas;\nListCache.prototype.set = listCacheSet;\n\nmodule.exports = ListCache;\n","/**\n * This function is like `arrayIncludes` except that it accepts a comparator.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @param {Function} comparator The comparator invoked per element.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludesWith(array, value, comparator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (comparator(value, array[index])) {\n      return true;\n    }\n  }\n  return false;\n}\n\nmodule.exports = arrayIncludesWith;\n","'use strict';\n\n/**\n * The label factory provides a label entry. For the label text\n * it expects either a string provided by the options.labelText\n * parameter or it could be generated programmatically using a\n * function passed as the options.get parameter.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.labelText]\n * @param  {Function} [options.get]\n * @param  {Function} [options.showLabel]\n * @param  {Boolean} [options.divider] adds a divider at the top of the label if true; default: false\n */\nvar label = function(options) {\n  return {\n    id: options.id,\n    html: '<label data-value=\"label\" ' +\n            'data-show=\"showLabel\" ' +\n            'class=\"entry-label' + (options.divider ? ' divider' : '') + '\">' +\n          '</label>',\n    get: function(element, node) {\n      if (typeof options.get === 'function') {\n        return options.get(element, node);\n      }\n      return { label: options.labelText };\n    },\n    showLabel: function(element, node) {\n      if (typeof options.showLabel === 'function') {\n        return options.showLabel(element, node);\n      }\n      return true;\n    }\n  };\n};\n\nmodule.exports = label;\n","var getNative = require('./_getNative');\n\n/* Built-in method references that are verified to be native. */\nvar nativeCreate = getNative(Object, 'create');\n\nmodule.exports = nativeCreate;\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/** Used as references for the maximum length and index of an array. */\nvar MAX_ARRAY_LENGTH = 4294967295;\n\n/**\n * Creates a lazy wrapper object which wraps `value` to enable lazy evaluation.\n *\n * @private\n * @constructor\n * @param {*} value The value to wrap.\n */\nfunction LazyWrapper(value) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__dir__ = 1;\n  this.__filtered__ = false;\n  this.__iteratees__ = [];\n  this.__takeCount__ = MAX_ARRAY_LENGTH;\n  this.__views__ = [];\n}\n\n// Ensure `LazyWrapper` is an instance of `baseLodash`.\nLazyWrapper.prototype = baseCreate(baseLodash.prototype);\nLazyWrapper.prototype.constructor = LazyWrapper;\n\nmodule.exports = LazyWrapper;\n","module.exports = function(module) {\n\tif (!module.webpackPolyfill) {\n\t\tmodule.deprecate = function() {};\n\t\tmodule.paths = [];\n\t\t// module.parent = undefined by default\n\t\tif (!module.children) module.children = [];\n\t\tObject.defineProperty(module, \"loaded\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.l;\n\t\t\t}\n\t\t});\n\t\tObject.defineProperty(module, \"id\", {\n\t\t\tenumerable: true,\n\t\t\tget: function() {\n\t\t\t\treturn module.i;\n\t\t\t}\n\t\t});\n\t\tmodule.webpackPolyfill = 1;\n\t}\n\treturn module;\n};\n","var toNumber = require('./toNumber');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0,\n    MAX_INTEGER = 1.7976931348623157e+308;\n\n/**\n * Converts `value` to a finite number.\n *\n * @static\n * @memberOf _\n * @since 4.12.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {number} Returns the converted number.\n * @example\n *\n * _.toFinite(3.2);\n * // => 3.2\n *\n * _.toFinite(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toFinite(Infinity);\n * // => 1.7976931348623157e+308\n *\n * _.toFinite('3.2');\n * // => 3.2\n */\nfunction toFinite(value) {\n  if (!value) {\n    return value === 0 ? value : 0;\n  }\n  value = toNumber(value);\n  if (value === INFINITY || value === -INFINITY) {\n    var sign = (value < 0 ? -1 : 1);\n    return sign * MAX_INTEGER;\n  }\n  return value === value ? value : 0;\n}\n\nmodule.exports = toFinite;\n","var baseIsMatch = require('./_baseIsMatch'),\n    getMatchData = require('./_getMatchData'),\n    matchesStrictComparable = require('./_matchesStrictComparable');\n\n/**\n * The base implementation of `_.matches` which doesn't clone `source`.\n *\n * @private\n * @param {Object} source The object of property values to match.\n * @returns {Function} Returns the new spec function.\n */\nfunction baseMatches(source) {\n  var matchData = getMatchData(source);\n  if (matchData.length == 1 && matchData[0][2]) {\n    return matchesStrictComparable(matchData[0][0], matchData[0][1]);\n  }\n  return function(object) {\n    return object === source || baseIsMatch(object, source, matchData);\n  };\n}\n\nmodule.exports = baseMatches;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    escapeHTML = require('../../../Utils').escapeHTML,\n    domQuery = require('min-dom').query,\n    cmdHelper = require('../../../helper/CmdHelper'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper'),\n    scriptImplementation = require('./implementation/Script');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n  if (!(is(element, 'bpmn:SequenceFlow') && isConditionalSource(element.source))\n    && !conditionalEventDefinition) {\n    return;\n  }\n\n  var script = scriptImplementation('language', 'body', true, translate);\n  group.entries.push({\n    id: 'condition',\n    label: translate('Condition'),\n    html: '<div class=\"bpp-row\">' +\n              '<label for=\"cam-condition-type\">'+ escapeHTML(translate('Condition Type')) + '</label>' +\n              '<div class=\"bpp-field-wrapper\">' +\n                '<select id=\"cam-condition-type\" name=\"conditionType\" data-value>' +\n                  '<option value=\"expression\">'+ escapeHTML(translate('Expression')) + '</option>' +\n                  '<option value=\"script\">'+ escapeHTML(translate('Script')) + '</option>' +\n                  '<option value=\"\" selected></option>' +\n                '</select>' +\n              '</div>' +\n            '</div>' +\n\n            // expression\n            '<div class=\"bpp-row\">' +\n              '<label for=\"cam-condition\" data-show=\"isExpression\">' + escapeHTML(translate('Expression')) + '</label>' +\n              '<div class=\"bpp-field-wrapper\" data-show=\"isExpression\">' +\n                '<input id=\"cam-condition\" type=\"text\" name=\"condition\" />' +\n                '<button class=\"clear\" data-action=\"clear\" data-show=\"canClear\">' +\n                  '<span>X</span>' +\n                '</button>' +\n              '</div>' +\n              '<div data-show=\"isScript\">' +\n                script.template +\n              '</div>' +\n            '</div>',\n\n    get: function(element, propertyName) {\n      var conditionalEventDefinition = eventDefinitionHelper.getConditionalEventDefinition(element);\n\n      var conditionExpression = conditionalEventDefinition\n        ? conditionalEventDefinition.condition\n        : bo.conditionExpression;\n\n      var values = {},\n          conditionType = '';\n\n      if (conditionExpression) {\n        var conditionLanguage = conditionExpression.language;\n        if (typeof conditionLanguage !== 'undefined') {\n          conditionType = 'script';\n          values = script.get(element, conditionExpression);\n        } else {\n          conditionType = 'expression';\n          values.condition = conditionExpression.get('body');\n        }\n      }\n\n      values.conditionType = conditionType;\n\n      return values;\n\n    },\n\n    set: function(element, values, containerElement) {\n      var conditionType = values.conditionType;\n      var commands = [];\n\n      var conditionProps = {\n        body: undefined\n      };\n\n      if (conditionType === 'script') {\n        conditionProps = script.set(element, values, containerElement);\n      } else {\n        var condition = values.condition;\n\n        conditionProps.body = condition;\n      }\n\n      var conditionOrConditionExpression;\n\n      if (conditionType) {\n        conditionOrConditionExpression = elementHelper.createElement(\n          'bpmn:FormalExpression',\n          conditionProps,\n          conditionalEventDefinition || bo,\n          bpmnFactory\n        );\n\n        var source = element.source;\n\n        // if default-flow, remove default-property from source\n        if (source && source.businessObject.default === bo) {\n          commands.push(cmdHelper.updateProperties(source, { 'default': undefined }));\n        }\n      }\n\n      var update = conditionalEventDefinition\n        ? { condition: conditionOrConditionExpression }\n        : { conditionExpression: conditionOrConditionExpression };\n\n      commands.push(cmdHelper.updateBusinessObject(element, conditionalEventDefinition || bo, update));\n\n      return commands;\n    },\n\n    validate: function(element, values) {\n      var validationResult = {};\n\n      if (!values.condition && values.conditionType === 'expression') {\n        validationResult.condition = translate('Must provide a value');\n      }\n      else if (values.conditionType === 'script') {\n        validationResult = script.validate(element, values);\n      }\n\n      return validationResult;\n    },\n\n    isExpression: function(element, inputNode) {\n      var conditionType = domQuery('select[name=conditionType]', inputNode);\n      if (conditionType.selectedIndex >= 0) {\n        return conditionType.options[conditionType.selectedIndex].value === 'expression';\n      }\n    },\n\n    isScript: function(element, inputNode) {\n      var conditionType = domQuery('select[name=conditionType]', inputNode);\n      if (conditionType.selectedIndex >= 0) {\n        return conditionType.options[conditionType.selectedIndex].value === 'script';\n      }\n    },\n\n    clear: function(element, inputNode) {\n      // clear text input\n      domQuery('input[name=condition]', inputNode).value='';\n\n      return true;\n    },\n\n    canClear: function(element, inputNode) {\n      var input = domQuery('input[name=condition]', inputNode);\n\n      return input.value !== '';\n    },\n\n    script : script,\n\n    cssClasses: [ 'bpp-textfield' ]\n  });\n};\n\n\n// utilities //////////////////////////\n\nvar CONDITIONAL_SOURCES = [\n  'bpmn:Activity',\n  'bpmn:ExclusiveGateway',\n  'bpmn:InclusiveGateway',\n  'bpmn:ComplexGateway'\n];\n\nfunction isConditionalSource(element) {\n  return isAny(element, CONDITIONAL_SOURCES);\n}\n","var castPath = require('./_castPath'),\n    toKey = require('./_toKey');\n\n/**\n * The base implementation of `_.get` without support for default values.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @returns {*} Returns the resolved value.\n */\nfunction baseGet(object, path) {\n  path = castPath(path, object);\n\n  var index = 0,\n      length = path.length;\n\n  while (object != null && index < length) {\n    object = object[toKey(path[index++])];\n  }\n  return (index && index == length) ? object : undefined;\n}\n\nmodule.exports = baseGet;\n","var isObject = require('../internals/is-object');\nvar isArray = require('../internals/is-array');\nvar wellKnownSymbol = require('../internals/well-known-symbol');\n\nvar SPECIES = wellKnownSymbol('species');\n\n// `ArraySpeciesCreate` abstract operation\n// https://tc39.github.io/ecma262/#sec-arrayspeciescreate\nmodule.exports = function (originalArray, length) {\n  var C;\n  if (isArray(originalArray)) {\n    C = originalArray.constructor;\n    // cross-realm fallback\n    if (typeof C == 'function' && (C === Array || isArray(C.prototype))) C = undefined;\n    else if (isObject(C)) {\n      C = C[SPECIES];\n      if (C === null) C = undefined;\n    }\n  } return new (C === undefined ? Array : C)(length === 0 ? 0 : length);\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var jobPriorityEntry = entryFactory.textField({\n    id: 'jobPriority',\n    label: translate('Job Priority'),\n    modelProperty: 'jobPriority',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        jobPriority: bo.get('camunda:jobPriority')\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:jobPriority': values.jobPriority || undefined\n      });\n    }\n\n  });\n\n  return [ jobPriorityEntry ];\n\n};\n","/**\n * Checks if `value` is classified as an `Array` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array, else `false`.\n * @example\n *\n * _.isArray([1, 2, 3]);\n * // => true\n *\n * _.isArray(document.body.children);\n * // => false\n *\n * _.isArray('abc');\n * // => false\n *\n * _.isArray(_.noop);\n * // => false\n */\nvar isArray = Array.isArray;\n\nmodule.exports = isArray;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Sets the list cache `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf ListCache\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the list cache instance.\n */\nfunction listCacheSet(key, value) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    ++this.size;\n    data.push([key, value]);\n  } else {\n    data[index][1] = value;\n  }\n  return this;\n}\n\nmodule.exports = listCacheSet;\n","module.exports = {\n  __depends__: [\n    require('./cmd'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [\n    'customElementsPropertiesActivator',\n    'elementTemplatesLoader'\n  ],\n  customElementsPropertiesActivator: [ 'type', require('./CustomElementsPropertiesActivator') ],\n  elementTemplates: [ 'type', require('./ElementTemplates') ],\n  elementTemplatesLoader: [ 'type', require('./ElementTemplatesLoader') ]\n};\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that verifies that there are no disconnected\n * flow elements, i.e. elements without incoming\n * _or_ outgoing sequence flows\n */\nmodule.exports = function() {\n\n  const keyed = {};\n\n  const outgoingReported = {};\n  const incomingReported = {};\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SequenceFlow')) {\n      return;\n    }\n\n    const key = flowKey(node);\n\n    if (key in keyed) {\n      reporter.report(node.id, 'SequenceFlow is a duplicate');\n\n      const sourceId = node.sourceRef.id;\n      const targetId = node.targetRef.id;\n\n      console.log(sourceId, targetId);\n\n      if (!outgoingReported[sourceId]) {\n        reporter.report(sourceId, 'Duplicate outgoing sequence flows');\n\n        outgoingReported[sourceId] = true;\n      }\n\n      if (!incomingReported[targetId]) {\n        reporter.report(targetId, 'Duplicate incoming sequence flows');\n\n        incomingReported[targetId] = true;\n      }\n    } else {\n      keyed[key] = node;\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////\n\nfunction flowKey(flow) {\n  const conditionExpression = flow.conditionExpression;\n\n  const condition = conditionExpression ? conditionExpression.body : '';\n  const source = flow.sourceRef ? flow.sourceRef.id : flow.id;\n  const target = flow.targetRef ? flow.targetRef.id : flow.id;\n\n  return source + '#' + target + '#' + condition;\n}","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks that start events inside an event sub-process\n * are typed.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:SubProcess') || !node.triggeredByEvent) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    flowElements.forEach(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      if (eventDefinitions.length === 0) {\n        reporter.report(flowElement.id, 'Start event is missing event definition');\n      }\n    });\n  }\n\n  return {\n    check\n  };\n\n};","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"file-upload-window\"},[_c('el-upload',{ref:\"upload\",staticClass:\"upload-demo\",attrs:{\"action\":\"\",\"http-request\":_vm.uploadSectionFile,\"multiple\":\"\",\"file-list\":_vm.fileList,\"auto-upload\":false}},[_c('el-button',{attrs:{\"slot\":\"trigger\",\"size\":\"small\",\"type\":\"primary\"},slot:\"trigger\"},[_vm._v(\"选取文件\")]),_c('el-button',{staticStyle:{\"margin-left\":\"10px\"},attrs:{\"size\":\"small\",\"type\":\"success\"},on:{\"click\":_vm.submitUpload}},[_vm._v(\"上传到服务器\")])],1)],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"file-upload-window\">\r\n        <el-upload\r\n                class=\"upload-demo\"\r\n                ref=\"upload\"\r\n                action=\"\"\r\n                :http-request=\"uploadSectionFile\"\r\n                multiple\r\n                :file-list=\"fileList\"\r\n                :auto-upload=\"false\">\r\n            <el-button slot=\"trigger\" size=\"small\" type=\"primary\">选取文件</el-button>\r\n            <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload\">上传到服务器</el-button>\r\n            <!--  <div slot=\"tip\" class=\"el-upload__tip\">只能上传jpg/png文件，且不超过500kb</div>-->\r\n        </el-upload>\r\n    </div>\r\n\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        name: \"FileUpload\",\r\n        data() {\r\n            return {\r\n                //fileList: [{name: 'food.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100'}, {name: 'food2.jpeg', url: 'https://fuss10.elemecdn.com/3/63/4e7f3a15429bfda99bce42a18cdd1jpeg.jpeg?imageMogr2/thumbnail/360x360/format/webp/quality/100'}]\r\n                formData:[],\r\n                fileList:[]\r\n            };\r\n        },\r\n        methods: {\r\n            submitUpload() {\r\n                console.log(\"submitUpload\");\r\n                this.formData = new FormData();\r\n                this.$refs.upload.submit();\r\n                console.log(\"AFTERSUBMIT\");\r\n                console.log(this.formData);\r\n\r\n                if(this.fileList.length>0){\r\n                    this.$axios({\r\n                        method: 'post',\r\n                        url: 'http://backend-java:8090/upload/uploadFiles',\r\n                        //url: 'http://lxc-backend-java.ingress.isa.buaanlsde.cn/upload/uploadFiles',\r\n                        //lxc\r\n                        // headers: {\r\n                        //     'Content-Type': 'multipart/form-data'\r\n                        // },\r\n                        data: this.formData\r\n                    })\r\n                }\r\n\r\n            },\r\n\r\n            uploadSectionFile(param) {\r\n                console.log(param.file);\r\n                this.fileList.push(param.file)\r\n                console.log(\"uploadSectionFile\");\r\n                this.formData.append('files',param.file)\r\n                //var fileObj = param.file;\r\n            }\r\n        }\r\n    }\r\n</script>\r\n\r\n<style scoped>\r\n    .file-upload-window {        \r\n        width: 400px;\r\n    }\r\n</style>","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./FileUpload.vue?vue&type=template&id=8d3627ba&scoped=true&\"\nimport script from \"./FileUpload.vue?vue&type=script&lang=js&\"\nexport * from \"./FileUpload.vue?vue&type=script&lang=js&\"\nimport style0 from \"./FileUpload.vue?vue&type=style&index=0&id=8d3627ba&scoped=true&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"8d3627ba\",\n  null\n  \n)\n\nexport default component.exports","var assocIndexOf = require('./_assocIndexOf');\n\n/** Used for built-in method references. */\nvar arrayProto = Array.prototype;\n\n/** Built-in value references. */\nvar splice = arrayProto.splice;\n\n/**\n * Removes `key` and its value from the list cache.\n *\n * @private\n * @name delete\n * @memberOf ListCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction listCacheDelete(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  if (index < 0) {\n    return false;\n  }\n  var lastIndex = data.length - 1;\n  if (index == lastIndex) {\n    data.pop();\n  } else {\n    splice.call(data, index, 1);\n  }\n  --this.size;\n  return true;\n}\n\nmodule.exports = listCacheDelete;\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    countHolders = require('./_countHolders'),\n    createCtor = require('./_createCtor'),\n    createRecurry = require('./_createRecurry'),\n    getHolder = require('./_getHolder'),\n    reorder = require('./_reorder'),\n    replaceHolders = require('./_replaceHolders'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_ARY_FLAG = 128,\n    WRAP_FLIP_FLAG = 512;\n\n/**\n * Creates a function that wraps `func` to invoke it with optional `this`\n * binding of `thisArg`, partial application, and currying.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [partialsRight] The arguments to append to those provided\n *  to the new function.\n * @param {Array} [holdersRight] The `partialsRight` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createHybrid(func, bitmask, thisArg, partials, holders, partialsRight, holdersRight, argPos, ary, arity) {\n  var isAry = bitmask & WRAP_ARY_FLAG,\n      isBind = bitmask & WRAP_BIND_FLAG,\n      isBindKey = bitmask & WRAP_BIND_KEY_FLAG,\n      isCurried = bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG),\n      isFlip = bitmask & WRAP_FLIP_FLAG,\n      Ctor = isBindKey ? undefined : createCtor(func);\n\n  function wrapper() {\n    var length = arguments.length,\n        args = Array(length),\n        index = length;\n\n    while (index--) {\n      args[index] = arguments[index];\n    }\n    if (isCurried) {\n      var placeholder = getHolder(wrapper),\n          holdersCount = countHolders(args, placeholder);\n    }\n    if (partials) {\n      args = composeArgs(args, partials, holders, isCurried);\n    }\n    if (partialsRight) {\n      args = composeArgsRight(args, partialsRight, holdersRight, isCurried);\n    }\n    length -= holdersCount;\n    if (isCurried && length < arity) {\n      var newHolders = replaceHolders(args, placeholder);\n      return createRecurry(\n        func, bitmask, createHybrid, wrapper.placeholder, thisArg,\n        args, newHolders, argPos, ary, arity - length\n      );\n    }\n    var thisBinding = isBind ? thisArg : this,\n        fn = isBindKey ? thisBinding[func] : func;\n\n    length = args.length;\n    if (argPos) {\n      args = reorder(args, argPos);\n    } else if (isFlip && length > 1) {\n      args.reverse();\n    }\n    if (isAry && ary < length) {\n      args.length = ary;\n    }\n    if (this && this !== root && this instanceof wrapper) {\n      fn = Ctor || createCtor(fn);\n    }\n    return fn.apply(thisBinding, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createHybrid;\n","var WeakMap = require('./_WeakMap');\n\n/** Used to store function metadata. */\nvar metaMap = WeakMap && new WeakMap;\n\nmodule.exports = metaMap;\n","var arrayEach = require('./_arrayEach'),\n    baseEach = require('./_baseEach'),\n    castFunction = require('./_castFunction'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection` and invokes `iteratee` for each element.\n * The iteratee is invoked with three arguments: (value, index|key, collection).\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * **Note:** As with other \"Collections\" methods, objects with a \"length\"\n * property are iterated like arrays. To avoid this behavior use `_.forIn`\n * or `_.forOwn` for object iteration.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @alias each\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array|Object} Returns `collection`.\n * @see _.forEachRight\n * @example\n *\n * _.forEach([1, 2], function(value) {\n *   console.log(value);\n * });\n * // => Logs `1` then `2`.\n *\n * _.forEach({ 'a': 1, 'b': 2 }, function(value, key) {\n *   console.log(key);\n * });\n * // => Logs 'a' then 'b' (iteration order is not guaranteed).\n */\nfunction forEach(collection, iteratee) {\n  var func = isArray(collection) ? arrayEach : baseEach;\n  return func(collection, castFunction(iteratee));\n}\n\nmodule.exports = forEach;\n","/**\n * Traverse a moddle tree, depth first from top to bottom\n * and call the passed visitor fn.\n *\n * @param {ModdleElement} element\n * @param {Function} fn\n */\nmodule.exports = function traverse(element, fn) {\n  fn(element);\n\n  var descriptor = element.$descriptor;\n\n  if (descriptor.isGeneric) {\n    return;\n  }\n\n  var containedProperties = descriptor.properties.filter(p => {\n    return !p.isAttr && !p.isReference && p.type !== 'String';\n  });\n\n  containedProperties.forEach(p => {\n    if (p.name in element) {\n      const propertyValue = element[p.name];\n\n      if (p.isMany) {\n        propertyValue.forEach(child => {\n          traverse(child, fn);\n        });\n      } else {\n        traverse(propertyValue, fn);\n      }\n    }\n  });\n};\n","var baseTimes = require('./_baseTimes'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isIndex = require('./_isIndex'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Creates an array of the enumerable property names of the array-like `value`.\n *\n * @private\n * @param {*} value The value to query.\n * @param {boolean} inherited Specify returning inherited property names.\n * @returns {Array} Returns the array of property names.\n */\nfunction arrayLikeKeys(value, inherited) {\n  var isArr = isArray(value),\n      isArg = !isArr && isArguments(value),\n      isBuff = !isArr && !isArg && isBuffer(value),\n      isType = !isArr && !isArg && !isBuff && isTypedArray(value),\n      skipIndexes = isArr || isArg || isBuff || isType,\n      result = skipIndexes ? baseTimes(value.length, String) : [],\n      length = result.length;\n\n  for (var key in value) {\n    if ((inherited || hasOwnProperty.call(value, key)) &&\n        !(skipIndexes && (\n           // Safari 9 has enumerable `arguments.length` in strict mode.\n           key == 'length' ||\n           // Node.js 0.10 has enumerable non-index properties on buffers.\n           (isBuff && (key == 'offset' || key == 'parent')) ||\n           // PhantomJS 2 has enumerable non-index properties on typed arrays.\n           (isType && (key == 'buffer' || key == 'byteLength' || key == 'byteOffset')) ||\n           // Skip index properties.\n           isIndex(key, length)\n        ))) {\n      result.push(key);\n    }\n  }\n  return result;\n}\n\nmodule.exports = arrayLikeKeys;\n","import inherits from 'inherits';\n\nimport Ids from 'ids';\n\nimport BaseViewer from './BaseViewer';\n\n\n/**\n * A base modeler for BPMN 2.0 diagrams.\n *\n * Have a look at {@link Modeler} for a bundle that includes actual features.\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function BaseModeler(options) {\n  BaseViewer.call(this, options);\n\n  // hook ID collection into the modeler\n  this.on('import.parse.complete', function(event) {\n    if (!event.error) {\n      this._collectIds(event.definitions, event.context);\n    }\n  }, this);\n\n  this.on('diagram.destroy', function() {\n    this.get('moddle').ids.clear();\n  }, this);\n}\n\ninherits(BaseModeler, BaseViewer);\n\n\n/**\n * Create a moddle instance, attaching ids to it.\n *\n * @param {Object} options\n */\nBaseModeler.prototype._createModdle = function(options) {\n  var moddle = BaseViewer.prototype._createModdle.call(this, options);\n\n  // attach ids to moddle to be able to track\n  // and validated ids in the BPMN 2.0 XML document\n  // tree\n  moddle.ids = new Ids([ 32, 36, 1 ]);\n\n  return moddle;\n};\n\n/**\n * Collect ids processed during parsing of the\n * definitions object.\n *\n * @param {ModdleElement} definitions\n * @param {Context} context\n */\nBaseModeler.prototype._collectIds = function(definitions, context) {\n\n  var moddle = definitions.$model,\n      ids = moddle.ids,\n      id;\n\n  // remove references from previous import\n  ids.clear();\n\n  for (id in context.elementsById) {\n    ids.claim(id, context.elementsById[id]);\n  }\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  event as domEvent,\n  closest as domClosest\n} from 'min-dom';\n\nimport Hammer from 'hammerjs';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar MIN_ZOOM = 0.2,\n    MAX_ZOOM = 4;\n\nvar mouseEvents = [\n  'mousedown',\n  'mouseup',\n  'mouseover',\n  'mouseout',\n  'click',\n  'dblclick'\n];\n\nfunction log() {\n\n  // console.log.apply(console, arguments);\n}\n\nfunction get(service, injector) {\n  return injector.get(service, false);\n}\n\nfunction stopEvent(event) {\n\n  event.preventDefault();\n  event.stopPropagation();\n\n  if (typeof event.stopImmediatePropagation === 'function') {\n    event.stopImmediatePropagation();\n  }\n}\n\n\nfunction createTouchRecognizer(node) {\n\n  function stopMouse(event) {\n\n    forEach(mouseEvents, function(e) {\n      domEvent.bind(node, e, stopEvent, true);\n    });\n  }\n\n  function allowMouse(event) {\n    setTimeout(function() {\n      forEach(mouseEvents, function(e) {\n        domEvent.unbind(node, e, stopEvent, true);\n      });\n    }, 500);\n  }\n\n  domEvent.bind(node, 'touchstart', stopMouse, true);\n  domEvent.bind(node, 'touchend', allowMouse, true);\n  domEvent.bind(node, 'touchcancel', allowMouse, true);\n\n  // A touch event recognizer that handles\n  // touch events only (we know, we can already handle\n  // mouse events out of the box)\n\n  var recognizer = new Hammer.Manager(node, {\n    inputClass: Hammer.TouchInput,\n    recognizers: []\n  });\n\n\n  var tap = new Hammer.Tap();\n  var pan = new Hammer.Pan({ threshold: 10 });\n  var press = new Hammer.Press();\n  var pinch = new Hammer.Pinch();\n\n  var doubleTap = new Hammer.Tap({ event: 'doubletap', taps: 2 });\n\n  pinch.requireFailure(pan);\n  pinch.requireFailure(press);\n\n  recognizer.add([ pan, press, pinch, doubleTap, tap ]);\n\n  recognizer.reset = function(force) {\n    var recognizers = this.recognizers,\n        session = this.session;\n\n    if (session.stopped) {\n      return;\n    }\n\n    log('recognizer', 'stop');\n\n    recognizer.stop(force);\n\n    setTimeout(function() {\n      var i, r;\n\n      log('recognizer', 'reset');\n      for (i = 0; (r = recognizers[i]); i++) {\n        r.reset();\n        r.state = 8; // FAILED STATE\n      }\n\n      session.curRecognizer = null;\n    }, 0);\n  };\n\n  recognizer.on('hammer.input', function(event) {\n    if (event.srcEvent.defaultPrevented) {\n      recognizer.reset(true);\n    }\n  });\n\n  return recognizer;\n}\n\n/**\n * A plugin that provides touch events for elements.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function TouchInteractionEvents(\n    injector, canvas, eventBus,\n    elementRegistry, interactionEvents) {\n\n  // optional integrations\n  var dragging = get('dragging', injector),\n      move = get('move', injector),\n      contextPad = get('contextPad', injector),\n      palette = get('palette', injector);\n\n  // the touch recognizer\n  var recognizer;\n\n  function handler(type) {\n\n    return function(event) {\n      log('element', type, event);\n\n      interactionEvents.fire(type, event);\n    };\n  }\n\n  function getGfx(target) {\n    var node = domClosest(target, 'svg, .djs-element', true);\n    return node;\n  }\n\n  function initEvents(svg) {\n\n    // touch recognizer\n    recognizer = createTouchRecognizer(svg);\n\n    recognizer.on('doubletap', handler('element.dblclick'));\n\n    recognizer.on('tap', handler('element.click'));\n\n    function startGrabCanvas(event) {\n\n      log('canvas', 'grab start');\n\n      var lx = 0, ly = 0;\n\n      function update(e) {\n\n        var dx = e.deltaX - lx,\n            dy = e.deltaY - ly;\n\n        canvas.scroll({ dx: dx, dy: dy });\n\n        lx = e.deltaX;\n        ly = e.deltaY;\n      }\n\n      function end(e) {\n        recognizer.off('panmove', update);\n        recognizer.off('panend', end);\n        recognizer.off('pancancel', end);\n\n        log('canvas', 'grab end');\n      }\n\n      recognizer.on('panmove', update);\n      recognizer.on('panend', end);\n      recognizer.on('pancancel', end);\n    }\n\n    function startGrab(event) {\n\n      var gfx = getGfx(event.target),\n          element = gfx && elementRegistry.get(gfx);\n\n      // recognizer\n      if (move && canvas.getRootElement() !== element) {\n        log('element', 'move start', element, event, true);\n        return move.start(event, element, true);\n      } else {\n        startGrabCanvas(event);\n      }\n    }\n\n    function startZoom(e) {\n\n      log('canvas', 'zoom start');\n\n      var zoom = canvas.zoom(),\n          mid = e.center;\n\n      function update(e) {\n\n        var ratio = 1 - (1 - e.scale) / 1.50,\n            newZoom = Math.max(MIN_ZOOM, Math.min(MAX_ZOOM, ratio * zoom));\n\n        canvas.zoom(newZoom, mid);\n\n        stopEvent(e);\n      }\n\n      function end(e) {\n        recognizer.off('pinchmove', update);\n        recognizer.off('pinchend', end);\n        recognizer.off('pinchcancel', end);\n\n        recognizer.reset(true);\n\n        log('canvas', 'zoom end');\n      }\n\n      recognizer.on('pinchmove', update);\n      recognizer.on('pinchend', end);\n      recognizer.on('pinchcancel', end);\n    }\n\n    recognizer.on('panstart', startGrab);\n    recognizer.on('press', startGrab);\n\n    recognizer.on('pinchstart', startZoom);\n  }\n\n  if (dragging) {\n\n    // simulate hover during dragging\n    eventBus.on('drag.move', function(event) {\n\n      var originalEvent = event.originalEvent;\n\n      if (!originalEvent || originalEvent instanceof MouseEvent) {\n        return;\n      }\n\n      var position = toPoint(originalEvent);\n\n      // this gets really expensive ...\n      var node = document.elementFromPoint(position.x, position.y),\n          gfx = getGfx(node),\n          element = gfx && elementRegistry.get(gfx);\n\n      if (element !== event.hover) {\n        if (event.hover) {\n          dragging.out(event);\n        }\n\n        if (element) {\n          dragging.hover({ element: element, gfx: gfx });\n\n          event.hover = element;\n          event.hoverGfx = gfx;\n        }\n      }\n    });\n  }\n\n  if (contextPad) {\n\n    eventBus.on('contextPad.create', function(event) {\n      var node = event.pad.html;\n\n      // touch recognizer\n      var padRecognizer = createTouchRecognizer(node);\n\n      padRecognizer.on('panstart', function(event) {\n        log('context-pad', 'panstart', event);\n        contextPad.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('press', function(event) {\n        log('context-pad', 'press', event);\n        contextPad.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('tap', function(event) {\n        log('context-pad', 'tap', event);\n        contextPad.trigger('click', event);\n      });\n    });\n  }\n\n  if (palette) {\n    eventBus.on('palette.create', function(event) {\n      var node = event.container;\n\n      // touch recognizer\n      var padRecognizer = createTouchRecognizer(node);\n\n      padRecognizer.on('panstart', function(event) {\n        log('palette', 'panstart', event);\n        palette.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('press', function(event) {\n        log('palette', 'press', event);\n        palette.trigger('dragstart', event, true);\n      });\n\n      padRecognizer.on('tap', function(event) {\n        log('palette', 'tap', event);\n        palette.trigger('click', event);\n      });\n    });\n  }\n\n  eventBus.on('canvas.init', function(event) {\n    initEvents(event.svg);\n  });\n}\n\n\nTouchInteractionEvents.$inject = [\n  'injector',\n  'canvas',\n  'eventBus',\n  'elementRegistry',\n  'interactionEvents',\n  'touchFix'\n];\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate\n} from 'tiny-svg';\n\n\nexport default function TouchFix(canvas, eventBus) {\n\n  var self = this;\n\n  eventBus.on('canvas.init', function(e) {\n    self.addBBoxMarker(e.svg);\n  });\n}\n\nTouchFix.$inject = [ 'canvas', 'eventBus' ];\n\n\n/**\n * Safari mobile (iOS 7) does not fire touchstart event in <SVG> element\n * if there is no shape between 0,0 and viewport elements origin.\n *\n * So touchstart event is only fired when the <g class=\"viewport\"> element was hit.\n * Putting an element over and below the 'viewport' fixes that behavior.\n */\nTouchFix.prototype.addBBoxMarker = function(svg) {\n\n  var markerStyle = {\n    fill: 'none',\n    class: 'outer-bound-marker'\n  };\n\n  var rect1 = svgCreate('rect');\n  svgAttr(rect1, {\n    x: -10000,\n    y: 10000,\n    width: 10,\n    height: 10\n  });\n  svgAttr(rect1, markerStyle);\n\n  svgAppend(svg, rect1);\n\n  var rect2 = svgCreate('rect');\n  svgAttr(rect2, {\n    x: 10000,\n    y: 10000,\n    width: 10,\n    height: 10\n  });\n  svgAttr(rect2, markerStyle);\n\n  svgAppend(svg, rect2);\n};\n","import InteractionEventsModule from '../interaction-events';\n\nimport TouchInteractionEvents from './TouchInteractionEvents';\nimport TouchFix from './TouchFix';\n\nexport default {\n  __depends__: [ InteractionEventsModule ],\n  __init__: [ 'touchInteractionEvents' ],\n  touchInteractionEvents: [ 'type', TouchInteractionEvents ],\n  touchFix: [ 'type', TouchFix ]\n};","import TouchModule from '../../features/touch';\n\nexport default {\n  __depends__: [\n    TouchModule\n  ]\n};","import {\n  filter,\n  forEach,\n  sortBy\n} from 'min-dash';\n\nfunction last(arr) {\n  return arr && arr[arr.length - 1];\n}\n\nfunction sortTopOrMiddle(element) {\n  return element.y;\n}\n\nfunction sortLeftOrCenter(element) {\n  return element.x;\n}\n\n/**\n * Sorting functions for different types of alignment\n *\n * @type {Object}\n *\n * @return {Function}\n */\nvar ALIGNMENT_SORTING = {\n  left: sortLeftOrCenter,\n  center: sortLeftOrCenter,\n  right: function(element) {\n    return element.x + element.width;\n  },\n  top: sortTopOrMiddle,\n  middle: sortTopOrMiddle,\n  bottom: function(element) {\n    return element.y + element.height;\n  }\n};\n\n\nexport default function AlignElements(modeling) {\n  this._modeling = modeling;\n}\n\nAlignElements.$inject = [ 'modeling' ];\n\n\n/**\n * Get the relevant \"axis\" and \"dimension\" related to the current type of alignment\n *\n * @param  {String} type left|right|center|top|bottom|middle\n *\n * @return {Object} { axis, dimension }\n */\nAlignElements.prototype._getOrientationDetails = function(type) {\n  var vertical = [ 'top', 'bottom', 'middle' ],\n      axis = 'x',\n      dimension = 'width';\n\n  if (vertical.indexOf(type) !== -1) {\n    axis = 'y';\n    dimension = 'height';\n  }\n\n  return {\n    axis: axis,\n    dimension: dimension\n  };\n};\n\nAlignElements.prototype._isType = function(type, types) {\n  return types.indexOf(type) !== -1;\n};\n\n/**\n * Get a point on the relevant axis where elements should align to\n *\n * @param  {String} type left|right|center|top|bottom|middle\n * @param  {Array} sortedElements\n *\n * @return {Object}\n */\nAlignElements.prototype._alignmentPosition = function(type, sortedElements) {\n  var orientation = this._getOrientationDetails(type),\n      axis = orientation.axis,\n      dimension = orientation.dimension,\n      alignment = {},\n      centers = {},\n      hasSharedCenters = false,\n      centeredElements,\n      firstElement,\n      lastElement;\n\n  function getMiddleOrTop(first, last) {\n    return Math.round((first[axis] + last[axis] + last[dimension]) / 2);\n  }\n\n  if (this._isType(type, [ 'left', 'top' ])) {\n    alignment[type] = sortedElements[0][axis];\n\n  } else if (this._isType(type, [ 'right', 'bottom' ])) {\n    lastElement = last(sortedElements);\n\n    alignment[type] = lastElement[axis] + lastElement[dimension];\n\n  } else if (this._isType(type, [ 'center', 'middle' ])) {\n\n    // check if there is a center shared by more than one shape\n    // if not, just take the middle of the range\n    forEach(sortedElements, function(element) {\n      var center = element[axis] + Math.round(element[dimension] / 2);\n\n      if (centers[center]) {\n        centers[center].elements.push(element);\n      } else {\n        centers[center] = {\n          elements: [ element ],\n          center: center\n        };\n      }\n    });\n\n    centeredElements = sortBy(centers, function(center) {\n      if (center.elements.length > 1) {\n        hasSharedCenters = true;\n      }\n\n      return center.elements.length;\n    });\n\n    if (hasSharedCenters) {\n      alignment[type] = last(centeredElements).center;\n\n      return alignment;\n    }\n\n    firstElement = sortedElements[0];\n\n    sortedElements = sortBy(sortedElements, function(element) {\n      return element[axis] + element[dimension];\n    });\n\n    lastElement = last(sortedElements);\n\n    alignment[type] = getMiddleOrTop(firstElement, lastElement);\n  }\n\n  return alignment;\n};\n\n/**\n * Executes the alignment of a selection of elements\n *\n * @param  {Array} elements [description]\n * @param  {String} type left|right|center|top|bottom|middle\n */\nAlignElements.prototype.trigger = function(elements, type) {\n  var modeling = this._modeling;\n\n  var filteredElements = filter(elements, function(element) {\n    return !(element.waypoints || element.host || element.labelTarget);\n  });\n\n  var sortFn = ALIGNMENT_SORTING[type];\n\n  var sortedElements = sortBy(filteredElements, sortFn);\n\n  var alignment = this._alignmentPosition(type, sortedElements);\n\n  modeling.alignElements(sortedElements, alignment);\n};\n","import AlignElements from './AlignElements';\n\nexport default {\n  __init__: [ 'alignElements' ],\n  alignElements: [ 'type', AlignElements ]\n};\n","import { is } from '../../util/ModelUtil';\nimport { isAny } from '../modeling/util/ModelingUtil';\n\nimport {\n  getMid,\n  asTRBL,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  find,\n  reduce\n} from 'min-dash';\n\nvar DEFAULT_HORIZONTAL_DISTANCE = 50;\n\nvar MAX_HORIZONTAL_DISTANCE = 250;\n\n// padding to detect element placement\nvar PLACEMENT_DETECTION_PAD = 10;\n\n/**\n * Find the new position for the target element to\n * connect to source.\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Point}\n */\nexport function getNewShapePosition(source, element) {\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n    return getTextAnnotationPosition(source, element);\n  }\n\n  if (isAny(element, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ])) {\n    return getDataElementPosition(source, element);\n  }\n\n  if (is(element, 'bpmn:FlowNode')) {\n    return getFlowNodePosition(source, element);\n  }\n\n  return getDefaultPosition(source, element);\n}\n\n/**\n * Always try to place element right of source;\n * compute actual distance from previous nodes in flow.\n */\nexport function getFlowNodePosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n  var sourceMid = getMid(source);\n\n  var horizontalDistance = getFlowNodeDistance(source, element);\n\n  var orientation = 'left',\n      rowSize = 80,\n      margin = 30;\n\n  if (is(source, 'bpmn:BoundaryEvent')) {\n    orientation = getOrientation(source, source.host, -25);\n\n    if (orientation.indexOf('top') !== -1) {\n      margin *= -1;\n    }\n  }\n\n  function getVerticalDistance(orient) {\n    if (orient.indexOf('top') != -1) {\n      return -1 * rowSize;\n    } else if (orient.indexOf('bottom') != -1) {\n      return rowSize;\n    } else {\n      return 0;\n    }\n  }\n\n  var position = {\n    x: sourceTrbl.right + horizontalDistance + element.width / 2,\n    y: sourceMid.y + getVerticalDistance(orientation)\n  };\n\n  var escapeDirection = {\n    y: {\n      margin: margin,\n      rowSize: rowSize\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Compute best distance between source and target,\n * based on existing connections to and from source.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n *\n * @return {Number} distance\n */\nexport function getFlowNodeDistance(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  // is connection a reference to consider?\n  function isReference(c) {\n    return is(c, 'bpmn:SequenceFlow');\n  }\n\n  function toTargetNode(weight) {\n\n    return function(shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function(shape) {\n          var shapeTrbl = asTRBL(shape);\n\n          return shapeTrbl.left - sourceTrbl.right;\n        }\n      };\n    };\n  }\n\n  function toSourceNode(weight) {\n    return function(shape) {\n      return {\n        shape: shape,\n        weight: weight,\n        distanceTo: function(shape) {\n          var shapeTrbl = asTRBL(shape);\n\n          return sourceTrbl.left - shapeTrbl.right;\n        }\n      };\n    };\n  }\n\n  // we create a list of nodes to take into consideration\n  // for calculating the optimal flow node distance\n  //\n  //   * weight existing target nodes higher than source nodes\n  //   * only take into account individual nodes once\n  //\n  var nodes = reduce([].concat(\n    getTargets(source, isReference).map(toTargetNode(5)),\n    getSources(source, isReference).map(toSourceNode(1))\n  ), function(nodes, node) {\n\n    // filter out shapes connected twice via source or target\n    nodes[node.shape.id + '__weight_' + node.weight] = node;\n\n    return nodes;\n  }, {});\n\n  // compute distances between source and incoming nodes;\n  // group at the same time by distance and expose the\n  // favourite distance as { fav: { count, value } }.\n  var distancesGrouped = reduce(nodes, function(result, node) {\n\n    var shape = node.shape,\n        weight = node.weight,\n        distanceTo = node.distanceTo;\n\n    var fav = result.fav,\n        currentDistance,\n        currentDistanceCount,\n        currentDistanceEntry;\n\n    currentDistance = distanceTo(shape);\n\n    // ignore too far away peers\n    // or non-left to right modeled nodes\n    if (currentDistance < 0 || currentDistance > MAX_HORIZONTAL_DISTANCE) {\n      return result;\n    }\n\n    currentDistanceEntry = result[String(currentDistance)] =\n      result[String(currentDistance)] || {\n        value: currentDistance,\n        count: 0\n      };\n\n    // inc diff count\n    currentDistanceCount = currentDistanceEntry.count += 1 * weight;\n\n    if (!fav || fav.count < currentDistanceCount) {\n      result.fav = currentDistanceEntry;\n    }\n\n    return result;\n  }, { });\n\n\n  if (distancesGrouped.fav) {\n    return distancesGrouped.fav.value;\n  } else {\n    return DEFAULT_HORIZONTAL_DISTANCE;\n  }\n}\n\n\n/**\n * Always try to place text annotations top right of source.\n */\nexport function getTextAnnotationPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var position = {\n    x: sourceTrbl.right + element.width / 2,\n    y: sourceTrbl.top - 50 - element.height / 2\n  };\n\n  var escapeDirection = {\n    y: {\n      margin: -30,\n      rowSize: 20\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Always put element bottom right of source.\n */\nexport function getDataElementPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var position = {\n    x: sourceTrbl.right - 10 + element.width / 2,\n    y: sourceTrbl.bottom + 40 + element.width / 2\n  };\n\n  var escapeDirection = {\n    x: {\n      margin: 30,\n      rowSize: 30\n    }\n  };\n\n  return deconflictPosition(source, element, position, escapeDirection);\n}\n\n\n/**\n * Always put element right of source per default.\n */\nexport function getDefaultPosition(source, element) {\n\n  var sourceTrbl = asTRBL(source);\n\n  var sourceMid = getMid(source);\n\n  // simply put element right next to source\n  return {\n    x: sourceTrbl.right + DEFAULT_HORIZONTAL_DISTANCE + element.width / 2,\n    y: sourceMid.y\n  };\n}\n\n\n/**\n * Returns all connected elements around the given source.\n *\n * This includes:\n *\n *   - connected elements\n *   - host connected elements\n *   - attachers connected elements\n *\n * @param  {djs.model.Shape} source\n * @param  {djs.model.Shape} element\n *\n * @return {Array<djs.model.Shape>}\n */\nfunction getAutoPlaceClosure(source, element) {\n\n  var allConnected = getConnected(source);\n\n  if (source.host) {\n    allConnected = allConnected.concat(getConnected(source.host));\n  }\n\n  if (source.attachers) {\n    allConnected = allConnected.concat(source.attachers.reduce(function(shapes, attacher) {\n      return shapes.concat(getConnected(attacher));\n    }, []));\n  }\n\n  return allConnected;\n}\n\n/**\n * Return target at given position, if defined.\n *\n * This takes connected elements from host and attachers\n * into account, too.\n */\nexport function getConnectedAtPosition(source, position, element) {\n\n  var bounds = {\n    x: position.x - (element.width / 2),\n    y: position.y - (element.height / 2),\n    width: element.width,\n    height: element.height\n  };\n\n  var closure = getAutoPlaceClosure(source, element);\n\n  return find(closure, function(target) {\n\n    if (target === element) {\n      return false;\n    }\n\n    var orientation = getOrientation(target, bounds, PLACEMENT_DETECTION_PAD);\n\n    return orientation === 'intersect';\n  });\n}\n\n\n/**\n * Returns a new, position for the given element\n * based on the given element that is not occupied\n * by some element connected to source.\n *\n * Take into account the escapeDirection (where to move\n * on positioning clashes) in the computation.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape} element\n * @param {Point} position\n * @param {Object} escapeDelta\n *\n * @return {Point}\n */\nexport function deconflictPosition(source, element, position, escapeDelta) {\n\n  function nextPosition(existingElement) {\n\n    var newPosition = {\n      x: position.x,\n      y: position.y\n    };\n\n    [ 'x', 'y' ].forEach(function(axis) {\n\n      var axisDelta = escapeDelta[axis];\n\n      if (!axisDelta) {\n        return;\n      }\n\n      var dimension = axis === 'x' ? 'width' : 'height';\n\n      var margin = axisDelta.margin,\n          rowSize = axisDelta.rowSize;\n\n      if (margin < 0) {\n        newPosition[axis] = Math.min(\n          existingElement[axis] + margin - element[dimension] / 2,\n          position[axis] - rowSize + margin\n        );\n      } else {\n        newPosition[axis] = Math.max(\n          existingTarget[axis] + existingTarget[dimension] + margin + element[dimension] / 2,\n          position[axis] + rowSize + margin\n        );\n      }\n    });\n\n    return newPosition;\n  }\n\n  var existingTarget;\n\n  // deconflict position until free slot is found\n  while ((existingTarget = getConnectedAtPosition(source, position, element))) {\n    position = nextPosition(existingTarget);\n  }\n\n  return position;\n}\n\n\n\n// helpers //////////////////////\n\nfunction noneFilter() {\n  return true;\n}\n\nfunction getConnected(element, connectionFilter) {\n  return [].concat(\n    getTargets(element, connectionFilter),\n    getSources(element, connectionFilter)\n  );\n}\n\nfunction getSources(shape, connectionFilter) {\n\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.incoming.filter(connectionFilter).map(function(c) {\n    return c.source;\n  });\n}\n\nfunction getTargets(shape, connectionFilter) {\n\n  if (!connectionFilter) {\n    connectionFilter = noneFilter;\n  }\n\n  return shape.outgoing.filter(connectionFilter).map(function(c) {\n    return c.target;\n  });\n}","import { getNewShapePosition } from './AutoPlaceUtil';\n\n\n/**\n * A service that places elements connected to existing ones\n * to an appropriate position in an _automated_ fashion.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AutoPlace(eventBus, modeling) {\n\n  function emit(event, payload) {\n    return eventBus.fire(event, payload);\n  }\n\n\n  /**\n   * Append shape to source at appropriate position.\n   *\n   * @param {djs.model.Shape} source\n   * @param {djs.model.Shape} shape\n   *\n   * @return {djs.model.Shape} appended shape\n   */\n  this.append = function(source, shape) {\n\n    emit('autoPlace.start', {\n      source: source,\n      shape: shape\n    });\n\n    // allow others to provide the position\n    var position = emit('autoPlace', {\n      source: source,\n      shape: shape\n    });\n\n    if (!position) {\n      position = getNewShapePosition(source, shape);\n    }\n\n    var newShape = modeling.appendShape(source, shape, position, source.parent);\n\n    emit('autoPlace.end', {\n      source: source,\n      shape: newShape\n    });\n\n    return newShape;\n  };\n\n}\n\nAutoPlace.$inject = [\n  'eventBus',\n  'modeling'\n];","/**\n * Select element after auto placement.\n *\n * @param {EventBus} eventBus\n * @param {Selection} selection\n */\nexport default function AutoPlaceSelectionBehavior(eventBus, selection) {\n\n  eventBus.on('autoPlace.end', 500, function(e) {\n    selection.select(e.shape);\n  });\n\n}\n\nAutoPlaceSelectionBehavior.$inject = [\n  'eventBus',\n  'selection'\n];","import AutoPlace from './AutoPlace';\nimport AutoPlaceSelectionBehavior from './AutoPlaceSelectionBehavior';\n\nexport default {\n  __init__: [ 'autoPlaceSelectionBehavior' ],\n  autoPlace: [ 'type', AutoPlace ],\n  autoPlaceSelectionBehavior: [ 'type', AutoPlaceSelectionBehavior ]\n};","import {\n  forEach,\n  isFunction,\n  isArray,\n  isNumber,\n  isObject\n} from 'min-dash';\n\n\nvar DEFAULT_PRIORITY = 1000;\n\n/**\n * A utility that can be used to plug-in into the command execution for\n * extension and/or validation.\n *\n * @param {EventBus} eventBus\n *\n * @example\n *\n * import inherits from 'inherits';\n *\n * import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n *\n * function CommandLogger(eventBus) {\n *   CommandInterceptor.call(this, eventBus);\n *\n *   this.preExecute(function(event) {\n *     console.log('command pre-execute', event);\n *   });\n * }\n *\n * inherits(CommandLogger, CommandInterceptor);\n *\n */\nexport default function CommandInterceptor(eventBus) {\n  this._eventBus = eventBus;\n}\n\nCommandInterceptor.$inject = [ 'eventBus' ];\n\nfunction unwrapEvent(fn, that) {\n  return function(event) {\n    return fn.call(that || null, event.context, event.command, event);\n  };\n}\n\n/**\n * Register an interceptor for a command execution\n *\n * @param {String|Array<String>} [events] list of commands to register on\n * @param {String} [hook] command hook, i.e. preExecute, executed to listen on\n * @param {Number} [priority] the priority on which to hook into the execution\n * @param {Function} handlerFn interceptor to be invoked with (event)\n * @param {Boolean} unwrap if true, unwrap the event and pass (context, command, event) to the\n *                          listener instead\n * @param {Object} [that] Pass context (`this`) to the handler function\n */\nCommandInterceptor.prototype.on = function(events, hook, priority, handlerFn, unwrap, that) {\n\n  if (isFunction(hook) || isNumber(hook)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = hook;\n    hook = null;\n  }\n\n  if (isFunction(priority)) {\n    that = unwrap;\n    unwrap = handlerFn;\n    handlerFn = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  if (isObject(unwrap)) {\n    that = unwrap;\n    unwrap = false;\n  }\n\n  if (!isFunction(handlerFn)) {\n    throw new Error('handlerFn must be a function');\n  }\n\n  if (!isArray(events)) {\n    events = [ events ];\n  }\n\n  var eventBus = this._eventBus;\n\n  forEach(events, function(event) {\n\n    // concat commandStack(.event)?(.hook)?\n    var fullEvent = [ 'commandStack', event, hook ].filter(function(e) { return e; }).join('.');\n\n    eventBus.on(fullEvent, priority, unwrap ? unwrapEvent(handlerFn, that) : handlerFn, that);\n  });\n};\n\n\nvar hooks = [\n  'canExecute',\n  'preExecute',\n  'preExecuted',\n  'execute',\n  'executed',\n  'postExecute',\n  'postExecuted',\n  'revert',\n  'reverted'\n];\n\n/*\n * Install hook shortcuts\n *\n * This will generate the CommandInterceptor#(preExecute|...|reverted) methods\n * which will in term forward to CommandInterceptor#on.\n */\nforEach(hooks, function(hook) {\n\n  /**\n   * {canExecute|preExecute|preExecuted|execute|executed|postExecute|postExecuted|revert|reverted}\n   *\n   * A named hook for plugging into the command execution\n   *\n   * @param {String|Array<String>} [events] list of commands to register on\n   * @param {Number} [priority] the priority on which to hook into the execution\n   * @param {Function} handlerFn interceptor to be invoked with (event)\n   * @param {Boolean} [unwrap=false] if true, unwrap the event and pass (context, command, event) to the\n   *                          listener instead\n   * @param {Object} [that] Pass context (`this`) to the handler function\n   */\n  CommandInterceptor.prototype[hook] = function(events, priority, handlerFn, unwrap, that) {\n\n    if (isFunction(events) || isNumber(events)) {\n      that = unwrap;\n      unwrap = handlerFn;\n      handlerFn = priority;\n      priority = events;\n      events = null;\n    }\n\n    this.on(events, hook, priority, handlerFn, unwrap, that);\n  };\n});\n","import inherits from 'inherits';\n\nimport { getBBox as getBoundingBox } from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\nimport {\n  assign,\n  flatten,\n  find,\n  forEach,\n  groupBy,\n  isArray,\n  matchPattern,\n  pick,\n  values\n} from 'min-dash';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An auto resize component that takes care of expanding a parent element\n * if child elements are created or moved close the parents edge.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function AutoResize(eventBus, elementRegistry, modeling, rules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._elementRegistry = elementRegistry;\n  this._modeling = modeling;\n  this._rules = rules;\n\n  var self = this;\n\n  this.postExecuted([ 'shape.create' ], function(event) {\n    var context = event.context,\n        hints = context.hints || {},\n        shape = context.shape,\n        parent = context.parent || context.newParent;\n\n    if (hints.autoResize === false) {\n      return;\n    }\n\n    self._expand([ shape ], parent);\n  });\n\n  this.postExecuted([ 'elements.move' ], function(event) {\n    var context = event.context,\n        elements = flatten(values(context.closure.topLevel)),\n        hints = context.hints;\n\n    var autoResize = hints ? hints.autoResize : true;\n\n    if (autoResize === false) {\n      return;\n    }\n\n    var expandings = groupBy(elements, function(element) {\n      return element.parent.id;\n    });\n\n    forEach(expandings, function(elements, parentId) {\n\n      // optionally filter elements to be considered when resizing\n      if (isArray(autoResize)) {\n        elements = elements.filter(function(element) {\n          return find(autoResize, matchPattern({ id: element.id }));\n        });\n      }\n\n      self._expand(elements, parentId);\n    });\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape;\n\n    if (hints && hints.autoResize === false) {\n      return;\n    }\n\n    if (shape.collapsed) {\n      return;\n    }\n\n    self._expand(shape.children || [], shape);\n  });\n\n  this.postExecuted([ 'shape.resize' ], function(event) {\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        parent = shape.parent;\n\n    if (hints && hints.autoResize === false) {\n      return;\n    }\n\n    if (parent) {\n      self._expand([ shape ], parent);\n    }\n  });\n\n}\n\nAutoResize.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'modeling',\n  'rules'\n];\n\ninherits(AutoResize, CommandInterceptor);\n\n\n/**\n * Calculate the new bounds of the target shape, given\n * a number of elements have been moved or added into the parent.\n *\n * This method considers the current size, the added elements as well as\n * the provided padding for the new bounds.\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape} target\n */\nAutoResize.prototype._getOptimalBounds = function(elements, target) {\n\n  var offset = this.getOffset(target),\n      padding = this.getPadding(target);\n\n  var elementsTrbl = asTRBL(getBoundingBox(elements)),\n      targetTrbl = asTRBL(target);\n\n  var newTrbl = {};\n\n  if (elementsTrbl.top - targetTrbl.top < padding.top) {\n    newTrbl.top = elementsTrbl.top - offset.top;\n  }\n\n  if (elementsTrbl.left - targetTrbl.left < padding.left) {\n    newTrbl.left = elementsTrbl.left - offset.left;\n  }\n\n  if (targetTrbl.right - elementsTrbl.right < padding.right) {\n    newTrbl.right = elementsTrbl.right + offset.right;\n  }\n\n  if (targetTrbl.bottom - elementsTrbl.bottom < padding.bottom) {\n    newTrbl.bottom = elementsTrbl.bottom + offset.bottom;\n  }\n\n  return asBounds(assign({}, targetTrbl, newTrbl));\n};\n\n\n/**\n * Expand the target shape respecting rules, offset and padding\n *\n * @param {Array<djs.model.Shape>} elements\n * @param {djs.model.Shape|String} target|targetId\n */\nAutoResize.prototype._expand = function(elements, target) {\n\n  if (typeof target === 'string') {\n    target = this._elementRegistry.get(target);\n  }\n\n  var allowed = this._rules.allowed('element.autoResize', {\n    elements: elements,\n    target: target\n  });\n\n  if (!allowed) {\n    return;\n  }\n\n  // calculate the new bounds\n  var newBounds = this._getOptimalBounds(elements, target);\n\n  if (!boundsChanged(newBounds, target)) {\n    return;\n  }\n\n  var resizeDirections = getResizeDirections(pick(target, [ 'x', 'y', 'width', 'height' ]), newBounds);\n\n  // resize the parent shape\n  this.resize(target, newBounds, {\n    autoResize: resizeDirections\n  });\n\n  var parent = target.parent;\n\n  // recursively expand parent elements\n  if (parent) {\n    this._expand([ target ], parent);\n  }\n};\n\n\n/**\n * Get the amount to expand the given shape in each direction.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getOffset = function(shape) {\n  return { top: 60, bottom: 60, left: 100, right: 100 };\n};\n\n\n/**\n * Get the activation threshold for each side for which\n * resize triggers.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {TRBL}\n */\nAutoResize.prototype.getPadding = function(shape) {\n  return { top: 2, bottom: 2, left: 15, right: 15 };\n};\n\n\n/**\n * Perform the actual resize operation.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n * @param {Object} [hints]\n * @param {string} [hints.autoResize]\n */\nAutoResize.prototype.resize = function(shape, newBounds, hints) {\n  this._modeling.resizeShape(shape, newBounds, null, hints);\n};\n\n\nfunction boundsChanged(newBounds, oldBounds) {\n  return (\n    newBounds.x !== oldBounds.x ||\n    newBounds.y !== oldBounds.y ||\n    newBounds.width !== oldBounds.width ||\n    newBounds.height !== oldBounds.height\n  );\n}\n\n/**\n * Get directions of resize as {n|w|s|e} e.g. \"nw\".\n *\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @returns {string} Resize directions as {n|w|s|e}.\n */\nfunction getResizeDirections(oldBounds, newBounds) {\n  var directions = '';\n\n  oldBounds = asTRBL(oldBounds);\n  newBounds = asTRBL(newBounds);\n\n  if (oldBounds.top > newBounds.top) {\n    directions = directions.concat('n');\n  }\n\n  if (oldBounds.right < newBounds.right) {\n    directions = directions.concat('w');\n  }\n\n  if (oldBounds.bottom < newBounds.bottom) {\n    directions = directions.concat('s');\n  }\n\n  if (oldBounds.left > newBounds.left) {\n    directions = directions.concat('e');\n  }\n\n  return directions;\n}","import AutoResize from 'diagram-js/lib/features/auto-resize/AutoResize';\n\nimport inherits from 'inherits';\n\nimport { is } from '../../util/ModelUtil';\n\n\n/**\n * Sub class of the AutoResize module which implements a BPMN\n * specific resize function.\n */\nexport default function BpmnAutoResize(injector) {\n\n  injector.invoke(AutoResize, this);\n}\n\nBpmnAutoResize.$inject = [\n  'injector'\n];\n\ninherits(BpmnAutoResize, AutoResize);\n\n\n/**\n * Resize shapes and lanes.\n *\n * @param {djs.model.Shape} target\n * @param {Bounds} newBounds\n * @param {Object} hints\n */\nBpmnAutoResize.prototype.resize = function(target, newBounds, hints) {\n\n  if (is(target, 'bpmn:Participant')) {\n    this._modeling.resizeLane(target, newBounds, null, hints);\n  } else {\n    this._modeling.resizeShape(target, newBounds, null, hints);\n  }\n};","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n/**\n * A basic provider that may be extended to implement modeling rules.\n *\n * Extensions should implement the init method to actually add their custom\n * modeling checks. Checks may be added via the #addRule(action, fn) method.\n *\n * @param {EventBus} eventBus\n */\nexport default function RuleProvider(eventBus) {\n  CommandInterceptor.call(this, eventBus);\n\n  this.init();\n}\n\nRuleProvider.$inject = [ 'eventBus' ];\n\ninherits(RuleProvider, CommandInterceptor);\n\n\n/**\n * Adds a modeling rule for the given action, implemented through\n * a callback function.\n *\n * The function will receive the modeling specific action context\n * to perform its check. It must return `false` to disallow the\n * action from happening or `true` to allow the action.\n *\n * A rule provider may pass over the evaluation to lower priority\n * rules by returning return nothing (or <code>undefined</code>).\n *\n * @example\n *\n * ResizableRules.prototype.init = function() {\n *\n *   \\/**\n *    * Return `true`, `false` or nothing to denote\n *    * _allowed_, _not allowed_ and _continue evaluating_.\n *    *\\/\n *   this.addRule('shape.resize', function(context) {\n *\n *     var shape = context.shape;\n *\n *     if (!context.newBounds) {\n *       // check general resizability\n *       if (!shape.resizable) {\n *         return false;\n *       }\n *\n *       // not returning anything (read: undefined)\n *       // will continue the evaluation of other rules\n *       // (with lower priority)\n *       return;\n *     } else {\n *       // element must have minimum size of 10*10 points\n *       return context.newBounds.width > 10 && context.newBounds.height > 10;\n *     }\n *   });\n * };\n *\n * @param {String|Array<String>} actions the identifier for the modeling action to check\n * @param {Number} [priority] the priority at which this rule is being applied\n * @param {Function} fn the callback function that performs the actual check\n */\nRuleProvider.prototype.addRule = function(actions, priority, fn) {\n\n  var self = this;\n\n  if (typeof actions === 'string') {\n    actions = [ actions ];\n  }\n\n  actions.forEach(function(action) {\n\n    self.canExecute(action, priority, function(context, action, event) {\n      return fn(context);\n    }, true);\n  });\n};\n\n/**\n * Implement this method to add new rules during provider initialization.\n */\nRuleProvider.prototype.init = function() {};","import RuleProvider from '../rules/RuleProvider';\n\nimport inherits from 'inherits';\n\n/**\n * This is a base rule provider for the element.autoResize rule.\n */\nexport default function AutoResizeProvider(eventBus) {\n\n  RuleProvider.call(this, eventBus);\n\n  var self = this;\n\n  this.addRule('element.autoResize', function(context) {\n    return self.canResize(context.elements, context.target);\n  });\n}\n\nAutoResizeProvider.$inject = [ 'eventBus' ];\n\ninherits(AutoResizeProvider, RuleProvider);\n\n/**\n * Needs to be implemented by sub classes to allow actual auto resize\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {djs.model.Shape} target\n *\n * @return {Boolean}\n */\nAutoResizeProvider.prototype.canResize = function(elements, target) {\n  return false;\n};","import { is } from '../../util/ModelUtil';\n\nimport inherits from 'inherits';\n\nimport { forEach } from 'min-dash';\n\nimport AutoResizeProvider from 'diagram-js/lib/features/auto-resize/AutoResizeProvider';\n\n\n/**\n * This module is a provider for automatically resizing parent BPMN elements\n */\nexport default function BpmnAutoResizeProvider(eventBus, modeling) {\n  AutoResizeProvider.call(this, eventBus);\n\n  this._modeling = modeling;\n}\n\ninherits(BpmnAutoResizeProvider, AutoResizeProvider);\n\nBpmnAutoResizeProvider.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Check if the given target can be expanded\n *\n * @param  {djs.model.Shape} target\n *\n * @return {boolean}\n */\nBpmnAutoResizeProvider.prototype.canResize = function(elements, target) {\n\n  if (!is(target, 'bpmn:Participant') && !is(target, 'bpmn:Lane') && !(is(target, 'bpmn:SubProcess'))) {\n    return false;\n  }\n\n  var canResize = true;\n\n  forEach(elements, function(element) {\n\n    if (is(element, 'bpmn:Lane') || element.labelTarget) {\n      canResize = false;\n      return;\n    }\n  });\n\n  return canResize;\n};\n","import BpmnAutoResize from './BpmnAutoResize';\nimport BpmnAutoResizeProvider from './BpmnAutoResizeProvider';\n\n\nexport default {\n  __init__: [\n    'bpmnAutoResize',\n    'bpmnAutoResizeProvider'\n  ],\n  bpmnAutoResize: [ 'type', BpmnAutoResize ],\n  bpmnAutoResizeProvider: [ 'type', BpmnAutoResizeProvider ]\n};\n","/* global TouchEvent */\n\nvar round = Math.round;\n\nimport { assign } from 'min-dash';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  getOriginal,\n  toPoint,\n  stopPropagation\n} from '../../util/Event';\n\nimport {\n  set as cursorSet,\n  unset as cursorUnset\n} from '../../util/Cursor';\n\nimport {\n  install as installClickTrap\n} from '../../util/ClickTrap';\n\nimport {\n  delta as deltaPos\n} from '../../util/PositionUtil';\n\nvar DRAG_ACTIVE_CLS = 'djs-drag-active';\n\n\nfunction preventDefault(event) {\n  event.preventDefault();\n}\n\nfunction isTouchEvent(event) {\n\n  // check for TouchEvent being available first\n  // (i.e. not available on desktop Firefox)\n  return typeof TouchEvent !== 'undefined' && event instanceof TouchEvent;\n}\n\nfunction getLength(point) {\n  return Math.sqrt(Math.pow(point.x, 2) + Math.pow(point.y, 2));\n}\n\n/**\n * A helper that fires canvas localized drag events and realizes\n * the general \"drag-and-drop\" look and feel.\n *\n * Calling {@link Dragging#activate} activates dragging on a canvas.\n *\n * It provides the following:\n *\n *   * emits life cycle events, namespaced with a prefix assigned\n *     during dragging activation\n *   * sets and restores the cursor\n *   * sets and restores the selection if elements still exist\n *   * ensures there can be only one drag operation active at a time\n *\n * Dragging may be canceled manually by calling {@link Dragging#cancel}\n * or by pressing ESC.\n *\n *\n * ## Life-cycle events\n *\n * Dragging can be in three different states, off, initialized\n * and active.\n *\n * (1) off: no dragging operation is in progress\n * (2) initialized: a new drag operation got initialized but not yet\n *                  started (i.e. because of no initial move)\n * (3) started: dragging is in progress\n *\n * Eventually dragging will be off again after a drag operation has\n * been ended or canceled via user click or ESC key press.\n *\n * To indicate transitions between these states dragging emits generic\n * life-cycle events with the `drag.` prefix _and_ events namespaced\n * to a prefix choosen by a user during drag initialization.\n *\n * The following events are emitted (appropriately prefixed) via\n * the {@link EventBus}.\n *\n * * `init`\n * * `start`\n * * `move`\n * * `end`\n * * `ended` (dragging already in off state)\n * * `cancel` (only if previously started)\n * * `canceled` (dragging already in off state, only if previously started)\n * * `cleanup`\n *\n *\n * @example\n *\n * function MyDragComponent(eventBus, dragging) {\n *\n *   eventBus.on('mydrag.start', function(event) {\n *     console.log('yes, we start dragging');\n *   });\n *\n *   eventBus.on('mydrag.move', function(event) {\n *     console.log('canvas local coordinates', event.x, event.y, event.dx, event.dy);\n *\n *     // local drag data is passed with the event\n *     event.context.foo; // \"BAR\"\n *\n *     // the original mouse event, too\n *     event.originalEvent; // MouseEvent(...)\n *   });\n *\n *   eventBus.on('element.click', function(event) {\n *     dragging.init(event, 'mydrag', {\n *       cursor: 'grabbing',\n *       data: {\n *         context: {\n *           foo: \"BAR\"\n *         }\n *       }\n *     });\n *   });\n * }\n */\nexport default function Dragging(eventBus, canvas, selection, elementRegistry) {\n\n  var defaultOptions = {\n    threshold: 5,\n    trapClick: true\n  };\n\n  // the currently active drag operation\n  // dragging is active as soon as this context exists.\n  //\n  // it is visually _active_ only when a context.active flag is set to true.\n  var context;\n\n  /* convert a global event into local coordinates */\n  function toLocalPoint(globalPosition) {\n\n    var viewbox = canvas.viewbox();\n\n    var clientRect = canvas._container.getBoundingClientRect();\n\n    return {\n      x: viewbox.x + (globalPosition.x - clientRect.left) / viewbox.scale,\n      y: viewbox.y + (globalPosition.y - clientRect.top) / viewbox.scale\n    };\n  }\n\n  // helpers\n\n  function fire(type, dragContext) {\n    dragContext = dragContext || context;\n\n    var event = eventBus.createEvent(\n      assign(\n        {},\n        dragContext.payload,\n        dragContext.data,\n        { isTouch: dragContext.isTouch }\n      )\n    );\n\n    // default integration\n    if (eventBus.fire('drag.' + type, event) === false) {\n      return false;\n    }\n\n    return eventBus.fire(dragContext.prefix + '.' + type, event);\n  }\n\n  function restoreSelection(previousSelection) {\n    var existingSelection = previousSelection.filter(function(element) {\n      return elementRegistry.get(element.id);\n    });\n\n    existingSelection.length && selection.select(existingSelection);\n  }\n\n  // event listeners\n\n  function move(event, activate) {\n    var payload = context.payload,\n        displacement = context.displacement;\n\n    var globalStart = context.globalStart,\n        globalCurrent = toPoint(event),\n        globalDelta = deltaPos(globalCurrent, globalStart);\n\n    var localStart = context.localStart,\n        localCurrent = toLocalPoint(globalCurrent),\n        localDelta = deltaPos(localCurrent, localStart);\n\n\n    // activate context explicitly or once threshold is reached\n    if (!context.active && (activate || getLength(globalDelta) > context.threshold)) {\n\n      // fire start event with original\n      // starting coordinates\n\n      assign(payload, {\n        x: round(localStart.x + displacement.x),\n        y: round(localStart.y + displacement.y),\n        dx: 0,\n        dy: 0\n      }, { originalEvent: event });\n\n      if (false === fire('start')) {\n        return cancel();\n      }\n\n      context.active = true;\n\n      // unset selection and remember old selection\n      // the previous (old) selection will always passed\n      // with the event via the event.previousSelection property\n      if (!context.keepSelection) {\n        payload.previousSelection = selection.get();\n        selection.select(null);\n      }\n\n      // allow custom cursor\n      if (context.cursor) {\n        cursorSet(context.cursor);\n      }\n\n      // indicate dragging via marker on root element\n      canvas.addMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n    }\n\n    stopPropagation(event);\n\n    if (context.active) {\n\n      // update payload with actual coordinates\n      assign(payload, {\n        x: round(localCurrent.x + displacement.x),\n        y: round(localCurrent.y + displacement.y),\n        dx: round(localDelta.x),\n        dy: round(localDelta.y)\n      }, { originalEvent: event });\n\n      // emit move event\n      fire('move');\n    }\n  }\n\n  function end(event) {\n    var previousContext,\n        returnValue = true;\n\n    if (context.active) {\n\n      if (event) {\n        context.payload.originalEvent = event;\n\n        // suppress original event (click, ...)\n        // because we just ended a drag operation\n        stopPropagation(event);\n      }\n\n      // implementations may stop restoring the\n      // original state (selections, ...) by preventing the\n      // end events default action\n      returnValue = fire('end');\n    }\n\n    if (returnValue === false) {\n      fire('rejected');\n    }\n\n    previousContext = cleanup(returnValue !== true);\n\n    // last event to be fired when all drag operations are done\n    // at this point in time no drag operation is in progress anymore\n    fire('ended', previousContext);\n  }\n\n\n  // cancel active drag operation if the user presses\n  // the ESC key on the keyboard\n\n  function checkCancel(event) {\n\n    if (event.which === 27) {\n      preventDefault(event);\n\n      cancel();\n    }\n  }\n\n\n  // prevent ghost click that might occur after a finished\n  // drag and drop session\n\n  function trapClickAndEnd(event) {\n\n    var untrap;\n\n    // trap the click in case we are part of an active\n    // drag operation. This will effectively prevent\n    // the ghost click that cannot be canceled otherwise.\n    if (context.active) {\n\n      untrap = installClickTrap(eventBus);\n\n      // remove trap after minimal delay\n      setTimeout(untrap, 400);\n\n      // prevent default action (click)\n      preventDefault(event);\n    }\n\n    end(event);\n  }\n\n  function trapTouch(event) {\n    move(event);\n  }\n\n  // update the drag events hover (djs.model.Base) and hoverGfx (Snap<SVGElement>)\n  // properties during hover and out and fire {prefix}.hover and {prefix}.out properties\n  // respectively\n\n  function hover(event) {\n    var payload = context.payload;\n\n    payload.hoverGfx = event.gfx;\n    payload.hover = event.element;\n\n    fire('hover');\n  }\n\n  function out(event) {\n    fire('out');\n\n    var payload = context.payload;\n\n    payload.hoverGfx = null;\n    payload.hover = null;\n  }\n\n\n  // life-cycle methods\n\n  function cancel(restore) {\n    var previousContext;\n\n    if (!context) {\n      return;\n    }\n\n    var wasActive = context.active;\n\n    if (wasActive) {\n      fire('cancel');\n    }\n\n    previousContext = cleanup(restore);\n\n    if (wasActive) {\n\n      // last event to be fired when all drag operations are done\n      // at this point in time no drag operation is in progress anymore\n      fire('canceled', previousContext);\n    }\n  }\n\n  function cleanup(restore) {\n    var previousContext,\n        endDrag;\n\n    fire('cleanup');\n\n    // reset cursor\n    cursorUnset();\n\n    if (context.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    // reset dom listeners\n    domEvent.unbind(document, 'mousemove', move);\n\n    domEvent.unbind(document, 'dragstart', preventDefault);\n    domEvent.unbind(document, 'selectstart', preventDefault);\n\n    domEvent.unbind(document, 'mousedown', endDrag, true);\n    domEvent.unbind(document, 'mouseup', endDrag, true);\n\n    domEvent.unbind(document, 'keyup', checkCancel);\n\n    domEvent.unbind(document, 'touchstart', trapTouch, true);\n    domEvent.unbind(document, 'touchcancel', cancel, true);\n    domEvent.unbind(document, 'touchmove', move, true);\n    domEvent.unbind(document, 'touchend', end, true);\n\n    eventBus.off('element.hover', hover);\n    eventBus.off('element.out', out);\n\n    // remove drag marker on root element\n    canvas.removeMarker(canvas.getRootElement(), DRAG_ACTIVE_CLS);\n\n    // restore selection, unless it has changed\n    var previousSelection = context.payload.previousSelection;\n\n    if (restore !== false && previousSelection && !selection.get().length) {\n      restoreSelection(previousSelection);\n    }\n\n    previousContext = context;\n\n    context = null;\n\n    return previousContext;\n  }\n\n  /**\n   * Initialize a drag operation.\n   *\n   * If `localPosition` is given, drag events will be emitted\n   * relative to it.\n   *\n   * @param {MouseEvent|TouchEvent} [event]\n   * @param {Point} [localPosition] actual diagram local position this drag operation should start at\n   * @param {String} prefix\n   * @param {Object} [options]\n   */\n  function init(event, relativeTo, prefix, options) {\n\n    // only one drag operation may be active, at a time\n    if (context) {\n      cancel(false);\n    }\n\n    if (typeof relativeTo === 'string') {\n      options = prefix;\n      prefix = relativeTo;\n      relativeTo = null;\n    }\n\n    options = assign({}, defaultOptions, options || {});\n\n    var data = options.data || {},\n        originalEvent,\n        globalStart,\n        localStart,\n        endDrag,\n        isTouch;\n\n    if (options.trapClick) {\n      endDrag = trapClickAndEnd;\n    } else {\n      endDrag = end;\n    }\n\n    if (event) {\n      originalEvent = getOriginal(event) || event;\n      globalStart = toPoint(event);\n\n      stopPropagation(event);\n\n      // prevent default browser dragging behavior\n      if (originalEvent.type === 'dragstart') {\n        preventDefault(originalEvent);\n      }\n    } else {\n      originalEvent = null;\n      globalStart = { x: 0, y: 0 };\n    }\n\n    localStart = toLocalPoint(globalStart);\n\n    if (!relativeTo) {\n      relativeTo = localStart;\n    }\n\n    isTouch = isTouchEvent(originalEvent);\n\n    context = assign({\n      prefix: prefix,\n      data: data,\n      payload: {},\n      globalStart: globalStart,\n      displacement: deltaPos(relativeTo, localStart),\n      localStart: localStart,\n      isTouch: isTouch\n    }, options);\n\n    // skip dom registration if trigger\n    // is set to manual (during testing)\n    if (!options.manual) {\n\n      // add dom listeners\n\n      if (isTouch) {\n        domEvent.bind(document, 'touchstart', trapTouch, true);\n        domEvent.bind(document, 'touchcancel', cancel, true);\n        domEvent.bind(document, 'touchmove', move, true);\n        domEvent.bind(document, 'touchend', end, true);\n      } else {\n\n        // assume we use the mouse to interact per default\n        domEvent.bind(document, 'mousemove', move);\n\n        // prevent default browser drag and text selection behavior\n        domEvent.bind(document, 'dragstart', preventDefault);\n        domEvent.bind(document, 'selectstart', preventDefault);\n\n        domEvent.bind(document, 'mousedown', endDrag, true);\n        domEvent.bind(document, 'mouseup', endDrag, true);\n      }\n\n      domEvent.bind(document, 'keyup', checkCancel);\n\n      eventBus.on('element.hover', hover);\n      eventBus.on('element.out', out);\n    }\n\n    fire('init');\n\n    if (options.autoActivate) {\n      move(event, true);\n    }\n  }\n\n  // cancel on diagram destruction\n  eventBus.on('diagram.destroy', cancel);\n\n\n  // API\n\n  this.init = init;\n  this.move = move;\n  this.hover = hover;\n  this.out = out;\n  this.end = end;\n\n  this.cancel = cancel;\n\n  // for introspection\n\n  this.context = function() {\n    return context;\n  };\n\n  this.setOptions = function(options) {\n    assign(defaultOptions, options);\n  };\n}\n\nDragging.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'elementRegistry'\n];\n","import {\n  closest as domClosest\n} from 'min-dom';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Browsers may swallow certain events (hover, out ...) if users are to\n * fast with the mouse.\n *\n * @see http://stackoverflow.com/questions/7448468/why-cant-i-reliably-capture-a-mouseout-event\n *\n * The fix implemented in this component ensure that we\n *\n * 1) have a hover state after a successful drag.move event\n * 2) have an out event when dragging leaves an element\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {ElementRegistry} elementRegistry\n */\nexport default function HoverFix(eventBus, dragging, elementRegistry) {\n\n  var self = this;\n\n  /**\n   * Make sure we are god damn hovering!\n   *\n   * @param {Event} dragging event\n   */\n  function ensureHover(event) {\n\n    if (event.hover) {\n      return;\n    }\n\n    var originalEvent = event.originalEvent;\n\n    var gfx = self._findTargetGfx(originalEvent);\n\n    var element = gfx && elementRegistry.get(gfx);\n\n    if (gfx && element) {\n\n      // 1) cancel current mousemove\n      event.stopPropagation();\n\n      // 2) emit fake hover for new target\n      dragging.hover({ element: element, gfx: gfx });\n\n      // 3) re-trigger move event\n      dragging.move(originalEvent);\n    }\n  }\n\n  /**\n   * We wait for a specific sequence of events before\n   * emitting a fake drag.hover event.\n   *\n   * Event Sequence:\n   *\n   * drag.start\n   * drag.move >> ensure we are hovering\n   */\n  eventBus.on('drag.start', function(event) {\n\n    eventBus.once('drag.move', HIGH_PRIORITY, function(event) {\n\n      ensureHover(event);\n\n    });\n\n  });\n\n\n  /**\n   * We make sure that drag.out is always fired, even if the\n   * browser swallows an element.out event.\n   *\n   * Event sequence:\n   *\n   * drag.hover\n   * (element.out >> sometimes swallowed)\n   * element.hover >> ensure we fired drag.out\n   */\n  eventBus.on('drag.init', function() {\n\n    var hover, hoverGfx;\n\n    function setDragHover(event) {\n      hover = event.hover;\n      hoverGfx = event.hoverGfx;\n    }\n\n    function unsetHover() {\n      hover = null;\n      hoverGfx = null;\n    }\n\n    function ensureOut() {\n\n      if (!hover) {\n        return;\n      }\n\n      var element = hover,\n          gfx = hoverGfx;\n\n      hover = null;\n      hoverGfx = null;\n\n      // emit synthetic out event\n      dragging.out({\n        element: element,\n        gfx: gfx\n      });\n    }\n\n    eventBus.on('drag.hover', setDragHover);\n    eventBus.on('element.out', unsetHover);\n    eventBus.on('element.hover', HIGH_PRIORITY, ensureOut);\n\n    eventBus.once('drag.cleanup', function() {\n      eventBus.off('drag.hover', setDragHover);\n      eventBus.off('element.out', unsetHover);\n      eventBus.off('element.hover', ensureOut);\n    });\n\n  });\n\n  this._findTargetGfx = function(event) {\n    var position,\n        target;\n\n    if (!(event instanceof MouseEvent)) {\n      return;\n    }\n\n    position = toPoint(event);\n\n    // damn expensive operation, ouch!\n    target = document.elementFromPoint(position.x, position.y);\n\n    return getGfx(target);\n  };\n\n}\n\nHoverFix.$inject = [\n  'eventBus',\n  'dragging',\n  'elementRegistry'\n];\n\n\n// helpers /////////////////////\n\nfunction getGfx(target) {\n  return domClosest(target, 'svg, .djs-element', true);\n}","import SelectionModule from '../selection';\n\nimport Dragging from './Dragging';\nimport HoverFix from './HoverFix';\n\nexport default {\n  __init__: [\n    'hoverFix'\n  ],\n  __depends__: [\n    SelectionModule\n  ],\n  dragging: [ 'type', Dragging ],\n  hoverFix: [ 'type', HoverFix ]\n};","import { assign } from 'min-dash';\n\nimport {\n  toPoint\n} from '../../util/Event';\n\n\n/**\n * Initiates canvas scrolling if current cursor point is close to a border.\n * Cancelled when current point moves back inside the scrolling borders\n * or cancelled manually.\n *\n * Default options :\n *   scrollThresholdIn: [ 20, 20, 20, 20 ],\n *   scrollThresholdOut: [ 0, 0, 0, 0 ],\n *   scrollRepeatTimeout: 15,\n *   scrollStep: 10\n *\n * Threshold order:\n *   [ left, top, right, bottom ]\n */\nexport default function AutoScroll(config, eventBus, canvas) {\n\n  this._canvas = canvas;\n\n  this._opts = assign({\n    scrollThresholdIn: [ 20, 20, 20, 20 ],\n    scrollThresholdOut: [ 0, 0, 0, 0 ],\n    scrollRepeatTimeout: 15,\n    scrollStep: 10\n  }, config);\n\n  var self = this;\n\n  eventBus.on('drag.move', function(e) {\n    var point = self._toBorderPoint(e);\n\n    self.startScroll(point);\n  });\n\n  eventBus.on([ 'drag.cleanup' ], function() {\n    self.stopScroll();\n  });\n}\n\nAutoScroll.$inject = [\n  'config.autoScroll',\n  'eventBus',\n  'canvas'\n];\n\n\n/**\n * Starts scrolling loop.\n * Point is given in global scale in canvas container box plane.\n *\n * @param  {Object} point { x: X, y: Y }\n */\nAutoScroll.prototype.startScroll = function(point) {\n\n  var canvas = this._canvas;\n  var opts = this._opts;\n  var self = this;\n\n  var clientRect = canvas.getContainer().getBoundingClientRect();\n\n  var diff = [\n    point.x,\n    point.y,\n    clientRect.width - point.x,\n    clientRect.height - point.y\n  ];\n\n  this.stopScroll();\n\n  var dx = 0,\n      dy = 0;\n\n  for (var i = 0; i < 4; i++) {\n    if (between(diff[i], opts.scrollThresholdOut[i], opts.scrollThresholdIn[i])) {\n      if (i === 0) {\n        dx = opts.scrollStep;\n      } else if (i == 1) {\n        dy = opts.scrollStep;\n      } else if (i == 2) {\n        dx = -opts.scrollStep;\n      } else if (i == 3) {\n        dy = -opts.scrollStep;\n      }\n    }\n  }\n\n  if (dx !== 0 || dy !== 0) {\n    canvas.scroll({ dx: dx, dy: dy });\n\n    this._scrolling = setTimeout(function() {\n      self.startScroll(point);\n    }, opts.scrollRepeatTimeout);\n  }\n};\n\nfunction between(val, start, end) {\n  if (start < val && val < end) {\n    return true;\n  }\n\n  return false;\n}\n\n\n/**\n * Stops scrolling loop.\n */\nAutoScroll.prototype.stopScroll = function() {\n  clearTimeout(this._scrolling);\n};\n\n\n/**\n * Overrides defaults options.\n *\n * @param  {Object} options\n */\nAutoScroll.prototype.setOptions = function(options) {\n  this._opts = assign({}, this._opts, options);\n};\n\n\n/**\n * Converts event to a point in canvas container plane in global scale.\n *\n * @param  {Event} event\n * @return {Point}\n */\nAutoScroll.prototype._toBorderPoint = function(event) {\n  var clientRect = this._canvas._container.getBoundingClientRect();\n\n  var globalPosition = toPoint(event.originalEvent);\n\n  return {\n    x: globalPosition.x - clientRect.left,\n    y: globalPosition.y - clientRect.top\n  };\n};","import DraggingModule from '../dragging';\n\nimport AutoScroll from './AutoScroll';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n  ],\n  __init__: [ 'autoScroll' ],\n  autoScroll: [ 'type', AutoScroll ]\n};","/**\n * A service that provides rules for certain diagram actions.\n *\n * The default implementation will hook into the {@link CommandStack}\n * to perform the actual rule evaluation. Make sure to provide the\n * `commandStack` service with this module if you plan to use it.\n *\n * Together with this implementation you may use the {@link RuleProvider}\n * to implement your own rule checkers.\n *\n * This module is ment to be easily replaced, thus the tiny foot print.\n *\n * @param {Injector} injector\n */\nexport default function Rules(injector) {\n  this._commandStack = injector.get('commandStack', false);\n}\n\nRules.$inject = [ 'injector' ];\n\n\n/**\n * Returns whether or not a given modeling action can be executed\n * in the specified context.\n *\n * This implementation will respond with allow unless anyone\n * objects.\n *\n * @param {String} action the action to be checked\n * @param {Object} [context] the context to check the action in\n *\n * @return {Boolean} returns true, false or null depending on whether the\n *                   operation is allowed, not allowed or should be ignored.\n */\nRules.prototype.allowed = function(action, context) {\n  var allowed = true;\n\n  var commandStack = this._commandStack;\n\n  if (commandStack) {\n    allowed = commandStack.canExecute(action, context);\n  }\n\n  // map undefined to true, i.e. no rules\n  return allowed === undefined ? true : allowed;\n};","import Rules from './Rules';\n\nexport default {\n  __init__: [ 'rules' ],\n  rules: [ 'type', Rules ]\n};\n","import {\n  pointDistance\n} from './Geometry';\n\nimport intersectPaths from 'path-intersection';\n\nvar round = Math.round,\n    max = Math.max;\n\n\nfunction circlePath(center, r) {\n  var x = center.x,\n      y = center.y;\n\n  return [\n    ['M', x, y],\n    ['m', 0, -r],\n    ['a', r, r, 0, 1, 1, 0, 2 * r],\n    ['a', r, r, 0, 1, 1, 0, -2 * r],\n    ['z']\n  ];\n}\n\nfunction linePath(points) {\n  var segments = [];\n\n  points.forEach(function(p, idx) {\n    segments.push([ idx === 0 ? 'M' : 'L', p.x, p.y ]);\n  });\n\n  return segments;\n}\n\n\nvar INTERSECTION_THRESHOLD = 10;\n\nfunction getBendpointIntersection(waypoints, reference) {\n\n  var i, w;\n\n  for (i = 0; (w = waypoints[i]); i++) {\n\n    if (pointDistance(w, reference) <= INTERSECTION_THRESHOLD) {\n      return {\n        point: waypoints[i],\n        bendpoint: true,\n        index: i\n      };\n    }\n  }\n\n  return null;\n}\n\nfunction getPathIntersection(waypoints, reference) {\n\n  var intersections = intersectPaths(circlePath(reference, INTERSECTION_THRESHOLD), linePath(waypoints));\n\n  var a = intersections[0],\n      b = intersections[intersections.length - 1],\n      idx;\n\n  if (!a) {\n\n    // no intersection\n    return null;\n  }\n\n  if (a !== b) {\n\n    if (a.segment2 !== b.segment2) {\n\n      // we use the bendpoint in between both segments\n      // as the intersection point\n\n      idx = max(a.segment2, b.segment2) - 1;\n\n      return {\n        point: waypoints[idx],\n        bendpoint: true,\n        index: idx\n      };\n    }\n\n    return {\n      point: {\n        x: (round(a.x + b.x) / 2),\n        y: (round(a.y + b.y) / 2)\n      },\n      index: a.segment2\n    };\n  }\n\n  return {\n    point: {\n      x: round(a.x),\n      y: round(a.y)\n    },\n    index: a.segment2\n  };\n}\n\n/**\n * Returns the closest point on the connection towards a given reference point.\n *\n * @param  {Array<Point>} waypoints\n * @param  {Point} reference\n *\n * @return {Object} intersection data (segment, point)\n */\nexport function getApproxIntersection(waypoints, reference) {\n  return getBendpointIntersection(waypoints, reference) || getPathIntersection(waypoints, reference);\n}\n","import {\n  toPoint\n} from '../../util/Event';\n\nimport {\n  getMidPoint,\n  pointsAligned\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  rotate,\n  translate\n} from '../../util/SvgTransformUtil';\n\nimport {\n  getApproxIntersection\n} from '../../util/LineIntersection';\n\nexport var BENDPOINT_CLS = 'djs-bendpoint';\nexport var SEGMENT_DRAGGER_CLS = 'djs-segment-dragger';\n\nexport function toCanvasCoordinates(canvas, event) {\n\n  var position = toPoint(event),\n      clientRect = canvas._container.getBoundingClientRect(),\n      offset;\n\n  // canvas relative position\n\n  offset = {\n    x: clientRect.left,\n    y: clientRect.top\n  };\n\n  // update actual event payload with canvas relative measures\n\n  var viewbox = canvas.viewbox();\n\n  return {\n    x: viewbox.x + (position.x - offset.x) / viewbox.scale,\n    y: viewbox.y + (position.y - offset.y) / viewbox.scale\n  };\n}\n\nexport function getConnectionIntersection(canvas, waypoints, event) {\n  var localPosition = toCanvasCoordinates(canvas, event),\n      intersection = getApproxIntersection(waypoints, localPosition);\n\n  return intersection;\n}\n\nexport function addBendpoint(parentGfx, cls) {\n  var groupGfx = svgCreate('g');\n  svgClasses(groupGfx).add(BENDPOINT_CLS);\n\n  svgAppend(parentGfx, groupGfx);\n\n  var visual = svgCreate('circle');\n  svgAttr(visual, {\n    cx: 0,\n    cy: 0,\n    r: 4\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(groupGfx, visual);\n\n  var hit = svgCreate('circle');\n  svgAttr(hit, {\n    cx: 0,\n    cy: 0,\n    r: 10\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(groupGfx, hit);\n\n  if (cls) {\n    svgClasses(groupGfx).add(cls);\n  }\n\n  return groupGfx;\n}\n\nfunction createParallelDragger(parentGfx, segmentStart, segmentEnd, alignment) {\n  var draggerGfx = svgCreate('g');\n\n  svgAppend(parentGfx, draggerGfx);\n\n  var width = 14,\n      height = 3,\n      padding = 6,\n      hitWidth = calculateHitWidth(segmentStart, segmentEnd, alignment),\n      hitHeight = height + padding;\n\n  var visual = svgCreate('rect');\n  svgAttr(visual, {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  });\n  svgClasses(visual).add('djs-visual');\n\n  svgAppend(draggerGfx, visual);\n\n  var hit = svgCreate('rect');\n  svgAttr(hit, {\n    x: -hitWidth / 2,\n    y: -hitHeight / 2,\n    width: hitWidth,\n    height: hitHeight\n  });\n  svgClasses(hit).add('djs-hit');\n\n  svgAppend(draggerGfx, hit);\n\n  rotate(draggerGfx, alignment === 'v' ? 90 : 0, 0, 0);\n\n  return draggerGfx;\n}\n\n\nexport function addSegmentDragger(parentGfx, segmentStart, segmentEnd) {\n\n  var groupGfx = svgCreate('g'),\n      mid = getMidPoint(segmentStart, segmentEnd),\n      alignment = pointsAligned(segmentStart, segmentEnd);\n\n  svgAppend(parentGfx, groupGfx);\n\n  createParallelDragger(groupGfx, segmentStart, segmentEnd, alignment);\n\n  svgClasses(groupGfx).add(SEGMENT_DRAGGER_CLS);\n  svgClasses(groupGfx).add(alignment === 'h' ? 'horizontal' : 'vertical');\n\n  translate(groupGfx, mid.x, mid.y);\n\n  return groupGfx;\n}\n\n/**\n * Calculates region for segment move which is 2/3 of the full segment length\n * @param {Number} segmentLength\n *\n * @return {Number}\n */\nexport function calculateSegmentMoveRegion(segmentLength) {\n  return Math.abs(Math.round(segmentLength * 2 / 3));\n}\n\n// helper //////////\n\nfunction calculateHitWidth(segmentStart, segmentEnd, alignment) {\n  var segmentLengthXAxis = segmentEnd.x - segmentStart.x,\n      segmentLengthYAxis = segmentEnd.y - segmentStart.y;\n\n  return alignment === 'h' ?\n    calculateSegmentMoveRegion(segmentLengthXAxis) :\n    calculateSegmentMoveRegion(segmentLengthYAxis);\n}\n","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import { forEach } from 'min-dash';\n\nimport {\n  event as domEvent,\n  query as domQuery,\n  queryAll as domQueryAll\n} from 'min-dom';\n\nimport {\n  BENDPOINT_CLS,\n  SEGMENT_DRAGGER_CLS,\n  addBendpoint,\n  addSegmentDragger,\n  calculateSegmentMoveRegion,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  escapeCSS\n} from '../../util/EscapeUtil';\n\nimport {\n  pointsAligned,\n  getMidPoint\n} from '../../util/Geometry';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\n/**\n * A service that adds editable bendpoints to connections.\n */\nexport default function Bendpoints(\n    eventBus, canvas, interactionEvents,\n    bendpointMove, connectionSegmentMove) {\n\n  /**\n   * Returns true if intersection point is inside middle region of segment, adjusted by\n   * optional threshold\n   */\n  function isIntersectionMiddle(intersection, waypoints, treshold) {\n    var idx = intersection.index,\n        p = intersection.point,\n        p0, p1, mid, aligned, xDelta, yDelta;\n\n    if (idx <= 0 || intersection.bendpoint) {\n      return false;\n    }\n\n    p0 = waypoints[idx - 1];\n    p1 = waypoints[idx];\n    mid = getMidPoint(p0, p1),\n    aligned = pointsAligned(p0, p1);\n    xDelta = Math.abs(p.x - mid.x);\n    yDelta = Math.abs(p.y - mid.y);\n\n    return aligned && xDelta <= treshold && yDelta <= treshold;\n  }\n\n  /**\n   * Calculates the threshold from a connection's middle which fits the two-third-region\n   */\n  function calculateIntersectionThreshold(connection, intersection) {\n    var waypoints = connection.waypoints,\n        relevantSegment, alignment, segmentLength, threshold;\n\n    if (intersection.index <= 0 || intersection.bendpoint) {\n      return null;\n    }\n\n    // segment relative to connection intersection\n    relevantSegment = {\n      start: waypoints[intersection.index - 1],\n      end: waypoints[intersection.index]\n    };\n\n    alignment = pointsAligned(relevantSegment.start, relevantSegment.end);\n\n    if (!alignment) {\n      return null;\n    }\n\n    if (alignment === 'h') {\n      segmentLength = relevantSegment.end.x - relevantSegment.start.x;\n    } else {\n      segmentLength = relevantSegment.end.y - relevantSegment.start.y;\n    }\n\n    // calculate threshold relative to 2/3 of segment length\n    threshold = calculateSegmentMoveRegion(segmentLength) / 2;\n\n    return threshold;\n  }\n\n  function activateBendpointMove(event, connection) {\n    var waypoints = connection.waypoints,\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        threshold;\n\n    if (!intersection) {\n      return;\n    }\n\n    threshold = calculateIntersectionThreshold(connection, intersection);\n\n    if (isIntersectionMiddle(intersection, waypoints, threshold)) {\n      connectionSegmentMove.start(event, connection, intersection.index);\n    } else {\n      bendpointMove.start(event, connection, intersection.index, !intersection.bendpoint);\n    }\n\n    // we've handled the event\n    return true;\n  }\n\n  function bindInteractionEvents(node, eventName, element) {\n\n    domEvent.bind(node, eventName, function(event) {\n      interactionEvents.triggerMouseEvent(eventName, event, element);\n      event.stopPropagation();\n    });\n  }\n\n  function getBendpointsContainer(element, create) {\n\n    var layer = canvas.getLayer('overlays'),\n        gfx = domQuery('.djs-bendpoints[data-element-id=\"' + escapeCSS(element.id) + '\"]', layer);\n\n    if (!gfx && create) {\n      gfx = svgCreate('g');\n      svgAttr(gfx, { 'data-element-id': element.id });\n      svgClasses(gfx).add('djs-bendpoints');\n\n      svgAppend(layer, gfx);\n\n      bindInteractionEvents(gfx, 'mousedown', element);\n      bindInteractionEvents(gfx, 'click', element);\n      bindInteractionEvents(gfx, 'dblclick', element);\n    }\n\n    return gfx;\n  }\n\n  function getSegmentDragger(idx, parentGfx) {\n    return domQuery(\n      '.djs-segment-dragger[data-segment-idx=\"' + idx + '\"]',\n      parentGfx\n    );\n  }\n\n  function createBendpoints(gfx, connection) {\n    connection.waypoints.forEach(function(p, idx) {\n      var bendpoint = addBendpoint(gfx);\n\n      svgAppend(gfx, bendpoint);\n\n      translate(bendpoint, p.x, p.y);\n    });\n\n    // add floating bendpoint\n    addBendpoint(gfx, 'floating');\n  }\n\n  function createSegmentDraggers(gfx, connection) {\n\n    var waypoints = connection.waypoints;\n\n    var segmentStart,\n        segmentEnd,\n        segmentDraggerGfx;\n\n    for (var i = 1; i < waypoints.length; i++) {\n\n      segmentStart = waypoints[i - 1];\n      segmentEnd = waypoints[i];\n\n      if (pointsAligned(segmentStart, segmentEnd)) {\n        segmentDraggerGfx = addSegmentDragger(gfx, segmentStart, segmentEnd);\n\n        svgAttr(segmentDraggerGfx, { 'data-segment-idx': i });\n\n        bindInteractionEvents(segmentDraggerGfx, 'mousemove', connection);\n      }\n    }\n  }\n\n  function clearBendpoints(gfx) {\n    forEach(domQueryAll('.' + BENDPOINT_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function clearSegmentDraggers(gfx) {\n    forEach(domQueryAll('.' + SEGMENT_DRAGGER_CLS, gfx), function(node) {\n      svgRemove(node);\n    });\n  }\n\n  function addHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (!gfx) {\n      gfx = getBendpointsContainer(connection, true);\n\n      createBendpoints(gfx, connection);\n      createSegmentDraggers(gfx, connection);\n    }\n\n    return gfx;\n  }\n\n  function updateHandles(connection) {\n\n    var gfx = getBendpointsContainer(connection);\n\n    if (gfx) {\n      clearSegmentDraggers(gfx);\n      clearBendpoints(gfx);\n      createSegmentDraggers(gfx, connection);\n      createBendpoints(gfx, connection);\n    }\n  }\n\n  function updateFloatingBendpointPosition(parentGfx, intersection) {\n    var floating = domQuery('.floating', parentGfx),\n        point = intersection.point;\n\n    if (!floating) {\n      return;\n    }\n\n    translate(floating, point.x, point.y);\n\n  }\n\n  function updateSegmentDraggerPosition(parentGfx, intersection, waypoints) {\n\n    var draggerGfx = getSegmentDragger(intersection.index, parentGfx),\n        segmentStart = waypoints[intersection.index - 1],\n        segmentEnd = waypoints[intersection.index],\n        point = intersection.point,\n        mid = getMidPoint(segmentStart, segmentEnd),\n        alignment = pointsAligned(segmentStart, segmentEnd),\n        draggerVisual, relativePosition;\n\n    if (!draggerGfx) {\n      return;\n    }\n\n    draggerVisual = getDraggerVisual(draggerGfx);\n\n    relativePosition = {\n      x: point.x - mid.x,\n      y: point.y - mid.y\n    };\n\n    if (alignment === 'v') {\n\n      // rotate position\n      relativePosition = {\n        x: relativePosition.y,\n        y: relativePosition.x\n      };\n    }\n\n    translate(draggerVisual, relativePosition.x, relativePosition.y);\n  }\n\n  eventBus.on('connection.changed', function(event) {\n    updateHandles(event.element);\n  });\n\n  eventBus.on('connection.remove', function(event) {\n    var gfx = getBendpointsContainer(event.element);\n\n    if (gfx) {\n      svgRemove(gfx);\n    }\n  });\n\n  eventBus.on('element.marker.update', function(event) {\n\n    var element = event.element,\n        bendpointsGfx;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    bendpointsGfx = addHandles(element);\n\n    if (event.add) {\n      svgClasses(bendpointsGfx).add(event.marker);\n    } else {\n      svgClasses(bendpointsGfx).remove(event.marker);\n    }\n  });\n\n  eventBus.on('element.mousemove', function(event) {\n\n    var element = event.element,\n        waypoints = element.waypoints,\n        bendpointsGfx,\n        intersection;\n\n    if (waypoints) {\n      bendpointsGfx = getBendpointsContainer(element, true);\n\n      intersection = getConnectionIntersection(canvas, waypoints, event.originalEvent);\n\n      if (!intersection) {\n        return;\n      }\n\n      updateFloatingBendpointPosition(bendpointsGfx, intersection);\n\n      if (!intersection.bendpoint) {\n        updateSegmentDraggerPosition(bendpointsGfx, intersection, waypoints);\n      }\n\n    }\n  });\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = event.originalEvent,\n        element = event.element;\n\n    if (!element.waypoints) {\n      return;\n    }\n\n    return activateBendpointMove(originalEvent, element);\n  });\n\n  eventBus.on('selection.changed', function(event) {\n    var newSelection = event.newSelection,\n        primary = newSelection[0];\n\n    if (primary && primary.waypoints) {\n      addHandles(primary);\n    }\n  });\n\n  eventBus.on('element.hover', function(event) {\n    var element = event.element;\n\n    if (element.waypoints) {\n      addHandles(element);\n      interactionEvents.registerEvent(event.gfx, 'mousemove', 'element.mousemove');\n    }\n  });\n\n  eventBus.on('element.out', function(event) {\n    interactionEvents.unregisterEvent(event.gfx, 'mousemove', 'element.mousemove');\n  });\n\n  // update bendpoint container data attribute on element ID change\n  eventBus.on('element.updateId', function(context) {\n    var element = context.element,\n        newId = context.newId;\n\n    if (element.waypoints) {\n      var bendpointContainer = getBendpointsContainer(element);\n\n      if (bendpointContainer) {\n        svgAttr(bendpointContainer, { 'data-element-id': newId });\n      }\n    }\n  });\n\n  // API\n\n  this.addHandles = addHandles;\n  this.updateHandles = updateHandles;\n  this.getBendpointsContainer = getBendpointsContainer;\n  this.getSegmentDragger = getSegmentDragger;\n}\n\nBendpoints.$inject = [\n  'eventBus',\n  'canvas',\n  'interactionEvents',\n  'bendpointMove',\n  'connectionSegmentMove'\n];\n\n\n\n// helper /////////////\n\nfunction getDraggerVisual(draggerGfx) {\n  return domQuery('.djs-visual', draggerGfx);\n}","import { filterRedundantWaypoints } from '../../layout/LayoutUtil';\n\nvar round = Math.round;\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\n\n/**\n * Move bendpoints through drag and drop to add/remove bendpoints or reconnect connection.\n */\nexport default function BendpointMove(injector, eventBus, canvas, dragging, rules, modeling) {\n  this._injector = injector;\n\n  this.start = function(event, connection, bendpointIndex, insert) {\n    var gfx = canvas.getGraphics(connection),\n        source = connection.source,\n        target = connection.target,\n        waypoints = connection.waypoints,\n        type;\n\n    if (!insert && bendpointIndex === 0) {\n      type = RECONNECT_START;\n    } else\n    if (!insert && bendpointIndex === waypoints.length - 1) {\n      type = RECONNECT_END;\n    } else {\n      type = UPDATE_WAYPOINTS;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    var allowed = rules.allowed(command, {\n      connection: connection,\n      source: source,\n      target: target\n    });\n\n    if (allowed === false) {\n      allowed = rules.allowed(command, {\n        connection: connection,\n        source: target,\n        target: source\n      });\n    }\n\n    if (allowed === false) {\n      return;\n    }\n\n    dragging.init(event, 'bendpoint.move', {\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: {\n          allowed: allowed,\n          bendpointIndex: bendpointIndex,\n          connection: connection,\n          source: source,\n          target: target,\n          insert: insert,\n          type: type\n        }\n      }\n    });\n  };\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hover = event.hover,\n        type = context.type;\n\n    // cache hover state\n    context.hover = hover;\n\n    var allowed;\n\n    if (!hover) {\n      return;\n    }\n\n    var command = type === UPDATE_WAYPOINTS ? 'connection.updateWaypoints' : 'connection.reconnect';\n\n    allowed = context.allowed = rules.allowed(command, {\n      connection: connection,\n      source: type === RECONNECT_START ? hover : source,\n      target: type === RECONNECT_END ? hover : target\n    });\n\n    if (allowed) {\n      context.source = type === RECONNECT_START ? hover : source;\n      context.target = type === RECONNECT_END ? hover : target;\n\n      return;\n    }\n\n    if (allowed === false) {\n      allowed = context.allowed = rules.allowed(command, {\n        connection: connection,\n        source: type === RECONNECT_END ? hover : target,\n        target: type === RECONNECT_START ? hover : source\n      });\n    }\n\n    if (allowed) {\n      context.source = type === RECONNECT_END ? hover : target;\n      context.target = type === RECONNECT_START ? hover : source;\n    }\n  });\n\n  eventBus.on([ 'bendpoint.move.out', 'bendpoint.move.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.allowed = false;\n  });\n\n  eventBus.on('bendpoint.move.end', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        newWaypoints = connection.waypoints.slice(),\n        source = context.source,\n        target = context.target,\n        type = context.type,\n        hints = {};\n\n    // ensure integer values (important if zoom level was > 1 during move)\n    var docking = {\n      x: round(event.x),\n      y: round(event.y)\n    };\n\n    if (!allowed) {\n      return false;\n    }\n\n    if (type === UPDATE_WAYPOINTS) {\n      if (insert) {\n\n        // insert new bendpoint\n        newWaypoints.splice(bendpointIndex, 0, docking);\n      } else {\n\n        // swap previous waypoint with moved one\n        newWaypoints[bendpointIndex] = docking;\n      }\n\n      // pass hints about actual moved bendpoint\n      // useful for connection/label layout\n      hints = {\n        bendpointMove: {\n          insert: insert,\n          bendpointIndex: bendpointIndex\n        }\n      };\n\n      newWaypoints = this.cropWaypoints(connection, newWaypoints);\n\n      modeling.updateWaypoints(connection, filterRedundantWaypoints(newWaypoints), hints);\n    } else {\n      if (type === RECONNECT_START) {\n        hints.docking = 'source';\n\n        if (isReverse(context)) {\n          hints.docking = 'target';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      } else if (type === RECONNECT_END) {\n        hints.docking = 'target';\n\n        if (isReverse(context)) {\n          hints.docking = 'source';\n\n          hints.newWaypoints = newWaypoints.reverse();\n        }\n      }\n\n      modeling.reconnect(connection, source, target, docking, hints);\n    }\n  }, this);\n}\n\nBendpointMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'rules',\n  'modeling'\n];\n\nBendpointMove.prototype.cropWaypoints = function(connection, newWaypoints) {\n  var connectionDocking = this._injector.get('connectionDocking', false);\n\n  if (!connectionDocking) {\n    return newWaypoints;\n  }\n\n  var waypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n\n  newWaypoints = connection.waypoints;\n\n  connection.waypoints = waypoints;\n\n  return newWaypoints;\n};\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target,\n      type = context.type;\n\n  if (type === RECONNECT_START) {\n    return hover && target && hover === target && source !== target;\n  }\n\n  if (type === RECONNECT_END) {\n    return hover && source && hover === source && source !== target;\n  }\n}","import {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { addBendpoint } from './BendpointUtil';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nimport { isReverse } from './BendpointMove';\n\nvar RECONNECT_START = 'reconnectStart',\n    RECONNECT_END = 'reconnectEnd',\n    UPDATE_WAYPOINTS = 'updateWaypoints';\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok',\n    MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating',\n    MARKER_ELEMENT_HIDDEN = 'djs-element-hidden';\n\nvar HIGH_PRIORITY = 1100;\n\n/**\n * Preview connection while moving bendpoints.\n */\nexport default function BendpointMovePreview(bendpointMove, injector, eventBus, canvas) {\n  this._injector = injector;\n\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  eventBus.on('bendpoint.move.start', function(event) {\n    var context = event.context,\n        bendpointIndex = context.bendpointIndex,\n        connection = context.connection,\n        insert = context.insert,\n        waypoints = connection.waypoints,\n        newWaypoints = waypoints.slice();\n\n    context.waypoints = waypoints;\n\n    if (insert) {\n\n      // insert placeholder for new bendpoint\n      newWaypoints.splice(bendpointIndex, 0, { x: event.x, y: event.y });\n    }\n\n    connection.waypoints = newWaypoints;\n\n    // add dragger gfx\n    var draggerGfx = context.draggerGfx = addBendpoint(canvas.getLayer('overlays'));\n\n    svgClasses(draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_ELEMENT_HIDDEN);\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('bendpoint.move.hover', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        hover = context.hover,\n        type = context.type;\n\n    if (hover) {\n      canvas.addMarker(hover, MARKER_CONNECT_HOVER);\n\n      if (type === UPDATE_WAYPOINTS) {\n        return;\n      }\n\n      if (allowed) {\n        canvas.removeMarker(hover, MARKER_NOT_OK);\n        canvas.addMarker(hover, MARKER_OK);\n      } else if (allowed === false) {\n        canvas.removeMarker(hover, MARKER_OK);\n        canvas.addMarker(hover, MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([\n    'bendpoint.move.out',\n    'bendpoint.move.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        hover = context.hover,\n        target = context.target;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n  eventBus.on('bendpoint.move.move', function(event) {\n    var context = event.context,\n        allowed = context.allowed,\n        bendpointIndex = context.bendpointIndex,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        type = context.type,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        newWaypoints = connection.waypoints.slice(),\n        bendpoint = { x: event.x, y: event.y },\n        hints;\n\n    if (connectionPreview) {\n      hints = {\n        source: source,\n        target: target\n      };\n\n      if (type === RECONNECT_START) {\n        if (isReverse(context)) {\n          hints.connectionEnd = bendpoint;\n          hints.source = target;\n          hints.target = hover || source;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          hints.connectionStart = bendpoint;\n          hints.source = hover || source;\n        }\n      } else if (type === RECONNECT_END) {\n        if (isReverse(context)) {\n          hints.connectionStart = bendpoint;\n          hints.target = source;\n          hints.source = hover || target;\n\n          newWaypoints = newWaypoints.reverse();\n        } else {\n          hints.connectionEnd = bendpoint;\n          hints.target = hover || target;\n        }\n\n      } else {\n        hints.noCropping = true;\n        hints.noLayout = true;\n        newWaypoints[ bendpointIndex ] = bendpoint;\n      }\n\n      if (type === UPDATE_WAYPOINTS) {\n        newWaypoints = bendpointMove.cropWaypoints(connection, newWaypoints);\n      }\n\n      hints.waypoints = newWaypoints;\n\n      connectionPreview.drawPreview(context, allowed, hints);\n    }\n\n    translate(draggerGfx, event.x, event.y);\n  }, this);\n\n  eventBus.on([\n    'bendpoint.move.end',\n    'bendpoint.move.cancel'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        draggerGfx = context.draggerGfx,\n        hover = context.hover,\n        target = context.target,\n        waypoints = context.waypoints;\n\n    connection.waypoints = waypoints;\n\n    // remove dragger gfx\n    svgRemove(draggerGfx);\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n    canvas.removeMarker(connection, MARKER_ELEMENT_HIDDEN);\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, target ? MARKER_OK : MARKER_NOT_OK);\n    }\n\n    if (connectionPreview) {\n      connectionPreview.cleanUp(context);\n    }\n  });\n}\n\nBendpointMovePreview.$inject = [\n  'bendpointMove',\n  'injector',\n  'eventBus',\n  'canvas'\n];","import {\n  pointsAligned,\n  pointsOnLine\n} from '../../util/Geometry';\n\nimport {\n  addSegmentDragger,\n  getConnectionIntersection\n} from './BendpointUtil';\n\nimport {\n  getMid,\n  getOrientation\n} from '../../layout/LayoutUtil';\n\nvar MARKER_CONNECT_HOVER = 'connect-hover',\n    MARKER_CONNECT_UPDATING = 'djs-updating';\n\nimport {\n  classes as svgClasses,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\n\nfunction axisAdd(point, axis, delta) {\n  return axisSet(point, axis, point[axis] + delta);\n}\n\nfunction axisSet(point, axis, value) {\n  return {\n    x: (axis === 'x' ? value : point.x),\n    y: (axis === 'y' ? value : point.y)\n  };\n}\n\nfunction axisFenced(position, segmentStart, segmentEnd, axis) {\n\n  var maxValue = Math.max(segmentStart[axis], segmentEnd[axis]),\n      minValue = Math.min(segmentStart[axis], segmentEnd[axis]);\n\n  var padding = 20;\n\n  var fencedValue = Math.min(Math.max(minValue + padding, position[axis]), maxValue - padding);\n\n  return axisSet(segmentStart, axis, fencedValue);\n}\n\nfunction flipAxis(axis) {\n  return axis === 'x' ? 'y' : 'x';\n}\n\n/**\n * Get the docking point on the given element.\n *\n * Compute a reasonable docking, if non exists.\n *\n * @param  {Point} point\n * @param  {djs.model.Shape} referenceElement\n * @param  {String} moveAxis (x|y)\n *\n * @return {Point}\n */\nfunction getDocking(point, referenceElement, moveAxis) {\n\n  var referenceMid,\n      inverseAxis;\n\n  if (point.original) {\n    return point.original;\n  } else {\n    referenceMid = getMid(referenceElement);\n    inverseAxis = flipAxis(moveAxis);\n\n    return axisSet(point, inverseAxis, referenceMid[inverseAxis]);\n  }\n}\n\n/**\n * A component that implements moving of bendpoints\n */\nexport default function ConnectionSegmentMove(\n    injector, eventBus, canvas,\n    dragging, graphicsFactory, modeling) {\n\n  // optional connection docking integration\n  var connectionDocking = injector.get('connectionDocking', false);\n\n\n  // API\n\n  this.start = function(event, connection, idx) {\n\n    var context,\n        gfx = canvas.getGraphics(connection),\n        segmentStartIndex = idx - 1,\n        segmentEndIndex = idx,\n        waypoints = connection.waypoints,\n        segmentStart = waypoints[segmentStartIndex],\n        segmentEnd = waypoints[segmentEndIndex],\n        intersection = getConnectionIntersection(canvas, waypoints, event),\n        direction, axis, dragPosition;\n\n    direction = pointsAligned(segmentStart, segmentEnd);\n\n    // do not move diagonal connection\n    if (!direction) {\n      return;\n    }\n\n    // the axis where we are going to move things\n    axis = direction === 'v' ? 'x' : 'y';\n\n    if (segmentStartIndex === 0) {\n      segmentStart = getDocking(segmentStart, connection.source, axis);\n    }\n\n    if (segmentEndIndex === waypoints.length - 1) {\n      segmentEnd = getDocking(segmentEnd, connection.target, axis);\n    }\n\n    if (intersection) {\n      dragPosition = intersection.point;\n    } else {\n\n      // set to segment center as default\n      dragPosition = {\n        x: (segmentStart.x + segmentEnd.x) / 2,\n        y: (segmentStart.y + segmentEnd.y) / 2\n      };\n    }\n\n    context = {\n      connection: connection,\n      segmentStartIndex: segmentStartIndex,\n      segmentEndIndex: segmentEndIndex,\n      segmentStart: segmentStart,\n      segmentEnd: segmentEnd,\n      axis: axis,\n      dragPosition: dragPosition\n    };\n\n    dragging.init(event, dragPosition, 'connectionSegment.move', {\n      cursor: axis === 'x' ? 'resize-ew' : 'resize-ns',\n      data: {\n        connection: connection,\n        connectionGfx: gfx,\n        context: context\n      }\n    });\n  };\n\n  /**\n   * Crop connection if connection cropping is provided.\n   *\n   * @param {Connection} connection\n   * @param {Array<Point>} newWaypoints\n   *\n   * @return {Array<Point>} cropped connection waypoints\n   */\n  function cropConnection(connection, newWaypoints) {\n\n    // crop connection, if docking service is provided only\n    if (!connectionDocking) {\n      return newWaypoints;\n    }\n\n    var oldWaypoints = connection.waypoints,\n        croppedWaypoints;\n\n    // temporary set new waypoints\n    connection.waypoints = newWaypoints;\n\n    croppedWaypoints = connectionDocking.getCroppedWaypoints(connection);\n\n    // restore old waypoints\n    connection.waypoints = oldWaypoints;\n\n    return croppedWaypoints;\n  }\n\n  // DRAGGING IMPLEMENTATION\n\n  function redrawConnection(data) {\n    graphicsFactory.update('connection', data.connection, data.connectionGfx);\n  }\n\n  function updateDragger(context, segmentOffset, event) {\n\n    var newWaypoints = context.newWaypoints,\n        segmentStartIndex = context.segmentStartIndex + segmentOffset,\n        segmentStart = newWaypoints[segmentStartIndex],\n        segmentEndIndex = context.segmentEndIndex + segmentOffset,\n        segmentEnd = newWaypoints[segmentEndIndex],\n        axis = flipAxis(context.axis);\n\n    // make sure the dragger does not move\n    // outside the connection\n    var draggerPosition = axisFenced(event, segmentStart, segmentEnd, axis);\n\n    // update dragger\n    translate(context.draggerGfx, draggerPosition.x, draggerPosition.y);\n  }\n\n  /**\n   * Filter waypoints for redundant ones (i.e. on the same axis).\n   * Returns the filtered waypoints and the offset related to the segment move.\n   *\n   * @param {Array<Point>} waypoints\n   * @param {Integer} segmentStartIndex of moved segment start\n   *\n   * @return {Object} { filteredWaypoints, segmentOffset }\n   */\n  function filterRedundantWaypoints(waypoints, segmentStartIndex) {\n\n    var segmentOffset = 0;\n\n    var filteredWaypoints = waypoints.filter(function(r, idx) {\n      if (pointsOnLine(waypoints[idx - 1], waypoints[idx + 1], r)) {\n\n        // remove point and increment offset\n        segmentOffset = idx <= segmentStartIndex ? segmentOffset - 1 : segmentOffset;\n        return false;\n      }\n\n      // dont remove point\n      return true;\n    });\n\n    return {\n      waypoints: filteredWaypoints,\n      segmentOffset: segmentOffset\n    };\n  }\n\n  eventBus.on('connectionSegment.move.start', function(event) {\n\n    var context = event.context,\n        connection = event.connection,\n        layer = canvas.getLayer('overlays');\n\n    context.originalWaypoints = connection.waypoints.slice();\n\n    // add dragger gfx\n    context.draggerGfx = addSegmentDragger(layer, context.segmentStart, context.segmentEnd);\n    svgClasses(context.draggerGfx).add('djs-dragging');\n\n    canvas.addMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on('connectionSegment.move.move', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEndIndex = context.segmentEndIndex,\n        segmentStart = context.segmentStart,\n        segmentEnd = context.segmentEnd,\n        axis = context.axis;\n\n    var newWaypoints = context.originalWaypoints.slice(),\n        newSegmentStart = axisAdd(segmentStart, axis, event['d' + axis]),\n        newSegmentEnd = axisAdd(segmentEnd, axis, event['d' + axis]);\n\n    // original waypoint count and added / removed\n    // from start waypoint delta. We use the later\n    // to retrieve the updated segmentStartIndex / segmentEndIndex\n    var waypointCount = newWaypoints.length,\n        segmentOffset = 0;\n\n    // move segment start / end by axis delta\n    newWaypoints[segmentStartIndex] = newSegmentStart;\n    newWaypoints[segmentEndIndex] = newSegmentEnd;\n\n    var sourceToSegmentOrientation,\n        targetToSegmentOrientation;\n\n    // handle first segment\n    if (segmentStartIndex < 2) {\n      sourceToSegmentOrientation = getOrientation(connection.source, newSegmentStart);\n\n      // first bendpoint, remove first segment if intersecting\n      if (segmentStartIndex === 1) {\n\n        if (sourceToSegmentOrientation === 'intersect') {\n          newWaypoints.shift();\n          newWaypoints[0] = newSegmentStart;\n          segmentOffset--;\n        }\n      }\n\n      // docking point, add segment if not intersecting anymore\n      else {\n        if (sourceToSegmentOrientation !== 'intersect') {\n          newWaypoints.unshift(segmentStart);\n          segmentOffset++;\n        }\n      }\n    }\n\n    // handle last segment\n    if (segmentEndIndex > waypointCount - 3) {\n      targetToSegmentOrientation = getOrientation(connection.target, newSegmentEnd);\n\n      // last bendpoint, remove last segment if intersecting\n      if (segmentEndIndex === waypointCount - 2) {\n\n        if (targetToSegmentOrientation === 'intersect') {\n          newWaypoints.pop();\n          newWaypoints[newWaypoints.length - 1] = newSegmentEnd;\n        }\n      }\n\n      // last bendpoint, remove last segment if intersecting\n      else {\n        if (targetToSegmentOrientation !== 'intersect') {\n          newWaypoints.push(segmentEnd);\n        }\n      }\n    }\n\n    // update connection waypoints\n    context.newWaypoints = connection.waypoints = cropConnection(connection, newWaypoints);\n\n    // update dragger position\n    updateDragger(context, segmentOffset, event);\n\n    // save segmentOffset in context\n    context.newSegmentStartIndex = segmentStartIndex + segmentOffset;\n\n    // redraw connection\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.hover', function(event) {\n\n    event.context.hover = event.hover;\n    canvas.addMarker(event.hover, MARKER_CONNECT_HOVER);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.out',\n    'connectionSegment.move.cleanup'\n  ], function(event) {\n\n    // remove connect marker\n    // if it was added\n    var hover = event.context.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_CONNECT_HOVER);\n    }\n  });\n\n  eventBus.on('connectionSegment.move.cleanup', function(event) {\n\n    var context = event.context,\n        connection = context.connection;\n\n    // remove dragger gfx\n    if (context.draggerGfx) {\n      svgRemove(context.draggerGfx);\n    }\n\n    canvas.removeMarker(connection, MARKER_CONNECT_UPDATING);\n  });\n\n  eventBus.on([\n    'connectionSegment.move.cancel',\n    'connectionSegment.move.end'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    connection.waypoints = context.originalWaypoints;\n\n    redrawConnection(event);\n  });\n\n  eventBus.on('connectionSegment.move.end', function(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        newWaypoints = context.newWaypoints,\n        newSegmentStartIndex = context.newSegmentStartIndex;\n\n    // ensure we have actual pixel values bendpoint\n    // coordinates (important when zoom level was > 1 during move)\n    newWaypoints = newWaypoints.map(function(p) {\n      return {\n        original: p.original,\n        x: Math.round(p.x),\n        y: Math.round(p.y)\n      };\n    });\n\n    // apply filter redunant waypoints\n    var filtered = filterRedundantWaypoints(newWaypoints, newSegmentStartIndex);\n\n    // get filtered waypoints\n    var filteredWaypoints = filtered.waypoints,\n        croppedWaypoints = cropConnection(connection, filteredWaypoints),\n        segmentOffset = filtered.segmentOffset;\n\n    var hints = {\n      segmentMove: {\n        segmentStartIndex: context.segmentStartIndex,\n        newSegmentStartIndex: newSegmentStartIndex + segmentOffset\n      }\n    };\n\n    modeling.updateWaypoints(connection, croppedWaypoints, hints);\n  });\n}\n\nConnectionSegmentMove.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'dragging',\n  'graphicsFactory',\n  'modeling'\n];\n","var abs = Math.abs,\n    round = Math.round;\n\n\n/**\n * Snap value to a collection of reference values.\n *\n * @param  {Number} value\n * @param  {Array<Number>} values\n * @param  {Number} [tolerance=10]\n *\n * @return {Number} the value we snapped to or null, if none snapped\n */\nexport function snapTo(value, values, tolerance) {\n  tolerance = tolerance === undefined ? 10 : tolerance;\n\n  var idx, snapValue;\n\n  for (idx = 0; idx < values.length; idx++) {\n    snapValue = values[idx];\n\n    if (abs(snapValue - value) <= tolerance) {\n      return snapValue;\n    }\n  }\n}\n\n\nexport function topLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y\n  };\n}\n\nexport function topRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y\n  };\n}\n\nexport function bottomLeft(bounds) {\n  return {\n    x: bounds.x,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function bottomRight(bounds) {\n  return {\n    x: bounds.x + bounds.width,\n    y: bounds.y + bounds.height\n  };\n}\n\nexport function mid(bounds, defaultValue) {\n\n  if (!bounds || isNaN(bounds.x) || isNaN(bounds.y)) {\n    return defaultValue;\n  }\n\n  return {\n    x: round(bounds.x + bounds.width / 2),\n    y: round(bounds.y + bounds.height / 2)\n  };\n}\n\n\n/**\n * Retrieve the snap state of the given event.\n *\n * @param  {Event} event\n * @param  {String} axis\n *\n * @return {Boolean} the snapped state\n *\n */\nexport function isSnapped(event, axis) {\n  var snapped = event.snapped;\n\n  if (!snapped) {\n    return false;\n  }\n\n  if (typeof axis === 'string') {\n    return snapped[axis];\n  }\n\n  return snapped.x && snapped.y;\n}\n\n\n/**\n * Set the given event as snapped.\n *\n * This method may change the x and/or y position of the shape\n * from the given event!\n *\n * @param {Event} event\n * @param {String} axis\n * @param {Number|Boolean} value\n *\n * @return {Number} old value\n */\nexport function setSnapped(event, axis, value) {\n  if (typeof axis !== 'string') {\n    throw new Error('axis must be in [x, y]');\n  }\n\n  if (typeof value !== 'number' && value !== false) {\n    throw new Error('value must be Number or false');\n  }\n\n  var delta,\n      previousValue = event[axis];\n\n  var snapped = event.snapped = (event.snapped || {});\n\n\n  if (value === false) {\n    snapped[axis] = false;\n  } else {\n    snapped[axis] = true;\n\n    delta = value - previousValue;\n\n    event[axis] += delta;\n    event['d' + axis] += delta;\n  }\n\n  return previousValue;\n}\n\n/**\n * Get children of a shape.\n *\n * @param {djs.model.Shape} parent\n *\n * @returns {Array<djs.model.Shape|djs.model.Connection>}\n */\nexport function getChildren(parent) {\n  return parent.children || [];\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport { setSnapped } from '../snapping/SnapUtil';\n\nvar abs= Math.abs,\n    round = Math.round;\n\nvar TOLERANCE = 10;\n\n\nexport default function BendpointSnapping(eventBus) {\n\n  function snapTo(values, value) {\n\n    if (isArray(values)) {\n      var i = values.length;\n\n      while (i--) if (abs(values[i] - value) <= TOLERANCE) {\n        return values[i];\n      }\n    } else {\n      values = +values;\n      var rem = value % values;\n\n      if (rem < TOLERANCE) {\n        return value - rem;\n      }\n\n      if (rem > values - TOLERANCE) {\n        return value - rem + values;\n      }\n    }\n\n    return value;\n  }\n\n  function mid(element) {\n    if (element.width) {\n      return {\n        x: round(element.width / 2 + element.x),\n        y: round(element.height / 2 + element.y)\n      };\n    }\n  }\n\n  // connection segment snapping //////////////////////\n\n  function getConnectionSegmentSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        connection = context.connection,\n        waypoints = connection.waypoints,\n        segmentStart = context.segmentStart,\n        segmentStartIndex = context.segmentStartIndex,\n        segmentEnd = context.segmentEnd,\n        segmentEndIndex = context.segmentEndIndex,\n        axis = context.axis;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [\n      waypoints[segmentStartIndex - 1],\n      segmentStart,\n      segmentEnd,\n      waypoints[segmentEndIndex + 1]\n    ];\n\n    if (segmentStartIndex < 2) {\n      referenceWaypoints.unshift(mid(connection.source));\n    }\n\n    if (segmentEndIndex > waypoints.length - 3) {\n      referenceWaypoints.unshift(mid(connection.target));\n    }\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        if (axis === 'y') {\n          snapPoints.horizontal.push(p.y);\n        }\n\n        if (axis === 'x') {\n          snapPoints.vertical.push(p.x);\n        }\n      }\n    });\n\n    return snapPoints;\n  }\n\n  eventBus.on('connectionSegment.move.move', 1500, function(event) {\n    var context = event.context,\n        snapPoints = getConnectionSegmentSnaps(context),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap\n    sx = snapTo(snapPoints.vertical, x);\n    sy = snapTo(snapPoints.horizontal, y);\n\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: sx,\n      y: sy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n\n\n  // bendpoint snapping //////////////////////\n\n  function getBendpointSnaps(context) {\n\n    var snapPoints = context.snapPoints,\n        waypoints = context.connection.waypoints,\n        bendpointIndex = context.bendpointIndex;\n\n    if (snapPoints) {\n      return snapPoints;\n    }\n\n    var referenceWaypoints = [ waypoints[bendpointIndex - 1], waypoints[bendpointIndex + 1] ];\n\n    context.snapPoints = snapPoints = { horizontal: [] , vertical: [] };\n\n    forEach(referenceWaypoints, function(p) {\n\n      // we snap on existing bendpoints only,\n      // not placeholders that are inserted during add\n      if (p) {\n        p = p.original || p;\n\n        snapPoints.horizontal.push(p.y);\n        snapPoints.vertical.push(p.x);\n      }\n    });\n\n    return snapPoints;\n  }\n\n\n  eventBus.on([ 'bendpoint.move.move', 'bendpoint.move.end' ], 1500, function(event) {\n\n    var context = event.context,\n        snapPoints = getBendpointSnaps(context),\n        hover = context.hover,\n        hoverMid = hover && mid(hover),\n        x = event.x,\n        y = event.y,\n        sx, sy;\n\n    if (!snapPoints) {\n      return;\n    }\n\n    // snap to hover mid\n    sx = snapTo(hoverMid ? snapPoints.vertical.concat([ hoverMid.x ]) : snapPoints.vertical, x);\n    sy = snapTo(hoverMid ? snapPoints.horizontal.concat([ hoverMid.y ]) : snapPoints.horizontal, y);\n\n    // correction x/y\n    var cx = (x - sx),\n        cy = (y - sy);\n\n    // update delta\n    assign(event, {\n      dx: event.dx - cx,\n      dy: event.dy - cy,\n      x: event.x - cx,\n      y: event.y - cy\n    });\n\n    // only set snapped if actually snapped\n    if (cx || snapPoints.vertical.indexOf(x) !== -1) {\n      setSnapped(event, 'x', sx);\n    }\n\n    if (cy || snapPoints.horizontal.indexOf(y) !== -1) {\n      setSnapped(event, 'y', sy);\n    }\n  });\n}\n\n\nBendpointSnapping.$inject = [ 'eventBus' ];","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\n\nimport Bendpoints from './Bendpoints';\nimport BendpointMove from './BendpointMove';\nimport BendpointMovePreview from './BendpointMovePreview';\nimport ConnectionSegmentMove from './ConnectionSegmentMove';\nimport BendpointSnapping from './BendpointSnapping';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    RulesModule\n  ],\n  __init__: [ 'bendpoints', 'bendpointSnapping', 'bendpointMovePreview' ],\n  bendpoints: [ 'type', Bendpoints ],\n  bendpointMove: [ 'type', BendpointMove ],\n  bendpointMovePreview: [ 'type', BendpointMovePreview ],\n  connectionSegmentMove: [ 'type', ConnectionSegmentMove ],\n  bendpointSnapping: [ 'type', BendpointSnapping ]\n};\n","import {\n  getMid\n} from '../../layout/LayoutUtil';\n\nimport {\n  isNil,\n  isObject\n} from 'min-dash';\n\n\nexport default function Connect(eventBus, dragging, modeling, rules) {\n\n  // rules\n\n  function canConnect(source, target) {\n    return rules.allowed('connection.create', {\n      source: source,\n      target: target\n    });\n  }\n\n  function canConnectReverse(source, target) {\n    return canConnect(target, source);\n  }\n\n\n  // event handlers\n\n  eventBus.on('connect.hover', function(event) {\n    var context = event.context,\n        start = context.start,\n        hover = event.hover,\n        canExecute;\n\n    // cache hover state\n    context.hover = hover;\n\n    canExecute = context.canExecute = canConnect(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = start;\n      context.target = hover;\n\n      return;\n    }\n\n    canExecute = context.canExecute = canConnectReverse(start, hover);\n\n    // ignore hover\n    if (isNil(canExecute)) {\n      return;\n    }\n\n    if (canExecute !== false) {\n      context.source = hover;\n      context.target = start;\n    }\n  });\n\n  eventBus.on([ 'connect.out', 'connect.cleanup' ], function(event) {\n    var context = event.context;\n\n    context.hover = null;\n    context.source = null;\n    context.target = null;\n\n    context.canExecute = false;\n  });\n\n  eventBus.on('connect.end', function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        connectionStart = context.connectionStart,\n        connectionEnd = {\n          x: event.x,\n          y: event.y\n        },\n        source = context.source,\n        target = context.target;\n\n    if (!canExecute) {\n      return false;\n    }\n\n    var attrs = null,\n        hints = {\n          connectionStart: isReverse(context) ? connectionEnd : connectionStart,\n          connectionEnd: isReverse(context) ? connectionStart : connectionEnd\n        };\n\n    if (isObject(canExecute)) {\n      attrs = canExecute;\n    }\n\n    modeling.connect(source, target, attrs, hints);\n  });\n\n\n  // API\n\n  /**\n   * Start connect operation.\n   *\n   * @param {DOMEvent} event\n   * @param {djs.model.Base} start\n   * @param {Point} [connectionStart]\n   * @param {boolean} [autoActivate=false]\n   */\n  this.start = function(event, start, connectionStart, autoActivate) {\n    if (!isObject(connectionStart)) {\n      autoActivate = connectionStart;\n      connectionStart = getMid(start);\n    }\n\n    dragging.init(event, 'connect', {\n      autoActivate: autoActivate,\n      data: {\n        shape: start,\n        context: {\n          start: start,\n          connectionStart: connectionStart\n        }\n      }\n    });\n  };\n}\n\nConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'rules'\n];\n\n\n// helpers //////////\n\nexport function isReverse(context) {\n  var hover = context.hover,\n      source = context.source,\n      target = context.target;\n\n  return hover && source && hover === source && source !== target;\n}","import { isReverse } from './Connect';\n\nvar HIGH_PRIORITY = 1100,\n    LOW_PRIORITY = 900;\n\nvar MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * Shows connection preview during connect.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function ConnectPreview(injector, eventBus, canvas) {\n  var connectionPreview = injector.get('connectionPreview', false);\n\n  connectionPreview && eventBus.on('connect.move', function(event) {\n    var context = event.context,\n        canConnect = context.canExecute,\n        hover = context.hover,\n        source = context.source,\n        start = context.start,\n        startPosition = context.startPosition,\n        target = context.target;\n\n    var connectionStart = isReverse(context) ? {\n      x: event.x,\n      y: event.y\n    } : startPosition;\n\n    var connectionEnd = isReverse(context) ? startPosition : {\n      x: event.x,\n      y: event.y\n    };\n\n    connectionPreview.drawPreview(context, canConnect, {\n      source: source || start,\n      target: target || hover,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd\n    });\n  });\n\n  eventBus.on('connect.hover', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        hover = event.hover,\n        canExecute = context.canExecute;\n\n    // ignore hover\n    if (canExecute === null) {\n      return;\n    }\n\n    canvas.addMarker(hover, canExecute ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n  eventBus.on([\n    'connect.out',\n    'connect.cleanup'\n  ], HIGH_PRIORITY, function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      canvas.removeMarker(hover, MARKER_OK);\n      canvas.removeMarker(hover, MARKER_NOT_OK);\n    }\n  });\n\n  connectionPreview && eventBus.on('connect.cleanup', function(event) {\n    connectionPreview.cleanUp(event.context);\n  });\n}\n\nConnectPreview.$inject = [\n  'injector',\n  'eventBus',\n  'canvas'\n];\n","import SelectionModule from '../selection';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\n\nimport Connect from './Connect';\nimport ConnectPreview from './ConnectPreview';\n\nexport default {\n  __depends__: [\n    SelectionModule,\n    RulesModule,\n    DraggingModule\n  ],\n  __init__: [\n    'connectPreview'\n  ],\n  connect: [ 'type', Connect ],\n  connectPreview: [ 'type', ConnectPreview ]\n};\n","import {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove,\n  clear as svgClear\n} from 'tiny-svg';\n\nimport {\n  isObject\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection,\n  getMid\n} from '../../layout/LayoutUtil';\n\n\nvar MARKER_CONNECTION_PREVIEW = 'djs-connection-preview';\n\n/**\n * Draws connection preview. Optionally, this can use layouter and connection docking to draw\n * better looking previews.\n *\n * @param {didi.Injector} injector\n * @param {Canvas} canvas\n * @param {GraphicsFactory} graphicsFactory\n * @param {ElementFactory} elementFactory\n */\nexport default function ConnectionPreview(\n    injector,\n    canvas,\n    graphicsFactory,\n    elementFactory\n) {\n  this._canvas = canvas;\n  this._graphicsFactory = graphicsFactory;\n  this._elementFactory = elementFactory;\n\n  // optional components\n  this._connectionDocking = injector.get('connectionDocking', false);\n  this._layouter = injector.get('layouter', false);\n}\n\nConnectionPreview.$inject = [\n  'injector',\n  'canvas',\n  'graphicsFactory',\n  'elementFactory'\n];\n\n/**\n * Draw connection preview.\n *\n * Provide at least one of <source, connectionStart> and <target, connectionEnd> to create a preview.\n * In the clean up stage, call `connectionPreview#cleanUp` with the context to remove preview.\n *\n * @param {Object} context\n * @param {Object|boolean} canConnect\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] connection preview start\n * @param {Point} [hints.connectionEnd] connection preview end\n * @param {Array<Point>} [hints.waypoints] provided waypoints for preview\n * @param {boolean} [hints.noLayout] true if preview should not be laid out\n * @param {boolean} [hints.noCropping] true if preview should not be cropped\n * @param {boolean} [hints.noNoop] true if simple connection should not be drawn\n */\nConnectionPreview.prototype.drawPreview = function(context, canConnect, hints) {\n\n  hints = hints || {};\n\n  var connectionPreviewGfx = context.connectionPreviewGfx,\n      getConnection = context.getConnection,\n      source = hints.source,\n      target = hints.target,\n      waypoints = hints.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd,\n      noLayout = hints.noLayout,\n      noCropping = hints.noCropping,\n      noNoop = hints.noNoop,\n      connection;\n\n  var self = this;\n\n  if (!connectionPreviewGfx) {\n    connectionPreviewGfx = context.connectionPreviewGfx = this.createConnectionPreviewGfx();\n  }\n\n  svgClear(connectionPreviewGfx);\n\n  if (!getConnection) {\n    getConnection = context.getConnection = cacheReturnValues(function(canConnect, source, target) {\n      return self.getConnection(canConnect, source, target);\n    });\n  }\n\n  if (canConnect) {\n    connection = getConnection(canConnect, source, target);\n  }\n\n  if (!connection) {\n    !noNoop && this.drawNoopPreview(connectionPreviewGfx, hints);\n    return;\n  }\n\n  connection.waypoints = waypoints || [];\n\n  // optional layout\n  if (this._layouter && !noLayout) {\n    connection.waypoints = this._layouter.layoutConnection(connection, {\n      source: source,\n      target: target,\n      connectionStart: connectionStart,\n      connectionEnd: connectionEnd,\n      waypoints: hints.waypoints || connection.waypoints\n    });\n  }\n\n  // fallback if no waypoints were provided nor created with layouter\n  if (!connection.waypoints || !connection.waypoints.length) {\n    connection.waypoints = [\n      source ? getMid(source) : connectionStart,\n      target ? getMid(target) : connectionEnd\n    ];\n  }\n\n  // optional cropping\n  if (this._connectionDocking && (source || target) && !noCropping) {\n    connection.waypoints = this._connectionDocking.getCroppedWaypoints(connection, source, target);\n  }\n\n  this._graphicsFactory.drawConnection(connectionPreviewGfx, connection);\n};\n\n/**\n * Draw simple connection between source and target or provided points.\n *\n * @param {SVGElement} connectionPreviewGfx container for the connection\n * @param {Object} hints\n * @param {djs.model.shape} [hints.source] source element\n * @param {djs.model.shape} [hints.target] target element\n * @param {Point} [hints.connectionStart] required if source is not provided\n * @param {Point} [hints.connectionEnd] required if target is not provided\n */\nConnectionPreview.prototype.drawNoopPreview = function(connectionPreviewGfx, hints) {\n  var source = hints.source,\n      target = hints.target,\n      start = hints.connectionStart || getMid(source),\n      end = hints.connectionEnd || getMid(target);\n\n  var waypoints = this.cropWaypoints(start, end, source, target);\n\n  var connection = this.createNoopConnection(waypoints[0], waypoints[1]);\n\n  svgAppend(connectionPreviewGfx, connection);\n};\n\n/**\n * Return cropped waypoints.\n *\n * @param {Point} start\n * @param {Point} end\n * @param {djs.model.shape} source\n * @param {djs.model.shape} target\n *\n * @returns {Array}\n */\nConnectionPreview.prototype.cropWaypoints = function(start, end, source, target) {\n  var graphicsFactory = this._graphicsFactory,\n      sourcePath = source && graphicsFactory.getShapePath(source),\n      targetPath = target && graphicsFactory.getShapePath(target),\n      connectionPath = graphicsFactory.getConnectionPath({ waypoints: [ start, end ] });\n\n  start = (source && getElementLineIntersection(sourcePath, connectionPath, true)) || start;\n  end = (target && getElementLineIntersection(targetPath, connectionPath, false)) || end;\n\n  return [ start, end ];\n};\n\n/**\n * Remove connection preview container if it exists.\n *\n * @param {Object} [context]\n * @param {SVGElement} [context.connectionPreviewGfx] preview container\n */\nConnectionPreview.prototype.cleanUp = function(context) {\n  if (context && context.connectionPreviewGfx) {\n    svgRemove(context.connectionPreviewGfx);\n  }\n};\n\n/**\n * Get connection that connects source and target.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {djs.model.connection}\n */\nConnectionPreview.prototype.getConnection = function(canConnect) {\n  var attrs = ensureConnectionAttrs(canConnect);\n\n  return this._elementFactory.createConnection(attrs);\n};\n\n\n/**\n * Add and return preview graphics.\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createConnectionPreviewGfx = function() {\n  var gfx = svgCreate('g');\n\n  svgAttr(gfx, {\n    pointerEvents: 'none'\n  });\n\n  svgClasses(gfx).add(MARKER_CONNECTION_PREVIEW);\n\n  svgAppend(this._canvas.getDefaultLayer(), gfx);\n\n  return gfx;\n};\n\n/**\n * Create and return simple connection.\n *\n * @param {Point} start\n * @param {Point} end\n *\n * @returns {SVGElement}\n */\nConnectionPreview.prototype.createNoopConnection = function(start, end) {\n  var connection = svgCreate('polyline');\n\n  svgAttr(connection, {\n    'stroke': '#333',\n    'strokeDasharray': [ 1 ],\n    'strokeWidth': 2,\n    'pointer-events': 'none'\n  });\n\n  svgAttr(connection, { 'points': [ start.x, start.y, end.x, end.y ] });\n\n  return connection;\n};\n\n// helpers //////////\n\n/**\n * Returns function that returns cached return values referenced by stringified first argument.\n *\n * @param {Function} fn\n *\n * @return {Function}\n */\nfunction cacheReturnValues(fn) {\n  var returnValues = {};\n\n  /**\n   * Return cached return value referenced by stringified first argument.\n   *\n   * @returns {*}\n   */\n  return function(firstArgument) {\n    var key = JSON.stringify(firstArgument);\n\n    var returnValue = returnValues[key];\n\n    if (!returnValue) {\n      returnValue = returnValues[key] = fn.apply(null, arguments);\n    }\n\n    return returnValue;\n  };\n}\n\n/**\n * Ensure connection attributes is object.\n *\n * @param {Object|boolean} canConnect\n *\n * @returns {Object}\n */\nfunction ensureConnectionAttrs(canConnect) {\n  if (isObject(canConnect)) {\n    return canConnect;\n  } else {\n    return {};\n  }\n}\n","import ConnectionPreview from './ConnectionPreview';\n\nexport default {\n  __init__: [ 'connectionPreview' ],\n  connectionPreview: [ 'type', ConnectionPreview ]\n};\n","import {\n  assign,\n  bind,\n  pick\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  event as domEvent,\n  remove as domRemove\n} from 'min-dom';\n\nvar min = Math.min,\n    max = Math.max;\n\nfunction preventDefault(e) {\n  e.preventDefault();\n}\n\nfunction stopPropagation(e) {\n  e.stopPropagation();\n}\n\nfunction isTextNode(node) {\n  return node.nodeType === Node.TEXT_NODE;\n}\n\nfunction toArray(nodeList) {\n  return [].slice.call(nodeList);\n}\n\n/**\n * Initializes a container for a content editable div.\n *\n * Structure:\n *\n * container\n *   parent\n *     content\n *     resize-handle\n *\n * @param {object} options\n * @param {DOMElement} options.container The DOM element to append the contentContainer to\n * @param {Function} options.keyHandler Handler for key events\n * @param {Function} options.resizeHandler Handler for resize events\n */\nexport default function TextBox(options) {\n  this.container = options.container;\n\n  this.parent = domify(\n    '<div class=\"djs-direct-editing-parent\">' +\n      '<div class=\"djs-direct-editing-content\" contenteditable=\"true\"></div>' +\n    '</div>'\n  );\n\n  this.content = domQuery('[contenteditable]', this.parent);\n\n  this.keyHandler = options.keyHandler || function() {};\n  this.resizeHandler = options.resizeHandler || function() {};\n\n  this.autoResize = bind(this.autoResize, this);\n  this.handlePaste = bind(this.handlePaste, this);\n}\n\n\n/**\n * Create a text box with the given position, size, style and text content\n *\n * @param {Object} bounds\n * @param {Number} bounds.x absolute x position\n * @param {Number} bounds.y absolute y position\n * @param {Number} [bounds.width] fixed width value\n * @param {Number} [bounds.height] fixed height value\n * @param {Number} [bounds.maxWidth] maximum width value\n * @param {Number} [bounds.maxHeight] maximum height value\n * @param {Number} [bounds.minWidth] minimum width value\n * @param {Number} [bounds.minHeight] minimum height value\n * @param {Object} [style]\n * @param {String} value text content\n *\n * @return {DOMElement} The created content DOM element\n */\nTextBox.prototype.create = function(bounds, style, value, options) {\n  var self = this;\n\n  var parent = this.parent,\n      content = this.content,\n      container = this.container;\n\n  options = this.options = options || {};\n\n  style = this.style = style || {};\n\n  var parentStyle = pick(style, [\n    'width',\n    'height',\n    'maxWidth',\n    'maxHeight',\n    'minWidth',\n    'minHeight',\n    'left',\n    'top',\n    'backgroundColor',\n    'position',\n    'overflow',\n    'border',\n    'wordWrap',\n    'textAlign',\n    'outline',\n    'transform'\n  ]);\n\n  assign(parent.style, {\n    width: bounds.width + 'px',\n    height: bounds.height + 'px',\n    maxWidth: bounds.maxWidth + 'px',\n    maxHeight: bounds.maxHeight + 'px',\n    minWidth: bounds.minWidth + 'px',\n    minHeight: bounds.minHeight + 'px',\n    left: bounds.x + 'px',\n    top: bounds.y + 'px',\n    backgroundColor: '#ffffff',\n    position: 'absolute',\n    overflow: 'visible',\n    border: '1px solid #ccc',\n    boxSizing: 'border-box',\n    wordWrap: 'normal',\n    textAlign: 'center',\n    outline: 'none'\n  }, parentStyle);\n\n  var contentStyle = pick(style, [\n    'fontFamily',\n    'fontSize',\n    'fontWeight',\n    'lineHeight',\n    'padding',\n    'paddingTop',\n    'paddingRight',\n    'paddingBottom',\n    'paddingLeft'\n  ]);\n\n  assign(content.style, {\n    boxSizing: 'border-box',\n    width: '100%',\n    outline: 'none',\n    wordWrap: 'break-word'\n  }, contentStyle);\n\n  if (options.centerVertically) {\n    assign(content.style, {\n      position: 'absolute',\n      top: '50%',\n      transform: 'translate(0, -50%)'\n    }, contentStyle);\n  }\n\n  content.innerText = value;\n\n  domEvent.bind(content, 'keydown', this.keyHandler);\n  domEvent.bind(content, 'mousedown', stopPropagation);\n  domEvent.bind(content, 'paste', self.handlePaste);\n\n  if (options.autoResize) {\n    domEvent.bind(content, 'input', this.autoResize);\n  }\n\n  if (options.resizable) {\n    this.resizable(style);\n  }\n\n  container.appendChild(parent);\n\n  // set selection to end of text\n  this.setSelection(content.lastChild, content.lastChild && content.lastChild.length);\n\n  return parent;\n};\n\n/**\n * Intercept paste events to remove formatting from pasted text.\n */\nTextBox.prototype.handlePaste = function(e) {\n  var options = this.options,\n      style = this.style;\n\n  e.preventDefault();\n\n  var text;\n\n  if (e.clipboardData) {\n\n    // Chrome, Firefox, Safari\n    text = e.clipboardData.getData('text/plain');\n  } else {\n\n    // Internet Explorer\n    text = window.clipboardData.getData('Text');\n  }\n\n  this.insertText(text);\n\n  if (options.autoResize) {\n    var hasResized = this.autoResize(style);\n\n    if (hasResized) {\n      this.resizeHandler(hasResized);\n    }\n  }\n};\n\nTextBox.prototype.insertText = function(text) {\n\n  // insertText command not supported by Internet Explorer\n  var success = document.execCommand('insertText', false, text);\n\n  if (success) {\n    return;\n  }\n\n  this._insertTextIE(text);\n};\n\nTextBox.prototype._insertTextIE = function(text) {\n\n  // Internet Explorer\n  var range = this.getSelection(),\n      startContainer = range.startContainer,\n      endContainer = range.endContainer,\n      startOffset = range.startOffset,\n      endOffset = range.endOffset,\n      commonAncestorContainer = range.commonAncestorContainer;\n\n  var childNodesArray = toArray(commonAncestorContainer.childNodes);\n\n  var container,\n      offset;\n\n  if (isTextNode(commonAncestorContainer)) {\n    var containerTextContent = startContainer.textContent;\n\n    startContainer.textContent =\n      containerTextContent.substring(0, startOffset)\n      + text\n      + containerTextContent.substring(endOffset);\n\n    container = startContainer;\n    offset = startOffset + text.length;\n\n  } else if (startContainer === this.content && endContainer === this.content) {\n    var textNode = document.createTextNode(text);\n\n    this.content.insertBefore(textNode, childNodesArray[startOffset]);\n\n    container = textNode;\n    offset = textNode.textContent.length;\n  } else {\n    var startContainerChildIndex = childNodesArray.indexOf(startContainer),\n        endContainerChildIndex = childNodesArray.indexOf(endContainer);\n\n    childNodesArray.forEach(function(childNode, index) {\n\n      if (index === startContainerChildIndex) {\n        childNode.textContent =\n          startContainer.textContent.substring(0, startOffset) +\n          text +\n          endContainer.textContent.substring(endOffset);\n      } else if (index > startContainerChildIndex && index <= endContainerChildIndex) {\n        domRemove(childNode);\n      }\n    });\n\n    container = startContainer;\n    offset = startOffset + text.length;\n  }\n\n  if (container && offset !== undefined) {\n\n    // is necessary in Internet Explorer\n    setTimeout(function() {\n      self.setSelection(container, offset);\n    });\n  }\n};\n\n/**\n * Automatically resize element vertically to fit its content.\n */\nTextBox.prototype.autoResize = function() {\n  var parent = this.parent,\n      content = this.content;\n\n  var fontSize = parseInt(this.style.fontSize) || 12;\n\n  if (content.scrollHeight > parent.offsetHeight ||\n      content.scrollHeight < parent.offsetHeight - fontSize) {\n    var bounds = parent.getBoundingClientRect();\n\n    var height = content.scrollHeight;\n    parent.style.height = height + 'px';\n\n    this.resizeHandler({\n      width: bounds.width,\n      height: bounds.height,\n      dx: 0,\n      dy: height - bounds.height\n    });\n  }\n};\n\n/**\n * Make an element resizable by adding a resize handle.\n */\nTextBox.prototype.resizable = function() {\n  var self = this;\n\n  var parent = this.parent,\n      resizeHandle = this.resizeHandle;\n\n  var minWidth = parseInt(this.style.minWidth) || 0,\n      minHeight = parseInt(this.style.minHeight) || 0,\n      maxWidth = parseInt(this.style.maxWidth) || Infinity,\n      maxHeight = parseInt(this.style.maxHeight) || Infinity;\n\n  if (!resizeHandle) {\n    resizeHandle = this.resizeHandle = domify(\n      '<div class=\"djs-direct-editing-resize-handle\"></div>'\n    );\n\n    var startX, startY, startWidth, startHeight;\n\n    var onMouseDown = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      startX = e.clientX;\n      startY = e.clientY;\n\n      var bounds = parent.getBoundingClientRect();\n\n      startWidth = bounds.width;\n      startHeight = bounds.height;\n\n      domEvent.bind(document, 'mousemove', onMouseMove);\n      domEvent.bind(document, 'mouseup', onMouseUp);\n    };\n\n    var onMouseMove = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      var newWidth = min(max(startWidth + e.clientX - startX, minWidth), maxWidth);\n      var newHeight = min(max(startHeight + e.clientY - startY, minHeight), maxHeight);\n\n      parent.style.width = newWidth + 'px';\n      parent.style.height = newHeight + 'px';\n\n      self.resizeHandler({\n        width: startWidth,\n        height: startHeight,\n        dx: e.clientX - startX,\n        dy: e.clientY - startY\n      });\n    };\n\n    var onMouseUp = function(e) {\n      preventDefault(e);\n      stopPropagation(e);\n\n      domEvent.unbind(document,'mousemove', onMouseMove, false);\n      domEvent.unbind(document, 'mouseup', onMouseUp, false);\n    };\n\n    domEvent.bind(resizeHandle, 'mousedown', onMouseDown);\n  }\n\n  assign(resizeHandle.style, {\n    position: 'absolute',\n    bottom: '0px',\n    right: '0px',\n    cursor: 'nwse-resize',\n    width: '0',\n    height: '0',\n    borderTop: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent',\n    borderRight: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderBottom: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid #ccc',\n    borderLeft: (parseInt(this.style.fontSize) / 4 || 3) + 'px solid transparent'\n  });\n\n  parent.appendChild(resizeHandle);\n};\n\n\n/**\n * Clear content and style of the textbox, unbind listeners and\n * reset CSS style.\n */\nTextBox.prototype.destroy = function() {\n  var parent = this.parent,\n      content = this.content,\n      resizeHandle = this.resizeHandle;\n\n  // clear content\n  content.innerText = '';\n\n  // clear styles\n  parent.removeAttribute('style');\n  content.removeAttribute('style');\n\n  domEvent.unbind(content, 'keydown', this.keyHandler);\n  domEvent.unbind(content, 'mousedown', stopPropagation);\n  domEvent.unbind(content, 'input', this.autoResize);\n  domEvent.unbind(content, 'paste', this.handlePaste);\n\n  if (resizeHandle) {\n    resizeHandle.removeAttribute('style');\n\n    domRemove(resizeHandle);\n  }\n\n  domRemove(parent);\n};\n\n\nTextBox.prototype.getValue = function() {\n  return this.content.innerText.trim();\n};\n\n\nTextBox.prototype.getSelection = function() {\n  var selection = window.getSelection(),\n      range = selection.getRangeAt(0);\n\n  return range;\n};\n\n\nTextBox.prototype.setSelection = function(container, offset) {\n  var range = document.createRange();\n\n  if (container === null) {\n    range.selectNodeContents(this.content);\n  } else {\n    range.setStart(container, offset);\n    range.setEnd(container, offset);\n  }\n\n  var selection = window.getSelection();\n\n  selection.removeAllRanges();\n  selection.addRange(range);\n};\n","import {\n  bind,\n  find\n} from 'min-dash';\n\nimport TextBox from './TextBox';\n\n\n/**\n * A direct editing component that allows users\n * to edit an elements text directly in the diagram\n *\n * @param {EventBus} eventBus the event bus\n */\nexport default function DirectEditing(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n\n  this._providers = [];\n  this._textbox = new TextBox({\n    container: canvas.getContainer(),\n    keyHandler: bind(this._handleKey, this),\n    resizeHandler: bind(this._handleResize, this)\n  });\n}\n\nDirectEditing.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a direct editing provider\n\n * @param {Object} provider the provider, must expose an #activate(element) method that returns\n *                          an activation context ({ bounds: {x, y, width, height }, text }) if\n *                          direct editing is available for the given element.\n *                          Additionally the provider must expose a #update(element, value) method\n *                          to receive direct editing updates.\n */\nDirectEditing.prototype.registerProvider = function(provider) {\n  this._providers.push(provider);\n};\n\n\n/**\n * Returns true if direct editing is currently active\n *\n * @return {Boolean}\n */\nDirectEditing.prototype.isActive = function() {\n  return !!this._active;\n};\n\n\n/**\n * Cancel direct editing, if it is currently active\n */\nDirectEditing.prototype.cancel = function() {\n  if (!this._active) {\n    return;\n  }\n\n  this._fire('cancel');\n  this.close();\n};\n\n\nDirectEditing.prototype._fire = function(event, context) {\n  this._eventBus.fire('directEditing.' + event, context || { active: this._active });\n};\n\nDirectEditing.prototype.close = function() {\n  this._textbox.destroy();\n\n  this._fire('deactivate');\n\n  this._active = null;\n\n  this.resizable = undefined;\n};\n\n\nDirectEditing.prototype.complete = function() {\n\n  var active = this._active;\n\n  if (!active) {\n    return;\n  }\n\n  var containerBounds,\n      previousBounds = active.context.bounds,\n      newBounds = this.$textbox.getBoundingClientRect(),\n      newText = this.getValue(),\n      previousText = active.context.text;\n\n  if (\n    newText !== previousText ||\n    newBounds.height !== previousBounds.height ||\n    newBounds.width !== previousBounds.width\n  ) {\n    containerBounds = this._textbox.container.getBoundingClientRect();\n\n    active.provider.update(active.element, newText, active.context.text, {\n      x: newBounds.left - containerBounds.left,\n      y: newBounds.top - containerBounds.top,\n      width: newBounds.width,\n      height: newBounds.height\n    });\n  }\n\n  this._fire('complete');\n\n  this.close();\n};\n\n\nDirectEditing.prototype.getValue = function() {\n  return this._textbox.getValue();\n};\n\n\nDirectEditing.prototype._handleKey = function(e) {\n\n  // stop bubble\n  e.stopPropagation();\n\n  var key = e.keyCode || e.charCode;\n\n  // ESC\n  if (key === 27) {\n    e.preventDefault();\n    return this.cancel();\n  }\n\n  // Enter\n  if (key === 13 && !e.shiftKey) {\n    e.preventDefault();\n    return this.complete();\n  }\n};\n\n\nDirectEditing.prototype._handleResize = function(event) {\n  this._fire('resize', event);\n};\n\n\n/**\n * Activate direct editing on the given element\n *\n * @param {Object} ElementDescriptor the descriptor for a shape or connection\n * @return {Boolean} true if the activation was possible\n */\nDirectEditing.prototype.activate = function(element) {\n  if (this.isActive()) {\n    this.cancel();\n  }\n\n  // the direct editing context\n  var context;\n\n  var provider = find(this._providers, function(p) {\n    return (context = p.activate(element)) ? p : null;\n  });\n\n  // check if activation took place\n  if (context) {\n    this.$textbox = this._textbox.create(\n      context.bounds,\n      context.style,\n      context.text,\n      context.options\n    );\n\n    this._active = {\n      element: element,\n      context: context,\n      provider: provider\n    };\n\n    if (context.options && context.options.resizable) {\n      this.resizable = true;\n    }\n\n    this._fire('activate');\n  }\n\n  return !!context;\n};\n","import InteractionEventsModule from 'diagram-js/lib/features/interaction-events';\n\nimport DirectEditing from './lib/DirectEditing';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule\n  ],\n  __init__: [ 'directEditing' ],\n  directEditing: [ 'type', DirectEditing ]\n};","import {\n  assign,\n  isFunction,\n  isArray,\n  forEach,\n  isDefined\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  event as domEvent,\n  attr as domAttr,\n  query as domQuery,\n  classes as domClasses,\n  domify as domify\n} from 'min-dom';\n\nvar entrySelector = '.entry';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A context pad that displays element specific, contextual actions next\n * to a diagram element.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Overlays} overlays\n */\nexport default function ContextPad(config, eventBus, overlays) {\n\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._overlaysConfig = {\n    position: {\n      right: -9,\n      top: -6\n    },\n    scale: scale\n  };\n\n  this._current = null;\n\n  this._init();\n}\n\nContextPad.$inject = [\n  'config.contextPad',\n  'eventBus',\n  'overlays'\n];\n\n\n/**\n * Registers events needed for interaction with other components\n */\nContextPad.prototype._init = function() {\n\n  var eventBus = this._eventBus;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n\n    var selection = e.newSelection;\n\n    if (selection.length === 1) {\n      self.open(selection[0]);\n    } else {\n      self.close();\n    }\n  });\n\n  eventBus.on('elements.delete', function(event) {\n    var elements = event.elements;\n\n    forEach(elements, function(e) {\n      if (self.isOpen(e)) {\n        self.close();\n      }\n    });\n  });\n\n  eventBus.on('element.changed', function(event) {\n    var element = event.element,\n        current = self._current;\n\n    // force reopen if element for which we are currently opened changed\n    if (current && current.element === element) {\n      self.open(element, true);\n    }\n  });\n};\n\n\n/**\n * Register a provider with the context pad\n *\n * @param  {Number} [priority=1000]\n * @param  {ContextPadProvider} provider\n *\n * @example\n * const contextPadProvider = {\n  *   getContextPadEntries: function(element) {\n  *     return function(entries) {\n  *       return {\n  *         ...entries,\n  *         'entry-1': {\n  *           label: 'My Entry',\n  *           action: function() { alert(\"I have been clicked!\"); }\n  *         }\n  *       };\n  *     }\n  *   }\n  * };\n  *\n * contextPad.registerProvider(800, contextPadProvider);\n */\nContextPad.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('contextPad.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n\n/**\n * Returns the context pad entries for a given element\n *\n * @param {djs.element.Base} element\n *\n * @return {Array<ContextPadEntryDescriptor>} list of entries\n */\nContextPad.prototype.getEntries = function(element) {\n  var providers = this._getProviders();\n\n  var entries = {};\n\n  // loop through all providers and their entries.\n  // group entries by id so that overriding an entry is possible\n  forEach(providers, function(provider) {\n    var entriesOrUpdater = provider.getContextPadEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\n\n/**\n * Trigger an action available on the opened context pad\n *\n * @param  {String} action\n * @param  {Event} event\n * @param  {Boolean} [autoActivate=false]\n */\nContextPad.prototype.trigger = function(action, event, autoActivate) {\n\n  var element = this._current.element,\n      entries = this._current.entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      return handler(originalEvent, element, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      return handler[action](originalEvent, element, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\n\n/**\n * Open the context pad for the given element\n *\n * @param {djs.model.Base} element\n * @param {Boolean} force if true, force reopening the context pad\n */\nContextPad.prototype.open = function(element, force) {\n  if (!force && this.isOpen(element)) {\n    return;\n  }\n\n  this.close();\n  this._updateAndOpen(element);\n};\n\nContextPad.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'contextPad.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nContextPad.prototype._updateAndOpen = function(element) {\n\n  var entries = this.getEntries(element),\n      pad = this.getPad(element),\n      html = pad.html;\n\n  forEach(entries, function(entry, id) {\n    var grouping = entry.group || 'default',\n        control = domify(entry.html || '<div class=\"entry\" draggable=\"true\"></div>'),\n        container;\n\n    domAttr(control, 'data-action', id);\n\n    container = domQuery('[data-group=' + grouping + ']', html);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      html.appendChild(container);\n    }\n\n    container.appendChild(control);\n\n    if (entry.className) {\n      addClasses(control, entry.className);\n    }\n\n    if (entry.title) {\n      domAttr(control, 'title', entry.title);\n    }\n\n    if (entry.imageUrl) {\n      control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n    }\n  });\n\n  domClasses(html).add('open');\n\n  this._current = {\n    element: element,\n    pad: pad,\n    entries: entries\n  };\n\n  this._eventBus.fire('contextPad.open', { current: this._current });\n};\n\n\nContextPad.prototype.getPad = function(element) {\n  if (this.isOpen()) {\n    return this._current.pad;\n  }\n\n  var self = this;\n\n  var overlays = this._overlays;\n\n  var html = domify('<div class=\"djs-context-pad\"></div>');\n\n  var overlaysConfig = assign({\n    html: html\n  }, this._overlaysConfig);\n\n  domDelegate.bind(html, entrySelector, 'click', function(event) {\n    self.trigger('click', event);\n  });\n\n  domDelegate.bind(html, entrySelector, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  // stop propagation of mouse events\n  domEvent.bind(html, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  this._overlayId = overlays.add(element, 'context-pad', overlaysConfig);\n\n  var pad = overlays.get(this._overlayId);\n\n  this._eventBus.fire('contextPad.create', { element: element, pad: pad });\n\n  return pad;\n};\n\n\n/**\n * Close the context pad\n */\nContextPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._overlays.remove(this._overlayId);\n\n  this._overlayId = null;\n\n  this._eventBus.fire('contextPad.close', { current: this._current });\n\n  this._current = null;\n};\n\n/**\n * Check if pad is open. If element is given, will check\n * if pad is opened with given element.\n *\n * @param {Element} element\n * @return {Boolean}\n */\nContextPad.prototype.isOpen = function(element) {\n  return !!this._current && (!element ? true : this._current.element === element);\n};\n\n\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}","import InteractionEventsModule from '../interaction-events';\nimport OverlaysModule from '../overlays';\n\nimport ContextPad from './ContextPad';\n\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    OverlaysModule\n  ],\n  contextPad: [ 'type', ContextPad ]\n};","import {\r\n  forEach\r\n} from 'min-dash';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  classes as svgClasses,\r\n  clone as svgClone,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nimport { query as domQuery } from 'min-dom';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nvar MARKER_TYPES = [\r\n  'marker-start',\r\n  'marker-mid',\r\n  'marker-end'\r\n];\r\n\r\nvar NODES_CAN_HAVE_MARKER = [\r\n  'circle',\r\n  'ellipse',\r\n  'line',\r\n  'path',\r\n  'polygon',\r\n  'polyline',\r\n  'rect'\r\n];\r\n\r\n\r\n/**\r\n * Adds support for previews of moving/resizing elements.\r\n */\r\nexport default function PreviewSupport(elementRegistry, eventBus, canvas, styles) {\r\n  this._elementRegistry = elementRegistry;\r\n  this._canvas = canvas;\r\n  this._styles = styles;\r\n\r\n  this._clonedMarkers = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('drag.cleanup', function() {\r\n    forEach(self._clonedMarkers, function(clonedMarker) {\r\n      svgRemove(clonedMarker);\r\n    });\r\n\r\n    self._clonedMarkers = {};\r\n  });\r\n}\r\n\r\nPreviewSupport.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas',\r\n  'styles'\r\n];\r\n\r\n\r\n/**\r\n * Returns graphics of an element.\r\n *\r\n * @param {djs.model.Base} element\r\n *\r\n * @return {SVGElement}\r\n */\r\nPreviewSupport.prototype.getGfx = function(element) {\r\n  return this._elementRegistry.getGraphics(element);\r\n};\r\n\r\n/**\r\n * Adds a move preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n * @param {SVGElement} [gfx]\r\n *\r\n * @return {SVGElement} dragger\r\n */\r\nPreviewSupport.prototype.addDragger = function(element, group, gfx) {\r\n  gfx = gfx || this.getGfx(element);\r\n\r\n  var dragger = svgClone(gfx);\r\n  var bbox = gfx.getBoundingClientRect();\r\n\r\n  this._cloneMarkers(getVisual(dragger));\r\n\r\n  svgAttr(dragger, this._styles.cls('djs-dragger', [], {\r\n    x: bbox.top,\r\n    y: bbox.left\r\n  }));\r\n\r\n  svgAppend(group, dragger);\r\n\r\n  return dragger;\r\n};\r\n\r\n/**\r\n * Adds a resize preview of a given shape to a given svg group.\r\n *\r\n * @param {djs.model.Base} element\r\n * @param {SVGElement} group\r\n *\r\n * @return {SVGElement} frame\r\n */\r\nPreviewSupport.prototype.addFrame = function(shape, group) {\r\n\r\n  var frame = svgCreate('rect', {\r\n    class: 'djs-resize-overlay',\r\n    width:  shape.width,\r\n    height: shape.height,\r\n    x: shape.x,\r\n    y: shape.y\r\n  });\r\n\r\n  svgAppend(group, frame);\r\n\r\n  return frame;\r\n};\r\n\r\n/**\r\n * Clone all markers referenced by a node and its child nodes.\r\n *\r\n * @param {SVGElement} gfx\r\n */\r\nPreviewSupport.prototype._cloneMarkers = function(gfx) {\r\n  var self = this;\r\n\r\n  if (gfx.childNodes) {\r\n\r\n    // TODO: use forEach once we drop PhantomJS\r\n    for (var i = 0; i < gfx.childNodes.length; i++) {\r\n\r\n      // recursively clone markers of child nodes\r\n      self._cloneMarkers(gfx.childNodes[ i ]);\r\n    }\r\n  }\r\n\r\n  if (!canHaveMarker(gfx)) {\r\n    return;\r\n  }\r\n\r\n  MARKER_TYPES.forEach(function(markerType) {\r\n    if (svgAttr(gfx, markerType)) {\r\n      var marker = getMarker(gfx, markerType, self._canvas.getContainer());\r\n\r\n      self._cloneMarker(gfx, marker, markerType);\r\n    }\r\n  });\r\n};\r\n\r\n/**\r\n * Clone marker referenced by an element.\r\n *\r\n * @param {SVGElement} gfx\r\n * @param {SVGElement} marker\r\n * @param {string} markerType\r\n */\r\nPreviewSupport.prototype._cloneMarker = function(gfx, marker, markerType) {\r\n  var markerId = marker.id;\r\n\r\n  var clonedMarker = this._clonedMarkers[ markerId ];\r\n\r\n  if (!clonedMarker) {\r\n    clonedMarker = svgClone(marker);\r\n\r\n    var clonedMarkerId = markerId + '-clone';\r\n\r\n    clonedMarker.id = clonedMarkerId;\r\n\r\n    svgClasses(clonedMarker)\r\n      .add('djs-dragger')\r\n      .add('djs-dragger-marker');\r\n\r\n    this._clonedMarkers[ markerId ] = clonedMarker;\r\n\r\n    var defs = domQuery('defs', this._canvas._svg);\r\n\r\n    if (!defs) {\r\n      defs = svgCreate('defs');\r\n\r\n      svgAppend(this._canvas._svg, defs);\r\n    }\r\n\r\n    svgAppend(defs, clonedMarker);\r\n  }\r\n\r\n  var reference = idToReference(this._clonedMarkers[ markerId ].id);\r\n\r\n  svgAttr(gfx, markerType, reference);\r\n};\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get marker of given type referenced by node.\r\n *\r\n * @param {Node} node\r\n * @param {string} markerType\r\n * @param {Node} [parentNode]\r\n *\r\n * @param {Node}\r\n */\r\nfunction getMarker(node, markerType, parentNode) {\r\n  var id = referenceToId(svgAttr(node, markerType));\r\n\r\n  return domQuery('marker#' + id, parentNode || document);\r\n}\r\n\r\n/**\r\n * Get ID of fragment within current document from its functional IRI reference.\r\n * References may use single or double quotes.\r\n *\r\n * @param {string} reference\r\n *\r\n * @returns {string}\r\n */\r\nfunction referenceToId(reference) {\r\n  return reference.match(/url\\(['\"]?#([^'\"]*)['\"]?\\)/)[1];\r\n}\r\n\r\n/**\r\n * Get functional IRI reference for given ID of fragment within current document.\r\n *\r\n * @param {string} id\r\n *\r\n * @returns {string}\r\n */\r\nfunction idToReference(id) {\r\n  return 'url(#' + id + ')';\r\n}\r\n\r\n/**\r\n * Check wether node type can have marker attributes.\r\n *\r\n * @param {Node} node\r\n *\r\n * @returns {boolean}\r\n */\r\nfunction canHaveMarker(node) {\r\n  return NODES_CAN_HAVE_MARKER.indexOf(node.nodeName) !== -1;\r\n}","import PreviewSupport from './PreviewSupport';\n\nexport default {\n  __init__: [ 'previewSupport' ],\n  previewSupport: [ 'type', PreviewSupport ]\n};\n","var MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_ATTACH = 'attach-ok',\n    MARKER_NEW_PARENT = 'new-parent';\n\nimport {\n  assign,\n  filter,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map\n} from 'min-dash';\n\nimport { getBBox } from '../../util/Elements';\n\nvar PREFIX = 'create';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * Create new elements through drag and drop.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function Create(\n    canvas,\n    dragging,\n    eventBus,\n    modeling,\n    rules\n) {\n\n  // rules //////////\n\n  /**\n   * Check wether elements can be created.\n   *\n   * @param {Array<djs.model.Base>} elements\n   * @param {djs.model.Base} target\n   * @param {Point} position\n   * @param {djs.model.Base} [source]\n   *\n   * @returns {boolean|null|Object}\n   */\n  function canCreate(elements, target, position, source) {\n    if (!target) {\n      return false;\n    }\n\n    // ignore child elements and external labels\n    elements = filter(elements, function(element) {\n      var labelTarget = element.labelTarget;\n\n      return !element.parent && !(isLabel(element) && elements.indexOf(labelTarget) !== -1);\n    });\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    var attach = false,\n        connect = false,\n        create = false;\n\n    // (1) attaching single shapes\n    if (isSingleShape(elements)) {\n      attach = rules.allowed('shape.attach', {\n        position: position,\n        shape: shape,\n        target: target\n      });\n    }\n\n    if (!attach) {\n\n      // (2) creating elements\n      if (isSingleShape(elements)) {\n        create = rules.allowed('shape.create', {\n          position: position,\n          shape: shape,\n          source: source,\n          target: target\n        });\n      } else {\n        create = rules.allowed('elements.create', {\n          elements: elements,\n          position: position,\n          target: target\n        });\n      }\n\n    }\n\n    // (3) appending single shapes\n    if (create || attach) {\n\n      if (shape && source) {\n        connect = rules.allowed('connection.create', {\n          source: source,\n          target: shape,\n          hints: {\n            targetParent: target,\n            targetAttach: attach\n          }\n        });\n      }\n\n      return {\n        attach: attach,\n        connect: connect\n      };\n    }\n\n    // ignore wether or not elements can be created\n    if (create === null || attach === null) {\n      return null;\n    }\n\n    return false;\n  }\n\n  function setMarker(element, marker) {\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  // event handling //////////\n\n  eventBus.on([ 'create.move', 'create.hover' ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hover = event.hover,\n        source = context.source;\n\n    if (!hover) {\n      context.canExecute = false;\n      context.target = null;\n\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    var canExecute = context.canExecute = hover && canCreate(elements, hover, position, source);\n\n    if (hover && canExecute !== null) {\n      context.target = hover;\n\n      if (canExecute && canExecute.attach) {\n        setMarker(hover, MARKER_ATTACH);\n      } else {\n        setMarker(hover, canExecute ? MARKER_NEW_PARENT : MARKER_NOT_OK);\n      }\n    }\n  });\n\n  eventBus.on([ 'create.end', 'create.out', 'create.cleanup' ], function(event) {\n    var hover = event.hover;\n\n    if (hover) {\n      setMarker(hover, null);\n    }\n  });\n\n  eventBus.on('create.end', function(event) {\n    var context = event.context,\n        source = context.source,\n        shape = context.shape,\n        elements = context.elements,\n        target = context.target,\n        hints = context.hints,\n        canExecute = context.canExecute,\n        attach = canExecute && canExecute.attach,\n        connect = canExecute && canExecute.connect;\n\n    if (canExecute === false || !target) {\n      return false;\n    }\n\n    ensureConstraints(event);\n\n    var position = {\n      x: event.x,\n      y: event.y\n    };\n\n    if (connect) {\n      shape = modeling.appendShape(source, shape, position, target, {\n        attach: attach,\n        connection: connect === true ? {} : connect\n      });\n    } else {\n      elements = modeling.createElements(elements, position, target, assign({}, hints, {\n        attach: attach\n      }));\n\n      // update shape\n      shape = find(elements, function(element) {\n        return !isConnection(element);\n      });\n    }\n\n    // update elements and shape\n    assign(context, {\n      elements: elements,\n      shape: shape\n    });\n\n    assign(event, {\n      elements: elements,\n      shape: shape\n    });\n  });\n\n  function cancel() {\n    var context = dragging.context();\n\n    if (context && context.prefix === PREFIX) {\n      dragging.cancel();\n    }\n  }\n\n  // cancel on <elements.changed> that is not result of <drag.end>\n  eventBus.on('create.init', function() {\n    eventBus.on('elements.changed', cancel);\n\n    eventBus.once([ 'create.cancel', 'create.end' ], HIGH_PRIORITY, function() {\n      eventBus.off('elements.changed', cancel);\n    });\n  });\n\n  // API //////////\n\n  this.start = function(event, elements, context) {\n    if (!isArray(elements)) {\n      elements = [ elements ];\n    }\n\n    var shape = find(elements, function(element) {\n      return !isConnection(element);\n    });\n\n    if (!shape) {\n\n      // at least one shape is required\n      return;\n    }\n\n    context = assign({\n      elements: elements,\n      hints: {},\n      shape: shape\n    }, context || {});\n\n    // make sure each element has x and y\n    forEach(elements, function(element) {\n      if (!isNumber(element.x)) {\n        element.x = 0;\n      }\n\n      if (!isNumber(element.y)) {\n        element.y = 0;\n      }\n    });\n\n    var bbox = getBBox(elements);\n\n    // center elements around cursor\n    forEach(elements, function(element) {\n      if (isConnection(element)) {\n        element.waypoints = map(element.waypoints, function(waypoint) {\n          return {\n            x: waypoint.x - bbox.x - bbox.width / 2,\n            y: waypoint.y - bbox.y - bbox.height / 2\n          };\n        });\n      }\n\n      assign(element, {\n        x: element.x - bbox.x - bbox.width / 2,\n        y: element.y - bbox.y - bbox.height / 2\n      });\n    });\n\n    dragging.init(event, PREFIX, {\n      cursor: 'grabbing',\n      autoActivate: true,\n      data: {\n        shape: shape,\n        elements: elements,\n        context: context\n      }\n    });\n  };\n}\n\nCreate.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules'\n];\n\n// helpers //////////\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  if (createConstraints.left) {\n    event.x = Math.max(event.x, createConstraints.left);\n  }\n\n  if (createConstraints.right) {\n    event.x = Math.min(event.x, createConstraints.right);\n  }\n\n  if (createConstraints.top) {\n    event.y = Math.max(event.y, createConstraints.top);\n  }\n\n  if (createConstraints.bottom) {\n    event.y = Math.min(event.y, createConstraints.bottom);\n  }\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isSingleShape(elements) {\n  return elements && elements.length === 1 && !isConnection(elements[0]);\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\r\n  translate\r\n} from '../../util/SvgTransformUtil';\r\n\r\nimport { getVisual } from '../../util/GraphicsUtil';\r\n\r\nimport {\r\n  append as svgAppend,\r\n  attr as svgAttr,\r\n  create as svgCreate,\r\n  remove as svgRemove\r\n} from 'tiny-svg';\r\n\r\nvar LOW_PRIORITY = 750;\r\n\r\n\r\nexport default function CreatePreview(\r\n    canvas,\r\n    eventBus,\r\n    graphicsFactory,\r\n    previewSupport,\r\n    styles\r\n) {\r\n  function createDragGroup(elements) {\r\n    var dragGroup = svgCreate('g');\r\n\r\n    svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\r\n\r\n    var childrenGfx = svgCreate('g');\r\n\r\n    elements.forEach(function(element) {\r\n\r\n      // create graphics\r\n      var gfx;\r\n\r\n      if (element.hidden) {\r\n        return;\r\n      }\r\n\r\n      if (element.waypoints) {\r\n        gfx = graphicsFactory._createContainer('connection', childrenGfx);\r\n\r\n        graphicsFactory.drawConnection(getVisual(gfx), element);\r\n      } else {\r\n        gfx = graphicsFactory._createContainer('shape', childrenGfx);\r\n\r\n        graphicsFactory.drawShape(getVisual(gfx), element);\r\n\r\n        translate(gfx, element.x, element.y);\r\n      }\r\n\r\n      // add preview\r\n      previewSupport.addDragger(element, dragGroup, gfx);\r\n    });\r\n\r\n    return dragGroup;\r\n  }\r\n\r\n  eventBus.on('create.move', LOW_PRIORITY, function(event) {\r\n\r\n    var hover = event.hover,\r\n        context = event.context,\r\n        elements = context.elements,\r\n        dragGroup = context.dragGroup;\r\n\r\n    // lazily create previews\r\n    if (!dragGroup) {\r\n      dragGroup = context.dragGroup = createDragGroup(elements);\r\n    }\r\n\r\n    var defaultLayer;\r\n\r\n    if (hover) {\r\n      if (!dragGroup.parentNode) {\r\n        defaultLayer = canvas.getDefaultLayer();\r\n\r\n        svgAppend(defaultLayer, dragGroup);\r\n      }\r\n\r\n      translate(dragGroup, event.x, event.y);\r\n    } else {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n\r\n  eventBus.on('create.cleanup', function(event) {\r\n    var context = event.context,\r\n        dragGroup = context.dragGroup;\r\n\r\n    if (dragGroup) {\r\n      svgRemove(dragGroup);\r\n    }\r\n  });\r\n}\r\n\r\nCreatePreview.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'graphicsFactory',\r\n  'previewSupport',\r\n  'styles'\r\n];\r\n","import DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\nimport RulesModule from '../rules';\nimport SelectionModule from '../selection';\n\nimport Create from './Create';\nimport CreatePreview from './CreatePreview';\n\n\nexport default {\n  __depends__: [\n    DraggingModule,\n    PreviewSupportModule,\n    RulesModule,\n    SelectionModule\n  ],\n  __init__: [\n    'create',\n    'createPreview'\n  ],\n  create: [ 'type', Create ],\n  createPreview: [ 'type', CreatePreview ]\n};\n","import {\n  assign,\n  forEach,\n  isFunction,\n  isDefined,\n  omit,\n  size\n} from 'min-dash';\n\nimport {\n  delegate as domDelegate,\n  domify as domify,\n  classes as domClasses,\n  attr as domAttr,\n  remove as domRemove\n} from 'min-dom';\n\nvar DATA_REF = 'data-id';\n\nvar CLOSE_EVENTS = [\n  'contextPad.close',\n  'canvas.viewbox.changing',\n  'commandStack.changed'\n];\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A popup menu that can be used to display a list of actions anywhere in the canvas.\n *\n * @param {Object} config\n * @param {Boolean|Object} [config.scale={ min: 1.0, max: 1.5 }]\n * @param {Number} [config.scale.min]\n * @param {Number} [config.scale.max]\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n *\n * @class\n * @constructor\n */\nexport default function PopupMenu(config, eventBus, canvas) {\n\n  var scale = isDefined(config && config.scale) ? config.scale : {\n    min: 1,\n    max: 1.5\n  };\n\n  this._config = {\n    scale: scale\n  };\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n  this._providers = {};\n  this._current = {};\n}\n\nPopupMenu.$inject = [\n  'config.popupMenu',\n  'eventBus',\n  'canvas'\n];\n\n/**\n * Registers a popup menu provider\n *\n * @param  {String} id\n * @param {Number} [priority=1000]\n * @param  {Object} provider\n *\n * @example\n * const popupMenuProvider = {\n *   getPopupMenuEntries: function(element) {\n *     return {\n *       'entry-1': {\n *         label: 'My Entry',\n *         action: function() { alert(\"I have been clicked!\"); }\n *       }\n *     }\n *   }\n * };\n *\n * popupMenu.registerProvider('myMenuID', popupMenuProvider);\n */\nPopupMenu.prototype.registerProvider = function(id, priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('popupMenu.getProviders.' + id, priority, function(event) {\n    event.providers.push(provider);\n  });\n};\n\n/**\n * Determine if the popup menu has entries.\n *\n * @return {Boolean} true if empty\n */\nPopupMenu.prototype.isEmpty = function(element, providerId) {\n  if (!element) {\n    throw new Error('element parameter is missing');\n  }\n\n  if (!providerId) {\n    throw new Error('providerId parameter is missing');\n  }\n\n  var providers = this._getProviders(providerId);\n\n  if (!providers) {\n    return true;\n  }\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  var hasEntries = size(entries) > 0,\n      hasHeaderEntries = headerEntries && size(headerEntries) > 0;\n\n  return !hasEntries && !hasHeaderEntries;\n};\n\n\n/**\n * Create entries and open popup menu at given position\n *\n * @param  {Object} element\n * @param  {String} id provider id\n * @param  {Object} position\n *\n * @return {Object} popup menu instance\n */\nPopupMenu.prototype.open = function(element, id, position) {\n\n  var providers = this._getProviders(id);\n\n  if (!element) {\n    throw new Error('Element is missing');\n  }\n\n  if (!providers || !providers.length) {\n    throw new Error('No registered providers for: ' + id);\n  }\n\n  if (!position) {\n    throw new Error('the position argument is missing');\n  }\n\n  if (this.isOpen()) {\n    this.close();\n  }\n\n  this._emit('open');\n\n  var current = this._current = {\n    className: id,\n    element: element,\n    position: position\n  };\n\n  var entries = this._getEntries(element, providers),\n      headerEntries = this._getHeaderEntries(element, providers);\n\n  current.entries = assign({}, entries, headerEntries);\n\n  current.container = this._createContainer();\n\n  if (size(headerEntries)) {\n    current.container.appendChild(\n      this._createEntries(headerEntries, 'djs-popup-header')\n    );\n  }\n\n  if (size(entries)) {\n    current.container.appendChild(\n      this._createEntries(entries, 'djs-popup-body')\n    );\n  }\n\n  var canvas = this._canvas,\n      parent = canvas.getContainer();\n\n  this._attachContainer(current.container, parent, position.cursor);\n  this._bindAutoClose();\n};\n\n\n/**\n * Removes the popup menu and unbinds the event handlers.\n */\nPopupMenu.prototype.close = function() {\n\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._emit('close');\n\n  this._unbindAutoClose();\n  domRemove(this._current.container);\n  this._current.container = null;\n};\n\n\n/**\n * Determine if an open popup menu exist.\n *\n * @return {Boolean} true if open\n */\nPopupMenu.prototype.isOpen = function() {\n  return !!this._current.container;\n};\n\n\n/**\n * Trigger an action associated with an entry.\n *\n * @param {Object} event\n *\n * @return the result of the action callback, if any\n */\nPopupMenu.prototype.trigger = function(event) {\n\n  // silence other actions\n  event.preventDefault();\n\n  var element = event.delegateTarget || event.target,\n      entryId = domAttr(element, DATA_REF);\n\n  var entry = this._getEntry(entryId);\n\n  if (entry.action) {\n    return entry.action.call(null, event, entry);\n  }\n};\n\nPopupMenu.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'popupMenu.getProviders.' + id,\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\nPopupMenu.prototype._getEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuEntries) {\n      forEach(provider.getEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n};\n\nPopupMenu.prototype._getHeaderEntries = function(element, providers) {\n\n  var entries = {};\n\n  forEach(providers, function(provider) {\n\n    // handle legacy method\n    if (!provider.getPopupMenuHeaderEntries) {\n      if (!provider.getHeaderEntries) {\n        return;\n      }\n\n      forEach(provider.getHeaderEntries(element), function(entry) {\n        var id = entry.id;\n\n        if (!id) {\n          throw new Error('every entry must have the id property set');\n        }\n\n        entries[id] = omit(entry, [ 'id' ]);\n      });\n\n      return;\n    }\n\n    var entriesOrUpdater = provider.getPopupMenuHeaderEntries(element);\n\n    if (isFunction(entriesOrUpdater)) {\n      entries = entriesOrUpdater(entries);\n    } else {\n      forEach(entriesOrUpdater, function(entry, id) {\n        entries[id] = entry;\n      });\n    }\n  });\n\n  return entries;\n\n\n};\n\n/**\n * Gets an entry instance (either entry or headerEntry) by id.\n *\n * @param  {String} entryId\n *\n * @return {Object} entry instance\n */\nPopupMenu.prototype._getEntry = function(entryId) {\n\n  var entry = this._current.entries[entryId];\n\n  if (!entry) {\n    throw new Error('entry not found');\n  }\n\n  return entry;\n};\n\nPopupMenu.prototype._emit = function(eventName) {\n  this._eventBus.fire('popupMenu.' + eventName);\n};\n\n/**\n * Creates the popup menu container.\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createContainer = function() {\n  var container = domify('<div class=\"djs-popup\">'),\n      position = this._current.position,\n      className = this._current.className;\n\n  assign(container.style, {\n    position: 'absolute',\n    left: position.x + 'px',\n    top: position.y + 'px',\n    visibility: 'hidden'\n  });\n\n  domClasses(container).add(className);\n\n  return container;\n};\n\n\n/**\n * Attaches the container to the DOM.\n *\n * @param {Object} container\n * @param {Object} parent\n */\nPopupMenu.prototype._attachContainer = function(container, parent, cursor) {\n  var self = this;\n\n  // Event handler\n  domDelegate.bind(container, '.entry' ,'click', function(event) {\n    self.trigger(event);\n  });\n\n  this._updateScale(container);\n\n  // Attach to DOM\n  parent.appendChild(container);\n\n  if (cursor) {\n    this._assureIsInbounds(container, cursor);\n  }\n};\n\n\n/**\n * Updates popup style.transform with respect to the config and zoom level.\n *\n * @method _updateScale\n *\n * @param {Object} container\n */\nPopupMenu.prototype._updateScale = function(container) {\n  var zoom = this._canvas.zoom();\n\n  var scaleConfig = this._config.scale,\n      minScale,\n      maxScale,\n      scale = zoom;\n\n  if (scaleConfig !== true) {\n\n    if (scaleConfig === false) {\n      minScale = 1;\n      maxScale = 1;\n    } else {\n      minScale = scaleConfig.min;\n      maxScale = scaleConfig.max;\n    }\n\n    if (isDefined(minScale) && zoom < minScale) {\n      scale = minScale;\n    }\n\n    if (isDefined(maxScale) && zoom > maxScale) {\n      scale = maxScale;\n    }\n\n  }\n\n  setTransform(container, 'scale(' + scale + ')');\n};\n\n\n/**\n * Make sure that the menu is always fully shown\n *\n * @method function\n *\n * @param  {Object} container\n * @param  {Position} cursor {x, y}\n */\nPopupMenu.prototype._assureIsInbounds = function(container, cursor) {\n  var canvas = this._canvas,\n      clientRect = canvas._container.getBoundingClientRect();\n\n  var containerX = container.offsetLeft,\n      containerY = container.offsetTop,\n      containerWidth = container.scrollWidth,\n      containerHeight = container.scrollHeight,\n      overAxis = {},\n      left, top;\n\n  var cursorPosition = {\n    x: cursor.x - clientRect.left,\n    y: cursor.y - clientRect.top\n  };\n\n  if (containerX + containerWidth > clientRect.width) {\n    overAxis.x = true;\n  }\n\n  if (containerY + containerHeight > clientRect.height) {\n    overAxis.y = true;\n  }\n\n  if (overAxis.x && overAxis.y) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  } else if (overAxis.x) {\n    left = cursorPosition.x - containerWidth + 'px';\n    top = cursorPosition.y + 'px';\n  } else if (overAxis.y && cursorPosition.y < containerHeight) {\n    left = cursorPosition.x + 'px';\n    top = 10 + 'px';\n  } else if (overAxis.y) {\n    left = cursorPosition.x + 'px';\n    top = cursorPosition.y - containerHeight + 'px';\n  }\n\n  assign(container.style, { left: left, top: top }, { visibility: 'visible', 'z-index': 1000 });\n};\n\n\n/**\n * Creates a list of entries and returns them as a DOM container.\n *\n * @param {Array<Object>} entries an array of entry objects\n * @param {String} className the class name of the entry container\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntries = function(entries, className) {\n\n  var entriesContainer = domify('<div>'),\n      self = this;\n\n  domClasses(entriesContainer).add(className);\n\n  forEach(entries, function(entry, id) {\n    var entryContainer = self._createEntry(entry, id);\n    entriesContainer.appendChild(entryContainer);\n  });\n\n  return entriesContainer;\n};\n\n\n/**\n * Creates a single entry and returns it as a DOM container.\n *\n * @param  {Object} entry\n *\n * @return {Object} a DOM container\n */\nPopupMenu.prototype._createEntry = function(entry, id) {\n\n  var entryContainer = domify('<div>'),\n      entryClasses = domClasses(entryContainer);\n\n  entryClasses.add('entry');\n\n  if (entry.className) {\n    entry.className.split(' ').forEach(function(className) {\n      entryClasses.add(className);\n    });\n  }\n\n  domAttr(entryContainer, DATA_REF, id);\n\n  if (entry.label) {\n    var label = domify('<span>');\n    label.textContent = entry.label;\n    entryContainer.appendChild(label);\n  }\n\n  if (entry.imageUrl) {\n    entryContainer.appendChild(domify('<img src=\"' + entry.imageUrl + '\" />'));\n  }\n\n  if (entry.active === true) {\n    entryClasses.add('active');\n  }\n\n  if (entry.disabled === true) {\n    entryClasses.add('disabled');\n  }\n\n  if (entry.title) {\n    entryContainer.title = entry.title;\n  }\n\n  return entryContainer;\n};\n\n\n/**\n * Set up listener to close popup automatically on certain events.\n */\nPopupMenu.prototype._bindAutoClose = function() {\n  this._eventBus.once(CLOSE_EVENTS, this.close, this);\n};\n\n\n/**\n * Remove the auto-closing listener.\n */\nPopupMenu.prototype._unbindAutoClose = function() {\n  this._eventBus.off(CLOSE_EVENTS, this.close, this);\n};\n\n\n\n// helpers /////////////////////////////\n\nfunction setTransform(element, transform) {\n  element.style['transform-origin'] = 'top left';\n\n  [ '', '-ms-', '-webkit-' ].forEach(function(prefix) {\n    element.style[prefix + 'transform'] = transform;\n  });\n}","import PopupMenu from './PopupMenu';\n\nexport default {\n  __init__: [ 'popupMenu' ],\n  popupMenu: [ 'type', PopupMenu ]\n};\n","/**\n * A clip board stub\n */\nexport default function Clipboard() {}\n\n\nClipboard.prototype.get = function() {\n  return this._data;\n};\n\nClipboard.prototype.set = function(data) {\n  this._data = data;\n};\n\nClipboard.prototype.clear = function() {\n  var data = this._data;\n\n  delete this._data;\n\n  return data;\n};\n\nClipboard.prototype.isEmpty = function() {\n  return !this._data;\n};","import Clipboard from './Clipboard';\n\nexport default {\n  clipboard: [ 'type', Clipboard ]\n};\n","export default function Mouse(eventBus) {\r\n  var self = this;\r\n\r\n  this._lastMoveEvent = null;\r\n\r\n  function setLastMoveEvent(mousemoveEvent) {\r\n    self._lastMoveEvent = mousemoveEvent;\r\n  }\r\n\r\n  eventBus.on('canvas.init', function(context) {\r\n    var svg = self._svg = context.svg;\r\n\r\n    svg.addEventListener('mousemove', setLastMoveEvent);\r\n  });\r\n\r\n  eventBus.on('canvas.destroy', function() {\r\n    self._lastMouseEvent = null;\r\n\r\n    self._svg.removeEventListener('mousemove', setLastMoveEvent);\r\n  });\r\n}\r\n\r\nMouse.$inject = [ 'eventBus' ];\r\n\r\nMouse.prototype.getLastMoveEvent = function() {\r\n  return this._lastMoveEvent || createMoveEvent(0, 0);\r\n};\r\n\r\n// helpers //////////\r\n\r\nexport function createMoveEvent(x, y) {\r\n  var event = document.createEvent('MouseEvent');\r\n\r\n  var screenX = x,\r\n      screenY = y,\r\n      clientX = x,\r\n      clientY = y;\r\n\r\n  if (event.initMouseEvent) {\r\n    event.initMouseEvent(\r\n      'mousemove',\r\n      true,\r\n      true,\r\n      window,\r\n      0,\r\n      screenX,\r\n      screenY,\r\n      clientX,\r\n      clientY,\r\n      false,\r\n      false,\r\n      false,\r\n      false,\r\n      0,\r\n      null\r\n    );\r\n  }\r\n\r\n  return event;\r\n}","import Mouse from './Mouse';\n\nexport default {\n  __init__: [ 'mouse' ],\n  mouse: [ 'type', Mouse ]\n};\n","import {\n  assign,\n  find,\n  forEach,\n  isArray,\n  isNumber,\n  map,\n  matchPattern,\n  omit,\n  sortBy\n} from 'min-dash';\n\nimport {\n  getBBox,\n  getParents\n} from '../../util/Elements';\n\nimport { eachElement } from '../../util/Elements';\n\n/**\n * @typedef {Function} <copyPaste.canCopyElements> listener\n *\n * @param {Object} context\n * @param {Array<djs.model.Base>} context.elements\n *\n * @returns {Array<djs.model.Base>|boolean} - Return elements to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <copyPaste.copyElement> listener\n *\n * @param {Object} context\n * @param {Object} context.descriptor\n * @param {djs.model.Base} context.element\n * @param {Array<djs.model.Base>} context.elements\n */\n\n/**\n * @typedef {Function} <copyPaste.elementsCopied> listener\n *\n * @param {Object} context\n * @param {Object} context.elements\n * @param {Object} context.tree\n */\n\n/**\n * @typedef {Function} <copyPaste.pasteElement> listener\n *\n * @param {Object} context\n * @param {Object} context.cache - Already created elements.\n * @param {Object} context.descriptor\n */\n\n/**\n * @typedef {Function} <copyPaste.pasteElements> listener\n *\n * @param {Object} context\n * @param {Object} context.hints - Add hints before pasting.\n */\n\n/**\n * Copy and paste elements.\n *\n * @param {Canvas} canvas\n * @param {Create} create\n * @param {Clipboard} clipboard\n * @param {ElementFactory} elementFactory\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Mouse} mouse\n * @param {Rules} rules\n */\nexport default function CopyPaste(\n    canvas,\n    create,\n    clipboard,\n    elementFactory,\n    eventBus,\n    modeling,\n    mouse,\n    rules\n) {\n\n  this._canvas = canvas;\n  this._create = create;\n  this._clipboard = clipboard;\n  this._elementFactory = elementFactory;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._mouse = mouse;\n  this._rules = rules;\n\n  eventBus.on('copyPaste.copyElement', function(context) {\n    var descriptor = context.descriptor,\n        element = context.element,\n        elements = context.elements;\n\n    // default priority (priority = 1)\n    descriptor.priority = 1;\n\n    descriptor.id = element.id;\n\n    var parentCopied = find(elements, function(e) {\n      return e === element.parent;\n    });\n\n    // do NOT reference parent if parent wasn't copied\n    if (parentCopied) {\n      descriptor.parent = element.parent.id;\n    }\n\n    // attachers (priority = 2)\n    if (isAttacher(element)) {\n      descriptor.priority = 2;\n\n      descriptor.host = element.host.id;\n    }\n\n    // connections (priority = 3)\n    if (isConnection(element)) {\n      descriptor.priority = 3;\n\n      descriptor.source = element.source.id;\n      descriptor.target = element.target.id;\n\n      descriptor.waypoints = copyWaypoints(element);\n    }\n\n    // labels (priority = 4)\n    if (isLabel(element)) {\n      descriptor.priority = 4;\n\n      descriptor.labelTarget = element.labelTarget.id;\n    }\n\n    forEach([ 'x', 'y', 'width', 'height' ], function(property) {\n      if (isNumber(element[ property ])) {\n        descriptor[ property ] = element[ property ];\n      }\n    });\n\n    descriptor.hidden = element.hidden;\n    descriptor.collapsed = element.collapsed;\n\n  });\n\n  eventBus.on('copyPaste.pasteElements', function(context) {\n    var hints = context.hints;\n\n    assign(hints, {\n      createElementsBehavior: false\n    });\n  });\n}\n\nCopyPaste.$inject = [\n  'canvas',\n  'create',\n  'clipboard',\n  'elementFactory',\n  'eventBus',\n  'modeling',\n  'mouse',\n  'rules'\n];\n\n\n/**\n * Copy elements.\n *\n * @param {Array<djs.model.Base>} elements\n *\n * @returns {Object}\n */\nCopyPaste.prototype.copy = function(elements) {\n  var allowed,\n      tree;\n\n  if (!isArray(elements)) {\n    elements = elements ? [ elements ] : [];\n  }\n\n  allowed = this._eventBus.fire('copyPaste.canCopyElements', {\n    elements: elements\n  });\n\n  if (allowed === false) {\n    tree = {};\n  } else {\n    tree = this.createTree(isArray(allowed) ? allowed : elements);\n  }\n\n  // we set an empty tree, selection of elements\n  // to copy was empty.\n  this._clipboard.set(tree);\n\n  this._eventBus.fire('copyPaste.elementsCopied', {\n    elements: elements,\n    tree: tree\n  });\n\n  return tree;\n};\n\n/**\n * Paste elements.\n *\n * @param {Object} [context]\n * @param {djs.model.base} [context.element] - Parent.\n * @param {Point} [context.point] - Position.\n * @param {Object} [context.hints] - Hints.\n */\nCopyPaste.prototype.paste = function(context) {\n  var tree = this._clipboard.get();\n\n  if (this._clipboard.isEmpty()) {\n    return;\n  }\n\n  var hints = context && context.hints || {};\n\n  this._eventBus.fire('copyPaste.pasteElements', {\n    hints: hints\n  });\n\n  var elements = this._createElements(tree);\n\n  // paste directly\n  if (context && context.element && context.point) {\n    return this._paste(elements, context.element, context.point, hints);\n  }\n\n  this._create.start(this._mouse.getLastMoveEvent(), elements, {\n    hints: hints || {}\n  });\n};\n\n/**\n * Paste elements directly.\n *\n * @param {Array<djs.model.Base>} elements\n * @param {djs.model.base} target\n * @param {Point} position\n * @param {Object} [hints]\n */\nCopyPaste.prototype._paste = function(elements, target, position, hints) {\n\n  // make sure each element has x and y\n  forEach(elements, function(element) {\n    if (!isNumber(element.x)) {\n      element.x = 0;\n    }\n\n    if (!isNumber(element.y)) {\n      element.y = 0;\n    }\n  });\n\n  var bbox = getBBox(elements);\n\n  // center elements around cursor\n  forEach(elements, function(element) {\n    if (isConnection(element)) {\n      element.waypoints = map(element.waypoints, function(waypoint) {\n        return {\n          x: waypoint.x - bbox.x - bbox.width / 2,\n          y: waypoint.y - bbox.y - bbox.height / 2\n        };\n      });\n    }\n\n    assign(element, {\n      x: element.x - bbox.x - bbox.width / 2,\n      y: element.y - bbox.y - bbox.height / 2\n    });\n  });\n\n  return this._modeling.createElements(elements, position, target, assign({}, hints));\n};\n\n/**\n * Create elements from tree.\n */\nCopyPaste.prototype._createElements = function(tree) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var cache = {};\n\n  var elements = [];\n\n  forEach(tree, function(branch, depth) {\n\n    depth = parseInt(depth, 10);\n\n    // sort by priority\n    branch = sortBy(branch, 'priority');\n\n    forEach(branch, function(descriptor) {\n\n      // remove priority\n      var attrs = assign({}, omit(descriptor, [ 'priority' ]));\n\n      if (cache[ descriptor.parent ]) {\n        attrs.parent = cache[ descriptor.parent ];\n      } else {\n        delete attrs.parent;\n      }\n\n      eventBus.fire('copyPaste.pasteElement', {\n        cache: cache,\n        descriptor: attrs\n      });\n\n      var element;\n\n      if (isConnection(attrs)) {\n        attrs.source = cache[ descriptor.source ];\n        attrs.target = cache[ descriptor.target ];\n\n        element = cache[ descriptor.id ] = self.createConnection(attrs);\n\n        elements.push(element);\n\n        return;\n      }\n\n      if (isLabel(attrs)) {\n        attrs.labelTarget = cache[ attrs.labelTarget ];\n\n        element = cache[ descriptor.id ] = self.createLabel(attrs);\n\n        elements.push(element);\n\n        return;\n      }\n\n      if (attrs.host) {\n        attrs.host = cache[ attrs.host ];\n      }\n\n      element = cache[ descriptor.id ] = self.createShape(attrs);\n\n      elements.push(element);\n    });\n\n  });\n\n  return elements;\n};\n\nCopyPaste.prototype.createConnection = function(attrs) {\n  var connection = this._elementFactory.createConnection(omit(attrs, [ 'id' ]));\n\n  return connection;\n};\n\nCopyPaste.prototype.createLabel = function(attrs) {\n  var label = this._elementFactory.createLabel(omit(attrs, [ 'id' ]));\n\n  return label;\n};\n\nCopyPaste.prototype.createShape = function(attrs) {\n  var shape = this._elementFactory.createShape(omit(attrs, [ 'id' ]));\n\n  return shape;\n};\n\n/**\n * Check wether element has relations to other elements e.g. attachers, labels and connections.\n *\n * @param  {Object} element\n * @param  {Array<djs.model.Base>} elements\n *\n * @returns {Boolean}\n */\nCopyPaste.prototype.hasRelations = function(element, elements) {\n  var labelTarget,\n      source,\n      target;\n\n  if (isConnection(element)) {\n    source = find(elements, matchPattern({ id: element.source.id }));\n    target = find(elements, matchPattern({ id: element.target.id }));\n\n    if (!source || !target) {\n      return false;\n    }\n  }\n\n  if (isLabel(element)) {\n    labelTarget = find(elements, matchPattern({ id: element.labelTarget.id }));\n\n    if (!labelTarget) {\n      return false;\n    }\n  }\n\n  return true;\n};\n\n/**\n * Create a tree-like structure from elements.\n *\n * @example\n * tree: {\n  *  0: [\n  *    { id: 'Shape_1', priority: 1, ... },\n  *    { id: 'Shape_2', priority: 1, ... },\n  *    { id: 'Connection_1', source: 'Shape_1', target: 'Shape_2', priority: 3, ... },\n  *    ...\n  *  ],\n  *  1: [\n  *    { id: 'Shape_3', parent: 'Shape1', priority: 1, ... },\n  *    ...\n  *  ]\n  * };\n  *\n  * @param  {Array<djs.model.base>} elements\n  *\n  * @return {Object}\n  */\nCopyPaste.prototype.createTree = function(elements) {\n  var rules = this._rules,\n      self = this;\n\n  var tree = {},\n      elementsData = [];\n\n  var parents = getParents(elements);\n\n  function canCopy(element, elements) {\n    return rules.allowed('element.copy', {\n      element: element,\n      elements: elements\n    });\n  }\n\n  function addElementData(element, depth) {\n\n    // (1) check wether element has already been added\n    var foundElementData = find(elementsData, function(elementsData) {\n      return element === elementsData.element;\n    });\n\n    // (2) add element if not already added\n    if (!foundElementData) {\n      elementsData.push({\n        element: element,\n        depth: depth\n      });\n\n      return;\n    }\n\n    // (3) update depth\n    if (foundElementData.depth < depth) {\n      elementsData = removeElementData(foundElementData, elementsData);\n\n      elementsData.push({\n        element: foundElementData.element,\n        depth: depth\n      });\n    }\n  }\n\n  function removeElementData(elementData, elementsData) {\n    var index = elementsData.indexOf(elementData);\n\n    if (index !== -1) {\n      elementsData.splice(index, 1);\n    }\n\n    return elementsData;\n  }\n\n  // (1) add elements\n  eachElement(parents, function(element, _index, depth) {\n\n    // do NOT add external labels directly\n    if (isLabel(element)) {\n      return;\n    }\n\n    // always copy external labels\n    forEach(element.labels, function(label) {\n      addElementData(label, depth);\n    });\n\n    function addRelatedElements(elements) {\n      elements && elements.length && forEach(elements, function(element) {\n\n        // add external labels\n        forEach(element.labels, function(label) {\n          addElementData(label, depth);\n        });\n\n        addElementData(element, depth);\n      });\n    }\n\n    forEach([ element.attachers, element.incoming, element.outgoing ], addRelatedElements);\n\n    addElementData(element, depth);\n\n    return element.children;\n  });\n\n  elements = map(elementsData, function(elementData) {\n    return elementData.element;\n  });\n\n  // (2) copy elements\n  elementsData = map(elementsData, function(elementData) {\n    elementData.descriptor = {};\n\n    self._eventBus.fire('copyPaste.copyElement', {\n      descriptor: elementData.descriptor,\n      element: elementData.element,\n      elements: elements\n    });\n\n    return elementData;\n  });\n\n  // (3) sort elements by priority\n  elementsData = sortBy(elementsData, function(elementData) {\n    return elementData.descriptor.priority;\n  });\n\n  elements = map(elementsData, function(elementData) {\n    return elementData.element;\n  });\n\n  // (4) create tree\n  forEach(elementsData, function(elementData) {\n    var depth = elementData.depth;\n\n    if (!self.hasRelations(elementData.element, elements)) {\n      removeElement(elementData.element, elements);\n\n      return;\n    }\n\n    if (!canCopy(elementData.element, elements)) {\n      removeElement(elementData.element, elements);\n\n      return;\n    }\n\n    if (!tree[depth]) {\n      tree[depth] = [];\n    }\n\n    tree[depth].push(elementData.descriptor);\n  });\n\n  return tree;\n};\n\n// helpers //////////\n\nfunction isAttacher(element) {\n  return !!element.host;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n\nfunction copyWaypoints(element) {\n  return map(element.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction removeElement(element, elements) {\n  var index = elements.indexOf(element);\n\n  if (index === -1) {\n    return elements;\n  }\n\n  return elements.splice(index, 1);\n}\n","import ClipboardModule from '../clipboard';\nimport CreateModule from '../create';\nimport MouseModule from '../mouse';\nimport RulesModule from '../rules';\n\nimport CopyPaste from './CopyPaste';\n\n\nexport default {\n  __depends__: [\n    ClipboardModule,\n    CreateModule,\n    MouseModule,\n    RulesModule\n  ],\n  __init__: [ 'copyPaste' ],\n  copyPaste: [ 'type', CopyPaste ]\n};\n","import {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  forEach,\n  isArray,\n  isUndefined,\n  omit,\n  reduce\n} from 'min-dash';\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nfunction removeProperties(element, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (element[property]) {\n      delete element[property];\n    }\n  });\n}\n\nvar LOW_PRIORITY = 750;\n\n\nexport default function BpmnCopyPaste(bpmnFactory, eventBus, moddleCopy) {\n\n  eventBus.on('copyPaste.copyElement', LOW_PRIORITY, function(context) {\n    var descriptor = context.descriptor,\n        element = context.element;\n\n    var businessObject = descriptor.oldBusinessObject = getBusinessObject(element);\n\n    descriptor.type = element.type;\n\n    copyProperties(businessObject, descriptor, 'name');\n\n    descriptor.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(businessObject.di, descriptor.di, [\n      'fill',\n      'stroke'\n    ]);\n\n    copyProperties(businessObject.di, descriptor, 'isExpanded');\n\n    if (isLabel(descriptor)) {\n      return descriptor;\n    }\n\n    // default sequence flow\n    if (businessObject.default) {\n      descriptor.default = businessObject.default.id;\n    }\n  });\n\n  eventBus.on('moddleCopy.canCopyProperty', function(context) {\n    var parent = context.parent,\n        property = context.property,\n        propertyName = context.propertyName,\n        bpmnProcess;\n\n    if (\n      propertyName === 'processRef' &&\n      is(parent, 'bpmn:Participant') &&\n      is(property, 'bpmn:Process')\n    ) {\n      bpmnProcess = bpmnFactory.create('bpmn:Process');\n\n      // return copy of process\n      return moddleCopy.copyElement(property, bpmnProcess);\n    }\n  });\n\n  var references;\n\n  function resolveReferences(descriptor, cache) {\n    var businessObject = getBusinessObject(descriptor);\n\n    // default sequence flows\n    if (descriptor.default) {\n\n      // relationship cannot be resolved immediately\n      references[ descriptor.default ] = {\n        element: businessObject,\n        property: 'default'\n      };\n    }\n\n    // boundary events\n    if (descriptor.host) {\n\n      // relationship can be resolved immediately\n      getBusinessObject(descriptor).attachedToRef = getBusinessObject(cache[ descriptor.host ]);\n    }\n\n    references = omit(references, reduce(references, function(array, reference, key) {\n      var element = reference.element,\n          property = reference.property;\n\n      if (key === descriptor.id) {\n        element[ property ] = businessObject;\n\n        array.push(descriptor.id);\n      }\n\n      return array;\n    }, []));\n  }\n\n  eventBus.on('copyPaste.pasteElements', function() {\n    references = {};\n  });\n\n  eventBus.on('copyPaste.pasteElement', function(context) {\n    var cache = context.cache,\n        descriptor = context.descriptor,\n        oldBusinessObject = descriptor.oldBusinessObject,\n        newBusinessObject;\n\n    // do NOT copy business object if external label\n    if (isLabel(descriptor)) {\n      descriptor.businessObject = getBusinessObject(cache[ descriptor.labelTarget ]);\n\n      return;\n    }\n\n    newBusinessObject = bpmnFactory.create(oldBusinessObject.$type);\n\n    descriptor.businessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject\n    );\n\n    // resolve references e.g. default sequence flow\n    resolveReferences(descriptor, cache);\n\n    copyProperties(descriptor, newBusinessObject, [\n      'isExpanded',\n      'name'\n    ]);\n\n    removeProperties(descriptor, 'oldBusinessObject');\n  });\n\n}\n\n\nBpmnCopyPaste.$inject = [\n  'bpmnFactory',\n  'eventBus',\n  'moddleCopy'\n];\n\n// helpers //////////\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}\n","import {\n  find,\n  forEach,\n  isArray,\n  isDefined,\n  isObject,\n  matchPattern,\n  reduce,\n  has,\n  sortBy\n} from 'min-dash';\n\nvar DISALLOWED_PROPERTIES = [\n  'artifacts',\n  'dataInputAssociations',\n  'dataOutputAssociations',\n  'default',\n  'flowElements',\n  'lanes',\n  'incoming',\n  'outgoing'\n];\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperties> listener\n *\n * @param {Object} context\n * @param {Array<string>} context.propertyNames\n * @param {ModdleElement} context.sourceElement\n * @param {ModdleElement} context.targetElement\n *\n * @returns {Array<string>|boolean} - Return properties to be copied or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canCopyProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {*|boolean} - Return copied property or false to disallow\n * copying.\n */\n\n/**\n * @typedef {Function} <moddleCopy.canSetCopiedProperty> listener\n *\n * @param {Object} context\n * @param {ModdleElement} context.parent\n * @param {*} context.property\n * @param {string} context.propertyName\n *\n * @returns {boolean} - Return false to disallow\n * setting copied property.\n */\n\n/**\n * Utility for copying model properties from source element to target element.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n * @param {BpmnModdle} moddle\n */\nexport default function ModdleCopy(eventBus, bpmnFactory, moddle) {\n  this._bpmnFactory = bpmnFactory;\n  this._eventBus = eventBus;\n  this._moddle = moddle;\n\n  // copy extension elements last\n  eventBus.on('moddleCopy.canCopyProperties', function(context) {\n    var propertyNames = context.propertyNames;\n\n    if (!propertyNames || !propertyNames.length) {\n      return;\n    }\n\n    return sortBy(propertyNames, function(propertyName) {\n      return propertyName === 'extensionElements';\n    });\n  });\n\n  // default check whether property can be copied\n  eventBus.on('moddleCopy.canCopyProperty', function(context) {\n    var parent = context.parent,\n        parentDescriptor = isObject(parent) && parent.$descriptor,\n        propertyName = context.propertyName;\n\n    if (propertyName && DISALLOWED_PROPERTIES.indexOf(propertyName) !== -1) {\n\n      // disallow copying property\n      return false;\n    }\n\n    if (propertyName &&\n      parentDescriptor &&\n      !find(parentDescriptor.properties, matchPattern({ name: propertyName }))) {\n\n      // disallow copying property\n      return false;\n    }\n  });\n\n  // do NOT allow to copy empty extension elements\n  eventBus.on('moddleCopy.canSetCopiedProperty', function(context) {\n    var property = context.property;\n\n    if (is(property, 'bpmn:ExtensionElements') && (!property.values || !property.values.length)) {\n\n      // disallow setting copied property\n      return false;\n    }\n  });\n}\n\nModdleCopy.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'moddle'\n];\n\n/**\n * Copy model properties of source element to target element.\n *\n * @param {ModdleElement} sourceElement\n * @param {ModdleElement} targetElement\n * @param {Array<string>} [propertyNames]\n *\n * @param {ModdleElement}\n */\nModdleCopy.prototype.copyElement = function(sourceElement, targetElement, propertyNames) {\n  var self = this;\n\n  if (propertyNames && !isArray(propertyNames)) {\n    propertyNames = [ propertyNames ];\n  }\n\n  propertyNames = propertyNames || getPropertyNames(sourceElement.$descriptor);\n\n  var canCopyProperties = this._eventBus.fire('moddleCopy.canCopyProperties', {\n    propertyNames: propertyNames,\n    sourceElement: sourceElement,\n    targetElement: targetElement\n  });\n\n  if (canCopyProperties === false) {\n    return targetElement;\n  }\n\n  if (isArray(canCopyProperties)) {\n    propertyNames = canCopyProperties;\n  }\n\n  // copy properties\n  forEach(propertyNames, function(propertyName) {\n    var sourceProperty;\n\n    if (has(sourceElement, propertyName)) {\n      sourceProperty = sourceElement.get(propertyName);\n    }\n\n    var copiedProperty = self.copyProperty(sourceProperty, targetElement, propertyName);\n\n    var canSetProperty = self._eventBus.fire('moddleCopy.canSetCopiedProperty', {\n      parent: parent,\n      property: copiedProperty,\n      propertyName: propertyName\n    });\n\n    if (canSetProperty === false) {\n      return;\n    }\n\n    if (isDefined(copiedProperty)) {\n      targetElement.set(propertyName, copiedProperty);\n    }\n  });\n\n  return targetElement;\n};\n\n/**\n * Copy model property.\n *\n * @param {*} property\n * @param {ModdleElement} parent\n * @param {string} propertyName\n *\n * @returns {*}\n */\nModdleCopy.prototype.copyProperty = function(property, parent, propertyName) {\n  var self = this;\n\n  // allow others to copy property\n  var copiedProperty = this._eventBus.fire('moddleCopy.canCopyProperty', {\n    parent: parent,\n    property: property,\n    propertyName: propertyName\n  });\n\n  // return if copying is NOT allowed\n  if (copiedProperty === false) {\n    return;\n  }\n\n  if (copiedProperty) {\n    if (isObject(copiedProperty) && copiedProperty.$type && !copiedProperty.$parent) {\n      copiedProperty.$parent = parent;\n    }\n\n    return copiedProperty;\n  }\n\n  var propertyDescriptor = this._moddle.getPropertyDescriptor(parent, propertyName);\n\n  // do NOT copy Ids and references\n  if (propertyDescriptor.isId || propertyDescriptor.isReference) {\n    return;\n  }\n\n  // copy arrays\n  if (isArray(property)) {\n    return reduce(property, function(childProperties, childProperty) {\n\n      // recursion\n      copiedProperty = self.copyProperty(childProperty, parent, propertyName);\n\n      // copying might NOT be allowed\n      if (copiedProperty) {\n        copiedProperty.$parent = parent;\n\n        return childProperties.concat(copiedProperty);\n      }\n\n      return childProperties;\n    }, []);\n  }\n\n  // copy model elements\n  if (isObject(property) && property.$type) {\n    if (this._moddle.getElementDescriptor(property).isGeneric) {\n      return;\n    }\n\n    copiedProperty = self._bpmnFactory.create(property.$type);\n\n    copiedProperty.$parent = parent;\n\n    // recursion\n    copiedProperty = self.copyElement(property, copiedProperty);\n\n    return copiedProperty;\n  }\n\n  // copy primitive properties\n  return property;\n};\n\n// helpers //////////\n\nexport function getPropertyNames(descriptor, keepDefaultProperties) {\n  return reduce(descriptor.properties, function(properties, property) {\n\n    if (keepDefaultProperties && property.default) {\n      return properties;\n    }\n\n    return properties.concat(property.name);\n  }, []);\n}\n\nfunction is(element, type) {\n  return element && (typeof element.$instanceOf === 'function') && element.$instanceOf(type);\n}","import CopyPasteModule from 'diagram-js/lib/features/copy-paste';\n\nimport BpmnCopyPaste from './BpmnCopyPaste';\nimport ModdleCopy from './ModdleCopy';\n\nexport default {\n  __depends__: [\n    CopyPasteModule\n  ],\n  __init__: [ 'bpmnCopyPaste', 'moddleCopy' ],\n  bpmnCopyPaste: [ 'type', BpmnCopyPaste ],\n  moddleCopy: [ 'type', ModdleCopy ]\n};\n","import {\n  assign\n} from 'min-dash';\n\nvar round = Math.round;\n\n/**\n * Service that allow replacing of elements.\n */\nexport default function Replace(modeling) {\n\n  this._modeling = modeling;\n}\n\nReplace.$inject = [ 'modeling' ];\n\n/**\n * @param {Element} oldElement - Element to be replaced\n * @param {Object}  newElementData - Containing information about the new element,\n *                                   for example the new bounds and type.\n * @param {Object}  options - Custom options that will be attached to the context. It can be used to inject data\n *                            that is needed in the command chain. For example it could be used in\n *                            eventbus.on('commandStack.shape.replace.postExecute') to change shape attributes after\n *                            shape creation.\n */\nReplace.prototype.replaceElement = function(oldElement, newElementData, options) {\n\n  if (oldElement.waypoints) {\n\n    // TODO(nikku): we do not replace connections, yet\n    return null;\n  }\n\n  var modeling = this._modeling;\n\n  var width = newElementData.width || oldElement.width,\n      height = newElementData.height || oldElement.height,\n      x = newElementData.x || oldElement.x,\n      y = newElementData.y || oldElement.y,\n      centerX = round(x + width / 2),\n      centerY = round(y + height / 2);\n\n  // modeling API requires center coordinates,\n  // account for that when handling shape bounds\n\n  return modeling.replaceShape(\n    oldElement,\n    assign(\n      {},\n      newElementData,\n      {\n        x: centerX,\n        y: centerY,\n        width: width,\n        height: height\n      }\n    ),\n    options\n  );\n};\n","import Replace from './Replace';\n\nexport default {\n  __init__: [ 'replace' ],\n  replace: [ 'type', Replace ]\n};","import {\n  pick,\n  assign,\n  filter,\n  forEach,\n  isArray,\n  isUndefined,\n  has\n} from 'min-dash';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../util/ModelUtil';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess\n} from '../../util/DiUtil';\n\nimport { getPropertyNames } from '../copy-paste/ModdleCopy';\n\nfunction copyProperties(source, target, properties) {\n  if (!isArray(properties)) {\n    properties = [ properties ];\n  }\n\n  forEach(properties, function(property) {\n    if (!isUndefined(source[property])) {\n      target[property] = source[property];\n    }\n  });\n}\n\nvar CUSTOM_PROPERTIES = [\n  'cancelActivity',\n  'instantiate',\n  'eventGatewayType',\n  'triggeredByEvent',\n  'isInterrupting'\n];\n\n\nfunction toggeling(element, target) {\n\n  var oldCollapsed = (\n    element && has(element, 'collapsed') ? element.collapsed : !isExpanded(element)\n  );\n\n  var targetCollapsed;\n\n  if (target && (has(target, 'collapsed') || has(target, 'isExpanded'))) {\n\n    // property is explicitly set so use it\n    targetCollapsed = (\n      has(target, 'collapsed') ? target.collapsed : !target.isExpanded\n    );\n  } else {\n\n    // keep old state\n    targetCollapsed = oldCollapsed;\n  }\n\n  if (oldCollapsed !== targetCollapsed) {\n    element.collapsed = oldCollapsed;\n    return true;\n  }\n\n  return false;\n}\n\n\n\n/**\n * This module takes care of replacing BPMN elements\n */\nexport default function BpmnReplace(\n    bpmnFactory,\n    elementFactory,\n    moddleCopy,\n    modeling,\n    replace,\n    selection\n) {\n\n  /**\n   * Prepares a new business object for the replacement element\n   * and triggers the replace operation.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {Object} target\n   * @param  {Object} [hints]\n   *\n   * @return {djs.model.Base} the newly created element\n   */\n  function replaceElement(element, target, hints) {\n\n    hints = hints || {};\n\n    var type = target.type,\n        oldBusinessObject = element.businessObject;\n\n    if (isSubProcess(oldBusinessObject)) {\n      if (type === 'bpmn:SubProcess') {\n        if (toggeling(element, target)) {\n\n          // expanding or collapsing process\n          modeling.toggleCollapse(element);\n\n          return element;\n        }\n      }\n    }\n\n    var newBusinessObject = bpmnFactory.create(type);\n\n    var newElement = {\n      type: type,\n      businessObject: newBusinessObject\n    };\n\n    var elementProps = getPropertyNames(oldBusinessObject.$descriptor),\n        newElementProps = getPropertyNames(newBusinessObject.$descriptor, true),\n        copyProps = intersection(elementProps, newElementProps);\n\n    // initialize special properties defined in target definition\n    assign(newBusinessObject, pick(target, CUSTOM_PROPERTIES));\n\n    var properties = filter(copyProps, function(propertyName) {\n\n      // copying event definitions, unless we replace\n      if (propertyName === 'eventDefinitions') {\n        return hasEventDefinition(element, target.eventDefinitionType);\n      }\n\n      // retain loop characteristics if the target element\n      // is not an event sub process\n      if (propertyName === 'loopCharacteristics') {\n        return !isEventSubProcess(newBusinessObject);\n      }\n\n      // so the applied properties from 'target' don't get lost\n      if (newBusinessObject.hasOwnProperty(propertyName)) {\n        return false;\n      }\n\n      if (propertyName === 'processRef' && target.isExpanded === false) {\n        return false;\n      }\n\n      if (propertyName === 'triggeredByEvent') {\n        return false;\n      }\n\n      return true;\n    });\n\n    newBusinessObject = moddleCopy.copyElement(\n      oldBusinessObject,\n      newBusinessObject,\n      properties\n    );\n\n    // initialize custom BPMN extensions\n    if (target.eventDefinitionType) {\n\n      // only initialize with new eventDefinition\n      // if we did not set an event definition yet,\n      // i.e. because we copied it\n      if (!hasEventDefinition(newBusinessObject, target.eventDefinitionType)) {\n        newElement.eventDefinitionType = target.eventDefinitionType;\n      }\n    }\n\n    if (is(oldBusinessObject, 'bpmn:Activity')) {\n\n      if (isSubProcess(oldBusinessObject)) {\n\n        // no toggeling, so keep old state\n        newElement.isExpanded = isExpanded(oldBusinessObject);\n      }\n\n      // else if property is explicitly set, use it\n      else if (target && has(target, 'isExpanded')) {\n        newElement.isExpanded = target.isExpanded;\n      }\n\n      // TODO: need also to respect min/max Size\n      // copy size, from an expanded subprocess to an expanded alternative subprocess\n      // except bpmn:Task, because Task is always expanded\n      if ((isExpanded(oldBusinessObject) && !is(oldBusinessObject, 'bpmn:Task')) && newElement.isExpanded) {\n        newElement.width = element.width;\n        newElement.height = element.height;\n      }\n    }\n\n    // remove children if not expanding sub process\n    if (isSubProcess(oldBusinessObject) && !isSubProcess(newBusinessObject)) {\n      hints.moveChildren = false;\n    }\n\n    // transform collapsed/expanded pools\n    if (is(oldBusinessObject, 'bpmn:Participant')) {\n\n      // create expanded pool\n      if (target.isExpanded === true) {\n        newBusinessObject.processRef = bpmnFactory.create('bpmn:Process');\n      } else {\n\n        // remove children when transforming to collapsed pool\n        hints.moveChildren = false;\n      }\n\n      // apply same width and default height\n      newElement.width = element.width;\n      newElement.height = elementFactory._getDefaultSize(newBusinessObject).height;\n    }\n\n    newBusinessObject.name = oldBusinessObject.name;\n\n    // retain default flow's reference between inclusive <-> exclusive gateways and activities\n    if (\n      isAny(oldBusinessObject, [\n        'bpmn:ExclusiveGateway',\n        'bpmn:InclusiveGateway',\n        'bpmn:Activity'\n      ]) &&\n      isAny(newBusinessObject, [\n        'bpmn:ExclusiveGateway',\n        'bpmn:InclusiveGateway',\n        'bpmn:Activity'\n      ])\n    ) {\n      newBusinessObject.default = oldBusinessObject.default;\n    }\n\n    if (\n      target.host &&\n      !is(oldBusinessObject, 'bpmn:BoundaryEvent') &&\n      is(newBusinessObject, 'bpmn:BoundaryEvent')\n    ) {\n      newElement.host = target.host;\n    }\n\n    newElement.di = {};\n\n    // fill and stroke will be set to DI\n    copyProperties(oldBusinessObject.di, newElement.di, [\n      'fill',\n      'stroke'\n    ]);\n\n    newElement = replace.replaceElement(element, newElement, hints);\n\n    if (hints.select !== false) {\n      selection.select(newElement);\n    }\n\n    return newElement;\n  }\n\n  this.replaceElement = replaceElement;\n}\n\nBpmnReplace.$inject = [\n  'bpmnFactory',\n  'elementFactory',\n  'moddleCopy',\n  'modeling',\n  'replace',\n  'selection'\n];\n\n\nfunction isSubProcess(bo) {\n  return is(bo, 'bpmn:SubProcess');\n}\n\nfunction hasEventDefinition(element, type) {\n\n  var bo = getBusinessObject(element);\n\n  return type && bo.get('eventDefinitions').some(function(definition) {\n    return is(definition, type);\n  });\n}\n\n/**\n * Compute intersection between two arrays.\n */\nfunction intersection(a1, a2) {\n  return a1.filter(function(el) {\n    return a2.indexOf(el) !== -1;\n  });\n}\n","import CopyPasteModule from '../copy-paste';\nimport ReplaceModule from 'diagram-js/lib/features/replace';\nimport SelectionModule from 'diagram-js/lib/features/selection';\n\nimport BpmnReplace from './BpmnReplace';\n\nexport default {\n  __depends__: [\n    CopyPasteModule,\n    ReplaceModule,\n    SelectionModule\n  ],\n  bpmnReplace: [ 'type', BpmnReplace ]\n};\n","import {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isExpanded\n} from '../../../util/DiUtil';\n\n\n/**\n * Returns true, if an element is from a different type\n * than a target definition. Takes into account the type,\n * event definition type and triggeredByEvent property.\n *\n * @param {djs.model.Base} element\n *\n * @return {Boolean}\n */\nexport function isDifferentType(element) {\n\n  return function(entry) {\n    var target = entry.target;\n\n    var businessObject = getBusinessObject(element),\n        eventDefinition = businessObject.eventDefinitions && businessObject.eventDefinitions[0];\n\n    var isTypeEqual = businessObject.$type === target.type;\n\n    var isEventDefinitionEqual = (\n      (eventDefinition && eventDefinition.$type) === target.eventDefinitionType\n    );\n\n    var isTriggeredByEventEqual = (\n      businessObject.triggeredByEvent === target.triggeredByEvent\n    );\n\n    var isExpandedEqual = (\n      target.isExpanded === undefined ||\n      target.isExpanded === isExpanded(businessObject)\n    );\n\n    return !isTypeEqual || !isEventDefinitionEqual || !isTriggeredByEventEqual || !isExpandedEqual;\n  };\n}","export var START_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throwing',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message Start Event',\n    actionName: 'replace-with-message-start',\n    className: 'bpmn-icon-start-event-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Start Event',\n    actionName: 'replace-with-timer-start',\n    className: 'bpmn-icon-start-event-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Start Event',\n    actionName: 'replace-with-conditional-start',\n    className: 'bpmn-icon-start-event-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Start Event',\n    actionName: 'replace-with-signal-start',\n    className: 'bpmn-icon-start-event-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  }\n];\n\nexport var INTERMEDIATE_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message Intermediate Catch Event',\n    actionName: 'replace-with-message-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-message',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Message Intermediate Throw Event',\n    actionName: 'replace-with-message-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-message',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Intermediate Catch Event',\n    actionName: 'replace-with-timer-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-timer',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Intermediate Throw Event',\n    actionName: 'replace-with-escalation-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-escalation',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Intermediate Catch Event',\n    actionName: 'replace-with-conditional-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-condition',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Link Intermediate Catch Event',\n    actionName: 'replace-with-link-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-link',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:LinkEventDefinition'\n    }\n  },\n  {\n    label: 'Link Intermediate Throw Event',\n    actionName: 'replace-with-link-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-link',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:LinkEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Intermediate Throw Event',\n    actionName: 'replace-with-compensation-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-compensation',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Intermediate Catch Event',\n    actionName: 'replace-with-signal-intermediate-catch',\n    className: 'bpmn-icon-intermediate-event-catch-signal',\n    target: {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Intermediate Throw Event',\n    actionName: 'replace-with-signal-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-throw-signal',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  }\n];\n\nexport var END_EVENT = [\n  {\n    label: 'Start Event',\n    actionName: 'replace-with-none-start',\n    className: 'bpmn-icon-start-event-none',\n    target: {\n      type: 'bpmn:StartEvent'\n    }\n  },\n  {\n    label: 'Intermediate Throw Event',\n    actionName: 'replace-with-none-intermediate-throw',\n    className: 'bpmn-icon-intermediate-event-none',\n    target: {\n      type: 'bpmn:IntermediateThrowEvent'\n    }\n  },\n  {\n    label: 'End Event',\n    actionName: 'replace-with-none-end',\n    className: 'bpmn-icon-end-event-none',\n    target: {\n      type: 'bpmn:EndEvent'\n    }\n  },\n  {\n    label: 'Message End Event',\n    actionName: 'replace-with-message-end',\n    className: 'bpmn-icon-end-event-message',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation End Event',\n    actionName: 'replace-with-escalation-end',\n    className: 'bpmn-icon-end-event-escalation',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Error End Event',\n    actionName: 'replace-with-error-end',\n    className: 'bpmn-icon-end-event-error',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Cancel End Event',\n    actionName: 'replace-with-cancel-end',\n    className: 'bpmn-icon-end-event-cancel',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:CancelEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation End Event',\n    actionName: 'replace-with-compensation-end',\n    className: 'bpmn-icon-end-event-compensation',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Signal End Event',\n    actionName: 'replace-with-signal-end',\n    className: 'bpmn-icon-end-event-signal',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Terminate End Event',\n    actionName: 'replace-with-terminate-end',\n    className: 'bpmn-icon-end-event-terminate',\n    target: {\n      type: 'bpmn:EndEvent',\n      eventDefinitionType: 'bpmn:TerminateEventDefinition'\n    }\n  }\n];\n\nexport var GATEWAY = [\n  {\n    label: 'Exclusive Gateway',\n    actionName: 'replace-with-exclusive-gateway',\n    className: 'bpmn-icon-gateway-xor',\n    target: {\n      type: 'bpmn:ExclusiveGateway'\n    }\n  },\n  {\n    label: 'Parallel Gateway',\n    actionName: 'replace-with-parallel-gateway',\n    className: 'bpmn-icon-gateway-parallel',\n    target: {\n      type: 'bpmn:ParallelGateway'\n    }\n  },\n  {\n    label: 'Inclusive Gateway',\n    actionName: 'replace-with-inclusive-gateway',\n    className: 'bpmn-icon-gateway-or',\n    target: {\n      type: 'bpmn:InclusiveGateway'\n    }\n  },\n  {\n    label: 'Complex Gateway',\n    actionName: 'replace-with-complex-gateway',\n    className: 'bpmn-icon-gateway-complex',\n    target: {\n      type: 'bpmn:ComplexGateway'\n    }\n  },\n  {\n    label: 'Event based Gateway',\n    actionName: 'replace-with-event-based-gateway',\n    className: 'bpmn-icon-gateway-eventbased',\n    target: {\n      type: 'bpmn:EventBasedGateway',\n      instantiate: false,\n      eventGatewayType: 'Exclusive'\n    }\n  }\n\n  // Gateways deactivated until https://github.com/bpmn-io/bpmn-js/issues/194\n  // {\n  //   label: 'Event based instantiating Gateway',\n  //   actionName: 'replace-with-exclusive-event-based-gateway',\n  //   className: 'bpmn-icon-exclusive-event-based',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Exclusive' }\n  //   }\n  // },\n  // {\n  //   label: 'Parallel Event based instantiating Gateway',\n  //   actionName: 'replace-with-parallel-event-based-instantiate-gateway',\n  //   className: 'bpmn-icon-parallel-event-based-instantiate-gateway',\n  //   target: {\n  //     type: 'bpmn:EventBasedGateway'\n  //   },\n  //   options: {\n  //     businessObject: { instantiate: true, eventGatewayType: 'Parallel' }\n  //   }\n  // }\n];\n\nexport var SUBPROCESS_EXPANDED = [\n  {\n    label: 'Transaction',\n    actionName: 'replace-with-transaction',\n    className: 'bpmn-icon-transaction',\n    target: {\n      type: 'bpmn:Transaction',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Event Sub Process',\n    actionName: 'replace-with-event-subprocess',\n    className: 'bpmn-icon-event-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      triggeredByEvent: true,\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Sub Process (collapsed)',\n    actionName: 'replace-with-collapsed-subprocess',\n    className: 'bpmn-icon-subprocess-collapsed',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: false\n    }\n  }\n];\n\nexport var TRANSACTION = [\n  {\n    label: 'Sub Process',\n    actionName: 'replace-with-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Event Sub Process',\n    actionName: 'replace-with-event-subprocess',\n    className: 'bpmn-icon-event-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      triggeredByEvent: true,\n      isExpanded: true\n    }\n  }\n];\n\nexport var EVENT_SUB_PROCESS = [\n  {\n    label: 'Sub Process',\n    actionName: 'replace-with-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Transaction',\n    actionName: 'replace-with-transaction',\n    className: 'bpmn-icon-transaction',\n    target: {\n      type: 'bpmn:Transaction',\n      isExpanded: true\n    }\n  }\n];\n\nexport var TASK = [\n  {\n    label: 'Task',\n    actionName: 'replace-with-task',\n    className: 'bpmn-icon-task',\n    target: {\n      type: 'bpmn:Task'\n    }\n  },\n  {\n    label: 'Send Task',\n    actionName: 'replace-with-send-task',\n    className: 'bpmn-icon-send',\n    target: {\n      type: 'bpmn:SendTask'\n    }\n  },\n  {\n    label: 'Receive Task',\n    actionName: 'replace-with-receive-task',\n    className: 'bpmn-icon-receive',\n    target: {\n      type: 'bpmn:ReceiveTask'\n    }\n  },\n  {\n    label: 'User Task',\n    actionName: 'replace-with-user-task',\n    className: 'bpmn-icon-user',\n    target: {\n      type: 'bpmn:UserTask'\n    }\n  },\n  {\n    label: 'Manual Task',\n    actionName: 'replace-with-manual-task',\n    className: 'bpmn-icon-manual',\n    target: {\n      type: 'bpmn:ManualTask'\n    }\n  },\n  {\n    label: 'Business Rule Task',\n    actionName: 'replace-with-rule-task',\n    className: 'bpmn-icon-business-rule',\n    target: {\n      type: 'bpmn:BusinessRuleTask'\n    }\n  },\n  {\n    label: 'Service Task',\n    actionName: 'replace-with-service-task',\n    className: 'bpmn-icon-service',\n    target: {\n      type: 'bpmn:ServiceTask'\n    }\n  },\n  {\n    label: 'Script Task',\n    actionName: 'replace-with-script-task',\n    className: 'bpmn-icon-script',\n    target: {\n      type: 'bpmn:ScriptTask'\n    }\n  },\n  {\n    label: 'Call Activity',\n    actionName: 'replace-with-call-activity',\n    className: 'bpmn-icon-call-activity',\n    target: {\n      type: 'bpmn:CallActivity'\n    }\n  },\n  {\n    label: 'Sub Process (collapsed)',\n    actionName: 'replace-with-collapsed-subprocess',\n    className: 'bpmn-icon-subprocess-collapsed',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: false\n    }\n  },\n  {\n    label: 'Sub Process (expanded)',\n    actionName: 'replace-with-expanded-subprocess',\n    className: 'bpmn-icon-subprocess-expanded',\n    target: {\n      type: 'bpmn:SubProcess',\n      isExpanded: true\n    }\n  }\n];\n\nexport var BOUNDARY_EVENT = [\n  {\n    label: 'Message Boundary Event',\n    actionName: 'replace-with-message-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-message',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Boundary Event',\n    actionName: 'replace-with-timer-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-timer',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Boundary Event',\n    actionName: 'replace-with-escalation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-escalation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Boundary Event',\n    actionName: 'replace-with-conditional-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-condition',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Error Boundary Event',\n    actionName: 'replace-with-error-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-error',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Cancel Boundary Event',\n    actionName: 'replace-with-cancel-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-cancel',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:CancelEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Boundary Event',\n    actionName: 'replace-with-signal-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-signal',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Boundary Event',\n    actionName: 'replace-with-compensation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-compensation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Message Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-message-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-message',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Timer Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-timer-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-timer',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Escalation Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-escalation-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-escalation',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Conditional Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-conditional-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-condition',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition',\n      cancelActivity: false\n    }\n  },\n  {\n    label: 'Signal Boundary Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-signal-boundary',\n    className: 'bpmn-icon-intermediate-event-catch-non-interrupting-signal',\n    target: {\n      type: 'bpmn:BoundaryEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition',\n      cancelActivity: false\n    }\n  }\n];\n\nexport var EVENT_SUB_PROCESS_START_EVENT = [\n  {\n    label: 'Message Start Event',\n    actionName: 'replace-with-message-start',\n    className: 'bpmn-icon-start-event-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition'\n    }\n  },\n  {\n    label: 'Timer Start Event',\n    actionName: 'replace-with-timer-start',\n    className: 'bpmn-icon-start-event-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition'\n    }\n  },\n  {\n    label: 'Conditional Start Event',\n    actionName: 'replace-with-conditional-start',\n    className: 'bpmn-icon-start-event-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition'\n    }\n  },\n  {\n    label: 'Signal Start Event',\n    actionName: 'replace-with-signal-start',\n    className: 'bpmn-icon-start-event-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition'\n    }\n  },\n  {\n    label: 'Error Start Event',\n    actionName: 'replace-with-error-start',\n    className: 'bpmn-icon-start-event-error',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ErrorEventDefinition'\n    }\n  },\n  {\n    label: 'Escalation Start Event',\n    actionName: 'replace-with-escalation-start',\n    className: 'bpmn-icon-start-event-escalation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition'\n    }\n  },\n  {\n    label: 'Compensation Start Event',\n    actionName: 'replace-with-compensation-start',\n    className: 'bpmn-icon-start-event-compensation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:CompensateEventDefinition'\n    }\n  },\n  {\n    label: 'Message Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-message-start',\n    className: 'bpmn-icon-start-event-non-interrupting-message',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:MessageEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Timer Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-timer-start',\n    className: 'bpmn-icon-start-event-non-interrupting-timer',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:TimerEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Conditional Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-conditional-start',\n    className: 'bpmn-icon-start-event-non-interrupting-condition',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:ConditionalEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Signal Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-signal-start',\n    className: 'bpmn-icon-start-event-non-interrupting-signal',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:SignalEventDefinition',\n      isInterrupting: false\n    }\n  },\n  {\n    label: 'Escalation Start Event (non-interrupting)',\n    actionName: 'replace-with-non-interrupting-escalation-start',\n    className: 'bpmn-icon-start-event-non-interrupting-escalation',\n    target: {\n      type: 'bpmn:StartEvent',\n      eventDefinitionType: 'bpmn:EscalationEventDefinition',\n      isInterrupting: false\n    }\n  }\n];\n\nexport var SEQUENCE_FLOW = [\n  {\n    label: 'Sequence Flow',\n    actionName: 'replace-with-sequence-flow',\n    className: 'bpmn-icon-connection'\n  },\n  {\n    label: 'Default Flow',\n    actionName: 'replace-with-default-flow',\n    className: 'bpmn-icon-default-flow'\n  },\n  {\n    label: 'Conditional Flow',\n    actionName: 'replace-with-conditional-flow',\n    className: 'bpmn-icon-conditional-flow'\n  }\n];\n\nexport var PARTICIPANT = [\n  {\n    label: 'Expanded Pool',\n    actionName: 'replace-with-expanded-pool',\n    className: 'bpmn-icon-participant',\n    target: {\n      type: 'bpmn:Participant',\n      isExpanded: true\n    }\n  },\n  {\n    label: 'Collapsed Pool',\n    actionName: 'replace-with-collapsed-pool',\n\n    // TODO(@janstuemmel): maybe design new icon\n    className: 'bpmn-icon-lane',\n    target: {\n      type: 'bpmn:Participant',\n      isExpanded: false\n    }\n  }\n];\n","import {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isEventSubProcess,\n  isExpanded\n} from '../../util/DiUtil';\n\nimport {\n  isDifferentType\n} from './util/TypeUtil';\n\nimport {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport * as replaceOptions from '../replace/ReplaceOptions';\n\n\n/**\n * This module is an element agnostic replace menu provider for the popup menu.\n */\nexport default function ReplaceMenuProvider(\n    popupMenu, modeling, moddle,\n    bpmnReplace, rules, translate) {\n\n  this._popupMenu = popupMenu;\n  this._modeling = modeling;\n  this._moddle = moddle;\n  this._bpmnReplace = bpmnReplace;\n  this._rules = rules;\n  this._translate = translate;\n\n  this.register();\n}\n\nReplaceMenuProvider.$inject = [\n  'popupMenu',\n  'modeling',\n  'moddle',\n  'bpmnReplace',\n  'rules',\n  'translate'\n];\n\n\n/**\n * Register replace menu provider in the popup menu\n */\nReplaceMenuProvider.prototype.register = function() {\n  this._popupMenu.registerProvider('bpmn-replace', this);\n};\n\n\n/**\n * Get all entries from replaceOptions for the given element and apply filters\n * on them. Get for example only elements, which are different from the current one.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getEntries = function(element) {\n\n  var businessObject = element.businessObject;\n\n  var rules = this._rules;\n\n  var entries;\n\n  if (!rules.allowed('shape.replace', { element: element })) {\n    return [];\n  }\n\n  var differentType = isDifferentType(element);\n\n  // start events outside event sub processes\n  if (is(businessObject, 'bpmn:StartEvent') && !isEventSubProcess(businessObject.$parent)) {\n\n    entries = filter(replaceOptions.START_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded/collapsed pools\n  if (is(businessObject, 'bpmn:Participant')) {\n\n    entries = filter(replaceOptions.PARTICIPANT, function(entry) {\n      return isExpanded(businessObject) !== entry.target.isExpanded;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // start events inside event sub processes\n  if (is(businessObject, 'bpmn:StartEvent') && isEventSubProcess(businessObject.$parent)) {\n\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS_START_EVENT, function(entry) {\n\n      var target = entry.target;\n\n      var isInterrupting = target.isInterrupting !== false;\n\n      var isInterruptingEqual = getBusinessObject(element).isInterrupting === isInterrupting;\n\n      // filters elements which types and event definition are equal but have have different interrupting types\n      return differentType(entry) || !differentType(entry) && !isInterruptingEqual;\n\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // end events\n  if (is(businessObject, 'bpmn:EndEvent')) {\n\n    entries = filter(replaceOptions.END_EVENT, function(entry) {\n      var target = entry.target;\n\n      // hide cancel end events outside transactions\n      if (target.eventDefinitionType == 'bpmn:CancelEventDefinition' && !is(businessObject.$parent, 'bpmn:Transaction')) {\n        return false;\n      }\n\n      return differentType(entry);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // boundary events\n  if (is(businessObject, 'bpmn:BoundaryEvent')) {\n\n    entries = filter(replaceOptions.BOUNDARY_EVENT, function(entry) {\n\n      var target = entry.target;\n\n      if (target.eventDefinition == 'bpmn:CancelEventDefinition' &&\n         !is(businessObject.attachedToRef, 'bpmn:Transaction')) {\n        return false;\n      }\n      var cancelActivity = target.cancelActivity !== false;\n\n      var isCancelActivityEqual = businessObject.cancelActivity == cancelActivity;\n\n      return differentType(entry) || !differentType(entry) && !isCancelActivityEqual;\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // intermediate events\n  if (is(businessObject, 'bpmn:IntermediateCatchEvent') ||\n      is(businessObject, 'bpmn:IntermediateThrowEvent')) {\n\n    entries = filter(replaceOptions.INTERMEDIATE_EVENT, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // gateways\n  if (is(businessObject, 'bpmn:Gateway')) {\n\n    entries = filter(replaceOptions.GATEWAY, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // transactions\n  if (is(businessObject, 'bpmn:Transaction')) {\n\n    entries = filter(replaceOptions.TRANSACTION, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded event sub processes\n  if (isEventSubProcess(businessObject) && isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.EVENT_SUB_PROCESS, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // expanded sub processes\n  if (is(businessObject, 'bpmn:SubProcess') && isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.SUBPROCESS_EXPANDED, differentType);\n\n    return this._createEntries(element, entries);\n  }\n\n  // collapsed ad hoc sub processes\n  if (is(businessObject, 'bpmn:AdHocSubProcess') && !isExpanded(businessObject)) {\n\n    entries = filter(replaceOptions.TASK, function(entry) {\n\n      var target = entry.target;\n\n      var isTargetSubProcess = target.type === 'bpmn:SubProcess';\n\n      var isTargetExpanded = target.isExpanded === true;\n\n      return isDifferentType(element, target) && (!isTargetSubProcess || isTargetExpanded);\n    });\n\n    return this._createEntries(element, entries);\n  }\n\n  // sequence flows\n  if (is(businessObject, 'bpmn:SequenceFlow')) {\n    return this._createSequenceFlowEntries(element, replaceOptions.SEQUENCE_FLOW);\n  }\n\n  // flow nodes\n  if (is(businessObject, 'bpmn:FlowNode')) {\n    entries = filter(replaceOptions.TASK, differentType);\n\n    // collapsed SubProcess can not be replaced with itself\n    if (is(businessObject, 'bpmn:SubProcess') && !isExpanded(businessObject)) {\n      entries = filter(entries, function(entry) {\n        return entry.label !== 'Sub Process (collapsed)';\n      });\n    }\n\n    return this._createEntries(element, entries);\n  }\n\n  return [];\n};\n\n\n/**\n * Get a list of header items for the given element. This includes buttons\n * for multi instance markers and for the ad hoc marker.\n *\n * @param {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu entry items\n */\nReplaceMenuProvider.prototype.getHeaderEntries = function(element) {\n\n  var headerEntries = [];\n\n  if (is(element, 'bpmn:Activity') && !isEventSubProcess(element)) {\n    headerEntries = headerEntries.concat(this._getLoopEntries(element));\n  }\n\n  if (is(element, 'bpmn:SubProcess') &&\n      !is(element, 'bpmn:Transaction') &&\n      !isEventSubProcess(element)) {\n    headerEntries.push(this._getAdHocEntry(element));\n  }\n\n  return headerEntries;\n};\n\n\n/**\n * Creates an array of menu entry objects for a given element and filters the replaceOptions\n * according to a filter function.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createEntries = function(element, replaceOptions) {\n  var menuEntries = [];\n\n  var self = this;\n\n  forEach(replaceOptions, function(definition) {\n    var entry = self._createMenuEntry(definition, element);\n\n    menuEntries.push(entry);\n  });\n\n  return menuEntries;\n};\n\n/**\n * Creates an array of menu entry objects for a given sequence flow.\n *\n * @param  {djs.model.Base} element\n * @param  {Object} replaceOptions\n\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._createSequenceFlowEntries = function(element, replaceOptions) {\n\n  var businessObject = getBusinessObject(element);\n\n  var menuEntries = [];\n\n  var modeling = this._modeling,\n      moddle = this._moddle;\n\n  var self = this;\n\n  forEach(replaceOptions, function(entry) {\n\n    switch (entry.actionName) {\n    case 'replace-with-default-flow':\n      if (businessObject.sourceRef.default !== businessObject &&\n            (is(businessObject.sourceRef, 'bpmn:ExclusiveGateway') ||\n             is(businessObject.sourceRef, 'bpmn:InclusiveGateway') ||\n             is(businessObject.sourceRef, 'bpmn:ComplexGateway') ||\n             is(businessObject.sourceRef, 'bpmn:Activity'))) {\n\n        menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element.source, { default: businessObject });\n        }));\n      }\n      break;\n    case 'replace-with-conditional-flow':\n      if (!businessObject.conditionExpression && is(businessObject.sourceRef, 'bpmn:Activity')) {\n\n        menuEntries.push(self._createMenuEntry(entry, element, function() {\n          var conditionExpression = moddle.create('bpmn:FormalExpression', { body: '' });\n\n          modeling.updateProperties(element, { conditionExpression: conditionExpression });\n        }));\n      }\n      break;\n    default:\n\n      // default flows\n      if (is(businessObject.sourceRef, 'bpmn:Activity') && businessObject.conditionExpression) {\n        return menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element, { conditionExpression: undefined });\n        }));\n      }\n\n      // conditional flows\n      if ((is(businessObject.sourceRef, 'bpmn:ExclusiveGateway') ||\n           is(businessObject.sourceRef, 'bpmn:InclusiveGateway') ||\n           is(businessObject.sourceRef, 'bpmn:ComplexGateway') ||\n           is(businessObject.sourceRef, 'bpmn:Activity')) &&\n           businessObject.sourceRef.default === businessObject) {\n\n        return menuEntries.push(self._createMenuEntry(entry, element, function() {\n          modeling.updateProperties(element.source, { default: undefined });\n        }));\n      }\n    }\n  });\n\n  return menuEntries;\n};\n\n\n/**\n * Creates and returns a single menu entry item.\n *\n * @param  {Object} definition a single replace options definition object\n * @param  {djs.model.Base} element\n * @param  {Function} [action] an action callback function which gets called when\n *                             the menu entry is being triggered.\n *\n * @return {Object} menu entry item\n */\nReplaceMenuProvider.prototype._createMenuEntry = function(definition, element, action) {\n  var translate = this._translate;\n  var replaceElement = this._bpmnReplace.replaceElement;\n\n  var replaceAction = function() {\n    return replaceElement(element, definition.target);\n  };\n\n  action = action || replaceAction;\n\n  var menuEntry = {\n    label: translate(definition.label),\n    className: definition.className,\n    id: definition.actionName,\n    action: action\n  };\n\n  return menuEntry;\n};\n\n/**\n * Get a list of menu items containing buttons for multi instance markers\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array<Object>} a list of menu items\n */\nReplaceMenuProvider.prototype._getLoopEntries = function(element) {\n\n  var self = this;\n  var translate = this._translate;\n\n  function toggleLoopEntry(event, entry) {\n    var loopCharacteristics;\n\n    if (entry.active) {\n      loopCharacteristics = undefined;\n    } else {\n      loopCharacteristics = self._moddle.create(entry.options.loopCharacteristics);\n\n      if (entry.options.isSequential) {\n        loopCharacteristics.isSequential = entry.options.isSequential;\n      }\n    }\n    self._modeling.updateProperties(element, { loopCharacteristics: loopCharacteristics });\n  }\n\n  var businessObject = getBusinessObject(element),\n      loopCharacteristics = businessObject.loopCharacteristics;\n\n  var isSequential,\n      isLoop,\n      isParallel;\n\n  if (loopCharacteristics) {\n    isSequential = loopCharacteristics.isSequential;\n    isLoop = loopCharacteristics.isSequential === undefined;\n    isParallel = loopCharacteristics.isSequential !== undefined && !loopCharacteristics.isSequential;\n  }\n\n\n  var loopEntries = [\n    {\n      id: 'toggle-parallel-mi',\n      className: 'bpmn-icon-parallel-mi-marker',\n      title: translate('Parallel Multi Instance'),\n      active: isParallel,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:MultiInstanceLoopCharacteristics',\n        isSequential: false\n      }\n    },\n    {\n      id: 'toggle-sequential-mi',\n      className: 'bpmn-icon-sequential-mi-marker',\n      title: translate('Sequential Multi Instance'),\n      active: isSequential,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:MultiInstanceLoopCharacteristics',\n        isSequential: true\n      }\n    },\n    {\n      id: 'toggle-loop',\n      className: 'bpmn-icon-loop-marker',\n      title: translate('Loop'),\n      active: isLoop,\n      action: toggleLoopEntry,\n      options: {\n        loopCharacteristics: 'bpmn:StandardLoopCharacteristics'\n      }\n    }\n  ];\n  return loopEntries;\n};\n\n\n/**\n * Get the menu items containing a button for the ad hoc marker\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} a menu item\n */\nReplaceMenuProvider.prototype._getAdHocEntry = function(element) {\n  var translate = this._translate;\n  var businessObject = getBusinessObject(element);\n\n  var isAdHoc = is(businessObject, 'bpmn:AdHocSubProcess');\n\n  var replaceElement = this._bpmnReplace.replaceElement;\n\n  var adHocEntry = {\n    id: 'toggle-adhoc',\n    className: 'bpmn-icon-ad-hoc-marker',\n    title: translate('Ad-hoc'),\n    active: isAdHoc,\n    action: function(event, entry) {\n      if (isAdHoc) {\n        return replaceElement(element, { type: 'bpmn:SubProcess' }, {\n          autoResize: false,\n          layoutConnection: false\n        });\n      } else {\n        return replaceElement(element, { type: 'bpmn:AdHocSubProcess' }, {\n          autoResize: false,\n          layoutConnection: false\n        });\n      }\n    }\n  };\n\n  return adHocEntry;\n};\n","import PopupMenuModule from 'diagram-js/lib/features/popup-menu';\nimport ReplaceModule from '../replace';\n\nimport ReplaceMenuProvider from './ReplaceMenuProvider';\n\n\nexport default {\n  __depends__: [\n    PopupMenuModule,\n    ReplaceModule\n  ],\n  __init__: [ 'replaceMenuProvider' ],\n  replaceMenuProvider: [ 'type', ReplaceMenuProvider ]\n};","import {\n  filter,\n  isNumber\n} from 'min-dash';\n\nvar max = Math.max,\n    min = Math.min;\n\nvar DEFAULT_CHILD_BOX_PADDING = 20;\n\nimport {\n  getBBox\n} from '../../util/Elements';\n\nimport {\n  asTRBL,\n  asBounds\n} from '../../layout/LayoutUtil';\n\n\n/**\n * Substract a TRBL from another\n *\n * @param  {TRBL} trblA\n * @param  {TRBL} trblB\n *\n * @return {TRBL}\n */\nexport function substractTRBL(trblA, trblB) {\n  return {\n    top: trblA.top - trblB.top,\n    right: trblA.right - trblB.right,\n    bottom: trblA.bottom - trblB.bottom,\n    left: trblA.left - trblB.left\n  };\n}\n\n/**\n * Resize the given bounds by the specified delta from a given anchor point.\n *\n * @param {Bounds} bounds the bounding box that should be resized\n * @param {String} direction in which the element is resized (nw, ne, se, sw)\n * @param {Point} delta of the resize operation\n *\n * @return {Bounds} resized bounding box\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var dx = delta.x,\n      dy = delta.y;\n\n  var newBounds = {\n    x: bounds.x,\n    y: bounds.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    newBounds.y = bounds.y + dy;\n    newBounds.height = bounds.height - dy;\n  } else if (direction.indexOf('s') !== -1) {\n    newBounds.height = bounds.height + dy;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    newBounds.width = bounds.width + dx;\n  } else if (direction.indexOf('w') !== -1) {\n    newBounds.x = bounds.x + dx;\n    newBounds.width = bounds.width - dx;\n  }\n\n  return newBounds;\n}\n\n\n/**\n * Resize the given bounds by applying the passed\n * { top, right, bottom, left } delta.\n *\n * @param {Bounds} bounds\n * @param {TRBL} trblResize\n *\n * @return {Bounds}\n */\nexport function resizeTRBL(bounds, resize) {\n  return {\n    x: bounds.x + (resize.left || 0),\n    y: bounds.y + (resize.top || 0),\n    width: bounds.width - (resize.left || 0) + (resize.right || 0),\n    height: bounds.height - (resize.top || 0) + (resize.bottom || 0)\n  };\n}\n\n\nexport function reattachPoint(bounds, newBounds, point) {\n\n  var sx = bounds.width / newBounds.width,\n      sy = bounds.height / newBounds.height;\n\n  return {\n    x: Math.round((newBounds.x + newBounds.width / 2)) - Math.floor(((bounds.x + bounds.width / 2) - point.x) / sx),\n    y: Math.round((newBounds.y + newBounds.height / 2)) - Math.floor(((bounds.y + bounds.height / 2) - point.y) / sy)\n  };\n}\n\n\nfunction applyConstraints(attr, trbl, resizeConstraints) {\n\n  var value = trbl[attr],\n      minValue = resizeConstraints.min && resizeConstraints.min[attr],\n      maxValue = resizeConstraints.max && resizeConstraints.max[attr];\n\n  if (isNumber(minValue)) {\n    value = (/top|left/.test(attr) ? min : max)(value, minValue);\n  }\n\n  if (isNumber(maxValue)) {\n    value = (/top|left/.test(attr) ? max : min)(value, maxValue);\n  }\n\n  return value;\n}\n\nexport function ensureConstraints(currentBounds, resizeConstraints) {\n\n  if (!resizeConstraints) {\n    return currentBounds;\n  }\n\n  var currentTrbl = asTRBL(currentBounds);\n\n  return asBounds({\n    top: applyConstraints('top', currentTrbl, resizeConstraints),\n    right: applyConstraints('right', currentTrbl, resizeConstraints),\n    bottom: applyConstraints('bottom', currentTrbl, resizeConstraints),\n    left: applyConstraints('left', currentTrbl, resizeConstraints)\n  });\n}\n\n\nexport function getMinResizeBounds(direction, currentBounds, minDimensions, childrenBounds) {\n\n  var currentBox = asTRBL(currentBounds);\n\n  var minBox = {\n    top: /n/.test(direction) ? currentBox.bottom - minDimensions.height : currentBox.top,\n    left: /w/.test(direction) ? currentBox.right - minDimensions.width : currentBox.left,\n    bottom: /s/.test(direction) ? currentBox.top + minDimensions.height : currentBox.bottom,\n    right: /e/.test(direction) ? currentBox.left + minDimensions.width : currentBox.right\n  };\n\n  var childrenBox = childrenBounds ? asTRBL(childrenBounds) : minBox;\n\n  var combinedBox = {\n    top: min(minBox.top, childrenBox.top),\n    left: min(minBox.left, childrenBox.left),\n    bottom: max(minBox.bottom, childrenBox.bottom),\n    right: max(minBox.right, childrenBox.right)\n  };\n\n  return asBounds(combinedBox);\n}\n\nfunction asPadding(mayBePadding, defaultValue) {\n  if (typeof mayBePadding !== 'undefined') {\n    return mayBePadding;\n  } else {\n    return DEFAULT_CHILD_BOX_PADDING;\n  }\n}\n\nexport function addPadding(bbox, padding) {\n  var left, right, top, bottom;\n\n  if (typeof padding === 'object') {\n    left = asPadding(padding.left);\n    right = asPadding(padding.right);\n    top = asPadding(padding.top);\n    bottom = asPadding(padding.bottom);\n  } else {\n    left = right = top = bottom = asPadding(padding);\n  }\n\n  return {\n    x: bbox.x - left,\n    y: bbox.y - top,\n    width: bbox.width + left + right,\n    height: bbox.height + top + bottom\n  };\n}\n\n\n/**\n * Is the given element part of the resize\n * targets min boundary box?\n *\n * This is the default implementation which excludes\n * connections and labels.\n *\n * @param {djs.model.Base} element\n */\nfunction isBBoxChild(element) {\n\n  // exclude connections\n  if (element.waypoints) {\n    return false;\n  }\n\n  // exclude labels\n  if (element.type === 'label') {\n    return false;\n  }\n\n  return true;\n}\n\n/**\n * Return children bounding computed from a shapes children\n * or a list of prefiltered children.\n *\n * @param  {djs.model.Shape|Array<djs.model.Shape>} shapeOrChildren\n * @param  {Number|Object} padding\n *\n * @return {Bounds}\n */\nexport function computeChildrenBBox(shapeOrChildren, padding) {\n\n  var elements;\n\n  // compute based on shape\n  if (shapeOrChildren.length === undefined) {\n\n    // grab all the children that are part of the\n    // parents children box\n    elements = filter(shapeOrChildren.children, isBBoxChild);\n\n  } else {\n    elements = shapeOrChildren;\n  }\n\n  if (elements.length) {\n    return addPadding(getBBox(elements), padding);\n  }\n}\n","import { is } from '../../../util/ModelUtil';\n\nimport {\n  getParent\n} from './ModelingUtil';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substractTRBL,\n  resizeTRBL\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\nvar abs = Math.abs;\n\n\nfunction getTRBLResize(oldBounds, newBounds) {\n  return substractTRBL(asTRBL(newBounds), asTRBL(oldBounds));\n}\n\n\nvar LANE_PARENTS = [\n  'bpmn:Participant',\n  'bpmn:Process',\n  'bpmn:SubProcess'\n];\n\nexport var LANE_INDENTATION = 30;\n\n\n/**\n * Collect all lane shapes in the given paren\n *\n * @param  {djs.model.Shape} shape\n * @param  {Array<djs.model.Base>} [collectedShapes]\n *\n * @return {Array<djs.model.Base>}\n */\nexport function collectLanes(shape, collectedShapes) {\n\n  collectedShapes = collectedShapes || [];\n\n  shape.children.filter(function(s) {\n    if (is(s, 'bpmn:Lane')) {\n      collectLanes(s, collectedShapes);\n\n      collectedShapes.push(s);\n    }\n  });\n\n  return collectedShapes;\n}\n\n\n/**\n * Return the lane children of the given element.\n *\n * @param {djs.model.Shape} shape\n *\n * @return {Array<djs.model.Shape>}\n */\nexport function getChildLanes(shape) {\n  return shape.children.filter(function(c) {\n    return is(c, 'bpmn:Lane');\n  });\n}\n\n\n/**\n * Return the root element containing the given lane shape\n *\n * @param {djs.model.Shape} shape\n *\n * @return {djs.model.Shape}\n */\nexport function getLanesRoot(shape) {\n  return getParent(shape, LANE_PARENTS) || shape;\n}\n\n\n/**\n * Compute the required resize operations for lanes\n * adjacent to the given shape, assuming it will be\n * resized to the given new bounds.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n *\n * @return {Array<Object>}\n */\nexport function computeLanesResize(shape, newBounds) {\n\n  var rootElement = getLanesRoot(shape);\n\n  var initialShapes = is(rootElement, 'bpmn:Process') ? [] : [ rootElement ];\n\n  var allLanes = collectLanes(rootElement, initialShapes),\n      shapeTrbl = asTRBL(shape),\n      shapeNewTrbl = asTRBL(newBounds),\n      trblResize = getTRBLResize(shape, newBounds),\n      resizeNeeded = [];\n\n  allLanes.forEach(function(other) {\n\n    if (other === shape) {\n      return;\n    }\n\n    var topResize = 0,\n        rightResize = trblResize.right,\n        bottomResize = 0,\n        leftResize = trblResize.left;\n\n    var otherTrbl = asTRBL(other);\n\n    if (trblResize.top) {\n      if (abs(otherTrbl.bottom - shapeTrbl.top) < 10) {\n        bottomResize = shapeNewTrbl.top - otherTrbl.bottom;\n      }\n\n      if (abs(otherTrbl.top - shapeTrbl.top) < 5) {\n        topResize = shapeNewTrbl.top - otherTrbl.top;\n      }\n    }\n\n    if (trblResize.bottom) {\n      if (abs(otherTrbl.top - shapeTrbl.bottom) < 10) {\n        topResize = shapeNewTrbl.bottom - otherTrbl.top;\n      }\n\n      if (abs(otherTrbl.bottom - shapeTrbl.bottom) < 5) {\n        bottomResize = shapeNewTrbl.bottom - otherTrbl.bottom;\n      }\n    }\n\n    if (topResize || rightResize || bottomResize || leftResize) {\n\n      resizeNeeded.push({\n        shape: other,\n        newBounds: resizeTRBL(other, {\n          top: topResize,\n          right: rightResize,\n          bottom: bottomResize,\n          left: leftResize\n        })\n      });\n    }\n\n  });\n\n  return resizeNeeded;\n}","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess\n} from '../../util/DiUtil';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  getChildLanes\n} from '../modeling/util/LaneUtil';\n\nimport {\n  hasPrimaryModifier\n} from 'diagram-js/lib/util/Mouse';\n\n\n/**\n * A provider for BPMN 2.0 elements context pad\n */\nexport default function ContextPadProvider(\n    config, injector, eventBus,\n    contextPad, modeling, elementFactory,\n    connect, create, popupMenu,\n    canvas, rules, translate) {\n\n  config = config || {};\n\n  contextPad.registerProvider(this);\n\n  this._contextPad = contextPad;\n\n  this._modeling = modeling;\n\n  this._elementFactory = elementFactory;\n  this._connect = connect;\n  this._create = create;\n  this._popupMenu = popupMenu;\n  this._canvas = canvas;\n  this._rules = rules;\n  this._translate = translate;\n\n  if (config.autoPlace !== false) {\n    this._autoPlace = injector.get('autoPlace', false);\n  }\n\n  eventBus.on('create.end', 250, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (!hasPrimaryModifier(event) || !contextPad.isOpen(shape)) {\n      return;\n    }\n\n    var entries = contextPad.getEntries(shape);\n\n    if (entries.replace) {\n      entries.replace.action.click(event, shape);\n    }\n  });\n}\n\nContextPadProvider.$inject = [\n  'config.contextPad',\n  'injector',\n  'eventBus',\n  'contextPad',\n  'modeling',\n  'elementFactory',\n  'connect',\n  'create',\n  'popupMenu',\n  'canvas',\n  'rules',\n  'translate'\n];\n\n\nContextPadProvider.prototype.getContextPadEntries = function(element) {\n\n  var contextPad = this._contextPad,\n      modeling = this._modeling,\n\n      elementFactory = this._elementFactory,\n      connect = this._connect,\n      create = this._create,\n      popupMenu = this._popupMenu,\n      canvas = this._canvas,\n      rules = this._rules,\n      autoPlace = this._autoPlace,\n      translate = this._translate;\n\n  var actions = {};\n\n  if (element.type === 'label') {\n    return actions;\n  }\n\n  var businessObject = element.businessObject;\n\n  function startConnect(event, element) {\n    connect.start(event, element);\n  }\n\n  function removeElement(e) {\n    modeling.removeElements([ element ]);\n  }\n\n  function getReplaceMenuPosition(element) {\n\n    var Y_OFFSET = 5;\n\n    var diagramContainer = canvas.getContainer(),\n        pad = contextPad.getPad(element).html;\n\n    var diagramRect = diagramContainer.getBoundingClientRect(),\n        padRect = pad.getBoundingClientRect();\n\n    var top = padRect.top - diagramRect.top;\n    var left = padRect.left - diagramRect.left;\n\n    var pos = {\n      x: left,\n      y: top + padRect.height + Y_OFFSET\n    };\n\n    return pos;\n  }\n\n\n  /**\n   * Create an append action\n   *\n   * @param {String} type\n   * @param {String} className\n   * @param {String} [title]\n   * @param {Object} [options]\n   *\n   * @return {Object} descriptor\n   */\n  function appendAction(type, className, title, options) {\n\n    if (typeof title !== 'string') {\n      options = title;\n      title = translate('Append {type}', { type: type.replace(/^bpmn:/, '') });\n    }\n\n    function appendStart(event, element) {\n\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n      create.start(event, shape, {\n        source: element\n      });\n    }\n\n\n    var append = autoPlace ? function(event, element) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n\n      autoPlace.append(element, shape);\n    } : appendStart;\n\n\n    return {\n      group: 'model',\n      className: className,\n      title: title,\n      action: {\n        dragstart: appendStart,\n        click: append\n      }\n    };\n  }\n\n  function splitLaneHandler(count) {\n\n    return function(event, element) {\n\n      // actual split\n      modeling.splitLane(element, count);\n\n      // refresh context pad after split to\n      // get rid of split icons\n      contextPad.open(element, true);\n    };\n  }\n\n\n  if (isAny(businessObject, [ 'bpmn:Lane', 'bpmn:Participant' ]) && isExpanded(businessObject)) {\n\n    var childLanes = getChildLanes(element);\n\n    assign(actions, {\n      'lane-insert-above': {\n        group: 'lane-insert-above',\n        className: 'bpmn-icon-lane-insert-above',\n        title: translate('Add Lane above'),\n        action: {\n          click: function(event, element) {\n            modeling.addLane(element, 'top');\n          }\n        }\n      }\n    });\n\n    if (childLanes.length < 2) {\n\n      if (element.height >= 120) {\n        assign(actions, {\n          'lane-divide-two': {\n            group: 'lane-divide',\n            className: 'bpmn-icon-lane-divide-two',\n            title: translate('Divide into two Lanes'),\n            action: {\n              click: splitLaneHandler(2)\n            }\n          }\n        });\n      }\n\n      if (element.height >= 180) {\n        assign(actions, {\n          'lane-divide-three': {\n            group: 'lane-divide',\n            className: 'bpmn-icon-lane-divide-three',\n            title: translate('Divide into three Lanes'),\n            action: {\n              click: splitLaneHandler(3)\n            }\n          }\n        });\n      }\n    }\n\n    assign(actions, {\n      'lane-insert-below': {\n        group: 'lane-insert-below',\n        className: 'bpmn-icon-lane-insert-below',\n        title: translate('Add Lane below'),\n        action: {\n          click: function(event, element) {\n            modeling.addLane(element, 'bottom');\n          }\n        }\n      }\n    });\n\n  }\n\n  if (is(businessObject, 'bpmn:FlowNode')) {\n\n    if (is(businessObject, 'bpmn:EventBasedGateway')) {\n\n      assign(actions, {\n        'append.receive-task': appendAction(\n          'bpmn:ReceiveTask',\n          'bpmn-icon-receive-task',\n          translate('Append ReceiveTask')\n        ),\n        'append.message-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-message',\n          translate('Append MessageIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:MessageEventDefinition' }\n        ),\n        'append.timer-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-timer',\n          translate('Append TimerIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:TimerEventDefinition' }\n        ),\n        'append.condition-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-condition',\n          translate('Append ConditionIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:ConditionalEventDefinition' }\n        ),\n        'append.signal-intermediate-event': appendAction(\n          'bpmn:IntermediateCatchEvent',\n          'bpmn-icon-intermediate-event-catch-signal',\n          translate('Append SignalIntermediateCatchEvent'),\n          { eventDefinitionType: 'bpmn:SignalEventDefinition' }\n        )\n      });\n    } else\n\n    if (isEventType(businessObject, 'bpmn:BoundaryEvent', 'bpmn:CompensateEventDefinition')) {\n\n      assign(actions, {\n        'append.compensation-activity':\n            appendAction(\n              'bpmn:Task',\n              'bpmn-icon-task',\n              translate('Append compensation activity'),\n              {\n                isForCompensation: true\n              }\n            )\n      });\n    } else\n\n    if (!is(businessObject, 'bpmn:EndEvent') &&\n        !businessObject.isForCompensation &&\n        !isEventType(businessObject, 'bpmn:IntermediateThrowEvent', 'bpmn:LinkEventDefinition') &&\n        !isEventSubProcess(businessObject)) {\n\n      assign(actions, {\n        'append.end-event': appendAction(\n          'bpmn:EndEvent',\n          'bpmn-icon-end-event-none',\n          translate('Append EndEvent')\n        ),\n        'append.gateway': appendAction(\n          'bpmn:ExclusiveGateway',\n          'bpmn-icon-gateway-none',\n          translate('Append Gateway')\n        ),\n        'append.append-task': appendAction(\n          'bpmn:Task',\n          'bpmn-icon-task',\n          translate('Append Task')\n        ),\n        'append.intermediate-event': appendAction(\n          'bpmn:IntermediateThrowEvent',\n          'bpmn-icon-intermediate-event-none',\n          translate('Append Intermediate/Boundary Event')\n        )\n      });\n    }\n  }\n\n  if (!popupMenu.isEmpty(element, 'bpmn-replace')) {\n\n    // Replace menu entry\n    assign(actions, {\n      'replace': {\n        group: 'edit',\n        className: 'bpmn-icon-screw-wrench',\n        title: translate('Change type'),\n        action: {\n          click: function(event, element) {\n\n            var position = assign(getReplaceMenuPosition(element), {\n              cursor: { x: event.x, y: event.y }\n            });\n\n            popupMenu.open(element, 'bpmn-replace', position);\n          }\n        }\n      }\n    });\n  }\n\n  if (isAny(businessObject, [\n    'bpmn:FlowNode',\n    'bpmn:InteractionNode',\n    'bpmn:DataObjectReference',\n    'bpmn:DataStoreReference'\n  ])) {\n\n    assign(actions, {\n      'append.text-annotation': appendAction('bpmn:TextAnnotation', 'bpmn-icon-text-annotation'),\n\n      'connect': {\n        group: 'connect',\n        className: 'bpmn-icon-connection-multi',\n        title: translate('Connect using ' +\n                  (businessObject.isForCompensation ? '' : 'Sequence/MessageFlow or ') +\n                  'Association'),\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n  if (isAny(businessObject, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ])) {\n    assign(actions, {\n      'connect': {\n        group: 'connect',\n        className: 'bpmn-icon-connection-multi',\n        title: translate('Connect using DataInputAssociation'),\n        action: {\n          click: startConnect,\n          dragstart: startConnect\n        }\n      }\n    });\n  }\n\n  // delete element entry, only show if allowed by rules\n  var deleteAllowed = rules.allowed('elements.delete', { elements: [ element ] });\n\n  if (isArray(deleteAllowed)) {\n\n    // was the element returned as a deletion candidate?\n    deleteAllowed = deleteAllowed[0] === element;\n  }\n\n  if (deleteAllowed) {\n    assign(actions, {\n      'delete': {\n        group: 'edit',\n        className: 'bpmn-icon-trash',\n        title: translate('Remove'),\n        action: {\n          click: removeElement\n        }\n      }\n    });\n  }\n\n  return actions;\n};\n\n\n// helpers /////////\n\nfunction isEventType(eventBo, type, definition) {\n\n  var isType = eventBo.$instanceOf(type);\n  var isDefinition = false;\n\n  var definitions = eventBo.eventDefinitions || [];\n  forEach(definitions, function(def) {\n    if (def.$type === definition) {\n      isDefinition = true;\n    }\n  });\n\n  return isType && isDefinition;\n}\n","import DirectEditingModule from 'diagram-js-direct-editing';\nimport ContextPadModule from 'diagram-js/lib/features/context-pad';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ConnectModule from 'diagram-js/lib/features/connect';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport PopupMenuModule from '../popup-menu';\n\nimport ContextPadProvider from './ContextPadProvider';\n\nexport default {\n  __depends__: [\n    DirectEditingModule,\n    ContextPadModule,\n    SelectionModule,\n    ConnectModule,\n    CreateModule,\n    PopupMenuModule\n  ],\n  __init__: [ 'contextPadProvider' ],\n  contextPadProvider: [ 'type', ContextPadProvider ]\n};","import {\n  sortBy,\n  forEach,\n  filter\n} from 'min-dash';\n\nvar AXIS_DIMENSIONS = {\n  horizontal: [ 'x', 'width' ],\n  vertical: [ 'y', 'height' ]\n};\n\nvar THRESHOLD = 5;\n\n\n/**\n * Groups and filters elements and then trigger even distribution.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n\n  this._filters = [];\n\n  // register filter for filtering big elements\n  this.registerFilter(function(elements, axis, dimension) {\n    var elementsSize = 0,\n        numOfShapes = 0,\n        avgDimension;\n\n    forEach(elements, function(element) {\n      if (element.waypoints || element.labelTarget) {\n        return;\n      }\n\n      elementsSize += element[dimension];\n\n      numOfShapes += 1;\n    });\n\n    avgDimension = Math.round(elementsSize / numOfShapes);\n\n    return filter(elements, function(element) {\n      return element[dimension] < (avgDimension + 50);\n    });\n  });\n\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\n\n/**\n * Registers filter functions that allow external parties to filter\n * out certain elements.\n *\n * @param  {Function} filterFn\n */\nDistributeElements.prototype.registerFilter = function(filterFn) {\n  if (typeof filterFn !== 'function') {\n    throw new Error('the filter has to be a function');\n  }\n\n  this._filters.push(filterFn);\n};\n\n/**\n * Distributes the elements with a given orientation\n *\n * @param  {Array} elements    [description]\n * @param  {String} orientation [description]\n */\nDistributeElements.prototype.trigger = function(elements, orientation) {\n  var modeling = this._modeling;\n\n  var groups,\n      distributableElements;\n\n  if (elements.length < 3) {\n    return;\n  }\n\n  this._setOrientation(orientation);\n\n  distributableElements = this._filterElements(elements);\n\n  groups = this._createGroups(distributableElements);\n\n  // nothing to distribute\n  if (groups.length <= 2) {\n    return;\n  }\n\n  modeling.distributeElements(groups, this._axis, this._dimension);\n\n  return groups;\n};\n\n/**\n * Filters the elements with provided filters by external parties\n *\n * @param  {Array[Elements]} elements\n *\n * @return {Array[Elements]}\n */\nDistributeElements.prototype._filterElements = function(elements) {\n  var filters = this._filters,\n      axis = this._axis,\n      dimension = this._dimension,\n      distributableElements = [].concat(elements);\n\n  if (!filters.length) {\n    return elements;\n  }\n\n  forEach(filters, function(filterFn) {\n    distributableElements = filterFn(distributableElements, axis, dimension);\n  });\n\n  return distributableElements;\n};\n\n\n/**\n * Create range (min, max) groups. Also tries to group elements\n * together that share the same range.\n *\n * @example\n * \tvar distributableElements = [\n * \t\t{\n * \t\t\trange: {\n * \t\t\t\tmin: 100,\n * \t\t\t\tmax: 200\n * \t\t\t},\n * \t\t\telements: [ { id: 'shape1', .. }]\n * \t\t}\n * \t]\n *\n * @param  {Array} elements\n *\n * @return {Array[Objects]}\n */\nDistributeElements.prototype._createGroups = function(elements) {\n  var rangeGroups = [],\n      self = this,\n      axis = this._axis,\n      dimension = this._dimension;\n\n  if (!axis) {\n    throw new Error('must have a defined \"axis\" and \"dimension\"');\n  }\n\n  // sort by 'left->right' or 'top->bottom'\n  var sortedElements = sortBy(elements, axis);\n\n  forEach(sortedElements, function(element, idx) {\n    var elementRange = self._findRange(element, axis, dimension),\n        range;\n\n    var previous = rangeGroups[rangeGroups.length - 1];\n\n    if (previous && self._hasIntersection(previous.range, elementRange)) {\n      rangeGroups[rangeGroups.length - 1].elements.push(element);\n    } else {\n      range = { range: elementRange, elements: [ element ] };\n\n      rangeGroups.push(range);\n    }\n  });\n\n  return rangeGroups;\n};\n\n\n/**\n * Maps a direction to the according axis and dimension\n *\n * @param  {String} direction 'horizontal' or 'vertical'\n */\nDistributeElements.prototype._setOrientation = function(direction) {\n  var orientation = AXIS_DIMENSIONS[direction];\n\n  this._axis = orientation[0];\n  this._dimension = orientation[1];\n};\n\n\n/**\n * Checks if the two ranges intercept each other\n *\n * @param  {Object} rangeA {min, max}\n * @param  {Object} rangeB {min, max}\n *\n * @return {Boolean}\n */\nDistributeElements.prototype._hasIntersection = function(rangeA, rangeB) {\n  return Math.max(rangeA.min, rangeA.max) >= Math.min(rangeB.min, rangeB.max) &&\n         Math.min(rangeA.min, rangeA.max) <= Math.max(rangeB.min, rangeB.max);\n};\n\n\n/**\n * Returns the min and max values for an element\n *\n * @param  {[type]} element   [description]\n * @param  {[type]} axis      [description]\n * @param  {[type]} dimension [description]\n *\n * @return {[type]}           [description]\n */\nDistributeElements.prototype._findRange = function(element) {\n  var axis = element[this._axis],\n      dimension = element[this._dimension];\n\n  return {\n    min: axis + THRESHOLD,\n    max: axis + dimension - THRESHOLD\n  };\n};\n","import DistributeElements from './DistributeElements';\n\nexport default {\n  __init__: [ 'distributeElements' ],\n  distributeElements: [ 'type', DistributeElements ]\n};\n","import {\n  filter\n} from 'min-dash';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\n\n/**\n * Registers element exclude filters for elements that\n * currently do not support distribution.\n */\nexport default function BpmnDistributeElements(distributeElements) {\n\n  distributeElements.registerFilter(function(elements) {\n    return filter(elements, function(element) {\n      var cannotDistribute = isAny(element, [\n        'bpmn:Association',\n        'bpmn:BoundaryEvent',\n        'bpmn:DataInputAssociation',\n        'bpmn:DataOutputAssociation',\n        'bpmn:Lane',\n        'bpmn:MessageFlow',\n        'bpmn:Participant',\n        'bpmn:SequenceFlow',\n        'bpmn:TextAnnotation'\n      ]);\n\n      return !(element.labelTarget || cannotDistribute);\n    });\n  });\n}\n\nBpmnDistributeElements.$inject = [ 'distributeElements' ];","import DistributeElementsModule from 'diagram-js/lib/features/distribute-elements';\n\nimport BpmnDistributeElements from './BpmnDistributeElements';\n\n\nexport default {\n  __depends__: [\n    DistributeElementsModule\n  ],\n  __init__: [ 'bpmnDistributeElements' ],\n  bpmnDistributeElements: [ 'type', BpmnDistributeElements ]\n};\n","import {\n  forEach,\n  isArray\n} from 'min-dash';\n\nvar NOT_REGISTERED_ERROR = 'is not a registered action',\n    IS_REGISTERED_ERROR = 'is already registered';\n\n\n/**\n * An interface that provides access to modeling actions by decoupling\n * the one who requests the action to be triggered and the trigger itself.\n *\n * It's possible to add new actions by registering them with ´registerAction´\n * and likewise unregister existing ones with ´unregisterAction´.\n *\n *\n * ## Life-Cycle and configuration\n *\n * The editor actions will wait for diagram initialization before\n * registering default actions _and_ firing an `editorActions.init` event.\n *\n * Interested parties may listen to the `editorActions.init` event with\n * low priority to check, which actions got registered. Other components\n * may use the event to register their own actions via `registerAction`.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function EditorActions(eventBus, injector) {\n\n  // initialize actions\n  this._actions = {};\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // all diagram modules got loaded; check which ones\n    // are available and register the respective default actions\n    self._registerDefaultActions(injector);\n\n    // ask interested parties to register available editor\n    // actions on diagram initialization\n    eventBus.fire('editorActions.init', {\n      editorActions: self\n    });\n  });\n\n}\n\nEditorActions.$inject = [\n  'eventBus',\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (1) retrieve optional components to integrate with\n\n  var commandStack = injector.get('commandStack', false);\n  var modeling = injector.get('modeling', false);\n  var selection = injector.get('selection', false);\n  var zoomScroll = injector.get('zoomScroll', false);\n  var copyPaste = injector.get('copyPaste', false);\n  var canvas = injector.get('canvas', false);\n  var rules = injector.get('rules', false);\n  var keyboardMove = injector.get('keyboardMove', false);\n  var keyboardMoveSelection = injector.get('keyboardMoveSelection', false);\n\n  // (2) check components and register actions\n\n  if (commandStack) {\n    this.register('undo', function() {\n      commandStack.undo();\n    });\n\n    this.register('redo', function() {\n      commandStack.redo();\n    });\n  }\n\n  if (copyPaste && selection) {\n    this.register('copy', function() {\n      var selectedElements = selection.get();\n\n      copyPaste.copy(selectedElements);\n    });\n  }\n\n  if (copyPaste) {\n    this.register('paste', function() {\n      copyPaste.paste();\n    });\n  }\n\n  if (zoomScroll) {\n    this.register('stepZoom', function(opts) {\n      zoomScroll.stepZoom(opts.value);\n    });\n  }\n\n  if (canvas) {\n    this.register('zoom', function(opts) {\n      canvas.zoom(opts.value);\n    });\n  }\n\n  if (modeling && selection && rules) {\n    this.register('removeSelection', function() {\n\n      var selectedElements = selection.get();\n\n      if (!selectedElements.length) {\n        return;\n      }\n\n      var allowed = rules.allowed('elements.delete', { elements: selectedElements }),\n          removableElements;\n\n      if (allowed === false) {\n        return;\n      }\n      else if (isArray(allowed)) {\n        removableElements = allowed;\n      }\n      else {\n        removableElements = selectedElements;\n      }\n\n      if (removableElements.length) {\n        modeling.removeElements(removableElements.slice());\n      }\n    });\n  }\n\n  if (keyboardMove) {\n    this.register('moveCanvas', function(opts) {\n      keyboardMove.moveCanvas(opts);\n    });\n  }\n\n  if (keyboardMoveSelection) {\n    this.register('moveSelection', function(opts) {\n      keyboardMoveSelection.moveSelection(opts.direction, opts.accelerated);\n    });\n  }\n\n};\n\n\n/**\n * Triggers a registered action\n *\n * @param  {String} action\n * @param  {Object} opts\n *\n * @return {Unknown} Returns what the registered listener returns\n */\nEditorActions.prototype.trigger = function(action, opts) {\n  if (!this._actions[action]) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  return this._actions[action](opts);\n};\n\n\n/**\n * Registers a collections of actions.\n * The key of the object will be the name of the action.\n *\n * @example\n * ´´´\n * var actions = {\n *   spaceTool: function() {\n *     spaceTool.activateSelection();\n *   },\n *   lassoTool: function() {\n *     lassoTool.activateSelection();\n *   }\n * ];\n *\n * editorActions.register(actions);\n *\n * editorActions.isRegistered('spaceTool'); // true\n * ´´´\n *\n * @param  {Object} actions\n */\nEditorActions.prototype.register = function(actions, listener) {\n  var self = this;\n\n  if (typeof actions === 'string') {\n    return this._registerAction(actions, listener);\n  }\n\n  forEach(actions, function(listener, action) {\n    self._registerAction(action, listener);\n  });\n};\n\n/**\n * Registers a listener to an action key\n *\n * @param  {String} action\n * @param  {Function} listener\n */\nEditorActions.prototype._registerAction = function(action, listener) {\n  if (this.isRegistered(action)) {\n    throw error(action, IS_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = listener;\n};\n\n/**\n * Unregister an existing action\n *\n * @param {String} action\n */\nEditorActions.prototype.unregister = function(action) {\n  if (!this.isRegistered(action)) {\n    throw error(action, NOT_REGISTERED_ERROR);\n  }\n\n  this._actions[action] = undefined;\n};\n\n/**\n * Returns the number of actions that are currently registered\n *\n * @return {Number}\n */\nEditorActions.prototype.getActions = function() {\n  return Object.keys(this._actions);\n};\n\n/**\n * Checks wether the given action is registered\n *\n * @param {String} action\n *\n * @return {Boolean}\n */\nEditorActions.prototype.isRegistered = function(action) {\n  return !!this._actions[action];\n};\n\n\nfunction error(action, message) {\n  return new Error(action + ' ' + message);\n}\n","import EditorActions from './EditorActions';\n\nexport default {\n  __init__: [ 'editorActions' ],\n  editorActions: [ 'type', EditorActions ]\n};\n","import inherits from 'inherits';\n\nimport EditorActions from 'diagram-js/lib/features/editor-actions/EditorActions';\n\nimport { filter } from 'min-dash';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  getBBox\n} from 'diagram-js/lib/util/Elements';\n\n\n/**\n * Registers and executes BPMN specific editor actions.\n *\n * @param {Injector} injector\n */\nexport default function BpmnEditorActions(injector) {\n  injector.invoke(EditorActions, this);\n}\n\ninherits(BpmnEditorActions, EditorActions);\n\nBpmnEditorActions.$inject = [\n  'injector'\n];\n\n/**\n * Register default actions.\n *\n * @param {Injector} injector\n */\nBpmnEditorActions.prototype._registerDefaultActions = function(injector) {\n\n  // (0) invoke super method\n\n  EditorActions.prototype._registerDefaultActions.call(this, injector);\n\n  // (1) retrieve optional components to integrate with\n\n  var canvas = injector.get('canvas', false);\n  var elementRegistry = injector.get('elementRegistry', false);\n  var selection = injector.get('selection', false);\n  var spaceTool = injector.get('spaceTool', false);\n  var lassoTool = injector.get('lassoTool', false);\n  var handTool = injector.get('handTool', false);\n  var globalConnect = injector.get('globalConnect', false);\n  var distributeElements = injector.get('distributeElements', false);\n  var alignElements = injector.get('alignElements', false);\n  var directEditing = injector.get('directEditing', false);\n  var searchPad = injector.get('searchPad', false);\n  var modeling = injector.get('modeling', false);\n\n  // (2) check components and register actions\n\n  if (canvas && elementRegistry && selection) {\n    this._registerAction('selectElements', function() {\n\n      // select all elements except for the invisible\n      // root element\n      var rootElement = canvas.getRootElement();\n\n      var elements = elementRegistry.filter(function(element) {\n        return element !== rootElement;\n      });\n\n      selection.select(elements);\n\n      return elements;\n    });\n  }\n\n  if (spaceTool) {\n    this._registerAction('spaceTool', function() {\n      spaceTool.toggle();\n    });\n  }\n\n  if (lassoTool) {\n    this._registerAction('lassoTool', function() {\n      lassoTool.toggle();\n    });\n  }\n\n  if (handTool) {\n    this._registerAction('handTool', function() {\n      handTool.toggle();\n    });\n  }\n\n  if (globalConnect) {\n    this._registerAction('globalConnectTool', function() {\n      globalConnect.toggle();\n    });\n  }\n\n  if (selection && distributeElements) {\n    this._registerAction('distributeElements', function(opts) {\n      var currentSelection = selection.get(),\n          type = opts.type;\n\n      if (currentSelection.length) {\n        distributeElements.trigger(currentSelection, type);\n      }\n    });\n  }\n\n  if (selection && alignElements) {\n    this._registerAction('alignElements', function(opts) {\n      var currentSelection = selection.get(),\n          aligneableElements = [],\n          type = opts.type;\n\n      if (currentSelection.length) {\n        aligneableElements = filter(currentSelection, function(element) {\n          return !is(element, 'bpmn:Lane');\n        });\n\n        alignElements.trigger(aligneableElements, type);\n      }\n    });\n  }\n\n  if (selection && modeling) {\n    this._registerAction('setColor', function(opts) {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        modeling.setColor(currentSelection, opts);\n      }\n    });\n  }\n\n  if (selection && directEditing) {\n    this._registerAction('directEditing', function() {\n      var currentSelection = selection.get();\n\n      if (currentSelection.length) {\n        directEditing.activate(currentSelection[0]);\n      }\n    });\n  }\n\n  if (searchPad) {\n    this._registerAction('find', function() {\n      searchPad.toggle();\n    });\n  }\n\n  if (canvas && modeling) {\n    this._registerAction('moveToOrigin', function() {\n      var rootElement = canvas.getRootElement(),\n          boundingBox,\n          elements;\n\n      if (is(rootElement, 'bpmn:Collaboration')) {\n        elements = elementRegistry.filter(function(element) {\n          return is(element.parent, 'bpmn:Collaboration');\n        });\n      } else {\n        elements = elementRegistry.filter(function(element) {\n          return element !== rootElement && !is(element.parent, 'bpmn:SubProcess');\n        });\n      }\n\n      boundingBox = getBBox(elements);\n\n      modeling.moveElements(\n        elements,\n        { x: -boundingBox.x, y: -boundingBox.y },\n        rootElement\n      );\n    });\n  }\n\n};","import EditorActionsModule from 'diagram-js/lib/features/editor-actions';\n\nimport BpmnEditorActions from './BpmnEditorActions';\n\nexport default {\n  __depends__: [\n    EditorActionsModule\n  ],\n  editorActions: [ 'type', BpmnEditorActions ]\n};\n","import { isAny } from '../modeling/util/ModelingUtil';\r\n\r\nexport default function BpmnGridSnapping(eventBus) {\r\n  eventBus.on([\r\n    'create.init',\r\n    'shape.move.init'\r\n  ], function(event) {\r\n    var context = event.context,\r\n        shape = event.shape;\r\n\r\n    if (isAny(shape, [\r\n      'bpmn:Participant',\r\n      'bpmn:SubProcess',\r\n      'bpmn:TextAnnotation'\r\n    ])) {\r\n      if (!context.gridSnappingContext) {\r\n        context.gridSnappingContext = {};\r\n      }\r\n\r\n      context.gridSnappingContext.snapLocation = 'top-left';\r\n    }\r\n  });\r\n}\r\n\r\nBpmnGridSnapping.$inject = [ 'eventBus' ];","export var SPACING = 10;\n\nexport function quantize(value, quantum, fn) {\n  if (!fn) {\n    fn = 'round';\n  }\n\n  return Math[ fn ](value / quantum) * quantum;\n}","import {\r\n  setSnapped,\r\n  isSnapped\r\n} from '../snapping/SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  assign,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nimport {\r\n  SPACING,\r\n  quantize\r\n} from './GridUtil';\r\n\r\nvar LOWER_PRIORITY = 1200;\r\nvar LOW_PRIORITY = 800;\r\n\r\n/**\r\n * Basic grid snapping that covers connecting, creating, moving, resizing shapes, moving bendpoints\r\n * and connection segments.\r\n */\r\nexport default function GridSnapping(elementRegistry, eventBus, config) {\r\n\r\n  var active = !config || config.active !== false;\r\n\r\n  this._eventBus = eventBus;\r\n\r\n  var self = this;\r\n\r\n  eventBus.on('diagram.init', LOW_PRIORITY, function() {\r\n    self.setActive(active);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'bendpoint.move.move',\r\n    'bendpoint.move.end',\r\n    'connect.move',\r\n    'connect.end',\r\n    'connectionSegment.move.move',\r\n    'connectionSegment.move.end',\r\n    'resize.move',\r\n    'resize.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], LOWER_PRIORITY, function(event) {\r\n    var originalEvent = event.originalEvent;\r\n\r\n    if (!self.active || (originalEvent && isCmd(originalEvent))) {\r\n      return;\r\n    }\r\n\r\n    var context = event.context,\r\n        gridSnappingContext = context.gridSnappingContext;\r\n\r\n    if (!gridSnappingContext) {\r\n      gridSnappingContext = context.gridSnappingContext = {};\r\n    }\r\n\r\n    [ 'x', 'y' ].forEach(function(axis) {\r\n      var options = {};\r\n\r\n      // allow snapping with offset\r\n      var snapOffset = getSnapOffset(event, axis, elementRegistry);\r\n\r\n      if (snapOffset) {\r\n        options.offset = snapOffset;\r\n      }\r\n\r\n      // allow snapping with min and max\r\n      var snapConstraints = getSnapConstraints(event, axis);\r\n\r\n      if (snapConstraints) {\r\n        assign(options, snapConstraints);\r\n      }\r\n\r\n      if (!isSnapped(event, axis)) {\r\n        self.snapEvent(event, axis, options);\r\n      }\r\n    });\r\n  });\r\n}\r\n\r\n/**\r\n * Snap an events x or y with optional min, max and offset.\r\n *\r\n * @param {Object} event\r\n * @param {string} axis\r\n * @param {number} [options.min]\r\n * @param {number} [options.max]\r\n * @param {number} [options.offset]\r\n */\r\nGridSnapping.prototype.snapEvent = function(event, axis, options) {\r\n  var snappedValue = this.snapValue(event[ axis ], options);\r\n\r\n  setSnapped(event, axis, snappedValue);\r\n};\r\n\r\n/**\r\n * Expose grid spacing for third parties (i.e. extensions).\r\n *\r\n * @return {Number} spacing of grid dots\r\n */\r\nGridSnapping.prototype.getGridSpacing = function() {\r\n  return SPACING;\r\n};\r\n\r\n/**\r\n * Snap value with optional min, max and offset.\r\n *\r\n * @param {number} value\r\n * @param {Object} options\r\n * @param {number} [options.min]\r\n * @param {number} [options.max]\r\n * @param {number} [options.offset]\r\n */\r\nGridSnapping.prototype.snapValue = function(value, options) {\r\n  var offset = 0;\r\n\r\n  if (options && options.offset) {\r\n    offset = options.offset;\r\n  }\r\n\r\n  value += offset;\r\n\r\n  value = quantize(value, SPACING);\r\n\r\n  var min, max;\r\n\r\n  if (options && options.min) {\r\n    min = options.min;\r\n\r\n    if (isNumber(min)) {\r\n      min = quantize(min + offset, SPACING, 'ceil');\r\n\r\n      value = Math.max(value, min);\r\n    }\r\n  }\r\n\r\n  if (options && options.max) {\r\n    max = options.max;\r\n\r\n    if (isNumber(max)) {\r\n      max = quantize(max + offset, SPACING, 'floor');\r\n\r\n      value = Math.min(value, max);\r\n    }\r\n  }\r\n\r\n  value -= offset;\r\n\r\n  return value;\r\n};\r\n\r\nGridSnapping.prototype.isActive = function() {\r\n  return this.active;\r\n};\r\n\r\nGridSnapping.prototype.setActive = function(active) {\r\n  this.active = active;\r\n\r\n  this._eventBus.fire('gridSnapping.toggle', { active: active });\r\n};\r\n\r\nGridSnapping.prototype.toggleActive = function() {\r\n  this.setActive(!this.active);\r\n};\r\n\r\nGridSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'config.gridSnapping'\r\n];\r\n\r\n// helpers //////////\r\n\r\n/**\r\n * Get minimum and maximum snap constraints.\r\n * Constraints are cached.\r\n *\r\n * @param {Object} event\r\n * @param {Object} event.context\r\n * @param {string} axis\r\n *\r\n * @returns {boolean|Object}\r\n */\r\nfunction getSnapConstraints(event, axis) {\r\n  var context = event.context,\r\n      createConstraints = context.createConstraints,\r\n      resizeConstraints = context.resizeConstraints || {},\r\n      gridSnappingContext = context.gridSnappingContext,\r\n      snapConstraints = gridSnappingContext.snapConstraints;\r\n\r\n  // cache snap constraints\r\n  if (snapConstraints && snapConstraints[ axis ]) {\r\n    return snapConstraints[ axis ];\r\n  }\r\n\r\n  if (!snapConstraints) {\r\n    snapConstraints = gridSnappingContext.snapConstraints = {};\r\n  }\r\n\r\n  if (!snapConstraints[ axis ]) {\r\n    snapConstraints[ axis ] = {};\r\n  }\r\n\r\n  var direction = context.direction;\r\n\r\n  // create\r\n  if (createConstraints) {\r\n    if (isHorizontal(axis)) {\r\n      snapConstraints.x.min = createConstraints.left;\r\n      snapConstraints.x.max = createConstraints.right;\r\n    } else {\r\n      snapConstraints.y.min = createConstraints.top;\r\n      snapConstraints.y.max = createConstraints.bottom;\r\n    }\r\n  }\r\n\r\n  // resize\r\n  var minResizeConstraints = resizeConstraints.min,\r\n      maxResizeConstraints = resizeConstraints.max;\r\n\r\n  if (minResizeConstraints) {\r\n    if (isHorizontal(axis)) {\r\n\r\n      if (isWest(direction)) {\r\n        snapConstraints.x.max = minResizeConstraints.left;\r\n      } else {\r\n        snapConstraints.x.min = minResizeConstraints.right;\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isNorth(direction)) {\r\n        snapConstraints.y.max = minResizeConstraints.top;\r\n      } else {\r\n        snapConstraints.y.min = minResizeConstraints.bottom;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  if (maxResizeConstraints) {\r\n    if (isHorizontal(axis)) {\r\n\r\n      if (isWest(direction)) {\r\n        snapConstraints.x.min = maxResizeConstraints.left;\r\n      } else {\r\n        snapConstraints.x.max = maxResizeConstraints.right;\r\n      }\r\n\r\n    } else {\r\n\r\n      if (isNorth(direction)) {\r\n        snapConstraints.y.min = maxResizeConstraints.top;\r\n      } else {\r\n        snapConstraints.y.max = maxResizeConstraints.bottom;\r\n      }\r\n\r\n    }\r\n  }\r\n\r\n  return snapConstraints[ axis ];\r\n}\r\n\r\n/**\r\n * Get snap offset.\r\n * Offset is cached.\r\n *\r\n * @param {Object} event\r\n * @param {string} axis\r\n * @param {ElementRegistry} elementRegistry\r\n *\r\n * @returns {number}\r\n */\r\nfunction getSnapOffset(event, axis, elementRegistry) {\r\n  var context = event.context,\r\n      shape = event.shape,\r\n      gridSnappingContext = context.gridSnappingContext,\r\n      snapLocation = gridSnappingContext.snapLocation,\r\n      snapOffset = gridSnappingContext.snapOffset;\r\n\r\n  // cache snap offset\r\n  if (snapOffset && isNumber(snapOffset[ axis ])) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (!snapOffset) {\r\n    snapOffset = gridSnappingContext.snapOffset = {};\r\n  }\r\n\r\n  if (!isNumber(snapOffset[ axis ])) {\r\n    snapOffset[ axis ] = 0;\r\n  }\r\n\r\n  if (!shape) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (!elementRegistry.get(shape.id)) {\r\n\r\n    if (isHorizontal(axis)) {\r\n      snapOffset[ axis ] += shape[ axis ] + shape.width / 2;\r\n    } else {\r\n      snapOffset[ axis ] += shape[ axis ] + shape.height / 2;\r\n    }\r\n  }\r\n\r\n  if (!snapLocation) {\r\n    return snapOffset[ axis ];\r\n  }\r\n\r\n  if (axis === 'x') {\r\n    if (/left/.test(snapLocation)) {\r\n      snapOffset[ axis ] -= shape.width / 2;\r\n    } else if (/right/.test(snapLocation)) {\r\n      snapOffset[ axis ] += shape.width / 2;\r\n    }\r\n  } else {\r\n    if (/top/.test(snapLocation)) {\r\n      snapOffset[ axis ] -= shape.height / 2;\r\n    } else if (/bottom/.test(snapLocation)) {\r\n      snapOffset[ axis ] += shape.height / 2;\r\n    }\r\n  }\r\n\r\n  return snapOffset[ axis ];\r\n}\r\n\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}\r\n\r\nfunction isNorth(direction) {\r\n  return direction.indexOf('n') !== -1;\r\n}\r\n\r\nfunction isWest(direction) {\r\n  return direction.indexOf('w') !== -1;\r\n}","import inherits from 'inherits';\r\n\r\nimport CommandInterceptor from '../../../command/CommandInterceptor';\r\n\r\nimport {\r\n  assign,\r\n  isString\r\n} from 'min-dash';\r\n\r\n\r\n/**\r\n * Integrates resizing with grid snapping.\r\n */\r\nexport default function ResizeBehavior(eventBus, gridSnapping) {\r\n  CommandInterceptor.call(this, eventBus);\r\n\r\n  this._gridSnapping = gridSnapping;\r\n\r\n  var self = this;\r\n\r\n  this.preExecute('shape.resize', function(event) {\r\n    var context = event.context,\r\n        hints = context.hints || {},\r\n        autoResize = hints.autoResize;\r\n\r\n    if (!autoResize) {\r\n      return;\r\n    }\r\n\r\n    var shape = context.shape,\r\n        newBounds = context.newBounds;\r\n\r\n    if (isString(autoResize)) {\r\n      context.newBounds = self.snapComplex(newBounds, autoResize);\r\n    } else {\r\n      context.newBounds = self.snapSimple(shape, newBounds);\r\n    }\r\n  });\r\n}\r\n\r\nResizeBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping',\r\n  'modeling'\r\n];\r\n\r\ninherits(ResizeBehavior, CommandInterceptor);\r\n\r\n/**\r\n * Snap width and height in relation to center.\r\n *\r\n * @param {djs.model.shape} shape\r\n * @param {Bounds} newBounds\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapSimple = function(shape, newBounds) {\r\n  var gridSnapping = this._gridSnapping;\r\n\r\n  newBounds.width = gridSnapping.snapValue(newBounds.width, {\r\n    min: newBounds.width\r\n  });\r\n\r\n  newBounds.height = gridSnapping.snapValue(newBounds.height, {\r\n    min: newBounds.height\r\n  });\r\n\r\n  newBounds.x = shape.x + (shape.width / 2) - (newBounds.width / 2);\r\n  newBounds.y = shape.y + (shape.height / 2) - (newBounds.height / 2);\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap x, y, width and height according to given directions.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapComplex = function(newBounds, directions) {\r\n  if (/w|e/.test(directions)) {\r\n    newBounds = this.snapHorizontally(newBounds, directions);\r\n  }\r\n\r\n  if (/n|s/.test(directions)) {\r\n    newBounds = this.snapVertically(newBounds, directions);\r\n  }\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap in one or both directions horizontally.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapHorizontally = function(newBounds, directions) {\r\n  var gridSnapping = this._gridSnapping,\r\n      west = /w/.test(directions),\r\n      east = /e/.test(directions);\r\n\r\n  var snappedNewBounds = {};\r\n\r\n  snappedNewBounds.width = gridSnapping.snapValue(newBounds.width, {\r\n    min: newBounds.width\r\n  });\r\n\r\n  if (east) {\r\n\r\n    // handle <we>\r\n    if (west) {\r\n      snappedNewBounds.x = gridSnapping.snapValue(newBounds.x, {\r\n        max: newBounds.x\r\n      });\r\n\r\n      snappedNewBounds.width += gridSnapping.snapValue(newBounds.x - snappedNewBounds.x, {\r\n        min: newBounds.x - snappedNewBounds.x\r\n      });\r\n    }\r\n\r\n    // handle <e>\r\n    else {\r\n      newBounds.x = newBounds.x + newBounds.width - snappedNewBounds.width;\r\n    }\r\n  }\r\n\r\n  // assign snapped x and width\r\n  assign(newBounds, snappedNewBounds);\r\n\r\n  return newBounds;\r\n};\r\n\r\n/**\r\n * Snap in one or both directions vertically.\r\n *\r\n * @param {Bounds} newBounds\r\n * @param {string} directions - Directions as {n|w|s|e}.\r\n *\r\n * @returns {Bounds} Snapped bounds.\r\n */\r\nResizeBehavior.prototype.snapVertically = function(newBounds, directions) {\r\n  var gridSnapping = this._gridSnapping,\r\n      north = /n/.test(directions),\r\n      south = /s/.test(directions);\r\n\r\n  var snappedNewBounds = {};\r\n\r\n  snappedNewBounds.height = gridSnapping.snapValue(newBounds.height, {\r\n    min: newBounds.height\r\n  });\r\n\r\n  if (north) {\r\n\r\n    // handle <ns>\r\n    if (south) {\r\n      snappedNewBounds.y = gridSnapping.snapValue(newBounds.y, {\r\n        max: newBounds.y\r\n      });\r\n\r\n      snappedNewBounds.height += gridSnapping.snapValue(newBounds.y - snappedNewBounds.y, {\r\n        min: newBounds.y - snappedNewBounds.y\r\n      });\r\n    }\r\n\r\n    // handle <n>\r\n    else {\r\n      newBounds.y = newBounds.y + newBounds.height - snappedNewBounds.height;\r\n    }\r\n  }\r\n\r\n  // assign snapped y and height\r\n  assign(newBounds, snappedNewBounds);\r\n\r\n  return newBounds;\r\n};","var HIGH_PRIORITY = 2000;\r\n\r\n/**\r\n * Integrates space tool with grid snapping.\r\n */\r\nexport default function SpaceToolBehavior(eventBus, gridSnapping) {\r\n  eventBus.on([\r\n    'spaceTool.move',\r\n    'spaceTool.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context;\r\n\r\n    if (!context.initialized) {\r\n      return;\r\n    }\r\n\r\n    var axis = context.axis;\r\n\r\n    var snapped;\r\n\r\n    if (axis === 'x') {\r\n\r\n      // snap delta x to multiple of 10\r\n      snapped = gridSnapping.snapValue(event.dx);\r\n\r\n      event.x = event.x + snapped - event.dx;\r\n      event.dx = snapped;\r\n    } else {\r\n\r\n      // snap delta y to multiple of 10\r\n      snapped = gridSnapping.snapValue(event.dy);\r\n\r\n      event.y = event.y + snapped - event.dy;\r\n      event.dy = snapped;\r\n    }\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping'\r\n];","import ResizeBehavior from './ResizeBehavior';\r\nimport SpaceToolBehavior from './SpaceToolBehavior';\r\n\r\nexport default {\r\n  __init__: [\r\n    'gridSnappingResizeBehavior',\r\n    'gridSnappingSpaceToolBehavior'\r\n  ],\r\n  gridSnappingResizeBehavior: [ 'type', ResizeBehavior ],\r\n  gridSnappingSpaceToolBehavior: [ 'type', SpaceToolBehavior ]\r\n};","import GridSnapping from './GridSnapping';\r\n\r\nimport GridSnappingBehaviorModule from './behavior';\r\n\r\nexport default {\r\n  __depends__: [ GridSnappingBehaviorModule ],\r\n  __init__: [ 'gridSnapping' ],\r\n  gridSnapping: [ 'type', GridSnapping ]\r\n};","import { getNewShapePosition } from '../../auto-place/AutoPlaceUtil';\r\n\r\nimport { getMid } from 'diagram-js/lib/layout/LayoutUtil';\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\n\r\nexport default function AutoPlaceBehavior(eventBus, gridSnapping) {\r\n  eventBus.on('autoPlace', function(context) {\r\n    var source = context.source,\r\n        sourceMid = getMid(source),\r\n        shape = context.shape;\r\n\r\n    var position = getNewShapePosition(source, shape);\r\n\r\n    [ 'x', 'y' ].forEach(function(axis) {\r\n      var options = {};\r\n\r\n      // do not snap if x/y equal\r\n      if (position[ axis ] === sourceMid[ axis ]) {\r\n        return;\r\n      }\r\n\r\n      if (position[ axis ] > sourceMid[ axis ]) {\r\n        options.min = position[ axis ];\r\n      } else {\r\n        options.max = position[ axis ];\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n\r\n        if (isHorizontal(axis)) {\r\n          options.offset = -shape.width / 2;\r\n        } else {\r\n          options.offset = -shape.height / 2;\r\n        }\r\n\r\n      }\r\n\r\n      position[ axis ] = gridSnapping.snapValue(position[ axis ], options);\r\n\r\n    });\r\n\r\n    // must be returned to be considered by auto place\r\n    return position;\r\n  });\r\n}\r\n\r\nAutoPlaceBehavior.$inject = [\r\n  'eventBus',\r\n  'gridSnapping'\r\n];\r\n\r\n// helpers //////////\r\n\r\nfunction isHorizontal(axis) {\r\n  return axis === 'x';\r\n}","import { is } from '../../../util/ModelUtil';\r\n\r\nvar HIGHER_PRIORITY = 1750;\r\n\r\n\r\nexport default function CreateParticipantBehavior(canvas, eventBus, gridSnapping) {\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        rootElement = canvas.getRootElement();\r\n\r\n    if (!is(shape, 'bpmn:Participant') ||\r\n      !is(rootElement, 'bpmn:Process') ||\r\n      !rootElement.children.length) {\r\n      return;\r\n    }\r\n\r\n    var createConstraints = context.createConstraints;\r\n\r\n    if (!createConstraints) {\r\n      return;\r\n    }\r\n\r\n    shape.width = gridSnapping.snapValue(shape.width, { min: shape.width });\r\n    shape.height = gridSnapping.snapValue(shape.height, { min: shape.height });\r\n  });\r\n}\r\n\r\nCreateParticipantBehavior.$inject = [\r\n  'canvas',\r\n  'eventBus',\r\n  'gridSnapping'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { pointsAligned } from 'diagram-js/lib/util/Geometry';\n\nimport {\n  assign\n} from 'min-dash';\n\nvar HIGH_PRIORITY = 3000;\n\n\n/**\n * Snaps connections with Manhattan layout.\n */\nexport default function LayoutConnectionBehavior(eventBus, gridSnapping, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  this._gridSnapping = gridSnapping;\n\n  var self = this;\n\n  this.postExecuted([\n    'connection.create',\n    'connection.layout'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        connection = context.connection,\n        hints = context.hints || {},\n        waypoints = connection.waypoints;\n\n    if (hints.connectionStart || hints.connectionEnd || hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (!hasMiddleSegments(waypoints)) {\n      return;\n    }\n\n    modeling.updateWaypoints(connection, self.snapMiddleSegments(waypoints));\n  });\n}\n\nLayoutConnectionBehavior.$inject = [\n  'eventBus',\n  'gridSnapping',\n  'modeling'\n];\n\ninherits(LayoutConnectionBehavior, CommandInterceptor);\n\n/**\n * Snap middle segments of a given connection.\n *\n * @param {Array<Point>} waypoints\n *\n * @returns {Array<Point>}\n */\nLayoutConnectionBehavior.prototype.snapMiddleSegments = function(waypoints) {\n  var gridSnapping = this._gridSnapping,\n      snapped;\n\n  waypoints = waypoints.slice();\n\n  for (var i = 1; i < waypoints.length - 2; i++) {\n\n    snapped = snapSegment(gridSnapping, waypoints[i], waypoints[i + 1]);\n\n    waypoints[i] = snapped[0];\n    waypoints[i + 1] = snapped[1];\n  }\n\n  return waypoints;\n};\n\n\n// helpers //////////\n\n/**\n * Check whether a connection has a middle segments.\n *\n * @param {Array} waypoints\n *\n * @returns {boolean}\n */\nfunction hasMiddleSegments(waypoints) {\n  return waypoints.length > 3;\n}\n\n/**\n * Check whether an alignment is horizontal.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction horizontallyAligned(aligned) {\n  return aligned === 'h';\n}\n\n/**\n * Check whether an alignment is vertical.\n *\n * @param {string} aligned\n *\n * @returns {boolean}\n */\nfunction verticallyAligned(aligned) {\n  return aligned === 'v';\n}\n\n/**\n * Get middle segments from a given connection.\n *\n * @param {Array} waypoints\n *\n * @returns {Array}\n */\nfunction snapSegment(gridSnapping, segmentStart, segmentEnd) {\n\n  var aligned = pointsAligned(segmentStart, segmentEnd);\n\n  var snapped = {};\n\n  if (horizontallyAligned(aligned)) {\n\n    // snap horizontally\n    snapped.y = gridSnapping.snapValue(segmentStart.y);\n  }\n\n  if (verticallyAligned(aligned)) {\n\n    // snap vertically\n    snapped.x = gridSnapping.snapValue(segmentStart.x);\n  }\n\n  if ('x' in snapped || 'y' in snapped) {\n    segmentStart = assign({}, segmentStart, snapped);\n    segmentEnd = assign({}, segmentEnd, snapped);\n  }\n\n  return [ segmentStart, segmentEnd ];\n}","import AutoPlaceBehavior from './AutoPlaceBehavior';\r\nimport CreateParticipantBehavior from './CreateParticipantBehavior';\r\nimport LayoutConnectionBehavior from './LayoutConnectionBehavior';\r\n\r\nexport default {\r\n  __init__: [\r\n    'gridSnappingAutoPlaceBehavior',\r\n    'gridSnappingCreateParticipantBehavior',\r\n    'gridSnappingLayoutConnectionBehavior',\r\n  ],\r\n  gridSnappingAutoPlaceBehavior: [ 'type', AutoPlaceBehavior ],\r\n  gridSnappingCreateParticipantBehavior: [ 'type', CreateParticipantBehavior ],\r\n  gridSnappingLayoutConnectionBehavior: [ 'type', LayoutConnectionBehavior ]\r\n};","import BpmnGridSnapping from './BpmnGridSnapping';\r\nimport GridSnappingModule from 'diagram-js/lib/features/grid-snapping';\r\n\r\nimport GridSnappingBehaviorModule from './behavior';\r\n\r\nexport default {\r\n  __depends__: [\r\n    GridSnappingModule,\r\n    GridSnappingBehaviorModule\r\n  ],\r\n  __init__: [ 'bpmnGridSnapping' ],\r\n  bpmnGridSnapping: [ 'type', BpmnGridSnapping ]\r\n};","import { is } from '../../util/ModelUtil';\n\nimport { isExpanded } from '../../util/DiUtil';\n\nvar LABEL_WIDTH = 30,\n    LABEL_HEIGHT = 30;\n\n\n/**\n * BPMN-specific hit zones and interaction fixes.\n *\n * @param {EventBus} eventBus\n * @param {InteractionEvents} interactionEvents\n */\nexport default function BpmnInteractionEvents(eventBus, interactionEvents) {\n\n  this._interactionEvents = interactionEvents;\n\n  var self = this;\n\n  eventBus.on([\n    'interactionEvents.createHit',\n    'interactionEvents.updateHit'\n  ], function(context) {\n    var element = context.element,\n        gfx = context.gfx;\n\n    if (is(element, 'bpmn:Lane')) {\n      return self.createParticipantHit(element, gfx);\n    } else\n\n    if (is(element, 'bpmn:Participant')) {\n      if (isExpanded(element)) {\n        return self.createParticipantHit(element, gfx);\n      } else {\n        return self.createDefaultHit(element, gfx);\n      }\n    } else\n\n    if (is(element, 'bpmn:SubProcess')) {\n      if (isExpanded(element)) {\n        return self.createSubProcessHit(element, gfx);\n      } else {\n        return self.createDefaultHit(element, gfx);\n      }\n    }\n  });\n\n}\n\nBpmnInteractionEvents.$inject = [\n  'eventBus',\n  'interactionEvents'\n];\n\n\nBpmnInteractionEvents.prototype.createDefaultHit = function(element, gfx) {\n  this._interactionEvents.removeHits(gfx);\n\n  this._interactionEvents.createDefaultHit(element, gfx);\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createParticipantHit = function(element, gfx) {\n\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, 'click-stroke', {\n    width: element.width,\n    height: element.height\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, 'all', {\n    width: LABEL_WIDTH,\n    height: element.height\n  });\n\n  // indicate that we created a hit\n  return true;\n};\n\nBpmnInteractionEvents.prototype.createSubProcessHit = function(element, gfx) {\n\n  // remove existing hits\n  this._interactionEvents.removeHits(gfx);\n\n  // add outline hit\n  this._interactionEvents.createBoxHit(gfx, 'click-stroke', {\n    width: element.width,\n    height: element.height\n  });\n\n  // add label hit\n  this._interactionEvents.createBoxHit(gfx, 'all', {\n    width: element.width,\n    height: LABEL_HEIGHT\n  });\n\n  // indicate that we created a hit\n  return true;\n};","import BpmnInteractionEvents from './BpmnInteractionEvents';\n\nexport default {\n  __init__: [ 'bpmnInteractionEvents' ],\n  bpmnInteractionEvents: [ 'type', BpmnInteractionEvents ]\n};","import inherits from 'inherits';\n\nimport KeyboardBindings from 'diagram-js/lib/features/keyboard/KeyboardBindings';\n\n\n/**\n * BPMN 2.0 specific keyboard bindings.\n *\n * @param {Injector} injector\n */\nexport default function BpmnKeyboardBindings(injector) {\n  injector.invoke(KeyboardBindings, this);\n}\n\ninherits(BpmnKeyboardBindings, KeyboardBindings);\n\nBpmnKeyboardBindings.$inject = [\n  'injector'\n];\n\n\n/**\n * Register available keyboard bindings.\n *\n * @param {Keyboard} keyboard\n * @param {EditorActions} editorActions\n */\nBpmnKeyboardBindings.prototype.registerBindings = function(keyboard, editorActions) {\n\n  // inherit default bindings\n  KeyboardBindings.prototype.registerBindings.call(this, keyboard, editorActions);\n\n  /**\n   * Add keyboard binding if respective editor action\n   * is registered.\n   *\n   * @param {String} action name\n   * @param {Function} fn that implements the key binding\n   */\n  function addListener(action, fn) {\n\n    if (editorActions.isRegistered(action)) {\n      keyboard.addListener(fn);\n    }\n  }\n\n  // select all elements\n  // CTRL + A\n  addListener('selectElements', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['a', 'A'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('selectElements');\n\n      return true;\n    }\n  });\n\n  // search labels\n  // CTRL + F\n  addListener('find', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.isKey(['f', 'F'], event) && keyboard.isCmd(event)) {\n      editorActions.trigger('find');\n\n      return true;\n    }\n  });\n\n  // activate space tool\n  // S\n  addListener('spaceTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['s', 'S'], event)) {\n      editorActions.trigger('spaceTool');\n\n      return true;\n    }\n  });\n\n  // activate lasso tool\n  // L\n  addListener('lassoTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['l', 'L'], event)) {\n      editorActions.trigger('lassoTool');\n\n      return true;\n    }\n  });\n\n  // activate hand tool\n  // H\n  addListener('handTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['h', 'H'], event)) {\n      editorActions.trigger('handTool');\n\n      return true;\n    }\n  });\n\n  // activate global connect tool\n  // C\n  addListener('globalConnectTool', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['c', 'C'], event)) {\n      editorActions.trigger('globalConnectTool');\n\n      return true;\n    }\n  });\n\n  // activate direct editing\n  // E\n  addListener('directEditing', function(context) {\n\n    var event = context.keyEvent;\n\n    if (keyboard.hasModifier(event)) {\n      return;\n    }\n\n    if (keyboard.isKey(['e', 'E'], event)) {\n      editorActions.trigger('directEditing');\n\n      return true;\n    }\n  });\n\n};","import KeyboardModule from 'diagram-js/lib/features/keyboard';\n\nimport BpmnKeyboardBindings from './BpmnKeyboardBindings';\n\nexport default {\n  __depends__: [\n    KeyboardModule\n  ],\n  __init__: [ 'keyboardBindings' ],\n  keyboardBindings: [ 'type', BpmnKeyboardBindings ]\n};\n","import {\n  assign\n} from 'min-dash';\n\n\nvar DEFAULT_CONFIG = {\n  moveSpeed: 1,\n  moveSpeedAccelerated: 10\n};\n\nvar HIGHER_PRIORITY = 1500;\n\nvar LEFT = 'left';\nvar UP = 'up';\nvar RIGHT = 'right';\nvar DOWN = 'down';\n\nvar KEY_TO_DIRECTION = {\n  ArrowLeft: LEFT,\n  Left: LEFT,\n  ArrowUp: UP,\n  Up: UP,\n  ArrowRight: RIGHT,\n  Right: RIGHT,\n  ArrowDown: DOWN,\n  Down: DOWN\n};\n\nvar DIRECTIONS_DELTA = {\n  left: function(speed) {\n    return {\n      x: -speed,\n      y: 0\n    };\n  },\n  up: function(speed) {\n    return {\n      x: 0,\n      y: -speed\n    };\n  },\n  right: function(speed) {\n    return {\n      x: speed,\n      y: 0\n    };\n  },\n  down: function(speed) {\n    return {\n      x: 0,\n      y: speed\n    };\n  }\n};\n\n\n/**\n * Enables to move selection with keyboard arrows.\n * Use with Shift for modified speed (default=1, with Shift=10).\n * Pressed Cmd/Ctrl turns the feature off.\n *\n * @param {Object} config\n * @param {Number} [config.moveSpeed=1]\n * @param {Number} [config.moveSpeedAccelerated=10]\n * @param {Keyboard} keyboard\n * @param {Modeling} modeling\n * @param {Selection} selection\n */\nexport default function KeyboardMoveSelection(\n    config,\n    keyboard,\n    modeling,\n    rules,\n    selection\n) {\n\n  var self = this;\n\n  this._config = assign({}, DEFAULT_CONFIG, config || {});\n\n  keyboard.addListener(HIGHER_PRIORITY, function(event) {\n\n    var keyEvent = event.keyEvent;\n\n    var direction = KEY_TO_DIRECTION[keyEvent.key];\n\n    if (!direction) {\n      return;\n    }\n\n    if (keyboard.isCmd(keyEvent)) {\n      return;\n    }\n\n    var accelerated = keyboard.isShift(keyEvent);\n\n    self.moveSelection(direction, accelerated);\n\n    return true;\n  });\n\n\n  /**\n   * Move selected elements in the given direction,\n   * optionally specifying accelerated movement.\n   *\n   * @param {String} direction\n   * @param {Boolean} [accelerated=false]\n   */\n  this.moveSelection = function(direction, accelerated) {\n\n    var selectedElements = selection.get();\n\n    if (!selectedElements.length) {\n      return;\n    }\n\n    var speed = this._config[\n      accelerated ?\n        'moveSpeedAccelerated' :\n        'moveSpeed'\n    ];\n\n    var delta = DIRECTIONS_DELTA[direction](speed);\n\n    var canMove = rules.allowed('elements.move', {\n      shapes: selectedElements\n    });\n\n    if (canMove) {\n      modeling.moveElements(selectedElements, delta);\n    }\n  };\n\n}\n\nKeyboardMoveSelection.$inject = [\n  'config.keyboardMoveSelection',\n  'keyboard',\n  'modeling',\n  'rules',\n  'selection'\n];","import KeyboardModule from '../keyboard';\nimport SelectionModule from '../selection';\n\nimport KeyboardMoveSelection from './KeyboardMoveSelection';\n\nexport default {\n  __depends__: [\n    KeyboardModule,\n    SelectionModule\n  ],\n  __init__: [\n    'keyboardMoveSelection'\n  ],\n  keyboardMoveSelection: [ 'type', KeyboardMoveSelection ]\n};\n","import {\n  getType as getElementType\n} from '../../util/Elements';\n\n/**\n * Adds change support to the diagram, including\n *\n * <ul>\n *   <li>redrawing shapes and connections on change</li>\n * </ul>\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {ElementRegistry} elementRegistry\n * @param {GraphicsFactory} graphicsFactory\n */\nexport default function ChangeSupport(\n    eventBus, canvas, elementRegistry,\n    graphicsFactory) {\n\n\n  // redraw shapes / connections on change\n\n  eventBus.on('element.changed', function(event) {\n\n    var element = event.element;\n\n    // element might have been deleted and replaced by new element with same ID\n    // thus check for parent of element except for root element\n    if (element.parent || element === canvas.getRootElement()) {\n      event.gfx = elementRegistry.getGraphics(element);\n    }\n\n    // shape + gfx may have been deleted\n    if (!event.gfx) {\n      return;\n    }\n\n    eventBus.fire(getElementType(element) + '.changed', event);\n  });\n\n  eventBus.on('elements.changed', function(event) {\n\n    var elements = event.elements;\n\n    elements.forEach(function(e) {\n      eventBus.fire('element.changed', { element: e });\n    });\n\n    graphicsFactory.updateContainments(elements);\n  });\n\n  eventBus.on('shape.changed', function(event) {\n    graphicsFactory.update('shape', event.element, event.gfx);\n  });\n\n  eventBus.on('connection.changed', function(event) {\n    graphicsFactory.update('connection', event.element, event.gfx);\n  });\n}\n\nChangeSupport.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'graphicsFactory'\n];","import ChangeSupport from './ChangeSupport';\n\nexport default {\n  __init__: [ 'changeSupport'],\n  changeSupport: [ 'type', ChangeSupport ]\n};","import {\n  pick,\n  assign\n} from 'min-dash';\n\nimport {\n  resizeBounds,\n  ensureConstraints,\n  computeChildrenBBox,\n  getMinResizeBounds\n} from './ResizeUtil';\n\nimport {\n  asTRBL,\n  getMid,\n  roundBounds\n} from '../../layout/LayoutUtil';\n\nvar DEFAULT_MIN_WIDTH = 10;\n\n\n/**\n * A component that provides resizing of shapes on the canvas.\n *\n * The following components are part of shape resize:\n *\n *  * adding resize handles,\n *  * creating a visual during resize\n *  * checking resize rules\n *  * committing a change once finished\n *\n *\n * ## Customizing\n *\n * It's possible to customize the resizing behaviour by intercepting 'resize.start'\n * and providing the following parameters through the 'context':\n *\n *   * minDimensions ({ width, height }): minimum shape dimensions\n *\n *   * childrenBoxPadding ({ left, top, bottom, right } || number):\n *     gap between the minimum bounding box and the container\n *\n * f.ex:\n *\n * ```javascript\n * eventBus.on('resize.start', 1500, function(event) {\n *   var context = event.context,\n *\n *  context.minDimensions = { width: 140, height: 120 };\n *\n *  // Passing general padding\n *  context.childrenBoxPadding = 30;\n *\n *  // Passing padding to a specific side\n *  context.childrenBoxPadding.left = 20;\n * });\n * ```\n */\nexport default function Resize(eventBus, rules, modeling, dragging) {\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  var self = this;\n\n\n  /**\n   * Handle resize move by specified delta.\n   *\n   * @param {Object} context\n   * @param {Point} delta\n   */\n  function handleMove(context, delta) {\n\n    var shape = context.shape,\n        direction = context.direction,\n        resizeConstraints = context.resizeConstraints,\n        newBounds;\n\n    context.delta = delta;\n\n    newBounds = resizeBounds(shape, direction, delta);\n\n    // ensure constraints during resize\n    context.newBounds = ensureConstraints(newBounds, resizeConstraints);\n\n    // update + cache executable state\n    context.canExecute = self.canResize(context);\n  }\n\n  /**\n   * Handle resize start.\n   *\n   * @param  {Object} context\n   */\n  function handleStart(context) {\n\n    var resizeConstraints = context.resizeConstraints,\n\n        // evaluate minBounds for backwards compatibility\n        minBounds = context.minBounds;\n\n    if (resizeConstraints !== undefined) {\n      return;\n    }\n\n    if (minBounds === undefined) {\n      minBounds = self.computeMinResizeBox(context);\n    }\n\n    context.resizeConstraints = {\n      min: asTRBL(minBounds)\n    };\n  }\n\n  /**\n   * Handle resize end.\n   *\n   * @param  {Object} context\n   */\n  function handleEnd(context) {\n    var shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (canExecute) {\n\n      // ensure we have actual pixel values for new bounds\n      // (important when zoom level was > 1 during move)\n      newBounds = roundBounds(newBounds);\n\n      if (!boundsChanged(shape, newBounds)) {\n\n        // no resize necessary\n        return;\n      }\n\n      // perform the actual resize\n      modeling.resizeShape(shape, newBounds);\n    }\n  }\n\n\n  eventBus.on('resize.start', function(event) {\n    handleStart(event.context);\n  });\n\n  eventBus.on('resize.move', function(event) {\n    var delta = {\n      x: event.dx,\n      y: event.dy\n    };\n\n    handleMove(event.context, delta);\n  });\n\n  eventBus.on('resize.end', function(event) {\n    handleEnd(event.context);\n  });\n\n}\n\n\nResize.prototype.canResize = function(context) {\n  var rules = this._rules;\n\n  var ctx = pick(context, [ 'newBounds', 'shape', 'delta', 'direction' ]);\n\n  return rules.allowed('shape.resize', ctx);\n};\n\n/**\n * Activate a resize operation.\n *\n * You may specify additional contextual information and must specify a\n * resize direction during activation of the resize event.\n *\n * @param {MouseEvent} event\n * @param {djs.model.Shape} shape\n * @param {Object|String} contextOrDirection\n */\nResize.prototype.activate = function(event, shape, contextOrDirection) {\n  var dragging = this._dragging,\n      context,\n      direction;\n\n  if (typeof contextOrDirection === 'string') {\n    contextOrDirection = {\n      direction: contextOrDirection\n    };\n  }\n\n  context = assign({ shape: shape }, contextOrDirection);\n\n  direction = context.direction;\n\n  if (!direction) {\n    throw new Error('must provide a direction (n|w|s|e|nw|se|ne|sw)');\n  }\n\n  dragging.init(event, getReferencePoint(shape, direction), 'resize', {\n    autoActivate: true,\n    cursor: getCursor(direction),\n    data: {\n      shape: shape,\n      context: context\n    }\n  });\n};\n\nResize.prototype.computeMinResizeBox = function(context) {\n  var shape = context.shape,\n      direction = context.direction,\n      minDimensions,\n      childrenBounds;\n\n  minDimensions = context.minDimensions || {\n    width: DEFAULT_MIN_WIDTH,\n    height: DEFAULT_MIN_WIDTH\n  };\n\n  // get children bounds\n  childrenBounds = computeChildrenBBox(shape, context.childrenBoxPadding);\n\n  // get correct minimum bounds from given resize direction\n  // basically ensures that the minBounds is max(childrenBounds, minDimensions)\n  return getMinResizeBounds(direction, shape, minDimensions, childrenBounds);\n};\n\n\nResize.$inject = [\n  'eventBus',\n  'rules',\n  'modeling',\n  'dragging'\n];\n\n// helpers //////////\n\nfunction boundsChanged(shape, newBounds) {\n  return shape.x !== newBounds.x ||\n    shape.y !== newBounds.y ||\n    shape.width !== newBounds.width ||\n    shape.height !== newBounds.height;\n}\n\nexport function getReferencePoint(shape, direction) {\n  var mid = getMid(shape),\n      trbl = asTRBL(shape);\n\n  var referencePoint = {\n    x: mid.x,\n    y: mid.y\n  };\n\n  if (direction.indexOf('n') !== -1) {\n    referencePoint.y = trbl.top;\n  } else if (direction.indexOf('s') !== -1) {\n    referencePoint.y = trbl.bottom;\n  }\n\n  if (direction.indexOf('e') !== -1) {\n    referencePoint.x = trbl.right;\n  } else if (direction.indexOf('w') !== -1) {\n    referencePoint.x = trbl.left;\n  }\n\n  return referencePoint;\n}\n\nfunction getCursor(direction) {\n  var prefix = 'resize-';\n\n  if (direction === 'n' || direction === 's') {\n    return prefix + 'ns';\n  } else if (direction === 'e' || direction === 'w') {\n    return prefix + 'ew';\n  } else if (direction === 'nw' || direction === 'se') {\n    return prefix + 'nwse';\n  } else {\n    return prefix + 'nesw';\n  }\n}","var MARKER_RESIZING = 'djs-resizing',\n    MARKER_RESIZE_NOT_OK = 'resize-not-ok';\n\nvar LOW_PRIORITY = 500;\n\nimport {\n  attr as svgAttr,\n  remove as svgRemove,\n  classes as svgClasses\n} from 'tiny-svg';\n\n\n/**\n * Provides previews for resizing shapes when resizing.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {PreviewSupport} previewSupport\n */\nexport default function ResizePreview(eventBus, canvas, previewSupport) {\n\n  /**\n   * Update resizer frame.\n   *\n   * @param {Object} context\n   */\n  function updateFrame(context) {\n\n    var shape = context.shape,\n        bounds = context.newBounds,\n        frame = context.frame;\n\n    if (!frame) {\n      frame = context.frame = previewSupport.addFrame(shape, canvas.getDefaultLayer());\n\n      canvas.addMarker(shape, MARKER_RESIZING);\n    }\n\n    if (bounds.width > 5) {\n      svgAttr(frame, { x: bounds.x, width: bounds.width });\n    }\n\n    if (bounds.height > 5) {\n      svgAttr(frame, { y: bounds.y, height: bounds.height });\n    }\n\n    if (context.canExecute) {\n      svgClasses(frame).remove(MARKER_RESIZE_NOT_OK);\n    } else {\n      svgClasses(frame).add(MARKER_RESIZE_NOT_OK);\n    }\n  }\n\n  /**\n   * Remove resizer frame.\n   *\n   * @param {Object} context\n   */\n  function removeFrame(context) {\n    var shape = context.shape,\n        frame = context.frame;\n\n    if (frame) {\n      svgRemove(context.frame);\n    }\n\n    canvas.removeMarker(shape, MARKER_RESIZING);\n  }\n\n  // add and update previews\n  eventBus.on('resize.move', LOW_PRIORITY, function(event) {\n    updateFrame(event.context);\n  });\n\n  // remove previews\n  eventBus.on('resize.cleanup', function(event) {\n    removeFrame(event.context);\n  });\n\n}\n\nResizePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'previewSupport'\n];","import {\n  bind,\n  forEach\n} from 'min-dash';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  clear as svgClear,\n  create as svgCreate\n} from 'tiny-svg';\n\nimport {\n  event as domEvent\n} from 'min-dom';\n\nimport {\n  isPrimaryButton\n} from '../../util/Mouse';\n\nimport {\n  transform\n} from '../../util/SvgTransformUtil';\n\nimport { getReferencePoint } from './Resize';\n\nvar HANDLE_OFFSET = -6,\n    HANDLE_SIZE = 4,\n    HANDLE_HIT_SIZE = 20;\n\nvar CLS_RESIZER = 'djs-resizer';\n\nvar directions = [ 'n', 'w', 's', 'e', 'nw', 'ne', 'se', 'sw' ];\n\n\n/**\n * This component is responsible for adding resize handles.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Selection} selection\n * @param {Resize} resize\n */\nexport default function ResizeHandles(eventBus, canvas, selection, resize) {\n\n  this._resize = resize;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('selection.changed', function(e) {\n    var newSelection = e.newSelection;\n\n    // remove old selection markers\n    self.removeResizers();\n\n    // add new selection markers ONLY if single selection\n    if (newSelection.length === 1) {\n      forEach(newSelection, bind(self.addResizer, self));\n    }\n  });\n\n  eventBus.on('shape.changed', function(e) {\n    var shape = e.element;\n\n    if (selection.isSelected(shape)) {\n      self.removeResizers();\n\n      self.addResizer(shape);\n    }\n  });\n}\n\n\nResizeHandles.prototype.makeDraggable = function(element, gfx, direction) {\n  var resize = this._resize;\n\n  function startResize(event) {\n\n    // only trigger on left mouse button\n    if (isPrimaryButton(event)) {\n      resize.activate(event, element, direction);\n    }\n  }\n\n  domEvent.bind(gfx, 'mousedown', startResize);\n  domEvent.bind(gfx, 'touchstart', startResize);\n};\n\n\nResizeHandles.prototype._createResizer = function(element, x, y, direction) {\n  var resizersParent = this._getResizersParent();\n\n  var offset = getHandleOffset(direction);\n\n  var group = svgCreate('g');\n\n  svgClasses(group).add(CLS_RESIZER);\n  svgClasses(group).add(CLS_RESIZER + '-' + element.id);\n  svgClasses(group).add(CLS_RESIZER + '-' + direction);\n\n  svgAppend(resizersParent, group);\n\n  var visual = svgCreate('rect');\n\n  svgAttr(visual, {\n    x: -HANDLE_SIZE / 2 + offset.x,\n    y: -HANDLE_SIZE / 2 + offset.y,\n    width: HANDLE_SIZE,\n    height: HANDLE_SIZE\n  });\n\n  svgClasses(visual).add(CLS_RESIZER + '-visual');\n\n  svgAppend(group, visual);\n\n  var hit = svgCreate('rect');\n\n  svgAttr(hit, {\n    x: -HANDLE_HIT_SIZE / 2 + offset.x,\n    y: -HANDLE_HIT_SIZE / 2 + offset.y,\n    width: HANDLE_HIT_SIZE,\n    height: HANDLE_HIT_SIZE\n  });\n\n  svgClasses(hit).add(CLS_RESIZER + '-hit');\n\n  svgAppend(group, hit);\n\n  transform(group, x, y);\n\n  return group;\n};\n\nResizeHandles.prototype.createResizer = function(element, direction) {\n  var point = getReferencePoint(element, direction);\n\n  var resizer = this._createResizer(element, point.x, point.y, direction);\n\n  this.makeDraggable(element, resizer, direction);\n};\n\n// resize handles implementation ///////////////////////////////\n\n/**\n * Add resizers for a given element.\n *\n * @param {djs.model.Shape} shape\n */\nResizeHandles.prototype.addResizer = function(shape) {\n  var self = this;\n\n  var resize = this._resize;\n\n  if (!resize.canResize({ shape: shape })) {\n    return;\n  }\n\n  forEach(directions, function(direction) {\n    self.createResizer(shape, direction);\n  });\n};\n\n/**\n * Remove all resizers\n */\nResizeHandles.prototype.removeResizers = function() {\n  var resizersParent = this._getResizersParent();\n\n  svgClear(resizersParent);\n};\n\nResizeHandles.prototype._getResizersParent = function() {\n  return this._canvas.getLayer('resizers');\n};\n\nResizeHandles.$inject = [\n  'eventBus',\n  'canvas',\n  'selection',\n  'resize'\n];\n\n// helpers //////////\n\nfunction getHandleOffset(direction) {\n  var offset = {\n    x: 0,\n    y: 0\n  };\n\n  if (direction.indexOf('e') !== -1) {\n    offset.x = -HANDLE_OFFSET;\n  } else if (direction.indexOf('w') !== -1) {\n    offset.x = HANDLE_OFFSET;\n  }\n\n  if (direction.indexOf('s') !== -1) {\n    offset.y = -HANDLE_OFFSET;\n  } else if (direction.indexOf('n') !== -1) {\n    offset.y = HANDLE_OFFSET;\n  }\n\n  return offset;\n}","import RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Resize from './Resize';\nimport ResizePreview from './ResizePreview';\nimport ResizeHandles from './ResizeHandles';\n\nexport default {\n  __depends__: [\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'resize',\n    'resizePreview',\n    'resizeHandles'\n  ],\n  resize: [ 'type', Resize ],\n  resizePreview: [ 'type', ResizePreview ],\n  resizeHandles: [ 'type', ResizeHandles ]\n};\n","import {\n  add as collectionAdd\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  getBusinessObject\n} from '../../../../util/ModelUtil';\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nexport function createCategoryValue(definitions, bpmnFactory) {\n  var categoryValue = bpmnFactory.create('bpmn:CategoryValue'),\n      category = bpmnFactory.create('bpmn:Category', {\n        categoryValue: [ categoryValue ]\n      });\n\n  // add to correct place\n  collectionAdd(definitions.get('rootElements'), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n\n}","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getLabel\n} from './LabelUtil';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  createCategoryValue\n} from '../modeling/behavior/util/CategoryUtil';\n\nimport { isAny } from '../modeling/util/ModelingUtil';\nimport { isExpanded } from '../../util/DiUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../util/LabelUtil';\n\n\nexport default function LabelEditingProvider(\n    eventBus, bpmnFactory, canvas, directEditing,\n    modeling, resizeHandles, textRenderer) {\n\n  this._bpmnFactory = bpmnFactory;\n  this._canvas = canvas;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n\n  directEditing.registerProvider(this);\n\n  // listen to dblclick on non-root elements\n  eventBus.on('element.dblclick', function(event) {\n    activateDirectEdit(event.element, true);\n  });\n\n  // complete on followup canvas operation\n  eventBus.on([\n    'autoPlace.start',\n    'canvas.viewbox.changing',\n    'drag.init',\n    'element.mousedown',\n    'popupMenu.open'\n  ], function(event) {\n\n    if (directEditing.isActive()) {\n      directEditing.complete();\n    }\n  });\n\n  // cancel on command stack changes\n  eventBus.on([ 'commandStack.changed' ], function(e) {\n    if (directEditing.isActive()) {\n      directEditing.cancel();\n    }\n  });\n\n\n  eventBus.on('directEditing.activate', function(event) {\n    resizeHandles.removeResizers();\n  });\n\n  eventBus.on('create.end', 500, function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        canExecute = event.context.canExecute,\n        isTouch = event.isTouch;\n\n    // TODO(nikku): we need to find a way to support the\n    // direct editing on mobile devices; right now this will\n    // break for desworkflowediting on mobile devices\n    // as it breaks the user interaction workflow\n\n    // TODO(nre): we should temporarily focus the edited element\n    // here and release the focused viewport after the direct edit\n    // operation is finished\n    if (isTouch) {\n      return;\n    }\n\n    if (!canExecute) {\n      return;\n    }\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    activateDirectEdit(element);\n  });\n\n  eventBus.on('autoPlace.end', 500, function(event) {\n    activateDirectEdit(event.shape);\n  });\n\n\n  function activateDirectEdit(element, force) {\n    if (force ||\n        isAny(element, [ 'bpmn:Task', 'bpmn:TextAnnotation', 'bpmn:Group' ]) ||\n        isCollapsedSubProcess(element)) {\n\n      directEditing.activate(element);\n    }\n  }\n\n}\n\nLabelEditingProvider.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'canvas',\n  'directEditing',\n  'modeling',\n  'resizeHandles',\n  'textRenderer'\n];\n\n\n/**\n * Activate direct editing for activities and text annotations.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object with properties bounds (position and size), text and options\n */\nLabelEditingProvider.prototype.activate = function(element) {\n\n  // text\n  var text = getLabel(element);\n\n  if (text === undefined) {\n    return;\n  }\n\n  var context = {\n    text: text\n  };\n\n  // bounds\n  var bounds = this.getEditingBBox(element);\n\n  assign(context, bounds);\n\n  var options = {};\n\n  // tasks\n  if (\n    isAny(element, [\n      'bpmn:Task',\n      'bpmn:Participant',\n      'bpmn:Lane',\n      'bpmn:CallActivity'\n    ]) ||\n    isCollapsedSubProcess(element)\n  ) {\n    assign(options, {\n      centerVertically: true\n    });\n  }\n\n  // external labels\n  if (isLabelExternal(element)) {\n    assign(options, {\n      autoResize: true\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(options, {\n      resizable: true,\n      autoResize: true\n    });\n  }\n\n  assign(context, {\n    options: options\n  });\n\n  return context;\n};\n\n\n/**\n * Get the editing bounding box based on the element's size and position\n *\n * @param  {djs.model.Base} element\n *\n * @return {Object} an object containing information about position\n *                  and size (fixed or minimum and/or maximum)\n */\nLabelEditingProvider.prototype.getEditingBBox = function(element) {\n  var canvas = this._canvas;\n\n  var target = element.label || element;\n\n  var bbox = canvas.getAbsoluteBBox(target);\n\n  var mid = {\n    x: bbox.x + bbox.width / 2,\n    y: bbox.y + bbox.height / 2\n  };\n\n  // default position\n  var bounds = { x: bbox.x, y: bbox.y };\n\n  var zoom = canvas.zoom();\n\n  var defaultStyle = this._textRenderer.getDefaultStyle(),\n      externalStyle = this._textRenderer.getExternalStyle();\n\n  // take zoom into account\n  var externalFontSize = externalStyle.fontSize * zoom,\n      externalLineHeight = externalStyle.lineHeight,\n      defaultFontSize = defaultStyle.fontSize * zoom,\n      defaultLineHeight = defaultStyle.lineHeight;\n\n  var style = {\n    fontFamily: this._textRenderer.getDefaultStyle().fontFamily,\n    fontWeight: this._textRenderer.getDefaultStyle().fontWeight\n  };\n\n  // adjust for expanded pools AND lanes\n  if (is(element, 'bpmn:Lane') || isExpandedPool(element)) {\n\n    assign(bounds, {\n      width: bbox.height,\n      height: 30 * zoom,\n      x: bbox.x - bbox.height / 2 + (15 * zoom),\n      y: mid.y - (30 * zoom) / 2\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      transform: 'rotate(-90deg)'\n    });\n  }\n\n\n  // internal labels for tasks and collapsed call activities,\n  // sub processes and participants\n  if (isAny(element, [ 'bpmn:Task', 'bpmn:CallActivity']) ||\n      isCollapsedPool(element) ||\n      isCollapsedSubProcess(element)) {\n\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n\n  // internal labels for expanded sub processes\n  if (isExpandedSubProcess(element)) {\n    assign(bounds, {\n      width: bbox.width,\n      x: bbox.x\n    });\n\n    assign(style, {\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight,\n      paddingTop: (7 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (5 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px'\n    });\n  }\n\n  var width = 90 * zoom,\n      paddingTop = 7 * zoom,\n      paddingBottom = 4 * zoom;\n\n  // external labels for events, data elements, gateways, groups and connections\n  if (target.labelTarget) {\n    assign(bounds, {\n      width: width,\n      height: bbox.height + paddingTop + paddingBottom,\n      x: mid.x - width / 2,\n      y: bbox.y - paddingTop\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // external label not yet created\n  if (isLabelExternal(target)\n      && !hasExternalLabel(target)\n      && !isLabel(target)) {\n\n    var externalLabelMid = getExternalLabelMid(element);\n\n    var absoluteBBox = canvas.getAbsoluteBBox({\n      x: externalLabelMid.x,\n      y: externalLabelMid.y,\n      width: 0,\n      height: 0\n    });\n\n    var height = externalFontSize + paddingTop + paddingBottom;\n\n    assign(bounds, {\n      width: width,\n      height: height,\n      x: absoluteBBox.x - width / 2,\n      y: absoluteBBox.y - height / 2\n    });\n\n    assign(style, {\n      fontSize: externalFontSize + 'px',\n      lineHeight: externalLineHeight,\n      paddingTop: paddingTop + 'px',\n      paddingBottom: paddingBottom + 'px'\n    });\n  }\n\n  // text annotations\n  if (is(element, 'bpmn:TextAnnotation')) {\n    assign(bounds, {\n      width: bbox.width,\n      height: bbox.height,\n      minWidth: 30 * zoom,\n      minHeight: 10 * zoom\n    });\n\n    assign(style, {\n      textAlign: 'left',\n      paddingTop: (5 * zoom) + 'px',\n      paddingBottom: (7 * zoom) + 'px',\n      paddingLeft: (7 * zoom) + 'px',\n      paddingRight: (5 * zoom) + 'px',\n      fontSize: defaultFontSize + 'px',\n      lineHeight: defaultLineHeight\n    });\n  }\n\n  return { bounds: bounds, style: style };\n};\n\n\nLabelEditingProvider.prototype.update = function(\n    element, newLabel,\n    activeContextText, bounds) {\n\n  var newBounds,\n      bbox;\n\n  if (is(element, 'bpmn:TextAnnotation')) {\n\n    bbox = this._canvas.getAbsoluteBBox(element);\n\n    newBounds = {\n      x: element.x,\n      y: element.y,\n      width: element.width / bbox.width * bounds.width,\n      height: element.height / bbox.height * bounds.height\n    };\n  }\n\n  if (is(element, 'bpmn:Group')) {\n\n    var businessObject = getBusinessObject(element);\n\n    // initialize categoryValue if not existing\n    if (!businessObject.categoryValueRef) {\n\n      var rootElement = this._canvas.getRootElement(),\n          definitions = getBusinessObject(rootElement).$parent;\n\n      var categoryValue = createCategoryValue(definitions, this._bpmnFactory);\n\n      getBusinessObject(element).categoryValueRef = categoryValue;\n    }\n\n  }\n\n  if (isEmptyText(newLabel)) {\n    newLabel = null;\n  }\n\n  this._modeling.updateLabel(element, newLabel, newBounds);\n};\n\n\n\n// helpers //////////////////////\n\nfunction isCollapsedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && !isExpanded(element);\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isCollapsedPool(element) {\n  return is(element, 'bpmn:Participant') && !isExpanded(element);\n}\n\nfunction isExpandedPool(element) {\n  return is(element, 'bpmn:Participant') && isExpanded(element);\n}\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  translate\n} from 'diagram-js/lib/util/SvgTransformUtil';\n\nvar MARKER_HIDDEN = 'djs-element-hidden',\n    MARKER_LABEL_HIDDEN = 'djs-label-hidden';\n\n\nexport default function LabelEditingPreview(\n    eventBus, canvas, elementRegistry,\n    pathMap) {\n\n  var self = this;\n\n  var defaultLayer = canvas.getDefaultLayer();\n\n  var element, absoluteElementBBox, gfx;\n\n  eventBus.on('directEditing.activate', function(context) {\n    var activeProvider = context.active;\n\n    element = activeProvider.element.label || activeProvider.element;\n\n    // text annotation\n    if (is(element, 'bpmn:TextAnnotation')) {\n      absoluteElementBBox = canvas.getAbsoluteBBox(element);\n\n      gfx = svgCreate('g');\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: element.height,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      var path = self.path = svgCreate('path');\n\n      svgAttr(path, {\n        d: textPathData,\n        strokeWidth: 2,\n        stroke: getStrokeColor(element)\n      });\n\n      svgAppend(gfx, path);\n\n      svgAppend(defaultLayer, gfx);\n\n      translate(gfx, element.x, element.y);\n    }\n\n    if (is(element, 'bpmn:TextAnnotation') ||\n        element.labelTarget) {\n      canvas.addMarker(element, MARKER_HIDDEN);\n    } else if (is(element, 'bpmn:Task') ||\n               is(element, 'bpmn:CallActivity') ||\n               is(element, 'bpmn:SubProcess') ||\n               is(element, 'bpmn:Participant')) {\n      canvas.addMarker(element, MARKER_LABEL_HIDDEN);\n    }\n  });\n\n  eventBus.on('directEditing.resize', function(context) {\n\n    // text annotation\n    if (is(element, 'bpmn:TextAnnotation')) {\n      var height = context.height,\n          dy = context.dy;\n\n      var newElementHeight = Math.max(element.height / absoluteElementBBox.height * (height + dy), 0);\n\n      var textPathData = pathMap.getScaledPath('TEXT_ANNOTATION', {\n        xScaleFactor: 1,\n        yScaleFactor: 1,\n        containerWidth: element.width,\n        containerHeight: newElementHeight,\n        position: {\n          mx: 0.0,\n          my: 0.0\n        }\n      });\n\n      svgAttr(self.path, {\n        d: textPathData\n      });\n    }\n  });\n\n  eventBus.on([ 'directEditing.complete', 'directEditing.cancel' ], function(context) {\n    var activeProvider = context.active;\n\n    if (activeProvider) {\n      canvas.removeMarker(activeProvider.element.label || activeProvider.element, MARKER_HIDDEN);\n      canvas.removeMarker(element, MARKER_LABEL_HIDDEN);\n    }\n\n    element = undefined;\n    absoluteElementBBox = undefined;\n\n    if (gfx) {\n      svgRemove(gfx);\n\n      gfx = undefined;\n    }\n  });\n}\n\nLabelEditingPreview.$inject = [\n  'eventBus',\n  'canvas',\n  'elementRegistry',\n  'pathMap'\n];\n\n\n// helpers ///////////////////\n\nfunction getStrokeColor(element, defaultColor) {\n  var bo = getBusinessObject(element);\n\n  return bo.di.get('stroke') || defaultColor || 'black';\n}","import ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport DirectEditingModule from 'diagram-js-direct-editing';\n\nimport LabelEditingProvider from './LabelEditingProvider';\nimport LabelEditingPreview from './LabelEditingPreview';\n\n\nexport default {\n  __depends__: [\n    ChangeSupportModule,\n    ResizeModule,\n    DirectEditingModule\n  ],\n  __init__: [\n    'labelEditingProvider',\n    'labelEditingPreview'\n  ],\n  labelEditingProvider: [ 'type', LabelEditingProvider ],\n  labelEditingPreview: [ 'type', LabelEditingPreview ]\n};\n","import inherits from 'inherits';\n\nimport {\n  getOrientation,\n  getMid,\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substract\n} from 'diagram-js/lib/util/Math';\n\nimport {\n  hasExternalLabel\n} from '../../../util/LabelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nvar ALIGNMENTS = [\n  'top',\n  'bottom',\n  'left',\n  'right'\n];\n\nvar ELEMENT_LABEL_DISTANCE = 10;\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function AdaptiveLabelPositioningBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.postExecuted([\n    'connection.create',\n    'connection.layout',\n    'connection.updateWaypoints'\n  ], function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source,\n        target = connection.target,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(source);\n      checkLabelAdjustment(target);\n    }\n  });\n\n\n  this.postExecuted([\n    'label.create'\n  ], function(event) {\n    var context = event.context,\n        shape = context.shape,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      checkLabelAdjustment(shape.labelTarget);\n    }\n  });\n\n\n  this.postExecuted([\n    'elements.create'\n  ], function(event) {\n    var context = event.context,\n        elements = context.elements,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior !== false) {\n      elements.forEach(function(element) {\n        checkLabelAdjustment(element);\n      });\n    }\n  });\n\n  function checkLabelAdjustment(element) {\n\n    // skip non-existing labels\n    if (!hasExternalLabel(element)) {\n      return;\n    }\n\n    var optimalPosition = getOptimalPosition(element);\n\n    // no optimal position found\n    if (!optimalPosition) {\n      return;\n    }\n\n    adjustLabelPosition(element, optimalPosition);\n  }\n\n  function adjustLabelPosition(element, orientation) {\n\n    var elementMid = getMid(element),\n        label = element.label,\n        labelMid = getMid(label);\n\n    // ignore labels that are being created\n    if (!label.parent) {\n      return;\n    }\n\n    var elementTrbl = asTRBL(element);\n\n    var newLabelMid;\n\n    switch (orientation) {\n    case 'top':\n      newLabelMid = {\n        x: elementMid.x,\n        y: elementTrbl.top - ELEMENT_LABEL_DISTANCE - label.height / 2\n      };\n\n      break;\n\n    case 'left':\n\n      newLabelMid = {\n        x: elementTrbl.left - ELEMENT_LABEL_DISTANCE - label.width / 2,\n        y: elementMid.y\n      };\n\n      break;\n\n    case 'bottom':\n\n      newLabelMid = {\n        x: elementMid.x,\n        y: elementTrbl.bottom + ELEMENT_LABEL_DISTANCE + label.height / 2\n      };\n\n      break;\n\n    case 'right':\n\n      newLabelMid = {\n        x: elementTrbl.right + ELEMENT_LABEL_DISTANCE + label.width / 2,\n        y: elementMid.y\n      };\n\n      break;\n    }\n\n    var delta = substract(newLabelMid, labelMid);\n\n    modeling.moveShape(label, delta);\n  }\n\n}\n\ninherits(AdaptiveLabelPositioningBehavior, CommandInterceptor);\n\nAdaptiveLabelPositioningBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Return alignments which are taken by a boundary's host element\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenHostAlignments(element) {\n\n  var hostElement = element.host,\n      elementMid = getMid(element),\n      hostOrientation = getOrientation(elementMid, hostElement);\n\n  var freeAlignments;\n\n  // check whether there is a multi-orientation, e.g. 'top-left'\n  if (hostOrientation.indexOf('-') >= 0) {\n    freeAlignments = hostOrientation.split('-');\n  } else {\n    freeAlignments = [ hostOrientation ];\n  }\n\n  var takenAlignments = ALIGNMENTS.filter(function(alignment) {\n\n    return freeAlignments.indexOf(alignment) === -1;\n  });\n\n  return takenAlignments;\n\n}\n\n/**\n * Return alignments which are taken by related connections\n *\n * @param {Shape} element\n *\n * @return {Array<String>}\n */\nfunction getTakenConnectionAlignments(element) {\n\n  var elementMid = getMid(element);\n\n  var takenAlignments = [].concat(\n    element.incoming.map(function(c) {\n      return c.waypoints[c.waypoints.length - 2 ];\n    }),\n    element.outgoing.map(function(c) {\n      return c.waypoints[1];\n    })\n  ).map(function(point) {\n    return getApproximateOrientation(elementMid, point);\n  });\n\n  return takenAlignments;\n}\n\n/**\n * Return the optimal label position around an element\n * or _undefined_, if none was found.\n *\n * @param  {Shape} element\n *\n * @return {String} positioning identifier\n */\nfunction getOptimalPosition(element) {\n\n  var labelMid = getMid(element.label);\n\n  var elementMid = getMid(element);\n\n  var labelOrientation = getApproximateOrientation(elementMid, labelMid);\n\n  if (!isAligned(labelOrientation)) {\n    return;\n  }\n\n  var takenAlignments = getTakenConnectionAlignments(element);\n\n  if (element.host) {\n    var takenHostAlignments = getTakenHostAlignments(element);\n\n    takenAlignments = takenAlignments.concat(takenHostAlignments);\n  }\n\n  var freeAlignments = ALIGNMENTS.filter(function(alignment) {\n\n    return takenAlignments.indexOf(alignment) === -1;\n  });\n\n  // NOTHING TO DO; label already aligned a.O.K.\n  if (freeAlignments.indexOf(labelOrientation) !== -1) {\n    return;\n  }\n\n  return freeAlignments[0];\n}\n\nfunction getApproximateOrientation(p0, p1) {\n  return getOrientation(p1, p0, 5);\n}\n\nfunction isAligned(orientation) {\n  return ALIGNMENTS.indexOf(orientation) !== -1;\n}\n","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n\nexport default function AppendBehavior(eventBus, elementFactory, bpmnRules) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // assign correct shape position unless already set\n\n  this.preExecute('shape.append', function(context) {\n\n    var source = context.source,\n        shape = context.shape;\n\n    if (!context.position) {\n\n      if (is(shape, 'bpmn:TextAnnotation')) {\n        context.position = {\n          x: source.x + source.width / 2 + 75,\n          y: source.y - (50) - shape.height / 2\n        };\n      } else {\n        context.position = {\n          x: source.x + source.width + 80 + shape.width / 2,\n          y: source.y + source.height / 2\n        };\n      }\n    }\n  }, true);\n}\n\ninherits(AppendBehavior, CommandInterceptor);\n\nAppendBehavior.$inject = [\n  'eventBus',\n  'elementFactory',\n  'bpmnRules'\n];","import inherits from 'inherits';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  filter,\r\n  forEach\r\n} from 'min-dash';\r\n\r\n\r\nexport default function AssociationBehavior(injector, modeling) {\r\n  injector.invoke(CommandInterceptor, this);\r\n\r\n  this.postExecute('shape.move', function(context) {\r\n    var newParent = context.newParent,\r\n        shape = context.shape;\r\n\r\n    var associations = filter(shape.incoming.concat(shape.outgoing), function(connection) {\r\n      return is(connection, 'bpmn:Association');\r\n    });\r\n\r\n    forEach(associations, function(association) {\r\n      modeling.moveConnection(association, { x: 0, y: 0 }, newParent);\r\n    });\r\n  }, true);\r\n}\r\n\r\ninherits(AssociationBehavior, CommandInterceptor);\r\n\r\nAssociationBehavior.$inject = [\r\n  'injector',\r\n  'modeling'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getBusinessObject } from '../../../util/ModelUtil';\n\nimport { isAny } from '../util/ModelingUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Replace intermediate event with boundary event when creating or moving results in attached event.\n */\nexport default function AttachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  var self = this;\n\n  this.postExecuted('elements.create', LOW_PRIORITY, function(context) {\n    var elements = context.elements;\n\n    elements = elements.filter(function(shape) {\n      var host = shape.host;\n\n      return shouldReplace(shape, host);\n    });\n\n    if (elements.length !== 1) {\n      return;\n    }\n\n    elements.map(function(element) {\n      return elements.indexOf(element);\n    }).forEach(function(index) {\n      var host = elements[ index ];\n\n      context.elements[ index ] = self.replaceShape(elements[ index ], host);\n    });\n  }, true);\n\n\n  this.preExecute('elements.move', LOW_PRIORITY, function(context) {\n    var shapes = context.shapes,\n        host = context.newHost;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    if (shouldReplace(shape, host)) {\n      context.shapes = [ self.replaceShape(shape, host) ];\n    }\n  }, true);\n}\n\nAttachEventBehavior.$inject = [\n  'bpmnReplace',\n  'injector'\n];\n\ninherits(AttachEventBehavior, CommandInterceptor);\n\nAttachEventBehavior.prototype.replaceShape = function(shape, host) {\n  var eventDefinition = getEventDefinition(shape);\n\n  var boundaryEvent = {\n    type: 'bpmn:BoundaryEvent',\n    host: host\n  };\n\n  if (eventDefinition) {\n    boundaryEvent.eventDefinitionType = eventDefinition.$type;\n  }\n\n  return this._bpmnReplace.replaceElement(shape, boundaryEvent, { layoutConnection: false });\n};\n\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  var businessObject = getBusinessObject(element),\n      eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) &&\n    isAny(shape, [ 'bpmn:IntermediateThrowEvent', 'bpmn:IntermediateCatchEvent' ]) && !!host;\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  filter,\n  forEach\n} from 'min-dash';\n\n\n/**\n * BPMN specific boundary event behavior\n */\nexport default function BoundaryEventBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  function getBoundaryEvents(element) {\n    return filter(element.attachers, function(attacher) {\n      return is(attacher, 'bpmn:BoundaryEvent');\n    });\n  }\n\n  // remove after connecting to event-based gateway\n  this.postExecute('connection.create', function(event) {\n    var source = event.context.source,\n        target = event.context.target,\n        boundaryEvents = getBoundaryEvents(target);\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      is(target, 'bpmn:ReceiveTask') &&\n      boundaryEvents.length > 0\n    ) {\n      modeling.removeElements(boundaryEvents);\n    }\n\n  });\n\n  // remove after replacing connected gateway with event-based gateway\n  this.postExecute('connection.reconnect', function(event) {\n    var oldSource = event.context.oldSource,\n        newSource = event.context.newSource;\n\n    if (is(oldSource, 'bpmn:Gateway') &&\n        is(newSource, 'bpmn:EventBasedGateway')) {\n      forEach(newSource.outgoing, function(connection) {\n        var target = connection.target,\n            attachedboundaryEvents = getBoundaryEvents(target);\n\n        if (is(target, 'bpmn:ReceiveTask') &&\n            attachedboundaryEvents.length > 0) {\n          modeling.removeElements(attachedboundaryEvents);\n        }\n      });\n    }\n  });\n}\n\nBoundaryEventBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(BoundaryEventBehavior, CommandInterceptor);\n","import inherits from 'inherits';\r\n\r\nimport {\r\n  find,\r\n  isArray,\r\n  matchPattern,\r\n  some\r\n} from 'min-dash';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport {\r\n  add as collectionAdd,\r\n  remove as collectionRemove\r\n} from 'diagram-js/lib/util/Collections';\r\n\r\nimport {\r\n  getBusinessObject,\r\n  is\r\n} from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nimport { hasEventDefinition } from '../../../util/DiUtil';\r\n\r\nvar LOW_PRIORITY = 500;\r\n\r\n\r\n/**\r\n * Add referenced root elements (error, escalation, message, signal) if they don't exist.\r\n * Copy referenced root elements on copy & paste.\r\n */\r\nexport default function RootElementReferenceBehavior(\r\n    bpmnjs, eventBus, injector, moddleCopy, bpmnFactory\r\n) {\r\n  injector.invoke(CommandInterceptor, this);\r\n\r\n  function canHaveRootElementReference(element) {\r\n    return isAny(element, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ]) ||\r\n      hasAnyEventDefinition(element, [\r\n        'bpmn:ErrorEventDefinition',\r\n        'bpmn:EscalationEventDefinition',\r\n        'bpmn:MessageEventDefinition',\r\n        'bpmn:SignalEventDefinition'\r\n      ]);\r\n  }\r\n\r\n  function hasRootElement(rootElement) {\r\n    var definitions = bpmnjs.getDefinitions(),\r\n        rootElements = definitions.get('rootElements');\r\n\r\n    return !!find(rootElements, matchPattern({ id: rootElement.id }));\r\n  }\r\n\r\n  function getRootElementReferencePropertyName(eventDefinition) {\r\n    if (is(eventDefinition, 'bpmn:ErrorEventDefinition')) {\r\n      return 'errorRef';\r\n    } else if (is(eventDefinition, 'bpmn:EscalationEventDefinition')) {\r\n      return 'escalationRef';\r\n    } else if (is(eventDefinition, 'bpmn:MessageEventDefinition')) {\r\n      return 'messageRef';\r\n    } else if (is(eventDefinition, 'bpmn:SignalEventDefinition')) {\r\n      return 'signalRef';\r\n    }\r\n  }\r\n\r\n  function getRootElement(businessObject) {\r\n    if (isAny(businessObject, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ])) {\r\n      return businessObject.get('messageRef');\r\n    }\r\n\r\n    var eventDefinitions = businessObject.get('eventDefinitions'),\r\n        eventDefinition = eventDefinitions[ 0 ];\r\n\r\n    return eventDefinition.get(getRootElementReferencePropertyName(eventDefinition));\r\n  }\r\n\r\n  function setRootElement(businessObject, rootElement) {\r\n    if (isAny(businessObject, [ 'bpmn:ReceiveTask', 'bpmn:SendTask' ])) {\r\n      return businessObject.set('messageRef', rootElement);\r\n    }\r\n\r\n    var eventDefinitions = businessObject.get('eventDefinitions'),\r\n        eventDefinition = eventDefinitions[ 0 ];\r\n\r\n    return eventDefinition.set(getRootElementReferencePropertyName(eventDefinition), rootElement);\r\n  }\r\n\r\n  // create shape\r\n  this.executed('shape.create', function(context) {\r\n    var shape = context.shape;\r\n\r\n    if (!canHaveRootElementReference(shape)) {\r\n      return;\r\n    }\r\n\r\n    var businessObject = getBusinessObject(shape),\r\n        rootElement = getRootElement(businessObject),\r\n        rootElements;\r\n\r\n    if (rootElement && !hasRootElement(rootElement)) {\r\n      rootElements = bpmnjs.getDefinitions().get('rootElements');\r\n\r\n      // add root element\r\n      collectionAdd(rootElements, rootElement);\r\n\r\n      context.addedRootElement = rootElement;\r\n    }\r\n  }, true);\r\n\r\n  this.reverted('shape.create', function(context) {\r\n    var addedRootElement = context.addedRootElement;\r\n\r\n    if (!addedRootElement) {\r\n      return;\r\n    }\r\n\r\n    var rootElements = bpmnjs.getDefinitions().get('rootElements');\r\n\r\n    // remove root element\r\n    collectionRemove(rootElements, addedRootElement);\r\n  }, true);\r\n\r\n  eventBus.on('copyPaste.copyElement', function(context) {\r\n    var descriptor = context.descriptor,\r\n        element = context.element;\r\n\r\n    if (!canHaveRootElementReference(element)) {\r\n      return;\r\n    }\r\n\r\n    var businessObject = getBusinessObject(element),\r\n        rootElement = getRootElement(businessObject);\r\n\r\n    if (rootElement) {\r\n      descriptor.referencedRootElement = rootElement;\r\n    }\r\n  });\r\n\r\n  eventBus.on('copyPaste.pasteElement', LOW_PRIORITY, function(context) {\r\n    var descriptor = context.descriptor,\r\n        businessObject = descriptor.businessObject;\r\n\r\n    if (!canHaveRootElementReference(businessObject)) {\r\n      return;\r\n    }\r\n\r\n    var referencedRootElement = descriptor.referencedRootElement;\r\n\r\n    if (!referencedRootElement) {\r\n      return;\r\n    }\r\n\r\n    if (!hasRootElement(referencedRootElement)) {\r\n      referencedRootElement = moddleCopy.copyElement(\r\n        referencedRootElement,\r\n        bpmnFactory.create(referencedRootElement.$type)\r\n      );\r\n    }\r\n\r\n    setRootElement(businessObject, referencedRootElement);\r\n  });\r\n}\r\n\r\nRootElementReferenceBehavior.$inject = [\r\n  'bpmnjs',\r\n  'eventBus',\r\n  'injector',\r\n  'moddleCopy',\r\n  'bpmnFactory'\r\n];\r\n\r\ninherits(RootElementReferenceBehavior, CommandInterceptor);\r\n\r\n// helpers //////////\r\n\r\nfunction hasAnyEventDefinition(element, types) {\r\n  if (!isArray(types)) {\r\n    types = [ types ];\r\n  }\r\n\r\n  return some(types, function(type) {\r\n    return hasEventDefinition(element, type);\r\n  });\r\n}","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { getParent } from '../util/ModelingUtil';\n\n\nexport default function CreateBehavior(injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute('shape.create', 1500, function(event) {\n    var context = event.context,\n        parent = context.parent,\n        shape = context.shape;\n\n    if (is(parent, 'bpmn:Lane') && !is(shape, 'bpmn:Lane')) {\n      context.parent = getParent(parent, 'bpmn:Participant');\n    }\n  });\n\n}\n\n\nCreateBehavior.$inject = [ 'injector' ];\n\ninherits(CreateBehavior, CommandInterceptor);","import { getLanesRoot } from '../util/LaneUtil';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\nvar HIGHEST_PRIORITY = 2000;\r\n\r\n\r\n/**\r\n * Correct hover targets in certain situations to improve diagram interaction.\r\n *\r\n * @param {ElementRegistry} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Canvas} canvas\r\n */\r\nexport default function FixHoverBehavior(elementRegistry, eventBus, canvas) {\r\n\r\n  eventBus.on([\r\n    'create.hover',\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.hover',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape || event.shape,\r\n        hover = event.hover;\r\n\r\n    // ensure elements are not dropped onto a bpmn:Lane but onto\r\n    // the underlying bpmn:Participant\r\n    if (is(hover, 'bpmn:Lane') && !isAny(shape, [ 'bpmn:Lane', 'bpmn:Participant' ])) {\r\n      event.hover = getLanesRoot(hover);\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n\r\n    var rootElement = canvas.getRootElement();\r\n\r\n    // ensure bpmn:Group and label elements are dropped\r\n    // always onto the root\r\n    if (hover !== rootElement && (shape.labelTarget || is(shape, 'bpmn:Group'))) {\r\n      event.hover = rootElement;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.out',\r\n    'connect.end',\r\n    'connect.cleanup',\r\n    'global-connect.hover',\r\n    'global-connect.out',\r\n    'global-connect.end',\r\n    'global-connect.cleanup'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var hover = event.hover;\r\n\r\n    // ensure connections start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane')) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'bendpoint.move.hover'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        hover = event.hover,\r\n        type = context.type;\r\n\r\n    // ensure reconnect start/end on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(hover, 'bpmn:Lane') && /reconnect/.test(type)) {\r\n      event.hover = getLanesRoot(hover) || hover;\r\n      event.hoverGfx = elementRegistry.getGraphics(event.hover);\r\n    }\r\n  });\r\n\r\n\r\n  eventBus.on([\r\n    'connect.start'\r\n  ], HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        start = context.start;\r\n\r\n    // ensure connect start on bpmn:Participant,\r\n    // not the underlying bpmn:Lane\r\n    if (is(start, 'bpmn:Lane')) {\r\n      context.start = getLanesRoot(start) || start;\r\n    }\r\n  });\r\n\r\n\r\n  // allow movement of participants from lanes\r\n  eventBus.on('shape.move.start', HIGHEST_PRIORITY, function(event) {\r\n    var shape = event.shape;\r\n\r\n    if (is(shape, 'bpmn:Lane')) {\r\n      event.shape = getLanesRoot(shape) || shape;\r\n    }\r\n  });\r\n\r\n}\r\n\r\nFixHoverBehavior.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'canvas'\r\n];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * BPMN specific create data object behavior\n */\nexport default function CreateDataObjectBehavior(eventBus, bpmnFactory, moddle) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this.preExecute('shape.create', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:DataObjectReference') && shape.type !== 'label') {\n\n      // create a DataObject every time a DataObjectReference is created\n      var dataObject = bpmnFactory.create('bpmn:DataObject');\n\n      // set the reference to the DataObject\n      shape.businessObject.dataObjectRef = dataObject;\n    }\n  });\n\n}\n\nCreateDataObjectBehavior.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'moddle'\n];\n\ninherits(CreateDataObjectBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nimport { getBBox } from 'diagram-js/lib/util/Elements';\n\nimport {\n  assign,\n  find\n} from 'min-dash';\n\nimport { asTRBL } from 'diagram-js/lib/layout/LayoutUtil';\n\nvar HORIZONTAL_PARTICIPANT_PADDING = 20,\n    VERTICAL_PARTICIPANT_PADDING = 20;\n\nexport var PARTICIPANT_BORDER_WIDTH = 30;\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * BPMN-specific behavior for creating participants.\n */\nexport default function CreateParticipantBehavior(canvas, eventBus, modeling) {\n  CommandInterceptor.call(this, eventBus);\n\n  // fit participant\n  eventBus.on([\n    'create.start',\n    'shape.move.start'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement();\n\n    if (!is(shape, 'bpmn:Participant') ||\n      !is(rootElement, 'bpmn:Process') ||\n      !rootElement.children.length) {\n      return;\n    }\n\n    // ignore connections, groups and labels\n    var children = rootElement.children.filter(function(element) {\n      return !is(element, 'bpmn:Group') &&\n        !isLabel(element) &&\n        !isConnection(element);\n    });\n\n    // ensure for available children to calculate bounds\n    if (!children.length) {\n      return;\n    }\n\n    var childrenBBox = getBBox(children);\n\n    var participantBounds = getParticipantBounds(shape, childrenBBox);\n\n    // assign width and height\n    assign(shape, participantBounds);\n\n    // assign create constraints\n    context.createConstraints = getParticipantCreateConstraints(shape, childrenBBox);\n  });\n\n  // force hovering process when creating first participant\n  eventBus.on('create.start', HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        rootElement = canvas.getRootElement(),\n        rootElementGfx = canvas.getGraphics(rootElement);\n\n    function ensureHoveringProcess(event) {\n      event.element = rootElement;\n      event.gfx = rootElementGfx;\n    }\n\n    if (is(shape, 'bpmn:Participant') && is(rootElement, 'bpmn:Process')) {\n      eventBus.on('element.hover', HIGH_PRIORITY, ensureHoveringProcess);\n\n      eventBus.once('create.cleanup', function() {\n        eventBus.off('element.hover', ensureHoveringProcess);\n      });\n    }\n  });\n\n  function ensureCollaboration(context) {\n    var parent = context.parent,\n        collaboration;\n\n    var rootElement = canvas.getRootElement();\n\n    if (is(rootElement, 'bpmn:Collaboration')) {\n      collaboration = rootElement;\n    } else {\n\n      // update root element by making collaboration\n      collaboration = modeling.makeCollaboration();\n\n      // re-use process when creating first participant\n      context.process = parent;\n    }\n\n    context.parent = collaboration;\n  }\n\n  // turn process into collaboration before adding participant\n  this.preExecute('shape.create', function(context) {\n    var parent = context.parent,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Participant') && is(parent, 'bpmn:Process')) {\n      ensureCollaboration(context);\n    }\n  }, true);\n\n  this.execute('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n      context.oldProcessRef = shape.businessObject.processRef;\n\n      // re-use process when creating first participant\n      shape.businessObject.processRef = process.businessObject;\n    }\n  }, true);\n\n  this.revert('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n\n      // re-use process when creating first participant\n      shape.businessObject.processRef = context.oldProcessRef;\n    }\n  }, true);\n\n  this.postExecute('shape.create', function(context) {\n    var process = context.process,\n        shape = context.shape;\n\n    if (process) {\n\n      // move children from process to participant\n      var processChildren = process.children.slice();\n\n      modeling.moveElements(processChildren, { x: 0, y: 0 }, shape);\n    }\n\n  }, true);\n\n  // turn process into collaboration when creating participants\n  this.preExecute('elements.create', HIGH_PRIORITY, function(context) {\n    var elements = context.elements,\n        parent = context.parent,\n        participant;\n\n    var hasParticipants = findParticipant(elements);\n\n    if (hasParticipants && is(parent, 'bpmn:Process')) {\n      ensureCollaboration(context);\n\n      participant = findParticipant(elements);\n\n      context.oldProcessRef = participant.businessObject.processRef;\n\n      // re-use process when creating first participant\n      participant.businessObject.processRef = parent.businessObject;\n    }\n  }, true);\n\n  this.revert('elements.create', function(context) {\n    var elements = context.elements,\n        process = context.process,\n        participant;\n\n    if (process) {\n      participant = findParticipant(elements);\n\n      // re-use process when creating first participant\n      participant.businessObject.processRef = context.oldProcessRef;\n    }\n  }, true);\n\n  this.postExecute('elements.create', function(context) {\n    var elements = context.elements,\n        process = context.process,\n        participant;\n\n    if (process) {\n      participant = findParticipant(elements);\n\n      // move children from process to first participant\n      var processChildren = process.children.slice();\n\n      modeling.moveElements(processChildren, { x: 0, y: 0 }, participant);\n    }\n\n  }, true);\n\n}\n\nCreateParticipantBehavior.$inject = [\n  'canvas',\n  'eventBus',\n  'modeling'\n];\n\ninherits(CreateParticipantBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getParticipantBounds(shape, childrenBBox) {\n  childrenBBox = {\n    width: childrenBBox.width + HORIZONTAL_PARTICIPANT_PADDING * 2 + PARTICIPANT_BORDER_WIDTH,\n    height: childrenBBox.height + VERTICAL_PARTICIPANT_PADDING * 2\n  };\n\n  var width = Math.max(shape.width, childrenBBox.width),\n      height = Math.max(shape.height, childrenBBox.height);\n\n  return {\n    x: -width / 2,\n    y: -height / 2,\n    width: width,\n    height: height\n  };\n}\n\nfunction getParticipantCreateConstraints(shape, childrenBBox) {\n  childrenBBox = asTRBL(childrenBBox);\n\n  return {\n    bottom: childrenBBox.top + shape.height / 2 - VERTICAL_PARTICIPANT_PADDING,\n    left: childrenBBox.right - shape.width / 2 + HORIZONTAL_PARTICIPANT_PADDING,\n    top: childrenBBox.bottom - shape.height / 2 + VERTICAL_PARTICIPANT_PADDING,\n    right: childrenBBox.left + shape.width / 2 - HORIZONTAL_PARTICIPANT_PADDING - PARTICIPANT_BORDER_WIDTH\n  };\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction findParticipant(elements) {\n  return find(elements, function(element) {\n    return is(element, 'bpmn:Participant');\n  });\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  find\n} from 'min-dash';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar TARGET_REF_PLACEHOLDER_NAME = '__targetRef_placeholder';\n\n\n/**\n * This behavior makes sure we always set a fake\n * DataInputAssociation#targetRef as demanded by the BPMN 2.0\n * XSD schema.\n *\n * The reference is set to a bpmn:Property{ name: '__targetRef_placeholder' }\n * which is created on the fly and cleaned up afterwards if not needed\n * anymore.\n *\n * @param {EventBus} eventBus\n * @param {BpmnFactory} bpmnFactory\n */\nexport default function DataInputAssociationBehavior(eventBus, bpmnFactory) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  this.executed([\n    'connection.create',\n    'connection.delete',\n    'connection.move',\n    'connection.reconnect'\n  ], ifDataInputAssociation(fixTargetRef));\n\n  this.reverted([\n    'connection.create',\n    'connection.delete',\n    'connection.move',\n    'connection.reconnect'\n  ], ifDataInputAssociation(fixTargetRef));\n\n\n  function usesTargetRef(element, targetRef, removedConnection) {\n\n    var inputAssociations = element.get('dataInputAssociations');\n\n    return find(inputAssociations, function(association) {\n      return association !== removedConnection &&\n             association.targetRef === targetRef;\n    });\n  }\n\n  function getTargetRef(element, create) {\n\n    var properties = element.get('properties');\n\n    var targetRefProp = find(properties, function(p) {\n      return p.name === TARGET_REF_PLACEHOLDER_NAME;\n    });\n\n    if (!targetRefProp && create) {\n      targetRefProp = bpmnFactory.create('bpmn:Property', {\n        name: TARGET_REF_PLACEHOLDER_NAME\n      });\n\n      collectionAdd(properties, targetRefProp);\n    }\n\n    return targetRefProp;\n  }\n\n  function cleanupTargetRef(element, connection) {\n\n    var targetRefProp = getTargetRef(element);\n\n    if (!targetRefProp) {\n      return;\n    }\n\n    if (!usesTargetRef(element, targetRefProp, connection)) {\n      collectionRemove(element.get('properties'), targetRefProp);\n    }\n  }\n\n  /**\n   * Make sure targetRef is set to a valid property or\n   * `null` if the connection is detached.\n   *\n   * @param {Event} event\n   */\n  function fixTargetRef(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        connectionBo = connection.businessObject,\n        target = connection.target,\n        targetBo = target && target.businessObject,\n        newTarget = context.newTarget,\n        newTargetBo = newTarget && newTarget.businessObject,\n        oldTarget = context.oldTarget || context.target,\n        oldTargetBo = oldTarget && oldTarget.businessObject;\n\n    var dataAssociation = connection.businessObject,\n        targetRefProp;\n\n    if (oldTargetBo && oldTargetBo !== targetBo) {\n      cleanupTargetRef(oldTargetBo, connectionBo);\n    }\n\n    if (newTargetBo && newTargetBo !== targetBo) {\n      cleanupTargetRef(newTargetBo, connectionBo);\n    }\n\n    if (targetBo) {\n      targetRefProp = getTargetRef(targetBo, true);\n      dataAssociation.targetRef = targetRefProp;\n    } else {\n      dataAssociation.targetRef = null;\n    }\n  }\n}\n\nDataInputAssociationBehavior.$inject = [\n  'eventBus',\n  'bpmnFactory'\n];\n\ninherits(DataInputAssociationBehavior, CommandInterceptor);\n\n\n/**\n * Only call the given function when the event\n * touches a bpmn:DataInputAssociation.\n *\n * @param {Function} fn\n * @return {Function}\n */\nfunction ifDataInputAssociation(fn) {\n\n  return function(event) {\n    var context = event.context,\n        connection = context.connection;\n\n    if (is(connection, 'bpmn:DataInputAssociation')) {\n      return fn(event);\n    }\n  };\n}","export default function UpdateSemanticParentHandler(bpmnUpdater) {\r\n  this._bpmnUpdater = bpmnUpdater;\r\n}\r\n\r\nUpdateSemanticParentHandler.$inject = [ 'bpmnUpdater' ];\r\n\r\n\r\nUpdateSemanticParentHandler.prototype.execute = function(context) {\r\n  var dataStoreBo = context.dataStoreBo,\r\n      newSemanticParent = context.newSemanticParent,\r\n      newDiParent = context.newDiParent;\r\n\r\n  context.oldSemanticParent = dataStoreBo.$parent;\r\n  context.oldDiParent = dataStoreBo.di.$parent;\r\n\r\n  // update semantic parent\r\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, newSemanticParent);\r\n\r\n  // update DI parent\r\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, newDiParent);\r\n};\r\n\r\nUpdateSemanticParentHandler.prototype.revert = function(context) {\r\n  var dataStoreBo = context.dataStoreBo,\r\n      oldSemanticParent = context.oldSemanticParent,\r\n      oldDiParent = context.oldDiParent;\r\n\r\n  // update semantic parent\r\n  this._bpmnUpdater.updateSemanticParent(dataStoreBo, oldSemanticParent);\r\n\r\n  // update DI parent\r\n  this._bpmnUpdater.updateDiParent(dataStoreBo.di, oldDiParent);\r\n};\r\n\r\n","import inherits from 'inherits';\r\n\r\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isAny } from '../util/ModelingUtil';\r\n\r\nimport UpdateSemanticParentHandler from '../cmd/UpdateSemanticParentHandler';\r\n\r\n\r\n/**\r\n * BPMN specific data store behavior\r\n */\r\nexport default function DataStoreBehavior(\r\n    canvas, commandStack, elementRegistry,\r\n    eventBus) {\r\n\r\n  CommandInterceptor.call(this, eventBus);\r\n\r\n  commandStack.registerHandler('dataStore.updateContainment', UpdateSemanticParentHandler);\r\n\r\n  function getFirstParticipant() {\r\n    return elementRegistry.filter(function(element) {\r\n      return is(element, 'bpmn:Participant');\r\n    })[0];\r\n  }\r\n\r\n  function getDataStores(element) {\r\n    return element.children.filter(function(child) {\r\n      return is(child, 'bpmn:DataStoreReference') && !child.labelTarget;\r\n    });\r\n  }\r\n\r\n  function updateDataStoreParent(dataStore, newDataStoreParent) {\r\n    var dataStoreBo = dataStore.businessObject || dataStore;\r\n\r\n    newDataStoreParent = newDataStoreParent || getFirstParticipant();\r\n\r\n    if (newDataStoreParent) {\r\n      var newDataStoreParentBo = newDataStoreParent.businessObject || newDataStoreParent;\r\n\r\n      commandStack.execute('dataStore.updateContainment', {\r\n        dataStoreBo: dataStoreBo,\r\n        newSemanticParent: newDataStoreParentBo.processRef || newDataStoreParentBo,\r\n        newDiParent: newDataStoreParentBo.di\r\n      });\r\n    }\r\n  }\r\n\r\n\r\n  // disable auto-resize for data stores\r\n  this.preExecute('shape.create', function(event) {\r\n\r\n    var context = event.context,\r\n        shape = context.shape;\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label') {\r\n\r\n      if (!context.hints) {\r\n        context.hints = {};\r\n      }\r\n\r\n      // prevent auto resizing\r\n      context.hints.autoResize = false;\r\n    }\r\n  });\r\n\r\n\r\n  // disable auto-resize for data stores\r\n  this.preExecute('elements.move', function(event) {\r\n    var context = event.context,\r\n        shapes = context.shapes;\r\n\r\n    var dataStoreReferences = shapes.filter(function(shape) {\r\n      return is(shape, 'bpmn:DataStoreReference');\r\n    });\r\n\r\n    if (dataStoreReferences.length) {\r\n      if (!context.hints) {\r\n        context.hints = {};\r\n      }\r\n\r\n      // prevent auto resizing for data store references\r\n      context.hints.autoResize = shapes.filter(function(shape) {\r\n        return !is(shape, 'bpmn:DataStoreReference');\r\n      });\r\n    }\r\n  });\r\n\r\n\r\n  // update parent on data store created\r\n  this.postExecute('shape.create', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent;\r\n\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label' &&\r\n        is(parent, 'bpmn:Collaboration')) {\r\n\r\n      updateDataStoreParent(shape);\r\n    }\r\n  });\r\n\r\n\r\n  // update parent on data store moved\r\n  this.postExecute('shape.move', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        oldParent = context.oldParent,\r\n        parent = shape.parent;\r\n\r\n    if (is(oldParent, 'bpmn:Collaboration')) {\r\n\r\n      // do nothing if not necessary\r\n      return;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:DataStoreReference') &&\r\n        shape.type !== 'label' &&\r\n        is(parent, 'bpmn:Collaboration')) {\r\n\r\n      var participant = is(oldParent, 'bpmn:Participant') ?\r\n        oldParent :\r\n        getAncestor(oldParent, 'bpmn:Participant');\r\n\r\n      updateDataStoreParent(shape, participant);\r\n    }\r\n  });\r\n\r\n\r\n  // update data store parents on participant or subprocess deleted\r\n  this.postExecute('shape.delete', function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        rootElement = canvas.getRootElement();\r\n\r\n    if (isAny(shape, [ 'bpmn:Participant', 'bpmn:SubProcess' ])\r\n        && is(rootElement, 'bpmn:Collaboration')) {\r\n      getDataStores(rootElement)\r\n        .filter(function(dataStore) {\r\n          return isDescendant(dataStore, shape);\r\n        })\r\n        .forEach(function(dataStore) {\r\n          updateDataStoreParent(dataStore);\r\n        });\r\n    }\r\n  });\r\n\r\n  // update data store parents on collaboration -> process\r\n  this.postExecute('canvas.updateRoot', function(event) {\r\n    var context = event.context,\r\n        oldRoot = context.oldRoot,\r\n        newRoot = context.newRoot;\r\n\r\n    var dataStores = getDataStores(oldRoot);\r\n\r\n    dataStores.forEach(function(dataStore) {\r\n\r\n      if (is(newRoot, 'bpmn:Process')) {\r\n        updateDataStoreParent(dataStore, newRoot);\r\n      }\r\n\r\n    });\r\n  });\r\n}\r\n\r\nDataStoreBehavior.$inject = [\r\n  'canvas',\r\n  'commandStack',\r\n  'elementRegistry',\r\n  'eventBus',\r\n];\r\n\r\ninherits(DataStoreBehavior, CommandInterceptor);\r\n\r\n\r\n// helpers //////////\r\n\r\nfunction isDescendant(descendant, ancestor) {\r\n  var descendantBo = descendant.businessObject || descendant,\r\n      ancestorBo = ancestor.businessObject || ancestor;\r\n\r\n  while (descendantBo.$parent) {\r\n    if (descendantBo.$parent === ancestorBo.processRef || ancestorBo) {\r\n      return true;\r\n    }\r\n\r\n    descendantBo = descendantBo.$parent;\r\n  }\r\n\r\n  return false;\r\n}\r\n\r\nfunction getAncestor(element, type) {\r\n\r\n  while (element.parent) {\r\n    if (is(element.parent, type)) {\r\n      return element.parent;\r\n    }\r\n\r\n    element = element.parent;\r\n  }\r\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport {\n  getChildLanes\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function DeleteLaneBehavior(eventBus, modeling, spaceTool) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function compensateLaneDelete(shape, oldParent) {\n\n    var siblings = getChildLanes(oldParent);\n\n    var topAffected = [];\n    var bottomAffected = [];\n\n    eachElement(siblings, function(element) {\n\n      if (element.y > shape.y) {\n        bottomAffected.push(element);\n      } else {\n        topAffected.push(element);\n      }\n\n      return element.children;\n    });\n\n    if (!siblings.length) {\n      return;\n    }\n\n    var offset;\n\n    if (bottomAffected.length && topAffected.length) {\n      offset = shape.height / 2;\n    } else {\n      offset = shape.height;\n    }\n\n    var topAdjustments,\n        bottomAdjustments;\n\n    if (topAffected.length) {\n      topAdjustments = spaceTool.calculateAdjustments(\n        topAffected, 'y', offset, shape.y - 10);\n\n      spaceTool.makeSpace(\n        topAdjustments.movingShapes,\n        topAdjustments.resizingShapes,\n        { x: 0, y: offset }, 's');\n    }\n\n    if (bottomAffected.length) {\n      bottomAdjustments = spaceTool.calculateAdjustments(\n        bottomAffected, 'y', -offset, shape.y + shape.height + 10);\n\n      spaceTool.makeSpace(\n        bottomAdjustments.movingShapes,\n        bottomAdjustments.resizingShapes,\n        { x: 0, y: -offset }, 'n');\n    }\n  }\n\n\n  /**\n   * Adjust sizes of other lanes after lane deletion\n   */\n  this.postExecuted('shape.delete', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        hints = context.hints,\n        shape = context.shape,\n        oldParent = context.oldParent;\n\n    // only compensate lane deletes\n    if (!is(shape, 'bpmn:Lane')) {\n      return;\n    }\n\n    // compensate root deletes only\n    if (hints && hints.nested) {\n      return;\n    }\n\n    compensateLaneDelete(shape, oldParent);\n  });\n}\n\nDeleteLaneBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'spaceTool'\n];\n\ninherits(DeleteLaneBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport { isLabel } from '../../../util/LabelUtil';\n\nvar LOW_PRIORITY = 500;\n\n\n/**\n * Replace boundary event with intermediate event when creating or moving results in detached event.\n */\nexport default function DetachEventBehavior(bpmnReplace, injector) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n\n  var self = this;\n\n  this.postExecuted('elements.create', LOW_PRIORITY, function(context) {\n    var elements = context.elements;\n\n    elements.filter(function(shape) {\n      var host = shape.host;\n\n      return shouldReplace(shape, host);\n    }).map(function(shape) {\n      return elements.indexOf(shape);\n    }).forEach(function(index) {\n      context.elements[ index ] = self.replaceShape(elements[ index ]);\n    });\n  }, true);\n\n  this.preExecute('elements.move', LOW_PRIORITY, function(context) {\n    var shapes = context.shapes,\n        newHost = context.newHost;\n\n    shapes.forEach(function(shape, index) {\n      var host = shape.host;\n\n      if (shouldReplace(shape, includes(shapes, host) ? host : newHost)) {\n        shapes[ index ] = self.replaceShape(shape);\n      }\n    });\n  }, true);\n}\n\nDetachEventBehavior.$inject = [\n  'bpmnReplace',\n  'injector'\n];\n\ninherits(DetachEventBehavior, CommandInterceptor);\n\nDetachEventBehavior.prototype.replaceShape = function(shape) {\n  var eventDefinition = getEventDefinition(shape),\n      intermediateEvent;\n\n  if (eventDefinition) {\n    intermediateEvent = {\n      type: 'bpmn:IntermediateCatchEvent',\n      eventDefinitionType: eventDefinition.$type\n    };\n  } else {\n    intermediateEvent = {\n      type: 'bpmn:IntermediateThrowEvent'\n    };\n  }\n\n  return this._bpmnReplace.replaceElement(shape, intermediateEvent, { layoutConnection: false });\n};\n\n\n// helpers //////////\n\nfunction getEventDefinition(element) {\n  var businessObject = getBusinessObject(element),\n      eventDefinitions = businessObject.eventDefinitions;\n\n  return eventDefinitions && eventDefinitions[0];\n}\n\nfunction shouldReplace(shape, host) {\n  return !isLabel(shape) && is(shape, 'bpmn:BoundaryEvent') && !host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import inherits from 'inherits';\n\nimport {\n  assign,\n  filter,\n  find,\n  isNumber\n} from 'min-dash';\n\nimport { getMid } from 'diagram-js/lib/layout/LayoutUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getApproxIntersection\n} from 'diagram-js/lib/util/LineIntersection';\n\n\nexport default function DropOnFlowBehavior(eventBus, bpmnRules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Reconnect start / end of a connection after\n   * dropping an element on a flow.\n   */\n\n  function insertShape(shape, targetFlow, positionOrBounds) {\n    var waypoints = targetFlow.waypoints,\n        waypointsBefore,\n        waypointsAfter,\n        dockingPoint,\n        source,\n        target,\n        incomingConnection,\n        outgoingConnection,\n        oldOutgoing = shape.outgoing.slice(),\n        oldIncoming = shape.incoming.slice();\n\n    var mid;\n\n    if (isNumber(positionOrBounds.width)) {\n      mid = getMid(positionOrBounds);\n    } else {\n      mid = positionOrBounds;\n    }\n\n    var intersection = getApproxIntersection(waypoints, mid);\n\n    if (intersection) {\n      waypointsBefore = waypoints.slice(0, intersection.index);\n      waypointsAfter = waypoints.slice(intersection.index + (intersection.bendpoint ? 1 : 0));\n\n      // due to inaccuracy intersection might have been found\n      if (!waypointsBefore.length || !waypointsAfter.length) {\n        return;\n      }\n\n      dockingPoint = intersection.bendpoint ? waypoints[intersection.index] : mid;\n\n      // if last waypointBefore is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsBefore[waypointsBefore.length-1])) {\n        waypointsBefore.push(copy(dockingPoint));\n      }\n\n      // if first waypointAfter is inside shape's bounds, ignore docking point\n      if (!isPointInsideBBox(shape, waypointsAfter[0])) {\n        waypointsAfter.unshift(copy(dockingPoint));\n      }\n    }\n\n    source = targetFlow.source;\n    target = targetFlow.target;\n\n    if (bpmnRules.canConnect(source, shape, targetFlow)) {\n\n      // reconnect source -> inserted shape\n      modeling.reconnectEnd(targetFlow, shape, waypointsBefore || mid);\n\n      incomingConnection = targetFlow;\n    }\n\n    if (bpmnRules.canConnect(shape, target, targetFlow)) {\n\n      if (!incomingConnection) {\n\n        // reconnect inserted shape -> end\n        modeling.reconnectStart(targetFlow, shape, waypointsAfter || mid);\n\n        outgoingConnection = targetFlow;\n      } else {\n        outgoingConnection = modeling.connect(\n          shape, target, { type: targetFlow.type, waypoints: waypointsAfter }\n        );\n      }\n    }\n\n    var duplicateConnections = [].concat(\n\n      incomingConnection && filter(oldIncoming, function(connection) {\n        return connection.source === incomingConnection.source;\n      }) || [],\n\n      outgoingConnection && filter(oldOutgoing, function(connection) {\n        return connection.target === outgoingConnection.target;\n      }) || []\n    );\n\n    if (duplicateConnections.length) {\n      modeling.removeElements(duplicateConnections);\n    }\n  }\n\n  this.preExecute('elements.move', function(context) {\n\n    var newParent = context.newParent,\n        shapes = context.shapes,\n        delta = context.delta,\n        shape = shapes[0];\n\n    if (!shape || !newParent) {\n      return;\n    }\n\n    // if the new parent is a connection,\n    // change it to the new parent's parent\n    if (newParent && newParent.waypoints) {\n      context.newParent = newParent = newParent.parent;\n    }\n\n    var shapeMid = getMid(shape);\n    var newShapeMid = {\n      x: shapeMid.x + delta.x,\n      y: shapeMid.y + delta.y\n    };\n\n    // find a connection which intersects with the\n    // element's mid point\n    var connection = find(newParent.children, function(element) {\n      var canInsert = bpmnRules.canInsert(shapes, element);\n\n      return canInsert && getApproxIntersection(element.waypoints, newShapeMid);\n    });\n\n    if (connection) {\n      context.targetFlow = connection;\n      context.position = newShapeMid;\n    }\n\n  }, true);\n\n  this.postExecuted('elements.move', function(context) {\n\n    var shapes = context.shapes,\n        targetFlow = context.targetFlow,\n        position = context.position;\n\n    if (targetFlow) {\n      insertShape(shapes[0], targetFlow, position);\n    }\n\n  }, true);\n\n  this.preExecute('shape.create', function(context) {\n\n    var parent = context.parent,\n        shape = context.shape;\n\n    if (bpmnRules.canInsert(shape, parent)) {\n      context.targetFlow = parent;\n      context.parent = parent.parent;\n    }\n  }, true);\n\n  this.postExecuted('shape.create', function(context) {\n\n    var shape = context.shape,\n        targetFlow = context.targetFlow,\n        positionOrBounds = context.position;\n\n    if (targetFlow) {\n      insertShape(shape, targetFlow, positionOrBounds);\n    }\n  }, true);\n}\n\ninherits(DropOnFlowBehavior, CommandInterceptor);\n\nDropOnFlowBehavior.$inject = [\n  'eventBus',\n  'bpmnRules',\n  'modeling'\n];\n\n\n// helpers /////////////////////\n\nfunction isPointInsideBBox(bbox, point) {\n  var x = point.x,\n      y = point.y;\n\n  return x >= bbox.x &&\n    x <= bbox.x + bbox.width &&\n    y >= bbox.y &&\n    y <= bbox.y + bbox.height;\n}\n\nfunction copy(obj) {\n  return assign({}, obj);\n}\n\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\nexport default function EventBasedGatewayBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Remove existing sequence flows of event-based target before connecting\n   * from event-based gateway.\n   */\n  this.preExecuted('connection.create', function(event) {\n\n    var context = event.context,\n        source = context.source,\n        target = context.target,\n        existingIncomingConnections = target.incoming.slice();\n\n    if (context.hints && context.hints.createElementsBehavior === false) {\n      return;\n    }\n\n    if (\n      is(source, 'bpmn:EventBasedGateway') &&\n      target.incoming.length\n    ) {\n\n      existingIncomingConnections.filter(isSequenceFlow)\n        .forEach(function(sequenceFlow) {\n          modeling.removeConnection(sequenceFlow);\n        });\n    }\n  });\n\n  /**\n   *  After replacing shape with event-based gateway, remove incoming sequence\n   *  flows of event-based targets which do not belong to event-based gateway\n   *  source.\n   */\n  this.preExecuted('shape.replace', function(event) {\n\n    var newShape = event.context.newShape,\n        newShapeTargets,\n        newShapeTargetsIncomingSequenceFlows;\n\n    if (!is(newShape, 'bpmn:EventBasedGateway')) {\n      return;\n    }\n\n    newShapeTargets = newShape.outgoing.filter(isSequenceFlow)\n      .map(function(sequenceFlow) {\n        return sequenceFlow.target;\n      });\n\n    newShapeTargetsIncomingSequenceFlows = newShapeTargets.reduce(function(sequenceFlows, target) {\n      var incomingSequenceFlows = target.incoming.filter(isSequenceFlow);\n\n      return sequenceFlows.concat(incomingSequenceFlows);\n    }, []);\n\n    newShapeTargetsIncomingSequenceFlows.forEach(function(sequenceFlow) {\n      if (sequenceFlow.source !== newShape) {\n        modeling.removeConnection(sequenceFlow);\n      }\n    });\n  });\n}\n\nEventBasedGatewayBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\ninherits(EventBasedGatewayBehavior, CommandInterceptor);\n\n\n\n// helpers //////////////////////\n\nfunction isSequenceFlow(connection) {\n  return is(connection, 'bpmn:SequenceFlow');\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  createCategoryValue\n} from './util/CategoryUtil';\n\nvar HIGH_PRIORITY = 2000;\n\n\n/**\n * BPMN specific Group behavior\n */\nexport default function GroupBehavior(\n    bpmnFactory,\n    canvas,\n    elementRegistry,\n    eventBus,\n    injector,\n    moddleCopy\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  /**\n   * Gets process definitions\n   *\n   * @return {ModdleElement} definitions\n   */\n  function getDefinitions() {\n    var rootElement = canvas.getRootElement(),\n        businessObject = getBusinessObject(rootElement);\n\n    return businessObject.$parent;\n  }\n\n  /**\n   * Removes a referenced category value for a given group shape\n   *\n   * @param {djs.model.Shape} shape\n   */\n  function removeReferencedCategoryValue(shape) {\n\n    var businessObject = getBusinessObject(shape),\n        categoryValue = businessObject.categoryValueRef;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    var category = categoryValue.$parent;\n\n    if (!categoryValue) {\n      return;\n    }\n\n    collectionRemove(category.categoryValue, categoryValue);\n\n    // cleanup category if it is empty\n    if (category && !category.categoryValue.length) {\n      removeCategory(category);\n    }\n  }\n\n  /**\n   * Removes a given category from the definitions\n   *\n   * @param {ModdleElement} category\n   */\n  function removeCategory(category) {\n\n    var definitions = getDefinitions();\n\n    collectionRemove(definitions.get('rootElements'), category);\n  }\n\n  /**\n   * Returns all group element in the current registry\n   *\n   * @return {Array<djs.model.shape>} a list of group shapes\n   */\n  function getGroupElements() {\n    return elementRegistry.filter(function(e) {\n      return is(e, 'bpmn:Group');\n    });\n  }\n\n  /**\n   * Returns true if given categoryValue is referenced in one of the given elements\n   *\n   * @param {Array<djs.model.shape>} elements\n   * @param {ModdleElement} categoryValue\n   * @return {Boolean}\n   */\n  function isReferenced(elements, categoryValue) {\n    return elements.some(function(e) {\n\n      var businessObject = getBusinessObject(e);\n\n      return businessObject.categoryValueRef\n        && businessObject.categoryValueRef === categoryValue;\n    });\n  }\n\n  /**\n   * remove referenced category + value when group was deleted\n   */\n  this.executed('shape.delete', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n\n      var businessObject = getBusinessObject(shape),\n          categoryValueRef = businessObject.categoryValueRef,\n          groupElements = getGroupElements();\n\n      if (!isReferenced(groupElements, categoryValueRef)) {\n        removeReferencedCategoryValue(shape);\n      }\n    }\n  });\n\n  /**\n   * re-attach removed category\n   */\n  this.reverted('shape.delete', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n\n      var businessObject = getBusinessObject(shape),\n          categoryValueRef = businessObject.categoryValueRef,\n          definitions = getDefinitions(),\n          category = categoryValueRef ? categoryValueRef.$parent : null;\n\n      collectionAdd(category.get('categoryValue'), categoryValueRef);\n      collectionAdd(definitions.get('rootElements'), category);\n    }\n  });\n\n  /**\n   * create new category + value when group was created\n   */\n  this.execute('shape.create', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        businessObject = getBusinessObject(shape);\n\n    if (is(businessObject, 'bpmn:Group') && !businessObject.categoryValueRef) {\n\n      var definitions = getDefinitions(),\n          categoryValue = createCategoryValue(definitions, bpmnFactory);\n\n      // link the reference to the Group\n      businessObject.categoryValueRef = categoryValue;\n    }\n  });\n\n\n  this.revert('shape.create', function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Group')) {\n      removeReferencedCategoryValue(shape);\n\n      delete getBusinessObject(shape).categoryValueRef;\n\n    }\n  });\n\n  // copy bpmn:CategoryValue when copying element\n  eventBus.on('moddleCopy.canCopyProperty', HIGH_PRIORITY, function(context) {\n    var property = context.property,\n        categoryValue;\n\n    if (is(property, 'bpmn:CategoryValue')) {\n      categoryValue = createCategoryValue(getDefinitions(), bpmnFactory);\n\n      // return copy of category\n      return moddleCopy.copyElement(property, categoryValue);\n    }\n  });\n\n}\n\nGroupBehavior.$inject = [\n  'bpmnFactory',\n  'canvas',\n  'elementRegistry',\n  'eventBus',\n  'injector',\n  'moddleCopy'\n];\n\ninherits(GroupBehavior, CommandInterceptor);","/**\n * Returns the intersection between two line segments a and b.\n *\n * @param {Point} l1s\n * @param {Point} l1e\n * @param {Point} l2s\n * @param {Point} l2e\n *\n * @return {Point}\n */\nexport default function lineIntersect(l1s, l1e, l2s, l2e) {\n\n  // if the lines intersect, the result contains the x and y of the\n  // intersection (treating the lines as infinite) and booleans for\n  // whether line segment 1 or line segment 2 contain the point\n  var denominator, a, b, c, numerator;\n\n  denominator = ((l2e.y - l2s.y) * (l1e.x - l1s.x)) - ((l2e.x - l2s.x) * (l1e.y - l1s.y));\n\n  if (denominator == 0) {\n    return null;\n  }\n\n  a = l1s.y - l2s.y;\n  b = l1s.x - l2s.x;\n  numerator = ((l2e.x - l2s.x) * a) - ((l2e.y - l2s.y) * b);\n\n  c = numerator / denominator;\n\n  // if we cast these lines infinitely in\n  // both directions, they intersect here\n  return {\n    x: Math.round(l1s.x + (c * (l1e.x - l1s.x))),\n    y: Math.round(l1s.y + (c * (l1e.y - l1s.y)))\n  };\n}","import {\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport lineIntersect from './util/LineIntersect';\n\n\n/**\n * Fix broken dockings after DI imports.\n *\n * @param {EventBus} eventBus\n */\nexport default function ImportDockingFix(eventBus) {\n\n  function adjustDocking(startPoint, nextPoint, elementMid) {\n\n    var elementTop = {\n      x: elementMid.x,\n      y: elementMid.y - 50\n    };\n\n    var elementLeft = {\n      x: elementMid.x - 50,\n      y: elementMid.y\n    };\n\n    var verticalIntersect = lineIntersect(startPoint, nextPoint, elementMid, elementTop),\n        horizontalIntersect = lineIntersect(startPoint, nextPoint, elementMid, elementLeft);\n\n    // original is horizontal or vertical center cross intersection\n    var centerIntersect;\n\n    if (verticalIntersect && horizontalIntersect) {\n      if (getDistance(verticalIntersect, elementMid) > getDistance(horizontalIntersect, elementMid)) {\n        centerIntersect = horizontalIntersect;\n      } else {\n        centerIntersect = verticalIntersect;\n      }\n    } else {\n      centerIntersect = verticalIntersect || horizontalIntersect;\n    }\n\n    startPoint.original = centerIntersect;\n  }\n\n  function fixDockings(connection) {\n    var waypoints = connection.waypoints;\n\n    adjustDocking(\n      waypoints[0],\n      waypoints[1],\n      getMid(connection.source)\n    );\n\n    adjustDocking(\n      waypoints[waypoints.length - 1],\n      waypoints[waypoints.length - 2],\n      getMid(connection.target)\n    );\n  }\n\n  eventBus.on('bpmnElement.added', function(e) {\n\n    var element = e.element;\n\n    if (element.waypoints) {\n      fixDockings(element);\n    }\n  });\n}\n\nImportDockingFix.$inject = [\n  'eventBus'\n];\n\n\n// helpers //////////////////////\n\nfunction getDistance(p1, p2) {\n  return Math.sqrt(Math.pow(p1.x - p2.x, 2) + Math.pow(p1.y - p2.y, 2));\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isAny\n} from '../util/ModelingUtil';\n\n/**\n * A component that makes sure that each created or updated\n * Pool and Lane is assigned an isHorizontal property set to true.\n *\n * @param {EventBus} eventBus\n */\nexport default function IsHorizontalFix(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var elementTypesToUpdate = [\n    'bpmn:Participant',\n    'bpmn:Lane'\n  ];\n\n  this.executed([ 'shape.move', 'shape.create', 'shape.resize' ], function(event) {\n    var bo = getBusinessObject(event.context.shape);\n\n    if (isAny(bo, elementTypesToUpdate) && !bo.di.get('isHorizontal')) {\n\n      // set attribute directly to avoid modeling#updateProperty side effects\n      bo.di.set('isHorizontal', true);\n    }\n  });\n\n}\n\nIsHorizontalFix.$inject = [ 'eventBus' ];\n\ninherits(IsHorizontalFix, CommandInterceptor);\n","/**\n * Returns the length of a vector\n *\n * @param {Vector}\n * @return {Float}\n */\nexport function vectorLength(v) {\n  return Math.sqrt(Math.pow(v.x, 2) + Math.pow(v.y, 2));\n}\n\n\n/**\n * Calculates the angle between a line a the yAxis\n *\n * @param {Array}\n * @return {Float}\n */\nexport function getAngle(line) {\n\n  // return value is between 0, 180 and -180, -0\n  // @janstuemmel: maybe replace return a/b with b/a\n  return Math.atan((line[1].y - line[0].y) / (line[1].x - line[0].x));\n}\n\n\n/**\n * Rotates a vector by a given angle\n *\n * @param {Vector}\n * @param {Float} Angle in radians\n * @return {Vector}\n */\nexport function rotateVector(vector, angle) {\n  return (!angle) ? vector : {\n    x: Math.cos(angle) * vector.x - Math.sin(angle) * vector.y,\n    y: Math.sin(angle) * vector.x + Math.cos(angle) * vector.y\n  };\n}\n\n\n/**\n * Solves a 2D equation system\n * a + r*b = c, where a,b,c are 2D vectors\n *\n * @param {Vector}\n * @param {Vector}\n * @param {Vector}\n * @return {Float}\n */\nfunction solveLambaSystem(a, b, c) {\n\n  // the 2d system\n  var system = [\n    { n: a[0] - c[0], lambda: b[0] },\n    { n: a[1] - c[1], lambda: b[1] }\n  ];\n\n  // solve\n  var n = system[0].n * b[0] + system[1].n * b[1],\n      l = system[0].lambda * b[0] + system[1].lambda * b[1];\n\n  return -n/l;\n}\n\n\n/**\n * Position of perpendicular foot\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Point} the perpendicular foot position\n */\nexport function perpendicularFoot(point, line) {\n\n  var a = line[0], b = line[1];\n\n  // relative position of b from a\n  var bd = { x: b.x - a.x, y: b.y - a.y };\n\n  // solve equation system to the parametrized vectors param real value\n  var r = solveLambaSystem([ a.x, a.y ], [ bd.x, bd.y ], [ point.x, point.y ]);\n\n  return { x: a.x + r*bd.x, y: a.y + r*bd.y };\n}\n\n\n/**\n * Calculates the distance between a point and a line\n *\n * @param {Point}\n * @param [ {Point}, {Point} ] line defined through two points\n * @return {Float} distance\n */\nexport function getDistancePointLine(point, line) {\n\n  var pfPoint = perpendicularFoot(point, line);\n\n  // distance vector\n  var connectionVector = {\n    x: pfPoint.x - point.x,\n    y: pfPoint.y - point.y\n  };\n\n  return vectorLength(connectionVector);\n}\n\n\n/**\n * Calculates the distance between two points\n *\n * @param {Point}\n * @param {Point}\n * @return {Float} distance\n */\nexport function getDistancePointPoint(point1, point2) {\n\n  return vectorLength({\n    x: point1.x - point2.x,\n    y: point1.y - point2.y\n  });\n}","var sqrt = Math.sqrt,\n    min = Math.min,\n    max = Math.max,\n    abs = Math.abs;\n\n/**\n * Calculate the square (power to two) of a number.\n *\n * @param {Number} n\n *\n * @return {Number}\n */\nfunction sq(n) {\n  return Math.pow(n, 2);\n}\n\n/**\n * Get distance between two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Number}\n */\nfunction getDistance(p1, p2) {\n  return sqrt(sq(p1.x - p2.x) + sq(p1.y - p2.y));\n}\n\n/**\n * Return the attachment of the given point on the specified line.\n *\n * The attachment is either a bendpoint (attached to the given point)\n * or segment (attached to a location on a line segment) attachment:\n *\n * ```javascript\n * var pointAttachment = {\n *   type: 'bendpoint',\n *   bendpointIndex: 3,\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n *\n * var segmentAttachment = {\n *   type: 'segment',\n *   segmentIndex: 2,\n *   relativeLocation: 0.31, // attach point location between 0 (at start) and 1 (at end)\n *   position: { x: 10, y: 10 } // the attach point on the line\n * };\n * ```\n *\n * @param {Point} point\n * @param {Array<Point>} line\n *\n * @return {Object} attachment\n */\nexport function getAttachment(point, line) {\n\n  var idx = 0,\n      segmentStart,\n      segmentEnd,\n      segmentStartDistance,\n      segmentEndDistance,\n      attachmentPosition,\n      minDistance,\n      intersections,\n      attachment,\n      attachmentDistance,\n      closestAttachmentDistance,\n      closestAttachment;\n\n  for (idx = 0; idx < line.length - 1; idx++) {\n\n    segmentStart = line[idx];\n    segmentEnd = line[idx + 1];\n\n    if (pointsEqual(segmentStart, segmentEnd)) {\n      intersections = [ segmentStart ];\n    } else {\n      segmentStartDistance = getDistance(point, segmentStart);\n      segmentEndDistance = getDistance(point, segmentEnd);\n\n      minDistance = min(segmentStartDistance, segmentEndDistance);\n\n      intersections = getCircleSegmentIntersections(segmentStart, segmentEnd, point, minDistance);\n    }\n\n    if (intersections.length < 1) {\n      throw new Error('expected between [1, 2] circle -> line intersections');\n    }\n\n    // one intersection -> bendpoint attachment\n    if (intersections.length === 1) {\n      attachment = {\n        type: 'bendpoint',\n        position: intersections[0],\n        segmentIndex: idx,\n        bendpointIndex: pointsEqual(segmentStart, intersections[0]) ? idx : idx + 1\n      };\n    }\n\n    // two intersections -> segment attachment\n    if (intersections.length === 2) {\n\n      attachmentPosition = mid(intersections[0], intersections[1]);\n\n      attachment = {\n        type: 'segment',\n        position: attachmentPosition,\n        segmentIndex: idx,\n        relativeLocation: getDistance(segmentStart, attachmentPosition) / getDistance(segmentStart, segmentEnd)\n      };\n    }\n\n    attachmentDistance = getDistance(attachment.position, point);\n\n    if (!closestAttachment || closestAttachmentDistance > attachmentDistance) {\n      closestAttachment = attachment;\n      closestAttachmentDistance = attachmentDistance;\n    }\n  }\n\n  return closestAttachment;\n}\n\n/**\n * Gets the intersection between a circle and a line segment.\n *\n * @param {Point} s1 segment start\n * @param {Point} s2 segment end\n * @param {Point} cc circle center\n * @param {Number} cr circle radius\n *\n * @return {Array<Point>} intersections\n */\nfunction getCircleSegmentIntersections(s1, s2, cc, cr) {\n\n  var baX = s2.x - s1.x;\n  var baY = s2.y - s1.y;\n  var caX = cc.x - s1.x;\n  var caY = cc.y - s1.y;\n\n  var a = baX * baX + baY * baY;\n  var bBy2 = baX * caX + baY * caY;\n  var c = caX * caX + caY * caY - cr * cr;\n\n  var pBy2 = bBy2 / a;\n  var q = c / a;\n\n  var disc = pBy2 * pBy2 - q;\n\n  // check against negative value to work around\n  // negative, very close to zero results (-4e-15)\n  // being produced in some environments\n  if (disc < 0 && disc > -0.000001) {\n    disc = 0;\n  }\n\n  if (disc < 0) {\n    return [];\n  }\n\n  // if disc == 0 ... dealt with later\n  var tmpSqrt = sqrt(disc);\n  var abScalingFactor1 = -pBy2 + tmpSqrt;\n  var abScalingFactor2 = -pBy2 - tmpSqrt;\n\n  var i1 = {\n    x: s1.x - baX * abScalingFactor1,\n    y: s1.y - baY * abScalingFactor1\n  };\n\n  if (disc === 0) { // abScalingFactor1 == abScalingFactor2\n    return [ i1 ];\n  }\n\n  var i2 = {\n    x: s1.x - baX * abScalingFactor2,\n    y: s1.y - baY * abScalingFactor2\n  };\n\n  // return only points on line segment\n  return [ i1, i2 ].filter(function(p) {\n    return isPointInSegment(p, s1, s2);\n  });\n}\n\n\nfunction isPointInSegment(p, segmentStart, segmentEnd) {\n  return (\n    fenced(p.x, segmentStart.x, segmentEnd.x) &&\n    fenced(p.y, segmentStart.y, segmentEnd.y)\n  );\n}\n\nfunction fenced(n, rangeStart, rangeEnd) {\n\n  // use matching threshold to work around\n  // precision errors in intersection computation\n\n  return (\n    n >= min(rangeStart, rangeEnd) - EQUAL_THRESHOLD &&\n    n <= max(rangeStart, rangeEnd) + EQUAL_THRESHOLD\n  );\n}\n\n/**\n * Calculate mid of two points.\n *\n * @param {Point} p1\n * @param {Point} p2\n *\n * @return {Point}\n */\nfunction mid(p1, p2) {\n\n  return {\n    x: (p1.x + p2.x) / 2,\n    y: (p1.y + p2.y) / 2\n  };\n}\n\nvar EQUAL_THRESHOLD = 0.1;\n\nfunction pointsEqual(p1, p2) {\n\n  return (\n    abs(p1.x - p2.x) <= EQUAL_THRESHOLD &&\n    abs(p1.y - p2.y) <= EQUAL_THRESHOLD\n  );\n}\n","import {\n  getDistancePointPoint,\n  rotateVector,\n  getAngle\n} from './GeometricUtil';\n\nimport {\n  getAttachment\n} from './LineAttachmentUtil';\n\nimport {\n  roundPoint\n} from 'diagram-js/lib/layout/LayoutUtil';\n\n\nexport function findNewLabelLineStartIndex(oldWaypoints, newWaypoints, attachment, hints) {\n\n  var index = attachment.segmentIndex;\n\n  var offset = newWaypoints.length - oldWaypoints.length;\n\n  // segmentMove happened\n  if (hints.segmentMove) {\n\n    var oldSegmentStartIndex = hints.segmentMove.segmentStartIndex,\n        newSegmentStartIndex = hints.segmentMove.newSegmentStartIndex;\n\n    // if label was on moved segment return new segment index\n    if (index === oldSegmentStartIndex) {\n      return newSegmentStartIndex;\n    }\n\n    // label is after new segment index\n    if (index >= newSegmentStartIndex) {\n      return (index+offset < newSegmentStartIndex) ? newSegmentStartIndex : index+offset;\n    }\n\n    // if label is before new segment index\n    return index;\n  }\n\n  // bendpointMove happened\n  if (hints.bendpointMove) {\n\n    var insert = hints.bendpointMove.insert,\n        bendpointIndex = hints.bendpointMove.bendpointIndex,\n        newIndex;\n\n    // waypoints length didnt change\n    if (offset === 0) {\n      return index;\n    }\n\n    // label behind new/removed bendpoint\n    if (index >= bendpointIndex) {\n      newIndex = insert ? index + 1 : index - 1;\n    }\n\n    // label before new/removed bendpoint\n    if (index < bendpointIndex) {\n\n      newIndex = index;\n\n      // decide label should take right or left segment\n      if (insert && attachment.type !== 'bendpoint' && bendpointIndex-1 === index) {\n\n        var rel = relativePositionMidWaypoint(newWaypoints, bendpointIndex);\n\n        if (rel < attachment.relativeLocation) {\n          newIndex++;\n        }\n      }\n    }\n\n    return newIndex;\n  }\n\n  // start/end changed\n  if (offset === 0) {\n    return index;\n  }\n\n  if (hints.connectionStart) {\n    return (index === 0) ? 0 : null;\n  }\n\n  if (hints.connectionEnd) {\n    return (index === oldWaypoints.length - 2) ? newWaypoints.length - 2 : null;\n  }\n\n  // if nothing fits, return null\n  return null;\n}\n\n\n/**\n * Calculate the required adjustment (move delta) for the given label\n * after the connection waypoints got updated.\n *\n * @param {djs.model.Label} label\n * @param {Array<Point>} newWaypoints\n * @param {Array<Point>} oldWaypoints\n * @param {Object} hints\n *\n * @return {Point} delta\n */\nexport function getLabelAdjustment(label, newWaypoints, oldWaypoints, hints) {\n\n  var x = 0,\n      y = 0;\n\n  var labelPosition = getLabelMid(label);\n\n  // get closest attachment\n  var attachment = getAttachment(labelPosition, oldWaypoints),\n      oldLabelLineIndex = attachment.segmentIndex,\n      newLabelLineIndex = findNewLabelLineStartIndex(oldWaypoints, newWaypoints, attachment, hints);\n\n  if (newLabelLineIndex === null) {\n    return { x: x, y: y };\n  }\n\n  // should never happen\n  // TODO(@janstuemmel): throw an error here when connectionSegmentMove is refactored\n  if (newLabelLineIndex < 0 ||\n      newLabelLineIndex > newWaypoints.length - 2) {\n    return { x: x, y: y };\n  }\n\n  var oldLabelLine = getLine(oldWaypoints, oldLabelLineIndex),\n      newLabelLine = getLine(newWaypoints, newLabelLineIndex),\n      oldFoot = attachment.position;\n\n  var relativeFootPosition = getRelativeFootPosition(oldLabelLine, oldFoot),\n      angleDelta = getAngleDelta(oldLabelLine, newLabelLine);\n\n  // special rule if label on bendpoint\n  if (attachment.type === 'bendpoint') {\n\n    var offset = newWaypoints.length - oldWaypoints.length,\n        oldBendpointIndex = attachment.bendpointIndex,\n        oldBendpoint = oldWaypoints[oldBendpointIndex];\n\n    // bendpoint position hasn't changed, return same position\n    if (newWaypoints.indexOf(oldBendpoint) !== -1) {\n      return { x: x, y: y };\n    }\n\n    // new bendpoint and old bendpoint have same index, then just return the offset\n    if (offset === 0) {\n      var newBendpoint = newWaypoints[oldBendpointIndex];\n\n      return {\n        x: newBendpoint.x - attachment.position.x,\n        y: newBendpoint.y - attachment.position.y\n      };\n    }\n\n    // if bendpoints get removed\n    if (offset < 0 && oldBendpointIndex !== 0 && oldBendpointIndex < oldWaypoints.length - 1) {\n      relativeFootPosition = relativePositionMidWaypoint(oldWaypoints, oldBendpointIndex);\n    }\n  }\n\n  var newFoot = {\n    x: (newLabelLine[1].x - newLabelLine[0].x) * relativeFootPosition + newLabelLine[0].x,\n    y: (newLabelLine[1].y - newLabelLine[0].y) * relativeFootPosition + newLabelLine[0].y\n  };\n\n  // the rotated vector to label\n  var newLabelVector = rotateVector({\n    x: labelPosition.x - oldFoot.x,\n    y: labelPosition.y - oldFoot.y\n  }, angleDelta);\n\n  // the new relative position\n  x = newFoot.x + newLabelVector.x - labelPosition.x;\n  y = newFoot.y + newLabelVector.y - labelPosition.y;\n\n  return roundPoint({\n    x: x,\n    y: y\n  });\n}\n\n\n// HELPERS //////////////////////\n\nfunction relativePositionMidWaypoint(waypoints, idx) {\n\n  var distanceSegment1 = getDistancePointPoint(waypoints[idx-1], waypoints[idx]),\n      distanceSegment2 = getDistancePointPoint(waypoints[idx], waypoints[idx+1]);\n\n  var relativePosition = distanceSegment1 / (distanceSegment1 + distanceSegment2);\n\n  return relativePosition;\n}\n\nfunction getLabelMid(label) {\n  return {\n    x: label.x + label.width / 2,\n    y: label.y + label.height / 2\n  };\n}\n\nfunction getAngleDelta(l1, l2) {\n  var a1 = getAngle(l1),\n      a2 = getAngle(l2);\n  return a2 - a1;\n}\n\nfunction getLine(waypoints, idx) {\n  return [ waypoints[idx], waypoints[idx+1] ];\n}\n\nfunction getRelativeFootPosition(line, foot) {\n\n  var length = getDistancePointPoint(line[0], line[1]),\n      lengthToFoot = getDistancePointPoint(line[0], foot);\n\n  return length === 0 ? 0 : lengthToFoot / length;\n}\n","import {\n  roundPoint\n} from '../layout/LayoutUtil';\n\nimport {\n  center,\n  delta\n} from './PositionUtil';\n\n\n/**\n * Calculates the absolute point relative to the new element's position\n *\n * @param {point} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {point} point [absolute]\n */\nexport function getNewAttachPoint(point, oldBounds, newBounds) {\n  var oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      oldDelta = delta(point, oldCenter);\n\n  var newDelta = {\n    x: oldDelta.x * (newBounds.width / oldBounds.width),\n    y: oldDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  return roundPoint({\n    x: newCenter.x + newDelta.x,\n    y: newCenter.y + newDelta.y\n  });\n}\n\n\n/**\n * Calculates the shape's delta relative to a new position\n * of a certain element's bounds\n *\n * @param {djs.model.Shape} point [absolute]\n * @param {bounds} oldBounds\n * @param {bounds} newBounds\n *\n * @return {delta} delta\n */\nexport function getNewAttachShapeDelta(shape, oldBounds, newBounds) {\n  var shapeCenter = center(shape),\n      oldCenter = center(oldBounds),\n      newCenter = center(newBounds),\n      shapeDelta = delta(shape, shapeCenter),\n      oldCenterDelta = delta(shapeCenter, oldCenter);\n\n  var newCenterDelta = {\n    x: oldCenterDelta.x * (newBounds.width / oldBounds.width),\n    y: oldCenterDelta.y * (newBounds.height / oldBounds.height)\n  };\n\n  var newShapeCenter = {\n    x: newCenter.x + newCenterDelta.x,\n    y: newCenter.y + newCenterDelta.y\n  };\n\n  return roundPoint({\n    x: newShapeCenter.x + shapeDelta.x - shape.x,\n    y: newShapeCenter.y + shapeDelta.y - shape.y\n  });\n}","import {\n  assign\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nimport {\n  isLabelExternal,\n  getExternalLabelMid,\n  hasExternalLabel,\n  isLabel\n} from '../../../util/LabelUtil';\n\nimport {\n  getLabel\n} from '../../label-editing/LabelUtil';\n\nimport {\n  getLabelAdjustment\n} from './util/LabelLayoutUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getNewAttachPoint\n} from 'diagram-js/lib/util/AttachUtil';\n\nimport {\n  getMid,\n  roundPoint\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  delta\n} from 'diagram-js/lib/util/PositionUtil';\n\nimport {\n  sortBy\n} from 'min-dash';\n\nimport {\n  getDistancePointLine,\n  perpendicularFoot\n} from './util/GeometricUtil';\n\nvar DEFAULT_LABEL_DIMENSIONS = {\n  width: 90,\n  height: 20\n};\n\nvar NAME_PROPERTY = 'name';\nvar TEXT_PROPERTY = 'text';\n\n/**\n * A component that makes sure that external labels are added\n * together with respective elements and properly updated (DI wise)\n * during move.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {BpmnFactory} bpmnFactory\n * @param {TextRenderer} textRenderer\n */\nexport default function LabelBehavior(\n    eventBus, modeling, bpmnFactory,\n    textRenderer) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  // update label if name property was updated\n  this.postExecute('element.updateProperties', function(e) {\n    var context = e.context,\n        element = context.element,\n        properties = context.properties;\n\n    if (NAME_PROPERTY in properties) {\n      modeling.updateLabel(element, properties[NAME_PROPERTY]);\n    }\n\n    if (TEXT_PROPERTY in properties\n        && is(element, 'bpmn:TextAnnotation')) {\n\n      var newBounds = textRenderer.getTextAnnotationBounds(\n        {\n          x: element.x,\n          y: element.y,\n          width: element.width,\n          height: element.height\n        },\n        properties[TEXT_PROPERTY] || ''\n      );\n\n      modeling.updateLabel(element, properties.text, newBounds);\n    }\n  });\n\n  // create label shape after shape/connection was created\n  this.postExecute([ 'shape.create', 'connection.create' ], function(e) {\n    var context = e.context,\n        hints = context.hints || {};\n\n    if (hints.createElementsBehavior === false) {\n      return;\n    }\n\n    var element = context.shape || context.connection,\n        businessObject = element.businessObject;\n\n    if (isLabel(element) || !isLabelExternal(element)) {\n      return;\n    }\n\n    // only create label if attribute available\n    if (!getLabel(element)) {\n      return;\n    }\n\n    var labelCenter = getExternalLabelMid(element);\n\n    // we don't care about x and y\n    var labelDimensions = textRenderer.getExternalLabelBounds(\n      DEFAULT_LABEL_DIMENSIONS,\n      getLabel(element)\n    );\n\n    modeling.createLabel(element, labelCenter, {\n      id: businessObject.id + '_label',\n      businessObject: businessObject,\n      width: labelDimensions.width,\n      height: labelDimensions.height\n    });\n  });\n\n  // update label after label shape was deleted\n  this.postExecute('shape.delete', function(event) {\n    var context = event.context,\n        labelTarget = context.labelTarget,\n        hints = context.hints || {};\n\n    // check if label\n    if (labelTarget && hints.unsetLabel !== false) {\n      modeling.updateLabel(labelTarget, null, null, { removeShape: false });\n    }\n  });\n\n  // update di information on label creation\n  this.postExecute([ 'label.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape,\n        businessObject,\n        di;\n\n    // we want to trigger on real labels only\n    if (!element.labelTarget) {\n      return;\n    }\n\n    // we want to trigger on BPMN elements only\n    if (!is(element.labelTarget || element, 'bpmn:BaseElement')) {\n      return;\n    }\n\n    businessObject = element.businessObject,\n    di = businessObject.di;\n\n\n    if (!di.label) {\n      di.label = bpmnFactory.create('bpmndi:BPMNLabel', {\n        bounds: bpmnFactory.create('dc:Bounds')\n      });\n    }\n\n    assign(di.label.bounds, {\n      x: element.x,\n      y: element.y,\n      width: element.width,\n      height: element.height\n    });\n  });\n\n  function getVisibleLabelAdjustment(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        label = connection.label,\n        hints = assign({}, context.hints),\n        newWaypoints = context.newWaypoints || connection.waypoints,\n        oldWaypoints = context.oldWaypoints;\n\n\n    if (typeof hints.startChanged === 'undefined') {\n      hints.startChanged = !!hints.connectionStart;\n    }\n\n    if (typeof hints.endChanged === 'undefined') {\n      hints.endChanged = !!hints.connectionEnd;\n    }\n\n    return getLabelAdjustment(label, newWaypoints, oldWaypoints, hints);\n  }\n\n  this.postExecute([\n    'connection.layout',\n    'connection.updateWaypoints'\n  ], function(event) {\n    var context = event.context,\n        hints = context.hints || {};\n\n    if (hints.labelBehavior === false) {\n      return;\n    }\n\n    var connection = context.connection,\n        label = connection.label,\n        labelAdjustment;\n\n    // handle missing label as well as the case\n    // that the label parent does not exist (yet),\n    // because it is being pasted / created via multi element create\n    //\n    // Cf. https://github.com/bpmn-io/bpmn-js/pull/1227\n    if (!label || !label.parent) {\n      return;\n    }\n\n    labelAdjustment = getVisibleLabelAdjustment(event);\n\n    modeling.moveShape(label, labelAdjustment);\n  });\n\n\n  // keep label position on shape replace\n  this.postExecute([ 'shape.replace' ], function(event) {\n    var context = event.context,\n        newShape = context.newShape,\n        oldShape = context.oldShape;\n\n    var businessObject = getBusinessObject(newShape);\n\n    if (businessObject\n      && isLabelExternal(businessObject)\n      && oldShape.label\n      && newShape.label) {\n      newShape.label.x = oldShape.label.x;\n      newShape.label.y = oldShape.label.y;\n    }\n  });\n\n\n  // move external label after resizing\n  this.postExecute('shape.resize', function(event) {\n\n    var context = event.context,\n        shape = context.shape,\n        newBounds = context.newBounds,\n        oldBounds = context.oldBounds;\n\n    if (hasExternalLabel(shape)) {\n\n      var label = shape.label,\n          labelMid = getMid(label),\n          edges = asEdges(oldBounds);\n\n      // get nearest border point to label as reference point\n      var referencePoint = getReferencePoint(labelMid, edges);\n\n      var delta = getReferencePointDelta(referencePoint, oldBounds, newBounds);\n\n      modeling.moveShape(label, delta);\n\n    }\n\n  });\n\n}\n\ninherits(LabelBehavior, CommandInterceptor);\n\nLabelBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'bpmnFactory',\n  'textRenderer'\n];\n\n// helpers //////////////////////\n\n/**\n * Calculates a reference point delta relative to a new position\n * of a certain element's bounds\n *\n * @param {Point} point\n * @param {Bounds} oldBounds\n * @param {Bounds} newBounds\n *\n * @return {Delta} delta\n */\nexport function getReferencePointDelta(referencePoint, oldBounds, newBounds) {\n\n  var newReferencePoint = getNewAttachPoint(referencePoint, oldBounds, newBounds);\n\n  return roundPoint(delta(newReferencePoint, referencePoint));\n}\n\n/**\n * Generates the nearest point (reference point) for a given point\n * onto given set of lines\n *\n * @param {Array<Point, Point>} lines\n * @param {Point} point\n *\n * @param {Point}\n */\nexport function getReferencePoint(point, lines) {\n\n  if (!lines.length) {\n    return;\n  }\n\n  var nearestLine = getNearestLine(point, lines);\n\n  return perpendicularFoot(point, nearestLine);\n}\n\n/**\n * Convert the given bounds to a lines array containing all edges\n *\n * @param {Bounds|Point} bounds\n *\n * @return Array<Point>\n */\nexport function asEdges(bounds) {\n  return [\n    [ // top\n      {\n        x: bounds.x,\n        y: bounds.y\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y\n      }\n    ],\n    [ // right\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0)\n      }\n    ],\n    [ // bottom\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0)\n      },\n      {\n        x: bounds.x + (bounds.width || 0),\n        y: bounds.y + (bounds.height || 0)\n      }\n    ],\n    [ // left\n      {\n        x: bounds.x,\n        y: bounds.y\n      },\n      {\n        x: bounds.x,\n        y: bounds.y + (bounds.height || 0)\n      }\n    ]\n  ];\n}\n\n/**\n * Returns the nearest line for a given point by distance\n * @param {Point} point\n * @param Array<Point> lines\n *\n * @return Array<Point>\n */\nfunction getNearestLine(point, lines) {\n\n  var distances = lines.map(function(l) {\n    return {\n      line: l,\n      distance: getDistancePointLine(point, l)\n    };\n  });\n\n  var sorted = sortBy(distances, 'distance');\n\n  return sorted[0].line;\n}\n","import { is } from '../../../util/ModelUtil';\n\nvar COLLAB_ERR_MSG = 'flow elements must be children of pools/participants',\n    PROCESS_ERR_MSG = 'participants cannot be pasted onto a non-empty process diagram';\n\n\nexport default function ModelingFeedback(eventBus, tooltips, translate) {\n\n  function showError(position, message, timeout) {\n    tooltips.add({\n      position: {\n        x: position.x + 5,\n        y: position.y + 5\n      },\n      type: 'error',\n      timeout: timeout || 2000,\n      html: '<div>' + message + '</div>'\n    });\n  }\n\n  eventBus.on([ 'shape.move.rejected', 'create.rejected' ], function(event) {\n    var context = event.context,\n        shape = context.shape,\n        target = context.target;\n\n    if (is(target, 'bpmn:Collaboration') && is(shape, 'bpmn:FlowNode')) {\n      showError(event, translate(COLLAB_ERR_MSG));\n    }\n  });\n\n  eventBus.on([ 'elements.paste.rejected' ], function(event) {\n    var context = event.context,\n        position = context.position,\n        target = context.target;\n\n    if (is(target, 'bpmn:Collaboration')) {\n      showError(position, translate(COLLAB_ERR_MSG));\n    }\n\n    if (is(target, 'bpmn:Process')) {\n      showError(position, translate(PROCESS_ERR_MSG), 3000);\n    }\n  });\n}\n\nModelingFeedback.$inject = [\n  'eventBus',\n  'tooltips',\n  'translate'\n];\n","import {\n  forEach,\n  find,\n  matchPattern\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\nexport default function ReplaceConnectionBehavior(eventBus, modeling, bpmnRules, injector) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var dragging = injector.get('dragging', false);\n\n  function fixConnection(connection) {\n\n    var source = connection.source,\n        target = connection.target,\n        parent = connection.parent;\n\n    // do not do anything if connection\n    // is already deleted (may happen due to other\n    // behaviors plugged-in before)\n    if (!parent) {\n      return;\n    }\n\n    var replacementType,\n        remove;\n\n    /**\n     * Check if incoming or outgoing connections\n     * can stay or could be substituted with an\n     * appropriate replacement.\n     *\n     * This holds true for SequenceFlow <> MessageFlow.\n     */\n\n    if (is(connection, 'bpmn:SequenceFlow')) {\n      if (!bpmnRules.canConnectSequenceFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectMessageFlow(source, target)) {\n        replacementType = 'bpmn:MessageFlow';\n      }\n    }\n\n    // transform message flows into sequence flows, if possible\n\n    if (is(connection, 'bpmn:MessageFlow')) {\n\n      if (!bpmnRules.canConnectMessageFlow(source, target)) {\n        remove = true;\n      }\n\n      if (bpmnRules.canConnectSequenceFlow(source, target)) {\n        replacementType = 'bpmn:SequenceFlow';\n      }\n    }\n\n    if (is(connection, 'bpmn:Association') && !bpmnRules.canConnectAssociation(source, target)) {\n      remove = true;\n    }\n\n\n    // remove invalid connection,\n    // unless it has been removed already\n    if (remove) {\n      modeling.removeConnection(connection);\n    }\n\n    // replace SequenceFlow <> MessageFlow\n\n    if (replacementType) {\n      modeling.connect(source, target, {\n        type: replacementType,\n        waypoints: connection.waypoints.slice()\n      });\n    }\n  }\n\n  function replaceReconnectedConnection(event) {\n\n    var context = event.context,\n        connection = context.connection,\n        source = context.newSource || connection.source,\n        target = context.newTarget || connection.target,\n        allowed,\n        replacement;\n\n    allowed = bpmnRules.canConnect(source, target);\n\n    if (!allowed || allowed.type === connection.type) {\n      return;\n    }\n\n    replacement = modeling.connect(source, target, {\n      type: allowed.type,\n      waypoints: connection.waypoints.slice()\n    });\n\n    // remove old connection\n    modeling.removeConnection(connection);\n\n    // replace connection in context to reconnect end/start\n    context.connection = replacement;\n\n    if (dragging) {\n      cleanDraggingSelection(connection, replacement);\n    }\n  }\n\n  // monkey-patch selection saved in dragging in order to re-select it when operation is finished\n  function cleanDraggingSelection(oldConnection, newConnection) {\n    var context = dragging.context(),\n        previousSelection = context && context.payload.previousSelection,\n        index;\n\n    // do nothing if not dragging or no selection was present\n    if (!previousSelection || !previousSelection.length) {\n      return;\n    }\n\n    index = previousSelection.indexOf(oldConnection);\n\n    if (index === -1) {\n      return;\n    }\n\n    previousSelection.splice(index, 1, newConnection);\n  }\n\n  // lifecycle hooks\n\n  this.postExecuted('elements.move', function(context) {\n\n    var closure = context.closure,\n        allConnections = closure.allConnections;\n\n    forEach(allConnections, fixConnection);\n  }, true);\n\n  this.preExecute('connection.reconnect', replaceReconnectedConnection);\n\n  this.postExecuted('element.updateProperties', function(event) {\n    var context = event.context,\n        properties = context.properties,\n        element = context.element,\n        businessObject = element.businessObject,\n        connection;\n\n    // remove condition on change to default\n    if (properties.default) {\n      connection = find(\n        element.outgoing,\n        matchPattern({ id: element.businessObject.default.id })\n      );\n\n      if (connection) {\n        modeling.updateProperties(connection, { conditionExpression: undefined });\n      }\n    }\n\n    // remove default from source on change to conditional\n    if (properties.conditionExpression && businessObject.sourceRef.default === businessObject) {\n      modeling.updateProperties(element.source, { default: undefined });\n    }\n  });\n}\n\ninherits(ReplaceConnectionBehavior, CommandInterceptor);\n\nReplaceConnectionBehavior.$inject = [\n  'eventBus',\n  'modeling',\n  'bpmnRules',\n  'injector'\n];\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\n\n\n/**\n * BPMN specific remove behavior\n */\nexport default function RemoveParticipantBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  /**\n   * morph collaboration diagram into process diagram\n   * after the last participant has been removed\n   */\n\n  this.preExecute('shape.delete', function(context) {\n\n    var shape = context.shape,\n        parent = shape.parent;\n\n    // activate the behavior if the shape to be removed\n    // is a participant\n    if (is(shape, 'bpmn:Participant')) {\n      context.collaborationRoot = parent;\n    }\n  }, true);\n\n  this.postExecute('shape.delete', function(context) {\n\n    var collaborationRoot = context.collaborationRoot;\n\n    if (collaborationRoot && !collaborationRoot.businessObject.participants.length) {\n\n      // replace empty collaboration with process diagram\n      modeling.makeProcess();\n    }\n  }, true);\n\n}\n\nRemoveParticipantBehavior.$inject = [ 'eventBus', 'modeling' ];\n\ninherits(RemoveParticipantBehavior, CommandInterceptor);","import inherits from 'inherits';\n\nimport { forEach } from 'min-dash';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { isEventSubProcess } from '../../../util/DiUtil';\n\n\n/**\n * BPMN-specific replace behavior.\n */\nexport default function ReplaceElementBehaviour(\n    bpmnReplace,\n    bpmnRules,\n    elementRegistry,\n    injector,\n    modeling,\n    selection\n) {\n  injector.invoke(CommandInterceptor, this);\n\n  this._bpmnReplace = bpmnReplace;\n  this._elementRegistry = elementRegistry;\n  this._selection = selection;\n\n  // replace elements on move\n  this.postExecuted([ 'elements.move' ], 500, function(event) {\n    var context = event.context,\n        target = context.newParent,\n        newHost = context.newHost,\n        elements = [];\n\n    forEach(context.closure.topLevel, function(topLevelElements) {\n      if (isEventSubProcess(topLevelElements)) {\n        elements = elements.concat(topLevelElements.children);\n      } else {\n        elements = elements.concat(topLevelElements);\n      }\n    });\n\n    // set target to host if attaching\n    if (elements.length === 1 && newHost) {\n      target = newHost;\n    }\n\n    var canReplace = bpmnRules.canReplace(elements, target);\n\n    if (canReplace) {\n      this.replaceElements(elements, canReplace.replacements, newHost);\n    }\n  }, this);\n\n  // update attachments on host replace\n  this.postExecute([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape,\n        attachers = oldShape.attachers,\n        canReplace;\n\n    if (attachers && attachers.length) {\n      canReplace = bpmnRules.canReplace(attachers, newShape);\n\n      this.replaceElements(attachers, canReplace.replacements);\n    }\n\n  }, this);\n\n  // keep ID on shape replace\n  this.postExecuted([ 'shape.replace' ], 1500, function(e) {\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    modeling.unclaimId(oldShape.businessObject.id, oldShape.businessObject);\n    modeling.updateProperties(newShape, { id: oldShape.id });\n  });\n}\n\ninherits(ReplaceElementBehaviour, CommandInterceptor);\n\nReplaceElementBehaviour.prototype.replaceElements = function(elements, newElements) {\n  var elementRegistry = this._elementRegistry,\n      bpmnReplace = this._bpmnReplace,\n      selection = this._selection;\n\n  forEach(newElements, function(replacement) {\n    var newElement = {\n      type: replacement.newElementType\n    };\n\n    var oldElement = elementRegistry.get(replacement.oldElementId);\n\n    var idx = elements.indexOf(oldElement);\n\n    elements[idx] = bpmnReplace.replaceElement(oldElement, newElement, { select: false });\n  });\n\n  if (newElements) {\n    selection.select(elements);\n  }\n};\n\nReplaceElementBehaviour.$inject = [\n  'bpmnReplace',\n  'bpmnRules',\n  'elementRegistry',\n  'injector',\n  'modeling',\n  'selection'\n];\n","import { is } from '../../../../util/ModelUtil';\r\n\r\nimport {\r\n  asTRBL\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nimport {\r\n  collectLanes,\r\n  getLanesRoot\r\n} from '../../../modeling/util/LaneUtil';\r\n\r\nvar abs = Math.abs,\r\n    min = Math.min,\r\n    max = Math.max;\r\n\r\n\r\nfunction addToTrbl(trbl, attr, value, choice) {\r\n  var current = trbl[attr];\r\n\r\n  // make sure to set the value if it does not exist\r\n  // or apply the correct value by comparing against\r\n  // choice(value, currentValue)\r\n  trbl[attr] = current === undefined ? value : choice(value, current);\r\n}\r\n\r\nfunction addMin(trbl, attr, value) {\r\n  return addToTrbl(trbl, attr, value, min);\r\n}\r\n\r\nfunction addMax(trbl, attr, value) {\r\n  return addToTrbl(trbl, attr, value, max);\r\n}\r\n\r\nvar LANE_MIN_HEIGHT = 60,\r\n    LANE_MIN_WIDTH = 300,\r\n    LANE_RIGHT_PADDING = 20,\r\n    LANE_LEFT_PADDING = 50,\r\n    LANE_TOP_PADDING = 20,\r\n    LANE_BOTTOM_PADDING = 20;\r\n\r\n\r\nexport function getParticipantResizeConstraints(laneShape, resizeDirection, balanced) {\r\n  var lanesRoot = getLanesRoot(laneShape);\r\n\r\n  var isFirst = true,\r\n      isLast = true;\r\n\r\n  // max top/bottom size for lanes\r\n  var allLanes = collectLanes(lanesRoot, [ lanesRoot ]);\r\n\r\n  var laneTrbl = asTRBL(laneShape);\r\n\r\n  var maxTrbl = {},\r\n      minTrbl = {};\r\n\r\n  if (/e/.test(resizeDirection)) {\r\n    minTrbl.right = laneTrbl.left + LANE_MIN_WIDTH;\r\n  } else\r\n  if (/w/.test(resizeDirection)) {\r\n    minTrbl.left = laneTrbl.right - LANE_MIN_WIDTH;\r\n  }\r\n\r\n  allLanes.forEach(function(other) {\r\n\r\n    var otherTrbl = asTRBL(other);\r\n\r\n    if (/n/.test(resizeDirection)) {\r\n\r\n      if (otherTrbl.top < (laneTrbl.top - 10)) {\r\n        isFirst = false;\r\n      }\r\n\r\n      // max top size (based on next element)\r\n      if (balanced && abs(laneTrbl.top - otherTrbl.bottom) < 10) {\r\n        addMax(maxTrbl, 'top', otherTrbl.top + LANE_MIN_HEIGHT);\r\n      }\r\n\r\n      // min top size (based on self or nested element)\r\n      if (abs(laneTrbl.top - otherTrbl.top) < 5) {\r\n        addMin(minTrbl, 'top', otherTrbl.bottom - LANE_MIN_HEIGHT);\r\n      }\r\n    }\r\n\r\n    if (/s/.test(resizeDirection)) {\r\n\r\n      if (otherTrbl.bottom > (laneTrbl.bottom + 10)) {\r\n        isLast = false;\r\n      }\r\n\r\n      // max bottom size (based on previous element)\r\n      if (balanced && abs(laneTrbl.bottom - otherTrbl.top) < 10) {\r\n        addMin(maxTrbl, 'bottom', otherTrbl.bottom - LANE_MIN_HEIGHT);\r\n      }\r\n\r\n      // min bottom size (based on self or nested element)\r\n      if (abs(laneTrbl.bottom - otherTrbl.bottom) < 5) {\r\n        addMax(minTrbl, 'bottom', otherTrbl.top + LANE_MIN_HEIGHT);\r\n      }\r\n    }\r\n  });\r\n\r\n  // max top/bottom/left/right size based on flow nodes\r\n  var flowElements = lanesRoot.children.filter(function(s) {\r\n    return !s.hidden && !s.waypoints && (is(s, 'bpmn:FlowElement') || is(s, 'bpmn:Artifact'));\r\n  });\r\n\r\n  flowElements.forEach(function(flowElement) {\r\n\r\n    var flowElementTrbl = asTRBL(flowElement);\r\n\r\n    if (isFirst && /n/.test(resizeDirection)) {\r\n      addMin(minTrbl, 'top', flowElementTrbl.top - LANE_TOP_PADDING);\r\n    }\r\n\r\n    if (/e/.test(resizeDirection)) {\r\n      addMax(minTrbl, 'right', flowElementTrbl.right + LANE_RIGHT_PADDING);\r\n    }\r\n\r\n    if (isLast && /s/.test(resizeDirection)) {\r\n      addMax(minTrbl, 'bottom', flowElementTrbl.bottom + LANE_BOTTOM_PADDING);\r\n    }\r\n\r\n    if (/w/.test(resizeDirection)) {\r\n      addMin(minTrbl, 'left', flowElementTrbl.left - LANE_LEFT_PADDING);\r\n    }\r\n  });\r\n\r\n  return {\r\n    min: minTrbl,\r\n    max: maxTrbl\r\n  };\r\n}","import { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport { getParticipantResizeConstraints } from './util/ResizeUtil';\r\n\r\nvar HIGH_PRIORITY = 1500;\r\n\r\nexport var PARTICIPANT_MIN_DIMENSIONS = { width: 300, height: 150 };\r\n\r\nexport var SUB_PROCESS_MIN_DIMENSIONS = { width: 140, height: 120 };\r\n\r\nexport var TEXT_ANNOTATION_MIN_DIMENSIONS = { width: 50, height: 30 };\r\n\r\n\r\n/**\r\n * Set minimum bounds/resize constraints on resize.\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nexport default function ResizeBehavior(eventBus) {\r\n  eventBus.on('resize.start', HIGH_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        direction = context.direction,\r\n        balanced = context.balanced;\r\n\r\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\r\n      context.resizeConstraints = getParticipantResizeConstraints(shape, direction, balanced);\r\n    }\r\n\r\n    if (is(shape, 'bpmn:Participant')) {\r\n      context.minDimensions = PARTICIPANT_MIN_DIMENSIONS;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n      context.minDimensions = SUB_PROCESS_MIN_DIMENSIONS;\r\n    }\r\n\r\n    if (is(shape, 'bpmn:TextAnnotation')) {\r\n      context.minDimensions = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n    }\r\n  });\r\n}\r\n\r\nResizeBehavior.$inject = [ 'eventBus' ];","import { is } from '../../../util/ModelUtil';\n\nimport {\n  roundBounds\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  hasPrimaryModifier\n} from 'diagram-js/lib/util/Mouse';\n\nvar SLIGHTLY_HIGHER_PRIORITY = 1001;\n\n\n/**\n * Invoke {@link Modeling#resizeLane} instead of\n * {@link Modeling#resizeShape} when resizing a Lane\n * or Participant shape.\n */\nexport default function ResizeLaneBehavior(eventBus, modeling) {\n\n  eventBus.on('resize.start', SLIGHTLY_HIGHER_PRIORITY + 500, function(event) {\n    var context = event.context,\n        shape = context.shape;\n\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\n\n      // should we resize the opposite lane(s) in\n      // order to compensate for the resize operation?\n      context.balanced = !hasPrimaryModifier(event);\n    }\n  });\n\n  /**\n   * Intercept resize end and call resize lane function instead.\n   */\n  eventBus.on('resize.end', SLIGHTLY_HIGHER_PRIORITY, function(event) {\n    var context = event.context,\n        shape = context.shape,\n        canExecute = context.canExecute,\n        newBounds = context.newBounds;\n\n    if (is(shape, 'bpmn:Lane') || is(shape, 'bpmn:Participant')) {\n\n      if (canExecute) {\n\n        // ensure we have actual pixel values for new bounds\n        // (important when zoom level was > 1 during move)\n        newBounds = roundBounds(newBounds);\n\n        // perform the actual resize\n        modeling.resizeLane(shape, newBounds, context.balanced);\n      }\n\n      // stop propagation\n      return false;\n    }\n  });\n}\n\nResizeLaneBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n","import inherits from 'inherits';\n\nimport { is } from '../../../util/ModelUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport lineIntersect from './util/LineIntersect';\n\n\nexport default function RemoveElementBehavior(eventBus, bpmnRules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Combine sequence flows when deleting an element\n   * if there is one incoming and one outgoing\n   * sequence flow\n   */\n  this.preExecute('shape.delete', function(e) {\n\n    var shape = e.context.shape;\n\n    // only handle [a] -> [shape] -> [b] patterns\n    if (shape.incoming.length !== 1 || shape.outgoing.length !== 1) {\n      return;\n    }\n\n    var inConnection = shape.incoming[0],\n        outConnection = shape.outgoing[0];\n\n    // only handle sequence flows\n    if (!is(inConnection, 'bpmn:SequenceFlow') || !is(outConnection, 'bpmn:SequenceFlow')) {\n      return;\n    }\n\n    if (bpmnRules.canConnect(inConnection.source, outConnection.target, inConnection)) {\n\n      // compute new, combined waypoints\n      var newWaypoints = getNewWaypoints(inConnection.waypoints, outConnection.waypoints);\n\n      modeling.reconnectEnd(inConnection, outConnection.target, newWaypoints);\n    }\n  });\n\n}\n\ninherits(RemoveElementBehavior, CommandInterceptor);\n\nRemoveElementBehavior.$inject = [\n  'eventBus',\n  'bpmnRules',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}\n\n\nfunction getNewWaypoints(inWaypoints, outWaypoints) {\n\n  var intersection = lineIntersect(\n    getDocking(inWaypoints[inWaypoints.length - 2]),\n    getDocking(inWaypoints[inWaypoints.length - 1]),\n    getDocking(outWaypoints[1]),\n    getDocking(outWaypoints[0]));\n\n  if (intersection) {\n    return [].concat(\n      inWaypoints.slice(0, inWaypoints.length - 1),\n      [ intersection ],\n      outWaypoints.slice(1));\n  } else {\n    return [\n      getDocking(inWaypoints[0]),\n      getDocking(outWaypoints[outWaypoints.length - 1])\n    ];\n  }\n}","import { forEach } from 'min-dash';\r\n\r\nimport { is } from '../../../util/ModelUtil';\r\n\r\nimport { isExpanded } from '../../../util/DiUtil';\r\n\r\nimport {\r\n  PARTICIPANT_MIN_DIMENSIONS,\r\n  SUB_PROCESS_MIN_DIMENSIONS,\r\n  TEXT_ANNOTATION_MIN_DIMENSIONS\r\n} from './ResizeBehavior';\r\n\r\nexport default function SpaceToolBehavior(eventBus) {\r\n  eventBus.on('spaceTool.getMinDimensions', function(context) {\r\n    var shapes = context.shapes,\r\n        minDimensions = {};\r\n\r\n    forEach(shapes, function(shape) {\r\n      var id = shape.id;\r\n\r\n      if (is(shape, 'bpmn:Participant')) {\r\n        minDimensions[ id ] = PARTICIPANT_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:SubProcess') && isExpanded(shape)) {\r\n        minDimensions[ id ] = SUB_PROCESS_MIN_DIMENSIONS;\r\n      }\r\n\r\n      if (is(shape, 'bpmn:TextAnnotation')) {\r\n        minDimensions[ id ] = TEXT_ANNOTATION_MIN_DIMENSIONS;\r\n      }\r\n    });\r\n\r\n    return minDimensions;\r\n  });\r\n}\r\n\r\nSpaceToolBehavior.$inject = [ 'eventBus' ];\r\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil.js';\n\n/**\n * Add start event replacing element with expanded sub process.\n *\n * @param {Injector} injector\n * @param {Modeling} modeling\n */\nexport default function SubProcessStartEventBehavior(injector, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.postExecuted('shape.replace', function(event) {\n    var oldShape = event.context.oldShape,\n        newShape = event.context.newShape;\n\n    if (\n      !is(newShape, 'bpmn:SubProcess') ||\n      !is(oldShape, 'bpmn:Task') ||\n      !isExpanded(newShape)\n    ) {\n      return;\n    }\n\n    var position = getStartEventPosition(newShape);\n\n    modeling.createShape({ type: 'bpmn:StartEvent' }, position, newShape);\n  });\n}\n\nSubProcessStartEventBehavior.$inject = [\n  'injector',\n  'modeling'\n];\n\ninherits(SubProcessStartEventBehavior, CommandInterceptor);\n\n// helpers //////////\n\nfunction getStartEventPosition(shape) {\n  return {\n    x: shape.x + shape.width / 6,\n    y: shape.y + shape.height / 2\n  };\n}\n","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  computeChildrenBBox\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\n\nvar LOW_PRIORITY = 500;\n\n\nexport default function ToggleElementCollapseBehaviour(\n    eventBus, elementFactory, modeling,\n    resize) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  function hideEmptyLabels(children) {\n    if (children.length) {\n      children.forEach(function(child) {\n        if (child.type === 'label' && !child.businessObject.name) {\n          child.hidden = true;\n        }\n      });\n    }\n  }\n\n  function expandedBounds(shape, defaultSize) {\n    var children = shape.children,\n        newBounds = defaultSize,\n        visibleElements,\n        visibleBBox;\n\n    visibleElements = filterVisible(children).concat([ shape ]);\n\n    visibleBBox = computeChildrenBBox(visibleElements);\n\n    if (visibleBBox) {\n\n      // center to visibleBBox with max(defaultSize, childrenBounds)\n      newBounds.width = Math.max(visibleBBox.width, newBounds.width);\n      newBounds.height = Math.max(visibleBBox.height, newBounds.height);\n\n      newBounds.x = visibleBBox.x + (visibleBBox.width - newBounds.width) / 2;\n      newBounds.y = visibleBBox.y + (visibleBBox.height - newBounds.height) / 2;\n    } else {\n\n      // center to collapsed shape with defaultSize\n      newBounds.x = shape.x + (shape.width - newBounds.width) / 2;\n      newBounds.y = shape.y + (shape.height - newBounds.height) / 2;\n    }\n\n    return newBounds;\n  }\n\n  function collapsedBounds(shape, defaultSize) {\n\n    return {\n      x: shape.x + (shape.width - defaultSize.width) / 2,\n      y: shape.y + (shape.height - defaultSize.height) / 2,\n      width: defaultSize.width,\n      height: defaultSize.height\n    };\n  }\n\n  this.executed([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shape = context.shape;\n\n    if (!is(shape, 'bpmn:SubProcess')) {\n      return;\n    }\n\n    if (!shape.collapsed) {\n\n      // all children got made visible through djs, hide empty labels\n      hideEmptyLabels(shape.children);\n\n      // remove collapsed marker\n      getBusinessObject(shape).di.isExpanded = true;\n    } else {\n\n      // place collapsed marker\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.reverted([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n\n    var context = e.context;\n    var shape = context.shape;\n\n\n    // revert removing/placing collapsed marker\n    if (!shape.collapsed) {\n      getBusinessObject(shape).di.isExpanded = true;\n\n    } else {\n      getBusinessObject(shape).di.isExpanded = false;\n    }\n  });\n\n  this.postExecuted([ 'shape.toggleCollapse' ], LOW_PRIORITY, function(e) {\n    var shape = e.context.shape,\n        defaultSize = elementFactory._getDefaultSize(shape),\n        newBounds;\n\n    if (shape.collapsed) {\n\n      // resize to default size of collapsed shapes\n      newBounds = collapsedBounds(shape, defaultSize);\n    } else {\n\n      // resize to bounds of max(visible children, defaultSize)\n      newBounds = expandedBounds(shape, defaultSize);\n    }\n\n    modeling.resizeShape(shape, newBounds, null, {\n      autoResize: shape.collapsed ? false : 'nwse'\n    });\n  });\n\n}\n\n\ninherits(ToggleElementCollapseBehaviour, CommandInterceptor);\n\nToggleElementCollapseBehaviour.$inject = [\n  'eventBus',\n  'elementFactory',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction filterVisible(elements) {\n  return elements.filter(function(e) {\n    return !e.hidden;\n  });\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport { is } from '../../../util/ModelUtil';\nimport { isExpanded } from '../../../util/DiUtil';\nimport { isLabel } from '../../../util/LabelUtil';\n\n\n/**\n * Unclaims model IDs on element deletion.\n *\n * @param {Canvas} canvas\n * @param {Injector} injector\n * @param {Moddle} moddle\n * @param {Modeling} modeling\n */\nexport default function UnclaimIdBehavior(canvas, injector, moddle, modeling) {\n  injector.invoke(CommandInterceptor, this);\n\n  this.preExecute('shape.delete', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        shapeBo = shape.businessObject;\n\n    if (isLabel(shape)) {\n      return;\n    }\n\n    if (is(shape, 'bpmn:Participant') && isExpanded(shape)) {\n      moddle.ids.unclaim(shapeBo.processRef.id);\n    }\n\n    modeling.unclaimId(shapeBo.id, shapeBo);\n  });\n\n\n  this.preExecute('connection.delete', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        connectionBo = connection.businessObject;\n\n    modeling.unclaimId(connectionBo.id, connectionBo);\n  });\n\n  this.preExecute('canvas.updateRoot', function() {\n    var rootElement = canvas.getRootElement(),\n        rootElementBo = rootElement.businessObject;\n\n    moddle.ids.unclaim(rootElementBo.id);\n  });\n}\n\ninherits(UnclaimIdBehavior, CommandInterceptor);\n\nUnclaimIdBehavior.$inject = [ 'canvas', 'injector', 'moddle', 'modeling' ];","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar LOW_PRIORITY = 500,\n    HIGH_PRIORITY = 5000;\n\n\n/**\n * BPMN specific delete lane behavior\n */\nexport default function UpdateFlowNodeRefsBehavior(eventBus, modeling, translate) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Ok, this is it:\n   *\n   * We have to update the Lane#flowNodeRefs _and_\n   * FlowNode#lanes with every FlowNode move/resize and\n   * Lane move/resize.\n   *\n   * We want to group that stuff to recompute containments\n   * as efficient as possible.\n   *\n   * Yea!\n   */\n\n  // the update context\n  var context;\n\n\n  function initContext() {\n    context = context || new UpdateContext();\n    context.enter();\n\n    return context;\n  }\n\n  function getContext() {\n    if (!context) {\n      throw new Error(translate('out of bounds release'));\n    }\n\n    return context;\n  }\n\n  function releaseContext() {\n\n    if (!context) {\n      throw new Error(translate('out of bounds release'));\n    }\n\n    var triggerUpdate = context.leave();\n\n    if (triggerUpdate) {\n      modeling.updateLaneRefs(context.flowNodes, context.lanes);\n\n      context = null;\n    }\n\n    return triggerUpdate;\n  }\n\n\n  var laneRefUpdateEvents = [\n    'spaceTool',\n    'lane.add',\n    'lane.resize',\n    'lane.split',\n    'elements.create',\n    'elements.delete',\n    'elements.move',\n    'shape.create',\n    'shape.delete',\n    'shape.move',\n    'shape.resize'\n  ];\n\n\n  // listen to a lot of stuff to group lane updates\n\n  this.preExecute(laneRefUpdateEvents, HIGH_PRIORITY, function(event) {\n    initContext();\n  });\n\n  this.postExecuted(laneRefUpdateEvents, LOW_PRIORITY, function(event) {\n    releaseContext();\n  });\n\n\n  // Mark flow nodes + lanes that need an update\n\n  this.preExecute([\n    'shape.create',\n    'shape.move',\n    'shape.delete',\n    'shape.resize'\n  ], function(event) {\n\n    var context = event.context,\n        shape = context.shape;\n\n    var updateContext = getContext();\n\n    // no need to update labels\n    if (shape.labelTarget) {\n      return;\n    }\n\n    if (is(shape, 'bpmn:Lane')) {\n      updateContext.addLane(shape);\n    }\n\n    if (is(shape, 'bpmn:FlowNode')) {\n      updateContext.addFlowNode(shape);\n    }\n  });\n}\n\nUpdateFlowNodeRefsBehavior.$inject = [\n  'eventBus',\n  'modeling' ,\n  'translate'\n];\n\ninherits(UpdateFlowNodeRefsBehavior, CommandInterceptor);\n\n\nfunction UpdateContext() {\n\n  this.flowNodes = [];\n  this.lanes = [];\n\n  this.counter = 0;\n\n  this.addLane = function(lane) {\n    this.lanes.push(lane);\n  };\n\n  this.addFlowNode = function(flowNode) {\n    this.flowNodes.push(flowNode);\n  };\n\n  this.enter = function() {\n    this.counter++;\n  };\n\n  this.leave = function() {\n    this.counter--;\n\n    return !this.counter;\n  };\n}","import inherits from 'inherits';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../../util/ModelUtil';\n\n\n/**\n * A behavior that unsets the Default property of\n * sequence flow source on element delete, if the\n * removed element is the Gateway or Task's default flow.\n *\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function DeleteSequenceFlowBehavior(eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  this.preExecute('connection.delete', function(event) {\n    var context = event.context,\n        connection = context.connection,\n        source = connection.source;\n\n    if (isDefaultFlow(connection, source)) {\n      modeling.updateProperties(source, {\n        'default': null\n      });\n    }\n  });\n}\n\ninherits(DeleteSequenceFlowBehavior, CommandInterceptor);\n\nDeleteSequenceFlowBehavior.$inject = [\n  'eventBus',\n  'modeling'\n];\n\n\n// helpers //////////////////////\n\nfunction isDefaultFlow(connection, source) {\n\n  if (!is(connection, 'bpmn:SequenceFlow')) {\n    return false;\n  }\n\n  var sourceBo = getBusinessObject(source),\n      sequenceFlow = getBusinessObject(connection);\n\n  return sourceBo.get('default') === sequenceFlow;\n}","import AdaptiveLabelPositioningBehavior from './AdaptiveLabelPositioningBehavior';\nimport AppendBehavior from './AppendBehavior';\nimport AssociationBehavior from './AssociationBehavior';\nimport AttachEventBehavior from './AttachEventBehavior';\nimport BoundaryEventBehavior from './BoundaryEventBehavior';\nimport RootElementReferenceBehavior from './RootElementReferenceBehavior';\nimport CreateBehavior from './CreateBehavior';\nimport FixHoverBehavior from './FixHoverBehavior';\nimport CreateDataObjectBehavior from './CreateDataObjectBehavior';\nimport CreateParticipantBehavior from './CreateParticipantBehavior';\nimport DataInputAssociationBehavior from './DataInputAssociationBehavior';\nimport DataStoreBehavior from './DataStoreBehavior';\nimport DeleteLaneBehavior from './DeleteLaneBehavior';\nimport DetachEventBehavior from './DetachEventBehavior';\nimport DropOnFlowBehavior from './DropOnFlowBehavior';\nimport EventBasedGatewayBehavior from './EventBasedGatewayBehavior';\nimport GroupBehavior from './GroupBehavior';\nimport ImportDockingFix from './ImportDockingFix';\nimport IsHorizontalFix from './IsHorizontalFix';\nimport LabelBehavior from './LabelBehavior';\nimport ModelingFeedback from './ModelingFeedback';\nimport ReplaceConnectionBehavior from './ReplaceConnectionBehavior';\nimport RemoveParticipantBehavior from './RemoveParticipantBehavior';\nimport ReplaceElementBehaviour from './ReplaceElementBehaviour';\nimport ResizeBehavior from './ResizeBehavior';\nimport ResizeLaneBehavior from './ResizeLaneBehavior';\nimport RemoveElementBehavior from './RemoveElementBehavior';\nimport SpaceToolBehavior from './SpaceToolBehavior';\nimport SubProcessStartEventBehavior from './SubProcessStartEventBehavior';\nimport ToggleElementCollapseBehaviour from './ToggleElementCollapseBehaviour';\nimport UnclaimIdBehavior from './UnclaimIdBehavior';\nimport UpdateFlowNodeRefsBehavior from './UpdateFlowNodeRefsBehavior';\nimport UnsetDefaultFlowBehavior from './UnsetDefaultFlowBehavior';\n\nexport default {\n  __init__: [\n    'adaptiveLabelPositioningBehavior',\n    'appendBehavior',\n    'associationBehavior',\n    'attachEventBehavior',\n    'boundaryEventBehavior',\n    'rootElementReferenceBehavior',\n    'createBehavior',\n    'fixHoverBehavior',\n    'createDataObjectBehavior',\n    'createParticipantBehavior',\n    'dataStoreBehavior',\n    'dataInputAssociationBehavior',\n    'deleteLaneBehavior',\n    'detachEventBehavior',\n    'dropOnFlowBehavior',\n    'eventBasedGatewayBehavior',\n    'groupBehavior',\n    'importDockingFix',\n    'isHorizontalFix',\n    'labelBehavior',\n    'modelingFeedback',\n    'removeElementBehavior',\n    'removeParticipantBehavior',\n    'replaceConnectionBehavior',\n    'replaceElementBehaviour',\n    'resizeBehavior',\n    'resizeLaneBehavior',\n    'toggleElementCollapseBehaviour',\n    'spaceToolBehavior',\n    'subProcessStartEventBehavior',\n    'unclaimIdBehavior',\n    'unsetDefaultFlowBehavior',\n    'updateFlowNodeRefsBehavior'\n  ],\n  adaptiveLabelPositioningBehavior: [ 'type', AdaptiveLabelPositioningBehavior ],\n  appendBehavior: [ 'type', AppendBehavior ],\n  associationBehavior: [ 'type', AssociationBehavior ],\n  attachEventBehavior: [ 'type', AttachEventBehavior ],\n  boundaryEventBehavior: [ 'type', BoundaryEventBehavior ],\n  rootElementReferenceBehavior: [ 'type', RootElementReferenceBehavior ],\n  createBehavior: [ 'type', CreateBehavior ],\n  fixHoverBehavior: [ 'type', FixHoverBehavior ],\n  createDataObjectBehavior: [ 'type', CreateDataObjectBehavior ],\n  createParticipantBehavior: [ 'type', CreateParticipantBehavior ],\n  dataInputAssociationBehavior: [ 'type', DataInputAssociationBehavior ],\n  dataStoreBehavior: [ 'type', DataStoreBehavior ],\n  deleteLaneBehavior: [ 'type', DeleteLaneBehavior ],\n  detachEventBehavior: [ 'type', DetachEventBehavior ],\n  dropOnFlowBehavior: [ 'type', DropOnFlowBehavior ],\n  eventBasedGatewayBehavior: [ 'type', EventBasedGatewayBehavior ],\n  groupBehavior: [ 'type', GroupBehavior ],\n  importDockingFix: [ 'type', ImportDockingFix ],\n  isHorizontalFix: [ 'type', IsHorizontalFix ],\n  labelBehavior: [ 'type', LabelBehavior ],\n  modelingFeedback: [ 'type', ModelingFeedback ],\n  replaceConnectionBehavior: [ 'type', ReplaceConnectionBehavior ],\n  removeParticipantBehavior: [ 'type', RemoveParticipantBehavior ],\n  replaceElementBehaviour: [ 'type', ReplaceElementBehaviour ],\n  resizeBehavior: [ 'type', ResizeBehavior ],\n  resizeLaneBehavior: [ 'type', ResizeLaneBehavior ],\n  removeElementBehavior: [ 'type', RemoveElementBehavior ],\n  toggleElementCollapseBehaviour : [ 'type', ToggleElementCollapseBehaviour ],\n  spaceToolBehavior: [ 'type', SpaceToolBehavior ],\n  subProcessStartEventBehavior: [ 'type', SubProcessStartEventBehavior ],\n  unclaimIdBehavior: [ 'type', UnclaimIdBehavior ],\n  updateFlowNodeRefsBehavior: [ 'type', UpdateFlowNodeRefsBehavior ],\n  unsetDefaultFlowBehavior: [ 'type', UnsetDefaultFlowBehavior ]\n};\n","import { getOrientation } from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nexport function getBoundaryAttachment(position, targetBounds) {\r\n\r\n  var orientation = getOrientation(position, targetBounds, -15);\r\n\r\n  if (orientation !== 'intersect') {\r\n    return orientation;\r\n  } else {\r\n    return null;\r\n  }\r\n}","import {\n  every,\n  find,\n  forEach,\n  some\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  is,\n  getBusinessObject\n} from '../../util/ModelUtil';\n\nimport {\n  getParent,\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  isLabel\n} from '../../util/LabelUtil';\n\nimport {\n  isExpanded,\n  isEventSubProcess,\n  isInterrupting,\n  hasErrorEventDefinition,\n  hasEscalationEventDefinition,\n  hasCompensateEventDefinition\n} from '../../util/DiUtil';\n\nimport RuleProvider from 'diagram-js/lib/features/rules/RuleProvider';\n\nimport {\n  getBoundaryAttachment as isBoundaryAttachment\n} from '../snapping/BpmnSnappingUtil';\n\n\n/**\n * BPMN specific modeling rule\n */\nexport default function BpmnRules(eventBus) {\n  RuleProvider.call(this, eventBus);\n}\n\ninherits(BpmnRules, RuleProvider);\n\nBpmnRules.$inject = [ 'eventBus' ];\n\nBpmnRules.prototype.init = function() {\n\n  this.addRule('connection.start', function(context) {\n    var source = context.source;\n\n    return canStartConnection(source);\n  });\n\n  this.addRule('connection.create', function(context) {\n    var source = context.source,\n        target = context.target,\n        hints = context.hints || {},\n        targetParent = hints.targetParent,\n        targetAttach = hints.targetAttach;\n\n    // don't allow incoming connections on\n    // newly created boundary events\n    // to boundary events\n    if (targetAttach) {\n      return false;\n    }\n\n    // temporarily set target parent for scoping\n    // checks to work\n    if (targetParent) {\n      target.parent = targetParent;\n    }\n\n    try {\n      return canConnect(source, target);\n    } finally {\n\n      // unset temporary target parent\n      if (targetParent) {\n        target.parent = null;\n      }\n    }\n  });\n\n  this.addRule('connection.reconnect', function(context) {\n\n    var connection = context.connection,\n        source = context.source,\n        target = context.target;\n\n    return canConnect(source, target, connection);\n  });\n\n  this.addRule('connection.updateWaypoints', function(context) {\n    return {\n      type: context.connection.type\n    };\n  });\n\n  this.addRule('shape.resize', function(context) {\n\n    var shape = context.shape,\n        newBounds = context.newBounds;\n\n    return canResize(shape, newBounds);\n  });\n\n  this.addRule('elements.create', function(context) {\n    var elements = context.elements,\n        position = context.position,\n        target = context.target;\n\n    return every(elements, function(element) {\n      if (isConnection(element)) {\n        return canConnect(element.source, element.target, element);\n      }\n\n      if (element.host) {\n        return canAttach(element, element.host, null, position);\n      }\n\n      return canCreate(element, target, null, position);\n    });\n  });\n\n  this.addRule('elements.move', function(context) {\n\n    var target = context.target,\n        shapes = context.shapes,\n        position = context.position;\n\n    return canAttach(shapes, target, null, position) ||\n           canReplace(shapes, target, position) ||\n           canMove(shapes, target, position) ||\n           canInsert(shapes, target, position);\n  });\n\n  this.addRule('shape.create', function(context) {\n    return canCreate(\n      context.shape,\n      context.target,\n      context.source,\n      context.position\n    );\n  });\n\n  this.addRule('shape.attach', function(context) {\n\n    return canAttach(\n      context.shape,\n      context.target,\n      null,\n      context.position\n    );\n  });\n\n  this.addRule('element.copy', function(context) {\n    var element = context.element,\n        elements = context.elements;\n\n    return canCopy(elements, element);\n  });\n};\n\nBpmnRules.prototype.canConnectMessageFlow = canConnectMessageFlow;\n\nBpmnRules.prototype.canConnectSequenceFlow = canConnectSequenceFlow;\n\nBpmnRules.prototype.canConnectDataAssociation = canConnectDataAssociation;\n\nBpmnRules.prototype.canConnectAssociation = canConnectAssociation;\n\nBpmnRules.prototype.canMove = canMove;\n\nBpmnRules.prototype.canAttach = canAttach;\n\nBpmnRules.prototype.canReplace = canReplace;\n\nBpmnRules.prototype.canDrop = canDrop;\n\nBpmnRules.prototype.canInsert = canInsert;\n\nBpmnRules.prototype.canCreate = canCreate;\n\nBpmnRules.prototype.canConnect = canConnect;\n\nBpmnRules.prototype.canResize = canResize;\n\nBpmnRules.prototype.canCopy = canCopy;\n\n/**\n * Utility functions for rule checking\n */\n\n/**\n * Checks if given element can be used for starting connection.\n *\n * @param  {Element} source\n * @return {Boolean}\n */\nfunction canStartConnection(element) {\n  if (nonExistingOrLabel(element)) {\n    return null;\n  }\n\n  return isAny(element, [\n    'bpmn:FlowNode',\n    'bpmn:InteractionNode',\n    'bpmn:DataObjectReference',\n    'bpmn:DataStoreReference'\n  ]);\n}\n\nfunction nonExistingOrLabel(element) {\n  return !element || isLabel(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction getOrganizationalParent(element) {\n\n  do {\n    if (is(element, 'bpmn:Process')) {\n      return getBusinessObject(element);\n    }\n\n    if (is(element, 'bpmn:Participant')) {\n      return (\n        getBusinessObject(element).processRef ||\n        getBusinessObject(element)\n      );\n    }\n  } while ((element = element.parent));\n\n}\n\nfunction isTextAnnotation(element) {\n  return is(element, 'bpmn:TextAnnotation');\n}\n\nfunction isGroup(element) {\n  return is(element, 'bpmn:Group') && !element.labelTarget;\n}\n\nfunction isCompensationBoundary(element) {\n  return is(element, 'bpmn:BoundaryEvent') &&\n         hasEventDefinition(element, 'bpmn:CompensateEventDefinition');\n}\n\nfunction isForCompensation(e) {\n  return getBusinessObject(e).isForCompensation;\n}\n\nfunction isSameOrganization(a, b) {\n  var parentA = getOrganizationalParent(a),\n      parentB = getOrganizationalParent(b);\n\n  return parentA === parentB;\n}\n\nfunction isMessageFlowSource(element) {\n  return (\n    is(element, 'bpmn:InteractionNode') && (\n      !is(element, 'bpmn:Event') || (\n        is(element, 'bpmn:ThrowEvent') &&\n        hasEventDefinitionOrNone(element, 'bpmn:MessageEventDefinition')\n      )\n    )\n  );\n}\n\nfunction isMessageFlowTarget(element) {\n  return (\n    is(element, 'bpmn:InteractionNode') &&\n    !isForCompensation(element) && (\n      !is(element, 'bpmn:Event') || (\n        is(element, 'bpmn:CatchEvent') &&\n        hasEventDefinitionOrNone(element, 'bpmn:MessageEventDefinition')\n      )\n    )\n  );\n}\n\nfunction getScopeParent(element) {\n\n  var parent = element;\n\n  while ((parent = parent.parent)) {\n\n    if (is(parent, 'bpmn:FlowElementsContainer')) {\n      return getBusinessObject(parent);\n    }\n\n    if (is(parent, 'bpmn:Participant')) {\n      return getBusinessObject(parent).processRef;\n    }\n  }\n\n  return null;\n}\n\nfunction isSameScope(a, b) {\n  var scopeParentA = getScopeParent(a),\n      scopeParentB = getScopeParent(b);\n\n  return scopeParentA === scopeParentB;\n}\n\nfunction hasEventDefinition(element, eventDefinition) {\n  var bo = getBusinessObject(element);\n\n  return !!find(bo.eventDefinitions || [], function(definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction hasEventDefinitionOrNone(element, eventDefinition) {\n  var bo = getBusinessObject(element);\n\n  return (bo.eventDefinitions || []).every(function(definition) {\n    return is(definition, eventDefinition);\n  });\n}\n\nfunction isSequenceFlowSource(element) {\n  return (\n    is(element, 'bpmn:FlowNode') &&\n    !is(element, 'bpmn:EndEvent') &&\n    !isEventSubProcess(element) &&\n    !(is(element, 'bpmn:IntermediateThrowEvent') &&\n      hasEventDefinition(element, 'bpmn:LinkEventDefinition')\n    ) &&\n    !isCompensationBoundary(element) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isSequenceFlowTarget(element) {\n  return (\n    is(element, 'bpmn:FlowNode') &&\n    !is(element, 'bpmn:StartEvent') &&\n    !is(element, 'bpmn:BoundaryEvent') &&\n    !isEventSubProcess(element) &&\n    !(is(element, 'bpmn:IntermediateCatchEvent') &&\n      hasEventDefinition(element, 'bpmn:LinkEventDefinition')\n    ) &&\n    !isForCompensation(element)\n  );\n}\n\nfunction isEventBasedTarget(element) {\n  return (\n    is(element, 'bpmn:ReceiveTask') || (\n      is(element, 'bpmn:IntermediateCatchEvent') && (\n        hasEventDefinition(element, 'bpmn:MessageEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:TimerEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:ConditionalEventDefinition') ||\n        hasEventDefinition(element, 'bpmn:SignalEventDefinition')\n      )\n    )\n  );\n}\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n\nfunction getParents(element) {\n\n  var parents = [];\n\n  while (element) {\n    element = element.parent;\n\n    if (element) {\n      parents.push(element);\n    }\n  }\n\n  return parents;\n}\n\nfunction isParent(possibleParent, element) {\n  var allParents = getParents(element);\n  return allParents.indexOf(possibleParent) !== -1;\n}\n\nfunction canConnect(source, target, connection) {\n\n  if (nonExistingOrLabel(source) || nonExistingOrLabel(target)) {\n    return null;\n  }\n\n  if (!is(connection, 'bpmn:DataAssociation')) {\n\n    if (canConnectMessageFlow(source, target)) {\n      return { type: 'bpmn:MessageFlow' };\n    }\n\n    if (canConnectSequenceFlow(source, target)) {\n      return { type: 'bpmn:SequenceFlow' };\n    }\n  }\n\n  var connectDataAssociation = canConnectDataAssociation(source, target);\n\n  if (connectDataAssociation) {\n    return connectDataAssociation;\n  }\n\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return {\n      type: 'bpmn:Association',\n      associationDirection: 'One'\n    };\n  }\n\n  if (canConnectAssociation(source, target)) {\n\n    return {\n      type: 'bpmn:Association'\n    };\n  }\n\n  return false;\n}\n\n/**\n * Can an element be dropped into the target element\n *\n * @return {Boolean}\n */\nfunction canDrop(element, target, position) {\n\n  // can move labels and groups everywhere\n  if (isLabel(element) || isGroup(element)) {\n    return true;\n  }\n\n\n  // disallow to create elements on collapsed pools\n  if (is(target, 'bpmn:Participant') && !isExpanded(target)) {\n    return false;\n  }\n\n  // allow to create new participants on\n  // existing collaboration and process diagrams\n  if (is(element, 'bpmn:Participant')) {\n    return is(target, 'bpmn:Process') || is(target, 'bpmn:Collaboration');\n  }\n\n  // allow moving DataInput / DataOutput within its original container only\n  if (isAny(element, [ 'bpmn:DataInput', 'bpmn:DataOutput' ])) {\n\n    if (element.parent) {\n      return target === element.parent;\n    }\n  }\n\n  // allow creating lanes on participants and other lanes only\n  if (is(element, 'bpmn:Lane')) {\n    return is(target, 'bpmn:Participant') || is(target, 'bpmn:Lane');\n  }\n\n  // disallow dropping boundary events which cannot replace with intermediate event\n  if (is(element, 'bpmn:BoundaryEvent') && !isDroppableBoundaryEvent(element)) {\n    return false;\n  }\n\n  // drop flow elements onto flow element containers\n  // and participants\n  if (is(element, 'bpmn:FlowElement') && !is(element, 'bpmn:DataStoreReference')) {\n    if (is(target, 'bpmn:FlowElementsContainer')) {\n      return isExpanded(target);\n    }\n\n    return isAny(target, [ 'bpmn:Participant', 'bpmn:Lane' ]);\n  }\n\n  // account for the fact that data associations are always\n  // rendered and moved to top (Process or Collaboration level)\n  //\n  // artifacts may be placed wherever, too\n  if (isAny(element, [ 'bpmn:Artifact', 'bpmn:DataAssociation', 'bpmn:DataStoreReference' ])) {\n    return isAny(target, [\n      'bpmn:Collaboration',\n      'bpmn:Lane',\n      'bpmn:Participant',\n      'bpmn:Process',\n      'bpmn:SubProcess' ]);\n  }\n\n  if (is(element, 'bpmn:MessageFlow')) {\n    return is(target, 'bpmn:Collaboration')\n      || element.source.parent == target\n      || element.target.parent == target;\n  }\n\n  return false;\n}\n\nfunction isDroppableBoundaryEvent(event) {\n  return getBusinessObject(event).cancelActivity && (\n    hasNoEventDefinition(event) || hasCommonBoundaryIntermediateEventDefinition(event)\n  );\n}\n\nfunction isBoundaryEvent(element) {\n  return !isLabel(element) && is(element, 'bpmn:BoundaryEvent');\n}\n\nfunction isLane(element) {\n  return is(element, 'bpmn:Lane');\n}\n\n/**\n * We treat IntermediateThrowEvents as boundary events during create,\n * this must be reflected in the rules.\n */\nfunction isBoundaryCandidate(element) {\n  if (isBoundaryEvent(element)) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:IntermediateThrowEvent') && hasNoEventDefinition(element)) {\n    return true;\n  }\n\n  return (\n    is(element, 'bpmn:IntermediateCatchEvent') &&\n    hasCommonBoundaryIntermediateEventDefinition(element)\n  );\n}\n\nfunction hasNoEventDefinition(element) {\n  var bo = getBusinessObject(element);\n\n  return bo && !(bo.eventDefinitions && bo.eventDefinitions.length);\n}\n\nfunction hasCommonBoundaryIntermediateEventDefinition(element) {\n  return hasOneOfEventDefinitions(element, [\n    'bpmn:MessageEventDefinition',\n    'bpmn:TimerEventDefinition',\n    'bpmn:SignalEventDefinition',\n    'bpmn:ConditionalEventDefinition'\n  ]);\n}\n\nfunction hasOneOfEventDefinitions(element, eventDefinitions) {\n  return eventDefinitions.some(function(definition) {\n    return hasEventDefinition(element, definition);\n  });\n}\n\nfunction isReceiveTaskAfterEventBasedGateway(element) {\n  return (\n    is(element, 'bpmn:ReceiveTask') &&\n    find(element.incoming, function(incoming) {\n      return is(incoming.source, 'bpmn:EventBasedGateway');\n    })\n  );\n}\n\n\nfunction canAttach(elements, target, source, position) {\n\n  if (!Array.isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  // only (re-)attach one element at a time\n  if (elements.length !== 1) {\n    return false;\n  }\n\n  var element = elements[0];\n\n  // do not attach labels\n  if (isLabel(element)) {\n    return false;\n  }\n\n  // only handle boundary events\n  if (!isBoundaryCandidate(element)) {\n    return false;\n  }\n\n  // disallow drop on event sub processes\n  if (isEventSubProcess(target)) {\n    return false;\n  }\n\n  // only allow drop on non compensation activities\n  if (!is(target, 'bpmn:Activity') || isForCompensation(target)) {\n    return false;\n  }\n\n  // only attach to subprocess border\n  if (position && !isBoundaryAttachment(position, target)) {\n    return false;\n  }\n\n  // do not attach on receive tasks after event based gateways\n  if (isReceiveTaskAfterEventBasedGateway(target)) {\n    return false;\n  }\n\n  return 'attach';\n}\n\n\n/**\n * Defines how to replace elements for a given target.\n *\n * Returns an array containing all elements which will be replaced.\n *\n * @example\n *\n *  [{ id: 'IntermediateEvent_2',\n *     type: 'bpmn:StartEvent'\n *   },\n *   { id: 'IntermediateEvent_5',\n *     type: 'bpmn:EndEvent'\n *   }]\n *\n * @param  {Array} elements\n * @param  {Object} target\n *\n * @return {Object} an object containing all elements which have to be replaced\n */\nfunction canReplace(elements, target, position) {\n\n  if (!target) {\n    return false;\n  }\n\n  var canExecute = {\n    replacements: []\n  };\n\n  forEach(elements, function(element) {\n\n    if (!isEventSubProcess(target)) {\n\n      if (is(element, 'bpmn:StartEvent') &&\n          element.type !== 'label' &&\n          canDrop(element, target)) {\n\n        // replace a non-interrupting start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (!isInterrupting(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:StartEvent'\n          });\n        }\n\n        // replace an error/escalation/compensate start event by a blank interrupting start event\n        // when the target is not an event sub process\n        if (hasErrorEventDefinition(element) ||\n            hasEscalationEventDefinition(element) ||\n            hasCompensateEventDefinition(element)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:StartEvent'\n          });\n        }\n      }\n    }\n\n    if (!is(target, 'bpmn:Transaction')) {\n      if (hasEventDefinition(element, 'bpmn:CancelEventDefinition') &&\n          element.type !== 'label') {\n\n        if (is(element, 'bpmn:EndEvent') && canDrop(element, target)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:EndEvent'\n          });\n        }\n\n        if (is(element, 'bpmn:BoundaryEvent') && canAttach(element, target, null, position)) {\n          canExecute.replacements.push({\n            oldElementId: element.id,\n            newElementType: 'bpmn:BoundaryEvent'\n          });\n        }\n      }\n    }\n  });\n\n  return canExecute.replacements.length ? canExecute : false;\n}\n\nfunction canMove(elements, target) {\n\n  // do not move selection containing lanes\n  if (some(elements, isLane)) {\n    return false;\n  }\n\n  // allow default move check to start move operation\n  if (!target) {\n    return true;\n  }\n\n  return elements.every(function(element) {\n    return canDrop(element, target);\n  });\n}\n\nfunction canCreate(shape, target, source, position) {\n\n  if (!target) {\n    return false;\n  }\n\n  if (isLabel(shape) || isGroup(shape)) {\n    return true;\n  }\n\n  if (isSame(source, target)) {\n    return false;\n  }\n\n  // ensure we do not drop the element\n  // into source\n  if (source && isParent(source, target)) {\n    return false;\n  }\n\n  return canDrop(shape, target, position) || canInsert(shape, target, position);\n}\n\nfunction canResize(shape, newBounds) {\n  if (is(shape, 'bpmn:SubProcess')) {\n    return (\n      isExpanded(shape) && (\n        !newBounds || (newBounds.width >= 100 && newBounds.height >= 80)\n      )\n    );\n  }\n\n  if (is(shape, 'bpmn:Lane')) {\n    return !newBounds || (newBounds.width >= 130 && newBounds.height >= 60);\n  }\n\n  if (is(shape, 'bpmn:Participant')) {\n    return !newBounds || (newBounds.width >= 250 && newBounds.height >= 50);\n  }\n\n  if (isTextAnnotation(shape)) {\n    return true;\n  }\n\n  if (isGroup(shape)) {\n    return true;\n  }\n\n  return false;\n}\n\n/**\n * Check, whether one side of the relationship\n * is a text annotation.\n */\nfunction isOneTextAnnotation(source, target) {\n\n  var sourceTextAnnotation = isTextAnnotation(source),\n      targetTextAnnotation = isTextAnnotation(target);\n\n  return (\n    (sourceTextAnnotation || targetTextAnnotation) &&\n    (sourceTextAnnotation !== targetTextAnnotation)\n  );\n}\n\n\nfunction canConnectAssociation(source, target) {\n\n  // do not connect connections\n  if (isConnection(source) || isConnection(target)) {\n    return false;\n  }\n\n  // compensation boundary events are exception\n  if (isCompensationBoundary(source) && isForCompensation(target)) {\n    return true;\n  }\n\n  // don't connect parent <-> child\n  if (isParent(target, source) || isParent(source, target)) {\n    return false;\n  }\n\n  // allow connection of associations between <!TextAnnotation> and <TextAnnotation>\n  if (isOneTextAnnotation(source, target)) {\n    return true;\n  }\n\n  // can connect associations where we can connect\n  // data associations, too (!)\n  return !!canConnectDataAssociation(source, target);\n}\n\nfunction canConnectMessageFlow(source, target) {\n\n  // during connect user might move mouse out of canvas\n  // https://github.com/bpmn-io/bpmn-js/issues/1033\n  if (getRootElement(source) && !getRootElement(target)) {\n    return false;\n  }\n\n  return (\n    isMessageFlowSource(source) &&\n    isMessageFlowTarget(target) &&\n    !isSameOrganization(source, target)\n  );\n}\n\nfunction canConnectSequenceFlow(source, target) {\n\n  if (\n    isEventBasedTarget(target) &&\n    target.incoming.length > 0 &&\n    areOutgoingEventBasedGatewayConnections(target.incoming) &&\n    !is(source, 'bpmn:EventBasedGateway')\n  ) {\n    return false;\n  }\n\n  return isSequenceFlowSource(source) &&\n         isSequenceFlowTarget(target) &&\n         isSameScope(source, target) &&\n         !(is(source, 'bpmn:EventBasedGateway') && !isEventBasedTarget(target));\n}\n\n\nfunction canConnectDataAssociation(source, target) {\n\n  if (isAny(source, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ]) &&\n      isAny(target, [ 'bpmn:Activity', 'bpmn:ThrowEvent' ])) {\n    return { type: 'bpmn:DataInputAssociation' };\n  }\n\n  if (isAny(target, [ 'bpmn:DataObjectReference', 'bpmn:DataStoreReference' ]) &&\n      isAny(source, [ 'bpmn:Activity', 'bpmn:CatchEvent' ])) {\n    return { type: 'bpmn:DataOutputAssociation' };\n  }\n\n  return false;\n}\n\nfunction canInsert(shape, flow, position) {\n\n  if (!flow) {\n    return false;\n  }\n\n  if (Array.isArray(shape)) {\n    if (shape.length !== 1) {\n      return false;\n    }\n\n    shape = shape[0];\n  }\n\n  if (flow.source === shape ||\n      flow.target === shape) {\n    return false;\n  }\n\n  // return true if we can drop on the\n  // underlying flow parent\n  //\n  // at this point we are not really able to talk\n  // about connection rules (yet)\n\n  return (\n    isAny(flow, [ 'bpmn:SequenceFlow', 'bpmn:MessageFlow' ]) &&\n    !isLabel(flow) &&\n    is(shape, 'bpmn:FlowNode') &&\n    !is(shape, 'bpmn:BoundaryEvent') &&\n    canDrop(shape, flow.parent, position));\n}\n\nfunction includes(elements, element) {\n  return (elements && element) && elements.indexOf(element) !== -1;\n}\n\nfunction canCopy(elements, element) {\n  if (isLabel(element)) {\n    return true;\n  }\n\n  if (is(element, 'bpmn:Lane') && !includes(elements, element.parent)) {\n    return false;\n  }\n\n  return true;\n}\n\nfunction isOutgoingEventBasedGatewayConnection(connection) {\n\n  if (connection && connection.source) {\n    return is(connection.source, 'bpmn:EventBasedGateway');\n  }\n}\n\nfunction areOutgoingEventBasedGatewayConnections(connections) {\n  connections = connections || [];\n\n  return connections.some(isOutgoingEventBasedGatewayConnection);\n}\n\nfunction getRootElement(element) {\n  return getParent(element, 'bpmn:Process') || getParent(element, 'bpmn:Collaboration');\n}\n","import RulesModule from 'diagram-js/lib/features/rules';\n\nimport BpmnRules from './BpmnRules';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'bpmnRules' ],\n  bpmnRules: [ 'type', BpmnRules ]\n};\n","import inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * An abstract provider that allows modelers to implement a custom\n * ordering of diagram elements on the canvas.\n *\n * It makes sure that the order is always preserved during element\n * creation and move operations.\n *\n * In order to use this behavior, inherit from it and override\n * the method {@link OrderingProvider#getOrdering}.\n *\n * @example\n *\n * ```javascript\n * function CustomOrderingProvider(eventBus) {\n *   OrderingProvider.call(this, eventBus);\n *\n *   this.getOrdering = function(element, newParent) {\n *     // always insert elements at the front\n *     // when moving\n *     return {\n *       index: 0,\n *       parent: newParent\n *     };\n *   };\n * }\n * ```\n *\n * @param {EventBus} eventBus\n */\nexport default function OrderingProvider(eventBus) {\n\n  CommandInterceptor.call(this, eventBus);\n\n\n  var self = this;\n\n  this.preExecute([ 'shape.create', 'connection.create' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.parent = ordering.parent;\n      }\n\n      context.parentIndex = ordering.index;\n    }\n  });\n\n  this.preExecute([ 'shape.move', 'connection.move' ], function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection,\n        parent = context.newParent || element.parent;\n\n    var ordering = self.getOrdering(element, parent);\n\n    if (ordering) {\n\n      if (ordering.parent !== undefined) {\n        context.newParent = ordering.parent;\n      }\n\n      context.newParentIndex = ordering.index;\n    }\n  });\n}\n\n/**\n * Return a custom ordering of the element, both in terms\n * of parent element and index in the new parent.\n *\n * Implementors of this method must return an object with\n * `parent` _and_ `index` in it.\n *\n * @param {djs.model.Base} element\n * @param {djs.model.Shape} newParent\n *\n * @return {Object} ordering descriptor\n */\nOrderingProvider.prototype.getOrdering = function(element, newParent) {\n  return null;\n};\n\ninherits(OrderingProvider, CommandInterceptor);","import inherits from 'inherits';\n\nimport OrderingProvider from 'diagram-js/lib/features/ordering/OrderingProvider';\n\nimport {\n  isAny\n} from '../modeling/util/ModelingUtil';\n\nimport {\n  findIndex,\n  find\n} from 'min-dash';\n\n\n/**\n * a simple ordering provider that makes sure:\n *\n * (0) labels and groups are rendered always on top\n * (1) elements are ordered by a {level} property\n */\nexport default function BpmnOrderingProvider(eventBus, canvas, translate) {\n\n  OrderingProvider.call(this, eventBus);\n\n  var orders = [\n    { type: 'bpmn:SubProcess', order: { level: 6 } },\n    {\n      type: 'bpmn:SequenceFlow',\n      order: {\n        level: 3,\n        containers: [\n          'bpmn:Participant',\n          'bpmn:FlowElementsContainer'\n        ]\n      }\n    },\n\n    // handle DataAssociation(s) like message flows and render them always on top\n    {\n      type: 'bpmn:DataAssociation',\n      order: {\n        level: 9,\n        containers: [\n          'bpmn:Collaboration',\n          'bpmn:Process'\n        ]\n      }\n    },\n    {\n      type: 'bpmn:MessageFlow', order: {\n        level: 9,\n        containers: [ 'bpmn:Collaboration' ]\n      }\n    },\n    {\n      type: 'bpmn:Association',\n      order: {\n        level: 6,\n        containers: [\n          'bpmn:Participant',\n          'bpmn:FlowElementsContainer',\n          'bpmn:Collaboration'\n        ]\n      }\n    },\n    { type: 'bpmn:BoundaryEvent', order: { level: 8 } },\n    {\n      type: 'bpmn:Group',\n      order: {\n        level: 10,\n        containers: [\n          'bpmn:Collaboration',\n          'bpmn:Process'\n        ]\n      }\n    },\n    { type: 'bpmn:FlowElement', order: { level: 5 } },\n    { type: 'bpmn:Participant', order: { level: -2 } },\n    { type: 'bpmn:Lane', order: { level: -1 } }\n  ];\n\n  function computeOrder(element) {\n    if (element.labelTarget) {\n      return { level: 10 };\n    }\n\n    var entry = find(orders, function(o) {\n      return isAny(element, [ o.type ]);\n    });\n\n    return entry && entry.order || { level: 1 };\n  }\n\n  function getOrder(element) {\n\n    var order = element.order;\n\n    if (!order) {\n      element.order = order = computeOrder(element);\n    }\n\n    return order;\n  }\n\n  function findActualParent(element, newParent, containers) {\n\n    var actualParent = newParent;\n\n    while (actualParent) {\n\n      if (isAny(actualParent, containers)) {\n        break;\n      }\n\n      actualParent = actualParent.parent;\n    }\n\n    if (!actualParent) {\n      throw new Error(translate('no parent for {element} in {parent}', {\n        element: element.id,\n        parent: newParent.id\n      }));\n    }\n\n    return actualParent;\n  }\n\n  this.getOrdering = function(element, newParent) {\n\n    // render labels always on top\n    if (element.labelTarget) {\n      return {\n        parent: canvas.getRootElement(),\n        index: -1\n      };\n    }\n\n    var elementOrder = getOrder(element);\n\n\n    if (elementOrder.containers) {\n      newParent = findActualParent(element, newParent, elementOrder.containers);\n    }\n\n\n    var currentIndex = newParent.children.indexOf(element);\n\n    var insertIndex = findIndex(newParent.children, function(child) {\n\n      // do not compare with labels, they are created\n      // in the wrong order (right after elements) during import and\n      // mess up the positioning.\n      if (!element.labelTarget && child.labelTarget) {\n        return false;\n      }\n\n      return elementOrder.level < getOrder(child).level;\n    });\n\n\n    // if the element is already in the child list at\n    // a smaller index, we need to adjust the insert index.\n    // this takes into account that the element is being removed\n    // before being re-inserted\n    if (insertIndex !== -1) {\n      if (currentIndex !== -1 && currentIndex < insertIndex) {\n        insertIndex -= 1;\n      }\n    }\n\n    return {\n      index: insertIndex,\n      parent: newParent\n    };\n  };\n}\n\nBpmnOrderingProvider.$inject = [ 'eventBus', 'canvas', 'translate' ];\n\ninherits(BpmnOrderingProvider, OrderingProvider);","import translate from 'diagram-js/lib/i18n/translate';\n\nimport BpmnOrderingProvider from './BpmnOrderingProvider';\n\nexport default {\n  __depends__: [\n    translate\n  ],\n  __init__: [ 'bpmnOrderingProvider' ],\n  bpmnOrderingProvider: [ 'type', BpmnOrderingProvider ]\n};","import {\n  uniqueBy,\n  isArray\n} from 'min-dash';\n\n\n/**\n * A service that offers un- and redoable execution of commands.\n *\n * The command stack is responsible for executing modeling actions\n * in a un- and redoable manner. To do this it delegates the actual\n * command execution to {@link CommandHandler}s.\n *\n * Command handlers provide {@link CommandHandler#execute(ctx)} and\n * {@link CommandHandler#revert(ctx)} methods to un- and redo a command\n * identified by a command context.\n *\n *\n * ## Life-Cycle events\n *\n * In the process the command stack fires a number of life-cycle events\n * that other components to participate in the command execution.\n *\n *    * preExecute\n *    * preExecuted\n *    * execute\n *    * executed\n *    * postExecute\n *    * postExecuted\n *    * revert\n *    * reverted\n *\n * A special event is used for validating, whether a command can be\n * performed prior to its execution.\n *\n *    * canExecute\n *\n * Each of the events is fired as `commandStack.{eventName}` and\n * `commandStack.{commandName}.{eventName}`, respectively. This gives\n * components fine grained control on where to hook into.\n *\n * The event object fired transports `command`, the name of the\n * command and `context`, the command context.\n *\n *\n * ## Creating Command Handlers\n *\n * Command handlers should provide the {@link CommandHandler#execute(ctx)}\n * and {@link CommandHandler#revert(ctx)} methods to implement\n * redoing and undoing of a command.\n *\n * A command handler _must_ ensure undo is performed properly in order\n * not to break the undo chain. It must also return the shapes that\n * got changed during the `execute` and `revert` operations.\n *\n * Command handlers may execute other modeling operations (and thus\n * commands) in their `preExecute` and `postExecute` phases. The command\n * stack will properly group all commands together into a logical unit\n * that may be re- and undone atomically.\n *\n * Command handlers must not execute other commands from within their\n * core implementation (`execute`, `revert`).\n *\n *\n * ## Change Tracking\n *\n * During the execution of the CommandStack it will keep track of all\n * elements that have been touched during the command's execution.\n *\n * At the end of the CommandStack execution it will notify interested\n * components via an 'elements.changed' event with all the dirty\n * elements.\n *\n * The event can be picked up by components that are interested in the fact\n * that elements have been changed. One use case for this is updating\n * their graphical representation after moving / resizing or deletion.\n *\n * @see CommandHandler\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function CommandStack(eventBus, injector) {\n\n  /**\n   * A map of all registered command handlers.\n   *\n   * @type {Object}\n   */\n  this._handlerMap = {};\n\n  /**\n   * A stack containing all re/undoable actions on the diagram\n   *\n   * @type {Array<Object>}\n   */\n  this._stack = [];\n\n  /**\n   * The current index on the stack\n   *\n   * @type {Number}\n   */\n  this._stackIdx = -1;\n\n  /**\n   * Current active commandStack execution\n   *\n   * @type {Object}\n   */\n  this._currentExecution = {\n    actions: [],\n    dirty: []\n  };\n\n\n  this._injector = injector;\n  this._eventBus = eventBus;\n\n  this._uid = 1;\n\n  eventBus.on([\n    'diagram.destroy',\n    'diagram.clear'\n  ], function() {\n    this.clear(false);\n  }, this);\n}\n\nCommandStack.$inject = [ 'eventBus', 'injector' ];\n\n\n/**\n * Execute a command\n *\n * @param {String} command the command to execute\n * @param {Object} context the environment to execute the command in\n */\nCommandStack.prototype.execute = function(command, context) {\n  if (!command) {\n    throw new Error('command required');\n  }\n\n  var action = { command: command, context: context };\n\n  this._pushAction(action);\n  this._internalExecute(action);\n  this._popAction(action);\n};\n\n\n/**\n * Ask whether a given command can be executed.\n *\n * Implementors may hook into the mechanism on two ways:\n *\n *   * in event listeners:\n *\n *     Users may prevent the execution via an event listener.\n *     It must prevent the default action for `commandStack.(<command>.)canExecute` events.\n *\n *   * in command handlers:\n *\n *     If the method {@link CommandHandler#canExecute} is implemented in a handler\n *     it will be called to figure out whether the execution is allowed.\n *\n * @param  {String} command the command to execute\n * @param  {Object} context the environment to execute the command in\n *\n * @return {Boolean} true if the command can be executed\n */\nCommandStack.prototype.canExecute = function(command, context) {\n\n  var action = { command: command, context: context };\n\n  var handler = this._getHandler(command);\n\n  var result = this._fire(command, 'canExecute', action);\n\n  // handler#canExecute will only be called if no listener\n  // decided on a result already\n  if (result === undefined) {\n    if (!handler) {\n      return false;\n    }\n\n    if (handler.canExecute) {\n      result = handler.canExecute(context);\n    }\n  }\n\n  return result;\n};\n\n\n/**\n * Clear the command stack, erasing all undo / redo history\n */\nCommandStack.prototype.clear = function(emit) {\n  this._stack.length = 0;\n  this._stackIdx = -1;\n\n  if (emit !== false) {\n    this._fire('changed');\n  }\n};\n\n\n/**\n * Undo last command(s)\n */\nCommandStack.prototype.undo = function() {\n  var action = this._getUndoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalUndo(action);\n      next = this._getUndoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Redo last command(s)\n */\nCommandStack.prototype.redo = function() {\n  var action = this._getRedoAction(),\n      next;\n\n  if (action) {\n    this._pushAction(action);\n\n    while (action) {\n      this._internalExecute(action, true);\n      next = this._getRedoAction();\n\n      if (!next || next.id !== action.id) {\n        break;\n      }\n\n      action = next;\n    }\n\n    this._popAction();\n  }\n};\n\n\n/**\n * Register a handler instance with the command stack\n *\n * @param {String} command\n * @param {CommandHandler} handler\n */\nCommandStack.prototype.register = function(command, handler) {\n  this._setHandler(command, handler);\n};\n\n\n/**\n * Register a handler type with the command stack\n * by instantiating it and injecting its dependencies.\n *\n * @param {String} command\n * @param {Function} a constructor for a {@link CommandHandler}\n */\nCommandStack.prototype.registerHandler = function(command, handlerCls) {\n\n  if (!command || !handlerCls) {\n    throw new Error('command and handlerCls must be defined');\n  }\n\n  var handler = this._injector.instantiate(handlerCls);\n  this.register(command, handler);\n};\n\nCommandStack.prototype.canUndo = function() {\n  return !!this._getUndoAction();\n};\n\nCommandStack.prototype.canRedo = function() {\n  return !!this._getRedoAction();\n};\n\n// stack access  //////////////////////\n\nCommandStack.prototype._getRedoAction = function() {\n  return this._stack[this._stackIdx + 1];\n};\n\n\nCommandStack.prototype._getUndoAction = function() {\n  return this._stack[this._stackIdx];\n};\n\n\n// internal functionality //////////////////////\n\nCommandStack.prototype._internalUndo = function(action) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n    self._fire(command, 'revert', action);\n\n    if (handler.revert) {\n      self._markDirty(handler.revert(context));\n    }\n\n    self._revertedAction(action);\n\n    self._fire(command, 'reverted', action);\n  });\n};\n\n\nCommandStack.prototype._fire = function(command, qualifier, event) {\n  if (arguments.length < 3) {\n    event = qualifier;\n    qualifier = null;\n  }\n\n  var names = qualifier ? [ command + '.' + qualifier, qualifier ] : [ command ],\n      i, name, result;\n\n  event = this._eventBus.createEvent(event);\n\n  for (i = 0; (name = names[i]); i++) {\n    result = this._eventBus.fire('commandStack.' + name, event);\n\n    if (event.cancelBubble) {\n      break;\n    }\n  }\n\n  return result;\n};\n\nCommandStack.prototype._createId = function() {\n  return this._uid++;\n};\n\nCommandStack.prototype._atomicDo = function(fn) {\n\n  var execution = this._currentExecution;\n\n  execution.atomic = true;\n\n  try {\n    fn();\n  } finally {\n    execution.atomic = false;\n  }\n};\n\nCommandStack.prototype._internalExecute = function(action, redo) {\n  var self = this;\n\n  var command = action.command,\n      context = action.context;\n\n  var handler = this._getHandler(command);\n\n  if (!handler) {\n    throw new Error('no command handler registered for <' + command + '>');\n  }\n\n  this._pushAction(action);\n\n  if (!redo) {\n    this._fire(command, 'preExecute', action);\n\n    if (handler.preExecute) {\n      handler.preExecute(context);\n    }\n\n    this._fire(command, 'preExecuted', action);\n  }\n\n  // guard against illegal nested command stack invocations\n  this._atomicDo(function() {\n\n    self._fire(command, 'execute', action);\n\n    if (handler.execute) {\n\n      // actual execute + mark return results as dirty\n      self._markDirty(handler.execute(context));\n    }\n\n    // log to stack\n    self._executedAction(action, redo);\n\n    self._fire(command, 'executed', action);\n  });\n\n  if (!redo) {\n    this._fire(command, 'postExecute', action);\n\n    if (handler.postExecute) {\n      handler.postExecute(context);\n    }\n\n    this._fire(command, 'postExecuted', action);\n  }\n\n  this._popAction(action);\n};\n\n\nCommandStack.prototype._pushAction = function(action) {\n\n  var execution = this._currentExecution,\n      actions = execution.actions;\n\n  var baseAction = actions[0];\n\n  if (execution.atomic) {\n    throw new Error('illegal invocation in <execute> or <revert> phase (action: ' + action.command + ')');\n  }\n\n  if (!action.id) {\n    action.id = (baseAction && baseAction.id) || this._createId();\n  }\n\n  actions.push(action);\n};\n\n\nCommandStack.prototype._popAction = function() {\n  var execution = this._currentExecution,\n      actions = execution.actions,\n      dirty = execution.dirty;\n\n  actions.pop();\n\n  if (!actions.length) {\n    this._eventBus.fire('elements.changed', { elements: uniqueBy('id', dirty.reverse()) });\n\n    dirty.length = 0;\n\n    this._fire('changed');\n  }\n};\n\n\nCommandStack.prototype._markDirty = function(elements) {\n  var execution = this._currentExecution;\n\n  if (!elements) {\n    return;\n  }\n\n  elements = isArray(elements) ? elements : [ elements ];\n\n  execution.dirty = execution.dirty.concat(elements);\n};\n\n\nCommandStack.prototype._executedAction = function(action, redo) {\n  var stackIdx = ++this._stackIdx;\n\n  if (!redo) {\n    this._stack.splice(stackIdx, this._stack.length, action);\n  }\n};\n\n\nCommandStack.prototype._revertedAction = function(action) {\n  this._stackIdx--;\n};\n\n\nCommandStack.prototype._getHandler = function(command) {\n  return this._handlerMap[command];\n};\n\nCommandStack.prototype._setHandler = function(command, handler) {\n  if (!command || !handler) {\n    throw new Error('command and handler required');\n  }\n\n  if (this._handlerMap[command]) {\n    throw new Error('overriding handler for command <' + command + '>');\n  }\n\n  this._handlerMap[command] = handler;\n};\n","import CommandStack from './CommandStack';\n\nexport default {\n  commandStack: [ 'type', CommandStack ]\n};\n","import {\n  isString,\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  attr as domAttr,\n  classes as domClasses,\n  remove as domRemove,\n  delegate as domDelegate\n} from 'min-dom';\n\nimport Ids from '../../util/IdGenerator';\n\n// document wide unique tooltip ids\nvar ids = new Ids('tt');\n\n\nfunction createRoot(parentNode) {\n  var root = domify(\n    '<div class=\"djs-tooltip-container\" style=\"position: absolute; width: 0; height: 0;\" />'\n  );\n\n  parentNode.insertBefore(root, parentNode.firstChild);\n\n  return root;\n}\n\n\nfunction setPosition(el, x, y) {\n  assign(el.style, { left: x + 'px', top: y + 'px' });\n}\n\nfunction setVisible(el, visible) {\n  el.style.display = visible === false ? 'none' : '';\n}\n\n\nvar tooltipClass = 'djs-tooltip',\n    tooltipSelector = '.' + tooltipClass;\n\n/**\n * A service that allows users to render tool tips on the diagram.\n *\n * The tooltip service will take care of updating the tooltip positioning\n * during navigation + zooming.\n *\n * @example\n *\n * ```javascript\n *\n * // add a pink badge on the top left of the shape\n * tooltips.add({\n *   position: {\n *     x: 50,\n *     y: 100\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>'\n * });\n *\n * // or with optional life span\n * tooltips.add({\n *   position: {\n *     top: -5,\n *     left: -5\n *   },\n *   html: '<div style=\"width: 10px; background: fuchsia; color: white;\">0</div>',\n *   ttl: 2000\n * });\n *\n * // remove a tool tip\n * var id = tooltips.add(...);\n * tooltips.remove(id);\n * ```\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Tooltips(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  this._ids = ids;\n\n  this._tooltipDefaults = {\n    show: {\n      minZoom: 0.7,\n      maxZoom: 5.0\n    }\n  };\n\n  /**\n   * Mapping tooltipId -> tooltip\n   */\n  this._tooltips = {};\n\n  // root html element for all tooltips\n  this._tooltipRoot = createRoot(canvas.getContainer());\n\n\n  var self = this;\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mouseover', function(event) {\n    self.trigger('mouseover', event);\n  });\n\n  domDelegate.bind(this._tooltipRoot, tooltipSelector, 'mouseout', function(event) {\n    self.trigger('mouseout', event);\n  });\n\n  this._init();\n}\n\n\nTooltips.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Adds a HTML tooltip to the diagram\n *\n * @param {Object}               tooltip   the tooltip configuration\n *\n * @param {String|DOMElement}    tooltip.html                 html element to use as an tooltip\n * @param {Object}               [tooltip.show]               show configuration\n * @param {Number}               [tooltip.show.minZoom]       minimal zoom level to show the tooltip\n * @param {Number}               [tooltip.show.maxZoom]       maximum zoom level to show the tooltip\n * @param {Object}               tooltip.position             where to attach the tooltip\n * @param {Number}               [tooltip.position.left]      relative to element bbox left attachment\n * @param {Number}               [tooltip.position.top]       relative to element bbox top attachment\n * @param {Number}               [tooltip.position.bottom]    relative to element bbox bottom attachment\n * @param {Number}               [tooltip.position.right]     relative to element bbox right attachment\n * @param {Number}               [tooltip.timeout=-1]\n *\n * @return {String}              id that may be used to reference the tooltip for update or removal\n */\nTooltips.prototype.add = function(tooltip) {\n\n  if (!tooltip.position) {\n    throw new Error('must specifiy tooltip position');\n  }\n\n  if (!tooltip.html) {\n    throw new Error('must specifiy tooltip html');\n  }\n\n  var id = this._ids.next();\n\n  tooltip = assign({}, this._tooltipDefaults, tooltip, {\n    id: id\n  });\n\n  this._addTooltip(tooltip);\n\n  if (tooltip.timeout) {\n    this.setTimeout(tooltip);\n  }\n\n  return id;\n};\n\nTooltips.prototype.trigger = function(action, event) {\n\n  var node = event.delegateTarget || event.target;\n\n  var tooltip = this.get(domAttr(node, 'data-tooltip-id'));\n\n  if (!tooltip) {\n    return;\n  }\n\n  if (action === 'mouseover' && tooltip.timeout) {\n    this.clearTimeout(tooltip);\n  }\n\n  if (action === 'mouseout' && tooltip.timeout) {\n\n    // cut timeout after mouse out\n    tooltip.timeout = 1000;\n\n    this.setTimeout(tooltip);\n  }\n};\n\n/**\n * Get a tooltip with the given id\n *\n * @param {String} id\n */\nTooltips.prototype.get = function(id) {\n\n  if (typeof id !== 'string') {\n    id = id.id;\n  }\n\n  return this._tooltips[id];\n};\n\nTooltips.prototype.clearTimeout = function(tooltip) {\n\n  tooltip = this.get(tooltip);\n\n  if (!tooltip) {\n    return;\n  }\n\n  var removeTimer = tooltip.removeTimer;\n\n  if (removeTimer) {\n    clearTimeout(removeTimer);\n    tooltip.removeTimer = null;\n  }\n};\n\nTooltips.prototype.setTimeout = function(tooltip) {\n\n  tooltip = this.get(tooltip);\n\n  if (!tooltip) {\n    return;\n  }\n\n  this.clearTimeout(tooltip);\n\n  var self = this;\n\n  tooltip.removeTimer = setTimeout(function() {\n    self.remove(tooltip);\n  }, tooltip.timeout);\n};\n\n/**\n * Remove an tooltip with the given id\n *\n * @param {String} id\n */\nTooltips.prototype.remove = function(id) {\n\n  var tooltip = this.get(id);\n\n  if (tooltip) {\n    domRemove(tooltip.html);\n    domRemove(tooltip.htmlContainer);\n\n    delete tooltip.htmlContainer;\n\n    delete this._tooltips[tooltip.id];\n  }\n};\n\n\nTooltips.prototype.show = function() {\n  setVisible(this._tooltipRoot);\n};\n\n\nTooltips.prototype.hide = function() {\n  setVisible(this._tooltipRoot, false);\n};\n\n\nTooltips.prototype._updateRoot = function(viewbox) {\n  var a = viewbox.scale || 1;\n  var d = viewbox.scale || 1;\n\n  var matrix = 'matrix(' + a + ',0,0,' + d + ',' + (-1 * viewbox.x * a) + ',' + (-1 * viewbox.y * d) + ')';\n\n  this._tooltipRoot.style.transform = matrix;\n  this._tooltipRoot.style['-ms-transform'] = matrix;\n};\n\n\nTooltips.prototype._addTooltip = function(tooltip) {\n\n  var id = tooltip.id,\n      html = tooltip.html,\n      htmlContainer,\n      tooltipRoot = this._tooltipRoot;\n\n  // unwrap jquery (for those who need it)\n  if (html.get && html.constructor.prototype.jquery) {\n    html = html.get(0);\n  }\n\n  // create proper html elements from\n  // tooltip HTML strings\n  if (isString(html)) {\n    html = domify(html);\n  }\n\n  htmlContainer = domify('<div data-tooltip-id=\"' + id + '\" class=\"' + tooltipClass + '\" style=\"position: absolute\">');\n\n  htmlContainer.appendChild(html);\n\n  if (tooltip.type) {\n    domClasses(htmlContainer).add('djs-tooltip-' + tooltip.type);\n  }\n\n  if (tooltip.className) {\n    domClasses(htmlContainer).add(tooltip.className);\n  }\n\n  tooltip.htmlContainer = htmlContainer;\n\n  tooltipRoot.appendChild(htmlContainer);\n\n  this._tooltips[id] = tooltip;\n\n  this._updateTooltip(tooltip);\n};\n\n\nTooltips.prototype._updateTooltip = function(tooltip) {\n\n  var position = tooltip.position,\n      htmlContainer = tooltip.htmlContainer;\n\n  // update overlay html based on tooltip x, y\n\n  setPosition(htmlContainer, position.x, position.y);\n};\n\n\nTooltips.prototype._updateTooltipVisibilty = function(viewbox) {\n\n  forEach(this._tooltips, function(tooltip) {\n    var show = tooltip.show,\n        htmlContainer = tooltip.htmlContainer,\n        visible = true;\n\n    if (show) {\n      if (show.minZoom > viewbox.scale ||\n          show.maxZoom < viewbox.scale) {\n        visible = false;\n      }\n\n      setVisible(htmlContainer, visible);\n    }\n  });\n};\n\nTooltips.prototype._init = function() {\n\n  var self = this;\n\n  // scroll/zoom integration\n\n  function updateViewbox(viewbox) {\n    self._updateRoot(viewbox);\n    self._updateTooltipVisibilty(viewbox);\n\n    self.show();\n  }\n\n  this._eventBus.on('canvas.viewbox.changing', function(event) {\n    self.hide();\n  });\n\n  this._eventBus.on('canvas.viewbox.changed', function(event) {\n    updateViewbox(event.viewbox);\n  });\n};\n","import Tooltips from './Tooltips';\n\nexport default {\n  __init__: [ 'tooltips' ],\n  tooltips: [ 'type', Tooltips ]\n};","/**\n * Remove from the beginning of a collection until it is empty.\n *\n * This is a null-safe operation that ensures elements\n * are being removed from the given collection until the\n * collection is empty.\n *\n * The implementation deals with the fact that a remove operation\n * may touch, i.e. remove multiple elements in the collection\n * at a time.\n *\n * @param {Array<Object>} [collection]\n * @param {Function} removeFn\n *\n * @return {Array<Object>} the cleared collection\n */\nexport function saveClear(collection, removeFn) {\n\n  if (typeof removeFn !== 'function') {\n    throw new Error('removeFn iterator must be a function');\n  }\n\n  if (!collection) {\n    return;\n  }\n\n  var e;\n\n  while ((e = collection[0])) {\n    removeFn(e);\n  }\n\n  return collection;\n}\n","import {\n  forEach,\n  filter\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nvar LOW_PRIORITY = 250,\n    HIGH_PRIORITY = 1400;\n\nimport {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../util/Collections';\n\nimport { saveClear } from '../../util/Removal';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\n\n/**\n * A handler that makes sure labels are properly moved with\n * their label targets.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n */\nexport default function LabelSupport(injector, eventBus, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n  // remove labels from the collection that are being\n  // moved with other elements anyway\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = removeLabels(shapes);\n    context.validatedShapes = removeLabels(validatedShapes);\n  });\n\n  // add labels to visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes;\n\n    var labels = [];\n\n    forEach(shapes, function(element) {\n\n      forEach(element.labels, function(label) {\n\n        if (!label.hidden && context.shapes.indexOf(label) === -1) {\n          labels.push(label);\n        }\n\n        if (element.labelTarget) {\n          labels.push(element);\n        }\n      });\n    });\n\n    forEach(labels, function(label) {\n      movePreview.makeDraggable(context, label, true);\n    });\n\n  });\n\n  // add all labels to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        enclosedElements = closure.enclosedElements;\n\n    var enclosedLabels = [];\n\n    // find labels that are not part of\n    // move closure yet and add them\n    forEach(enclosedElements, function(element) {\n      forEach(element.labels, function(label) {\n\n        if (!enclosedElements[label.id]) {\n          enclosedLabels.push(label);\n        }\n      });\n    });\n\n    closure.addAll(enclosedLabels);\n  });\n\n\n  this.preExecute([\n    'connection.delete',\n    'shape.delete'\n  ], function(e) {\n\n    var context = e.context,\n        element = context.connection || context.shape;\n\n    saveClear(element.labels, function(label) {\n      modeling.removeShape(label, { nested: true });\n    });\n  });\n\n\n  this.execute('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = shape.labelTarget;\n\n    // unset labelTarget\n    if (labelTarget) {\n      context.labelTargetIndex = collectionIdx(labelTarget.labels, shape);\n      context.labelTarget = labelTarget;\n\n      shape.labelTarget = null;\n    }\n  });\n\n  this.revert('shape.delete', function(e) {\n\n    var context = e.context,\n        shape = context.shape,\n        labelTarget = context.labelTarget,\n        labelTargetIndex = context.labelTargetIndex;\n\n    // restore labelTarget\n    if (labelTarget) {\n      collectionAdd(labelTarget.labels, shape, labelTargetIndex);\n\n      shape.labelTarget = labelTarget;\n    }\n  });\n\n}\n\ninherits(LabelSupport, CommandInterceptor);\n\nLabelSupport.$inject = [\n  'injector',\n  'eventBus',\n  'modeling'\n];\n\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeLabels(elements) {\n\n  return filter(elements, function(element) {\n\n    // filter out labels that are move together\n    // with their label targets\n    return elements.indexOf(element.labelTarget) === -1;\n  });\n}\n","import LabelSupport from './LabelSupport';\n\nexport default {\n  __init__: [ 'labelSupport'],\n  labelSupport: [ 'type', LabelSupport ]\n};\n","import {\n  flatten,\n  filter,\n  forEach,\n  groupBy,\n  map,\n  unionBy\n} from 'min-dash';\n\nimport { saveClear } from '../../util/Removal';\n\nimport { getNewAttachShapeDelta } from '../../util/AttachUtil';\n\nimport inherits from 'inherits';\n\nimport CommandInterceptor from '../../command/CommandInterceptor';\n\nvar LOW_PRIORITY = 251,\n    HIGH_PRIORITY = 1401;\n\nvar MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Adds the notion of attached elements to the modeler.\n *\n * Optionally depends on `diagram-js/lib/features/move` to render\n * the attached elements during move preview.\n *\n * Optionally depends on `diagram-js/lib/features/label-support`\n * to render attached labels during move preview.\n *\n * @param {didi.Injector} injector\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {Rules} rules\n * @param {Modeling} modeling\n */\nexport default function AttachSupport(injector, eventBus, canvas, rules, modeling) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  var movePreview = injector.get('movePreview', false);\n\n\n  // remove all the attached elements from the shapes to be validated\n  // add all the attached shapes to the overall list of moved shapes\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        validatedShapes = context.validatedShapes;\n\n    context.shapes = addAttached(shapes);\n\n    context.validatedShapes = removeAttached(validatedShapes);\n  });\n\n  // add attachers to the visual's group\n  movePreview && eventBus.on('shape.move.start', LOW_PRIORITY, function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      movePreview.makeDraggable(context, attacher, true);\n\n      forEach(attacher.labels, function(label) {\n        movePreview.makeDraggable(context, label, true);\n      });\n    });\n  });\n\n  // add attach-ok marker to current host\n  movePreview && eventBus.on('shape.move.start', function(event) {\n    var context = event.context,\n        shapes = context.shapes;\n\n    if (shapes.length !== 1) {\n      return;\n    }\n\n    var shape = shapes[0];\n\n    var host = shape.host;\n\n    if (host) {\n      canvas.addMarker(host, MARKER_ATTACH);\n\n      eventBus.once([\n        'shape.move.out',\n        'shape.move.cleanup'\n      ], function() {\n        canvas.removeMarker(host, MARKER_ATTACH);\n      });\n    }\n  });\n\n  // add all attachers to move closure\n  this.preExecuted('elements.move', HIGH_PRIORITY, function(e) {\n    var context = e.context,\n        closure = context.closure,\n        shapes = context.shapes,\n        attachers = getAttachers(shapes);\n\n    forEach(attachers, function(attacher) {\n      closure.add(attacher, closure.topLevel[attacher.host.id]);\n    });\n  });\n\n  // perform the attaching after shapes are done moving\n  this.postExecuted('elements.move', function(e) {\n\n    var context = e.context,\n        shapes = context.shapes,\n        newHost = context.newHost,\n        attachers;\n\n    // only single elements can be attached\n    // multiply elements can be detached\n    if (newHost && shapes.length !== 1) {\n      return;\n    }\n\n    if (newHost) {\n      attachers = shapes;\n    } else {\n\n      // find attachers moved without host\n      attachers = filter(shapes, function(shape) {\n        var host = shape.host;\n\n        return isAttacher(shape) && !includes(shapes, host);\n      });\n    }\n\n    forEach(attachers, function(attacher) {\n      modeling.updateAttachment(attacher, newHost);\n    });\n  });\n\n  // ensure invalid attachment connections are removed\n  this.postExecuted('elements.move', function(e) {\n\n    var shapes = e.context.shapes;\n\n    forEach(shapes, function(shape) {\n\n      forEach(shape.attachers, function(attacher) {\n\n        // remove invalid outgoing connections\n        forEach(attacher.outgoing.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnect', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n\n        // remove invalid incoming connections\n        forEach(attacher.incoming.slice(), function(connection) {\n          var allowed = rules.allowed('connection.reconnect', {\n            connection: connection,\n            source: connection.source,\n            target: connection.target\n          });\n\n          if (!allowed) {\n            modeling.removeConnection(connection);\n          }\n        });\n      });\n    });\n  });\n\n  this.postExecute('shape.create', function(e) {\n    var context = e.context,\n        shape = context.shape,\n        host = context.host;\n\n    if (host) {\n      modeling.updateAttachment(shape, host);\n    }\n  });\n\n  // update attachments if the host is replaced\n  this.postExecute('shape.replace', function(e) {\n\n    var context = e.context,\n        oldShape = context.oldShape,\n        newShape = context.newShape;\n\n    // move the attachers to the new host\n    saveClear(oldShape.attachers, function(attacher) {\n      var allowed = rules.allowed('elements.move', {\n        target: newShape,\n        shapes: [attacher]\n      });\n\n      if (allowed === 'attach') {\n        modeling.updateAttachment(attacher, newShape);\n      } else {\n        modeling.removeShape(attacher);\n      }\n    });\n\n    // move attachers if new host has different size\n    if (newShape.attachers.length) {\n\n      forEach(newShape.attachers, function(attacher) {\n        var delta = getNewAttachShapeDelta(attacher, oldShape, newShape);\n        modeling.moveShape(attacher, delta, attacher.parent);\n      });\n    }\n\n  });\n\n  // move shape on host resize\n  this.postExecute('shape.resize', function(event) {\n    var context = event.context,\n        shape = context.shape,\n        oldBounds = context.oldBounds,\n        newBounds = context.newBounds,\n        attachers = shape.attachers,\n        hints = context.hints || {};\n\n    if (hints.attachSupport === false) {\n      return;\n    }\n\n    forEach(attachers, function(attacher) {\n      var delta = getNewAttachShapeDelta(attacher, oldBounds, newBounds);\n\n      modeling.moveShape(attacher, delta, attacher.parent);\n\n      forEach(attacher.labels, function(label) {\n        modeling.moveShape(label, delta, label.parent);\n      });\n    });\n  });\n\n  // remove attachments\n  this.preExecute('shape.delete', function(event) {\n\n    var shape = event.context.shape;\n\n    saveClear(shape.attachers, function(attacher) {\n      modeling.removeShape(attacher);\n    });\n\n    if (shape.host) {\n      modeling.updateAttachment(shape, null);\n    }\n  });\n}\n\ninherits(AttachSupport, CommandInterceptor);\n\nAttachSupport.$inject = [\n  'injector',\n  'eventBus',\n  'canvas',\n  'rules',\n  'modeling'\n];\n\n\n/**\n * Return attachers of the given shapes\n *\n * @param {Array<djs.model.Base>} shapes\n * @return {Array<djs.model.Base>}\n */\nfunction getAttachers(shapes) {\n  return flatten(map(shapes, function(s) {\n    return s.attachers || [];\n  }));\n}\n\n/**\n * Return a combined list of elements and\n * attachers.\n *\n * @param {Array<djs.model.Base>} elements\n * @return {Array<djs.model.Base>} filtered\n */\nfunction addAttached(elements) {\n  var attachers = getAttachers(elements);\n\n  return unionBy('id', elements, attachers);\n}\n\n/**\n * Return a filtered list of elements that do not\n * contain attached elements with hosts being part\n * of the selection.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeAttached(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while (element) {\n\n      // host in selection\n      if (element.host && ids[element.host.id]) {\n        return false;\n      }\n\n      element = element.parent;\n    }\n\n    return true;\n  });\n}\n\nfunction isAttacher(shape) {\n  return !!shape.host;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import RulesModule from '../rules';\n\nimport AttachSupport from './AttachSupport';\n\nexport default {\n  __depends__: [\n    RulesModule\n  ],\n  __init__: [ 'attachSupport' ],\n  attachSupport: [ 'type', AttachSupport ]\n};\n","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  closest as domClosest\n} from 'min-dom';\n\nvar LOW_PRIORITY = 250;\n\n/**\n * The tool manager acts as middle-man between the available tool's and the Palette,\n * it takes care of making sure that the correct active state is set.\n *\n * @param  {Object}    eventBus\n * @param  {Object}    dragging\n */\nexport default function ToolManager(eventBus, dragging) {\n  this._eventBus = eventBus;\n  this._dragging = dragging;\n\n  this._tools = [];\n  this._active = null;\n}\n\nToolManager.$inject = [ 'eventBus', 'dragging' ];\n\nToolManager.prototype.registerTool = function(name, events) {\n  var tools = this._tools;\n\n  if (!events) {\n    throw new Error('A tool has to be registered with it\\'s \"events\"');\n  }\n\n  tools.push(name);\n\n  this.bindEvents(name, events);\n};\n\nToolManager.prototype.isActive = function(tool) {\n  return tool && this._active === tool;\n};\n\nToolManager.prototype.length = function(tool) {\n  return this._tools.length;\n};\n\nToolManager.prototype.setActive = function(tool) {\n  var eventBus = this._eventBus;\n\n  if (this._active !== tool) {\n    this._active = tool;\n\n    eventBus.fire('tool-manager.update', { tool: tool });\n  }\n};\n\nToolManager.prototype.bindEvents = function(name, events) {\n  var eventBus = this._eventBus,\n      dragging = this._dragging;\n\n  var eventsToRegister = [];\n\n  eventBus.on(events.tool + '.init', function(event) {\n    var context = event.context;\n\n    // Active tools that want to reactivate themselves must do this explicitly\n    if (!context.reactivate && this.isActive(name)) {\n      this.setActive(null);\n\n      dragging.cancel();\n      return;\n    }\n\n    this.setActive(name);\n\n  }, this);\n\n  // Todo[ricardo]: add test cases\n  forEach(events, function(event) {\n    eventsToRegister.push(event + '.ended');\n    eventsToRegister.push(event + '.canceled');\n  });\n\n  eventBus.on(eventsToRegister, LOW_PRIORITY, function(event) {\n    var originalEvent = event.originalEvent;\n\n    // We defer the de-activation of the tool to the .activate phase,\n    // so we're able to check if we want to toggle off the current\n    // active tool or switch to a new one\n    if (!this._active) {\n      return;\n    }\n\n    if (originalEvent && domClosest(originalEvent.target, '.group[data-group=\"tools\"]')) {\n      return;\n    }\n\n    this.setActive(null);\n  }, this);\n};\n","import DraggingModule from '../dragging';\n\nimport ToolManager from './ToolManager';\n\nexport default {\n  __depends__: [\n    DraggingModule\n  ],\n  __init__: [ 'toolManager' ],\n  toolManager: [ 'type', ToolManager ]\n};\n","import { forEach } from 'min-dash';\n\n/**\n * Return direction given axis and delta.\n *\n * @param {string} axis\n * @param {number} delta\n *\n * @return {string}\n */\nexport function getDirection(axis, delta) {\n\n  if (axis === 'x') {\n    if (delta > 0) {\n      return 'e';\n    }\n\n    if (delta < 0) {\n      return 'w';\n    }\n  }\n\n  if (axis === 'y') {\n    if (delta > 0) {\n      return 's';\n    }\n\n    if (delta < 0) {\n      return 'n';\n    }\n  }\n\n  return null;\n}\n\n/**\n * Returns connections whose waypoints are to be updated. Waypoints are to be updated if start\n * or end is to be moved or resized.\n *\n * @param {Array<djs.model.Shape} movingShapes\n * @param {Array<djs.model.Shape} resizingShapes\n *\n * @returns {Array<djs.model.Connection>}\n */\nexport function getWaypointsUpdatingConnections(movingShapes, resizingShapes) {\n  var waypointsUpdatingConnections = [];\n\n  forEach(movingShapes, function(shape) {\n    var incoming = shape.incoming,\n        outgoing = shape.outgoing;\n\n    forEach(incoming.concat(outgoing), function(connection) {\n      var source = connection.source,\n          target = connection.target;\n\n      if (includes(movingShapes, source) ||\n        includes(movingShapes, target) ||\n        includes(resizingShapes, source) ||\n        includes(resizingShapes, target)) {\n\n        if (!includes(waypointsUpdatingConnections, connection)) {\n          waypointsUpdatingConnections.push(connection);\n        }\n      }\n    });\n  });\n\n  return waypointsUpdatingConnections;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\n/**\n * Resize bounds.\n *\n * @param {Object} bounds\n * @param {number} bounds.x\n * @param {number} bounds.y\n * @param {number} bounds.width\n * @param {number} bounds.height\n * @param {string} direction\n * @param {Object} delta\n * @param {number} delta.x\n * @param {number} delta.y\n *\n * @return {Object}\n */\nexport function resizeBounds(bounds, direction, delta) {\n  var x = bounds.x,\n      y = bounds.y,\n      width = bounds.width,\n      height = bounds.height,\n      dx = delta.x,\n      dy = delta.y;\n\n  switch (direction) {\n  case 'n':\n    return {\n      x: x,\n      y: y + dy,\n      width: width,\n      height: height - dy\n    };\n  case 's':\n    return {\n      x: x,\n      y: y,\n      width: width,\n      height: height + dy\n    };\n  case 'w':\n    return {\n      x: x + dx,\n      y: y,\n      width: width - dx,\n      height: height\n    };\n  case 'e':\n    return {\n      x: x,\n      y: y,\n      width: width + dx,\n      height: height\n    };\n  default:\n    throw new Error('unknown direction: ' + direction);\n  }\n}","import {\n  assign,\n  filter,\n  forEach,\n  isNumber\n} from 'min-dash';\n\nimport { asTRBL } from '../../layout/LayoutUtil';\n\nimport { getBBox } from '../../util/Elements';\n\nimport { getDirection } from './SpaceUtil';\n\nimport { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { set as setCursor } from '../../util/Cursor';\n\nimport { selfAndAllChildren } from '../../util/Elements';\n\nvar abs = Math.abs,\n    round = Math.round;\n\nvar AXIS_TO_DIMENSION = {\n  x: 'width',\n  y: 'height'\n};\n\nvar CURSOR_CROSSHAIR = 'crosshair';\n\nvar DIRECTION_TO_TRBL = {\n  n: 'top',\n  w: 'left',\n  s: 'bottom',\n  e: 'right'\n};\n\nvar HIGH_PRIORITY = 1500;\n\nvar DIRECTION_TO_OPPOSITE = {\n  n: 's',\n  w: 'e',\n  s: 'n',\n  e: 'w'\n};\n\nvar PADDING = 20;\n\n\n/**\n * Add or remove space by moving and resizing elements.\n *\n * @param {Canvas} canvas\n * @param {Dragging} dragging\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {Rules} rules\n * @param {toolManager} toolManager\n */\nexport default function SpaceTool(canvas, dragging, eventBus, modeling, rules, toolManager) {\n  this._canvas = canvas;\n  this._dragging = dragging;\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._rules = rules;\n  this._toolManager = toolManager;\n\n  var self = this;\n\n  toolManager.registerTool('space', {\n    tool: 'spaceTool.selection',\n    dragging: 'spaceTool'\n  });\n\n  eventBus.on('spaceTool.selection.end', function(event) {\n    eventBus.once('spaceTool.selection.ended', function() {\n      self.activateMakeSpace(event.originalEvent);\n    });\n  });\n\n  eventBus.on('spaceTool.move', HIGH_PRIORITY , function(event) {\n    var context = event.context,\n        initialized = context.initialized;\n\n    if (!initialized) {\n      initialized = context.initialized = self.init(event, context);\n    }\n\n    if (initialized) {\n      ensureConstraints(event);\n    }\n  });\n\n  eventBus.on('spaceTool.end', function(event) {\n    var context = event.context,\n        axis = context.axis,\n        direction = context.direction,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes,\n        start = context.start;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    ensureConstraints(event);\n\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    delta[ axis ] = round(event[ 'd' + axis ]);\n\n    self.makeSpace(movingShapes, resizingShapes, delta, direction, start);\n\n    eventBus.once('spaceTool.ended', function(event) {\n\n      // activate space tool selection after make space\n      self.activateSelection(event.originalEvent, true, true);\n    });\n  });\n}\n\nSpaceTool.$inject = [\n  'canvas',\n  'dragging',\n  'eventBus',\n  'modeling',\n  'rules',\n  'toolManager'\n];\n\n/**\n * Activate space tool selection.\n *\n * @param {Object} event\n * @param {boolean} autoActivate\n */\nSpaceTool.prototype.activateSelection = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'spaceTool.selection', {\n    autoActivate: autoActivate,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    },\n    trapClick: false\n  });\n};\n\n/**\n * Activate space tool make space.\n *\n * @param  {MouseEvent} event\n */\nSpaceTool.prototype.activateMakeSpace = function(event) {\n  this._dragging.init(event, 'spaceTool', {\n    autoActivate: true,\n    cursor: CURSOR_CROSSHAIR,\n    data: {\n      context: {}\n    }\n  });\n};\n\n/**\n * Make space.\n *\n * @param  {Array<djs.model.Shape>} movingShapes\n * @param  {Array<djs.model.Shape>} resizingShapes\n * @param  {Object} delta\n * @param  {number} delta.x\n * @param  {number} delta.y\n * @param  {string} direction\n * @param  {number} start\n */\nSpaceTool.prototype.makeSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  return this._modeling.createSpace(movingShapes, resizingShapes, delta, direction, start);\n};\n\n/**\n * Initialize make space and return true if that was successful.\n *\n * @param {Object} event\n * @param {Object} context\n *\n * @return {boolean}\n */\nSpaceTool.prototype.init = function(event, context) {\n  var axis = abs(event.dx) > abs(event.dy) ? 'x' : 'y',\n      delta = event[ 'd' + axis ],\n      start = event[ axis ] - delta;\n\n  if (abs(delta) < 5) {\n    return false;\n  }\n\n  // invert delta to remove space when moving left\n  if (delta < 0) {\n    delta *= -1;\n  }\n\n  // invert delta to add/remove space when removing/adding space if modifier key is pressed\n  if (hasPrimaryModifier(event)) {\n    delta *= -1;\n  }\n\n  var direction = getDirection(axis, delta);\n\n  var root = this._canvas.getRootElement();\n\n  var children = selfAndAllChildren(root, true);\n\n  var elements = this.calculateAdjustments(children, axis, delta, start);\n\n  var minDimensions = this._eventBus.fire('spaceTool.getMinDimensions', {\n    shapes: elements.resizingShapes\n  });\n\n  var spaceToolConstraints = getSpaceToolConstraints(elements, axis, direction, start, minDimensions);\n\n  assign(\n    context,\n    elements,\n    {\n      axis: axis,\n      direction: direction,\n      spaceToolConstraints: spaceToolConstraints,\n      start: start\n    }\n  );\n\n  setCursor('resize-' + (axis === 'x' ? 'ew' : 'ns'));\n\n  return true;\n};\n\n/**\n * Get elements to be moved and resized.\n *\n * @param  {Array<djs.model.Shape>} elements\n * @param  {string} axis\n * @param  {number} delta\n * @param  {number} start\n *\n * @return {Object}\n */\nSpaceTool.prototype.calculateAdjustments = function(elements, axis, delta, start) {\n  var rules = this._rules;\n\n  var movingShapes = [],\n      resizingShapes = [];\n\n  forEach(elements, function(element) {\n    if (!element.parent || isConnection(element)) {\n      return;\n    }\n\n    var shapeStart = element[ axis ],\n        shapeEnd = shapeStart + element[ AXIS_TO_DIMENSION[ axis ] ];\n\n    // shape to be moved\n    if ((delta > 0 && shapeStart > start) || (delta < 0 && shapeEnd < start)) {\n      return movingShapes.push(element);\n    }\n\n    // shape to be resized\n    if (shapeStart < start &&\n      shapeEnd > start &&\n      rules.allowed('shape.resize', { shape: element })\n    ) {\n\n      return resizingShapes.push(element);\n    }\n  });\n\n  return {\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes\n  };\n};\n\nSpaceTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nSpaceTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^spaceTool/.test(context.prefix);\n};\n\n// helpers //////////\n\nfunction addPadding(trbl) {\n  return {\n    top: trbl.top - PADDING,\n    right: trbl.right + PADDING,\n    bottom: trbl.bottom + PADDING,\n    left: trbl.left - PADDING\n  };\n}\n\nfunction ensureConstraints(event) {\n  var context = event.context,\n      spaceToolConstraints = context.spaceToolConstraints;\n\n  if (!spaceToolConstraints) {\n    return;\n  }\n\n  var x, y;\n\n  if (spaceToolConstraints.left) {\n    x = Math.max(event.x, spaceToolConstraints.left);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (spaceToolConstraints.right) {\n    x = Math.min(event.x, spaceToolConstraints.right);\n\n    event.dx = event.dx + x - event.x;\n    event.x = x;\n  }\n\n  if (spaceToolConstraints.top) {\n    y = Math.max(event.y, spaceToolConstraints.top);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n\n  if (spaceToolConstraints.bottom) {\n    y = Math.min(event.y, spaceToolConstraints.bottom);\n\n    event.dy = event.dy + y - event.y;\n    event.y = y;\n  }\n}\n\nfunction getSpaceToolConstraints(elements, axis, direction, start, minDimensions) {\n  var movingShapes = elements.movingShapes,\n      resizingShapes = elements.resizingShapes;\n\n  if (!resizingShapes.length) {\n    return;\n  }\n\n  var spaceToolConstraints = {},\n      min,\n      max;\n\n  forEach(resizingShapes, function(resizingShape) {\n    var resizingShapeBBox = asTRBL(resizingShape);\n\n    // find children that are not moving or resizing\n    var nonMovingResizingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) &&\n        !isLabel(child) &&\n        !includes(movingShapes, child) &&\n        !includes(resizingShapes, child);\n    });\n\n    // find children that are moving\n    var movingChildren = filter(resizingShape.children, function(child) {\n      return !isConnection(child) && !isLabel(child) && includes(movingShapes, child);\n    });\n\n    var minOrMax,\n        nonMovingResizingChildrenBBox,\n        movingChildrenBBox;\n\n    if (nonMovingResizingChildren.length) {\n      nonMovingResizingChildrenBBox = addPadding(asTRBL(getBBox(nonMovingResizingChildren)));\n\n      minOrMax = start -\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ direction ] ] +\n        nonMovingResizingChildrenBBox[ DIRECTION_TO_TRBL[ direction ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    if (movingChildren.length) {\n      movingChildrenBBox = addPadding(asTRBL(getBBox(movingChildren)));\n\n      minOrMax = start -\n        movingChildrenBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ] +\n        resizingShapeBBox[ DIRECTION_TO_TRBL[ DIRECTION_TO_OPPOSITE[ direction ] ] ];\n\n      if (direction === 'n') {\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n\n    var resizingShapeMinDimensions = minDimensions && minDimensions[ resizingShape.id ];\n\n    if (resizingShapeMinDimensions) {\n      if (direction === 'n') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.bottom = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 'w') {\n        minOrMax = start +\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] -\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.right = max = isNumber(max) ? Math.min(max, minOrMax) : minOrMax;\n      } else if (direction === 's') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.top = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      } else if (direction === 'e') {\n        minOrMax = start -\n          resizingShape[ AXIS_TO_DIMENSION [ axis ] ] +\n          resizingShapeMinDimensions[ AXIS_TO_DIMENSION[ axis ] ];\n\n        spaceToolConstraints.left = min = isNumber(min) ? Math.max(min, minOrMax) : minOrMax;\n      }\n    }\n  });\n\n  return spaceToolConstraints;\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}\n\nfunction isConnection(element) {\n  return !!element.waypoints;\n}\n\nfunction isLabel(element) {\n  return !!element.labelTarget;\n}","import {\n  forEach\n} from 'min-dash';\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_RESIZING = 'djs-resizing';\n\nvar LOW_PRIORITY = 250;\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport {\n  translate\n} from '../../util/SvgTransformUtil';\n\nvar max = Math.max;\n\n\n/**\n * Provides previews for selecting/moving/resizing shapes when creating/removing space.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function SpaceToolPreview(\n    eventBus, elementRegistry, canvas,\n    styles, previewSupport) {\n\n  function addPreviewGfx(collection, dragGroup) {\n    forEach(collection, function(element) {\n      previewSupport.addDragger(element, dragGroup);\n\n      canvas.addMarker(element, MARKER_DRAGGING);\n    });\n  }\n\n  // add crosshair\n  eventBus.on('spaceTool.selection.start', function(event) {\n    var space = canvas.getLayer('space'),\n        context = event.context;\n\n    var orientation = {\n      x: 'M 0,-10000 L 0,10000',\n      y: 'M -10000,0 L 10000,0'\n    };\n\n    var crosshairGroup = svgCreate('g');\n    svgAttr(crosshairGroup, styles.cls('djs-crosshair-group', [ 'no-events' ]));\n\n    svgAppend(space, crosshairGroup);\n\n    // horizontal path\n    var pathX = svgCreate('path');\n    svgAttr(pathX, 'd', orientation.x);\n    svgClasses(pathX).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathX);\n\n    // vertical path\n    var pathY = svgCreate('path');\n    svgAttr(pathY, 'd', orientation.y);\n    svgClasses(pathY).add('djs-crosshair');\n\n    svgAppend(crosshairGroup, pathY);\n\n    context.crosshairGroup = crosshairGroup;\n  });\n\n  // update crosshair\n  eventBus.on('spaceTool.selection.move', function(event) {\n    var crosshairGroup = event.context.crosshairGroup;\n\n    translate(crosshairGroup, event.x, event.y);\n  });\n\n  // remove crosshair\n  eventBus.on('spaceTool.selection.cleanup', function(event) {\n    var context = event.context,\n        crosshairGroup = context.crosshairGroup;\n\n    if (crosshairGroup) {\n      svgRemove(crosshairGroup);\n    }\n  });\n\n  // add and update move/resize previews\n  eventBus.on('spaceTool.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        line = context.line,\n        axis = context.axis,\n        movingShapes = context.movingShapes,\n        resizingShapes = context.resizingShapes;\n\n    if (!context.initialized) {\n      return;\n    }\n\n    if (!context.dragGroup) {\n      var spaceLayer = canvas.getLayer('space');\n\n      line = svgCreate('path');\n      svgAttr(line, 'd', 'M0,0 L0,0');\n      svgClasses(line).add('djs-crosshair');\n\n      svgAppend(spaceLayer, line);\n\n      context.line = line;\n\n      var dragGroup = svgCreate('g');\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), dragGroup);\n\n      // shapes\n      addPreviewGfx(movingShapes, dragGroup);\n\n      // connections\n      var movingConnections = context.movingConnections = elementRegistry.filter(function(element) {\n        var sourceIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsMoving = true;\n            }\n          });\n        });\n\n        var targetIsMoving = false;\n\n        forEach(movingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsMoving = true;\n            }\n          });\n        });\n\n        var sourceIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.outgoing, function(connection) {\n            if (element === connection) {\n              sourceIsResizing = true;\n            }\n          });\n        });\n\n        var targetIsResizing = false;\n\n        forEach(resizingShapes, function(shape) {\n          forEach(shape.incoming, function(connection) {\n            if (element === connection) {\n              targetIsResizing = true;\n            }\n          });\n        });\n\n        return isConnection(element)\n          && (sourceIsMoving || sourceIsResizing)\n          && (targetIsMoving || targetIsResizing);\n      });\n\n\n      addPreviewGfx(movingConnections, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    if (!context.frameGroup) {\n      var frameGroup = svgCreate('g');\n      svgAttr(frameGroup, styles.cls('djs-frame-group', [ 'no-events' ]));\n\n      svgAppend(canvas.getDefaultLayer(), frameGroup);\n\n      var frames = [];\n\n      forEach(resizingShapes, function(shape) {\n        var frame = previewSupport.addFrame(shape, frameGroup);\n\n        var initialBounds = frame.getBBox();\n\n        frames.push({\n          element: frame,\n          initialBounds: initialBounds\n        });\n\n        canvas.addMarker(shape, MARKER_RESIZING);\n      });\n\n      context.frameGroup = frameGroup;\n      context.frames = frames;\n    }\n\n    var orientation = {\n      x: 'M' + event.x + ', -10000 L' + event.x + ', 10000',\n      y: 'M -10000, ' + event.y + ' L 10000, ' + event.y\n    };\n\n    svgAttr(line, { d: orientation[ axis ] });\n\n    var opposite = { x: 'y', y: 'x' };\n    var delta = { x: event.dx, y: event.dy };\n    delta[ opposite[ context.axis ] ] = 0;\n\n    // update move previews\n    translate(context.dragGroup, delta.x, delta.y);\n\n    // update resize previews\n    forEach(context.frames, function(frame) {\n      var element = frame.element,\n          initialBounds = frame.initialBounds,\n          width,\n          height;\n\n      if (context.direction === 'e') {\n        svgAttr(element, {\n          width: max(initialBounds.width + delta.x, 5)\n        });\n      } else {\n        width = max(initialBounds.width - delta.x, 5);\n\n        svgAttr(element, {\n          width: width,\n          x: initialBounds.x + initialBounds.width - width\n        });\n      }\n\n      if (context.direction === 's') {\n        svgAttr(element, {\n          height: max(initialBounds.height + delta.y, 5)\n        });\n      } else {\n        height = max(initialBounds.height - delta.y, 5);\n\n        svgAttr(element, {\n          height: height,\n          y: initialBounds.y + initialBounds.height - height\n        });\n      }\n    });\n\n  });\n\n  // remove move/resize previews\n  eventBus.on('spaceTool.cleanup', function(event) {\n\n    var context = event.context,\n        movingShapes = context.movingShapes,\n        movingConnections = context.movingConnections,\n        resizingShapes = context.resizingShapes,\n        line = context.line,\n        dragGroup = context.dragGroup,\n        frameGroup = context.frameGroup;\n\n    // moving shapes\n    forEach(movingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_DRAGGING);\n    });\n\n    // moving connections\n    forEach(movingConnections, function(connection) {\n      canvas.removeMarker(connection, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(line);\n      svgRemove(dragGroup);\n    }\n\n    forEach(resizingShapes, function(shape) {\n      canvas.removeMarker(shape, MARKER_RESIZING);\n    });\n\n    if (frameGroup) {\n      svgRemove(frameGroup);\n    }\n  });\n}\n\nSpaceToolPreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import DraggingModule from '../dragging';\nimport RulesModule from '../rules';\nimport ToolManagerModule from '../tool-manager';\nimport PreviewSupportModule from '../preview-support';\n\nimport SpaceTool from './SpaceTool';\nimport SpaceToolPreview from './SpaceToolPreview';\n\nexport default {\n  __init__: ['spaceToolPreview'],\n  __depends__: [\n    DraggingModule,\n    RulesModule,\n    ToolManagerModule,\n    PreviewSupportModule\n  ],\n  spaceTool: ['type', SpaceTool ],\n  spaceToolPreview: ['type', SpaceToolPreview ]\n};\n","import {\n  map,\n  assign,\n  pick\n} from 'min-dash';\n\nimport {\n  isAny\n} from './util/ModelingUtil';\n\nimport {\n  is\n} from '../../util/ModelUtil';\n\n\nexport default function BpmnFactory(moddle) {\n  this._model = moddle;\n}\n\nBpmnFactory.$inject = [ 'moddle' ];\n\n\nBpmnFactory.prototype._needsId = function(element) {\n  return isAny(element, [\n    'bpmn:RootElement',\n    'bpmn:FlowElement',\n    'bpmn:MessageFlow',\n    'bpmn:DataAssociation',\n    'bpmn:Artifact',\n    'bpmn:Participant',\n    'bpmn:Lane',\n    'bpmn:LaneSet',\n    'bpmn:Process',\n    'bpmn:Collaboration',\n    'bpmndi:BPMNShape',\n    'bpmndi:BPMNEdge',\n    'bpmndi:BPMNDiagram',\n    'bpmndi:BPMNPlane',\n    'bpmn:Property',\n    'bpmn:CategoryValue'\n  ]);\n};\n\nBpmnFactory.prototype._ensureId = function(element) {\n\n  // generate semantic ids for elements\n  // bpmn:SequenceFlow -> SequenceFlow_ID\n  var prefix;\n\n  if (is(element, 'bpmn:Activity')) {\n    prefix = 'Activity';\n  } else if (is(element, 'bpmn:Event')) {\n    prefix = 'Event';\n  } else if (is(element, 'bpmn:Gateway')) {\n    prefix = 'Gateway';\n  } else if (is(element, 'bpmn:FlowElement')) {\n    prefix = 'Flow';\n  } else {\n    prefix = (element.$type || '').replace(/^[^:]*:/g, '');\n  }\n\n  prefix += '_';\n\n  if (!element.id && this._needsId(element)) {\n    element.id = this._model.ids.nextPrefixed(prefix, element);\n  }\n};\n\n\nBpmnFactory.prototype.create = function(type, attrs) {\n  var element = this._model.create(type, attrs || {});\n\n  this._ensureId(element);\n\n  return element;\n};\n\n\nBpmnFactory.prototype.createDiLabel = function() {\n  return this.create('bpmndi:BPMNLabel', {\n    bounds: this.createDiBounds()\n  });\n};\n\n\nBpmnFactory.prototype.createDiShape = function(semantic, bounds, attrs) {\n\n  return this.create('bpmndi:BPMNShape', assign({\n    bpmnElement: semantic,\n    bounds: this.createDiBounds(bounds)\n  }, attrs));\n};\n\n\nBpmnFactory.prototype.createDiBounds = function(bounds) {\n  return this.create('dc:Bounds', bounds);\n};\n\n\nBpmnFactory.prototype.createDiWaypoints = function(waypoints) {\n  var self = this;\n\n  return map(waypoints, function(pos) {\n    return self.createDiWaypoint(pos);\n  });\n};\n\nBpmnFactory.prototype.createDiWaypoint = function(point) {\n  return this.create('dc:Point', pick(point, [ 'x', 'y' ]));\n};\n\n\nBpmnFactory.prototype.createDiEdge = function(semantic, waypoints, attrs) {\n  return this.create('bpmndi:BPMNEdge', assign({\n    bpmnElement: semantic\n  }, attrs));\n};\n\nBpmnFactory.prototype.createDiPlane = function(semantic) {\n  return this.create('bpmndi:BPMNPlane', {\n    bpmnElement: semantic\n  });\n};","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport {\n  remove as collectionRemove,\n  add as collectionAdd\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  Label\n} from 'diagram-js/lib/model';\n\nimport {\n  getBusinessObject,\n  is\n} from '../../util/ModelUtil';\n\nimport {\n  isAny\n} from './util/ModelingUtil';\n\nimport CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\n/**\n * A handler responsible for updating the underlying BPMN 2.0 XML + DI\n * once changes on the diagram happen\n */\nexport default function BpmnUpdater(\n    eventBus, bpmnFactory, connectionDocking,\n    translate) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  this._bpmnFactory = bpmnFactory;\n  this._translate = translate;\n\n  var self = this;\n\n\n\n  // connection cropping //////////////////////\n\n  // crop connection ends during create/update\n  function cropConnection(e) {\n    var context = e.context,\n        hints = context.hints || {},\n        connection;\n\n    if (!context.cropped && hints.createElementsBehavior !== false) {\n      connection = context.connection;\n      connection.waypoints = connectionDocking.getCroppedWaypoints(connection);\n      context.cropped = true;\n    }\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.create'\n  ], cropConnection);\n\n  this.reverted([ 'connection.layout' ], function(e) {\n    delete e.context.cropped;\n  });\n\n\n\n  // BPMN + DI update //////////////////////\n\n\n  // update parent\n  function updateParent(e) {\n    var context = e.context;\n\n    self.updateParent(context.shape || context.connection, context.oldParent);\n  }\n\n  function reverseUpdateParent(e) {\n    var context = e.context;\n\n    var element = context.shape || context.connection,\n\n        // oldParent is the (old) new parent, because we are undoing\n        oldParent = context.parent || context.newParent;\n\n    self.updateParent(element, oldParent);\n  }\n\n  this.executed([\n    'shape.move',\n    'shape.create',\n    'shape.delete',\n    'connection.create',\n    'connection.move',\n    'connection.delete'\n  ], ifBpmn(updateParent));\n\n  this.reverted([\n    'shape.move',\n    'shape.create',\n    'shape.delete',\n    'connection.create',\n    'connection.move',\n    'connection.delete'\n  ], ifBpmn(reverseUpdateParent));\n\n  /*\n   * ## Updating Parent\n   *\n   * When morphing a Process into a Collaboration or vice-versa,\n   * make sure that both the *semantic* and *di* parent of each element\n   * is updated.\n   *\n   */\n  function updateRoot(event) {\n    var context = event.context,\n        oldRoot = context.oldRoot,\n        children = oldRoot.children;\n\n    forEach(children, function(child) {\n      if (is(child, 'bpmn:BaseElement')) {\n        self.updateParent(child);\n      }\n    });\n  }\n\n  this.executed([ 'canvas.updateRoot' ], updateRoot);\n  this.reverted([ 'canvas.updateRoot' ], updateRoot);\n\n\n  // update bounds\n  function updateBounds(e) {\n    var shape = e.context.shape;\n\n    if (!is(shape, 'bpmn:BaseElement')) {\n      return;\n    }\n\n    self.updateBounds(shape);\n  }\n\n  this.executed([ 'shape.move', 'shape.create', 'shape.resize' ], ifBpmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  this.reverted([ 'shape.move', 'shape.create', 'shape.resize' ], ifBpmn(function(event) {\n\n    // exclude labels because they're handled separately during shape.changed\n    if (event.context.shape.type === 'label') {\n      return;\n    }\n\n    updateBounds(event);\n  }));\n\n  // Handle labels separately. This is necessary, because the label bounds have to be updated\n  // every time its shape changes, not only on move, create and resize.\n  eventBus.on('shape.changed', function(event) {\n    if (event.element.type === 'label') {\n      updateBounds({ context: { shape: event.element } });\n    }\n  });\n\n  // attach / detach connection\n  function updateConnection(e) {\n    self.updateConnection(e.context);\n  }\n\n  this.executed([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnect'\n  ], ifBpmn(updateConnection));\n\n  this.reverted([\n    'connection.create',\n    'connection.move',\n    'connection.delete',\n    'connection.reconnect'\n  ], ifBpmn(updateConnection));\n\n\n  // update waypoints\n  function updateConnectionWaypoints(e) {\n    self.updateConnectionWaypoints(e.context.connection);\n  }\n\n  this.executed([\n    'connection.layout',\n    'connection.move',\n    'connection.updateWaypoints',\n  ], ifBpmn(updateConnectionWaypoints));\n\n  this.reverted([\n    'connection.layout',\n    'connection.move',\n    'connection.updateWaypoints',\n  ], ifBpmn(updateConnectionWaypoints));\n\n  // update conditional/default flows\n  this.executed('connection.reconnect', ifBpmn(function(event) {\n    var context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n    // remove condition from connection on reconnect to new source\n    // if new source can NOT have condional sequence flow\n    if (connectionBo.conditionExpression && !isAny(newSourceBo, [\n      'bpmn:Activity',\n      'bpmn:ExclusiveGateway',\n      'bpmn:InclusiveGateway'\n    ])) {\n      context.oldConditionExpression = connectionBo.conditionExpression;\n\n      delete connectionBo.conditionExpression;\n    }\n\n    // remove default from old source flow on reconnect to new source\n    // if source changed\n    if (oldSource !== newSource && oldSourceBo.default === connectionBo) {\n      context.oldDefault = oldSourceBo.default;\n\n      delete oldSourceBo.default;\n    }\n  }));\n\n  this.reverted('connection.reconnect', ifBpmn(function(event) {\n    var context = event.context,\n        connection = context.connection,\n        oldSource = context.oldSource,\n        newSource = context.newSource,\n        connectionBo = getBusinessObject(connection),\n        oldSourceBo = getBusinessObject(oldSource),\n        newSourceBo = getBusinessObject(newSource);\n\n    // add condition to connection on revert reconnect to new source\n    if (context.oldConditionExpression) {\n      connectionBo.conditionExpression = context.oldConditionExpression;\n    }\n\n    // add default to old source on revert reconnect to new source\n    if (context.oldDefault) {\n      oldSourceBo.default = context.oldDefault;\n\n      delete newSourceBo.default;\n    }\n  }));\n\n  // update attachments\n  function updateAttachment(e) {\n    self.updateAttachment(e.context);\n  }\n\n  this.executed([ 'element.updateAttachment' ], ifBpmn(updateAttachment));\n  this.reverted([ 'element.updateAttachment' ], ifBpmn(updateAttachment));\n}\n\ninherits(BpmnUpdater, CommandInterceptor);\n\nBpmnUpdater.$inject = [\n  'eventBus',\n  'bpmnFactory',\n  'connectionDocking',\n  'translate'\n];\n\n\n// implementation //////////////////////\n\nBpmnUpdater.prototype.updateAttachment = function(context) {\n\n  var shape = context.shape,\n      businessObject = shape.businessObject,\n      host = shape.host;\n\n  businessObject.attachedToRef = host && host.businessObject;\n};\n\nBpmnUpdater.prototype.updateParent = function(element, oldParent) {\n\n  // do not update BPMN 2.0 label parent\n  if (element instanceof Label) {\n    return;\n  }\n\n  // data stores in collaborations are handled separately by DataStoreBehavior\n  if (is(element, 'bpmn:DataStoreReference') &&\n      element.parent &&\n      is(element.parent, 'bpmn:Collaboration')) {\n    return;\n  }\n\n  var parentShape = element.parent;\n\n  var businessObject = element.businessObject,\n      parentBusinessObject = parentShape && parentShape.businessObject,\n      parentDi = parentBusinessObject && parentBusinessObject.di;\n\n  if (is(element, 'bpmn:FlowNode')) {\n    this.updateFlowNodeRefs(businessObject, parentBusinessObject, oldParent && oldParent.businessObject);\n  }\n\n  if (is(element, 'bpmn:DataOutputAssociation')) {\n    if (element.source) {\n      parentBusinessObject = element.source.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  if (is(element, 'bpmn:DataInputAssociation')) {\n    if (element.target) {\n      parentBusinessObject = element.target.businessObject;\n    } else {\n      parentBusinessObject = null;\n    }\n  }\n\n  this.updateSemanticParent(businessObject, parentBusinessObject);\n\n  if (is(element, 'bpmn:DataObjectReference') && businessObject.dataObjectRef) {\n    this.updateSemanticParent(businessObject.dataObjectRef, parentBusinessObject);\n  }\n\n  this.updateDiParent(businessObject.di, parentDi);\n};\n\n\nBpmnUpdater.prototype.updateBounds = function(shape) {\n\n  var di = shape.businessObject.di;\n\n  var target = (shape instanceof Label) ? this._getLabel(di) : di;\n\n  var bounds = target.bounds;\n\n  if (!bounds) {\n    bounds = this._bpmnFactory.createDiBounds();\n    target.set('bounds', bounds);\n  }\n\n  assign(bounds, {\n    x: shape.x,\n    y: shape.y,\n    width: shape.width,\n    height: shape.height\n  });\n};\n\nBpmnUpdater.prototype.updateFlowNodeRefs = function(businessObject, newContainment, oldContainment) {\n\n  if (oldContainment === newContainment) {\n    return;\n  }\n\n  var oldRefs, newRefs;\n\n  if (is (oldContainment, 'bpmn:Lane')) {\n    oldRefs = oldContainment.get('flowNodeRef');\n    collectionRemove(oldRefs, businessObject);\n  }\n\n  if (is(newContainment, 'bpmn:Lane')) {\n    newRefs = newContainment.get('flowNodeRef');\n    collectionAdd(newRefs, businessObject);\n  }\n};\n\n\n// update existing sourceElement and targetElement di information\nBpmnUpdater.prototype.updateDiConnection = function(di, newSource, newTarget) {\n\n  if (di.sourceElement && di.sourceElement.bpmnElement !== newSource) {\n    di.sourceElement = newSource && newSource.di;\n  }\n\n  if (di.targetElement && di.targetElement.bpmnElement !== newTarget) {\n    di.targetElement = newTarget && newTarget.di;\n  }\n\n};\n\n\nBpmnUpdater.prototype.updateDiParent = function(di, parentDi) {\n\n  if (parentDi && !is(parentDi, 'bpmndi:BPMNPlane')) {\n    parentDi = parentDi.$parent;\n  }\n\n  if (di.$parent === parentDi) {\n    return;\n  }\n\n  var planeElements = (parentDi || di.$parent).get('planeElement');\n\n  if (parentDi) {\n    planeElements.push(di);\n    di.$parent = parentDi;\n  } else {\n    collectionRemove(planeElements, di);\n    di.$parent = null;\n  }\n};\n\nfunction getDefinitions(element) {\n  while (element && !is(element, 'bpmn:Definitions')) {\n    element = element.$parent;\n  }\n\n  return element;\n}\n\nBpmnUpdater.prototype.getLaneSet = function(container) {\n\n  var laneSet, laneSets;\n\n  // bpmn:Lane\n  if (is(container, 'bpmn:Lane')) {\n    laneSet = container.childLaneSet;\n\n    if (!laneSet) {\n      laneSet = this._bpmnFactory.create('bpmn:LaneSet');\n      container.childLaneSet = laneSet;\n      laneSet.$parent = container;\n    }\n\n    return laneSet;\n  }\n\n  // bpmn:Participant\n  if (is(container, 'bpmn:Participant')) {\n    container = container.processRef;\n  }\n\n  // bpmn:FlowElementsContainer\n  laneSets = container.get('laneSets');\n  laneSet = laneSets[0];\n\n  if (!laneSet) {\n    laneSet = this._bpmnFactory.create('bpmn:LaneSet');\n    laneSet.$parent = container;\n    laneSets.push(laneSet);\n  }\n\n  return laneSet;\n};\n\nBpmnUpdater.prototype.updateSemanticParent = function(businessObject, newParent, visualParent) {\n\n  var containment,\n      translate = this._translate;\n\n  if (businessObject.$parent === newParent) {\n    return;\n  }\n\n  if (is(businessObject, 'bpmn:DataInput') || is(businessObject, 'bpmn:DataOutput')) {\n\n    if (is(newParent, 'bpmn:Participant') && 'processRef' in newParent) {\n      newParent = newParent.processRef;\n    }\n\n    // already in correct ioSpecification\n    if ('ioSpecification' in newParent && newParent.ioSpecification === businessObject.$parent) {\n      return;\n    }\n  }\n\n  if (is(businessObject, 'bpmn:Lane')) {\n\n    if (newParent) {\n      newParent = this.getLaneSet(newParent);\n    }\n\n    containment = 'lanes';\n  } else\n\n  if (is(businessObject, 'bpmn:FlowElement')) {\n\n    if (newParent) {\n\n      if (is(newParent, 'bpmn:Participant')) {\n        newParent = newParent.processRef;\n      } else\n\n      if (is(newParent, 'bpmn:Lane')) {\n        do {\n\n          // unwrap Lane -> LaneSet -> (Lane | FlowElementsContainer)\n          newParent = newParent.$parent.$parent;\n        } while (is(newParent, 'bpmn:Lane'));\n\n      }\n    }\n\n    containment = 'flowElements';\n\n  } else\n\n  if (is(businessObject, 'bpmn:Artifact')) {\n\n    while (newParent &&\n           !is(newParent, 'bpmn:Process') &&\n           !is(newParent, 'bpmn:SubProcess') &&\n           !is(newParent, 'bpmn:Collaboration')) {\n\n      if (is(newParent, 'bpmn:Participant')) {\n        newParent = newParent.processRef;\n        break;\n      } else {\n        newParent = newParent.$parent;\n      }\n    }\n\n    containment = 'artifacts';\n  } else\n\n  if (is(businessObject, 'bpmn:MessageFlow')) {\n    containment = 'messageFlows';\n\n  } else\n\n  if (is(businessObject, 'bpmn:Participant')) {\n    containment = 'participants';\n\n    // make sure the participants process is properly attached / detached\n    // from the XML document\n\n    var process = businessObject.processRef,\n        definitions;\n\n    if (process) {\n      definitions = getDefinitions(businessObject.$parent || newParent);\n\n      if (businessObject.$parent) {\n        collectionRemove(definitions.get('rootElements'), process);\n        process.$parent = null;\n      }\n\n      if (newParent) {\n        collectionAdd(definitions.get('rootElements'), process);\n        process.$parent = definitions;\n      }\n    }\n  } else\n\n  if (is(businessObject, 'bpmn:DataOutputAssociation')) {\n    containment = 'dataOutputAssociations';\n  } else\n\n  if (is(businessObject, 'bpmn:DataInputAssociation')) {\n    containment = 'dataInputAssociations';\n  }\n\n  if (!containment) {\n    throw new Error(translate(\n      'no parent for {element} in {parent}',\n      {\n        element: businessObject.id,\n        parent: newParent.id\n      }\n    ));\n  }\n\n  var children;\n\n  if (businessObject.$parent) {\n\n    // remove from old parent\n    children = businessObject.$parent.get(containment);\n    collectionRemove(children, businessObject);\n  }\n\n  if (!newParent) {\n    businessObject.$parent = null;\n  } else {\n\n    // add to new parent\n    children = newParent.get(containment);\n    children.push(businessObject);\n    businessObject.$parent = newParent;\n  }\n\n  if (visualParent) {\n    var diChildren = visualParent.get(containment);\n\n    collectionRemove(children, businessObject);\n\n    if (newParent) {\n\n      if (!diChildren) {\n        diChildren = [];\n        newParent.set(containment, diChildren);\n      }\n\n      diChildren.push(businessObject);\n    }\n  }\n};\n\n\nBpmnUpdater.prototype.updateConnectionWaypoints = function(connection) {\n  connection.businessObject.di.set('waypoint', this._bpmnFactory.createDiWaypoints(connection.waypoints));\n};\n\n\nBpmnUpdater.prototype.updateConnection = function(context) {\n\n  var connection = context.connection,\n      businessObject = getBusinessObject(connection),\n      newSource = getBusinessObject(connection.source),\n      newTarget = getBusinessObject(connection.target),\n      visualParent;\n\n  if (!is(businessObject, 'bpmn:DataAssociation')) {\n\n    var inverseSet = is(businessObject, 'bpmn:SequenceFlow');\n\n    if (businessObject.sourceRef !== newSource) {\n      if (inverseSet) {\n        collectionRemove(businessObject.sourceRef && businessObject.sourceRef.get('outgoing'), businessObject);\n\n        if (newSource && newSource.get('outgoing')) {\n          newSource.get('outgoing').push(businessObject);\n        }\n      }\n\n      businessObject.sourceRef = newSource;\n    }\n\n    if (businessObject.targetRef !== newTarget) {\n      if (inverseSet) {\n        collectionRemove(businessObject.targetRef && businessObject.targetRef.get('incoming'), businessObject);\n\n        if (newTarget && newTarget.get('incoming')) {\n          newTarget.get('incoming').push(businessObject);\n        }\n      }\n\n      businessObject.targetRef = newTarget;\n    }\n  } else\n\n  if (is(businessObject, 'bpmn:DataInputAssociation')) {\n\n    // handle obnoxious isMsome sourceRef\n    businessObject.get('sourceRef')[0] = newSource;\n\n    visualParent = context.parent || context.newParent || newTarget;\n\n    this.updateSemanticParent(businessObject, newTarget, visualParent);\n  } else\n\n  if (is(businessObject, 'bpmn:DataOutputAssociation')) {\n    visualParent = context.parent || context.newParent || newSource;\n\n    this.updateSemanticParent(businessObject, newSource, visualParent);\n\n    // targetRef = new target\n    businessObject.targetRef = newTarget;\n  }\n\n  this.updateConnectionWaypoints(connection);\n\n  this.updateDiConnection(businessObject.di, newSource, newTarget);\n};\n\n\n// helpers //////////////////////\n\nBpmnUpdater.prototype._getLabel = function(di) {\n  if (!di.label) {\n    di.label = this._bpmnFactory.createDiLabel();\n  }\n\n  return di.label;\n};\n\n\n/**\n * Make sure the event listener is only called\n * if the touched element is a BPMN element.\n *\n * @param  {Function} fn\n * @return {Function} guarded function\n */\nfunction ifBpmn(fn) {\n\n  return function(event) {\n\n    var context = event.context,\n        element = context.shape || context.connection;\n\n    if (is(element, 'bpmn:BaseElement')) {\n      fn(event);\n    }\n  };\n}\n","import {\n  assign,\n  forEach,\n  isObject\n} from 'min-dash';\n\nimport inherits from 'inherits';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  isExpanded\n} from '../../util/DiUtil';\n\nimport BaseElementFactory from 'diagram-js/lib/core/ElementFactory';\n\nimport {\n  DEFAULT_LABEL_SIZE\n} from '../../util/LabelUtil';\n\n\n/**\n * A bpmn-aware factory for diagram-js shapes\n */\nexport default function ElementFactory(bpmnFactory, moddle, translate) {\n  BaseElementFactory.call(this);\n\n  this._bpmnFactory = bpmnFactory;\n  this._moddle = moddle;\n  this._translate = translate;\n}\n\ninherits(ElementFactory, BaseElementFactory);\n\nElementFactory.$inject = [\n  'bpmnFactory',\n  'moddle',\n  'translate'\n];\n\nElementFactory.prototype.baseCreate = BaseElementFactory.prototype.create;\n\nElementFactory.prototype.create = function(elementType, attrs) {\n\n  // no special magic for labels,\n  // we assume their businessObjects have already been created\n  // and wired via attrs\n  if (elementType === 'label') {\n    return this.baseCreate(elementType, assign({ type: 'label' }, DEFAULT_LABEL_SIZE, attrs));\n  }\n\n  return this.createBpmnElement(elementType, attrs);\n};\n\nElementFactory.prototype.createBpmnElement = function(elementType, attrs) {\n  var size,\n      translate = this._translate;\n\n  attrs = attrs || {};\n\n  var businessObject = attrs.businessObject;\n\n  if (!businessObject) {\n    if (!attrs.type) {\n      throw new Error(translate('no shape type specified'));\n    }\n\n    businessObject = this._bpmnFactory.create(attrs.type);\n  }\n\n  if (!businessObject.di) {\n    if (elementType === 'root') {\n      businessObject.di = this._bpmnFactory.createDiPlane(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    } else\n    if (elementType === 'connection') {\n      businessObject.di = this._bpmnFactory.createDiEdge(businessObject, [], {\n        id: businessObject.id + '_di'\n      });\n    } else {\n      businessObject.di = this._bpmnFactory.createDiShape(businessObject, {}, {\n        id: businessObject.id + '_di'\n      });\n    }\n  }\n\n  if (is(businessObject, 'bpmn:Group')) {\n    attrs = assign({\n      isFrame: true\n    }, attrs);\n  }\n\n  if (attrs.di) {\n    assign(businessObject.di, attrs.di);\n\n    delete attrs.di;\n  }\n\n  applyAttributes(businessObject, attrs, [\n    'processRef',\n    'isInterrupting',\n    'associationDirection',\n    'isForCompensation'\n  ]);\n\n  if (attrs.isExpanded) {\n    applyAttribute(businessObject.di, attrs, 'isExpanded');\n  }\n\n  if (is(businessObject, 'bpmn:ExclusiveGateway')) {\n    businessObject.di.isMarkerVisible = true;\n  }\n\n  var eventDefinitions,\n      newEventDefinition;\n\n  if (attrs.eventDefinitionType) {\n    eventDefinitions = businessObject.get('eventDefinitions') || [];\n    newEventDefinition = this._bpmnFactory.create(attrs.eventDefinitionType);\n\n    if (attrs.eventDefinitionType === 'bpmn:ConditionalEventDefinition') {\n      newEventDefinition.condition = this._bpmnFactory.create('bpmn:FormalExpression');\n    }\n\n    eventDefinitions.push(newEventDefinition);\n\n    newEventDefinition.$parent = businessObject;\n    businessObject.eventDefinitions = eventDefinitions;\n\n    delete attrs.eventDefinitionType;\n  }\n\n  size = this._getDefaultSize(businessObject);\n\n  attrs = assign({\n    businessObject: businessObject,\n    id: businessObject.id\n  }, size, attrs);\n\n  return this.baseCreate(elementType, attrs);\n};\n\n\nElementFactory.prototype._getDefaultSize = function(semantic) {\n\n  if (is(semantic, 'bpmn:SubProcess')) {\n\n    if (isExpanded(semantic)) {\n      return { width: 350, height: 200 };\n    } else {\n      return { width: 100, height: 80 };\n    }\n  }\n\n  if (is(semantic, 'bpmn:Task')) {\n    return { width: 100, height: 80 };\n  }\n\n  if (is(semantic, 'bpmn:Gateway')) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:Event')) {\n    return { width: 36, height: 36 };\n  }\n\n  if (is(semantic, 'bpmn:Participant')) {\n    if (isExpanded(semantic)) {\n      return { width: 600, height: 250 };\n    } else {\n      return { width: 400, height: 60 };\n    }\n  }\n\n  if (is(semantic, 'bpmn:Lane')) {\n    return { width: 400, height: 100 };\n  }\n\n  if (is(semantic, 'bpmn:DataObjectReference')) {\n    return { width: 36, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:DataStoreReference')) {\n    return { width: 50, height: 50 };\n  }\n\n  if (is(semantic, 'bpmn:TextAnnotation')) {\n    return { width: 100, height: 30 };\n  }\n\n  if (is(semantic, 'bpmn:Group')) {\n    return { width: 300, height: 300 };\n  }\n\n  return { width: 100, height: 80 };\n};\n\n\n/**\n * Create participant.\n *\n * @param {boolean|Object} [attrs] attrs\n *\n * @returns {djs.model.Shape}\n */\nElementFactory.prototype.createParticipantShape = function(attrs) {\n\n  if (!isObject(attrs)) {\n    attrs = { isExpanded: attrs };\n  }\n\n  attrs = assign({ type: 'bpmn:Participant' }, attrs || {});\n\n  // participants are expanded by default\n  if (attrs.isExpanded !== false) {\n    attrs.processRef = this._bpmnFactory.create('bpmn:Process');\n  }\n\n  return this.createShape(attrs);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Apply attributes from a map to the given element,\n * remove attribute from the map on application.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {Array<String>} attributeNames name of attributes to apply\n */\nfunction applyAttributes(element, attrs, attributeNames) {\n\n  forEach(attributeNames, function(property) {\n    if (attrs[property] !== undefined) {\n      applyAttribute(element, attrs, property);\n    }\n  });\n}\n\n/**\n * Apply named property to element and drain it from the attrs\n * collection.\n *\n * @param {Base} element\n * @param {Object} attrs (in/out map of attributes)\n * @param {String} attributeName to apply\n */\nfunction applyAttribute(element, attrs, attributeName) {\n  element[attributeName] = attrs[attributeName];\n\n  delete attrs[attributeName];\n}","import { forEach } from 'min-dash';\n\n/**\n * A handler that align elements in a certain way.\n *\n */\nexport default function AlignElements(modeling, canvas) {\n  this._modeling = modeling;\n  this._canvas = canvas;\n}\n\nAlignElements.$inject = [ 'modeling', 'canvas' ];\n\n\nAlignElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var elements = context.elements,\n      alignment = context.alignment;\n\n\n  forEach(elements, function(element) {\n    var delta = {\n      x: 0,\n      y: 0\n    };\n\n    if (alignment.left) {\n      delta.x = alignment.left - element.x;\n\n    } else if (alignment.right) {\n      delta.x = (alignment.right - element.width) - element.x;\n\n    } else if (alignment.center) {\n      delta.x = (alignment.center - Math.round(element.width / 2)) - element.x;\n\n    } else if (alignment.top) {\n      delta.y = alignment.top - element.y;\n\n    } else if (alignment.bottom) {\n      delta.y = (alignment.bottom - element.height) - element.y;\n\n    } else if (alignment.middle) {\n      delta.y = (alignment.middle - Math.round(element.height / 2)) - element.y;\n    }\n\n    modeling.moveElements([ element ], delta, element.parent);\n  });\n};\n\nAlignElements.prototype.postExecute = function(context) {\n\n};\n","import { some } from 'min-dash';\n\n\n/**\n * A handler that implements reversible appending of shapes\n * to a source shape.\n *\n * @param {canvas} Canvas\n * @param {elementFactory} ElementFactory\n * @param {modeling} Modeling\n */\nexport default function AppendShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nAppendShapeHandler.$inject = [ 'modeling' ];\n\n\n// api //////////////////////\n\n\n/**\n * Creates a new shape\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.shape the new shape\n * @param {ElementDescriptor} context.source the source object\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nAppendShapeHandler.prototype.preExecute = function(context) {\n\n  var source = context.source;\n\n  if (!source) {\n    throw new Error('source required');\n  }\n\n  var target = context.target || source.parent,\n      shape = context.shape;\n\n  shape = context.shape =\n    this._modeling.createShape(\n      shape,\n      context.position,\n      target, { attach: context.attach });\n\n  context.shape = shape;\n};\n\nAppendShapeHandler.prototype.postExecute = function(context) {\n  var parent = context.connectionParent || context.shape.parent;\n\n  if (!existsConnection(context.source, context.shape)) {\n\n    // create connection\n    this._modeling.connect(context.source, context.shape, context.connection, parent);\n  }\n};\n\n\nfunction existsConnection(source, target) {\n  return some(source.outgoing, function(c) {\n    return c.target === target;\n  });\n}","export default function CreateConnectionHandler(canvas, layouter) {\n  this._canvas = canvas;\n  this._layouter = layouter;\n}\n\nCreateConnectionHandler.$inject = [ 'canvas', 'layouter' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.element.Base} context.source the source object\n * @param {djs.element.Base} context.target the parent object\n * @param {Point} context.position position of the new element\n */\nCreateConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      source = context.source,\n      target = context.target,\n      parent = context.parent,\n      parentIndex = context.parentIndex,\n      hints = context.hints;\n\n  if (!source || !target) {\n    throw new Error('source and target required');\n  }\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  connection.source = source;\n  connection.target = target;\n\n  if (!connection.waypoints) {\n    connection.waypoints = this._layouter.layoutConnection(connection, hints);\n  }\n\n  // add connection\n  this._canvas.addConnection(connection, parent, parentIndex);\n\n  return connection;\n};\n\nCreateConnectionHandler.prototype.revert = function(context) {\n  var connection = context.connection;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};","import {\r\n  assign,\r\n  forEach,\r\n  isNumber,\r\n  map,\r\n  pick,\r\n  values\r\n} from 'min-dash';\r\n\r\nimport {\r\n  getBBox,\r\n  getParents\r\n} from '../../../util/Elements';\r\n\r\nvar round = Math.round;\r\n\r\nexport default function CreateElementsHandler(modeling) {\r\n  this._modeling = modeling;\r\n}\r\n\r\nCreateElementsHandler.$inject = [\r\n  'modeling'\r\n];\r\n\r\nCreateElementsHandler.prototype.preExecute = function(context) {\r\n  var elements = context.elements,\r\n      parent = context.parent,\r\n      parentIndex = context.parentIndex,\r\n      position = context.position,\r\n      hints = context.hints;\r\n\r\n  var modeling = this._modeling;\r\n\r\n  // make sure each element has x and y\r\n  forEach(elements, function(element) {\r\n    if (!isNumber(element.x)) {\r\n      element.x = 0;\r\n    }\r\n\r\n    if (!isNumber(element.y)) {\r\n      element.y = 0;\r\n    }\r\n  });\r\n\r\n  var bbox = getBBox(elements);\r\n\r\n  // center elements around position\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      element.waypoints = map(element.waypoints, function(waypoint) {\r\n        return {\r\n          x: round(waypoint.x - bbox.x - bbox.width / 2 + position.x),\r\n          y: round(waypoint.y - bbox.y - bbox.height / 2 + position.y)\r\n        };\r\n      });\r\n    }\r\n\r\n    assign(element, {\r\n      x: round(element.x - bbox.x - bbox.width / 2 + position.x),\r\n      y: round(element.y - bbox.y - bbox.height / 2 + position.y)\r\n    });\r\n  });\r\n\r\n  var parents = getParents(elements);\r\n\r\n  var cache = {};\r\n\r\n  forEach(elements, function(element) {\r\n    if (isConnection(element)) {\r\n      cache[ element.id ] = isNumber(parentIndex) ?\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          parentIndex,\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        ) :\r\n        modeling.createConnection(\r\n          cache[ element.source.id ],\r\n          cache[ element.target.id ],\r\n          element,\r\n          element.parent || parent,\r\n          hints\r\n        );\r\n\r\n      return;\r\n    }\r\n\r\n    var createShapeHints = assign({}, hints);\r\n\r\n    if (parents.indexOf(element) === -1) {\r\n      createShapeHints.autoResize = false;\r\n    }\r\n\r\n    cache[ element.id ] = isNumber(parentIndex) ?\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        parentIndex,\r\n        createShapeHints\r\n      ) :\r\n      modeling.createShape(\r\n        element,\r\n        pick(element, [ 'x', 'y', 'width', 'height' ]),\r\n        element.parent || parent,\r\n        createShapeHints\r\n      );\r\n  });\r\n\r\n  context.elements = values(cache);\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}","import { assign } from 'min-dash';\n\nvar round = Math.round;\n\n\n/**\n * A handler that implements reversible addition of shapes.\n *\n * @param {canvas} Canvas\n */\nexport default function CreateShapeHandler(canvas) {\n  this._canvas = canvas;\n}\n\nCreateShapeHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\n/**\n * Appends a shape to a target shape\n *\n * @param {Object} context\n * @param {djs.model.Base} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      positionOrBounds = context.position,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  if (!parent) {\n    throw new Error('parent required');\n  }\n\n  if (!positionOrBounds) {\n    throw new Error('position required');\n  }\n\n  // (1) add at event center position _or_ at given bounds\n  if (positionOrBounds.width !== undefined) {\n    assign(shape, positionOrBounds);\n  } else {\n    assign(shape, {\n      x: positionOrBounds.x - round(shape.width / 2),\n      y: positionOrBounds.y - round(shape.height / 2)\n    });\n  }\n\n  // (2) add to canvas\n  this._canvas.addShape(shape, parent, parentIndex);\n\n  return shape;\n};\n\n\n/**\n * Undo append by removing the shape\n */\nCreateShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape;\n\n  // (3) remove form canvas\n  this._canvas.removeShape(shape);\n\n  return shape;\n};","import inherits from 'inherits';\n\nimport CreateShapeHandler from './CreateShapeHandler';\n\n\n/**\n * A handler that attaches a label to a given target shape.\n *\n * @param {Canvas} canvas\n */\nexport default function CreateLabelHandler(canvas) {\n  CreateShapeHandler.call(this, canvas);\n}\n\ninherits(CreateLabelHandler, CreateShapeHandler);\n\nCreateLabelHandler.$inject = [ 'canvas' ];\n\n\n// api //////////////////////\n\n\nvar originalExecute = CreateShapeHandler.prototype.execute;\n\n/**\n * Appends a label to a target shape.\n *\n * @method CreateLabelHandler#execute\n *\n * @param {Object} context\n * @param {ElementDescriptor} context.target the element the label is attached to\n * @param {ElementDescriptor} context.parent the parent object\n * @param {Point} context.position position of the new element\n */\nCreateLabelHandler.prototype.execute = function(context) {\n\n  var label = context.shape;\n\n  ensureValidDimensions(label);\n\n  label.labelTarget = context.labelTarget;\n\n  return originalExecute.call(this, context);\n};\n\nvar originalRevert = CreateShapeHandler.prototype.revert;\n\n/**\n * Undo append by removing the shape\n */\nCreateLabelHandler.prototype.revert = function(context) {\n  context.shape.labelTarget = null;\n\n  return originalRevert.call(this, context);\n};\n\n\n// helpers //////////////////////\n\nfunction ensureValidDimensions(label) {\n\n  // make sure a label has valid { width, height } dimensions\n  [ 'width', 'height' ].forEach(function(prop) {\n    if (typeof label[prop] === 'undefined') {\n      label[prop] = 0;\n    }\n  });\n}","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible deletion of Connections.\n */\nexport default function DeleteConnectionHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteConnectionHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nDeleteConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      parent = connection.parent;\n\n  context.parent = parent;\n\n  // remember containment\n  context.parentIndex = collectionIdx(parent.children, connection);\n\n  context.source = connection.source;\n  context.target = connection.target;\n\n  this._canvas.removeConnection(connection);\n\n  connection.source = null;\n  connection.target = null;\n\n  return connection;\n};\n\n/**\n * Command revert implementation.\n */\nDeleteConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      parent = context.parent,\n      parentIndex = context.parentIndex;\n\n  connection.source = context.source;\n  connection.target = context.target;\n\n  // restore containment\n  collectionAdd(parent.children, connection, parentIndex);\n\n  this._canvas.addConnection(connection, parent);\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nexport default function DeleteElementsHandler(modeling, elementRegistry) {\n  this._modeling = modeling;\n  this._elementRegistry = elementRegistry;\n}\n\nDeleteElementsHandler.$inject = [\n  'modeling',\n  'elementRegistry'\n];\n\n\nDeleteElementsHandler.prototype.postExecute = function(context) {\n\n  var modeling = this._modeling,\n      elementRegistry = this._elementRegistry,\n      elements = context.elements;\n\n  forEach(elements, function(element) {\n\n    // element may have been removed with previous\n    // remove operations already (e.g. in case of nesting)\n    if (!elementRegistry.get(element.id)) {\n      return;\n    }\n\n    if (element.waypoints) {\n      modeling.removeConnection(element);\n    } else {\n      modeling.removeShape(element);\n    }\n  });\n};","import {\n  add as collectionAdd,\n  indexOf as collectionIdx\n} from '../../../util/Collections';\n\nimport { saveClear } from '../../../util/Removal';\n\n\n/**\n * A handler that implements reversible deletion of shapes.\n *\n */\nexport default function DeleteShapeHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nDeleteShapeHandler.$inject = [ 'canvas', 'modeling' ];\n\n\n/**\n * - Remove connections\n * - Remove all direct children\n */\nDeleteShapeHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling;\n\n  var shape = context.shape;\n\n  // remove connections\n  saveClear(shape.incoming, function(connection) {\n\n    // To make sure that the connection isn't removed twice\n    // For example if a container is removed\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  saveClear(shape.outgoing, function(connection) {\n    modeling.removeConnection(connection, { nested: true });\n  });\n\n  // remove child shapes and connections\n  saveClear(shape.children, function(child) {\n    if (isConnection(child)) {\n      modeling.removeConnection(child, { nested: true });\n    } else {\n      modeling.removeShape(child, { nested: true });\n    }\n  });\n};\n\n/**\n * Remove shape and remember the parent\n */\nDeleteShapeHandler.prototype.execute = function(context) {\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = shape.parent;\n\n  context.oldParent = oldParent;\n\n  // remove containment\n  context.oldParentIndex = collectionIdx(oldParent.children, shape);\n\n  // remove shape\n  canvas.removeShape(shape);\n\n  return shape;\n};\n\n\n/**\n * Command revert implementation\n */\nDeleteShapeHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex;\n\n  // restore containment\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  canvas.addShape(shape, oldParent);\n\n  return shape;\n};\n\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import {\n  forEach,\n  sortBy\n} from 'min-dash';\n\n\n/**\n * A handler that distributes elements evenly.\n */\nexport default function DistributeElements(modeling) {\n  this._modeling = modeling;\n}\n\nDistributeElements.$inject = [ 'modeling' ];\n\nvar OFF_AXIS = {\n  x: 'y',\n  y: 'x'\n};\n\nDistributeElements.prototype.preExecute = function(context) {\n  var modeling = this._modeling;\n\n  var groups = context.groups,\n      axis = context.axis,\n      dimension = context.dimension;\n\n  function updateRange(group, element) {\n    group.range.min = Math.min(element[axis], group.range.min);\n    group.range.max = Math.max(element[axis] + element[dimension], group.range.max);\n  }\n\n  function center(element) {\n    return element[axis] + element[dimension] / 2;\n  }\n\n  function lastIdx(arr) {\n    return arr.length - 1;\n  }\n\n  function rangeDiff(range) {\n    return range.max - range.min;\n  }\n\n  function centerElement(refCenter, element) {\n    var delta = { y: 0 };\n\n    delta[axis] = refCenter - center(element);\n\n    if (delta[axis]) {\n\n      delta[OFF_AXIS[axis]] = 0;\n\n      modeling.moveElements([ element ], delta, element.parent);\n    }\n  }\n\n  var firstGroup = groups[0],\n      lastGroupIdx = lastIdx(groups),\n      lastGroup = groups[ lastGroupIdx ];\n\n  var margin,\n      spaceInBetween,\n      groupsSize = 0; // the size of each range\n\n  forEach(groups, function(group, idx) {\n    var sortedElements,\n        refElem,\n        refCenter;\n\n    if (group.elements.length < 2) {\n      if (idx && idx !== groups.length - 1) {\n        updateRange(group, group.elements[0]);\n\n        groupsSize += rangeDiff(group.range);\n      }\n      return;\n    }\n\n    sortedElements = sortBy(group.elements, axis);\n\n    refElem = sortedElements[0];\n\n    if (idx === lastGroupIdx) {\n      refElem = sortedElements[lastIdx(sortedElements)];\n    }\n\n    refCenter = center(refElem);\n\n    // wanna update the ranges after the shapes have been centered\n    group.range = null;\n\n    forEach(sortedElements, function(element) {\n\n      centerElement(refCenter, element);\n\n      if (group.range === null) {\n        group.range = {\n          min: element[axis],\n          max: element[axis] + element[dimension]\n        };\n\n        return;\n      }\n\n      // update group's range after centering the range elements\n      updateRange(group, element);\n    });\n\n    if (idx && idx !== groups.length - 1) {\n      groupsSize += rangeDiff(group.range);\n    }\n  });\n\n  spaceInBetween = Math.abs(lastGroup.range.min - firstGroup.range.max);\n\n  margin = Math.round((spaceInBetween - groupsSize) / (groups.length - 1));\n\n  if (margin < groups.length - 1) {\n    return;\n  }\n\n  forEach(groups, function(group, groupIdx) {\n    var delta = {},\n        prevGroup;\n\n    if (group === firstGroup || group === lastGroup) {\n      return;\n    }\n\n    prevGroup = groups[groupIdx - 1];\n\n    group.range.max = 0;\n\n    forEach(group.elements, function(element, idx) {\n      delta[OFF_AXIS[axis]] = 0;\n      delta[axis] = (prevGroup.range.max - element[axis]) + margin;\n\n      if (group.range.min !== element[axis]) {\n        delta[axis] += element[axis] - group.range.min;\n      }\n\n      if (delta[axis]) {\n        modeling.moveElements([ element ], delta, element.parent);\n      }\n\n      group.range.max = Math.max(element[axis] + element[dimension], idx ? group.range.max : 0);\n    });\n  });\n};\n\nDistributeElements.prototype.postExecute = function(context) {\n\n};\n","import { assign } from 'min-dash';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function LayoutConnectionHandler(layouter, canvas) {\n  this._layouter = layouter;\n  this._canvas = canvas;\n}\n\nLayoutConnectionHandler.$inject = [ 'layouter', 'canvas' ];\n\nLayoutConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection;\n\n  var oldWaypoints = connection.waypoints;\n\n  assign(context, {\n    oldWaypoints: oldWaypoints\n  });\n\n  connection.waypoints = this._layouter.layoutConnection(connection, context.hints);\n\n  return connection;\n};\n\nLayoutConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection;\n\n  connection.waypoints = context.oldWaypoints;\n\n  return connection;\n};\n","import { forEach } from 'min-dash';\n\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n\n/**\n * A handler that implements reversible moving of connections.\n *\n * The handler differs from the layout connection handler in a sense\n * that it preserves the connection layout.\n */\nexport default function MoveConnectionHandler() { }\n\n\nMoveConnectionHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      delta = context.delta;\n\n  var newParent = context.newParent || connection.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = connection.parent;\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, connection);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, connection, newParentIndex);\n\n  // update parent\n  connection.parent = newParent;\n\n  // update waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x += delta.x;\n    p.y += delta.y;\n\n    if (p.original) {\n      p.original.x += delta.x;\n      p.original.y += delta.y;\n    }\n  });\n\n  return connection;\n};\n\nMoveConnectionHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      newParent = connection.parent,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // remove from newParent\n  collectionRemove(newParent.children, connection);\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, connection, oldParentIndex);\n\n  // restore parent\n  connection.parent = oldParent;\n\n  // revert to old waypoint positions\n  forEach(connection.waypoints, function(p) {\n    p.x -= delta.x;\n    p.y -= delta.y;\n\n    if (p.original) {\n      p.original.x -= delta.x;\n      p.original.y -= delta.y;\n    }\n  });\n\n  return connection;\n};","import {\n  getNewAttachPoint\n} from '../../../../util/AttachUtil';\n\n\nexport function getResizedSourceAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[0];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getResizedTargetAnchor(connection, shape, oldBounds) {\n\n  var waypoints = safeGetWaypoints(connection),\n      oldAnchor = waypoints[waypoints.length - 1];\n\n  return getNewAttachPoint(oldAnchor.original || oldAnchor, oldBounds, shape);\n}\n\n\nexport function getMovedSourceAnchor(connection, source, moveDelta) {\n  return getResizedSourceAnchor(connection, source, substractPosition(source, moveDelta));\n}\n\n\nexport function getMovedTargetAnchor(connection, target, moveDelta) {\n  return getResizedTargetAnchor(connection, target, substractPosition(target, moveDelta));\n}\n\n\n// helpers //////////////////////\n\nfunction substractPosition(bounds, delta) {\n  return {\n    x: bounds.x - delta.x,\n    y: bounds.y - delta.y,\n    width: bounds.width,\n    height: bounds.height\n  };\n}\n\n\n/**\n * Return waypoints of given connection; throw if non exists (should not happen!!).\n *\n * @param {Connection} connection\n *\n * @return {Array<Point>}\n */\nfunction safeGetWaypoints(connection) {\n\n  var waypoints = connection.waypoints;\n\n  if (!waypoints.length) {\n    throw new Error('connection#' + connection.id + ': no waypoints');\n  }\n\n  return waypoints;\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getClosure\n} from '../../../../util/Elements';\n\n\nexport default function MoveClosure() {\n\n  this.allShapes = {};\n  this.allConnections = {};\n\n  this.enclosedElements = {};\n  this.enclosedConnections = {};\n\n  this.topLevel = {};\n}\n\n\nMoveClosure.prototype.add = function(element, isTopLevel) {\n  return this.addAll([ element ], isTopLevel);\n};\n\n\nMoveClosure.prototype.addAll = function(elements, isTopLevel) {\n\n  var newClosure = getClosure(elements, !!isTopLevel, this);\n\n  assign(this, newClosure);\n\n  return this;\n};","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './AnchorsHelper';\n\nimport MoveClosure from './MoveClosure';\n\n\n/**\n * A helper that is able to carry out serialized move\n * operations on multiple elements.\n *\n * @param {Modeling} modeling\n */\nexport default function MoveHelper(modeling) {\n  this._modeling = modeling;\n}\n\n/**\n * Move the specified elements and all children by the given delta.\n *\n * This moves all enclosed connections, too and layouts all affected\n * external connections.\n *\n * @param  {Array<djs.model.Base>} elements\n * @param  {Point} delta\n * @param  {djs.model.Base} newParent applied to the first level of shapes\n *\n * @return {Array<djs.model.Base>} list of touched elements\n */\nMoveHelper.prototype.moveRecursive = function(elements, delta, newParent) {\n  if (!elements) {\n    return [];\n  } else {\n    return this.moveClosure(this.getClosure(elements), delta, newParent);\n  }\n};\n\n/**\n * Move the given closure of elmements.\n *\n * @param {Object} closure\n * @param {Point} delta\n * @param {djs.model.Base} [newParent]\n * @param {djs.model.Base} [newHost]\n */\nMoveHelper.prototype.moveClosure = function(closure, delta, newParent, newHost, primaryShape) {\n  var modeling = this._modeling;\n\n  var allShapes = closure.allShapes,\n      allConnections = closure.allConnections,\n      enclosedConnections = closure.enclosedConnections,\n      topLevel = closure.topLevel,\n      keepParent = false;\n\n  if (primaryShape && primaryShape.parent === newParent) {\n    keepParent = true;\n  }\n\n  // move all shapes\n  forEach(allShapes, function(shape) {\n\n    // move the element according to the given delta\n    modeling.moveShape(shape, delta, topLevel[shape.id] && !keepParent && newParent, {\n      recurse: false,\n      layout: false\n    });\n  });\n\n  // move all child connections / layout external connections\n  forEach(allConnections, function(c) {\n\n    var sourceMoved = !!allShapes[c.source.id],\n        targetMoved = !!allShapes[c.target.id];\n\n    if (enclosedConnections[c.id] && sourceMoved && targetMoved) {\n      modeling.moveConnection(c, delta, topLevel[c.id] && !keepParent && newParent);\n    } else {\n      modeling.layoutConnection(c, {\n        connectionStart: sourceMoved && getMovedSourceAnchor(c, c.source, delta),\n        connectionEnd: targetMoved && getMovedTargetAnchor(c, c.target, delta)\n      });\n    }\n  });\n};\n\n/**\n * Returns the closure for the selected elements\n *\n * @param  {Array<djs.model.Base>} elements\n * @return {MoveClosure} closure\n */\nMoveHelper.prototype.getClosure = function(elements) {\n  return new MoveClosure().addAll(elements, true);\n};","import MoveHelper from './helper/MoveHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveElementsHandler(modeling) {\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveElementsHandler.$inject = [ 'modeling' ];\n\nMoveElementsHandler.prototype.preExecute = function(context) {\n  context.closure = this._helper.getClosure(context.shapes);\n};\n\nMoveElementsHandler.prototype.postExecute = function(context) {\n\n  var hints = context.hints,\n      primaryShape;\n\n  if (hints && hints.primaryShape) {\n    primaryShape = hints.primaryShape;\n    hints.oldParent = primaryShape.parent;\n  }\n\n  this._helper.moveClosure(\n    context.closure,\n    context.delta,\n    context.newParent,\n    context.newHost,\n    primaryShape\n  );\n};","import {\n  assign,\n  forEach,\n  pick\n} from 'min-dash';\n\nimport MoveHelper from './helper/MoveHelper';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\nimport {\n  getMovedSourceAnchor,\n  getMovedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible moving of shapes.\n */\nexport default function MoveShapeHandler(modeling) {\n  this._modeling = modeling;\n\n  this._helper = new MoveHelper(modeling);\n}\n\nMoveShapeHandler.$inject = [ 'modeling' ];\n\n\nMoveShapeHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      newParent = context.newParent || shape.parent,\n      newParentIndex = context.newParentIndex,\n      oldParent = shape.parent;\n\n  context.oldBounds = pick(shape, [ 'x', 'y', 'width', 'height']);\n\n  // save old parent in context\n  context.oldParent = oldParent;\n  context.oldParentIndex = collectionRemove(oldParent.children, shape);\n\n  // add to new parent at position\n  collectionAdd(newParent.children, shape, newParentIndex);\n\n  // update shape parent + position\n  assign(shape, {\n    parent: newParent,\n    x: shape.x + delta.x,\n    y: shape.y + delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.postExecute = function(context) {\n\n  var shape = context.shape,\n      delta = context.delta,\n      hints = context.hints;\n\n  var modeling = this._modeling;\n\n  if (hints.layout !== false) {\n\n    forEach(shape.incoming, function(c) {\n      modeling.layoutConnection(c, {\n        connectionEnd: getMovedTargetAnchor(c, shape, delta)\n      });\n    });\n\n    forEach(shape.outgoing, function(c) {\n      modeling.layoutConnection(c, {\n        connectionStart: getMovedSourceAnchor(c, shape, delta)\n      });\n    });\n  }\n\n  if (hints.recurse !== false) {\n    this.moveChildren(context);\n  }\n};\n\nMoveShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldParent = context.oldParent,\n      oldParentIndex = context.oldParentIndex,\n      delta = context.delta;\n\n  // restore previous location in old parent\n  collectionAdd(oldParent.children, shape, oldParentIndex);\n\n  // revert to old position and parent\n  assign(shape, {\n    parent: oldParent,\n    x: shape.x - delta.x,\n    y: shape.y - delta.y\n  });\n\n  return shape;\n};\n\nMoveShapeHandler.prototype.moveChildren = function(context) {\n\n  var delta = context.delta,\n      shape = context.shape;\n\n  this._helper.moveRecursive(shape.children, delta, null);\n};\n\nMoveShapeHandler.prototype.getNewParent = function(context) {\n  return context.newParent || context.shape.parent;\n};\n","import { isArray } from 'min-dash';\n\n\n/**\n * Reconnect connection handler\n */\nexport default function ReconnectConnectionHandler(modeling) {\n  this._modeling = modeling;\n}\n\nReconnectConnectionHandler.$inject = [ 'modeling' ];\n\nReconnectConnectionHandler.prototype.execute = function(context) {\n  var newSource = context.newSource,\n      newTarget = context.newTarget,\n      connection = context.connection,\n      dockingOrPoints = context.dockingOrPoints;\n\n  if (!newSource && !newTarget) {\n    throw new Error('newSource or newTarget required');\n  }\n\n  if (isArray(dockingOrPoints)) {\n    context.oldWaypoints = connection.waypoints;\n    connection.waypoints = dockingOrPoints;\n  }\n\n  if (newSource) {\n    context.oldSource = connection.source;\n    connection.source = newSource;\n  }\n\n  if (newTarget) {\n    context.oldTarget = connection.target;\n    connection.target = newTarget;\n  }\n\n  return connection;\n};\n\nReconnectConnectionHandler.prototype.postExecute = function(context) {\n  var connection = context.connection,\n      newSource = context.newSource,\n      newTarget = context.newTarget,\n      dockingOrPoints = context.dockingOrPoints,\n      hints = context.hints || {};\n\n  if (hints.layoutConnection === false) {\n    return;\n  }\n\n  var layoutConnectionHints = {};\n\n  if (newSource && (!newTarget || hints.docking === 'source')) {\n    layoutConnectionHints.connectionStart = getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ 0 ] : dockingOrPoints);\n  }\n\n  if (newTarget && (!newSource || hints.docking === 'target')) {\n    layoutConnectionHints.connectionEnd = getDocking(isArray(dockingOrPoints) ? dockingOrPoints[ dockingOrPoints.length - 1 ] : dockingOrPoints);\n  }\n\n  if (hints.newWaypoints) {\n    layoutConnectionHints.waypoints = hints.newWaypoints;\n  }\n\n  this._modeling.layoutConnection(connection, layoutConnectionHints);\n};\n\nReconnectConnectionHandler.prototype.revert = function(context) {\n  var oldSource = context.oldSource,\n      oldTarget = context.oldTarget,\n      oldWaypoints = context.oldWaypoints,\n      connection = context.connection;\n\n  if (oldSource) {\n    connection.source = oldSource;\n  }\n\n  if (oldTarget) {\n    connection.target = oldTarget;\n  }\n\n  if (oldWaypoints) {\n    connection.waypoints = oldWaypoints;\n  }\n\n  return connection;\n};\n\n\n\n// helpers //////////\n\nfunction getDocking(point) {\n  return point.original || point;\n}","import { forEach } from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n/**\n * Replace shape by adding new shape and removing old shape. Incoming and outgoing connections will\n * be kept if possible.\n *\n * @class\n * @constructor\n *\n * @param {Modeling} modeling\n * @param {Rules} rules\n */\nexport default function ReplaceShapeHandler(modeling, rules) {\n  this._modeling = modeling;\n  this._rules = rules;\n}\n\nReplaceShapeHandler.$inject = [ 'modeling', 'rules' ];\n\n\n/**\n * Add new shape.\n *\n * @param {Object} context\n * @param {djs.model.Shape} context.oldShape\n * @param {Object} context.newData\n * @param {string} context.newData.type\n * @param {number} context.newData.x\n * @param {number} context.newData.y\n * @param {Object} [hints]\n */\nReplaceShapeHandler.prototype.preExecute = function(context) {\n  var self = this,\n      modeling = this._modeling,\n      rules = this._rules;\n\n  var oldShape = context.oldShape,\n      newData = context.newData,\n      hints = context.hints || {},\n      newShape;\n\n  function canReconnect(source, target, connection) {\n    return rules.allowed('connection.reconnect', {\n      connection: connection,\n      source: source,\n      target: target\n    });\n  }\n\n  // (1) add new shape at given position\n  var position = {\n    x: newData.x,\n    y: newData.y\n  };\n\n  var oldBounds = {\n    x: oldShape.x,\n    y: oldShape.y,\n    width: oldShape.width,\n    height: oldShape.height\n  };\n\n  newShape = context.newShape =\n    context.newShape ||\n    self.createShape(newData, position, oldShape.parent, hints);\n\n  // (2) update host\n  if (oldShape.host) {\n    modeling.updateAttachment(newShape, oldShape.host);\n  }\n\n  // (3) adopt all children from old shape\n  var children;\n\n  if (hints.moveChildren !== false) {\n    children = oldShape.children.slice();\n\n    modeling.moveElements(children, { x: 0, y: 0 }, newShape, hints);\n  }\n\n  // (4) reconnect connections to new shape if possible\n  var incoming = oldShape.incoming.slice(),\n      outgoing = oldShape.outgoing.slice();\n\n  forEach(incoming, function(connection) {\n    var source = connection.source,\n        allowed = canReconnect(source, newShape, connection);\n\n    if (allowed) {\n      self.reconnectEnd(\n        connection, newShape,\n        getResizedTargetAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n\n  forEach(outgoing, function(connection) {\n    var target = connection.target,\n        allowed = canReconnect(newShape, target, connection);\n\n    if (allowed) {\n      self.reconnectStart(\n        connection, newShape,\n        getResizedSourceAnchor(connection, newShape, oldBounds),\n        hints\n      );\n    }\n  });\n};\n\n\n/**\n * Remove old shape.\n */\nReplaceShapeHandler.prototype.postExecute = function(context) {\n  var oldShape = context.oldShape;\n\n  this._modeling.removeShape(oldShape);\n};\n\n\nReplaceShapeHandler.prototype.execute = function(context) {};\n\n\nReplaceShapeHandler.prototype.revert = function(context) {};\n\n\nReplaceShapeHandler.prototype.createShape = function(shape, position, target, hints) {\n  return this._modeling.createShape(shape, position, target, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectStart = function(connection, newSource, dockingPoint, hints) {\n  this._modeling.reconnectStart(connection, newSource, dockingPoint, hints);\n};\n\n\nReplaceShapeHandler.prototype.reconnectEnd = function(connection, newTarget, dockingPoint, hints) {\n  this._modeling.reconnectEnd(connection, newTarget, dockingPoint, hints);\n};\n","import {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  getResizedSourceAnchor,\n  getResizedTargetAnchor\n} from './helper/AnchorsHelper';\n\n\n/**\n * A handler that implements reversible resizing of shapes.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeShapeHandler(modeling) {\n  this._modeling = modeling;\n}\n\nResizeShapeHandler.$inject = [ 'modeling' ];\n\n/**\n * {\n *   shape: {....}\n *   newBounds: {\n *     width:  20,\n *     height: 40,\n *     x:       5,\n *     y:      10\n *   }\n *\n * }\n */\nResizeShapeHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      minBounds = context.minBounds;\n\n  if (newBounds.x === undefined || newBounds.y === undefined ||\n      newBounds.width === undefined || newBounds.height === undefined) {\n    throw new Error('newBounds must have {x, y, width, height} properties');\n  }\n\n  if (minBounds && (newBounds.width < minBounds.width\n    || newBounds.height < minBounds.height)) {\n    throw new Error('width and height cannot be less than minimum height and width');\n  } else if (!minBounds\n    && newBounds.width < 10 || newBounds.height < 10) {\n    throw new Error('width and height cannot be less than 10px');\n  }\n\n  // save old bbox in context\n  context.oldBounds = {\n    width:  shape.width,\n    height: shape.height,\n    x:      shape.x,\n    y:      shape.y\n  };\n\n  // update shape\n  assign(shape, {\n    width:  newBounds.width,\n    height: newBounds.height,\n    x:      newBounds.x,\n    y:      newBounds.y\n  });\n\n  return shape;\n};\n\nResizeShapeHandler.prototype.postExecute = function(context) {\n  var modeling = this._modeling;\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds,\n      hints = context.hints || {};\n\n  if (hints.layout === false) {\n    return;\n  }\n\n  forEach(shape.incoming, function(c) {\n    modeling.layoutConnection(c, {\n      connectionEnd: getResizedTargetAnchor(c, shape, oldBounds)\n    });\n  });\n\n  forEach(shape.outgoing, function(c) {\n    modeling.layoutConnection(c, {\n      connectionStart: getResizedSourceAnchor(c, shape, oldBounds)\n    });\n  });\n\n};\n\nResizeShapeHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldBounds = context.oldBounds;\n\n  // restore previous bbox\n  assign(shape, {\n    width:  oldBounds.width,\n    height: oldBounds.height,\n    x:      oldBounds.x,\n    y:      oldBounds.y\n  });\n\n  return shape;\n};\n","import {\n  assign,\n  forEach,\n  map\n} from 'min-dash';\n\nimport {\n  getWaypointsUpdatingConnections,\n  resizeBounds\n} from '../../space-tool/SpaceUtil';\n\n\n/**\n * Add or remove space by moving and resizing shapes and updating connection waypoints.\n */\nexport default function SpaceToolHandler(modeling) {\n  this._modeling = modeling;\n}\n\nSpaceToolHandler.$inject = [ 'modeling' ];\n\nSpaceToolHandler.prototype.preExecute = function(context) {\n  var delta = context.delta,\n      direction = context.direction,\n      movingShapes = context.movingShapes,\n      resizingShapes = context.resizingShapes,\n      start = context.start;\n\n  // (1) move shapes\n  this.moveShapes(movingShapes, delta);\n\n  // (2) resize shapes\n  this.resizeShapes(resizingShapes, delta, direction);\n\n  // (3) update connection waypoints\n  this.updateConnectionWaypoints(\n    getWaypointsUpdatingConnections(movingShapes, resizingShapes),\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes\n  );\n};\n\nSpaceToolHandler.prototype.execute = function() {};\nSpaceToolHandler.prototype.revert = function() {};\n\nSpaceToolHandler.prototype.moveShapes = function(shapes, delta) {\n  var self = this;\n\n  forEach(shapes, function(element) {\n    self._modeling.moveShape(element, delta, null, {\n      autoResize: false,\n      layout: false,\n      recurse: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.resizeShapes = function(shapes, delta, direction) {\n  var self = this;\n\n  forEach(shapes, function(shape) {\n    var newBounds = resizeBounds(shape, direction, delta);\n\n    self._modeling.resizeShape(shape, newBounds, null, {\n      attachSupport: false,\n      autoResize: false,\n      layout: false\n    });\n  });\n};\n\nSpaceToolHandler.prototype.updateConnectionWaypoints = function(\n    connections,\n    delta,\n    direction,\n    start,\n    movingShapes,\n    resizingShapes\n) {\n  var self = this;\n\n  forEach(connections, function(connection) {\n    var source = connection.source,\n        target = connection.target,\n        waypoints = copyWaypoints(connection);\n\n    var axis = getAxisFromDirection(direction);\n\n    // move waypoints\n    waypoints = map(waypoints, function(waypoint, index) {\n      var isFirstWaypoint = index === 0,\n          isLastWaypoint = index === waypoints.length - 1;\n\n      // do NOT move first/last waypoint if source/target NOT moving or resizing\n      if ((isFirstWaypoint && !includes(movingShapes.concat(resizingShapes), source)) ||\n        (isLastWaypoint && !includes(movingShapes.concat(resizingShapes), target))) {\n\n        return waypoint;\n      }\n\n      if ((waypoint[ axis ] > start && /e|s/.test(direction)) ||\n        (waypoint[ axis ] < start) && /n|w/.test(direction)) {\n\n        // move waypoint\n        waypoint[ axis ] = waypoint[ axis ] + delta[ axis ];\n      }\n\n      if (waypoint.original) {\n        if ((waypoint.original[ axis ] > start && /e|s/.test(direction)) ||\n          (waypoint.original[ axis ] < start) && /n|w/.test(direction)) {\n\n          // move waypoint original\n          waypoint.original[ axis ] = waypoint.original[ axis ] + delta[ axis ];\n        }\n      }\n\n      return waypoint;\n    });\n\n    self._modeling.updateWaypoints(connection, waypoints, {\n      labelBehavior: false\n    });\n  });\n};\n\n\n// helpers //////////\n\nfunction copyWaypoint(waypoint) {\n  return assign({}, waypoint);\n}\n\nfunction copyWaypoints(connection) {\n  return map(connection.waypoints, function(waypoint) {\n\n    waypoint = copyWaypoint(waypoint);\n\n    if (waypoint.original) {\n      waypoint.original = copyWaypoint(waypoint.original);\n    }\n\n    return waypoint;\n  });\n}\n\nfunction getAxisFromDirection(direction) {\n  switch (direction) {\n  case 'n':\n    return 'y';\n  case 'w':\n    return 'x';\n  case 's':\n    return 'y';\n  case 'e':\n    return 'x';\n  }\n}\n\nfunction includes(array, item) {\n  return array.indexOf(item) !== -1;\n}","import {\n  assign,\n  forEach\n} from 'min-dash';\n\n/**\n * A handler that toggles the collapsed state of an element\n * and the visibility of all its children.\n *\n * @param {Modeling} modeling\n */\nexport default function ToggleShapeCollapseHandler(modeling) {\n  this._modeling = modeling;\n}\n\nToggleShapeCollapseHandler.$inject = [ 'modeling' ];\n\n\nToggleShapeCollapseHandler.prototype.execute = function(context) {\n\n  var shape = context.shape,\n      children = shape.children;\n\n  // recursively remember previous visibility of children\n  context.oldChildrenVisibility = getElementsVisibilityRecursive(children);\n\n  // toggle state\n  shape.collapsed = !shape.collapsed;\n\n  // recursively hide/show children\n  var result = setHiddenRecursive(children, shape.collapsed);\n\n  return [shape].concat(result);\n};\n\n\nToggleShapeCollapseHandler.prototype.revert = function(context) {\n\n  var shape = context.shape,\n      oldChildrenVisibility = context.oldChildrenVisibility;\n\n  var children = shape.children;\n\n  // recursively set old visability of children\n  var result = restoreVisibilityRecursive(children, oldChildrenVisibility);\n\n  // retoggle state\n  shape.collapsed = !shape.collapsed;\n\n  return [shape].concat(result);\n};\n\n\n// helpers //////////////////////\n\n/**\n * Return a map { elementId -> hiddenState}.\n *\n * @param {Array<djs.model.Shape>} elements\n *\n * @return {Object}\n */\nfunction getElementsVisibilityRecursive(elements) {\n\n  var result = {};\n\n  forEach(elements, function(element) {\n    result[element.id] = element.hidden;\n\n    if (element.children) {\n      result = assign({}, result, getElementsVisibilityRecursive(element.children));\n    }\n  });\n\n  return result;\n}\n\n\nfunction setHiddenRecursive(elements, newHidden) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = newHidden;\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(setHiddenRecursive(element.children, element.collapsed || newHidden));\n    }\n  });\n\n  return result;\n}\n\nfunction restoreVisibilityRecursive(elements, lastState) {\n  var result = [];\n  forEach(elements, function(element) {\n    element.hidden = lastState[element.id];\n\n    result = result.concat(element);\n\n    if (element.children) {\n      result = result.concat(restoreVisibilityRecursive(element.children, lastState));\n    }\n  });\n\n  return result;\n}\n","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from '../../../util/Collections';\n\n/**\n * A handler that implements reversible attaching/detaching of shapes.\n */\nexport default function UpdateAttachmentHandler(modeling) {\n  this._modeling = modeling;\n}\n\nUpdateAttachmentHandler.$inject = [ 'modeling' ];\n\n\nUpdateAttachmentHandler.prototype.execute = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = shape.host;\n\n  // (0) detach from old host\n  context.oldHost = oldHost;\n  context.attacherIdx = removeAttacher(oldHost, shape);\n\n  // (1) attach to new host\n  addAttacher(newHost, shape);\n\n  // (2) update host\n  shape.host = newHost;\n\n  return shape;\n};\n\nUpdateAttachmentHandler.prototype.revert = function(context) {\n  var shape = context.shape,\n      newHost = context.newHost,\n      oldHost = context.oldHost,\n      attacherIdx = context.attacherIdx;\n\n  // (2) update host\n  shape.host = oldHost;\n\n  // (1) attach to new host\n  removeAttacher(newHost, shape);\n\n  // (0) detach from old host\n  addAttacher(oldHost, shape, attacherIdx);\n\n  return shape;\n};\n\n\nfunction removeAttacher(host, attacher) {\n\n  // remove attacher from host\n  return collectionRemove(host && host.attachers, attacher);\n}\n\nfunction addAttacher(host, attacher, idx) {\n\n  if (!host) {\n    return;\n  }\n\n  var attachers = host.attachers;\n\n  if (!attachers) {\n    host.attachers = attachers = [];\n  }\n\n  collectionAdd(attachers, attacher, idx);\n}\n","export default function UpdateWaypointsHandler() { }\n\nUpdateWaypointsHandler.prototype.execute = function(context) {\n\n  var connection = context.connection,\n      newWaypoints = context.newWaypoints;\n\n  context.oldWaypoints = connection.waypoints;\n\n  connection.waypoints = newWaypoints;\n\n  return connection;\n};\n\nUpdateWaypointsHandler.prototype.revert = function(context) {\n\n  var connection = context.connection,\n      oldWaypoints = context.oldWaypoints;\n\n  connection.waypoints = oldWaypoints;\n\n  return connection;\n};","import {\n  assign,\n  forEach,\n  isArray\n} from 'min-dash';\n\nimport {\n  Base\n} from '../../model';\n\nimport AlignElementsHandler from './cmd/AlignElementsHandler';\nimport AppendShapeHandler from './cmd/AppendShapeHandler';\nimport CreateConnectionHandler from './cmd/CreateConnectionHandler';\nimport CreateElementsHandler from './cmd/CreateElementsHandler';\nimport CreateLabelHandler from './cmd/CreateLabelHandler';\nimport CreateShapeHandler from './cmd/CreateShapeHandler';\nimport DeleteConnectionHandler from './cmd/DeleteConnectionHandler';\nimport DeleteElementsHandler from './cmd/DeleteElementsHandler';\nimport DeleteShapeHandler from './cmd/DeleteShapeHandler';\nimport DistributeElementsHandler from './cmd/DistributeElementsHandler';\nimport LayoutConnectionHandler from './cmd/LayoutConnectionHandler';\nimport MoveConnectionHandler from './cmd/MoveConnectionHandler';\nimport MoveElementsHandler from './cmd/MoveElementsHandler';\nimport MoveShapeHandler from './cmd/MoveShapeHandler';\nimport ReconnectConnectionHandler from './cmd/ReconnectConnectionHandler';\nimport ReplaceShapeHandler from './cmd/ReplaceShapeHandler';\nimport ResizeShapeHandler from './cmd/ResizeShapeHandler';\nimport SpaceToolHandler from './cmd/SpaceToolHandler';\nimport ToggleShapeCollapseHandler from './cmd/ToggleShapeCollapseHandler';\nimport UpdateAttachmentHandler from './cmd/UpdateAttachmentHandler';\nimport UpdateWaypointsHandler from './cmd/UpdateWaypointsHandler';\n\n\n/**\n * The basic modeling entry point.\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n */\nexport default function Modeling(eventBus, elementFactory, commandStack) {\n  this._eventBus = eventBus;\n  this._elementFactory = elementFactory;\n  this._commandStack = commandStack;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n\n    // register modeling handlers\n    self.registerHandlers(commandStack);\n  });\n}\n\nModeling.$inject = [ 'eventBus', 'elementFactory', 'commandStack' ];\n\n\nModeling.prototype.getHandlers = function() {\n  return {\n    'shape.append': AppendShapeHandler,\n    'shape.create': CreateShapeHandler,\n    'shape.delete': DeleteShapeHandler,\n    'shape.move': MoveShapeHandler,\n    'shape.resize': ResizeShapeHandler,\n    'shape.replace': ReplaceShapeHandler,\n    'shape.toggleCollapse': ToggleShapeCollapseHandler,\n\n    'spaceTool': SpaceToolHandler,\n\n    'label.create': CreateLabelHandler,\n\n    'connection.create': CreateConnectionHandler,\n    'connection.delete': DeleteConnectionHandler,\n    'connection.move': MoveConnectionHandler,\n    'connection.layout': LayoutConnectionHandler,\n\n    'connection.updateWaypoints': UpdateWaypointsHandler,\n\n    'connection.reconnect': ReconnectConnectionHandler,\n\n    'elements.create': CreateElementsHandler,\n    'elements.move': MoveElementsHandler,\n    'elements.delete': DeleteElementsHandler,\n\n    'elements.distribute': DistributeElementsHandler,\n    'elements.align': AlignElementsHandler,\n\n    'element.updateAttachment': UpdateAttachmentHandler\n  };\n};\n\n/**\n * Register handlers with the command stack\n *\n * @param {CommandStack} commandStack\n */\nModeling.prototype.registerHandlers = function(commandStack) {\n  forEach(this.getHandlers(), function(handler, id) {\n    commandStack.registerHandler(id, handler);\n  });\n};\n\n\n// modeling helpers //////////////////////\n\nModeling.prototype.moveShape = function(shape, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = null;\n  }\n\n  var context = {\n    shape: shape,\n    delta:  delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.move', context);\n};\n\n\n/**\n * Update the attachment of the given shape.\n *\n * @param {djs.mode.Base} shape\n * @param {djs.model.Base} [newHost]\n */\nModeling.prototype.updateAttachment = function(shape, newHost) {\n  var context = {\n    shape: shape,\n    newHost: newHost\n  };\n\n  this._commandStack.execute('element.updateAttachment', context);\n};\n\n\n/**\n * Move a number of shapes to a new target, either setting it as\n * the new parent or attaching it.\n *\n * @param {Array<djs.mode.Base>} shapes\n * @param {Point} delta\n * @param {djs.model.Base} [target]\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach=false]\n */\nModeling.prototype.moveElements = function(shapes, delta, target, hints) {\n\n  hints = hints || {};\n\n  var attach = hints.attach;\n\n  var newParent = target,\n      newHost;\n\n  if (attach === true) {\n    newHost = target;\n    newParent = target.parent;\n  } else\n\n  if (attach === false) {\n    newHost = null;\n  }\n\n  var context = {\n    shapes: shapes,\n    delta: delta,\n    newParent: newParent,\n    newHost: newHost,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.move', context);\n};\n\n\nModeling.prototype.moveConnection = function(connection, delta, newParent, newParentIndex, hints) {\n\n  if (typeof newParentIndex === 'object') {\n    hints = newParentIndex;\n    newParentIndex = undefined;\n  }\n\n  var context = {\n    connection: connection,\n    delta: delta,\n    newParent: newParent,\n    newParentIndex: newParentIndex,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.move', context);\n};\n\n\nModeling.prototype.layoutConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.layout', context);\n};\n\n\n/**\n * Create connection.\n *\n * @param {djs.model.Base} source\n * @param {djs.model.Base} target\n * @param {Number} [parentIndex]\n * @param {Object|djs.model.Connection} connection\n * @param {djs.model.Base} parent\n * @param {Object} hints\n *\n * @return {djs.model.Connection} the created connection.\n */\nModeling.prototype.createConnection = function(source, target, parentIndex, connection, parent, hints) {\n\n  if (typeof parentIndex === 'object') {\n    hints = parent;\n    parent = connection;\n    connection = parentIndex;\n    parentIndex = undefined;\n  }\n\n  connection = this._create('connection', connection);\n\n  var context = {\n    source: source,\n    target: target,\n    parent: parent,\n    parentIndex: parentIndex,\n    connection: connection,\n    hints: hints\n  };\n\n  this._commandStack.execute('connection.create', context);\n\n  return context.connection;\n};\n\n\n/**\n * Create a shape at the specified position.\n *\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape|djs.model.Root} target\n * @param {Number} [parentIndex] position in parents children list\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach] whether to attach to target or become a child\n *\n * @return {djs.model.Shape} the created shape\n */\nModeling.prototype.createShape = function(shape, position, target, parentIndex, hints) {\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var attach = hints.attach,\n      parent,\n      host;\n\n  shape = this._create('shape', shape);\n\n  if (attach) {\n    parent = target.parent;\n    host = target;\n  } else {\n    parent = target;\n  }\n\n  var context = {\n    position: position,\n    shape: shape,\n    parent: parent,\n    parentIndex: parentIndex,\n    host: host,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.create', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.createElements = function(elements, position, parent, parentIndex, hints) {\n  if (!isArray(elements)) {\n    elements = [ elements ];\n  }\n\n  if (typeof parentIndex !== 'number') {\n    hints = parentIndex;\n    parentIndex = undefined;\n  }\n\n  hints = hints || {};\n\n  var context = {\n    position: position,\n    elements: elements,\n    parent: parent,\n    parentIndex: parentIndex,\n    hints: hints\n  };\n\n  this._commandStack.execute('elements.create', context);\n\n  return context.elements;\n};\n\n\nModeling.prototype.createLabel = function(labelTarget, position, label, parent) {\n\n  label = this._create('label', label);\n\n  var context = {\n    labelTarget: labelTarget,\n    position: position,\n    parent: parent || labelTarget.parent,\n    shape: label\n  };\n\n  this._commandStack.execute('label.create', context);\n\n  return context.shape;\n};\n\n\n/**\n * Append shape to given source, drawing a connection\n * between source and the newly created shape.\n *\n * @param {djs.model.Shape} source\n * @param {djs.model.Shape|Object} shape\n * @param {Point} position\n * @param {djs.model.Shape} target\n * @param {Object} [hints]\n * @param {Boolean} [hints.attach]\n * @param {djs.model.Connection|Object} [hints.connection]\n * @param {djs.model.Base} [hints.connectionParent]\n *\n * @return {djs.model.Shape} the newly created shape\n */\nModeling.prototype.appendShape = function(source, shape, position, target, hints) {\n\n  hints = hints || {};\n\n  shape = this._create('shape', shape);\n\n  var context = {\n    source: source,\n    position: position,\n    target: target,\n    shape: shape,\n    connection: hints.connection,\n    connectionParent: hints.connectionParent,\n    attach: hints.attach\n  };\n\n  this._commandStack.execute('shape.append', context);\n\n  return context.shape;\n};\n\n\nModeling.prototype.removeElements = function(elements) {\n  var context = {\n    elements: elements\n  };\n\n  this._commandStack.execute('elements.delete', context);\n};\n\n\nModeling.prototype.distributeElements = function(groups, axis, dimension) {\n  var context = {\n    groups: groups,\n    axis: axis,\n    dimension: dimension\n  };\n\n  this._commandStack.execute('elements.distribute', context);\n};\n\n\nModeling.prototype.removeShape = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.delete', context);\n};\n\n\nModeling.prototype.removeConnection = function(connection, hints) {\n  var context = {\n    connection: connection,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.delete', context);\n};\n\nModeling.prototype.replaceShape = function(oldShape, newShape, hints) {\n  var context = {\n    oldShape: oldShape,\n    newData: newShape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.replace', context);\n\n  return context.newShape;\n};\n\nModeling.prototype.alignElements = function(elements, alignment) {\n  var context = {\n    elements: elements,\n    alignment: alignment\n  };\n\n  this._commandStack.execute('elements.align', context);\n};\n\nModeling.prototype.resizeShape = function(shape, newBounds, minBounds, hints) {\n  var context = {\n    shape: shape,\n    newBounds: newBounds,\n    minBounds: minBounds,\n    hints: hints\n  };\n\n  this._commandStack.execute('shape.resize', context);\n};\n\nModeling.prototype.createSpace = function(movingShapes, resizingShapes, delta, direction, start) {\n  var context = {\n    delta: delta,\n    direction: direction,\n    movingShapes: movingShapes,\n    resizingShapes: resizingShapes,\n    start: start\n  };\n\n  this._commandStack.execute('spaceTool', context);\n};\n\nModeling.prototype.updateWaypoints = function(connection, newWaypoints, hints) {\n  var context = {\n    connection: connection,\n    newWaypoints: newWaypoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.updateWaypoints', context);\n};\n\nModeling.prototype.reconnect = function(connection, source, target, dockingOrPoints, hints) {\n  var context = {\n    connection: connection,\n    newSource: source,\n    newTarget: target,\n    dockingOrPoints: dockingOrPoints,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('connection.reconnect', context);\n};\n\nModeling.prototype.reconnectStart = function(connection, newSource, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, newSource, connection.target, dockingOrPoints, assign(hints, {\n    docking: 'source'\n  }));\n};\n\nModeling.prototype.reconnectEnd = function(connection, newTarget, dockingOrPoints, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  this.reconnect(connection, connection.source, newTarget, dockingOrPoints, assign(hints, {\n    docking: 'target'\n  }));\n};\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n  return this.createConnection(source, target, attrs || {}, source.parent, hints);\n};\n\nModeling.prototype._create = function(type, attrs) {\n  if (attrs instanceof Base) {\n    return attrs;\n  } else {\n    return this._elementFactory.create(type, attrs);\n  }\n};\n\nModeling.prototype.toggleCollapse = function(shape, hints) {\n  var context = {\n    shape: shape,\n    hints: hints || {}\n  };\n\n  this._commandStack.execute('shape.toggleCollapse', context);\n};\n","import {\n  reduce,\n  keys,\n  forEach,\n  assign\n} from 'min-dash';\n\nimport {\n  getBusinessObject\n} from '../../../util/ModelUtil';\n\nvar DEFAULT_FLOW = 'default',\n    ID = 'id',\n    DI = 'di';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n/**\n * A handler that implements a BPMN 2.0 property update.\n *\n * This should be used to set simple properties on elements with\n * an underlying BPMN business object.\n *\n * Use respective diagram-js provided handlers if you would\n * like to perform automated modeling.\n */\nexport default function UpdatePropertiesHandler(\n    elementRegistry, moddle, translate,\n    modeling, textRenderer) {\n\n  this._elementRegistry = elementRegistry;\n  this._moddle = moddle;\n  this._translate = translate;\n  this._modeling = modeling;\n  this._textRenderer = textRenderer;\n}\n\nUpdatePropertiesHandler.$inject = [\n  'elementRegistry',\n  'moddle',\n  'translate',\n  'modeling',\n  'textRenderer'\n];\n\n\n// api //////////////////////\n\n/**\n * Updates a BPMN element with a list of new properties\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element to update\n * @param {Object} context.properties a list of properties to set on the element's\n *                                    businessObject (the BPMN model element)\n *\n * @return {Array<djs.model.Base>} the updated element\n */\nUpdatePropertiesHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      changed = [ element ],\n      translate = this._translate;\n\n  if (!element) {\n    throw new Error(translate('element required'));\n  }\n\n  var elementRegistry = this._elementRegistry,\n      ids = this._moddle.ids;\n\n  var businessObject = element.businessObject,\n      properties = unwrapBusinessObjects(context.properties),\n      oldProperties = context.oldProperties || getProperties(businessObject, properties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(businessObject[ID]);\n\n    elementRegistry.updateId(element, properties[ID]);\n\n    ids.claim(properties[ID], businessObject);\n  }\n\n  // correctly indicate visual changes on default flow updates\n  if (DEFAULT_FLOW in properties) {\n\n    if (properties[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(properties[DEFAULT_FLOW].id));\n    }\n\n    if (businessObject[DEFAULT_FLOW]) {\n      changed.push(elementRegistry.get(businessObject[DEFAULT_FLOW].id));\n    }\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n\nUpdatePropertiesHandler.prototype.postExecute = function(context) {\n  var element = context.element,\n      label = element.label;\n\n  var text = label && getBusinessObject(label).name;\n\n  if (!text) {\n    return;\n  }\n\n  // get layouted text bounds and resize external\n  // external label accordingly\n  var newLabelBounds = this._textRenderer.getExternalLabelBounds(label, text);\n\n  this._modeling.resizeShape(label, newLabelBounds, NULL_DIMENSIONS);\n};\n\n/**\n * Reverts the update on a BPMN elements properties.\n *\n * @param  {Object} context\n *\n * @return {djs.model.Base} the updated element\n */\nUpdatePropertiesHandler.prototype.revert = function(context) {\n\n  var element = context.element,\n      properties = context.properties,\n      oldProperties = context.oldProperties,\n      businessObject = element.businessObject,\n      elementRegistry = this._elementRegistry,\n      ids = this._moddle.ids;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  if (isIdChange(properties, businessObject)) {\n    ids.unclaim(properties[ID]);\n\n    elementRegistry.updateId(element, oldProperties[ID]);\n\n    ids.claim(oldProperties[ID], businessObject);\n  }\n\n  return context.changed;\n};\n\n\nfunction isIdChange(properties, businessObject) {\n  return ID in properties && properties[ID] !== businessObject[ID];\n}\n\n\nfunction getProperties(businessObject, properties) {\n  var propertyNames = keys(properties);\n\n  return reduce(propertyNames, function(result, key) {\n\n    // handle DI separately\n    if (key !== DI) {\n      result[key] = businessObject.get(key);\n    } else {\n      result[key] = getDiProperties(businessObject.di, keys(properties.di));\n    }\n\n    return result;\n  }, {});\n}\n\n\nfunction getDiProperties(di, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = di.get(key);\n\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n\n    if (key !== DI) {\n      businessObject.set(key, value);\n    } else {\n\n      // only update, if businessObject.di exists\n      if (businessObject.di) {\n        setDiProperties(businessObject.di, value);\n      }\n    }\n  });\n}\n\n\nfunction setDiProperties(di, properties) {\n  forEach(properties, function(value, key) {\n    di.set(key, value);\n  });\n}\n\n\nvar referencePropertyNames = [ 'default' ];\n\n/**\n * Make sure we unwrap the actual business object\n * behind diagram element that may have been\n * passed as arguments.\n *\n * @param  {Object} properties\n *\n * @return {Object} unwrappedProps\n */\nfunction unwrapBusinessObjects(properties) {\n\n  var unwrappedProps = assign({}, properties);\n\n  referencePropertyNames.forEach(function(name) {\n    if (name in properties) {\n      unwrappedProps[name] = getBusinessObject(unwrappedProps[name]);\n    }\n  });\n\n  return unwrappedProps;\n}","import {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\n\nexport default function UpdateCanvasRootHandler(canvas, modeling) {\n  this._canvas = canvas;\n  this._modeling = modeling;\n}\n\nUpdateCanvasRootHandler.$inject = [\n  'canvas',\n  'modeling'\n];\n\n\nUpdateCanvasRootHandler.prototype.execute = function(context) {\n\n  var canvas = this._canvas;\n\n  var newRoot = context.newRoot,\n      newRootBusinessObject = newRoot.businessObject,\n      oldRoot = canvas.getRootElement(),\n      oldRootBusinessObject = oldRoot.businessObject,\n      bpmnDefinitions = oldRootBusinessObject.$parent,\n      diPlane = oldRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(newRoot, true);\n\n  // (2) update root elements\n  collectionAdd(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = bpmnDefinitions;\n\n  collectionRemove(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = null;\n\n  // (3) wire di\n  oldRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = newRootBusinessObject;\n  newRootBusinessObject.di = diPlane;\n\n  context.oldRoot = oldRoot;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};\n\n\nUpdateCanvasRootHandler.prototype.revert = function(context) {\n\n  var canvas = this._canvas;\n\n  var newRoot = context.newRoot,\n      newRootBusinessObject = newRoot.businessObject,\n      oldRoot = context.oldRoot,\n      oldRootBusinessObject = oldRoot.businessObject,\n      bpmnDefinitions = newRootBusinessObject.$parent,\n      diPlane = newRootBusinessObject.di;\n\n  // (1) replace process old <> new root\n  canvas.setRootElement(oldRoot, true);\n\n  // (2) update root elements\n  collectionRemove(bpmnDefinitions.rootElements, newRootBusinessObject);\n  newRootBusinessObject.$parent = null;\n\n  collectionAdd(bpmnDefinitions.rootElements, oldRootBusinessObject);\n  oldRootBusinessObject.$parent = bpmnDefinitions;\n\n  // (3) wire di\n  newRootBusinessObject.di = null;\n\n  diPlane.bpmnElement = oldRootBusinessObject;\n  oldRootBusinessObject.di = diPlane;\n\n  // TODO(nikku): return changed elements?\n  // return [ newRoot, oldRoot ];\n};","import {\n  filter\n} from 'min-dash';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\nimport {\n  getLanesRoot,\n  getChildLanes,\n  LANE_INDENTATION\n} from '../util/LaneUtil';\n\n\n/**\n * A handler that allows us to add a new lane\n * above or below an existing one.\n *\n * @param {Modeling} modeling\n */\nexport default function AddLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nAddLaneHandler.$inject = [\n  'modeling',\n  'spaceTool'\n];\n\n\nAddLaneHandler.prototype.preExecute = function(context) {\n\n  var spaceTool = this._spaceTool,\n      modeling = this._modeling;\n\n  var shape = context.shape,\n      location = context.location;\n\n  var lanesRoot = getLanesRoot(shape);\n\n  var isRoot = lanesRoot === shape,\n      laneParent = isRoot ? shape : shape.parent;\n\n  var existingChildLanes = getChildLanes(laneParent);\n\n  // (0) add a lane if we currently got none and are adding to root\n  if (!existingChildLanes.length) {\n    modeling.createShape({ type: 'bpmn:Lane' }, {\n      x: shape.x + LANE_INDENTATION,\n      y: shape.y,\n      width: shape.width - LANE_INDENTATION,\n      height: shape.height\n    }, laneParent);\n  }\n\n  // (1) collect affected elements to create necessary space\n  var allAffected = [];\n\n  eachElement(lanesRoot, function(element) {\n    allAffected.push(element);\n\n    if (element === shape) {\n      return [];\n    }\n\n    return filter(element.children, function(c) {\n      return c !== shape;\n    });\n  });\n\n  var offset = location === 'top' ? -120 : 120,\n      lanePosition = location === 'top' ? shape.y : shape.y + shape.height,\n      spacePos = lanePosition + (location === 'top' ? 10 : -10),\n      direction = location === 'top' ? 'n' : 's';\n\n  var adjustments = spaceTool.calculateAdjustments(allAffected, 'y', offset, spacePos);\n\n  spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: 0, y: offset }, direction);\n\n  // (2) create new lane at open space\n  context.newLane = modeling.createShape({ type: 'bpmn:Lane' }, {\n    x: shape.x + (isRoot ? LANE_INDENTATION : 0),\n    y: lanePosition - (location === 'top' ? 120 : 0),\n    width: shape.width - (isRoot ? LANE_INDENTATION : 0),\n    height: 120\n  }, laneParent);\n};\n","import {\n  getChildLanes,\n  LANE_INDENTATION\n} from '../util/LaneUtil';\n\n\n/**\n * A handler that splits a lane into a number of sub-lanes,\n * creating new sub lanes, if necessary.\n *\n * @param {Modeling} modeling\n */\nexport default function SplitLaneHandler(modeling, translate) {\n  this._modeling = modeling;\n  this._translate = translate;\n}\n\nSplitLaneHandler.$inject = [\n  'modeling',\n  'translate'\n];\n\n\nSplitLaneHandler.prototype.preExecute = function(context) {\n\n  var modeling = this._modeling,\n      translate = this._translate;\n\n  var shape = context.shape,\n      newLanesCount = context.count;\n\n  var childLanes = getChildLanes(shape),\n      existingLanesCount = childLanes.length;\n\n  if (existingLanesCount > newLanesCount) {\n    throw new Error(translate('more than {count} child lanes', { count: newLanesCount }));\n  }\n\n  var newLanesHeight = Math.round(shape.height / newLanesCount);\n\n  // Iterate from top to bottom in child lane order,\n  // resizing existing lanes and creating new ones\n  // so that they split the parent proportionally.\n  //\n  // Due to rounding related errors, the bottom lane\n  // needs to take up all the remaining space.\n  var laneY,\n      laneHeight,\n      laneBounds,\n      newLaneAttrs,\n      idx;\n\n  for (idx = 0; idx < newLanesCount; idx++) {\n\n    laneY = shape.y + idx * newLanesHeight;\n\n    // if bottom lane\n    if (idx === newLanesCount - 1) {\n      laneHeight = shape.height - (newLanesHeight * idx);\n    } else {\n      laneHeight = newLanesHeight;\n    }\n\n    laneBounds = {\n      x: shape.x + LANE_INDENTATION,\n      y: laneY,\n      width: shape.width - LANE_INDENTATION,\n      height: laneHeight\n    };\n\n    if (idx < existingLanesCount) {\n\n      // resize existing lane\n      modeling.resizeShape(childLanes[idx], laneBounds);\n    } else {\n\n      // create a new lane at position\n      newLaneAttrs = {\n        type: 'bpmn:Lane'\n      };\n\n      modeling.createShape(newLaneAttrs, laneBounds, shape);\n    }\n  }\n};\n","import { is } from '../../../util/ModelUtil';\n\nimport {\n  getLanesRoot,\n  computeLanesResize\n} from '../util/LaneUtil';\n\nimport {\n  eachElement\n} from 'diagram-js/lib/util/Elements';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  substractTRBL\n} from 'diagram-js/lib/features/resize/ResizeUtil';\n\n\n/**\n * A handler that resizes a lane.\n *\n * @param {Modeling} modeling\n */\nexport default function ResizeLaneHandler(modeling, spaceTool) {\n  this._modeling = modeling;\n  this._spaceTool = spaceTool;\n}\n\nResizeLaneHandler.$inject = [\n  'modeling',\n  'spaceTool'\n];\n\n\nResizeLaneHandler.prototype.preExecute = function(context) {\n\n  var shape = context.shape,\n      newBounds = context.newBounds,\n      balanced = context.balanced;\n\n  if (balanced !== false) {\n    this.resizeBalanced(shape, newBounds);\n  } else {\n    this.resizeSpace(shape, newBounds);\n  }\n};\n\n\n/**\n * Resize balanced, adjusting next / previous lane sizes.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeBalanced = function(shape, newBounds) {\n\n  var modeling = this._modeling;\n\n  var resizeNeeded = computeLanesResize(shape, newBounds);\n\n  // resize the lane\n  modeling.resizeShape(shape, newBounds);\n\n  // resize other lanes as needed\n  resizeNeeded.forEach(function(r) {\n    modeling.resizeShape(r.shape, r.newBounds);\n  });\n};\n\n\n/**\n * Resize, making actual space and moving below / above elements.\n *\n * @param {djs.model.Shape} shape\n * @param {Bounds} newBounds\n */\nResizeLaneHandler.prototype.resizeSpace = function(shape, newBounds) {\n  var spaceTool = this._spaceTool;\n\n  var shapeTrbl = asTRBL(shape),\n      newTrbl = asTRBL(newBounds);\n\n  var trblDiff = substractTRBL(newTrbl, shapeTrbl);\n\n  var lanesRoot = getLanesRoot(shape);\n\n  var allAffected = [],\n      allLanes = [];\n\n  eachElement(lanesRoot, function(element) {\n    allAffected.push(element);\n\n    if (is(element, 'bpmn:Lane') || is(element, 'bpmn:Participant')) {\n      allLanes.push(element);\n    }\n\n    return element.children;\n  });\n\n  var change,\n      spacePos,\n      direction,\n      offset,\n      adjustments;\n\n  if (trblDiff.bottom || trblDiff.top) {\n\n    change = trblDiff.bottom || trblDiff.top;\n    spacePos = shape.y + (trblDiff.bottom ? shape.height : 0) + (trblDiff.bottom ? -10 : 10);\n    direction = trblDiff.bottom ? 's' : 'n';\n\n    offset = trblDiff.top > 0 || trblDiff.bottom < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(allAffected, 'y', offset, spacePos);\n\n    spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: 0, y: change }, direction);\n  }\n\n\n  if (trblDiff.left || trblDiff.right) {\n\n    change = trblDiff.right || trblDiff.left;\n    spacePos = shape.x + (trblDiff.right ? shape.width : 0) + (trblDiff.right ? -10 : 100);\n    direction = trblDiff.right ? 'e' : 'w';\n\n    offset = trblDiff.left > 0 || trblDiff.right < 0 ? -change : change;\n\n    adjustments = spaceTool.calculateAdjustments(allLanes, 'x', offset, spacePos);\n\n    spaceTool.makeSpace(adjustments.movingShapes, adjustments.resizingShapes, { x: change, y: 0 }, direction);\n  }\n};","import {\n  collectLanes,\n  getLanesRoot\n} from '../util/LaneUtil';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nimport {\n  add as collectionAdd,\n  remove as collectionRemove\n} from 'diagram-js/lib/util/Collections';\n\nimport {\n  asTRBL\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nvar FLOW_NODE_REFS_ATTR = 'flowNodeRef',\n    LANES_ATTR = 'lanes';\n\n\n/**\n * A handler that updates lane refs on changed elements\n */\nexport default function UpdateFlowNodeRefsHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateFlowNodeRefsHandler.$inject = [\n  'elementRegistry'\n];\n\n\nUpdateFlowNodeRefsHandler.prototype.computeUpdates = function(flowNodeShapes, laneShapes) {\n\n  var handledNodes = [];\n\n  var updates = [];\n\n  var participantCache = {};\n\n  var allFlowNodeShapes = [];\n\n  function isInLaneShape(element, laneShape) {\n\n    var laneTrbl = asTRBL(laneShape);\n\n    var elementMid = {\n      x: element.x + element.width / 2,\n      y: element.y + element.height / 2\n    };\n\n    return elementMid.x > laneTrbl.left &&\n           elementMid.x < laneTrbl.right &&\n           elementMid.y > laneTrbl.top &&\n           elementMid.y < laneTrbl.bottom;\n  }\n\n  function addFlowNodeShape(flowNodeShape) {\n    if (handledNodes.indexOf(flowNodeShape) === -1) {\n      allFlowNodeShapes.push(flowNodeShape);\n      handledNodes.push(flowNodeShape);\n    }\n  }\n\n  function getAllLaneShapes(flowNodeShape) {\n\n    var root = getLanesRoot(flowNodeShape);\n\n    if (!participantCache[root.id]) {\n      participantCache[root.id] = collectLanes(root);\n    }\n\n    return participantCache[root.id];\n  }\n\n  function getNewLanes(flowNodeShape) {\n    if (!flowNodeShape.parent) {\n      return [];\n    }\n\n    var allLaneShapes = getAllLaneShapes(flowNodeShape);\n\n    return allLaneShapes.filter(function(l) {\n      return isInLaneShape(flowNodeShape, l);\n    }).map(function(shape) {\n      return shape.businessObject;\n    });\n  }\n\n  laneShapes.forEach(function(laneShape) {\n    var root = getLanesRoot(laneShape);\n\n    if (!root || handledNodes.indexOf(root) !== -1) {\n      return;\n    }\n\n    var children = root.children.filter(function(c) {\n      return is(c, 'bpmn:FlowNode');\n    });\n\n    children.forEach(addFlowNodeShape);\n\n    handledNodes.push(root);\n  });\n\n  flowNodeShapes.forEach(addFlowNodeShape);\n\n\n  allFlowNodeShapes.forEach(function(flowNodeShape) {\n\n    var flowNode = flowNodeShape.businessObject;\n\n    var lanes = flowNode.get(LANES_ATTR),\n        remove = lanes.slice(),\n        add = getNewLanes(flowNodeShape);\n\n    updates.push({ flowNode: flowNode, remove: remove, add: add });\n  });\n\n  laneShapes.forEach(function(laneShape) {\n\n    var lane = laneShape.businessObject;\n\n    // lane got removed XX-)\n    if (!laneShape.parent) {\n      lane.get(FLOW_NODE_REFS_ATTR).forEach(function(flowNode) {\n        updates.push({ flowNode: flowNode, remove: [ lane ], add: [] });\n      });\n    }\n  });\n\n  return updates;\n};\n\nUpdateFlowNodeRefsHandler.prototype.execute = function(context) {\n\n  var updates = context.updates;\n\n  if (!updates) {\n    updates = context.updates = this.computeUpdates(context.flowNodeShapes, context.laneShapes);\n  }\n\n\n  updates.forEach(function(update) {\n\n    var flowNode = update.flowNode,\n        lanes = flowNode.get(LANES_ATTR);\n\n    // unwire old\n    update.remove.forEach(function(oldLane) {\n      collectionRemove(lanes, oldLane);\n      collectionRemove(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire new\n    update.add.forEach(function(newLane) {\n      collectionAdd(lanes, newLane);\n      collectionAdd(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n\n\nUpdateFlowNodeRefsHandler.prototype.revert = function(context) {\n\n  var updates = context.updates;\n\n  updates.forEach(function(update) {\n\n    var flowNode = update.flowNode,\n        lanes = flowNode.get(LANES_ATTR);\n\n    // unwire new\n    update.add.forEach(function(newLane) {\n      collectionRemove(lanes, newLane);\n      collectionRemove(newLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n\n    // wire old\n    update.remove.forEach(function(oldLane) {\n      collectionAdd(lanes, oldLane);\n      collectionAdd(oldLane.get(FLOW_NODE_REFS_ATTR), flowNode);\n    });\n  });\n\n  // TODO(nikku): return changed elements\n  // return [ ... ];\n};\n","export default function IdClaimHandler(moddle) {\n  this._moddle = moddle;\n}\n\nIdClaimHandler.$inject = [ 'moddle' ];\n\n\nIdClaimHandler.prototype.execute = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.claim(id, element);\n  } else {\n    ids.unclaim(id);\n  }\n};\n\n/**\n * Command revert implementation.\n */\nIdClaimHandler.prototype.revert = function(context) {\n  var ids = this._moddle.ids,\n      id = context.id,\n      element = context.element,\n      claiming = context.claiming;\n\n  if (claiming) {\n    ids.unclaim(id);\n  } else {\n    ids.claim(id, element);\n  }\n};\n\n","import {\r\n  assign,\r\n  forEach\r\n} from 'min-dash';\r\n\r\n\r\nvar DEFAULT_COLORS = {\r\n  fill: undefined,\r\n  stroke: undefined\r\n};\r\n\r\n\r\nexport default function SetColorHandler(commandStack) {\r\n  this._commandStack = commandStack;\r\n}\r\n\r\nSetColorHandler.$inject = [\r\n  'commandStack'\r\n];\r\n\r\n\r\nSetColorHandler.prototype.postExecute = function(context) {\r\n  var elements = context.elements,\r\n      colors = context.colors || DEFAULT_COLORS;\r\n\r\n  var self = this;\r\n\r\n  var di = {};\r\n\r\n  if ('fill' in colors) {\r\n    assign(di, { fill: colors.fill });\r\n  }\r\n\r\n  if ('stroke' in colors) {\r\n    assign(di, { stroke: colors.stroke });\r\n  }\r\n\r\n  forEach(elements, function(element) {\r\n\r\n    self._commandStack.execute('element.updateProperties', {\r\n      element: element,\r\n      properties: {\r\n        di: di\r\n      }\r\n    });\r\n  });\r\n\r\n};","import {\n  setLabel,\n  getLabel\n} from '../LabelUtil';\n\nimport {\n  getExternalLabelMid,\n  isLabelExternal,\n  hasExternalLabel,\n  isLabel\n} from '../../../util/LabelUtil';\n\nimport {\n  is\n} from '../../../util/ModelUtil';\n\nvar NULL_DIMENSIONS = {\n  width: 0,\n  height: 0\n};\n\n\n/**\n * A handler that updates the text of a BPMN element.\n */\nexport default function UpdateLabelHandler(modeling, textRenderer) {\n\n  /**\n   * Set the label and return the changed elements.\n   *\n   * Element parameter can be label itself or connection (i.e. sequence flow).\n   *\n   * @param {djs.model.Base} element\n   * @param {String} text\n   */\n  function setText(element, text) {\n\n    // external label if present\n    var label = element.label || element;\n\n    var labelTarget = element.labelTarget || element;\n\n    setLabel(label, text, labelTarget !== label);\n\n    return [ label, labelTarget ];\n  }\n\n  function preExecute(ctx) {\n    var element = ctx.element,\n        businessObject = element.businessObject,\n        newLabel = ctx.newLabel;\n\n    if (!isLabel(element)\n        && isLabelExternal(element)\n        && !hasExternalLabel(element)\n        && !isEmptyText(newLabel)) {\n\n      // create label\n      var paddingTop = 7;\n\n      var labelCenter = getExternalLabelMid(element);\n\n      labelCenter = {\n        x: labelCenter.x,\n        y: labelCenter.y + paddingTop\n      };\n\n      modeling.createLabel(element, labelCenter, {\n        id: businessObject.id + '_label',\n        businessObject: businessObject\n      });\n    }\n  }\n\n  function execute(ctx) {\n    ctx.oldLabel = getLabel(ctx.element);\n    return setText(ctx.element, ctx.newLabel);\n  }\n\n  function revert(ctx) {\n    return setText(ctx.element, ctx.oldLabel);\n  }\n\n  function postExecute(ctx) {\n    var element = ctx.element,\n        label = element.label || element,\n        newLabel = ctx.newLabel,\n        newBounds = ctx.newBounds,\n        hints = ctx.hints || {};\n\n    if (isLabel(label) && isEmptyText(newLabel)) {\n\n      if (hints.removeShape !== false) {\n        modeling.removeShape(label, { unsetLabel: false });\n      }\n\n      return;\n    }\n\n    // ignore internal labels for elements except text annotations\n    if (!isLabelExternal(element) && !is(element, 'bpmn:TextAnnotation')) {\n      return;\n    }\n\n    var text = getLabel(label);\n\n    // don't resize without text\n    if (!text) {\n      return;\n    }\n\n    // resize element based on label _or_ pre-defined bounds\n    if (typeof newBounds === 'undefined') {\n      newBounds = textRenderer.getExternalLabelBounds(label, text);\n    }\n\n    // setting newBounds to false or _null_ will\n    // disable the postExecute resize operation\n    if (newBounds) {\n      modeling.resizeShape(label, newBounds, NULL_DIMENSIONS);\n    }\n  }\n\n  // API\n\n  this.preExecute = preExecute;\n  this.execute = execute;\n  this.revert = revert;\n  this.postExecute = postExecute;\n}\n\nUpdateLabelHandler.$inject = [\n  'modeling',\n  'textRenderer'\n];\n\n\n// helpers ///////////////////////\n\nfunction isEmptyText(label) {\n  return !label || !label.trim();\n}","import inherits from 'inherits';\n\nimport BaseModeling from 'diagram-js/lib/features/modeling/Modeling';\n\nimport UpdatePropertiesHandler from './cmd/UpdatePropertiesHandler';\nimport UpdateCanvasRootHandler from './cmd/UpdateCanvasRootHandler';\nimport AddLaneHandler from './cmd/AddLaneHandler';\nimport SplitLaneHandler from './cmd/SplitLaneHandler';\nimport ResizeLaneHandler from './cmd/ResizeLaneHandler';\nimport UpdateFlowNodeRefsHandler from './cmd/UpdateFlowNodeRefsHandler';\nimport IdClaimHandler from './cmd/IdClaimHandler';\nimport SetColorHandler from './cmd/SetColorHandler';\n\nimport UpdateLabelHandler from '../label-editing/cmd/UpdateLabelHandler';\n\n\n/**\n * BPMN 2.0 modeling features activator\n *\n * @param {EventBus} eventBus\n * @param {ElementFactory} elementFactory\n * @param {CommandStack} commandStack\n * @param {BpmnRules} bpmnRules\n */\nexport default function Modeling(\n    eventBus, elementFactory, commandStack,\n    bpmnRules) {\n\n  BaseModeling.call(this, eventBus, elementFactory, commandStack);\n\n  this._bpmnRules = bpmnRules;\n}\n\ninherits(Modeling, BaseModeling);\n\nModeling.$inject = [\n  'eventBus',\n  'elementFactory',\n  'commandStack',\n  'bpmnRules'\n];\n\n\nModeling.prototype.getHandlers = function() {\n  var handlers = BaseModeling.prototype.getHandlers.call(this);\n\n  handlers['element.updateProperties'] = UpdatePropertiesHandler;\n  handlers['canvas.updateRoot'] = UpdateCanvasRootHandler;\n  handlers['lane.add'] = AddLaneHandler;\n  handlers['lane.resize'] = ResizeLaneHandler;\n  handlers['lane.split'] = SplitLaneHandler;\n  handlers['lane.updateRefs'] = UpdateFlowNodeRefsHandler;\n  handlers['id.updateClaim'] = IdClaimHandler;\n  handlers['element.setColor'] = SetColorHandler;\n  handlers['element.updateLabel'] = UpdateLabelHandler;\n\n  return handlers;\n};\n\n\nModeling.prototype.updateLabel = function(element, newLabel, newBounds, hints) {\n  this._commandStack.execute('element.updateLabel', {\n    element: element,\n    newLabel: newLabel,\n    newBounds: newBounds,\n    hints: hints || {}\n  });\n};\n\n\nModeling.prototype.connect = function(source, target, attrs, hints) {\n\n  var bpmnRules = this._bpmnRules;\n\n  if (!attrs) {\n    attrs = bpmnRules.canConnect(source, target);\n  }\n\n  if (!attrs) {\n    return;\n  }\n\n  return this.createConnection(source, target, attrs, source.parent, hints);\n};\n\n\nModeling.prototype.updateProperties = function(element, properties) {\n  this._commandStack.execute('element.updateProperties', {\n    element: element,\n    properties: properties\n  });\n};\n\nModeling.prototype.resizeLane = function(laneShape, newBounds, balanced) {\n  this._commandStack.execute('lane.resize', {\n    shape: laneShape,\n    newBounds: newBounds,\n    balanced: balanced\n  });\n};\n\nModeling.prototype.addLane = function(targetLaneShape, location) {\n  var context = {\n    shape: targetLaneShape,\n    location: location\n  };\n\n  this._commandStack.execute('lane.add', context);\n\n  return context.newLane;\n};\n\nModeling.prototype.splitLane = function(targetLane, count) {\n  this._commandStack.execute('lane.split', {\n    shape: targetLane,\n    count: count\n  });\n};\n\n/**\n * Transform the current diagram into a collaboration.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeCollaboration = function() {\n\n  var collaborationElement = this._create('root', {\n    type: 'bpmn:Collaboration'\n  });\n\n  var context = {\n    newRoot: collaborationElement\n  };\n\n  this._commandStack.execute('canvas.updateRoot', context);\n\n  return collaborationElement;\n};\n\nModeling.prototype.updateLaneRefs = function(flowNodeShapes, laneShapes) {\n\n  this._commandStack.execute('lane.updateRefs', {\n    flowNodeShapes: flowNodeShapes,\n    laneShapes: laneShapes\n  });\n};\n\n/**\n * Transform the current diagram into a process.\n *\n * @return {djs.model.Root} the new root element\n */\nModeling.prototype.makeProcess = function() {\n\n  var processElement = this._create('root', {\n    type: 'bpmn:Process'\n  });\n\n  var context = {\n    newRoot: processElement\n  };\n\n  this._commandStack.execute('canvas.updateRoot', context);\n};\n\n\nModeling.prototype.claimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement,\n    claiming: true\n  });\n};\n\n\nModeling.prototype.unclaimId = function(id, moddleElement) {\n  this._commandStack.execute('id.updateClaim', {\n    id: id,\n    element: moddleElement\n  });\n};\n\nModeling.prototype.setColor = function(elements, colors) {\n  if (!elements.length) {\n    elements = [ elements ];\n  }\n\n  this._commandStack.execute('element.setColor', {\n    elements: elements,\n    colors: colors\n  });\n};\n","import {\n  getMid\n} from './LayoutUtil';\n\n\n/**\n * A base connection layouter implementation\n * that layouts the connection by directly connecting\n * mid(source) + mid(target).\n */\nexport default function BaseLayouter() {}\n\n\n/**\n * Return the new layouted waypoints for the given connection.\n *\n * The connection passed is still unchanged; you may figure out about\n * the new connection start / end via the layout hints provided.\n *\n * @param {djs.model.Connection} connection\n * @param {Object} [hints]\n * @param {Point} [hints.connectionStart]\n * @param {Point} [hints.connectionEnd]\n * @param {Point} [hints.source]\n * @param {Point} [hints.target]\n *\n * @return {Array<Point>} the layouted connection waypoints\n */\nBaseLayouter.prototype.layoutConnection = function(connection, hints) {\n\n  hints = hints || {};\n\n  return [\n    hints.connectionStart || getMid(hints.source || connection.source),\n    hints.connectionEnd || getMid(hints.target || connection.target)\n  ];\n};\n","import {\n  assign,\n  find,\n  isArray,\n  without\n} from 'min-dash';\n\nimport {\n  getOrientation,\n  getMid\n} from './LayoutUtil';\n\nimport {\n  pointInRect,\n  pointDistance,\n  pointsAligned,\n  pointsOnLine\n} from '../util/Geometry';\n\nvar MIN_SEGMENT_LENGTH = 20,\n    POINT_ORIENTATION_PADDING = 5;\n\nvar round = Math.round;\n\nvar INTERSECTION_THRESHOLD = 20,\n    ORIENTATION_THRESHOLD = {\n      'h:h': 20,\n      'v:v': 20,\n      'h:v': -10,\n      'v:h': -10\n    };\n\nfunction needsTurn(orientation, startDirection) {\n  return !{\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /./,\n    v: /./\n  }[startDirection].test(orientation);\n}\n\nfunction canLayoutStraight(direction, targetOrientation) {\n  return {\n    t: /top/,\n    r: /right/,\n    b: /bottom/,\n    l: /left/,\n    h: /left|right/,\n    v: /top|bottom/\n  }[direction].test(targetOrientation);\n}\n\nfunction getSegmentBendpoints(a, b, directions) {\n  var orientation = getOrientation(b, a, POINT_ORIENTATION_PADDING);\n\n  var startDirection = directions.split(':')[0];\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  var segmentEnd, segmentDirections;\n\n  var layoutStraight = canLayoutStraight(startDirection, orientation),\n      layoutHorizontal = /h|r|l/.test(startDirection),\n      layoutTurn = false;\n\n  var turnNextDirections = false;\n\n  if (layoutStraight) {\n    segmentEnd = layoutHorizontal ? { x: xmid, y: a.y } : { x: a.x, y: ymid };\n\n    segmentDirections = layoutHorizontal ? 'h:h' : 'v:v';\n  } else {\n    layoutTurn = needsTurn(orientation, startDirection);\n\n    segmentDirections = layoutHorizontal ? 'h:v' : 'v:h';\n\n    if (layoutTurn) {\n\n      if (layoutHorizontal) {\n        turnNextDirections = ymid === a.y;\n\n        segmentEnd = {\n          x: a.x + MIN_SEGMENT_LENGTH * (/l/.test(startDirection) ? -1 : 1),\n          y: turnNextDirections ? ymid + MIN_SEGMENT_LENGTH : ymid\n        };\n      } else {\n        turnNextDirections = xmid === a.x;\n\n        segmentEnd = {\n          x: turnNextDirections ? xmid + MIN_SEGMENT_LENGTH : xmid,\n          y: a.y + MIN_SEGMENT_LENGTH * (/t/.test(startDirection) ? -1 : 1)\n        };\n      }\n\n    } else {\n      segmentEnd = {\n        x: xmid,\n        y: ymid\n      };\n    }\n  }\n\n  return {\n    waypoints: getBendpoints(a, segmentEnd, segmentDirections).concat(segmentEnd),\n    directions:  segmentDirections,\n    turnNextDirections: turnNextDirections\n  };\n}\n\nfunction getStartSegment(a, b, directions) {\n  return getSegmentBendpoints(a, b, directions);\n}\n\nfunction getEndSegment(a, b, directions) {\n  var invertedSegment = getSegmentBendpoints(b, a, invertDirections(directions));\n\n  return {\n    waypoints: invertedSegment.waypoints.slice().reverse(),\n    directions: invertDirections(invertedSegment.directions),\n    turnNextDirections: invertedSegment.turnNextDirections\n  };\n}\n\nfunction getMidSegment(startSegment, endSegment) {\n\n  var startDirection = startSegment.directions.split(':')[1],\n      endDirection = endSegment.directions.split(':')[0];\n\n  if (startSegment.turnNextDirections) {\n    startDirection = startDirection == 'h' ? 'v' : 'h';\n  }\n\n  if (endSegment.turnNextDirections) {\n    endDirection = endDirection == 'h' ? 'v' : 'h';\n  }\n\n  var directions = startDirection + ':' + endDirection;\n\n  var bendpoints = getBendpoints(\n    startSegment.waypoints[startSegment.waypoints.length - 1],\n    endSegment.waypoints[0],\n    directions\n  );\n\n  return {\n    waypoints: bendpoints,\n    directions: directions\n  };\n}\n\nfunction invertDirections(directions) {\n  return directions.split(':').reverse().join(':');\n}\n\n/**\n * Handle simple layouts with maximum two bendpoints.\n */\nfunction getSimpleBendpoints(a, b, directions) {\n\n  var xmid = round((b.x - a.x) / 2 + a.x),\n      ymid = round((b.y - a.y) / 2 + a.y);\n\n  // one point, right or left from a\n  if (directions === 'h:v') {\n    return [ { x: b.x, y: a.y } ];\n  }\n\n  // one point, above or below a\n  if (directions === 'v:h') {\n    return [ { x: a.x, y: b.y } ];\n  }\n\n  // vertical segment between a and b\n  if (directions === 'h:h') {\n    return [\n      { x: xmid, y: a.y },\n      { x: xmid, y: b.y }\n    ];\n  }\n\n  // horizontal segment between a and b\n  if (directions === 'v:v') {\n    return [\n      { x: a.x, y: ymid },\n      { x: b.x, y: ymid }\n    ];\n  }\n\n  throw new Error('invalid directions: can only handle varians of [hv]:[hv]');\n}\n\n\n/**\n * Returns the mid points for a manhattan connection between two points.\n *\n * @example h:h (horizontal:horizontal)\n *\n * [a]----[x]\n *         |\n *        [x]----[b]\n *\n * @example h:v (horizontal:vertical)\n *\n * [a]----[x]\n *         |\n *        [b]\n *\n * @example h:r (horizontal:right)\n *\n * [a]----[x]\n *         |\n *    [b]-[x]\n *\n * @param  {Point} a\n * @param  {Point} b\n * @param  {String} directions\n *\n * @return {Array<Point>}\n */\nfunction getBendpoints(a, b, directions) {\n  directions = directions || 'h:h';\n\n  if (!isValidDirections(directions)) {\n    throw new Error(\n      'unknown directions: <' + directions + '>: ' +\n      'must be specified as <start>:<end> ' +\n      'with start/end in { h,v,t,r,b,l }'\n    );\n  }\n\n  // compute explicit directions, involving trbl dockings\n  // using a three segmented layouting algorithm\n  if (isExplicitDirections(directions)) {\n    var startSegment = getStartSegment(a, b, directions),\n        endSegment = getEndSegment(a, b, directions),\n        midSegment = getMidSegment(startSegment, endSegment);\n\n    return [].concat(\n      startSegment.waypoints,\n      midSegment.waypoints,\n      endSegment.waypoints\n    );\n  }\n\n  // handle simple [hv]:[hv] cases that can be easily computed\n  return getSimpleBendpoints(a, b, directions);\n}\n\n/**\n * Create a connection between the two points according\n * to the manhattan layout (only horizontal and vertical) edges.\n *\n * @param {Point} a\n * @param {Point} b\n *\n * @param {String} [directions='h:h'] specifies manhattan directions for each point as {adirection}:{bdirection}.\n                   A directionfor a point is either `h` (horizontal) or `v` (vertical)\n *\n * @return {Array<Point>}\n */\nexport function connectPoints(a, b, directions) {\n\n  var points = getBendpoints(a, b, directions);\n\n  points.unshift(a);\n  points.push(b);\n\n  return withoutRedundantPoints(points);\n}\n\n\n/**\n * Connect two rectangles using a manhattan layouted connection.\n *\n * @param {Bounds} source source rectangle\n * @param {Bounds} target target rectangle\n * @param {Point} [start] source docking\n * @param {Point} [end] target docking\n *\n * @param {Object} [hints]\n * @param {String} [hints.preserveDocking=source] preserve docking on selected side\n * @param {Array<String>} [hints.preferredLayouts]\n * @param {Point|Boolean} [hints.connectionStart] whether the start changed\n * @param {Point|Boolean} [hints.connectionEnd] whether the end changed\n *\n * @return {Array<Point>} connection points\n */\nexport function connectRectangles(source, target, start, end, hints) {\n\n  var preferredLayouts = hints && hints.preferredLayouts || [];\n\n  var preferredLayout = without(preferredLayouts, 'straight')[0] || 'h:h';\n\n  var threshold = ORIENTATION_THRESHOLD[preferredLayout] || 0;\n\n  var orientation = getOrientation(source, target, threshold);\n\n  var directions = getDirections(orientation, preferredLayout);\n\n  start = start || getMid(source);\n  end = end || getMid(target);\n\n  var directionSplit = directions.split(':');\n\n  // compute actual docking points for start / end\n  // this ensures we properly layout only parts of the\n  // connection that lies in between the two rectangles\n  var startDocking = getDockingPoint(start, source, directionSplit[0], invertOrientation(orientation)),\n      endDocking = getDockingPoint(end, target, directionSplit[1], orientation);\n\n  return connectPoints(startDocking, endDocking, directions);\n}\n\n\n/**\n * Repair the connection between two rectangles, of which one has been updated.\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} [start]\n * @param {Point} [end]\n * @param {Array<Point>} [waypoints]\n * @param {Object} [hints]\n * @param {Array<String>} [hints.preferredLayouts] list of preferred layouts\n * @param {Boolean} [hints.connectionStart]\n * @param {Boolean} [hints.connectionEnd]\n *\n * @return {Array<Point>} repaired waypoints\n */\nexport function repairConnection(source, target, start, end, waypoints, hints) {\n\n  if (isArray(start)) {\n    waypoints = start;\n    hints = end;\n\n    start = getMid(source);\n    end = getMid(target);\n  }\n\n  hints = assign({ preferredLayouts: [] }, hints);\n  waypoints = waypoints || [];\n\n  var preferredLayouts = hints.preferredLayouts,\n      preferStraight = preferredLayouts.indexOf('straight') !== -1,\n      repairedWaypoints;\n\n  // just layout non-existing or simple connections\n  // attempt to render straight lines, if required\n\n  // attempt to layout a straight line\n  repairedWaypoints = preferStraight && tryLayoutStraight(source, target, start, end, hints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from end\n  repairedWaypoints = hints.connectionEnd && tryRepairConnectionEnd(target, source, end, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // try to layout from start\n  repairedWaypoints = hints.connectionStart && tryRepairConnectionStart(source, target, start, waypoints);\n\n  if (repairedWaypoints) {\n    return repairedWaypoints;\n  }\n\n  // or whether nothing seems to have changed\n  if (!hints.connectionStart && !hints.connectionEnd && waypoints && waypoints.length) {\n    return waypoints;\n  }\n\n  // simply reconnect if nothing else worked\n  return connectRectangles(source, target, start, end, hints);\n}\n\n\nfunction inRange(a, start, end) {\n  return a >= start && a <= end;\n}\n\nfunction isInRange(axis, a, b) {\n  var size = {\n    x: 'width',\n    y: 'height'\n  };\n\n  return inRange(a[axis], b[axis], b[axis] + b[size[axis]]);\n}\n\n/**\n * Layout a straight connection\n *\n * @param {Bounds} source\n * @param {Bounds} target\n * @param {Point} start\n * @param {Point} end\n * @param {Object} [hints]\n *\n * @return {Array<Point>|null} waypoints if straight layout worked\n */\nexport function tryLayoutStraight(source, target, start, end, hints) {\n  var axis = {},\n      primaryAxis,\n      orientation;\n\n  orientation = getOrientation(source, target);\n\n  // only layout a straight connection if shapes are\n  // horizontally or vertically aligned\n  if (!/^(top|bottom|left|right)$/.test(orientation)) {\n    return null;\n  }\n\n  if (/top|bottom/.test(orientation)) {\n    primaryAxis = 'x';\n  }\n\n  if (/left|right/.test(orientation)) {\n    primaryAxis = 'y';\n  }\n\n  if (hints.preserveDocking === 'target') {\n\n    if (!isInRange(primaryAxis, end, source)) {\n      return null;\n    }\n\n    axis[primaryAxis] = end[primaryAxis];\n\n    return [\n      {\n        x: axis.x !== undefined ? axis.x : start.x,\n        y: axis.y !== undefined ? axis.y : start.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : start.x,\n          y: axis.y !== undefined ? axis.y : start.y\n        }\n      },\n      {\n        x: end.x,\n        y: end.y\n      }\n    ];\n\n  } else {\n\n    if (!isInRange(primaryAxis, start, target)) {\n      return null;\n    }\n\n    axis[primaryAxis] = start[primaryAxis];\n\n    return [\n      {\n        x: start.x,\n        y: start.y\n      },\n      {\n        x: axis.x !== undefined ? axis.x : end.x,\n        y: axis.y !== undefined ? axis.y : end.y,\n        original: {\n          x: axis.x !== undefined ? axis.x : end.x,\n          y: axis.y !== undefined ? axis.y : end.y\n        }\n      }\n    ];\n  }\n\n}\n\n/**\n * Repair a connection from start.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionStart(moved, other, newDocking, points) {\n  return _tryRepairConnectionSide(moved, other, newDocking, points);\n}\n\n/**\n * Repair a connection from end.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>|null} the repaired points between the two rectangles\n */\nfunction tryRepairConnectionEnd(moved, other, newDocking, points) {\n  var waypoints = points.slice().reverse();\n\n  waypoints = _tryRepairConnectionSide(moved, other, newDocking, waypoints);\n\n  return waypoints ? waypoints.reverse() : null;\n}\n\n/**\n * Repair a connection from one side that moved.\n *\n * @param {Bounds} moved\n * @param {Bounds} other\n * @param {Point} newDocking\n * @param {Array<Point>} points originalPoints from moved to other\n *\n * @return {Array<Point>} the repaired points between the two rectangles\n */\nfunction _tryRepairConnectionSide(moved, other, newDocking, points) {\n\n  function needsRelayout(points) {\n    if (points.length < 3) {\n      return true;\n    }\n\n    if (points.length > 4) {\n      return false;\n    }\n\n    // relayout if two points overlap\n    // this is most likely due to\n    return !!find(points, function(p, idx) {\n      var q = points[idx - 1];\n\n      return q && pointDistance(p, q) < 3;\n    });\n  }\n\n  function repairBendpoint(candidate, oldPeer, newPeer) {\n\n    var alignment = pointsAligned(oldPeer, candidate);\n\n    switch (alignment) {\n    case 'v':\n\n      // repair horizontal alignment\n      return { x: newPeer.x, y: candidate.y };\n    case 'h':\n\n      // repair vertical alignment\n      return { x: candidate.x, y: newPeer.y };\n    }\n\n    return { x: candidate.x, y: candidate. y };\n  }\n\n  function removeOverlapping(points, a, b) {\n    var i;\n\n    for (i = points.length - 2; i !== 0; i--) {\n\n      // intersects (?) break, remove all bendpoints up to this one and relayout\n      if (pointInRect(points[i], a, INTERSECTION_THRESHOLD) ||\n          pointInRect(points[i], b, INTERSECTION_THRESHOLD)) {\n\n        // return sliced old connection\n        return points.slice(i);\n      }\n    }\n\n    return points;\n  }\n\n  // (0) only repair what has layoutable bendpoints\n\n  // (1) if only one bendpoint and on shape moved onto other shapes axis\n  //     (horizontally / vertically), relayout\n\n  if (needsRelayout(points)) {\n    return null;\n  }\n\n  var oldDocking = points[0],\n      newPoints = points.slice(),\n      slicedPoints;\n\n  // (2) repair only last line segment and only if it was layouted before\n\n  newPoints[0] = newDocking;\n  newPoints[1] = repairBendpoint(newPoints[1], oldDocking, newDocking);\n\n\n  // (3) if shape intersects with any bendpoint after repair,\n  //     remove all segments up to this bendpoint and repair from there\n  slicedPoints = removeOverlapping(newPoints, moved, other);\n\n  if (slicedPoints !== newPoints) {\n    newPoints = _tryRepairConnectionSide(moved, other, newDocking, slicedPoints);\n  }\n\n  // (4) do NOT repair if repaired bendpoints are aligned\n  if (newPoints && pointsAligned(newPoints)) {\n    return null;\n  }\n\n  return newPoints;\n}\n\n\n/**\n * Returns the manhattan directions connecting two rectangles\n * with the given orientation.\n *\n * Will always return the default layout, if it is specific\n * regarding sides already (trbl).\n *\n * @example\n *\n * getDirections('top'); // -> 'v:v'\n * getDirections('intersect'); // -> 't:t'\n *\n * getDirections('top-right', 'v:h'); // -> 'v:h'\n * getDirections('top-right', 'h:h'); // -> 'h:h'\n *\n *\n * @param {String} orientation\n * @param {String} defaultLayout\n *\n * @return {String}\n */\nfunction getDirections(orientation, defaultLayout) {\n\n  // don't override specific trbl directions\n  if (isExplicitDirections(defaultLayout)) {\n    return defaultLayout;\n  }\n\n  switch (orientation) {\n  case 'intersect':\n    return 't:t';\n\n  case 'top':\n  case 'bottom':\n    return 'v:v';\n\n  case 'left':\n  case 'right':\n    return 'h:h';\n\n  // 'top-left'\n  // 'top-right'\n  // 'bottom-left'\n  // 'bottom-right'\n  default:\n    return defaultLayout;\n  }\n}\n\nfunction isValidDirections(directions) {\n  return directions && /^h|v|t|r|b|l:h|v|t|r|b|l$/.test(directions);\n}\n\nfunction isExplicitDirections(directions) {\n  return directions && /t|r|b|l/.test(directions);\n}\n\nfunction invertOrientation(orientation) {\n  return {\n    'top': 'bottom',\n    'bottom': 'top',\n    'left': 'right',\n    'right': 'left',\n    'top-left': 'bottom-right',\n    'bottom-right': 'top-left',\n    'top-right': 'bottom-left',\n    'bottom-left': 'top-right',\n  }[orientation];\n}\n\nfunction getDockingPoint(point, rectangle, dockingDirection, targetOrientation) {\n\n  // ensure we end up with a specific docking direction\n  // based on the targetOrientation, if <h|v> is being passed\n\n  if (dockingDirection === 'h') {\n    dockingDirection = /left/.test(targetOrientation) ? 'l' : 'r';\n  }\n\n  if (dockingDirection === 'v') {\n    dockingDirection = /top/.test(targetOrientation) ? 't' : 'b';\n  }\n\n  if (dockingDirection === 't') {\n    return { original: point, x: point.x, y: rectangle.y };\n  }\n\n  if (dockingDirection === 'r') {\n    return { original: point, x: rectangle.x + rectangle.width, y: point.y };\n  }\n\n  if (dockingDirection === 'b') {\n    return { original: point, x: point.x, y: rectangle.y + rectangle.height };\n  }\n\n  if (dockingDirection === 'l') {\n    return { original: point, x: rectangle.x, y: point.y };\n  }\n\n  throw new Error('unexpected dockingDirection: <' + dockingDirection + '>');\n}\n\n\n/**\n * Return list of waypoints with redundant ones filtered out.\n *\n * @example\n *\n * Original points:\n *\n *   [x] ----- [x] ------ [x]\n *                         |\n *                        [x] ----- [x] - [x]\n *\n * Filtered:\n *\n *   [x] ---------------- [x]\n *                         |\n *                        [x] ----------- [x]\n *\n * @param  {Array<Point>} waypoints\n *\n * @return {Array<Point>}\n */\nexport function withoutRedundantPoints(waypoints) {\n  return waypoints.reduce(function(points, p, idx) {\n\n    var previous = points[points.length - 1],\n        next = waypoints[idx + 1];\n\n    if (!pointsOnLine(previous, next, p, 0)) {\n      points.push(p);\n    }\n\n    return points;\n  }, []);\n}\n","import inherits from 'inherits';\n\nimport {\n  assign\n} from 'min-dash';\n\nimport BaseLayouter from 'diagram-js/lib/layout/BaseLayouter';\n\nimport {\n  repairConnection,\n  withoutRedundantPoints\n} from 'diagram-js/lib/layout/ManhattanLayout';\n\nimport {\n  getMid,\n  getOrientation\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport {\n  isExpanded\n} from '../../util/DiUtil';\n\nimport { is } from '../../util/ModelUtil';\n\nvar ATTACH_ORIENTATION_PADDING = -10,\n    BOUNDARY_TO_HOST_THRESHOLD = 40;\n\nvar oppositeOrientationMapping = {\n  'top': 'bottom',\n  'top-right': 'bottom-left',\n  'top-left': 'bottom-right',\n  'right': 'left',\n  'bottom': 'top',\n  'bottom-right': 'top-left',\n  'bottom-left': 'top-right',\n  'left': 'right'\n};\n\nvar orientationDirectionMapping = {\n  top: 't',\n  right: 'r',\n  bottom: 'b',\n  left: 'l'\n};\n\n\nexport default function BpmnLayouter() {}\n\ninherits(BpmnLayouter, BaseLayouter);\n\n\nBpmnLayouter.prototype.layoutConnection = function(connection, hints) {\n  if (!hints) {\n    hints = {};\n  }\n\n  var source = hints.source || connection.source,\n      target = hints.target || connection.target,\n      waypoints = hints.waypoints || connection.waypoints,\n      connectionStart = hints.connectionStart,\n      connectionEnd = hints.connectionEnd;\n\n  var manhattanOptions,\n      updatedWaypoints;\n\n  if (!connectionStart) {\n    connectionStart = getConnectionDocking(waypoints && waypoints[ 0 ], source);\n  }\n\n  if (!connectionEnd) {\n    connectionEnd = getConnectionDocking(waypoints && waypoints[ waypoints.length - 1 ], target);\n  }\n\n  // TODO(nikku): support vertical modeling\n  // and invert preferredLayouts accordingly\n\n  if (is(connection, 'bpmn:Association') ||\n      is(connection, 'bpmn:DataAssociation')) {\n\n    if (waypoints && !isCompensationAssociation(source, target)) {\n      return [].concat([ connectionStart ], waypoints.slice(1, -1), [ connectionEnd ]);\n    }\n  }\n\n  if (is(connection, 'bpmn:MessageFlow')) {\n    manhattanOptions = getMessageFlowManhattanOptions(source, target);\n  } else if (is(connection, 'bpmn:SequenceFlow') || isCompensationAssociation(source, target)) {\n\n    // layout all connection between flow elements h:h, except for\n    // (1) outgoing of boundary events -> layout based on attach orientation and target orientation\n    // (2) incoming/outgoing of gateways -> v:h for outgoing, h:v for incoming\n    // (3) loops\n    if (source === target) {\n      manhattanOptions = {\n        preferredLayouts: getLoopPreferredLayout(source, connection)\n      };\n    } else if (is(source, 'bpmn:BoundaryEvent')) {\n      manhattanOptions = {\n        preferredLayouts: getBoundaryEventPreferredLayouts(source, target, connectionEnd)\n      };\n    } else if (is(source, 'bpmn:Gateway')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'v:h' ]\n      };\n    } else if (is(target, 'bpmn:Gateway')) {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:v' ]\n      };\n    } else {\n      manhattanOptions = {\n        preferredLayouts: [ 'h:h' ]\n      };\n    }\n  }\n\n  if (manhattanOptions) {\n    manhattanOptions = assign(manhattanOptions, hints);\n\n    updatedWaypoints = withoutRedundantPoints(repairConnection(\n      source,\n      target,\n      connectionStart,\n      connectionEnd,\n      waypoints,\n      manhattanOptions\n    ));\n  }\n\n  return updatedWaypoints || [ connectionStart, connectionEnd ];\n};\n\n\n// helpers //////////\n\nfunction getAttachOrientation(attachedElement) {\n  var hostElement = attachedElement.host;\n\n  return getOrientation(getMid(attachedElement), hostElement, ATTACH_ORIENTATION_PADDING);\n}\n\nfunction getMessageFlowManhattanOptions(source, target) {\n  return {\n    preferredLayouts: [ 'straight', 'v:v' ],\n    preserveDocking: getMessageFlowPreserveDocking(source, target)\n  };\n}\n\nfunction getMessageFlowPreserveDocking(source, target) {\n\n  // (1) docking element connected to participant has precedence\n  if (is(target, 'bpmn:Participant')) {\n    return 'source';\n  }\n\n  if (is(source, 'bpmn:Participant')) {\n    return 'target';\n  }\n\n  // (2) docking element connected to expanded sub-process has precedence\n  if (isExpandedSubProcess(target)) {\n    return 'source';\n  }\n\n  if (isExpandedSubProcess(source)) {\n    return 'target';\n  }\n\n  // (3) docking event has precedence\n  if (is(target, 'bpmn:Event')) {\n    return 'target';\n  }\n\n  if (is(source, 'bpmn:Event')) {\n    return 'source';\n  }\n\n  return null;\n}\n\nfunction getConnectionDocking(point, shape) {\n  return point ? (point.original || point) : getMid(shape);\n}\n\nfunction isCompensationAssociation(source, target) {\n  return is(target, 'bpmn:Activity') &&\n    is(source, 'bpmn:BoundaryEvent') &&\n    target.businessObject.isForCompensation;\n}\n\nfunction isExpandedSubProcess(element) {\n  return is(element, 'bpmn:SubProcess') && isExpanded(element);\n}\n\nfunction isSame(a, b) {\n  return a === b;\n}\n\nfunction isAnyOrientation(orientation, orientations) {\n  return orientations.indexOf(orientation) !== -1;\n}\n\nfunction getHorizontalOrientation(orientation) {\n  var matches = /right|left/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction getVerticalOrientation(orientation) {\n  var matches = /top|bottom/.exec(orientation);\n\n  return matches && matches[0];\n}\n\nfunction isOppositeOrientation(a, b) {\n  return oppositeOrientationMapping[a] === b;\n}\n\nfunction isOppositeHorizontalOrientation(a, b) {\n  var horizontalOrientation = getHorizontalOrientation(a);\n\n  var oppositeHorizontalOrientation = oppositeOrientationMapping[horizontalOrientation];\n\n  return b.indexOf(oppositeHorizontalOrientation) !== -1;\n}\n\nfunction isOppositeVerticalOrientation(a, b) {\n  var verticalOrientation = getVerticalOrientation(a);\n\n  var oppositeVerticalOrientation = oppositeOrientationMapping[verticalOrientation];\n\n  return b.indexOf(oppositeVerticalOrientation) !== -1;\n}\n\nfunction isHorizontalOrientation(orientation) {\n  return orientation === 'right' || orientation === 'left';\n}\n\nfunction getLoopPreferredLayout(source, connection) {\n  var waypoints = connection.waypoints;\n\n  var orientation = waypoints && waypoints.length && getOrientation(waypoints[0], source);\n\n  if (orientation === 'top') {\n    return [ 't:r' ];\n  } else if (orientation === 'right') {\n    return [ 'r:b' ];\n  } else if (orientation === 'left') {\n    return [ 'l:t' ];\n  }\n\n  return [ 'b:l' ];\n}\n\nfunction getBoundaryEventPreferredLayouts(source, target, end) {\n  var sourceMid = getMid(source),\n      targetMid = getMid(target),\n      attachOrientation = getAttachOrientation(source),\n      sourceLayout,\n      targetLayout;\n\n  var isLoop = isSame(source.host, target);\n\n  var attachedToSide = isAnyOrientation(attachOrientation, [ 'top', 'right', 'bottom', 'left' ]);\n\n  var targetOrientation = getOrientation(targetMid, sourceMid, {\n    x: source.width / 2 + target.width / 2,\n    y: source.height / 2 + target.height / 2\n  });\n\n  if (isLoop) {\n    return getBoundaryEventLoopLayout(attachOrientation, attachedToSide, source, target, end);\n  }\n\n  // source layout\n  sourceLayout = getBoundaryEventSourceLayout(attachOrientation, targetOrientation, attachedToSide);\n\n  // target layout\n  targetLayout = getBoundaryEventTargetLayout(attachOrientation, targetOrientation, attachedToSide);\n\n  return [ sourceLayout + ':' + targetLayout ];\n}\n\nfunction getBoundaryEventLoopLayout(attachOrientation, attachedToSide, source, target, end) {\n  var orientation = attachedToSide ? attachOrientation : getVerticalOrientation(attachOrientation),\n      sourceLayout = orientationDirectionMapping[ orientation ],\n      targetLayout;\n\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n      targetLayout = shouldConnectToSameSide('y', source, target, end) ? 'h' : 'b';\n    } else {\n      targetLayout = shouldConnectToSameSide('x', source, target, end) ? 'v' : 'l';\n    }\n  } else {\n    targetLayout = 'v';\n  }\n\n  return [ sourceLayout + ':' + targetLayout ];\n}\n\nfunction shouldConnectToSameSide(axis, source, target, end) {\n  var threshold = BOUNDARY_TO_HOST_THRESHOLD;\n\n  return !(\n    areCloseOnAxis(axis, end, target, threshold) ||\n    areCloseOnAxis(axis, end, {\n      x: target.x + target.width,\n      y: target.y + target.height\n    }, threshold) ||\n    areCloseOnAxis(axis, end, getMid(source), threshold)\n  );\n}\n\nfunction areCloseOnAxis(axis, a, b, threshold) {\n  return Math.abs(a[ axis ] - b[ axis ]) < threshold;\n}\n\nfunction getBoundaryEventSourceLayout(attachOrientation, targetOrientation, attachedToSide) {\n\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    return orientationDirectionMapping[ attachOrientation ];\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // same vertical or opposite horizontal orientation\n  if (isSame(\n    getVerticalOrientation(attachOrientation), getVerticalOrientation(targetOrientation)\n  ) || isOppositeOrientation(\n    getHorizontalOrientation(attachOrientation), getHorizontalOrientation(targetOrientation)\n  )) {\n    return orientationDirectionMapping[ getVerticalOrientation(attachOrientation) ];\n  }\n\n  // fallback\n  return orientationDirectionMapping[ getHorizontalOrientation(attachOrientation) ];\n}\n\nfunction getBoundaryEventTargetLayout(attachOrientation, targetOrientation, attachedToSide) {\n\n  // attached to either top, right, bottom or left side\n  if (attachedToSide) {\n    if (isHorizontalOrientation(attachOrientation)) {\n\n      // orientation is right or left\n\n      // opposite horizontal orientation or same orientation\n      if (\n        isOppositeHorizontalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return 'h';\n      }\n\n      // fallback\n      return 'v';\n    } else {\n\n      // orientation is top or bottom\n\n      // opposite vertical orientation or same orientation\n      if (\n        isOppositeVerticalOrientation(attachOrientation, targetOrientation) ||\n        isSame(attachOrientation, targetOrientation)\n      ) {\n        return 'v';\n      }\n\n      // fallback\n      return 'h';\n    }\n  }\n\n  // attached to either top-right, top-left, bottom-right or bottom-left corner\n\n  // orientation is right, left\n  // or same vertical orientation but also right or left\n  if (isHorizontalOrientation(targetOrientation) ||\n    (isSame(getVerticalOrientation(attachOrientation), getVerticalOrientation(targetOrientation)) &&\n      getHorizontalOrientation(targetOrientation))) {\n    return 'h';\n  } else {\n    return 'v';\n  }\n}\n","import {\n  assign\n} from 'min-dash';\n\nimport {\n  getElementLineIntersection\n} from './LayoutUtil';\n\n\nfunction dockingToPoint(docking) {\n\n  // use the dockings actual point and\n  // retain the original docking\n  return assign({ original: docking.point.original || docking.point }, docking.actual);\n}\n\n\n/**\n * A {@link ConnectionDocking} that crops connection waypoints based on\n * the path(s) of the connection source and target.\n *\n * @param {djs.core.ElementRegistry} elementRegistry\n */\nexport default function CroppingConnectionDocking(elementRegistry, graphicsFactory) {\n  this._elementRegistry = elementRegistry;\n  this._graphicsFactory = graphicsFactory;\n}\n\nCroppingConnectionDocking.$inject = [ 'elementRegistry', 'graphicsFactory' ];\n\n\n/**\n * @inheritDoc ConnectionDocking#getCroppedWaypoints\n */\nCroppingConnectionDocking.prototype.getCroppedWaypoints = function(connection, source, target) {\n\n  source = source || connection.source;\n  target = target || connection.target;\n\n  var sourceDocking = this.getDockingPoint(connection, source, true),\n      targetDocking = this.getDockingPoint(connection, target);\n\n  var croppedWaypoints = connection.waypoints.slice(sourceDocking.idx + 1, targetDocking.idx);\n\n  croppedWaypoints.unshift(dockingToPoint(sourceDocking));\n  croppedWaypoints.push(dockingToPoint(targetDocking));\n\n  return croppedWaypoints;\n};\n\n/**\n * Return the connection docking point on the specified shape\n *\n * @inheritDoc ConnectionDocking#getDockingPoint\n */\nCroppingConnectionDocking.prototype.getDockingPoint = function(connection, shape, dockStart) {\n\n  var waypoints = connection.waypoints,\n      dockingIdx,\n      dockingPoint,\n      croppedPoint;\n\n  dockingIdx = dockStart ? 0 : waypoints.length - 1;\n  dockingPoint = waypoints[dockingIdx];\n\n  croppedPoint = this._getIntersection(shape, connection, dockStart);\n\n  return {\n    point: dockingPoint,\n    actual: croppedPoint || dockingPoint,\n    idx: dockingIdx\n  };\n};\n\n\n// helpers //////////////////////\n\nCroppingConnectionDocking.prototype._getIntersection = function(shape, connection, takeFirst) {\n\n  var shapePath = this._getShapePath(shape),\n      connectionPath = this._getConnectionPath(connection);\n\n  return getElementLineIntersection(shapePath, connectionPath, takeFirst);\n};\n\nCroppingConnectionDocking.prototype._getConnectionPath = function(connection) {\n  return this._graphicsFactory.getConnectionPath(connection);\n};\n\nCroppingConnectionDocking.prototype._getShapePath = function(shape) {\n  return this._graphicsFactory.getShapePath(shape);\n};\n\nCroppingConnectionDocking.prototype._getGfx = function(element) {\n  return this._elementRegistry.getGraphics(element);\n};\n","import BehaviorModule from './behavior';\nimport RulesModule from '../rules';\nimport OrderingModule from '../ordering';\nimport ReplaceModule from '../replace';\n\nimport CommandModule from 'diagram-js/lib/command';\nimport TooltipsModule from 'diagram-js/lib/features/tooltips';\nimport LabelSupportModule from 'diagram-js/lib/features/label-support';\nimport AttachSupportModule from 'diagram-js/lib/features/attach-support';\nimport SelectionModule from 'diagram-js/lib/features/selection';\nimport ChangeSupportModule from 'diagram-js/lib/features/change-support';\nimport SpaceToolModule from 'diagram-js/lib/features/space-tool';\n\nimport BpmnFactory from './BpmnFactory';\nimport BpmnUpdater from './BpmnUpdater';\nimport ElementFactory from './ElementFactory';\nimport Modeling from './Modeling';\nimport BpmnLayouter from './BpmnLayouter';\nimport CroppingConnectionDocking from 'diagram-js/lib/layout/CroppingConnectionDocking';\n\n\nexport default {\n  __init__: [\n    'modeling',\n    'bpmnUpdater'\n  ],\n  __depends__: [\n    BehaviorModule,\n    RulesModule,\n    OrderingModule,\n    ReplaceModule,\n    CommandModule,\n    TooltipsModule,\n    LabelSupportModule,\n    AttachSupportModule,\n    SelectionModule,\n    ChangeSupportModule,\n    SpaceToolModule\n  ],\n  bpmnFactory: [ 'type', BpmnFactory ],\n  bpmnUpdater: [ 'type', BpmnUpdater ],\n  elementFactory: [ 'type', ElementFactory ],\n  modeling: [ 'type', Modeling ],\n  layouter: [ 'type', BpmnLayouter ],\n  connectionDocking: [ 'type', CroppingConnectionDocking ]\n};","import {\n  assign,\n  filter,\n  groupBy,\n  isObject\n} from 'min-dash';\n\nvar LOW_PRIORITY = 500,\n    MEDIUM_PRIORITY = 1250,\n    HIGH_PRIORITY = 1500;\n\nimport { getOriginal as getOriginalEvent } from '../../util/Event';\n\nvar round = Math.round;\n\nfunction mid(element) {\n  return {\n    x: element.x + round(element.width / 2),\n    y: element.y + round(element.height / 2)\n  };\n}\n\n/**\n * A plugin that makes shapes draggable / droppable.\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Modeling} modeling\n * @param {Selection} selection\n * @param {Rules} rules\n */\nexport default function MoveEvents(\n    eventBus, dragging, modeling,\n    selection, rules) {\n\n  // rules\n\n  function canMove(shapes, delta, position, target) {\n\n    return rules.allowed('elements.move', {\n      shapes: shapes,\n      delta: delta,\n      position: position,\n      target: target\n    });\n  }\n\n\n  // move events\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment.\n  //\n  // This sets up the context with\n  //\n  // * shape: the primary shape being moved\n  // * shapes: a list of shapes to be moved\n  // * validatedShapes: a list of shapes that are being checked\n  //                    against the rules before and during move\n  //\n  eventBus.on('shape.move.start', HIGH_PRIORITY, function(event) {\n\n    var context = event.context,\n        shape = event.shape,\n        shapes = selection.get().slice();\n\n    // move only single shape if the dragged element\n    // is not part of the current selection\n    if (shapes.indexOf(shape) === -1) {\n      shapes = [ shape ];\n    }\n\n    // ensure we remove nested elements in the collection\n    // and add attachers for a proper dragger\n    shapes = removeNested(shapes);\n\n    // attach shapes to drag context\n    assign(context, {\n      shapes: shapes,\n      validatedShapes: shapes,\n      shape: shape\n    });\n  });\n\n\n  // assign a high priority to this handler to setup the environment\n  // others may hook up later, e.g. at default priority and modify\n  // the move environment\n  //\n  eventBus.on('shape.move.start', MEDIUM_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        canExecute;\n\n    canExecute = context.canExecute = canMove(validatedShapes);\n\n    // check if we can move the elements\n    if (!canExecute) {\n      return false;\n    }\n  });\n\n  // assign a low priority to this handler\n  // to let others modify the move event before we update\n  // the context\n  //\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        validatedShapes = context.validatedShapes,\n        hover = event.hover,\n        delta = { x: event.dx, y: event.dy },\n        position = { x: event.x, y: event.y },\n        canExecute;\n\n    // check if we can move the elements\n    canExecute = canMove(validatedShapes, delta, position, hover);\n\n    context.delta = delta;\n    context.canExecute = canExecute;\n\n    // simply ignore move over\n    if (canExecute === null) {\n      context.target = null;\n\n      return;\n    }\n\n    context.target = hover;\n  });\n\n  eventBus.on('shape.move.end', function(event) {\n\n    var context = event.context;\n\n    var delta = context.delta,\n        canExecute = context.canExecute,\n        isAttach = canExecute === 'attach',\n        shapes = context.shapes;\n\n    if (canExecute === false) {\n      return false;\n    }\n\n    // ensure we have actual pixel values deltas\n    // (important when zoom level was > 1 during move)\n    delta.x = round(delta.x);\n    delta.y = round(delta.y);\n\n    if (delta.x === 0 && delta.y === 0) {\n\n      // didn't move\n      return;\n    }\n\n    modeling.moveElements(shapes, delta, context.target, {\n      primaryShape: context.shape,\n      attach: isAttach\n    });\n  });\n\n\n  // move activation\n\n  eventBus.on('element.mousedown', function(event) {\n\n    var originalEvent = getOriginalEvent(event);\n\n    if (!originalEvent) {\n      throw new Error('must supply DOM mousedown event');\n    }\n\n    return start(originalEvent, event.element);\n  });\n\n  /**\n   * Start move.\n   *\n   * @param {MouseEvent} event\n   * @param {djs.model.Shape} shape\n   * @param {boolean} [activate]\n   * @param {Object} [context]\n   */\n  function start(event, element, activate, context) {\n    if (isObject(activate)) {\n      context = activate;\n      activate = false;\n    }\n\n    // do not move connections or the root element\n    if (element.waypoints || !element.parent) {\n      return;\n    }\n\n    var referencePoint = mid(element);\n\n    dragging.init(event, referencePoint, 'shape.move', {\n      cursor: 'grabbing',\n      autoActivate: activate,\n      data: {\n        shape: element,\n        context: context || {}\n      }\n    });\n\n    // we've handled the event\n    return true;\n  }\n\n  // API\n\n  this.start = start;\n}\n\nMoveEvents.$inject = [\n  'eventBus',\n  'dragging',\n  'modeling',\n  'selection',\n  'rules'\n];\n\n\n/**\n * Return a filtered list of elements that do not contain\n * those nested into others.\n *\n * @param  {Array<djs.model.Base>} elements\n *\n * @return {Array<djs.model.Base>} filtered\n */\nfunction removeNested(elements) {\n\n  var ids = groupBy(elements, 'id');\n\n  return filter(elements, function(element) {\n    while ((element = element.parent)) {\n\n      // parent in selection\n      if (ids[element.id]) {\n        return false;\n      }\n    }\n\n    return true;\n  });\n}\n","import {\n  flatten,\n  forEach,\n  filter,\n  find,\n  groupBy,\n  map,\n  matchPattern,\n  size\n} from 'min-dash';\n\nimport {\n  selfAndAllChildren\n} from '../../util/Elements';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nimport { translate } from '../../util/SvgTransformUtil';\n\nvar LOW_PRIORITY = 499;\n\nvar MARKER_DRAGGING = 'djs-dragging',\n    MARKER_OK = 'drop-ok',\n    MARKER_NOT_OK = 'drop-not-ok',\n    MARKER_NEW_PARENT = 'new-parent',\n    MARKER_ATTACH = 'attach-ok';\n\n\n/**\n * Provides previews for moving shapes when moving.\n *\n * @param {EventBus} eventBus\n * @param {ElementRegistry} elementRegistry\n * @param {Canvas} canvas\n * @param {Styles} styles\n */\nexport default function MovePreview(\n    eventBus, canvas, styles, previewSupport) {\n\n  function getVisualDragShapes(shapes) {\n    var elements = getAllDraggedElements(shapes);\n\n    var filteredElements = removeEdges(elements);\n\n    return filteredElements;\n  }\n\n  function getAllDraggedElements(shapes) {\n    var allShapes = selfAndAllChildren(shapes, true);\n\n    var allConnections = map(allShapes, function(shape) {\n      return (shape.incoming || []).concat(shape.outgoing || []);\n    });\n\n    return flatten(allShapes.concat(allConnections));\n  }\n\n  /**\n   * Sets drop marker on an element.\n   */\n  function setMarker(element, marker) {\n\n    [ MARKER_ATTACH, MARKER_OK, MARKER_NOT_OK, MARKER_NEW_PARENT ].forEach(function(m) {\n\n      if (m === marker) {\n        canvas.addMarker(element, m);\n      } else {\n        canvas.removeMarker(element, m);\n      }\n    });\n  }\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  function makeDraggable(context, element, addMarker) {\n\n    previewSupport.addDragger(element, context.dragGroup);\n\n    if (addMarker) {\n      canvas.addMarker(element, MARKER_DRAGGING);\n    }\n\n    if (context.allDraggedElements) {\n      context.allDraggedElements.push(element);\n    } else {\n      context.allDraggedElements = [ element ];\n    }\n  }\n\n  // assign a low priority to this handler\n  // to let others modify the move context before\n  // we draw things\n  eventBus.on('shape.move.start', LOW_PRIORITY, function(event) {\n    var context = event.context,\n        dragShapes = context.shapes,\n        allDraggedElements = context.allDraggedElements;\n\n    var visuallyDraggedShapes = getVisualDragShapes(dragShapes);\n\n    if (!context.dragGroup) {\n      var dragGroup = svgCreate('g');\n\n      svgAttr(dragGroup, styles.cls('djs-drag-group', [ 'no-events' ]));\n\n      var defaultLayer = canvas.getDefaultLayer();\n\n      svgAppend(defaultLayer, dragGroup);\n\n      context.dragGroup = dragGroup;\n    }\n\n    // add previews\n    visuallyDraggedShapes.forEach(function(shape) {\n      previewSupport.addDragger(shape, context.dragGroup);\n    });\n\n    // cache all dragged elements / gfx\n    // so that we can quickly undo their state changes later\n    if (!allDraggedElements) {\n      allDraggedElements = getAllDraggedElements(dragShapes);\n    } else {\n      allDraggedElements = flatten([\n        allDraggedElements,\n        getAllDraggedElements(dragShapes)\n      ]);\n    }\n\n    // add dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.addMarker(e, MARKER_DRAGGING);\n    });\n\n    context.allDraggedElements = allDraggedElements;\n\n    // determine, if any of the dragged elements have different parents\n    context.differentParents = haveDifferentParents(dragShapes);\n  });\n\n  // update previews\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        dragGroup = context.dragGroup,\n        target = context.target,\n        parent = context.shape.parent,\n        canExecute = context.canExecute;\n\n    if (target) {\n      if (canExecute === 'attach') {\n        setMarker(target, MARKER_ATTACH);\n      } else if (context.canExecute && target && target.id !== parent.id) {\n        setMarker(target, MARKER_NEW_PARENT);\n      } else {\n        setMarker(target, context.canExecute ? MARKER_OK : MARKER_NOT_OK);\n      }\n    }\n\n    translate(dragGroup, event.dx, event.dy);\n  });\n\n  eventBus.on([ 'shape.move.out', 'shape.move.cleanup' ], function(event) {\n    var context = event.context,\n        target = context.target;\n\n    if (target) {\n      setMarker(target, null);\n    }\n  });\n\n  // remove previews\n  eventBus.on('shape.move.cleanup', function(event) {\n\n    var context = event.context,\n        allDraggedElements = context.allDraggedElements,\n        dragGroup = context.dragGroup;\n\n\n    // remove dragging marker\n    forEach(allDraggedElements, function(e) {\n      canvas.removeMarker(e, MARKER_DRAGGING);\n    });\n\n    if (dragGroup) {\n      svgRemove(dragGroup);\n    }\n  });\n\n\n  // API //////////////////////\n\n  /**\n   * Make an element draggable.\n   *\n   * @param {Object} context\n   * @param {djs.model.Base} element\n   * @param {Boolean} addMarker\n   */\n  this.makeDraggable = makeDraggable;\n}\n\nMovePreview.$inject = [\n  'eventBus',\n  'canvas',\n  'styles',\n  'previewSupport'\n];\n\n\n// helpers //////////////////////\n\n/**\n * returns elements minus all connections\n * where source or target is not elements\n */\nfunction removeEdges(elements) {\n\n  var filteredElements = filter(elements, function(element) {\n\n    if (!isConnection(element)) {\n      return true;\n    } else {\n\n      return (\n        find(elements, matchPattern({ id: element.source.id })) &&\n        find(elements, matchPattern({ id: element.target.id }))\n      );\n    }\n  });\n\n  return filteredElements;\n}\n\nfunction haveDifferentParents(elements) {\n  return size(groupBy(elements, function(e) { return e.parent && e.parent.id; })) !== 1;\n}\n\n/**\n * Checks if an element is a connection.\n */\nfunction isConnection(element) {\n  return element.waypoints;\n}\n","import InteractionEventsModule from '../interaction-events';\nimport SelectionModule from '../selection';\nimport OutlineModule from '../outline';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport PreviewSupportModule from '../preview-support';\n\nimport Move from './Move';\nimport MovePreview from './MovePreview';\n\nexport default {\n  __depends__: [\n    InteractionEventsModule,\n    SelectionModule,\n    OutlineModule,\n    RulesModule,\n    DraggingModule,\n    PreviewSupportModule\n  ],\n  __init__: [\n    'move',\n    'movePreview'\n  ],\n  move: [ 'type', Move ],\n  movePreview: [ 'type', MovePreview ]\n};\n","import {\n  isArray,\n  isFunction,\n  forEach\n} from 'min-dash';\n\nimport {\n  domify,\n  query as domQuery,\n  attr as domAttr,\n  clear as domClear,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  event as domEvent\n} from 'min-dom';\n\n\nvar TOGGLE_SELECTOR = '.djs-palette-toggle',\n    ENTRY_SELECTOR = '.entry',\n    ELEMENT_SELECTOR = TOGGLE_SELECTOR + ', ' + ENTRY_SELECTOR;\n\nvar PALETTE_OPEN_CLS = 'open',\n    PALETTE_TWO_COLUMN_CLS = 'two-column';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A palette containing modeling elements.\n */\nexport default function Palette(eventBus, canvas) {\n\n  this._eventBus = eventBus;\n  this._canvas = canvas;\n\n  var self = this;\n\n  eventBus.on('tool-manager.update', function(event) {\n    var tool = event.tool;\n\n    self.updateToolHighlight(tool);\n  });\n\n  eventBus.on('i18n.changed', function() {\n    self._update();\n  });\n\n  eventBus.on('diagram.init', function() {\n\n    self._diagramInitialized = true;\n\n    self._rebuild();\n  });\n}\n\nPalette.$inject = [ 'eventBus', 'canvas' ];\n\n\n/**\n * Register a provider with the palette\n *\n * @param  {Number} [priority=1000]\n * @param  {PaletteProvider} provider\n *\n * @example\n * const paletteProvider = {\n *   getPaletteEntries: function() {\n *     return function(entries) {\n *       return {\n *         ...entries,\n *         'entry-1': {\n *           label: 'My Entry',\n *           action: function() { alert(\"I have been clicked!\"); }\n *         }\n *       };\n *     }\n *   }\n * };\n *\n * palette.registerProvider(800, paletteProvider);\n */\nPalette.prototype.registerProvider = function(priority, provider) {\n  if (!provider) {\n    provider = priority;\n    priority = DEFAULT_PRIORITY;\n  }\n\n  this._eventBus.on('palette.getProviders', priority, function(event) {\n    event.providers.push(provider);\n  });\n\n  this._rebuild();\n};\n\n\n/**\n * Returns the palette entries\n *\n * @return {Object<string, PaletteEntryDescriptor>} map of entries\n */\nPalette.prototype.getEntries = function() {\n  var providers = this._getProviders();\n\n  return providers.reduce(addPaletteEntries, {});\n};\n\nPalette.prototype._rebuild = function() {\n\n  if (!this._diagramInitialized) {\n    return;\n  }\n\n  var providers = this._getProviders();\n\n  if (!providers.length) {\n    return;\n  }\n\n  if (!this._container) {\n    this._init();\n  }\n\n  this._update();\n};\n\n/**\n * Initialize\n */\nPalette.prototype._init = function() {\n\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var parentContainer = this._getParentContainer();\n\n  var container = this._container = domify(Palette.HTML_MARKUP);\n\n  parentContainer.appendChild(container);\n\n  domDelegate.bind(container, ELEMENT_SELECTOR, 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    if (domMatches(target, TOGGLE_SELECTOR)) {\n      return self.toggle();\n    }\n\n    self.trigger('click', event);\n  });\n\n  // prevent drag propagation\n  domEvent.bind(container, 'mousedown', function(event) {\n    event.stopPropagation();\n  });\n\n  // prevent drag propagation\n  domDelegate.bind(container, ENTRY_SELECTOR, 'dragstart', function(event) {\n    self.trigger('dragstart', event);\n  });\n\n  eventBus.on('canvas.resized', this._layoutChanged, this);\n\n  eventBus.fire('palette.create', {\n    container: container\n  });\n};\n\nPalette.prototype._getProviders = function(id) {\n\n  var event = this._eventBus.createEvent({\n    type: 'palette.getProviders',\n    providers: []\n  });\n\n  this._eventBus.fire(event);\n\n  return event.providers;\n};\n\n/**\n * Update palette state.\n *\n * @param  {Object} [state] { open, twoColumn }\n */\nPalette.prototype._toggleState = function(state) {\n\n  state = state || {};\n\n  var parent = this._getParentContainer(),\n      container = this._container;\n\n  var eventBus = this._eventBus;\n\n  var twoColumn;\n\n  var cls = domClasses(container);\n\n  if ('twoColumn' in state) {\n    twoColumn = state.twoColumn;\n  } else {\n    twoColumn = this._needsCollapse(parent.clientHeight, this._entries || {});\n  }\n\n  // always update two column\n  cls.toggle(PALETTE_TWO_COLUMN_CLS, twoColumn);\n\n  if ('open' in state) {\n    cls.toggle(PALETTE_OPEN_CLS, state.open);\n  }\n\n  eventBus.fire('palette.changed', {\n    twoColumn: twoColumn,\n    open: this.isOpen()\n  });\n};\n\nPalette.prototype._update = function() {\n\n  var entriesContainer = domQuery('.djs-palette-entries', this._container),\n      entries = this._entries = this.getEntries();\n\n  domClear(entriesContainer);\n\n  forEach(entries, function(entry, id) {\n\n    var grouping = entry.group || 'default';\n\n    var container = domQuery('[data-group=' + grouping + ']', entriesContainer);\n    if (!container) {\n      container = domify('<div class=\"group\" data-group=\"' + grouping + '\"></div>');\n      entriesContainer.appendChild(container);\n    }\n\n    var html = entry.html || (\n      entry.separator ?\n        '<hr class=\"separator\" />' :\n        '<div class=\"entry\" draggable=\"true\"></div>');\n\n\n    var control = domify(html);\n    container.appendChild(control);\n\n    if (!entry.separator) {\n      domAttr(control, 'data-action', id);\n\n      if (entry.title) {\n        domAttr(control, 'title', entry.title);\n      }\n\n      if (entry.className) {\n        addClasses(control, entry.className);\n      }\n\n      if (entry.imageUrl) {\n        control.appendChild(domify('<img src=\"' + entry.imageUrl + '\">'));\n      }\n    }\n  });\n\n  // open after update\n  this.open();\n};\n\n\n/**\n * Trigger an action available on the palette\n *\n * @param  {String} action\n * @param  {Event} event\n */\nPalette.prototype.trigger = function(action, event, autoActivate) {\n  var entries = this._entries,\n      entry,\n      handler,\n      originalEvent,\n      button = event.delegateTarget || event.target;\n\n  if (!button) {\n    return event.preventDefault();\n  }\n\n  entry = entries[domAttr(button, 'data-action')];\n\n  // when user clicks on the palette and not on an action\n  if (!entry) {\n    return;\n  }\n\n  handler = entry.action;\n\n  originalEvent = event.originalEvent || event;\n\n  // simple action (via callback function)\n  if (isFunction(handler)) {\n    if (action === 'click') {\n      handler(originalEvent, autoActivate);\n    }\n  } else {\n    if (handler[action]) {\n      handler[action](originalEvent, autoActivate);\n    }\n  }\n\n  // silence other actions\n  event.preventDefault();\n};\n\nPalette.prototype._layoutChanged = function() {\n  this._toggleState({});\n};\n\n/**\n * Do we need to collapse to two columns?\n *\n * @param {Number} availableHeight\n * @param {Object} entries\n *\n * @return {Boolean}\n */\nPalette.prototype._needsCollapse = function(availableHeight, entries) {\n\n  // top margin + bottom toggle + bottom margin\n  // implementors must override this method if they\n  // change the palette styles\n  var margin = 20 + 10 + 20;\n\n  var entriesHeight = Object.keys(entries).length * 46;\n\n  return availableHeight < entriesHeight + margin;\n};\n\n/**\n * Close the palette\n */\nPalette.prototype.close = function() {\n\n  this._toggleState({\n    open: false,\n    twoColumn: false\n  });\n};\n\n\n/**\n * Open the palette\n */\nPalette.prototype.open = function() {\n  this._toggleState({ open: true });\n};\n\n\nPalette.prototype.toggle = function(open) {\n  if (this.isOpen()) {\n    this.close();\n  } else {\n    this.open();\n  }\n};\n\nPalette.prototype.isActiveTool = function(tool) {\n  return tool && this._activeTool === tool;\n};\n\nPalette.prototype.updateToolHighlight = function(name) {\n  var entriesContainer,\n      toolsContainer;\n\n  if (!this._toolsContainer) {\n    entriesContainer = domQuery('.djs-palette-entries', this._container);\n\n    this._toolsContainer = domQuery('[data-group=tools]', entriesContainer);\n  }\n\n  toolsContainer = this._toolsContainer;\n\n  forEach(toolsContainer.children, function(tool) {\n    var actionName = tool.getAttribute('data-action');\n\n    if (!actionName) {\n      return;\n    }\n\n    var toolClasses = domClasses(tool);\n\n    actionName = actionName.replace('-tool', '');\n\n    if (toolClasses.contains('entry') && actionName === name) {\n      toolClasses.add('highlighted-entry');\n    } else {\n      toolClasses.remove('highlighted-entry');\n    }\n  });\n};\n\n\n/**\n * Return true if the palette is opened.\n *\n * @example\n *\n * palette.open();\n *\n * if (palette.isOpen()) {\n *   // yes, we are open\n * }\n *\n * @return {boolean} true if palette is opened\n */\nPalette.prototype.isOpen = function() {\n  return domClasses(this._container).has(PALETTE_OPEN_CLS);\n};\n\n/**\n * Get container the palette lives in.\n *\n * @return {Element}\n */\nPalette.prototype._getParentContainer = function() {\n  return this._canvas.getContainer();\n};\n\n\n/* markup definition */\n\nPalette.HTML_MARKUP =\n  '<div class=\"djs-palette\">' +\n    '<div class=\"djs-palette-entries\"></div>' +\n    '<div class=\"djs-palette-toggle\"></div>' +\n  '</div>';\n\n\n// helpers //////////////////////\n\nfunction addClasses(element, classNames) {\n\n  var classes = domClasses(element);\n\n  var actualClassNames = isArray(classNames) ? classNames : classNames.split(/\\s+/g);\n  actualClassNames.forEach(function(cls) {\n    classes.add(cls);\n  });\n}\n\nfunction addPaletteEntries(entries, provider) {\n\n  var entriesOrUpdater = provider.getPaletteEntries();\n\n  if (isFunction(entriesOrUpdater)) {\n    return entriesOrUpdater(entries);\n  }\n\n  forEach(entriesOrUpdater, function(entry, id) {\n    entries[id] = entry;\n  });\n\n  return entries;\n}","import Palette from './Palette';\n\nexport default {\n  __init__: [ 'palette' ],\n  palette: [ 'type', Palette ]\n};\n","import { values } from 'min-dash';\n\nimport { getEnclosedElements } from '../../util/Elements';\n\nimport { hasSecondaryModifier } from '../../util/Mouse';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  create as svgCreate,\n  remove as svgRemove\n} from 'tiny-svg';\n\nvar LASSO_TOOL_CURSOR = 'crosshair';\n\n\nexport default function LassoTool(\n    eventBus, canvas, dragging,\n    elementRegistry, selection, toolManager) {\n\n  this._selection = selection;\n  this._dragging = dragging;\n\n  var self = this;\n\n  // lasso visuals implementation\n\n  /**\n  * A helper that realizes the selection box visual\n  */\n  var visuals = {\n\n    create: function(context) {\n      var container = canvas.getDefaultLayer(),\n          frame;\n\n      frame = context.frame = svgCreate('rect');\n      svgAttr(frame, {\n        class: 'djs-lasso-overlay',\n        width:  1,\n        height: 1,\n        x: 0,\n        y: 0\n      });\n\n      svgAppend(container, frame);\n    },\n\n    update: function(context) {\n      var frame = context.frame,\n          bbox = context.bbox;\n\n      svgAttr(frame, {\n        x: bbox.x,\n        y: bbox.y,\n        width: bbox.width,\n        height: bbox.height\n      });\n    },\n\n    remove: function(context) {\n\n      if (context.frame) {\n        svgRemove(context.frame);\n      }\n    }\n  };\n\n  toolManager.registerTool('lasso', {\n    tool: 'lasso.selection',\n    dragging: 'lasso'\n  });\n\n  eventBus.on('lasso.selection.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return;\n    }\n\n    eventBus.once('lasso.selection.ended', function() {\n      self.activateLasso(event.originalEvent, true);\n    });\n  });\n\n  // lasso interaction implementation\n\n  eventBus.on('lasso.end', function(event) {\n\n    var bbox = toBBox(event);\n\n    var elements = elementRegistry.filter(function(element) {\n      return element;\n    });\n\n    self.select(elements, bbox);\n  });\n\n  eventBus.on('lasso.start', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.create(context);\n  });\n\n  eventBus.on('lasso.move', function(event) {\n\n    var context = event.context;\n\n    context.bbox = toBBox(event);\n    visuals.update(context);\n  });\n\n  eventBus.on('lasso.cleanup', function(event) {\n\n    var context = event.context;\n\n    visuals.remove(context);\n  });\n\n\n  // event integration\n\n  eventBus.on('element.mousedown', 1500, function(event) {\n\n    if (hasSecondaryModifier(event)) {\n      self.activateLasso(event.originalEvent);\n\n      // we've handled the event\n      return true;\n    }\n  });\n}\n\nLassoTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'elementRegistry',\n  'selection',\n  'toolManager'\n];\n\n\nLassoTool.prototype.activateLasso = function(event, autoActivate) {\n\n  this._dragging.init(event, 'lasso', {\n    autoActivate: autoActivate,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.activateSelection = function(event) {\n\n  this._dragging.init(event, 'lasso.selection', {\n    trapClick: false,\n    cursor: LASSO_TOOL_CURSOR,\n    data: {\n      context: {}\n    }\n  });\n};\n\nLassoTool.prototype.select = function(elements, bbox) {\n  var selectedElements = getEnclosedElements(elements, bbox);\n\n  this._selection.select(values(selectedElements));\n};\n\nLassoTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateSelection();\n  }\n};\n\nLassoTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^lasso/.test(context.prefix);\n};\n\n\n\nfunction toBBox(event) {\n\n  var start = {\n\n    x: event.x - event.dx,\n    y: event.y - event.dy\n  };\n\n  var end = {\n    x: event.x,\n    y: event.y\n  };\n\n  var bbox;\n\n  if ((start.x <= end.x && start.y < end.y) ||\n      (start.x < end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: start.y,\n      width:  end.x - start.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x >= end.x && start.y < end.y) ||\n             (start.x > end.x && start.y <= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: start.y,\n      width:  start.x - end.x,\n      height: end.y - start.y\n    };\n  } else if ((start.x <= end.x && start.y > end.y) ||\n             (start.x < end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: start.x,\n      y: end.y,\n      width:  end.x - start.x,\n      height: start.y - end.y\n    };\n  } else if ((start.x >= end.x && start.y > end.y) ||\n             (start.x > end.x && start.y >= end.y)) {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  start.x - end.x,\n      height: start.y - end.y\n    };\n  } else {\n\n    bbox = {\n      x: end.x,\n      y: end.y,\n      width:  0,\n      height: 0\n    };\n  }\n  return bbox;\n}\n","import ToolManagerModule from '../tool-manager';\n\nimport LassoTool from './LassoTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'lassoTool' ],\n  lassoTool: [ 'type', LassoTool ]\n};\n","import { hasPrimaryModifier } from '../../util/Mouse';\n\nimport { isKey } from '../../features/keyboard/KeyboardUtil';\n\nvar HIGH_PRIORITY = 1500;\nvar HAND_CURSOR = 'grab';\n\n\nexport default function HandTool(eventBus, canvas, dragging, injector, toolManager) {\n  this._dragging = dragging;\n\n  var self = this,\n      keyboard = injector.get('keyboard', false);\n\n  toolManager.registerTool('hand', {\n    tool: 'hand',\n    dragging: 'hand.move'\n  });\n\n  eventBus.on('element.mousedown', HIGH_PRIORITY, function(event) {\n    if (hasPrimaryModifier(event)) {\n      this.activateMove(event.originalEvent);\n\n      return false;\n    }\n  }, this);\n\n  keyboard && keyboard.addListener(HIGH_PRIORITY, function(e) {\n    if (!isSpace(e.keyEvent)) {\n      return;\n    }\n\n    if (self.isActive()) {\n      return;\n    }\n\n    function activateMove(event) {\n      self.activateMove(event);\n\n      window.removeEventListener('mousemove', activateMove);\n    }\n\n    window.addEventListener('mousemove', activateMove);\n\n    function deactivateMove(e) {\n      if (!isSpace(e.keyEvent)) {\n        return;\n      }\n\n      window.removeEventListener('mousemove', activateMove);\n\n      keyboard.removeListener(deactivateMove, 'keyboard.keyup');\n\n      dragging.cancel();\n    }\n\n    keyboard.addListener(HIGH_PRIORITY, deactivateMove, 'keyboard.keyup');\n  }, 'keyboard.keydown');\n\n  eventBus.on('hand.end', function(event) {\n    var target = event.originalEvent.target;\n\n    // only reactive on diagram click\n    // on some occasions, event.hover is not set and we have to check if the target is an svg\n    if (!event.hover && !(target instanceof SVGElement)) {\n      return false;\n    }\n\n    eventBus.once('hand.ended', function() {\n      this.activateMove(event.originalEvent, { reactivate: true });\n    }, this);\n\n  }, this);\n\n\n  eventBus.on('hand.move.move', function(event) {\n    var scale = canvas.viewbox().scale;\n\n    canvas.scroll({\n      dx: event.dx * scale,\n      dy: event.dy * scale\n    });\n  });\n\n  eventBus.on('hand.move.end', function(event) {\n    var context = event.context,\n        reactivate = context.reactivate;\n\n    // Don't reactivate if the user is using the keyboard keybinding\n    if (!hasPrimaryModifier(event) && reactivate) {\n\n      eventBus.once('hand.move.ended', function(event) {\n        this.activateHand(event.originalEvent, true, true);\n      }, this);\n\n    }\n\n    return false;\n  }, this);\n\n}\n\nHandTool.$inject = [\n  'eventBus',\n  'canvas',\n  'dragging',\n  'injector',\n  'toolManager'\n];\n\n\nHandTool.prototype.activateMove = function(event, autoActivate, context) {\n  if (typeof autoActivate === 'object') {\n    context = autoActivate;\n    autoActivate = false;\n  }\n\n  this._dragging.init(event, 'hand.move', {\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: context || {}\n    }\n  });\n};\n\nHandTool.prototype.activateHand = function(event, autoActivate, reactivate) {\n  this._dragging.init(event, 'hand', {\n    trapClick: false,\n    autoActivate: autoActivate,\n    cursor: HAND_CURSOR,\n    data: {\n      context: {\n        reactivate: reactivate\n      }\n    }\n  });\n};\n\nHandTool.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.activateHand();\n  }\n};\n\nHandTool.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  if (context) {\n    return /^(hand|hand\\.move)$/.test(context.prefix);\n  }\n\n  return false;\n};\n\n// helpers //////////\n\nfunction isSpace(keyEvent) {\n  return isKey(' ', keyEvent);\n}","import ToolManagerModule from '../tool-manager';\n\nimport HandTool from './HandTool';\n\nexport default {\n  __depends__: [\n    ToolManagerModule\n  ],\n  __init__: [ 'handTool' ],\n  handTool: [ 'type', HandTool ]\n};\n","var MARKER_OK = 'connect-ok',\n    MARKER_NOT_OK = 'connect-not-ok';\n\n/**\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Dragging} dragging\n * @param {Connect} connect\n * @param {Canvas} canvas\n * @param {ToolManager} toolManager\n * @param {Rules} rules\n */\nexport default function GlobalConnect(\n    eventBus, dragging, connect,\n    canvas, toolManager, rules) {\n\n  var self = this;\n\n  this._dragging = dragging;\n  this._rules = rules;\n\n  toolManager.registerTool('global-connect', {\n    tool: 'global-connect',\n    dragging: 'global-connect.drag'\n  });\n\n  eventBus.on('global-connect.hover', function(event) {\n    var context = event.context,\n        startTarget = event.hover;\n\n    var canStartConnect = context.canStartConnect = self.canStartConnect(startTarget);\n\n    // simply ignore hover\n    if (canStartConnect === null) {\n      return;\n    }\n\n    context.startTarget = startTarget;\n\n    canvas.addMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n  });\n\n\n  eventBus.on([ 'global-connect.out', 'global-connect.cleanup' ], function(event) {\n    var startTarget = event.context.startTarget,\n        canStartConnect = event.context.canStartConnect;\n\n    if (startTarget) {\n      canvas.removeMarker(startTarget, canStartConnect ? MARKER_OK : MARKER_NOT_OK);\n    }\n  });\n\n\n  eventBus.on([ 'global-connect.ended' ], function(event) {\n    var context = event.context,\n        startTarget = context.startTarget,\n        startPosition = {\n          x: event.x,\n          y: event.y\n        };\n\n    var canStartConnect = self.canStartConnect(startTarget);\n\n    if (!canStartConnect) {\n      return;\n    }\n\n    eventBus.once('element.out', function() {\n      eventBus.once([ 'connect.ended', 'connect.canceled' ], function() {\n        eventBus.fire('global-connect.drag.ended');\n      });\n\n      connect.start(null, startTarget, startPosition);\n    });\n\n    return false;\n  });\n}\n\nGlobalConnect.$inject = [\n  'eventBus',\n  'dragging',\n  'connect',\n  'canvas',\n  'toolManager',\n  'rules'\n];\n\n/**\n * Initiates tool activity.\n */\nGlobalConnect.prototype.start = function(event) {\n  this._dragging.init(event, 'global-connect', {\n    trapClick: false,\n    data: {\n      context: {}\n    }\n  });\n};\n\nGlobalConnect.prototype.toggle = function() {\n  if (this.isActive()) {\n    this._dragging.cancel();\n  } else {\n    this.start();\n  }\n};\n\nGlobalConnect.prototype.isActive = function() {\n  var context = this._dragging.context();\n\n  return context && /^global-connect/.test(context.prefix);\n};\n\n/**\n * Check if source shape can initiate connection.\n *\n * @param  {Shape} startTarget\n * @return {Boolean}\n */\nGlobalConnect.prototype.canStartConnect = function(startTarget) {\n  return this._rules.allowed('connection.start', { source: startTarget });\n};\n","import ConnectModule from '../connect';\nimport RulesModule from '../rules';\nimport DraggingModule from '../dragging';\nimport ToolManagerModule from '../tool-manager';\n\nimport GlobalConnect from './GlobalConnect';\n\nexport default {\n  __depends__: [\n    ConnectModule,\n    RulesModule,\n    DraggingModule,\n    ToolManagerModule\n  ],\n  globalConnect: [ 'type', GlobalConnect ]\n};\n","import {\n  assign\n} from 'min-dash';\n\n\n/**\n * A palette provider for BPMN 2.0 elements.\n */\nexport default function PaletteProvider(\n    palette, create, elementFactory,\n    spaceTool, lassoTool, handTool,\n    globalConnect, translate) {\n\n  this._palette = palette;\n  this._create = create;\n  this._elementFactory = elementFactory;\n  this._spaceTool = spaceTool;\n  this._lassoTool = lassoTool;\n  this._handTool = handTool;\n  this._globalConnect = globalConnect;\n  this._translate = translate;\n\n  palette.registerProvider(this);\n}\n\nPaletteProvider.$inject = [\n  'palette',\n  'create',\n  'elementFactory',\n  'spaceTool',\n  'lassoTool',\n  'handTool',\n  'globalConnect',\n  'translate'\n];\n\n\nPaletteProvider.prototype.getPaletteEntries = function(element) {\n\n  var actions = {},\n      create = this._create,\n      elementFactory = this._elementFactory,\n      spaceTool = this._spaceTool,\n      lassoTool = this._lassoTool,\n      handTool = this._handTool,\n      globalConnect = this._globalConnect,\n      translate = this._translate;\n\n  function createAction(type, group, className, title, options) {\n\n    function createListener(event) {\n      var shape = elementFactory.createShape(assign({ type: type }, options));\n\n      if (options) {\n        shape.businessObject.di.isExpanded = options.isExpanded;\n      }\n\n      create.start(event, shape);\n    }\n\n    var shortType = type.replace(/^bpmn:/, '');\n\n    return {\n      group: group,\n      className: className,\n      title: title || translate('Create {type}', { type: shortType }),\n      action: {\n        dragstart: createListener,\n        click: createListener\n      }\n    };\n  }\n\n  function createSubprocess(event) {\n    var subProcess = elementFactory.createShape({\n      type: 'bpmn:SubProcess',\n      x: 0,\n      y: 0,\n      isExpanded: true\n    });\n\n    var startEvent = elementFactory.createShape({\n      type: 'bpmn:StartEvent',\n      x: 40,\n      y: 82,\n      parent: subProcess\n    });\n\n    create.start(event, [ subProcess, startEvent ], {\n      hints: {\n        autoSelect: [ startEvent ]\n      }\n    });\n  }\n\n  function createParticipant(event) {\n    create.start(event, elementFactory.createParticipantShape());\n  }\n\n  assign(actions, {\n    'hand-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-hand-tool',\n      title: translate('Activate the hand tool'),\n      action: {\n        click: function(event) {\n          handTool.activateHand(event);\n        }\n      }\n    },\n    'lasso-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-lasso-tool',\n      title: translate('Activate the lasso tool'),\n      action: {\n        click: function(event) {\n          lassoTool.activateSelection(event);\n        }\n      }\n    },\n    'space-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-space-tool',\n      title: translate('Activate the create/remove space tool'),\n      action: {\n        click: function(event) {\n          spaceTool.activateSelection(event);\n        }\n      }\n    },\n    'global-connect-tool': {\n      group: 'tools',\n      className: 'bpmn-icon-connection-multi',\n      title: translate('Activate the global connect tool'),\n      action: {\n        click: function(event) {\n          globalConnect.toggle(event);\n        }\n      }\n    },\n    'tool-separator': {\n      group: 'tools',\n      separator: true\n    },\n    'create.start-event': createAction(\n      'bpmn:StartEvent', 'event', 'bpmn-icon-start-event-none',\n      translate('Create StartEvent')\n    ),\n    'create.intermediate-event': createAction(\n      'bpmn:IntermediateThrowEvent', 'event', 'bpmn-icon-intermediate-event-none',\n      translate('Create Intermediate/Boundary Event')\n    ),\n    'create.end-event': createAction(\n      'bpmn:EndEvent', 'event', 'bpmn-icon-end-event-none',\n      translate('Create EndEvent')\n    ),\n    'create.exclusive-gateway': createAction(\n      'bpmn:ExclusiveGateway', 'gateway', 'bpmn-icon-gateway-none',\n      translate('Create Gateway')\n    ),\n    'create.task': createAction(\n      'bpmn:Task', 'activity', 'bpmn-icon-task',\n      translate('Create Task')\n    ),\n    'create.data-object': createAction(\n      'bpmn:DataObjectReference', 'data-object', 'bpmn-icon-data-object',\n      translate('Create DataObjectReference')\n    ),\n    'create.data-store': createAction(\n      'bpmn:DataStoreReference', 'data-store', 'bpmn-icon-data-store',\n      translate('Create DataStoreReference')\n    ),\n    'create.subprocess-expanded': {\n      group: 'activity',\n      className: 'bpmn-icon-subprocess-expanded',\n      title: translate('Create expanded SubProcess'),\n      action: {\n        dragstart: createSubprocess,\n        click: createSubprocess\n      }\n    },\n    'create.participant-expanded': {\n      group: 'collaboration',\n      className: 'bpmn-icon-participant',\n      title: translate('Create Pool/Participant'),\n      action: {\n        dragstart: createParticipant,\n        click: createParticipant\n      }\n    },\n    'create.group': createAction(\n      'bpmn:Group', 'artifact', 'bpmn-icon-group',\n      translate('Create Group')\n    ),\n  });\n\n  return actions;\n};\n","import PaletteModule from 'diagram-js/lib/features/palette';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport SpaceToolModule from 'diagram-js/lib/features/space-tool';\nimport LassoToolModule from 'diagram-js/lib/features/lasso-tool';\nimport HandToolModule from 'diagram-js/lib/features/hand-tool';\nimport GlobalConnectModule from 'diagram-js/lib/features/global-connect';\nimport translate from 'diagram-js/lib/i18n/translate';\n\nimport PaletteProvider from './PaletteProvider';\n\nexport default {\n  __depends__: [\n    PaletteModule,\n    CreateModule,\n    SpaceToolModule,\n    LassoToolModule,\n    HandToolModule,\n    GlobalConnectModule,\n    translate\n  ],\n  __init__: [ 'paletteProvider' ],\n  paletteProvider: [ 'type', PaletteProvider ]\n};\n","import CommandInterceptor from 'diagram-js/lib/command/CommandInterceptor';\n\nimport inherits from 'inherits';\n\nimport cssEscape from 'css.escape';\n\nimport {\n  assign,\n  forEach\n} from 'min-dash';\n\nimport {\n  query as domQuery\n} from 'min-dom';\n\nimport {\n  attr as svgAttr\n} from 'tiny-svg';\n\nvar LOW_PRIORITY = 250;\n\n\nexport default function BpmnReplacePreview(\n    eventBus, elementRegistry, elementFactory,\n    canvas, previewSupport) {\n\n  CommandInterceptor.call(this, eventBus);\n\n  /**\n   * Replace the visuals of all elements in the context which can be replaced\n   *\n   * @param  {Object} context\n   */\n  function replaceVisual(context) {\n\n    var replacements = context.canExecute.replacements;\n\n    forEach(replacements, function(replacement) {\n\n      var id = replacement.oldElementId;\n\n      var newElement = {\n        type: replacement.newElementType\n      };\n\n      // if the visual of the element is already replaced\n      if (context.visualReplacements[id]) {\n        return;\n      }\n\n      var element = elementRegistry.get(id);\n\n      assign(newElement, { x: element.x, y: element.y });\n\n      // create a temporary shape\n      var tempShape = elementFactory.createShape(newElement);\n\n      canvas.addShape(tempShape, element.parent);\n\n      // select the original SVG element related to the element and hide it\n      var gfx = domQuery('[data-element-id=\"' + cssEscape(element.id) + '\"]', context.dragGroup);\n\n      if (gfx) {\n        svgAttr(gfx, { display: 'none' });\n      }\n\n      // clone the gfx of the temporary shape and add it to the drag group\n      var dragger = previewSupport.addDragger(tempShape, context.dragGroup);\n\n      context.visualReplacements[id] = dragger;\n\n      canvas.removeShape(tempShape);\n    });\n  }\n\n  /**\n   * Restore the original visuals of the previously replaced elements\n   *\n   * @param  {Object} context\n   */\n  function restoreVisual(context) {\n\n    var visualReplacements = context.visualReplacements;\n\n    forEach(visualReplacements, function(dragger, id) {\n\n      var originalGfx = domQuery('[data-element-id=\"' + cssEscape(id) + '\"]', context.dragGroup);\n\n      if (originalGfx) {\n        svgAttr(originalGfx, { display: 'inline' });\n      }\n\n      dragger.remove();\n\n      if (visualReplacements[id]) {\n        delete visualReplacements[id];\n      }\n    });\n  }\n\n  eventBus.on('shape.move.move', LOW_PRIORITY, function(event) {\n\n    var context = event.context,\n        canExecute = context.canExecute;\n\n    if (!context.visualReplacements) {\n      context.visualReplacements = {};\n    }\n\n    if (canExecute && canExecute.replacements) {\n      replaceVisual(context);\n    } else {\n      restoreVisual(context);\n    }\n  });\n}\n\nBpmnReplacePreview.$inject = [\n  'eventBus',\n  'elementRegistry',\n  'elementFactory',\n  'canvas',\n  'previewSupport'\n];\n\ninherits(BpmnReplacePreview, CommandInterceptor);","import PreviewSupportModule from 'diagram-js/lib/features/preview-support';\n\nimport BpmnReplacePreview from './BpmnReplacePreview';\n\nexport default {\n  __depends__: [\n    PreviewSupportModule\n  ],\n  __init__: [ 'bpmnReplacePreview' ],\n  bpmnReplacePreview: [ 'type', BpmnReplacePreview ]\n};\n","import {\r\n  mid,\r\n  setSnapped\r\n} from 'diagram-js/lib/features/snapping/SnapUtil';\r\n\r\nimport { isCmd } from 'diagram-js/lib/features/keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  getOrientation\r\n} from 'diagram-js/lib/layout/LayoutUtil';\r\n\r\nimport { is } from '../../util/ModelUtil';\r\n\r\nimport { isAny } from '../modeling/util/ModelingUtil';\r\n\r\nimport { some } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\nvar BOUNDARY_TO_HOST_THRESHOLD = 40;\r\n\r\nvar TARGET_BOUNDS_PADDING = 20,\r\n    TASK_BOUNDS_PADDING = 10;\r\n\r\nvar TARGET_CENTER_PADDING = 20;\r\n\r\nvar AXES = [ 'x', 'y' ];\r\n\r\nvar abs = Math.abs;\r\n\r\n/**\r\n * Snap during connect.\r\n *\r\n * @param {EventBus} eventBus\r\n */\r\nexport default function BpmnConnectSnapping(eventBus) {\r\n  eventBus.on([\r\n    'connect.hover',\r\n    'connect.move',\r\n    'connect.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        canExecute = context.canExecute,\r\n        start = context.start,\r\n        hover = context.hover,\r\n        source = context.source,\r\n        target = context.target;\r\n\r\n    // do NOT snap on CMD\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (!context.initialConnectionStart) {\r\n      context.initialConnectionStart = context.connectionStart;\r\n    }\r\n\r\n    // snap hover\r\n    if (canExecute && hover) {\r\n      snapToShape(event, hover, getTargetBoundsPadding(hover));\r\n    }\r\n\r\n    if (hover && isAnyType(canExecute, [\r\n      'bpmn:Association',\r\n      'bpmn:DataInputAssociation',\r\n      'bpmn:DataOutputAssociation',\r\n      'bpmn:SequenceFlow'\r\n    ])) {\r\n      context.connectionStart = mid(start);\r\n\r\n      // snap hover\r\n      if (isAny(hover, [ 'bpmn:Event', 'bpmn:Gateway' ])) {\r\n        snapToPosition(event, mid(hover));\r\n      }\r\n\r\n      // snap hover\r\n      if (isAny(hover, [ 'bpmn:Task', 'bpmn:SubProcess' ])) {\r\n        snapToTargetMid(event, hover);\r\n      }\r\n\r\n      // snap source and target\r\n      if (is(source, 'bpmn:BoundaryEvent') && target === source.host) {\r\n        snapBoundaryEventLoop(event);\r\n      }\r\n\r\n    } else if (isType(canExecute, 'bpmn:MessageFlow')) {\r\n\r\n      if (is(start, 'bpmn:Event')) {\r\n\r\n        // snap start\r\n        context.connectionStart = mid(start);\r\n      }\r\n\r\n      if (is(hover, 'bpmn:Event')) {\r\n\r\n        // snap hover\r\n        snapToPosition(event, mid(hover));\r\n      }\r\n\r\n    } else {\r\n\r\n      // un-snap source\r\n      context.connectionStart = context.initialConnectionStart;\r\n    }\r\n  });\r\n}\r\n\r\nBpmnConnectSnapping.$inject = [ 'eventBus' ];\r\n\r\n\r\n// helpers //////////\r\n\r\n// snap to target if event in target\r\nfunction snapToShape(event, target, padding) {\r\n  AXES.forEach(function(axis) {\r\n    var dimensionForAxis = getDimensionForAxis(axis, target);\r\n\r\n    if (event[ axis ] < target[ axis ] + padding) {\r\n      setSnapped(event, axis, target[ axis ] + padding);\r\n    } else if (event[ axis ] > target[ axis ] + dimensionForAxis - padding) {\r\n      setSnapped(event, axis, target[ axis ] + dimensionForAxis - padding);\r\n    }\r\n  });\r\n}\r\n\r\n// snap to target mid if event in target mid\r\nfunction snapToTargetMid(event, target) {\r\n  var targetMid = mid(target);\r\n\r\n  AXES.forEach(function(axis) {\r\n    if (isMid(event, target, axis)) {\r\n      setSnapped(event, axis, targetMid[ axis ]);\r\n    }\r\n  });\r\n}\r\n\r\n// snap to prevent loop overlapping boundary event\r\nfunction snapBoundaryEventLoop(event) {\r\n  var context = event.context,\r\n      source = context.source,\r\n      target = context.target;\r\n\r\n  if (isReverse(context)) {\r\n    return;\r\n  }\r\n\r\n  var sourceMid = mid(source),\r\n      orientation = getOrientation(sourceMid, target, -10),\r\n      axes = [];\r\n\r\n  if (/top|bottom/.test(orientation)) {\r\n    axes.push('x');\r\n  }\r\n\r\n  if (/left|right/.test(orientation)) {\r\n    axes.push('y');\r\n  }\r\n\r\n  axes.forEach(function(axis) {\r\n    var coordinate = event[ axis ], newCoordinate;\r\n\r\n    if (abs(coordinate - sourceMid[ axis ]) < BOUNDARY_TO_HOST_THRESHOLD) {\r\n      if (coordinate > sourceMid[ axis ]) {\r\n        newCoordinate = sourceMid[ axis ] + BOUNDARY_TO_HOST_THRESHOLD;\r\n      }\r\n      else {\r\n        newCoordinate = sourceMid[ axis ] - BOUNDARY_TO_HOST_THRESHOLD;\r\n      }\r\n\r\n      setSnapped(event, axis, newCoordinate);\r\n    }\r\n  });\r\n}\r\n\r\nfunction snapToPosition(event, position) {\r\n  setSnapped(event, 'x', position.x);\r\n  setSnapped(event, 'y', position.y);\r\n}\r\n\r\nfunction isType(attrs, type) {\r\n  return attrs && attrs.type === type;\r\n}\r\n\r\nfunction isAnyType(attrs, types) {\r\n  return some(types, function(type) {\r\n    return isType(attrs, type);\r\n  });\r\n}\r\n\r\nfunction getDimensionForAxis(axis, element) {\r\n  return axis === 'x' ? element.width : element.height;\r\n}\r\n\r\nfunction getTargetBoundsPadding(target) {\r\n  if (is(target, 'bpmn:Task')) {\r\n    return TASK_BOUNDS_PADDING;\r\n  } else {\r\n    return TARGET_BOUNDS_PADDING;\r\n  }\r\n}\r\n\r\nfunction isMid(event, target, axis) {\r\n  return event[ axis ] > target[ axis ] + TARGET_CENTER_PADDING\r\n    && event[ axis ] < target[ axis ] + getDimensionForAxis(axis, target) - TARGET_CENTER_PADDING;\r\n}\r\n\r\nfunction isReverse(context) {\r\n  var hover = context.hover,\r\n      source = context.source;\r\n\r\n  return hover && source && hover === source;\r\n}","import {\n  forEach\n} from 'min-dash';\n\nimport {\n  snapTo\n} from './SnapUtil';\n\n\n/**\n * A snap context, containing the (possibly incomplete)\n * mappings of drop targets (to identify the snapping)\n * to computed snap points.\n */\nexport default function SnapContext() {\n\n  /**\n   * Map<String, SnapPoints> mapping drop targets to\n   * a list of possible snappings.\n   *\n   * @type {Object}\n   */\n  this._targets = {};\n\n  /**\n   * Map<String, Point> initial positioning of element\n   * regarding various snap directions.\n   *\n   * @type {Object}\n   */\n  this._snapOrigins = {};\n\n  /**\n   * List of snap locations\n   *\n   * @type {Array<String>}\n   */\n  this._snapLocations = [];\n\n  /**\n   * Map<String, Array<Point>> of default snapping locations\n   *\n   * @type {Object}\n   */\n  this._defaultSnaps = {};\n}\n\n\nSnapContext.prototype.getSnapOrigin = function(snapLocation) {\n  return this._snapOrigins[snapLocation];\n};\n\n\nSnapContext.prototype.setSnapOrigin = function(snapLocation, initialValue) {\n  this._snapOrigins[snapLocation] = initialValue;\n\n  if (this._snapLocations.indexOf(snapLocation) === -1) {\n    this._snapLocations.push(snapLocation);\n  }\n};\n\n\nSnapContext.prototype.addDefaultSnap = function(type, point) {\n\n  var snapValues = this._defaultSnaps[type];\n\n  if (!snapValues) {\n    snapValues = this._defaultSnaps[type] = [];\n  }\n\n  snapValues.push(point);\n};\n\n/**\n * Return a number of initialized snaps, i.e. snap locations such as\n * top-left, mid, bottom-right and so forth.\n *\n * @return {Array<String>} snapLocations\n */\nSnapContext.prototype.getSnapLocations = function() {\n  return this._snapLocations;\n};\n\n/**\n * Set the snap locations for this context.\n *\n * The order of locations determines precedence.\n *\n * @param {Array<String>} snapLocations\n */\nSnapContext.prototype.setSnapLocations = function(snapLocations) {\n  this._snapLocations = snapLocations;\n};\n\n/**\n * Get snap points for a given target\n *\n * @param {Element|String} target\n */\nSnapContext.prototype.pointsForTarget = function(target) {\n\n  var targetId = target.id || target;\n\n  var snapPoints = this._targets[targetId];\n\n  if (!snapPoints) {\n    snapPoints = this._targets[targetId] = new SnapPoints();\n    snapPoints.initDefaults(this._defaultSnaps);\n  }\n\n  return snapPoints;\n};\n\n\n/**\n * Creates the snap points and initializes them with the\n * given default values.\n *\n * @param {Object<String, Array<Point>>} [defaultPoints]\n */\nexport function SnapPoints(defaultSnaps) {\n\n  /**\n   * Map<String, Map<(x|y), Array<Number>>> mapping snap locations,\n   * i.e. top-left, bottom-right, center to actual snap values.\n   *\n   * @type {Object}\n   */\n  this._snapValues = {};\n}\n\nSnapPoints.prototype.add = function(snapLocation, point) {\n\n  var snapValues = this._snapValues[snapLocation];\n\n  if (!snapValues) {\n    snapValues = this._snapValues[snapLocation] = { x: [], y: [] };\n  }\n\n  if (snapValues.x.indexOf(point.x) === -1) {\n    snapValues.x.push(point.x);\n  }\n\n  if (snapValues.y.indexOf(point.y) === -1) {\n    snapValues.y.push(point.y);\n  }\n};\n\n\nSnapPoints.prototype.snap = function(point, snapLocation, axis, tolerance) {\n  var snappingValues = this._snapValues[snapLocation];\n\n  return snappingValues && snapTo(point[axis], snappingValues[axis], tolerance);\n};\n\n/**\n * Initialize a number of default snapping points.\n *\n * @param  {Object} defaultSnaps\n */\nSnapPoints.prototype.initDefaults = function(defaultSnaps) {\n\n  var self = this;\n\n  forEach(defaultSnaps || {}, function(snapPoints, snapLocation) {\n    forEach(snapPoints, function(point) {\n      self.add(snapLocation, point);\n    });\n  });\n};","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  getChildren,\r\n  isSnapped,\r\n  mid\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  forEach,\r\n  isNumber\r\n} from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during create and move.\r\n *\r\n * @param {EventBus} elementRegistry\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function CreateMoveSnapping(elementRegistry, eventBus, snapping) {\r\n  var self = this;\r\n\r\n  this._elementRegistry = elementRegistry;\r\n\r\n  eventBus.on([\r\n    'create.start',\r\n    'shape.move.start'\r\n  ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.move',\r\n    'create.end',\r\n    'shape.move.move',\r\n    'shape.move.end'\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        snapContext = context.snapContext,\r\n        target = context.target;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event) || !target) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(target);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, target);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([\r\n    'create.cleanup',\r\n    'shape.move.cleanup'\r\n  ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nCreateMoveSnapping.$inject = [\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nCreateMoveSnapping.prototype.initSnap = function(event) {\r\n  var elementRegistry = this._elementRegistry;\r\n\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var shapeMid;\r\n\r\n  if (elementRegistry.get(shape.id)) {\r\n\r\n    // move\r\n    shapeMid = mid(shape, event);\r\n  } else {\r\n\r\n    // create\r\n    shapeMid = {\r\n      x: event.x + mid(shape).x,\r\n      y: event.y + mid(shape).y\r\n    };\r\n  }\r\n\r\n  var shapeTopLeft = {\r\n        x: shapeMid.x - shape.width / 2,\r\n        y: shapeMid.y - shape.height / 2\r\n      },\r\n      shapeBottomRight = {\r\n        x: shapeMid.x + shape.width / 2,\r\n        y: shapeMid.y + shape.height / 2\r\n      };\r\n\r\n  snapContext.setSnapOrigin('mid', {\r\n    x: shapeMid.x - event.x,\r\n    y: shapeMid.y - event.y\r\n  });\r\n\r\n  // snap labels to mid only\r\n  if (isLabel(shape)) {\r\n    return snapContext;\r\n  }\r\n\r\n  snapContext.setSnapOrigin('top-left', {\r\n    x: shapeTopLeft.x - event.x,\r\n    y: shapeTopLeft.y - event.y\r\n  });\r\n\r\n  snapContext.setSnapOrigin('bottom-right', {\r\n    x: shapeBottomRight.x - event.x,\r\n    y: shapeBottomRight.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n\r\n    // handle labels\r\n    if (isLabel(snapTarget)) {\r\n\r\n      if (isLabel(shape)) {\r\n        snapPoints.add('mid', mid(snapTarget));\r\n      }\r\n\r\n      return;\r\n    }\r\n\r\n    // handle connections\r\n    if (isConnection(snapTarget)) {\r\n\r\n      // ignore single segment connections\r\n      if (snapTarget.waypoints.length < 3) {\r\n        return;\r\n      }\r\n\r\n      // ignore first and last waypoint\r\n      var waypoints = snapTarget.waypoints.slice(1, -1);\r\n\r\n      forEach(waypoints, function(waypoint) {\r\n        snapPoints.add('mid', waypoint);\r\n      });\r\n\r\n      return;\r\n    }\r\n\r\n    // handle shapes\r\n    snapPoints.add('mid', mid(snapTarget));\r\n  });\r\n\r\n  if (!isNumber(shape.x) || !isNumber(shape.y)) {\r\n    return snapPoints;\r\n  }\r\n\r\n  // snap to original position when moving\r\n  if (this._elementRegistry.get(shape.id)) {\r\n    snapPoints.add('mid', mid(shape));\r\n  }\r\n\r\n  return snapPoints;\r\n};\r\n\r\nCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isHidden(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}","import inherits from 'inherits';\n\nimport CreateMoveSnapping from 'diagram-js/lib/features/snapping/CreateMoveSnapping';\n\nimport {\n  isSnapped,\n  setSnapped,\n  topLeft,\n  bottomRight\n} from 'diagram-js/lib/features/snapping/SnapUtil';\n\nimport { isExpanded } from '../../util/DiUtil';\n\nimport { is } from '../../util/ModelUtil';\n\nimport {\n  asTRBL,\n  getMid\n} from 'diagram-js/lib/layout/LayoutUtil';\n\nimport { getBoundaryAttachment } from './BpmnSnappingUtil';\n\nimport { forEach } from 'min-dash';\n\nvar HIGH_PRIORITY = 1500;\n\n\n/**\n * Snap during create and move.\n *\n * @param {EventBus} eventBus\n * @param {Injector} injector\n */\nexport default function BpmnCreateMoveSnapping(eventBus, injector) {\n  injector.invoke(CreateMoveSnapping, this);\n\n  // creating first participant\n  eventBus.on([ 'create.move', 'create.end' ], HIGH_PRIORITY, setSnappedIfConstrained);\n\n  // snap boundary events\n  eventBus.on([\n    'create.move',\n    'create.end',\n    'shape.move.move',\n    'shape.move.end'\n  ], HIGH_PRIORITY, function(event) {\n    var context = event.context,\n        canExecute = context.canExecute,\n        target = context.target;\n\n    var canAttach = canExecute && (canExecute === 'attach' || canExecute.attach);\n\n    if (canAttach && !isSnapped(event)) {\n      snapBoundaryEvent(event, target);\n    }\n  });\n}\n\ninherits(BpmnCreateMoveSnapping, CreateMoveSnapping);\n\nBpmnCreateMoveSnapping.$inject = [\n  'eventBus',\n  'injector'\n];\n\nBpmnCreateMoveSnapping.prototype.initSnap = function(event) {\n  var snapContext = CreateMoveSnapping.prototype.initSnap.call(this, event);\n\n  var shape = event.shape;\n\n  var isMove = !!this._elementRegistry.get(shape.id);\n\n  // snap to docking points\n  forEach(shape.outgoing, function(connection) {\n    var docking = connection.waypoints[0];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', getDockingSnapOrigin(docking, isMove, event));\n  });\n\n  forEach(shape.incoming, function(connection) {\n    var docking = connection.waypoints[connection.waypoints.length - 1];\n\n    docking = docking.original || docking;\n\n    snapContext.setSnapOrigin(connection.id + '-docking', getDockingSnapOrigin(docking, isMove, event));\n  });\n\n  if (is(shape, 'bpmn:Participant')) {\n\n    // snap to borders with higher priority\n    snapContext.setSnapLocations([ 'top-left', 'bottom-right', 'mid' ]);\n  }\n\n  return snapContext;\n};\n\nBpmnCreateMoveSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target) {\n  CreateMoveSnapping.prototype.addSnapTargetPoints.call(this, snapPoints, shape, target);\n\n  var snapTargets = this.getSnapTargets(shape, target);\n\n  forEach(snapTargets, function(snapTarget) {\n\n    // handle TRBL alignment\n    //\n    // * with container elements\n    // * with text annotations\n    if (isContainer(snapTarget) || areAll([ shape, snapTarget ], 'bpmn:TextAnnotation')) {\n      snapPoints.add('top-left', topLeft(snapTarget));\n      snapPoints.add('bottom-right', bottomRight(snapTarget));\n    }\n  });\n\n  var elementRegistry = this._elementRegistry;\n\n  // snap to docking points if not create mode\n  forEach(shape.incoming, function(connection) {\n    if (elementRegistry.get(shape.id)) {\n\n      if (!includes(snapTargets, connection.source)) {\n        snapPoints.add('mid', getMid(connection.source));\n      }\n\n      var docking = connection.waypoints[0];\n      snapPoints.add(connection.id + '-docking', docking.original || docking);\n    }\n  });\n\n  forEach(shape.outgoing, function(connection) {\n    if (elementRegistry.get(shape.id)) {\n\n      if (!includes(snapTargets, connection.target)) {\n        snapPoints.add('mid', getMid(connection.target));\n      }\n\n      var docking = connection.waypoints[ connection.waypoints.length - 1 ];\n\n      snapPoints.add(connection.id + '-docking', docking.original || docking);\n    }\n  });\n\n  // add sequence flow parents as snap targets\n  if (is(target, 'bpmn:SequenceFlow')) {\n    snapPoints = this.addSnapTargetPoints(snapPoints, shape, target.parent);\n  }\n\n  return snapPoints;\n};\n\nBpmnCreateMoveSnapping.prototype.getSnapTargets = function(shape, target) {\n  return CreateMoveSnapping.prototype.getSnapTargets.call(this, shape, target)\n    .filter(function(snapTarget) {\n\n      // do not snap to lanes\n      return !is(snapTarget, 'bpmn:Lane');\n    });\n};\n\n// helpers //////////\n\nfunction snapBoundaryEvent(event, target) {\n  var targetTRBL = asTRBL(target);\n\n  var direction = getBoundaryAttachment(event, target);\n\n  var context = event.context,\n      shape = context.shape;\n\n  var offset;\n\n  if (shape.parent) {\n    offset = { x: 0, y: 0 };\n  } else {\n    offset = getMid(shape);\n  }\n\n  if (/top/.test(direction)) {\n    setSnapped(event, 'y', targetTRBL.top - offset.y);\n  } else if (/bottom/.test(direction)) {\n    setSnapped(event, 'y', targetTRBL.bottom - offset.y);\n  }\n\n  if (/left/.test(direction)) {\n    setSnapped(event, 'x', targetTRBL.left - offset.x);\n  } else if (/right/.test(direction)) {\n    setSnapped(event, 'x', targetTRBL.right - offset.x);\n  }\n}\n\nfunction areAll(elements, type) {\n  return elements.every(function(el) {\n    return is(el, type);\n  });\n}\n\nfunction isContainer(element) {\n  if (is(element, 'bpmn:SubProcess') && isExpanded(element)) {\n    return true;\n  }\n\n  return is(element, 'bpmn:Participant');\n}\n\n\nfunction setSnappedIfConstrained(event) {\n  var context = event.context,\n      createConstraints = context.createConstraints;\n\n  if (!createConstraints) {\n    return;\n  }\n\n  var top = createConstraints.top,\n      right = createConstraints.right,\n      bottom = createConstraints.bottom,\n      left = createConstraints.left;\n\n  if ((left && left >= event.x) || (right && right <= event.x)) {\n    setSnapped(event, 'x', event.x);\n  }\n\n  if ((top && top >= event.y) || (bottom && bottom <= event.y)) {\n    setSnapped(event, 'y', event.y);\n  }\n}\n\nfunction includes(array, value) {\n  return array.indexOf(value) !== -1;\n}\n\nfunction getDockingSnapOrigin(docking, isMove, event) {\n  return isMove ? (\n    {\n      x: docking.x - event.x,\n      y: docking.y - event.y\n    }\n  ) : {\n    x: docking.x,\n    y: docking.y\n  };\n}\n","import SnapContext from './SnapContext';\r\n\r\nimport {\r\n  bottomRight,\r\n  getChildren,\r\n  isSnapped,\r\n  setSnapped,\r\n  topLeft,\r\n} from './SnapUtil';\r\n\r\nimport { isCmd } from '../keyboard/KeyboardUtil';\r\n\r\nimport {\r\n  asTRBL,\r\n  getMid\r\n} from '../../layout/LayoutUtil';\r\n\r\nimport { forEach } from 'min-dash';\r\n\r\nvar HIGHER_PRIORITY = 1250;\r\n\r\n\r\n/**\r\n * Snap during resize.\r\n *\r\n * @param {EventBus} eventBus\r\n * @param {Snapping} snapping\r\n */\r\nexport default function ResizeSnapping(eventBus, snapping) {\r\n  var self = this;\r\n\r\n  eventBus.on([ 'resize.start' ], function(event) {\r\n    self.initSnap(event);\r\n  });\r\n\r\n  eventBus.on([\r\n    'resize.move',\r\n    'resize.end',\r\n  ], HIGHER_PRIORITY, function(event) {\r\n    var context = event.context,\r\n        shape = context.shape,\r\n        parent = shape.parent,\r\n        direction = context.direction,\r\n        snapContext = context.snapContext;\r\n\r\n    if (event.originalEvent && isCmd(event.originalEvent)) {\r\n      return;\r\n    }\r\n\r\n    if (isSnapped(event)) {\r\n      return;\r\n    }\r\n\r\n    var snapPoints = snapContext.pointsForTarget(parent);\r\n\r\n    if (!snapPoints.initialized) {\r\n      snapPoints = self.addSnapTargetPoints(snapPoints, shape, parent, direction);\r\n\r\n      snapPoints.initialized = true;\r\n    }\r\n\r\n    if (isHorizontal(direction)) {\r\n      setSnapped(event, 'x', event.x);\r\n    }\r\n\r\n    if (isVertical(direction)) {\r\n      setSnapped(event, 'y', event.y);\r\n    }\r\n\r\n    snapping.snap(event, snapPoints);\r\n  });\r\n\r\n  eventBus.on([ 'resize.cleanup' ], function() {\r\n    snapping.hide();\r\n  });\r\n}\r\n\r\nResizeSnapping.prototype.initSnap = function(event) {\r\n  var context = event.context,\r\n      shape = context.shape,\r\n      direction = context.direction,\r\n      snapContext = context.snapContext;\r\n\r\n  if (!snapContext) {\r\n    snapContext = context.snapContext = new SnapContext();\r\n  }\r\n\r\n  var snapOrigin = getSnapOrigin(shape, direction);\r\n\r\n  snapContext.setSnapOrigin('corner', {\r\n    x: snapOrigin.x - event.x,\r\n    y: snapOrigin.y - event.y\r\n  });\r\n\r\n  return snapContext;\r\n};\r\n\r\nResizeSnapping.prototype.addSnapTargetPoints = function(snapPoints, shape, target, direction) {\r\n  var snapTargets = this.getSnapTargets(shape, target);\r\n\r\n  forEach(snapTargets, function(snapTarget) {\r\n    snapPoints.add('corner', bottomRight(snapTarget));\r\n    snapPoints.add('corner', topLeft(snapTarget));\r\n  });\r\n\r\n  snapPoints.add('corner', getSnapOrigin(shape, direction));\r\n\r\n  return snapPoints;\r\n};\r\n\r\nResizeSnapping.$inject = [\r\n  'eventBus',\r\n  'snapping'\r\n];\r\n\r\nResizeSnapping.prototype.getSnapTargets = function(shape, target) {\r\n  return getChildren(target).filter(function(child) {\r\n    return !isAttached(child, shape)\r\n      && !isConnection(child)\r\n      && !isHidden(child)\r\n      && !isLabel(child);\r\n  });\r\n};\r\n\r\n// helpers //////////\r\n\r\nfunction getSnapOrigin(shape, direction) {\r\n  var mid = getMid(shape),\r\n      trbl = asTRBL(shape);\r\n\r\n  var snapOrigin = {\r\n    x: mid.x,\r\n    y: mid.y\r\n  };\r\n\r\n  if (direction.indexOf('n') !== -1) {\r\n    snapOrigin.y = trbl.top;\r\n  } else if (direction.indexOf('s') !== -1) {\r\n    snapOrigin.y = trbl.bottom;\r\n  }\r\n\r\n  if (direction.indexOf('e') !== -1) {\r\n    snapOrigin.x = trbl.right;\r\n  } else if (direction.indexOf('w') !== -1) {\r\n    snapOrigin.x = trbl.left;\r\n  }\r\n\r\n  return snapOrigin;\r\n}\r\n\r\nfunction isAttached(element, host) {\r\n  return element.host === host;\r\n}\r\n\r\nfunction isConnection(element) {\r\n  return !!element.waypoints;\r\n}\r\n\r\nfunction isHidden(element) {\r\n  return !!element.hidden;\r\n}\r\n\r\nfunction isLabel(element) {\r\n  return !!element.labelTarget;\r\n}\r\n\r\nfunction isHorizontal(direction) {\r\n  return direction === 'n' || direction === 's';\r\n}\r\n\r\nfunction isVertical(direction) {\r\n  return direction === 'e' || direction === 'w';\r\n}","import {\n  bind,\n  debounce,\n  forEach,\n  isNumber,\n  isObject\n} from 'min-dash';\n\nimport {\n  isSnapped,\n  setSnapped\n} from './SnapUtil';\n\nimport {\n  append as svgAppend,\n  attr as svgAttr,\n  classes as svgClasses,\n  create as svgCreate\n} from 'tiny-svg';\n\nvar SNAP_TOLERANCE = 7;\n\nexport var SNAP_LINE_HIDE_DELAY = 1000;\n\n\n/**\n * Generic snapping feature.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n */\nexport default function Snapping(canvas) {\n  this._canvas = canvas;\n\n  // delay hide by 1000 seconds since last snap\n  this._asyncHide = debounce(bind(this.hide, this), SNAP_LINE_HIDE_DELAY);\n}\n\nSnapping.$inject = [ 'canvas' ];\n\n/**\n * Snap an event to given snap points.\n *\n * @param {Event} event\n * @param {SnapPoints} snapPoints\n */\nSnapping.prototype.snap = function(event, snapPoints) {\n  var context = event.context,\n      snapContext = context.snapContext,\n      snapLocations = snapContext.getSnapLocations();\n\n  var snapping = {\n    x: isSnapped(event, 'x'),\n    y: isSnapped(event, 'y')\n  };\n\n  forEach(snapLocations, function(location) {\n    var snapOrigin = snapContext.getSnapOrigin(location);\n\n    var snapCurrent = {\n      x: event.x + snapOrigin.x,\n      y: event.y + snapOrigin.y\n    };\n\n    // snap both axis if not snapped already\n    forEach([ 'x', 'y' ], function(axis) {\n      var locationSnapping;\n\n      if (!snapping[axis]) {\n        locationSnapping = snapPoints.snap(snapCurrent, location, axis, SNAP_TOLERANCE);\n\n        if (locationSnapping !== undefined) {\n          snapping[axis] = {\n            value: locationSnapping,\n            originValue: locationSnapping - snapOrigin[axis]\n          };\n        }\n      }\n    });\n\n    // no need to continue snapping\n    if (snapping.x && snapping.y) {\n      return false;\n    }\n  });\n\n  // show snap lines\n  this.showSnapLine('vertical', snapping.x && snapping.x.value);\n  this.showSnapLine('horizontal', snapping.y && snapping.y.value);\n\n  // snap event\n  forEach([ 'x', 'y' ], function(axis) {\n    var axisSnapping = snapping[axis];\n\n    if (isObject(axisSnapping)) {\n      setSnapped(event, axis, axisSnapping.originValue);\n    }\n  });\n};\n\nSnapping.prototype._createLine = function(orientation) {\n  var root = this._canvas.getLayer('snap');\n\n  var line = svgCreate('path');\n\n  svgAttr(line, { d: 'M0,0 L0,0' });\n\n  svgClasses(line).add('djs-snap-line');\n\n  svgAppend(root, line);\n\n  return {\n    update: function(position) {\n\n      if (!isNumber(position)) {\n        svgAttr(line, { display: 'none' });\n      } else {\n        if (orientation === 'horizontal') {\n          svgAttr(line, {\n            d: 'M-100000,' + position + ' L+100000,' + position,\n            display: ''\n          });\n        } else {\n          svgAttr(line, {\n            d: 'M ' + position + ',-100000 L ' + position + ', +100000',\n            display: ''\n          });\n        }\n      }\n    }\n  };\n};\n\nSnapping.prototype._createSnapLines = function() {\n  this._snapLines = {\n    horizontal: this._createLine('horizontal'),\n    vertical: this._createLine('vertical')\n  };\n};\n\nSnapping.prototype.showSnapLine = function(orientation, position) {\n\n  var line = this.getSnapLine(orientation);\n\n  if (line) {\n    line.update(position);\n  }\n\n  this._asyncHide();\n};\n\nSnapping.prototype.getSnapLine = function(orientation) {\n  if (!this._snapLines) {\n    this._createSnapLines();\n  }\n\n  return this._snapLines[orientation];\n};\n\nSnapping.prototype.hide = function() {\n  forEach(this._snapLines, function(snapLine) {\n    snapLine.update();\n  });\n};\n","import CreateMoveSnapping from './CreateMoveSnapping';\nimport ResizeSnapping from './ResizeSnapping';\nimport Snapping from './Snapping';\n\nexport default {\n  __init__: [\n    'createMoveSnapping',\n    'resizeSnapping',\n    'snapping'\n  ],\n  createMoveSnapping: [ 'type', CreateMoveSnapping ],\n  resizeSnapping: [ 'type', ResizeSnapping ],\n  snapping: [ 'type', Snapping ]\n};","import BpmnConnectSnapping from './BpmnConnectSnapping';\nimport BpmnCreateMoveSnapping from './BpmnCreateMoveSnapping';\nimport SnappingModule from 'diagram-js/lib/features/snapping';\n\nexport default {\n  __depends__: [ SnappingModule ],\n  __init__: [\n    'connectSnapping',\n    'createMoveSnapping'\n  ],\n  connectSnapping: [ 'type', BpmnConnectSnapping ],\n  createMoveSnapping: [ 'type', BpmnCreateMoveSnapping ]\n};","import {\n  clear as domClear,\n  delegate as domDelegate,\n  query as domQuery,\n  classes as domClasses,\n  attr as domAttr,\n  domify as domify\n} from 'min-dom';\n\nimport {\n  getBBox as getBoundingBox\n} from '../../util/Elements';\n\nimport {\n  escapeHTML\n} from '../../util/EscapeUtil';\n\n/**\n * Provides searching infrastructure\n */\nexport default function SearchPad(canvas, eventBus, overlays, selection) {\n  this._open = false;\n  this._results = [];\n  this._eventMaps = [];\n\n  this._canvas = canvas;\n  this._eventBus = eventBus;\n  this._overlays = overlays;\n  this._selection = selection;\n\n  // setup elements\n  this._container = domify(SearchPad.BOX_HTML);\n  this._searchInput = domQuery(SearchPad.INPUT_SELECTOR, this._container);\n  this._resultsContainer = domQuery(SearchPad.RESULTS_CONTAINER_SELECTOR, this._container);\n\n  // attach search pad\n  this._canvas.getContainer().appendChild(this._container);\n\n  // cleanup on destroy\n  eventBus.on([ 'canvas.destroy', 'diagram.destroy' ], this.close, this);\n}\n\n\nSearchPad.$inject = [\n  'canvas',\n  'eventBus',\n  'overlays',\n  'selection'\n];\n\n\n/**\n * Binds and keeps track of all event listereners\n */\nSearchPad.prototype._bindEvents = function() {\n  var self = this;\n\n  function listen(el, selector, type, fn) {\n    self._eventMaps.push({\n      el: el,\n      type: type,\n      listener: domDelegate.bind(el, selector, type, fn)\n    });\n  }\n\n  // close search on clicking anywhere outside\n  listen(document, 'html', 'click', function(e) {\n    self.close();\n  });\n\n  // stop event from propagating and closing search\n  // focus on input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    e.delegateTarget.focus();\n  });\n\n  // preselect result on hover\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'mouseover', function(e) {\n    e.stopPropagation();\n    self._scrollToNode(e.delegateTarget);\n    self._preselect(e.delegateTarget);\n  });\n\n  // selects desired result on mouse click\n  listen(this._container, SearchPad.RESULT_SELECTOR, 'click', function(e) {\n    e.stopPropagation();\n    self._select(e.delegateTarget);\n  });\n\n  // prevent cursor in input from going left and right when using up/down to\n  // navigate results\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keydown', function(e) {\n\n    // up\n    if (e.keyCode === 38) {\n      e.preventDefault();\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      e.preventDefault();\n    }\n  });\n\n  // handle keyboard input\n  listen(this._container, SearchPad.INPUT_SELECTOR, 'keyup', function(e) {\n\n    // escape\n    if (e.keyCode === 27) {\n      return self.close();\n    }\n\n    // enter\n    if (e.keyCode === 13) {\n      var selected = self._getCurrentResult();\n\n      return selected ? self._select(selected) : self.close();\n    }\n\n    // up\n    if (e.keyCode === 38) {\n      return self._scrollToDirection(true);\n    }\n\n    // down\n    if (e.keyCode === 40) {\n      return self._scrollToDirection();\n    }\n\n    // left && right\n    // do not search while navigating text input\n    if (e.keyCode === 37 || e.keyCode === 39) {\n      return;\n    }\n\n    // anything else\n    self._search(e.delegateTarget.value);\n  });\n};\n\n\n/**\n * Unbinds all previously established listeners\n */\nSearchPad.prototype._unbindEvents = function() {\n  this._eventMaps.forEach(function(m) {\n    domDelegate.unbind(m.el, m.type, m.listener);\n  });\n};\n\n\n/**\n * Performs a search for the given pattern.\n *\n * @param  {String} pattern\n */\nSearchPad.prototype._search = function(pattern) {\n  var self = this;\n\n  this._clearResults();\n\n  // do not search on empty query\n  if (!pattern || pattern === '') {\n    return;\n  }\n\n  var searchResults = this._searchProvider.find(pattern);\n\n  if (!searchResults.length) {\n    return;\n  }\n\n  // append new results\n  searchResults.forEach(function(result) {\n    var id = result.element.id;\n    var node = self._createResultNode(result, id);\n    self._results[id] = {\n      element: result.element,\n      node: node\n    };\n  });\n\n  // preselect first result\n  var node = domQuery(SearchPad.RESULT_SELECTOR, this._resultsContainer);\n  this._scrollToNode(node);\n  this._preselect(node);\n};\n\n\n/**\n * Navigate to the previous/next result. Defaults to next result.\n * @param  {Boolean} previous\n */\nSearchPad.prototype._scrollToDirection = function(previous) {\n  var selected = this._getCurrentResult();\n  if (!selected) {\n    return;\n  }\n\n  var node = previous ? selected.previousElementSibling : selected.nextElementSibling;\n  if (node) {\n    this._scrollToNode(node);\n    this._preselect(node);\n  }\n};\n\n\n/**\n * Scroll to the node if it is not visible.\n *\n * @param  {Element} node\n */\nSearchPad.prototype._scrollToNode = function(node) {\n  if (!node || node === this._getCurrentResult()) {\n    return;\n  }\n\n  var nodeOffset = node.offsetTop;\n  var containerScroll = this._resultsContainer.scrollTop;\n\n  var bottomScroll = nodeOffset - this._resultsContainer.clientHeight + node.clientHeight;\n\n  if (nodeOffset < containerScroll) {\n    this._resultsContainer.scrollTop = nodeOffset;\n  } else if (containerScroll < bottomScroll) {\n    this._resultsContainer.scrollTop = bottomScroll;\n  }\n};\n\n\n/**\n * Clears all results data.\n */\nSearchPad.prototype._clearResults = function() {\n  domClear(this._resultsContainer);\n\n  this._results = [];\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.cleared');\n};\n\n\n/**\n * Get currently selected result.\n *\n * @return {Element}\n */\nSearchPad.prototype._getCurrentResult = function() {\n  return domQuery(SearchPad.RESULT_SELECTED_SELECTOR, this._resultsContainer);\n};\n\n\n/**\n * Create result DOM element within results container\n * that corresponds to a search result.\n *\n * 'result' : one of the elements returned by SearchProvider\n * 'id' : id attribute value to assign to the new DOM node\n * return : created DOM element\n *\n * @param  {SearchResult} result\n * @param  {String} id\n * @return {Element}\n */\nSearchPad.prototype._createResultNode = function(result, id) {\n  var node = domify(SearchPad.RESULT_HTML);\n\n  // create only if available\n  if (result.primaryTokens.length > 0) {\n    createInnerTextNode(node, result.primaryTokens, SearchPad.RESULT_PRIMARY_HTML);\n  }\n\n  // secondary tokens (represent element ID) are allways available\n  createInnerTextNode(node, result.secondaryTokens, SearchPad.RESULT_SECONDARY_HTML);\n\n  domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE, id);\n\n  this._resultsContainer.appendChild(node);\n\n  return node;\n};\n\n\n/**\n * Register search element provider.\n *\n * SearchProvider.find - provides search function over own elements\n *  (pattern) => [{ text: <String>, element: <Element>}, ...]\n *\n * @param  {SearchProvider} provider\n */\nSearchPad.prototype.registerProvider = function(provider) {\n  this._searchProvider = provider;\n};\n\n\n/**\n * Open search pad.\n */\nSearchPad.prototype.open = function() {\n  if (!this._searchProvider) {\n    throw new Error('no search provider registered');\n  }\n\n  if (this.isOpen()) {\n    return;\n  }\n\n  this._bindEvents();\n\n  this._open = true;\n\n  domClasses(this._container).add('open');\n\n  this._searchInput.focus();\n\n  this._eventBus.fire('searchPad.opened');\n};\n\n\n/**\n * Close search pad.\n */\nSearchPad.prototype.close = function() {\n  if (!this.isOpen()) {\n    return;\n  }\n\n  this._unbindEvents();\n\n  this._open = false;\n\n  domClasses(this._container).remove('open');\n\n  this._clearResults();\n\n  this._searchInput.value = '';\n  this._searchInput.blur();\n\n  this._resetOverlay();\n\n  this._eventBus.fire('searchPad.closed');\n};\n\n\n/**\n * Toggles search pad on/off.\n */\nSearchPad.prototype.toggle = function() {\n  this.isOpen() ? this.close() : this.open();\n};\n\n\n/**\n * Report state of search pad.\n */\nSearchPad.prototype.isOpen = function() {\n  return this._open;\n};\n\n\n/**\n * Preselect result entry.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._preselect = function(node) {\n  var selectedNode = this._getCurrentResult();\n\n  // already selected\n  if (node === selectedNode) {\n    return;\n  }\n\n  // removing preselection from current node\n  if (selectedNode) {\n    domClasses(selectedNode).remove(SearchPad.RESULT_SELECTED_CLASS);\n  }\n\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  domClasses(node).add(SearchPad.RESULT_SELECTED_CLASS);\n\n  this._resetOverlay(element);\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.preselected', element);\n};\n\n\n/**\n * Select result node.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._select = function(node) {\n  var id = domAttr(node, SearchPad.RESULT_ID_ATTRIBUTE);\n  var element = this._results[id].element;\n\n  this.close();\n\n  this._resetOverlay();\n\n  this._centerViewbox(element);\n\n  this._selection.select(element);\n\n  this._eventBus.fire('searchPad.selected', element);\n};\n\n\n/**\n * Center viewbox on the element middle point.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._centerViewbox = function(element) {\n  var viewbox = this._canvas.viewbox();\n\n  var box = getBoundingBox(element);\n\n  var newViewbox = {\n    x: (box.x + box.width/2) - viewbox.outer.width/2,\n    y: (box.y + box.height/2) - viewbox.outer.height/2,\n    width: viewbox.outer.width,\n    height: viewbox.outer.height\n  };\n\n  this._canvas.viewbox(newViewbox);\n\n  this._canvas.zoom(viewbox.scale);\n};\n\n\n/**\n * Reset overlay removes and, optionally, set\n * overlay to a new element.\n *\n * @param  {Element} element\n */\nSearchPad.prototype._resetOverlay = function(element) {\n  if (this._overlayId) {\n    this._overlays.remove(this._overlayId);\n  }\n\n  if (element) {\n    var box = getBoundingBox(element);\n    var overlay = constructOverlay(box);\n    this._overlayId = this._overlays.add(element, overlay);\n  }\n};\n\n\n/**\n * Construct overlay object for the given bounding box.\n *\n * @param  {BoundingBox} box\n * @return {Object}\n */\nfunction constructOverlay(box) {\n\n  var offset = 6;\n  var w = box.width + offset * 2;\n  var h = box.height + offset * 2;\n\n  var styles = [\n    'width: '+ w +'px',\n    'height: '+ h + 'px'\n  ].join('; ');\n\n  return {\n    position: {\n      bottom: h - offset,\n      right: w - offset\n    },\n    show: true,\n    html: '<div style=\"' + styles + '\" class=\"' + SearchPad.OVERLAY_CLASS + '\"></div>'\n  };\n}\n\n\n/**\n * Creates and appends child node from result tokens and HTML template.\n *\n * @param  {Element} node\n * @param  {Array<Object>} tokens\n * @param  {String} template\n */\nfunction createInnerTextNode(parentNode, tokens, template) {\n  var text = createHtmlText(tokens);\n  var childNode = domify(template);\n  childNode.innerHTML = text;\n  parentNode.appendChild(childNode);\n}\n\n/**\n * Create internal HTML markup from result tokens.\n * Caters for highlighting pattern matched tokens.\n *\n * @param  {Array<Object>} tokens\n * @return {String}\n */\nfunction createHtmlText(tokens) {\n  var htmlText = '';\n\n  tokens.forEach(function(t) {\n    if (t.matched) {\n      htmlText += '<strong class=\"' + SearchPad.RESULT_HIGHLIGHT_CLASS + '\">' + escapeHTML(t.matched) + '</strong>';\n    } else {\n      htmlText += escapeHTML(t.normal);\n    }\n  });\n\n  return htmlText !== '' ? htmlText : null;\n}\n\n\n/**\n * CONSTANTS\n */\nSearchPad.CONTAINER_SELECTOR = '.djs-search-container';\nSearchPad.INPUT_SELECTOR = '.djs-search-input input';\nSearchPad.RESULTS_CONTAINER_SELECTOR = '.djs-search-results';\nSearchPad.RESULT_SELECTOR = '.djs-search-result';\nSearchPad.RESULT_SELECTED_CLASS = 'djs-search-result-selected';\nSearchPad.RESULT_SELECTED_SELECTOR = '.' + SearchPad.RESULT_SELECTED_CLASS;\nSearchPad.RESULT_ID_ATTRIBUTE = 'data-result-id';\nSearchPad.RESULT_HIGHLIGHT_CLASS = 'djs-search-highlight';\nSearchPad.OVERLAY_CLASS = 'djs-search-overlay';\n\nSearchPad.BOX_HTML =\n  '<div class=\"djs-search-container djs-draggable djs-scrollable\">' +\n    '<div class=\"djs-search-input\">' +\n      '<input type=\"text\"/>' +\n    '</div>' +\n    '<div class=\"djs-search-results\"></div>' +\n  '</div>';\n\nSearchPad.RESULT_HTML =\n  '<div class=\"djs-search-result\"></div>';\n\nSearchPad.RESULT_PRIMARY_HTML =\n  '<div class=\"djs-search-result-primary\"></div>';\n\nSearchPad.RESULT_SECONDARY_HTML =\n  '<p class=\"djs-search-result-secondary\"></p>';\n","import OverlaysModule from '../overlays';\nimport SelectionModule from '../selection';\n\nimport SearchPad from './SearchPad';\n\nexport default {\n  __depends__: [\n    OverlaysModule,\n    SelectionModule\n  ],\n  searchPad: [ 'type', SearchPad ]\n};\n","import {\n  map,\n  filter,\n  sortBy\n} from 'min-dash';\n\nimport {\n  getLabel\n} from '../label-editing/LabelUtil';\n\n\n/**\n * Provides ability to search through BPMN elements\n */\nexport default function BpmnSearchProvider(elementRegistry, searchPad, canvas) {\n\n  this._elementRegistry = elementRegistry;\n  this._canvas = canvas;\n\n  searchPad.registerProvider(this);\n}\n\nBpmnSearchProvider.$inject = [\n  'elementRegistry',\n  'searchPad',\n  'canvas'\n];\n\n\n/**\n * Finds all elements that match given pattern\n *\n * <Result> :\n *  {\n *    primaryTokens: <Array<Token>>,\n *    secondaryTokens: <Array<Token>>,\n *    element: <Element>\n *  }\n *\n * <Token> :\n *  {\n *    normal|matched: <String>\n *  }\n *\n * @param  {String} pattern\n * @return {Array<Result>}\n */\nBpmnSearchProvider.prototype.find = function(pattern) {\n  var rootElement = this._canvas.getRootElement();\n\n  var elements = this._elementRegistry.filter(function(element) {\n    if (element.labelTarget) {\n      return false;\n    }\n    return true;\n  });\n\n  // do not include root element\n  elements = filter(elements, function(element) {\n    return element !== rootElement;\n  });\n\n  elements = map(elements, function(element) {\n    return {\n      primaryTokens: matchAndSplit(getLabel(element), pattern),\n      secondaryTokens: matchAndSplit(element.id, pattern),\n      element: element\n    };\n  });\n\n  // exclude non-matched elements\n  elements = filter(elements, function(element) {\n    return hasMatched(element.primaryTokens) || hasMatched(element.secondaryTokens);\n  });\n\n  elements = sortBy(elements, function(element) {\n    return getLabel(element.element) + element.element.id;\n  });\n\n  return elements;\n};\n\n\nfunction hasMatched(tokens) {\n  var matched = filter(tokens, function(t) {\n    return !!t.matched;\n  });\n\n  return matched.length > 0;\n}\n\n\nfunction matchAndSplit(text, pattern) {\n  var tokens = [],\n      originalText = text;\n\n  if (!text) {\n    return tokens;\n  }\n\n  text = text.toLowerCase();\n  pattern = pattern.toLowerCase();\n\n  var i = text.indexOf(pattern);\n\n  if (i > -1) {\n    if (i !== 0) {\n      tokens.push({\n        normal: originalText.substr(0, i)\n      });\n    }\n\n    tokens.push({\n      matched: originalText.substr(i, pattern.length)\n    });\n\n    if (pattern.length + i < text.length) {\n      tokens.push({\n        normal: originalText.substr(pattern.length + i, text.length)\n      });\n    }\n  } else {\n    tokens.push({\n      normal: originalText\n    });\n  }\n\n  return tokens;\n}","import SearchPadModule from 'diagram-js/lib/features/search-pad';\n\nimport BpmnSearchProvider from './BpmnSearchProvider';\n\n\nexport default {\n  __depends__: [\n    SearchPadModule\n  ],\n  __init__: [ 'bpmnSearch'],\n  bpmnSearch: [ 'type', BpmnSearchProvider ]\n};\n","import inherits from 'inherits';\n\nimport BaseModeler from './BaseModeler';\n\nimport Viewer from './Viewer';\nimport NavigatedViewer from './NavigatedViewer';\n\nimport KeyboardMoveModule from 'diagram-js/lib/navigation/keyboard-move';\nimport MoveCanvasModule from 'diagram-js/lib/navigation/movecanvas';\nimport TouchModule from 'diagram-js/lib/navigation/touch';\nimport ZoomScrollModule from 'diagram-js/lib/navigation/zoomscroll';\n\nimport AlignElementsModule from 'diagram-js/lib/features/align-elements';\nimport AutoPlaceModule from './features/auto-place';\nimport AutoResizeModule from './features/auto-resize';\nimport AutoScrollModule from 'diagram-js/lib/features/auto-scroll';\nimport BendpointsModule from 'diagram-js/lib/features/bendpoints';\nimport ConnectModule from 'diagram-js/lib/features/connect';\nimport ConnectionPreviewModule from 'diagram-js/lib/features/connection-preview';\nimport ContextPadModule from './features/context-pad';\nimport CopyPasteModule from './features/copy-paste';\nimport CreateModule from 'diagram-js/lib/features/create';\nimport DistributeElementsModule from './features/distribute-elements';\nimport EditorActionsModule from './features/editor-actions';\nimport GridSnappingModule from './features/grid-snapping';\nimport InteractionEventsModule from './features/interaction-events';\nimport KeyboardModule from './features/keyboard';\nimport KeyboardMoveSelectionModule from 'diagram-js/lib/features/keyboard-move-selection';\nimport LabelEditingModule from './features/label-editing';\nimport ModelingModule from './features/modeling';\nimport MoveModule from 'diagram-js/lib/features/move';\nimport PaletteModule from './features/palette';\nimport ReplacePreviewModule from './features/replace-preview';\nimport ResizeModule from 'diagram-js/lib/features/resize';\nimport SnappingModule from './features/snapping';\nimport SearchModule from './features/search';\n\n\nvar initialDiagram =\n  '<?xml version=\"1.0\" encoding=\"UTF-8\"?>' +\n  '<bpmn:definitions xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" ' +\n                    'xmlns:bpmn=\"http://www.omg.org/spec/BPMN/20100524/MODEL\" ' +\n                    'xmlns:bpmndi=\"http://www.omg.org/spec/BPMN/20100524/DI\" ' +\n                    'xmlns:dc=\"http://www.omg.org/spec/DD/20100524/DC\" ' +\n                    'targetNamespace=\"http://bpmn.io/schema/bpmn\" ' +\n                    'id=\"Definitions_1\">' +\n    '<bpmn:process id=\"Process_1\" isExecutable=\"false\">' +\n      '<bpmn:startEvent id=\"StartEvent_1\"/>' +\n    '</bpmn:process>' +\n    '<bpmndi:BPMNDiagram id=\"BPMNDiagram_1\">' +\n      '<bpmndi:BPMNPlane id=\"BPMNPlane_1\" bpmnElement=\"Process_1\">' +\n        '<bpmndi:BPMNShape id=\"_BPMNShape_StartEvent_2\" bpmnElement=\"StartEvent_1\">' +\n          '<dc:Bounds height=\"36.0\" width=\"36.0\" x=\"173.0\" y=\"102.0\"/>' +\n        '</bpmndi:BPMNShape>' +\n      '</bpmndi:BPMNPlane>' +\n    '</bpmndi:BPMNDiagram>' +\n  '</bpmn:definitions>';\n\n\n/**\n * A modeler for BPMN 2.0 diagrams.\n *\n *\n * ## Extending the Modeler\n *\n * In order to extend the viewer pass extension modules to bootstrap via the\n * `additionalModules` option. An extension module is an object that exposes\n * named services.\n *\n * The following example depicts the integration of a simple\n * logging component that integrates with interaction events:\n *\n *\n * ```javascript\n *\n * // logging component\n * function InteractionLogger(eventBus) {\n *   eventBus.on('element.hover', function(event) {\n *     console.log()\n *   })\n * }\n *\n * InteractionLogger.$inject = [ 'eventBus' ]; // minification save\n *\n * // extension module\n * var extensionModule = {\n *   __init__: [ 'interactionLogger' ],\n *   interactionLogger: [ 'type', InteractionLogger ]\n * };\n *\n * // extend the viewer\n * var bpmnModeler = new Modeler({ additionalModules: [ extensionModule ] });\n * bpmnModeler.importXML(...);\n * ```\n *\n *\n * ## Customizing / Replacing Components\n *\n * You can replace individual diagram components by redefining them in override modules.\n * This works for all components, including those defined in the core.\n *\n * Pass in override modules via the `options.additionalModules` flag like this:\n *\n * ```javascript\n * function CustomContextPadProvider(contextPad) {\n *\n *   contextPad.registerProvider(this);\n *\n *   this.getContextPadEntries = function(element) {\n *     // no entries, effectively disable the context pad\n *     return {};\n *   };\n * }\n *\n * CustomContextPadProvider.$inject = [ 'contextPad' ];\n *\n * var overrideModule = {\n *   contextPadProvider: [ 'type', CustomContextPadProvider ]\n * };\n *\n * var bpmnModeler = new Modeler({ additionalModules: [ overrideModule ]});\n * ```\n *\n * @param {Object} [options] configuration options to pass to the viewer\n * @param {DOMElement} [options.container] the container to render the viewer in, defaults to body.\n * @param {String|Number} [options.width] the width of the viewer\n * @param {String|Number} [options.height] the height of the viewer\n * @param {Object} [options.moddleExtensions] extension packages to provide\n * @param {Array<didi.Module>} [options.modules] a list of modules to override the default modules\n * @param {Array<didi.Module>} [options.additionalModules] a list of modules to use with the default modules\n */\nexport default function Modeler(options) {\n  BaseModeler.call(this, options);\n}\n\ninherits(Modeler, BaseModeler);\n\n\nModeler.Viewer = Viewer;\nModeler.NavigatedViewer = NavigatedViewer;\n\n/**\n * Create a new diagram to start modeling.\n *\n * @param {Function} [done]\n */\nModeler.prototype.createDiagram = function(done) {\n  return this.importXML(initialDiagram, done);\n};\n\n\nModeler.prototype._interactionModules = [\n\n  // non-modeling components\n  KeyboardMoveModule,\n  MoveCanvasModule,\n  TouchModule,\n  ZoomScrollModule\n];\n\nModeler.prototype._modelingModules = [\n\n  // modeling components\n  AlignElementsModule,\n  AutoPlaceModule,\n  AutoScrollModule,\n  AutoResizeModule,\n  BendpointsModule,\n  ConnectModule,\n  ConnectionPreviewModule,\n  ContextPadModule,\n  CopyPasteModule,\n  CreateModule,\n  DistributeElementsModule,\n  EditorActionsModule,\n  GridSnappingModule,\n  InteractionEventsModule,\n  KeyboardModule,\n  KeyboardMoveSelectionModule,\n  LabelEditingModule,\n  ModelingModule,\n  MoveModule,\n  PaletteModule,\n  ReplacePreviewModule,\n  ResizeModule,\n  SnappingModule,\n  SearchModule\n];\n\n\n// modules the modeler is composed of\n//\n// - viewer modules\n// - interaction modules\n// - modeling modules\n\nModeler.prototype._modules = [].concat(\n  Viewer.prototype._modules,\n  Modeler.prototype._interactionModules,\n  Modeler.prototype._modelingModules\n);\n","'use strict';\r\n\r\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\r\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\r\n\r\nvar tasklist = require('./implementation/Tasklist');\r\n\r\nmodule.exports = function(group, element, bpmnFactory, translate) {\r\n  var businessObject = getBusinessObject(element);\r\n\r\n  if (is(element, 'camunda:Process') ||\r\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\r\n\r\n    group.entries = group.entries.concat(tasklist(element, bpmnFactory, {\r\n      getBusinessObject: function(element) {\r\n        var bo = getBusinessObject(element);\r\n\r\n        if (!is(bo, 'bpmn:Participant')) {\r\n          return bo;\r\n        }\r\n\r\n        return bo.get('processRef');\r\n      }\r\n    }, translate));\r\n\r\n  }\r\n};\r\n","var createBaseFor = require('./_createBaseFor');\n\n/**\n * The base implementation of `baseForOwn` which iterates over `object`\n * properties returned by `keysFunc` and invokes `iteratee` for each property.\n * Iteratee functions may exit iteration early by explicitly returning `false`.\n *\n * @private\n * @param {Object} object The object to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @returns {Object} Returns `object`.\n */\nvar baseFor = createBaseFor();\n\nmodule.exports = baseFor;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nvar forEach = require('lodash/forEach');\n\nfunction getLinkEventDefinition(element) {\n\n  var bo = getBusinessObject(element);\n\n  var linkEventDefinition = null;\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function(eventDefinition) {\n      if (is(eventDefinition, 'bpmn:LinkEventDefinition')) {\n        linkEventDefinition = eventDefinition;\n      }\n    });\n  }\n\n  return linkEventDefinition;\n}\n\nmodule.exports = function(group, element, translate) {\n  var linkEvents = [ 'bpmn:IntermediateThrowEvent', 'bpmn:IntermediateCatchEvent' ];\n\n  forEach(linkEvents, function(event) {\n    if (is(element, event)) {\n\n      var linkEventDefinition = getLinkEventDefinition(element);\n\n      if (linkEventDefinition) {\n        var entry = entryFactory.textField({\n          id: 'link-event',\n          label: translate('Link Name'),\n          modelProperty: 'link-name'\n        });\n\n        entry.get = function() {\n          return { 'link-name': linkEventDefinition.get('name') };\n        };\n\n        entry.set = function(element, values) {\n          var newProperties = {\n            name: values['link-name']\n          };\n          return cmdHelper.updateBusinessObject(element, linkEventDefinition, newProperties);\n        };\n\n        group.entries.push(entry);\n      }\n    }\n  });\n};\n\n","/**\n * Creates a function that returns `value`.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {*} value The value to return from the new function.\n * @returns {Function} Returns the new constant function.\n * @example\n *\n * var objects = _.times(2, _.constant({ 'a': 1 }));\n *\n * console.log(objects);\n * // => [{ 'a': 1 }, { 'a': 1 }]\n *\n * console.log(objects[0] === objects[1]);\n * // => true\n */\nfunction constant(value) {\n  return function() {\n    return value;\n  };\n}\n\nmodule.exports = constant;\n","'use strict';\n\nvar Validator = require('./Validator');\n\n/**\n * The guy responsible for template loading.\n *\n * Provide the actual templates via the `config.elementTemplates`.\n *\n * That configuration can either be an array of template\n * descriptors or a node style callback to retrieve\n * the templates asynchronously.\n *\n * @param {Array<TemplateDescriptor>|Function} loadTemplates\n * @param {EventBus} eventBus\n * @param {ElementTemplates} elementTemplates\n */\nfunction ElementTemplatesLoader(loadTemplates, eventBus, elementTemplates) {\n  this._loadTemplates = loadTemplates;\n  this._eventBus = eventBus;\n  this._elementTemplates = elementTemplates;\n\n  var self = this;\n\n  eventBus.on('diagram.init', function() {\n    self.reload();\n  });\n}\n\nmodule.exports = ElementTemplatesLoader;\n\nElementTemplatesLoader.$inject = [\n  'config.elementTemplates',\n  'eventBus',\n  'elementTemplates'\n];\n\n\nElementTemplatesLoader.prototype.reload = function() {\n\n  var self = this;\n\n  var loadTemplates = this._loadTemplates;\n\n  // no templates specified\n  if (typeof loadTemplates === 'undefined') {\n    return;\n  }\n\n  // template loader function specified\n  if (typeof loadTemplates === 'function') {\n\n    return loadTemplates(function(err, templates) {\n\n      if (err) {\n        return self.templateErrors([ err ]);\n      }\n\n      self.setTemplates(templates);\n    });\n  }\n\n  // templates array specified\n  if (loadTemplates.length) {\n    return this.setTemplates(loadTemplates);\n  }\n\n};\n\nElementTemplatesLoader.prototype.setTemplates = function(templates) {\n\n  var elementTemplates = this._elementTemplates;\n\n  var validator = new Validator().addAll(templates);\n\n  var errors = validator.getErrors(),\n      validTemplates = validator.getValidTemplates();\n\n  elementTemplates.set(validTemplates);\n\n  if (errors.length) {\n    this.templateErrors(errors);\n  }\n\n  this.templatesChanged();\n};\n\nElementTemplatesLoader.prototype.templatesChanged = function() {\n  this._eventBus.fire('elementTemplates.changed');\n};\n\nElementTemplatesLoader.prototype.templateErrors = function(errors) {\n  this._eventBus.fire('elementTemplates.errors', {\n    errors: errors\n  });\n};","var baseIsTypedArray = require('./_baseIsTypedArray'),\n    baseUnary = require('./_baseUnary'),\n    nodeUtil = require('./_nodeUtil');\n\n/* Node.js helper references. */\nvar nodeIsTypedArray = nodeUtil && nodeUtil.isTypedArray;\n\n/**\n * Checks if `value` is classified as a typed array.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n * @example\n *\n * _.isTypedArray(new Uint8Array);\n * // => true\n *\n * _.isTypedArray([]);\n * // => false\n */\nvar isTypedArray = nodeIsTypedArray ? baseUnary(nodeIsTypedArray) : baseIsTypedArray;\n\nmodule.exports = isTypedArray;\n","'use strict';\n\nvar assign = require('lodash/assign'),\n    find = require('lodash/find');\n\nvar domQuery = require('min-dom').query;\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar selectEntryFactory = require('./SelectEntryFactory'),\n    entryFieldDescription = require('./EntryFieldDescription');\n\n\n/**\n * The combo box is a special implementation of the select entry and adds the option 'custom' to the\n * select box. If 'custom' is selected, an additional text input field is shown which allows to define\n * a custom value.\n *\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} options.label\n * @param  {Array<Object>} options.selectOptions list of name/value pairs\n * @param  {string} options.modelProperty\n * @param  {function} options.get\n * @param  {function} options.set\n * @param  {string} [options.customValue] custom select option value (default: 'custom')\n * @param  {string} [options.customName] custom select option name visible in the select box (default: 'custom')\n *\n * @return {Object}\n */\nvar comboBox = function(options) {\n\n  var selectOptions = options.selectOptions,\n      modelProperty = options.modelProperty,\n      customValue = options.customValue || 'custom',\n      customName = options.customName || 'custom ' + modelProperty,\n      description = options.description;\n\n  // check if a value is not a built in value\n  var isCustomValue = function(value) {\n    if (typeof value[modelProperty] === 'undefined') {\n      return false;\n    }\n\n    var isCustom = !find(selectOptions, function(option) {\n      return value[modelProperty] === option.value;\n    });\n\n    return isCustom;\n  };\n\n  var comboOptions = assign({}, options);\n\n  // true if the selected value in the select box is customValue\n  comboOptions.showCustomInput = function(element, node) {\n    var selectBox = domQuery('[data-entry=\"'+ options.id +'\"] select', node.parentNode);\n\n    if (selectBox) {\n      return selectBox.value === customValue;\n    }\n\n    return false;\n  };\n\n  comboOptions.get = function(element, node) {\n    var value = options.get(element, node);\n\n    var modifiedValues = {};\n\n    if (!isCustomValue(value)) {\n      modifiedValues[modelProperty] = value[modelProperty] || '';\n\n      return modifiedValues;\n    }\n\n    modifiedValues[modelProperty] = customValue;\n    modifiedValues['custom-'+modelProperty] = value[modelProperty];\n\n    return modifiedValues;\n  };\n\n  comboOptions.set = function(element, values, node) {\n    var modifiedValues = {};\n\n    // if the custom select option has been selected\n    // take the value from the text input field\n    if (values[modelProperty] === customValue) {\n      modifiedValues[modelProperty] = values['custom-' + modelProperty] || '';\n    }\n    else if (options.emptyParameter && values[modelProperty] === '') {\n      modifiedValues[modelProperty] = undefined;\n    } else {\n      modifiedValues[modelProperty] = values[modelProperty];\n    }\n    return options.set(element, modifiedValues, node);\n  };\n\n  comboOptions.selectOptions.push({ name: customName, value: customValue });\n\n  var comboBoxEntry = assign({}, selectEntryFactory(comboOptions, comboOptions));\n\n  comboBoxEntry.html += '<div class=\"bpp-field-wrapper bpp-combo-input\" ' +\n    'data-show=\"showCustomInput\"' +\n    '>' +\n    '<input id=\"camunda-' + escapeHTML(options.id) + '-input\" type=\"text\" name=\"custom-' +\n      escapeHTML(modelProperty) + '\" ' +\n    ' />' +\n  '</div>';\n\n  // add description below combo box entry field\n  if (description) {\n    comboBoxEntry.html += entryFieldDescription(description);\n  }\n\n  return comboBoxEntry;\n};\n\nmodule.exports = comboBox;\n","var baseGetTag = require('./_baseGetTag'),\n    isLength = require('./isLength'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    boolTag = '[object Boolean]',\n    dateTag = '[object Date]',\n    errorTag = '[object Error]',\n    funcTag = '[object Function]',\n    mapTag = '[object Map]',\n    numberTag = '[object Number]',\n    objectTag = '[object Object]',\n    regexpTag = '[object RegExp]',\n    setTag = '[object Set]',\n    stringTag = '[object String]',\n    weakMapTag = '[object WeakMap]';\n\nvar arrayBufferTag = '[object ArrayBuffer]',\n    dataViewTag = '[object DataView]',\n    float32Tag = '[object Float32Array]',\n    float64Tag = '[object Float64Array]',\n    int8Tag = '[object Int8Array]',\n    int16Tag = '[object Int16Array]',\n    int32Tag = '[object Int32Array]',\n    uint8Tag = '[object Uint8Array]',\n    uint8ClampedTag = '[object Uint8ClampedArray]',\n    uint16Tag = '[object Uint16Array]',\n    uint32Tag = '[object Uint32Array]';\n\n/** Used to identify `toStringTag` values of typed arrays. */\nvar typedArrayTags = {};\ntypedArrayTags[float32Tag] = typedArrayTags[float64Tag] =\ntypedArrayTags[int8Tag] = typedArrayTags[int16Tag] =\ntypedArrayTags[int32Tag] = typedArrayTags[uint8Tag] =\ntypedArrayTags[uint8ClampedTag] = typedArrayTags[uint16Tag] =\ntypedArrayTags[uint32Tag] = true;\ntypedArrayTags[argsTag] = typedArrayTags[arrayTag] =\ntypedArrayTags[arrayBufferTag] = typedArrayTags[boolTag] =\ntypedArrayTags[dataViewTag] = typedArrayTags[dateTag] =\ntypedArrayTags[errorTag] = typedArrayTags[funcTag] =\ntypedArrayTags[mapTag] = typedArrayTags[numberTag] =\ntypedArrayTags[objectTag] = typedArrayTags[regexpTag] =\ntypedArrayTags[setTag] = typedArrayTags[stringTag] =\ntypedArrayTags[weakMapTag] = false;\n\n/**\n * The base implementation of `_.isTypedArray` without Node.js optimizations.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a typed array, else `false`.\n */\nfunction baseIsTypedArray(value) {\n  return isObjectLike(value) &&\n    isLength(value.length) && !!typedArrayTags[baseGetTag(value)];\n}\n\nmodule.exports = baseIsTypedArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar ImplementationTypeHelper = require('../../../helper/ImplementationTypeHelper');\n\nvar externalTaskPriority = require('./implementation/ExternalTaskPriority');\n\nfunction getServiceTaskLikeBusinessObject(element) {\n  var bo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n\n  // if the element is not a serviceTaskLike element, fetch the normal business object\n  // This avoids the loss of the process / participant business object\n  if (!bo) {\n    bo = getBusinessObject(element);\n  }\n\n  return bo;\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var bo = getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(bo, 'camunda:TaskPriorized') || (is(bo, 'bpmn:Participant')) && bo.get('processRef')) {\n    group.entries = group.entries.concat(externalTaskPriority(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n        return bo.get('processRef');\n      }\n    }, translate));\n  }\n};","var Set = require('./_Set'),\n    noop = require('./noop'),\n    setToArray = require('./_setToArray');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Creates a set object of `values`.\n *\n * @private\n * @param {Array} values The values to add to the set.\n * @returns {Object} Returns the new set.\n */\nvar createSet = !(Set && (1 / setToArray(new Set([,-0]))[1]) == INFINITY) ? noop : function(values) {\n  return new Set(values);\n};\n\nmodule.exports = createSet;\n","var isObject = require('./isObject');\n\n/** Built-in value references. */\nvar objectCreate = Object.create;\n\n/**\n * The base implementation of `_.create` without support for assigning\n * properties to the created object.\n *\n * @private\n * @param {Object} proto The object to inherit from.\n * @returns {Object} Returns the new object.\n */\nvar baseCreate = (function() {\n  function object() {}\n  return function(proto) {\n    if (!isObject(proto)) {\n      return {};\n    }\n    if (objectCreate) {\n      return objectCreate(proto);\n    }\n    object.prototype = proto;\n    var result = new object;\n    object.prototype = undefined;\n    return result;\n  };\n}());\n\nmodule.exports = baseCreate;\n","var baseToString = require('./_baseToString');\n\n/**\n * Converts `value` to a string. An empty string is returned for `null`\n * and `undefined` values. The sign of `-0` is preserved.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to convert.\n * @returns {string} Returns the converted string.\n * @example\n *\n * _.toString(null);\n * // => ''\n *\n * _.toString(-0);\n * // => '-0'\n *\n * _.toString([1, 2, 3]);\n * // => '1,2,3'\n */\nfunction toString(value) {\n  return value == null ? '' : baseToString(value);\n}\n\nmodule.exports = toString;\n","/**\n * A specialized version of `_.map` for arrays without support for iteratee\n * shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction arrayMap(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length,\n      result = Array(length);\n\n  while (++index < length) {\n    result[index] = iteratee(array[index], index, array);\n  }\n  return result;\n}\n\nmodule.exports = arrayMap;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar domQuery = require('min-dom').query,\n    domClosest = require('min-dom').closest,\n    domify = require('min-dom').domify,\n    forEach = require('lodash/forEach');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils'),\n    escapeHTML = utils.escapeHTML;\n\nfunction getSelectBox(node, id) {\n  var currentTab = domClosest(node, 'div.bpp-properties-tab');\n  var query = 'select[name=selectedExtensionElement]' + (id ? '[id=cam-extensionElements-' + id + ']' : '');\n  return domQuery(query, currentTab);\n}\n\nfunction getSelected(node, id) {\n  var selectBox = getSelectBox(node, id);\n  return {\n    value: (selectBox || {}).value,\n    idx: (selectBox || {}).selectedIndex\n  };\n}\n\nfunction generateElementId(prefix) {\n  prefix = prefix + '_';\n  return utils.nextId(prefix);\n}\n\nvar CREATE_EXTENSION_ELEMENT_ACTION = 'create-extension-element',\n    REMOVE_EXTENSION_ELEMENT_ACTION = 'remove-extension-element';\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var id = options.id,\n      prefix = options.prefix || 'elem',\n      label = options.label || id,\n      idGeneration = (options.idGeneration === false) ? options.idGeneration : true,\n      businessObject = options.businessObject || getBusinessObject(element);\n\n  var modelProperty = options.modelProperty || 'id';\n\n  var getElements = options.getExtensionElements;\n\n  var createElement = options.createExtensionElement,\n      canCreate = typeof createElement === 'function';\n\n  var removeElement = options.removeExtensionElement,\n      canRemove = typeof removeElement === 'function';\n\n  var onSelectionChange = options.onSelectionChange;\n\n  var hideElements = options.hideExtensionElements,\n      canBeHidden = typeof hideElements === 'function';\n\n  var setOptionLabelValue = options.setOptionLabelValue;\n\n  var defaultSize = options.size || 5,\n      resizable = options.resizable;\n\n  var reference = options.reference || undefined;\n\n  var selectionChanged = function(element, node, event, scope) {\n    if (typeof onSelectionChange === 'function') {\n      return onSelectionChange(element, node, event, scope);\n    }\n  };\n\n  var createOption = function(value) {\n    return '<option value=\"' + escapeHTML(value) + '\" data-value data-name=\"extensionElementValue\">' + escapeHTML(value) + '</option>';\n  };\n\n  var initSelectionSize = function(selectBox, optionsLength) {\n    if (resizable) {\n      selectBox.size = optionsLength > defaultSize ? optionsLength : defaultSize;\n    }\n  };\n\n  return {\n    id: id,\n    html: '<div class=\"bpp-row bpp-element-list\" ' +\n            (canBeHidden ? 'data-show=\"hideElements\"' : '') + '>' +\n            '<label for=\"cam-extensionElements-' + escapeHTML(id) + '\">' + escapeHTML(label) + '</label>' +\n            '<div class=\"bpp-field-wrapper\">' +\n              '<select id=\"cam-extensionElements-' + escapeHTML(id) + '\"' +\n                      'name=\"selectedExtensionElement\" ' +\n                      'size=\"' + escapeHTML(defaultSize) + '\" ' +\n                      'data-list-entry-container ' +\n                      'data-on-change=\"selectElement\">' +\n              '</select>' +\n              (canCreate ? '<button class=\"add\" ' +\n                                   'id=\"cam-extensionElements-create-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"createElement\">' +\n                             '<span>+</span>' +\n                           '</button>' : '') +\n              (canRemove ? '<button class=\"clear\" ' +\n                                   'id=\"cam-extensionElements-remove-' + escapeHTML(id) + '\" ' +\n                                   'data-action=\"removeElement\" ' +\n                                   'data-disable=\"disableRemove\">' +\n                             '<span>-</span>' +\n                           '</button>' : '') +\n            '</div>' +\n          '</div>',\n\n    get: function(element, node) {\n      var elements = getElements(element, node);\n\n      var result = [];\n      forEach(elements, function(elem) {\n        result.push({\n          extensionElementValue: elem.get(modelProperty)\n        });\n      });\n\n      var selectBox = getSelectBox(node.parentNode, id);\n      initSelectionSize(selectBox, result.length);\n\n      return result;\n    },\n\n    set: function(element, values, node) {\n      var action = this.__action;\n      delete this.__action;\n\n      businessObject = businessObject || getBusinessObject(element);\n\n      var bo =\n        (reference && businessObject.get(reference))\n          ? businessObject.get(reference)\n          : businessObject;\n\n      var extensionElements = bo.get('extensionElements');\n\n      if (action.id === CREATE_EXTENSION_ELEMENT_ACTION) {\n        var commands = [];\n        if (!extensionElements) {\n          extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n        commands.push(createElement(element, extensionElements, action.value, node));\n        return commands;\n\n      }\n      else if (action.id === REMOVE_EXTENSION_ELEMENT_ACTION) {\n        return removeElement(element, extensionElements, action.value, action.idx, node);\n      }\n\n    },\n\n    createListEntryTemplate: function(value, index, selectBox) {\n      initSelectionSize(selectBox, selectBox.options.length + 1);\n      return createOption(value.extensionElementValue);\n    },\n\n    deselect: function(element, node) {\n      var selectBox = getSelectBox(node, id);\n      selectBox.selectedIndex = -1;\n    },\n\n    getSelected: function(element, node) {\n      return getSelected(node, id);\n    },\n\n    setControlValue: function(element, node, option, property, value, idx) {\n      node.value = value;\n\n      if (!setOptionLabelValue) {\n        node.text = value;\n      } else {\n        setOptionLabelValue(element, node, option, property, value, idx);\n      }\n    },\n\n    createElement: function(element, node) {\n      // create option template\n      var generatedId;\n      if (idGeneration) {\n        generatedId = generateElementId(prefix);\n      }\n\n      var selectBox = getSelectBox(node, id);\n      var template = domify(createOption(generatedId));\n\n      // add new empty option as last child element\n      selectBox.appendChild(template);\n\n      // select last child element\n      selectBox.lastChild.selected = 'selected';\n      selectionChanged(element, node);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: CREATE_EXTENSION_ELEMENT_ACTION,\n        value: generatedId\n      };\n\n      return true;\n    },\n\n    removeElement: function(element, node) {\n      var selection = getSelected(node, id);\n\n      var selectBox = getSelectBox(node, id);\n      selectBox.removeChild(selectBox.options[selection.idx]);\n\n      // update select box size\n      initSelectionSize(selectBox, selectBox.options.length);\n\n      this.__action = {\n        id: REMOVE_EXTENSION_ELEMENT_ACTION,\n        value: selection.value,\n        idx: selection.idx\n      };\n\n      return true;\n    },\n\n    hideElements: function(element, entryNode, node, scopeNode) {\n      return !hideElements(element, entryNode, node, scopeNode);\n    },\n\n    disableRemove: function(element, entryNode, node, scopeNode) {\n      return (getSelected(entryNode, id) || {}).idx < 0;\n    },\n\n    selectElement: selectionChanged\n  };\n\n};\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Map = getNative(root, 'Map');\n\nmodule.exports = Map;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Checks if a hash value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf Hash\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction hashHas(key) {\n  var data = this.__data__;\n  return nativeCreate ? (data[key] !== undefined) : hasOwnProperty.call(data, key);\n}\n\nmodule.exports = hashHas;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar extensionElementsEntry = require('./ExtensionElements'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    ImplementationTypeHelper = require('../../../../helper/ImplementationTypeHelper');\n\n\nfunction getListeners(bo, type) {\n  return bo && extensionElementsHelper.getExtensionElements(bo, type) || [];\n}\n\nvar CAMUNDA_EXECUTION_LISTENER_ELEMENT = 'camunda:ExecutionListener';\nvar CAMUNDA_TASK_LISTENER_ELEMENT = 'camunda:TaskListener';\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var LISTENER_TYPE_LABEL = {\n    class: translate('Java Class'),\n    expression: translate('Expression'),\n    delegateExpression: translate('Delegate Expression'),\n    script: translate('Script')\n  };\n\n  var bo;\n\n  var result = {\n    getSelectedListener: getSelectedListener\n  };\n\n  var entries = result.entries = [];\n\n  var isSequenceFlow = ImplementationTypeHelper.isSequenceFlow(element);\n\n  function getSelectedListener(element, node) {\n    var selection = (executionListenerEntry && executionListenerEntry.getSelected(element, node)) || { idx: -1 };\n\n    var listener = getListeners(bo, CAMUNDA_EXECUTION_LISTENER_ELEMENT)[selection.idx];\n    if (!listener && taskListenerEntry) {\n      selection = taskListenerEntry.getSelected(element, node);\n      listener = getListeners(bo, CAMUNDA_TASK_LISTENER_ELEMENT)[selection.idx];\n    }\n    return listener;\n  }\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx) {\n      var listeners = getListeners(bo, type);\n      var listener = listeners[idx];\n      var listenerType = ImplementationTypeHelper.getImplementationType(listener);\n\n      var event = (listener.get('event')) ? listener.get('event') : '<empty>';\n\n      var label = (event || '*') + ' : ' + (LISTENER_TYPE_LABEL[listenerType] || '');\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(element, type, initialEvent) {\n    return function(element, extensionElements, value) {\n      var props = {\n        event: initialEvent,\n        class: ''\n      };\n\n      var newElem = elementHelper.createElement(type, props, extensionElements, bpmnFactory);\n\n      return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newElem ]);\n    };\n  };\n\n  var removeElement = function(element, type) {\n    return function(element, extensionElements, value, idx) {\n      var listeners = getListeners(bo, type);\n      var listener = listeners[idx];\n      if (listener) {\n        return extensionElementsHelper.removeEntry(bo, element, listener);\n      }\n    };\n  };\n\n\n  // Execution Listener\n\n  if (is(element, 'bpmn:FlowElement') || is(element, 'bpmn:Process') || is(element, 'bpmn:Participant')) {\n    bo = getBusinessObject(element);\n    if (is(element, 'bpmn:Participant')) {\n      element = element.processRef;\n      bo = bo.get('processRef');\n    }\n\n    if (bo) {\n\n      var executionListenerEntry = extensionElementsEntry(element, bpmnFactory, {\n        id : 'executionListeners',\n        label : translate('Execution Listener'),\n        modelProperty: 'name',\n        idGeneration: 'false',\n        reference: 'processRef',\n\n        createExtensionElement: newElement(element, CAMUNDA_EXECUTION_LISTENER_ELEMENT, (isSequenceFlow) ? 'take' : 'start'),\n        removeExtensionElement: removeElement(element, CAMUNDA_EXECUTION_LISTENER_ELEMENT),\n\n        getExtensionElements: function(element) {\n          return getListeners(bo, CAMUNDA_EXECUTION_LISTENER_ELEMENT);\n        },\n\n        onSelectionChange: function(element, node, event, scope) {\n          taskListenerEntry && taskListenerEntry.deselect(element, node);\n        },\n\n        setOptionLabelValue: setOptionLabelValue(CAMUNDA_EXECUTION_LISTENER_ELEMENT)\n\n      });\n      entries.push(executionListenerEntry);\n\n    }\n  }\n\n\n  // Task Listener\n\n  if (is(element, 'bpmn:UserTask')) {\n    bo = getBusinessObject(element);\n\n    var taskListenerEntry = extensionElementsEntry(element, bpmnFactory, {\n      id : 'taskListeners',\n      label : translate('Task Listener'),\n      modelProperty: 'name',\n      idGeneration: 'false',\n\n      createExtensionElement: newElement(element, CAMUNDA_TASK_LISTENER_ELEMENT, 'create'),\n      removeExtensionElement: removeElement(element, CAMUNDA_TASK_LISTENER_ELEMENT),\n\n      getExtensionElements: function(element) {\n        return getListeners(bo, CAMUNDA_TASK_LISTENER_ELEMENT);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        executionListenerEntry.deselect(element, node);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(CAMUNDA_TASK_LISTENER_ELEMENT)\n\n    });\n    entries.push(taskListenerEntry);\n  }\n\n  return result;\n\n};\n","'use strict';\n\nvar ChangeElementTemplateHandler = require('./ChangeElementTemplateHandler');\n\nvar getTemplate = require('../Helper').getTemplate,\n    getDefaultTemplate = require('../Helper').getDefaultTemplate;\n\nfunction registerHandlers(commandStack, elementTemplates, eventBus, elementRegistry) {\n  commandStack.registerHandler(\n    'propertiesPanel.camunda.changeTemplate',\n    ChangeElementTemplateHandler\n  );\n\n  // apply default element templates on shape creation\n  eventBus.on([ 'commandStack.shape.create.postExecuted' ], function(context) {\n    applyDefaultTemplate(context.context.shape, elementTemplates, commandStack);\n  });\n\n  // apply default element templates on connection creation\n  eventBus.on([ 'commandStack.connection.create.postExecuted' ], function(context) {\n    applyDefaultTemplate(context.context.connection, elementTemplates, commandStack);\n  });\n}\n\nregisterHandlers.$inject = [ 'commandStack', 'elementTemplates', 'eventBus', 'elementRegistry' ];\n\n\nmodule.exports = {\n  __init__: [ registerHandlers ]\n};\n\n\nfunction applyDefaultTemplate(element, elementTemplates, commandStack) {\n\n  if (!getTemplate(element, elementTemplates)\n      && getDefaultTemplate(element, elementTemplates)) {\n\n    var command = 'propertiesPanel.camunda.changeTemplate';\n    var commandContext = {\n      element: element,\n      newTemplate: getDefaultTemplate(element, elementTemplates)\n    };\n\n    commandStack.execute(command, commandContext);\n  }\n}\n","var mapCacheClear = require('./_mapCacheClear'),\n    mapCacheDelete = require('./_mapCacheDelete'),\n    mapCacheGet = require('./_mapCacheGet'),\n    mapCacheHas = require('./_mapCacheHas'),\n    mapCacheSet = require('./_mapCacheSet');\n\n/**\n * Creates a map cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction MapCache(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `MapCache`.\nMapCache.prototype.clear = mapCacheClear;\nMapCache.prototype['delete'] = mapCacheDelete;\nMapCache.prototype.get = mapCacheGet;\nMapCache.prototype.has = mapCacheHas;\nMapCache.prototype.set = mapCacheSet;\n\nmodule.exports = MapCache;\n","/**\n * Checks whether node is of specific bpmn type.\n *\n * @param {ModdleElement} node\n * @param {String} type\n *\n * @return {Boolean}\n */\nfunction is(node, type) {\n\n  if (type.indexOf(':') === -1) {\n    type = 'bpmn:' + type;\n  }\n\n  return (\n    (typeof node.$instanceOf === 'function')\n      ? node.$instanceOf(type)\n      : node.$type === type\n  );\n}\n\n/**\n * Checks whether node has any of the specified types.\n *\n * @param {ModdleElement} node\n * @param {Array<String>} types\n *\n * @return {Boolean}\n */\nfunction isAny(node, types) {\n  return types.some(function(type) {\n    return is(node, type);\n  });\n}\n\nexport { is, isAny };\n//# sourceMappingURL=index.esm.js.map\n","var Stack = require('./_Stack'),\n    equalArrays = require('./_equalArrays'),\n    equalByTag = require('./_equalByTag'),\n    equalObjects = require('./_equalObjects'),\n    getTag = require('./_getTag'),\n    isArray = require('./isArray'),\n    isBuffer = require('./isBuffer'),\n    isTypedArray = require('./isTypedArray');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** `Object#toString` result references. */\nvar argsTag = '[object Arguments]',\n    arrayTag = '[object Array]',\n    objectTag = '[object Object]';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqual` for arrays and objects which performs\n * deep comparisons and tracks traversed objects enabling objects with circular\n * references to be compared.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} [stack] Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction baseIsEqualDeep(object, other, bitmask, customizer, equalFunc, stack) {\n  var objIsArr = isArray(object),\n      othIsArr = isArray(other),\n      objTag = objIsArr ? arrayTag : getTag(object),\n      othTag = othIsArr ? arrayTag : getTag(other);\n\n  objTag = objTag == argsTag ? objectTag : objTag;\n  othTag = othTag == argsTag ? objectTag : othTag;\n\n  var objIsObj = objTag == objectTag,\n      othIsObj = othTag == objectTag,\n      isSameTag = objTag == othTag;\n\n  if (isSameTag && isBuffer(object)) {\n    if (!isBuffer(other)) {\n      return false;\n    }\n    objIsArr = true;\n    objIsObj = false;\n  }\n  if (isSameTag && !objIsObj) {\n    stack || (stack = new Stack);\n    return (objIsArr || isTypedArray(object))\n      ? equalArrays(object, other, bitmask, customizer, equalFunc, stack)\n      : equalByTag(object, other, objTag, bitmask, customizer, equalFunc, stack);\n  }\n  if (!(bitmask & COMPARE_PARTIAL_FLAG)) {\n    var objIsWrapped = objIsObj && hasOwnProperty.call(object, '__wrapped__'),\n        othIsWrapped = othIsObj && hasOwnProperty.call(other, '__wrapped__');\n\n    if (objIsWrapped || othIsWrapped) {\n      var objUnwrapped = objIsWrapped ? object.value() : object,\n          othUnwrapped = othIsWrapped ? other.value() : other;\n\n      stack || (stack = new Stack);\n      return equalFunc(objUnwrapped, othUnwrapped, bitmask, customizer, stack);\n    }\n  }\n  if (!isSameTag) {\n    return false;\n  }\n  stack || (stack = new Stack);\n  return equalObjects(object, other, bitmask, customizer, equalFunc, stack);\n}\n\nmodule.exports = baseIsEqualDeep;\n","'use strict';\n\nvar inputOutput = require('./implementation/InputOutput');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inputOutputEntry = inputOutput(element, bpmnFactory, {}, translate);\n\n  group.entries = group.entries.concat(inputOutputEntry.entries);\n\n  return {\n    getSelectedParameter: inputOutputEntry.getSelectedParameter\n  };\n\n};\n","var Hash = require('./_Hash'),\n    ListCache = require('./_ListCache'),\n    Map = require('./_Map');\n\n/**\n * Removes all key-value entries from the map.\n *\n * @private\n * @name clear\n * @memberOf MapCache\n */\nfunction mapCacheClear() {\n  this.size = 0;\n  this.__data__ = {\n    'hash': new Hash,\n    'map': new (Map || ListCache),\n    'string': new Hash\n  };\n}\n\nmodule.exports = mapCacheClear;\n","'use strict';\n\n/**\n * Calculate the selection update for the given\n * current and new input values.\n *\n * @param {Object} currentSelection as {start, end}\n * @param {String} currentValue\n * @param {String} newValue\n *\n * @return {Object} newSelection as {start, end}\n */\nfunction calculateUpdate(currentSelection, currentValue, newValue) {\n\n  var currentCursor = currentSelection.start,\n      newCursor = currentCursor,\n      diff = newValue.length - currentValue.length,\n      idx;\n\n  var lengthDelta = newValue.length - currentValue.length;\n\n  var currentTail = currentValue.substring(currentCursor);\n\n  // check if we can remove common ending from the equation\n  // to be able to properly detect a selection change for\n  // the following scenarios:\n  //\n  //  * (AAATTT|TF) => (AAAT|TF)\n  //  * (AAAT|TF) =>  (AAATTT|TF)\n  //\n  if (newValue.lastIndexOf(currentTail) === newValue.length - currentTail.length) {\n    currentValue = currentValue.substring(0, currentValue.length - currentTail.length);\n    newValue = newValue.substring(0, newValue.length - currentTail.length);\n  }\n\n  // diff\n  var diff = createDiff(currentValue, newValue);\n\n  if (diff) {\n    if (diff.type === 'remove') {\n      newCursor = diff.newStart;\n    } else {\n      newCursor = diff.newEnd;\n    }\n  }\n\n  return range(newCursor);\n}\n\nmodule.exports = calculateUpdate;\n\n\nfunction createDiff(currentValue, newValue) {\n\n  var insert;\n\n  var l_str, l_char, l_idx = 0,\n      s_str, s_char, s_idx = 0;\n\n  if (newValue.length > currentValue.length) {\n    l_str = newValue;\n    s_str = currentValue;\n  } else {\n    l_str = currentValue;\n    s_str = newValue;\n  }\n\n  // assume there will be only one insert / remove and\n  // detect that _first_ edit operation only\n  while (l_idx < l_str.length) {\n\n    l_char = l_str.charAt(l_idx);\n    s_char = s_str.charAt(s_idx);\n\n    // chars no not equal\n    if (l_char !== s_char) {\n\n      if (!insert) {\n        insert = {\n          l_start: l_idx,\n          s_start: s_idx\n        };\n      }\n\n      l_idx++;\n    }\n\n    // chars equal (again?)\n    else {\n\n      if (insert && !insert.complete) {\n        insert.l_end = l_idx;\n        insert.s_end = s_idx;\n        insert.complete = true;\n      }\n\n      s_idx++;\n      l_idx++;\n    }\n  }\n\n  if (insert && !insert.complete) {\n    insert.complete = true;\n    insert.s_end = s_str.length;\n    insert.l_end = l_str.length;\n  }\n\n  // no diff\n  if (!insert) {\n    return;\n  }\n\n  if (newValue.length > currentValue.length) {\n    return {\n      newStart: insert.l_start,\n      newEnd: insert.l_end,\n      type: 'add'\n    };\n  } else {\n    return {\n      newStart: insert.s_start,\n      newEnd: insert.s_end,\n      type: newValue.length < currentValue.length ? 'remove' : 'replace'\n    };\n  }\n}\n\n/**\n * Utility method for creating a new selection range {start, end} object.\n *\n * @param {Number} start\n * @param {Number} [end]\n *\n * @return {Object} selection range as {start, end}\n */\nfunction range(start, end) {\n  return {\n    start: start,\n    end: end === undefined ? start : end\n  };\n}\n\nmodule.exports.range = range;\n\n\nfunction splitStr(str, position) {\n  return {\n    before: str.substring(0, position),\n    after: str.substring(position)\n  };\n}","var arrayPush = require('./_arrayPush'),\n    isArray = require('./isArray');\n\n/**\n * The base implementation of `getAllKeys` and `getAllKeysIn` which uses\n * `keysFunc` and `symbolsFunc` to get the enumerable property names and\n * symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Function} keysFunc The function to get the keys of `object`.\n * @param {Function} symbolsFunc The function to get the symbols of `object`.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction baseGetAllKeys(object, keysFunc, symbolsFunc) {\n  var result = keysFunc(object);\n  return isArray(object) ? result : arrayPush(result, symbolsFunc(object));\n}\n\nmodule.exports = baseGetAllKeys;\n","var ListCache = require('./_ListCache'),\n    stackClear = require('./_stackClear'),\n    stackDelete = require('./_stackDelete'),\n    stackGet = require('./_stackGet'),\n    stackHas = require('./_stackHas'),\n    stackSet = require('./_stackSet');\n\n/**\n * Creates a stack cache object to store key-value pairs.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Stack(entries) {\n  var data = this.__data__ = new ListCache(entries);\n  this.size = data.size;\n}\n\n// Add methods to `Stack`.\nStack.prototype.clear = stackClear;\nStack.prototype['delete'] = stackDelete;\nStack.prototype.get = stackGet;\nStack.prototype.has = stackHas;\nStack.prototype.set = stackSet;\n\nmodule.exports = Stack;\n","/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/**\n * Adds `value` to the array cache.\n *\n * @private\n * @name add\n * @memberOf SetCache\n * @alias push\n * @param {*} value The value to cache.\n * @returns {Object} Returns the cache instance.\n */\nfunction setCacheAdd(value) {\n  this.__data__.set(value, HASH_UNDEFINED);\n  return this;\n}\n\nmodule.exports = setCacheAdd;\n","module.exports = {\n  __depends__: [\n    require('./cmd'),\n    require('diagram-js/lib/i18n/translate').default\n  ],\n  __init__: [ 'propertiesPanel' ],\n  propertiesPanel: [ 'type', require('./PropertiesPanel') ]\n};\n","'use strict';\n\nvar inherits = require('inherits');\n\nvar PropertiesActivator = require('../../PropertiesActivator');\n\nvar asyncCapableHelper = require('../../helper/AsyncCapableHelper'),\n    ImplementationTypeHelper = require('../../helper/ImplementationTypeHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\n// bpmn properties\nvar processProps = require('../bpmn/parts/ProcessProps'),\n    eventProps = require('../bpmn/parts/EventProps'),\n    linkProps = require('../bpmn/parts/LinkProps'),\n    documentationProps = require('../bpmn/parts/DocumentationProps'),\n    idProps = require('../bpmn/parts/IdProps'),\n    nameProps = require('../bpmn/parts/NameProps'),\n    executableProps = require('../bpmn/parts/ExecutableProps');\n\n// camunda properties\nvar serviceTaskDelegateProps = require('./parts/ServiceTaskDelegateProps'),\n    userTaskProps = require('./parts/UserTaskProps'),\n    asynchronousContinuationProps = require('./parts/AsynchronousContinuationProps'),\n    callActivityProps = require('./parts/CallActivityProps'),\n    multiInstanceProps = require('./parts/MultiInstanceLoopProps'),\n    conditionalProps = require('./parts/ConditionalProps'),\n    scriptProps = require('./parts/ScriptTaskProps'),\n    errorProps = require('./parts/ErrorEventProps'),\n    formProps = require('./parts/FormProps'),\n    startEventInitiator = require('./parts/StartEventInitiator'),\n    variableMapping = require('./parts/VariableMappingProps'),\n    versionTag = require('./parts/VersionTagProps');\n\nvar listenerProps = require('./parts/ListenerProps'),\n    listenerDetails = require('./parts/ListenerDetailProps'),\n    listenerFields = require('./parts/ListenerFieldInjectionProps');\n\nvar elementTemplateChooserProps = require('./element-templates/parts/ChooserProps'),\n    elementTemplateCustomProps = require('./element-templates/parts/CustomProps');\n\n// Input/Output\nvar inputOutput = require('./parts/InputOutputProps'),\n    inputOutputParameter = require('./parts/InputOutputParameterProps');\n\n// Connector\nvar connectorDetails = require('./parts/ConnectorDetailProps'),\n    connectorInputOutput = require('./parts/ConnectorInputOutputProps'),\n    connectorInputOutputParameter = require('./parts/ConnectorInputOutputParameterProps');\n\n// properties\nvar properties = require('./parts/PropertiesProps');\n\n// job configuration\nvar jobConfiguration = require('./parts/JobConfigurationProps');\n\n// history time to live\nvar historyTimeToLive = require('./parts/HistoryTimeToLiveProps');\n\n// candidate starter groups/users\nvar candidateStarter = require('./parts/CandidateStarterProps');\n\n// tasklist\nvar tasklist = require('./parts/TasklistProps');\n\n// external task configuration\nvar externalTaskConfiguration = require('./parts/ExternalTaskConfigurationProps');\n\n// field injection\nvar fieldInjections = require('./parts/FieldInjectionProps');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    eventDefinitionHelper = require('../../helper/EventDefinitionHelper'),\n    implementationTypeHelper = require('../../helper/ImplementationTypeHelper');\n\n// helpers ////////////////////////////////////////\n\nvar isExternalTaskPriorityEnabled = function(element) {\n  var businessObject = getBusinessObject(element);\n\n  // show only if element is a process, a participant ...\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n    return true;\n  }\n\n  var externalBo = ImplementationTypeHelper.getServiceTaskLikeBusinessObject(element),\n      isExternalTask = ImplementationTypeHelper.getImplementationType(externalBo) === 'external';\n\n  // ... or an external task with selected external implementation type\n  return !!ImplementationTypeHelper.isExternalCapable(externalBo) && isExternalTask;\n};\n\nvar isJobConfigEnabled = function(element) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n    return true;\n  }\n\n  // async behavior\n  var bo = getBusinessObject(element);\n  if (asyncCapableHelper.isAsyncBefore(bo) || asyncCapableHelper.isAsyncAfter(bo)) {\n    return true;\n  }\n\n  // timer definition\n  if (is(element, 'bpmn:Event')) {\n    return !!eventDefinitionHelper.getTimerEventDefinition(element);\n  }\n\n  return false;\n};\n\nvar getInputOutputParameterLabel = function(param, translate) {\n\n  if (is(param, 'camunda:InputParameter')) {\n    return translate('Input Parameter');\n  }\n\n  if (is(param, 'camunda:OutputParameter')) {\n    return translate('Output Parameter');\n  }\n\n  return '';\n};\n\nvar getListenerLabel = function(param, translate) {\n\n  if (is(param, 'camunda:ExecutionListener')) {\n    return translate('Execution Listener');\n  }\n\n  if (is(param, 'camunda:TaskListener')) {\n    return translate('Task Listener');\n  }\n\n  return '';\n};\n\nvar PROCESS_KEY_HINT = 'This maps to the process definition key.';\nvar TASK_KEY_HINT = 'This maps to the task definition key.';\n\nfunction createGeneralTabGroups(\n    element, canvas, bpmnFactory,\n    elementRegistry, elementTemplates, translate) {\n\n  // refer to target element for external labels\n  element = element.labelTarget || element;\n\n  var generalGroup = {\n    id: 'general',\n    label: translate('General'),\n    entries: []\n  };\n\n  var idOptions;\n  var processOptions;\n\n  if (is(element, 'bpmn:Process')) {\n    idOptions = { description: PROCESS_KEY_HINT };\n  }\n\n  if (is(element, 'bpmn:UserTask')) {\n    idOptions = { description: TASK_KEY_HINT };\n  }\n\n  if (is(element, 'bpmn:Participant')) {\n    processOptions = { processIdDescription: PROCESS_KEY_HINT };\n  }\n\n  idProps(generalGroup, element, translate, idOptions);\n  nameProps(generalGroup, element, bpmnFactory, canvas, translate);\n  processProps(generalGroup, element, translate, processOptions);\n  versionTag(generalGroup, element, translate);\n  executableProps(generalGroup, element, translate);\n  elementTemplateChooserProps(generalGroup, element, elementTemplates, translate);\n\n  var customFieldsGroups = elementTemplateCustomProps(element, elementTemplates, bpmnFactory, translate);\n\n  var detailsGroup = {\n    id: 'details',\n    label: translate('Details'),\n    entries: []\n  };\n  serviceTaskDelegateProps(detailsGroup, element, bpmnFactory, translate);\n  userTaskProps(detailsGroup, element, translate);\n  scriptProps(detailsGroup, element, bpmnFactory, translate);\n  linkProps(detailsGroup, element, translate);\n  callActivityProps(detailsGroup, element, bpmnFactory, translate);\n  eventProps(detailsGroup, element, bpmnFactory, elementRegistry, translate);\n  errorProps(detailsGroup, element, bpmnFactory, translate);\n  conditionalProps(detailsGroup, element, bpmnFactory, translate);\n  startEventInitiator(detailsGroup, element, translate); // this must be the last element of the details group!\n\n  var multiInstanceGroup = {\n    id: 'multiInstance',\n    label: translate('Multi Instance'),\n    entries: []\n  };\n  multiInstanceProps(multiInstanceGroup, element, bpmnFactory, translate);\n\n  var asyncGroup = {\n    id : 'async',\n    label: translate('Asynchronous Continuations'),\n    entries : []\n  };\n  asynchronousContinuationProps(asyncGroup, element, bpmnFactory, translate);\n\n  var jobConfigurationGroup = {\n    id : 'jobConfiguration',\n    label : translate('Job Configuration'),\n    entries : [],\n    enabled: isJobConfigEnabled\n  };\n  jobConfiguration(jobConfigurationGroup, element, bpmnFactory, translate);\n\n  var externalTaskGroup = {\n    id : 'externalTaskConfiguration',\n    label : translate('External Task Configuration'),\n    entries : [],\n    enabled: isExternalTaskPriorityEnabled\n  };\n  externalTaskConfiguration(externalTaskGroup, element, bpmnFactory, translate);\n\n\n  var candidateStarterGroup = {\n    id: 'candidateStarterConfiguration',\n    label: translate('Candidate Starter Configuration'),\n    entries: []\n  };\n  candidateStarter(candidateStarterGroup, element, bpmnFactory, translate);\n\n  var historyTimeToLiveGroup = {\n    id: 'historyConfiguration',\n    label: translate('History Configuration'),\n    entries: []\n  };\n  historyTimeToLive(historyTimeToLiveGroup, element, bpmnFactory, translate);\n\n  var tasklistGroup = {\n    id: 'tasklist',\n    label: translate('Tasklist Configuration'),\n    entries: []\n  };\n  tasklist(tasklistGroup, element, bpmnFactory, translate);\n\n  var documentationGroup = {\n    id: 'documentation',\n    label: translate('Documentation'),\n    entries: []\n  };\n  documentationProps(documentationGroup, element, bpmnFactory, translate);\n\n  var groups = [];\n  groups.push(generalGroup);\n  customFieldsGroups.forEach(function(group) {\n    groups.push(group);\n  });\n  groups.push(detailsGroup);\n  groups.push(externalTaskGroup);\n  groups.push(multiInstanceGroup);\n  groups.push(asyncGroup);\n  groups.push(jobConfigurationGroup);\n  groups.push(candidateStarterGroup);\n  groups.push(historyTimeToLiveGroup);\n  groups.push(tasklistGroup);\n  groups.push(documentationGroup);\n\n  return groups;\n}\n\nfunction createVariablesTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var variablesGroup = {\n    id : 'variables',\n    label : translate('Variables'),\n    entries: []\n  };\n  variableMapping(variablesGroup, element, bpmnFactory, translate);\n\n  return [\n    variablesGroup\n  ];\n}\n\nfunction createFormsTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var formGroup = {\n    id : 'forms',\n    label : translate('Forms'),\n    entries: []\n  };\n  formProps(formGroup, element, bpmnFactory, translate);\n\n  return [\n    formGroup\n  ];\n}\n\nfunction createListenersTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var listenersGroup = {\n    id : 'listeners',\n    label: translate('Listeners'),\n    entries: []\n  };\n\n  var options = listenerProps(listenersGroup, element, bpmnFactory, translate);\n\n  var listenerDetailsGroup = {\n    id: 'listener-details',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedListener(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedListener(element, node);\n      return getListenerLabel(param, translate);\n    }\n  };\n\n  listenerDetails(listenerDetailsGroup, element, bpmnFactory, options, translate);\n\n  var listenerFieldsGroup = {\n    id: 'listener-fields',\n    label: translate('Field Injection'),\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedListener(element, node);\n    }\n  };\n\n  listenerFields(listenerFieldsGroup, element, bpmnFactory, options, translate);\n\n  return [\n    listenersGroup,\n    listenerDetailsGroup,\n    listenerFieldsGroup\n  ];\n}\n\nfunction createInputOutputTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var inputOutputGroup = {\n    id: 'input-output',\n    label: translate('Parameters'),\n    entries: []\n  };\n\n  var options = inputOutput(inputOutputGroup, element, bpmnFactory, translate);\n\n  var inputOutputParameterGroup = {\n    id: 'input-output-parameter',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedParameter(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedParameter(element, node);\n      return getInputOutputParameterLabel(param, translate);\n    }\n  };\n\n  inputOutputParameter(inputOutputParameterGroup, element, bpmnFactory, options, translate);\n\n  return [\n    inputOutputGroup,\n    inputOutputParameterGroup\n  ];\n}\n\nfunction createConnectorTabGroups(element, bpmnFactory, elementRegistry, translate) {\n  var connectorDetailsGroup = {\n    id: 'connector-details',\n    label: translate('Details'),\n    entries: []\n  };\n\n  connectorDetails(connectorDetailsGroup, element, bpmnFactory, translate);\n\n  var connectorInputOutputGroup = {\n    id: 'connector-input-output',\n    label: translate('Input/Output'),\n    entries: []\n  };\n\n  var options = connectorInputOutput(connectorInputOutputGroup, element, bpmnFactory, translate);\n\n  var connectorInputOutputParameterGroup = {\n    id: 'connector-input-output-parameter',\n    entries: [],\n    enabled: function(element, node) {\n      return options.getSelectedParameter(element, node);\n    },\n    label: function(element, node) {\n      var param = options.getSelectedParameter(element, node);\n      return getInputOutputParameterLabel(param, translate);\n    }\n  };\n\n  connectorInputOutputParameter(connectorInputOutputParameterGroup, element, bpmnFactory, options, translate);\n\n  return [\n    connectorDetailsGroup,\n    connectorInputOutputGroup,\n    connectorInputOutputParameterGroup\n  ];\n}\n\nfunction createFieldInjectionsTabGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var fieldGroup = {\n    id: 'field-injections-properties',\n    label: translate('Field Injections'),\n    entries: []\n  };\n\n  fieldInjections(fieldGroup, element, bpmnFactory, translate);\n\n  return [\n    fieldGroup\n  ];\n}\n\nfunction createExtensionElementsGroups(element, bpmnFactory, elementRegistry, translate) {\n\n  var propertiesGroup = {\n    id : 'extensionElements-properties',\n    label: translate('Properties'),\n    entries: []\n  };\n  properties(propertiesGroup, element, bpmnFactory, translate);\n\n  return [\n    propertiesGroup\n  ];\n}\n\n// Camunda Properties Provider /////////////////////////////////////\n\n\n/**\n * A properties provider for Camunda related properties.\n *\n * @param {EventBus} eventBus\n * @param {Canvas} canvas\n * @param {BpmnFactory} bpmnFactory\n * @param {ElementRegistry} elementRegistry\n * @param {ElementTemplates} elementTemplates\n * @param {Translate} translate\n */\nfunction CamundaPropertiesProvider(\n    eventBus, canvas, bpmnFactory,\n    elementRegistry, elementTemplates, translate) {\n\n  PropertiesActivator.call(this, eventBus);\n\n  this.getTabs = function(element) {\n\n    var generalTab = {\n      id: 'general',\n      label: translate('General'),\n      groups: createGeneralTabGroups(\n        element, canvas, bpmnFactory,\n        elementRegistry, elementTemplates, translate)\n    };\n\n    var variablesTab = {\n      id: 'variables',\n      label: translate('Variables'),\n      groups: createVariablesTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var formsTab = {\n      id: 'forms',\n      label: translate('Forms'),\n      groups: createFormsTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var listenersTab = {\n      id: 'listeners',\n      label: translate('Listeners'),\n      groups: createListenersTabGroups(element, bpmnFactory, elementRegistry, translate),\n      enabled: function(element) {\n        return !eventDefinitionHelper.getLinkEventDefinition(element)\n          || (!is(element, 'bpmn:IntermediateThrowEvent')\n          && eventDefinitionHelper.getLinkEventDefinition(element));\n      }\n    };\n\n    var inputOutputTab = {\n      id: 'input-output',\n      label: translate('Input/Output'),\n      groups: createInputOutputTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var connectorTab = {\n      id: 'connector',\n      label: translate('Connector'),\n      groups: createConnectorTabGroups(element, bpmnFactory, elementRegistry, translate),\n      enabled: function(element) {\n        var bo = implementationTypeHelper.getServiceTaskLikeBusinessObject(element);\n        return bo && implementationTypeHelper.getImplementationType(bo) === 'connector';\n      }\n    };\n\n    var fieldInjectionsTab = {\n      id: 'field-injections',\n      label: translate('Field Injections'),\n      groups: createFieldInjectionsTabGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    var extensionsTab = {\n      id: 'extensionElements',\n      label: translate('Extensions'),\n      groups: createExtensionElementsGroups(element, bpmnFactory, elementRegistry, translate)\n    };\n\n    return [\n      generalTab,\n      variablesTab,\n      connectorTab,\n      formsTab,\n      listenersTab,\n      inputOutputTab,\n      fieldInjectionsTab,\n      extensionsTab\n    ];\n  };\n\n}\n\nCamundaPropertiesProvider.$inject = [\n  'eventBus',\n  'canvas',\n  'bpmnFactory',\n  'elementRegistry',\n  'elementTemplates',\n  'translate'\n];\n\ninherits(CamundaPropertiesProvider, PropertiesActivator);\n\nmodule.exports = CamundaPropertiesProvider;\n","/**\n * Gets the stack value for `key`.\n *\n * @private\n * @name get\n * @memberOf Stack\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction stackGet(key) {\n  return this.__data__.get(key);\n}\n\nmodule.exports = stackGet;\n","/**\n * A specialized version of `_.forEach` for arrays without support for\n * iteratee shorthands.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns `array`.\n */\nfunction arrayEach(array, iteratee) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    if (iteratee(array[index], index, array) === false) {\n      break;\n    }\n  }\n  return array;\n}\n\nmodule.exports = arrayEach;\n","'use strict';\n\nvar forEach = require('lodash/forEach');\n\nvar HANDLERS = {\n  'properties-panel.update-businessobject': require('./UpdateBusinessObjectHandler'),\n  'properties-panel.create-and-reference': require('./CreateAndReferenceHandler'),\n  'properties-panel.create-businessobject-list': require('./CreateBusinessObjectListHandler'),\n  'properties-panel.update-businessobject-list': require('./UpdateBusinessObjectListHandler'),\n  'properties-panel.multi-command-executor': require('./MultiCommandHandler')\n};\n\n\nfunction CommandInitializer(eventBus, commandStack) {\n\n  eventBus.on('diagram.init', function() {\n    forEach(HANDLERS, function(handler, id) {\n      commandStack.registerHandler(id, handler);\n    });\n  });\n}\n\nCommandInitializer.$inject = [ 'eventBus', 'commandStack' ];\n\nmodule.exports = {\n  __init__: [ CommandInitializer ]\n};","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\n/**\n * Create a linkified and HTML escaped entry field description.\n *\n * As a special feature, this description may contain both markdown,\n * plain <a href> links and <br />\n *\n * @param {String} description\n */\nmodule.exports = function entryFieldDescription(description) {\n\n  // we tokenize the description to extract text, HTML and markdown links\n  // text, links and new lines are handled seperately\n\n  var escaped = [];\n\n  // match markdown [{TEXT}]({URL}) and HTML links <a href=\"{URL}\">{TEXT}</a>\n  var pattern = /(?:\\[([^\\]]+)\\]\\((https?:\\/\\/[^)]+)\\))|(?:<a href=\"(https?:\\/\\/[^\"]+)\">(.+?(?=<\\/))<\\/a>)/gi;\n\n  var index = 0;\n  var match;\n  var link, text;\n\n  while ((match = pattern.exec(description))) {\n\n    // escape + insert text before match\n    if (match.index > index) {\n      escaped.push(escapeText(description.substring(index, match.index)));\n    }\n\n    link = match[2] && encodeURI(match[2]) || match[3];\n    text = match[1] || match[4];\n\n    // insert safe link\n    escaped.push('<a href=\"' + link + '\" target=\"_blank\">' + escapeText(text) + '</a>');\n\n    index = match.index + match[0].length;\n  }\n\n  // escape and insert text after last match\n  if (index < description.length) {\n    escaped.push(escapeText(description.substring(index)));\n  }\n\n  return '<div class=\"bpp-field-description\">' + escaped.join('') + '</div>';\n};\n\nfunction escapeText(text) {\n  var match, index = 0, escaped = [];\n\n  // match new line <br/> <br /> <br.... /> etc.\n  var pattern = /<br\\s*\\/?>/gi;\n\n  while ((match = pattern.exec(text))) {\n\n    if (match.index > index) {\n      escaped.push(escapeHTML(text.substring(index, match.index)));\n    }\n\n    escaped.push('<br />');\n\n    index = match.index + match[0].length;\n  }\n\n  if (index < text.length) {\n    escaped.push(escapeHTML(text.substring(index)));\n  }\n\n  return escaped.join('');\n}\n","/**\n * A faster alternative to `Function#apply`, this function invokes `func`\n * with the `this` binding of `thisArg` and the arguments of `args`.\n *\n * @private\n * @param {Function} func The function to invoke.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} args The arguments to invoke `func` with.\n * @returns {*} Returns the result of `func`.\n */\nfunction apply(func, thisArg, args) {\n  switch (args.length) {\n    case 0: return func.call(thisArg);\n    case 1: return func.call(thisArg, args[0]);\n    case 2: return func.call(thisArg, args[0], args[1]);\n    case 3: return func.call(thisArg, args[0], args[1], args[2]);\n  }\n  return func.apply(thisArg, args);\n}\n\nmodule.exports = apply;\n","var baseHasIn = require('./_baseHasIn'),\n    hasPath = require('./_hasPath');\n\n/**\n * Checks if `path` is a direct or inherited property of `object`.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n * @example\n *\n * var object = _.create({ 'a': _.create({ 'b': 2 }) });\n *\n * _.hasIn(object, 'a');\n * // => true\n *\n * _.hasIn(object, 'a.b');\n * // => true\n *\n * _.hasIn(object, ['a', 'b']);\n * // => true\n *\n * _.hasIn(object, 'b');\n * // => false\n */\nfunction hasIn(object, path) {\n  return object != null && hasPath(object, path, baseHasIn);\n}\n\nmodule.exports = hasIn;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    escapeHTML = require('../../../../Utils').escapeHTML;\n\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar domClasses = require('min-dom').classes;\n\n/**\n * Get a property value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n * @param {string} propertyName\n *\n * @return {any} the property value\n */\nfunction getProperty(element, propertyName) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n  return loopCharacteristics && loopCharacteristics.get(propertyName);\n}\n\n/**\n * Get the body of a given expression.\n *\n * @param {ModdleElement<bpmn:FormalExpression>} expression\n *\n * @return {string} the body (value) of the expression\n */\nfunction getBody(expression) {\n  return expression && expression.get('body');\n}\n\n\n/**\n * Get the loop characteristics of an element.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:MultiInstanceLoopCharacteristics>} the loop characteristics\n */\nfunction getLoopCharacteristics(element) {\n  var bo = getBusinessObject(element);\n  return bo.loopCharacteristics;\n}\n\n/**\n * Get the loop cardinality of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:FormalExpression>} an expression representing the loop cardinality\n */\nfunction getLoopCardinality(element) {\n  return getProperty(element, 'loopCardinality');\n}\n\n/**\n * Get the loop cardinality value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the loop cardinality value\n */\nfunction getLoopCardinalityValue(element) {\n  var loopCardinality = getLoopCardinality(element);\n  return getBody(loopCardinality);\n}\n\n/**\n * Get the completion condition of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement<bpmn:FormalExpression>} an expression representing the completion condition\n */\nfunction getCompletionCondition(element) {\n  return getProperty(element, 'completionCondition');\n}\n\n/**\n * Get the completion condition value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the completion condition value\n */\nfunction getCompletionConditionValue(element) {\n  var completionCondition = getCompletionCondition(element);\n  return getBody(completionCondition);\n}\n\n/**\n * Get the 'camunda:collection' attribute value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the 'camunda:collection' value\n */\nfunction getCollection(element) {\n  return getProperty(element, 'camunda:collection');\n}\n\n/**\n * Get the 'camunda:elementVariable' attribute value of the loop characteristics.\n *\n * @param {djs.model.Base} element\n *\n * @return {string} the 'camunda:elementVariable' value\n */\nfunction getElementVariable(element) {\n  return getProperty(element, 'camunda:elementVariable');\n}\n\n\n/**\n * Creates 'bpmn:FormalExpression' element.\n *\n * @param {ModdleElement} parent\n * @param {string} body\n * @param {BpmnFactory} bpmnFactory\n *\n * @result {ModdleElement<bpmn:FormalExpression>} a formal expression\n */\nfunction createFormalExpression(parent, body, bpmnFactory) {\n  return elementHelper.createElement('bpmn:FormalExpression', { body: body }, parent, bpmnFactory);\n}\n\n/**\n * Updates a specific formal expression of the loop characteristics.\n *\n * @param {djs.model.Base} element\n * @param {string} propertyName\n * @param {string} newValue\n * @param {BpmnFactory} bpmnFactory\n */\nfunction updateFormalExpression(element, propertyName, newValue, bpmnFactory) {\n  var loopCharacteristics = getLoopCharacteristics(element);\n\n  var expressionProps = {};\n\n  if (!newValue) {\n    // remove formal expression\n    expressionProps[propertyName] = undefined;\n    return cmdHelper.updateBusinessObject(element, loopCharacteristics, expressionProps);\n  }\n\n  var existingExpression = loopCharacteristics.get(propertyName);\n\n  if (!existingExpression) {\n    // add formal expression\n    expressionProps[propertyName] = createFormalExpression(loopCharacteristics, newValue, bpmnFactory);\n    return cmdHelper.updateBusinessObject(element, loopCharacteristics, expressionProps);\n  }\n\n  // edit existing formal expression\n  return cmdHelper.updateBusinessObject(element, existingExpression, {\n    body: newValue\n  });\n}\n\n\nmodule.exports = function(element, bpmnFactory, translate) {\n\n  var entries = [];\n\n  // error message /////////////////////////////////////////////////////////////////\n\n  entries.push({\n    id: 'multiInstance-errorMessage',\n    html: '<div data-show=\"isValid\">' +\n             '<span class=\"bpp-icon-warning\"></span> ' +\n             escapeHTML(translate('Must provide either loop cardinality or collection')) +\n          '</div>',\n\n    isValid: function(element, node, notification, scope) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n\n      var isValid = true;\n      if (loopCharacteristics) {\n        var loopCardinality = getLoopCardinalityValue(element);\n        var collection = getCollection(element);\n\n        isValid = !loopCardinality && !collection;\n      }\n\n      domClasses(node).toggle('bpp-hidden', !isValid);\n      domClasses(notification).toggle('bpp-error-message', isValid);\n\n      return isValid;\n    }\n  });\n\n  // loop cardinality //////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-loopCardinality',\n    label: translate('Loop Cardinality'),\n    modelProperty: 'loopCardinality',\n\n    get: function(element, node) {\n      return {\n        loopCardinality: getLoopCardinalityValue(element)\n      };\n    },\n\n    set: function(element, values) {\n      return updateFormalExpression(element, 'loopCardinality', values.loopCardinality, bpmnFactory);\n    }\n  }));\n\n\n  // collection //////////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-collection',\n    label: translate('Collection'),\n    modelProperty: 'collection',\n\n    get: function(element, node) {\n      return {\n        collection: getCollection(element)\n      };\n    },\n\n    set: function(element, values) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n      return cmdHelper.updateBusinessObject(element, loopCharacteristics, {\n        'camunda:collection': values.collection || undefined\n      });\n    },\n\n    validate: function(element, values, node) {\n      var collection = getCollection(element);\n      var elementVariable = getElementVariable(element);\n\n      if (!collection && elementVariable) {\n        return { collection : 'Must provide a value' };\n      }\n    }\n  }));\n\n\n  // element variable ////////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-elementVariable',\n    label: translate('Element Variable'),\n    modelProperty: 'elementVariable',\n\n    get: function(element, node) {\n      return {\n        elementVariable: getElementVariable(element)\n      };\n    },\n\n    set: function(element, values) {\n      var loopCharacteristics = getLoopCharacteristics(element);\n      return cmdHelper.updateBusinessObject(element, loopCharacteristics, {\n        'camunda:elementVariable': values.elementVariable || undefined\n      });\n    }\n  }));\n\n\n  // Completion Condition //////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textField({\n    id: 'multiInstance-completionCondition',\n    label: translate('Completion Condition'),\n    modelProperty: 'completionCondition',\n\n    get: function(element) {\n      return {\n        completionCondition: getCompletionConditionValue(element)\n      };\n    },\n\n    set: function(element, values) {\n      return updateFormalExpression(element, 'completionCondition', values.completionCondition, bpmnFactory);\n    }\n  }));\n\n  return entries;\n\n};\n","var defineProperty = require('./_defineProperty');\n\n/**\n * The base implementation of `assignValue` and `assignMergeValue` without\n * value checks.\n *\n * @private\n * @param {Object} object The object to modify.\n * @param {string} key The key of the property to assign.\n * @param {*} value The value to assign.\n */\nfunction baseAssignValue(object, key, value) {\n  if (key == '__proto__' && defineProperty) {\n    defineProperty(object, key, {\n      'configurable': true,\n      'enumerable': true,\n      'value': value,\n      'writable': true\n    });\n  } else {\n    object[key] = value;\n  }\n}\n\nmodule.exports = baseAssignValue;\n","var createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the optional `this`\n * binding of `thisArg`.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createBind(func, bitmask, thisArg) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n    return fn.apply(isBind ? thisArg : this, arguments);\n  }\n  return wrapper;\n}\n\nmodule.exports = createBind;\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, errorEventDefinition, translate) {\n\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, errorEventDefinition, bpmnFactory, {\n    label: translate('Error'),\n    elementName: 'error',\n    elementType: 'bpmn:Error',\n    referenceProperty: 'errorRef',\n    newElementIdPrefix: 'Error_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n    id: 'error-element-name',\n    label: translate('Error Name'),\n    referenceProperty: 'errorRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, errorEventDefinition, bpmnFactory, {\n    id: 'error-element-code',\n    label: translate('Error Code'),\n    referenceProperty: 'errorRef',\n    modelProperty: 'errorCode'\n  }));\n\n};\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('../helper/CmdHelper'),\n    escapeHTML = require('../Utils').escapeHTML;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar checkbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      id = resource.id,\n      label = options.label || id,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n  resource.html =\n    '<input id=\"camunda-' + escapeHTML(id) + '\" ' +\n         'type=\"checkbox\" ' +\n         'name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n         (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n         (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n         ' />' +\n    '<label for=\"camunda-' + escapeHTML(id) + '\" ' +\n         (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n         (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n         '>' + escapeHTML(label) + '</label>';\n\n  // add description below checkbox entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource.get = function(element) {\n    var bo = getBusinessObject(element),\n        res = {};\n\n    res[options.modelProperty] = bo.get(options.modelProperty);\n\n    return res;\n  };\n\n  resource.set = function(element, values) {\n    var res = {};\n\n    res[options.modelProperty] = !!values[options.modelProperty];\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  if (typeof options.set === 'function') {\n    resource.set = options.set;\n  }\n\n  if (typeof options.get === 'function') {\n    resource.get = options.get;\n  }\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-checkbox'];\n\n  return resource;\n};\n\nmodule.exports = checkbox;\n","const {\n  is\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks, whether a gateway forks and joins\n * at the same time.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:Gateway')) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n    const outgoing = node.outgoing || [];\n\n    if (incoming.length > 1 && outgoing.length > 1) {\n      reporter.report(node.id, 'Gateway forks and joins');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseIndexOf = require('./_baseIndexOf');\n\n/**\n * A specialized version of `_.includes` for arrays without support for\n * specifying an index to search from.\n *\n * @private\n * @param {Array} [array] The array to inspect.\n * @param {*} target The value to search for.\n * @returns {boolean} Returns `true` if `target` is found, else `false`.\n */\nfunction arrayIncludes(array, value) {\n  var length = array == null ? 0 : array.length;\n  return !!length && baseIndexOf(array, value, 0) > -1;\n}\n\nmodule.exports = arrayIncludes;\n","var assignValue = require('./_assignValue'),\n    baseAssignValue = require('./_baseAssignValue');\n\n/**\n * Copies properties of `source` to `object`.\n *\n * @private\n * @param {Object} source The object to copy properties from.\n * @param {Array} props The property identifiers to copy.\n * @param {Object} [object={}] The object to copy properties to.\n * @param {Function} [customizer] The function to customize copied values.\n * @returns {Object} Returns `object`.\n */\nfunction copyObject(source, props, object, customizer) {\n  var isNew = !object;\n  object || (object = {});\n\n  var index = -1,\n      length = props.length;\n\n  while (++index < length) {\n    var key = props[index];\n\n    var newValue = customizer\n      ? customizer(object[key], source[key], key, object, source)\n      : undefined;\n\n    if (newValue === undefined) {\n      newValue = source[key];\n    }\n    if (isNew) {\n      baseAssignValue(object, key, newValue);\n    } else {\n      assignValue(object, key, newValue);\n    }\n  }\n  return object;\n}\n\nmodule.exports = copyObject;\n","/**\n * Creates a unary function that invokes `func` with its argument transformed.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {Function} transform The argument transform.\n * @returns {Function} Returns the new function.\n */\nfunction overArg(func, transform) {\n  return function(arg) {\n    return func(transform(arg));\n  };\n}\n\nmodule.exports = overArg;\n","var arrayFilter = require('./_arrayFilter'),\n    baseFilter = require('./_baseFilter'),\n    baseIteratee = require('./_baseIteratee'),\n    isArray = require('./isArray');\n\n/**\n * Iterates over elements of `collection`, returning an array of all elements\n * `predicate` returns truthy for. The predicate is invoked with three\n * arguments: (value, index|key, collection).\n *\n * **Note:** Unlike `_.remove`, this method returns a new array.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [predicate=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n * @see _.reject\n * @example\n *\n * var users = [\n *   { 'user': 'barney', 'age': 36, 'active': true },\n *   { 'user': 'fred',   'age': 40, 'active': false }\n * ];\n *\n * _.filter(users, function(o) { return !o.active; });\n * // => objects for ['fred']\n *\n * // The `_.matches` iteratee shorthand.\n * _.filter(users, { 'age': 36, 'active': true });\n * // => objects for ['barney']\n *\n * // The `_.matchesProperty` iteratee shorthand.\n * _.filter(users, ['active', false]);\n * // => objects for ['fred']\n *\n * // The `_.property` iteratee shorthand.\n * _.filter(users, 'active');\n * // => objects for ['barney']\n */\nfunction filter(collection, predicate) {\n  var func = isArray(collection) ? arrayFilter : baseFilter;\n  return func(collection, baseIteratee(predicate, 3));\n}\n\nmodule.exports = filter;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    asyncContinuation = require('./implementation/AsyncContinuation');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (is(element, 'camunda:AsyncCapable')) {\n\n    group.entries = group.entries.concat(asyncContinuation(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject\n    }, translate));\n\n  }\n};","var getMapData = require('./_getMapData');\n\n/**\n * Removes `key` and its value from the map.\n *\n * @private\n * @name delete\n * @memberOf MapCache\n * @param {string} key The key of the value to remove.\n * @returns {boolean} Returns `true` if the entry was removed, else `false`.\n */\nfunction mapCacheDelete(key) {\n  var result = getMapData(this, key)['delete'](key);\n  this.size -= result ? 1 : 0;\n  return result;\n}\n\nmodule.exports = mapCacheDelete;\n","'use strict';\n\nvar collectionAdd = require('diagram-js/lib/util/Collections').add,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar CategoryHelper = {};\n\nmodule.exports = CategoryHelper;\n\n/**\n * Creates a new bpmn:CategoryValue inside a new bpmn:Category\n *\n * @param {ModdleElement} definitions\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {ModdleElement} categoryValue.\n */\nCategoryHelper.createCategoryValue = function(definitions, bpmnFactory) {\n  var categoryValue = bpmnFactory.create('bpmn:CategoryValue'),\n      category = bpmnFactory.create('bpmn:Category', {\n        categoryValue: [ categoryValue ]\n      });\n\n  // add to correct place\n  collectionAdd(definitions.get('rootElements'), category);\n  getBusinessObject(category).$parent = definitions;\n  getBusinessObject(categoryValue).$parent = category;\n\n  return categoryValue;\n\n};","var isArrayLike = require('./isArrayLike');\n\n/**\n * Creates a `baseEach` or `baseEachRight` function.\n *\n * @private\n * @param {Function} eachFunc The function to iterate over a collection.\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseEach(eachFunc, fromRight) {\n  return function(collection, iteratee) {\n    if (collection == null) {\n      return collection;\n    }\n    if (!isArrayLike(collection)) {\n      return eachFunc(collection, iteratee);\n    }\n    var length = collection.length,\n        index = fromRight ? length : -1,\n        iterable = Object(collection);\n\n    while ((fromRight ? index-- : ++index < length)) {\n      if (iteratee(iterable[index], index, iterable) === false) {\n        break;\n      }\n    }\n    return collection;\n  };\n}\n\nmodule.exports = createBaseEach;\n","var baseGetTag = require('./_baseGetTag'),\n    isObject = require('./isObject');\n\n/** `Object#toString` result references. */\nvar asyncTag = '[object AsyncFunction]',\n    funcTag = '[object Function]',\n    genTag = '[object GeneratorFunction]',\n    proxyTag = '[object Proxy]';\n\n/**\n * Checks if `value` is classified as a `Function` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a function, else `false`.\n * @example\n *\n * _.isFunction(_);\n * // => true\n *\n * _.isFunction(/abc/);\n * // => false\n */\nfunction isFunction(value) {\n  if (!isObject(value)) {\n    return false;\n  }\n  // The use of `Object#toString` avoids issues with the `typeof` operator\n  // in Safari 9 which returns 'object' for typed arrays and other constructors.\n  var tag = baseGetTag(value);\n  return tag == funcTag || tag == genTag || tag == asyncTag || tag == proxyTag;\n}\n\nmodule.exports = isFunction;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper');\n\nvar assign = require('lodash/assign');\nvar map = require('lodash/map');\n\nvar DEFAULT_DELEGATE_PROPS = [ 'class', 'expression', 'delegateExpression' ];\n\nvar DELEGATE_PROPS = {\n  'camunda:class': undefined,\n  'camunda:expression': undefined,\n  'camunda:delegateExpression': undefined,\n  'camunda:resultVariable': undefined\n};\n\nvar DMN_CAPABLE_PROPS = {\n  'camunda:decisionRef': undefined,\n  'camunda:decisionRefBinding': 'latest',\n  'camunda:decisionRefVersion': undefined,\n  'camunda:mapDecisionResult': 'resultList',\n  'camunda:decisionRefTenantId': undefined\n};\n\n\nvar EXTERNAL_CAPABLE_PROPS = {\n  'camunda:type': undefined,\n  'camunda:topic': undefined\n};\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var DEFAULT_OPTIONS = [\n    { value: 'class', name: translate('Java Class') },\n    { value: 'expression', name: translate('Expression') },\n    { value: 'delegateExpression', name: translate('Delegate Expression') }\n  ];\n\n  var DMN_OPTION = [\n    { value: 'dmn', name: translate('DMN') }\n  ];\n\n  var EXTERNAL_OPTION = [\n    { value: 'external', name: translate('External') }\n  ];\n\n  var CONNECTOR_OPTION = [\n    { value: 'connector', name: translate('Connector') }\n  ];\n\n  var SCRIPT_OPTION = [\n    { value: 'script', name: translate('Script') }\n  ];\n\n  var getType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  var hasDmnSupport = options.hasDmnSupport,\n      hasExternalSupport = options.hasExternalSupport,\n      hasServiceTaskLikeSupport = options.hasServiceTaskLikeSupport,\n      hasScriptSupport = options.hasScriptSupport;\n\n  var entries = [];\n\n  var selectOptions = DEFAULT_OPTIONS.concat([]);\n\n  if (hasDmnSupport) {\n    selectOptions = selectOptions.concat(DMN_OPTION);\n  }\n\n  if (hasExternalSupport) {\n    selectOptions = selectOptions.concat(EXTERNAL_OPTION);\n  }\n\n  if (hasServiceTaskLikeSupport) {\n    selectOptions = selectOptions.concat(CONNECTOR_OPTION);\n  }\n\n  if (hasScriptSupport) {\n    selectOptions = selectOptions.concat(SCRIPT_OPTION);\n  }\n\n  selectOptions.push({ value: '' });\n\n  entries.push(entryFactory.selectBox({\n    id : 'implementation',\n    label: translate('Implementation'),\n    selectOptions: selectOptions,\n    modelProperty: 'implType',\n\n    get: function(element, node) {\n      return {\n        implType: getType(element) || ''\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var oldType = getType(element);\n      var newType = values.implType;\n\n      var props = assign({}, DELEGATE_PROPS);\n\n      if (DEFAULT_DELEGATE_PROPS.indexOf(newType) !== -1) {\n\n        var newValue = '';\n        if (DEFAULT_DELEGATE_PROPS.indexOf(oldType) !== -1) {\n          newValue = bo.get('camunda:' + oldType);\n        }\n        props['camunda:' + newType] = newValue;\n      }\n\n      if (hasDmnSupport) {\n        props = assign(props, DMN_CAPABLE_PROPS);\n        if (newType === 'dmn') {\n          props['camunda:decisionRef'] = '';\n        }\n      }\n\n      if (hasExternalSupport) {\n        props = assign(props, EXTERNAL_CAPABLE_PROPS);\n        if (newType === 'external') {\n          props['camunda:type'] = 'external';\n          props['camunda:topic'] = '';\n        }\n      }\n\n      if (hasScriptSupport) {\n        props['camunda:script'] = undefined;\n\n        if (newType === 'script') {\n          props['camunda:script'] = elementHelper.createElement('camunda:Script', {}, bo, bpmnFactory);\n        }\n      }\n\n      var commands = [];\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n\n      if (hasServiceTaskLikeSupport) {\n        var connectors = extensionElementsHelper.getExtensionElements(bo, 'camunda:Connector');\n        commands.push(map(connectors, function(connector) {\n          return extensionElementsHelper.removeEntry(bo, element, connector);\n        }));\n\n        if (newType === 'connector') {\n          var extensionElements = bo.get('extensionElements');\n          if (!extensionElements) {\n            extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n            commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n          }\n          var connector = elementHelper.createElement('camunda:Connector', {}, extensionElements, bpmnFactory);\n          commands.push(cmdHelper.addAndRemoveElementsFromList(\n            element,\n            extensionElements,\n            'values',\n            'extensionElements',\n            [ connector ],\n            []\n          ));\n        }\n      }\n\n      return commands;\n\n    }\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    entryFactory = require('../../../factory/EntryFactory'),\n    participantHelper = require('../../../helper/ParticipantHelper'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    nameEntryFactory = require('./implementation/Name'),\n    utils = require('../../../Utils');\n\nmodule.exports = function(group, element, translate, options) {\n  var businessObject = getBusinessObject(element);\n\n  var processIdDescription = options && options.processIdDescription;\n\n  if (is(element, 'bpmn:Process') || (is(element, 'bpmn:Participant') && businessObject.get('processRef'))) {\n\n    /**\n     * processId\n     */\n    if (is(element, 'bpmn:Participant')) {\n      var idEntry = entryFactory.validationAwareTextField({\n        id: 'process-id',\n        label: translate('Process Id'),\n        description: processIdDescription && translate(processIdDescription),\n        modelProperty: 'processId'\n      });\n\n      // in participants we have to change the default behavior of set and get\n      idEntry.get = function(element) {\n        var properties = participantHelper.getProcessBusinessObject(element, 'id');\n        return { processId: properties.id };\n      };\n\n      idEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'id', { id: values.processId });\n      };\n\n      idEntry.validate = function(element, values) {\n        var idValue = values.processId;\n\n        var bo = getBusinessObject(element);\n\n        var processIdError = utils.isIdValid(bo.processRef, idValue, translate);\n\n        return processIdError ? { processId: processIdError } : {};\n      };\n\n      group.entries.push(idEntry);\n\n\n      /**\n       * process name\n       */\n      var processNameEntry = nameEntryFactory(element, {\n        id: 'process-name',\n        label: translate('Process Name')\n      })[0];\n\n      // in participants we have to change the default behavior of set and get\n      processNameEntry.get = function(element) {\n        return participantHelper.getProcessBusinessObject(element, 'name');\n      };\n\n      processNameEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'name', values);\n      };\n\n      group.entries.push(processNameEntry);\n    }\n  }\n};\n","/**\n * Performs a\n * [`SameValueZero`](http://ecma-international.org/ecma-262/7.0/#sec-samevaluezero)\n * comparison between two values to determine if they are equivalent.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n * @example\n *\n * var object = { 'a': 1 };\n * var other = { 'a': 1 };\n *\n * _.eq(object, object);\n * // => true\n *\n * _.eq(object, other);\n * // => false\n *\n * _.eq('a', 'a');\n * // => true\n *\n * _.eq('a', Object('a'));\n * // => false\n *\n * _.eq(NaN, NaN);\n * // => true\n */\nfunction eq(value, other) {\n  return value === other || (value !== value && other !== other);\n}\n\nmodule.exports = eq;\n","var Stack = require('./_Stack'),\n    baseIsEqual = require('./_baseIsEqual');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * The base implementation of `_.isMatch` without support for iteratee shorthands.\n *\n * @private\n * @param {Object} object The object to inspect.\n * @param {Object} source The object of property values to match.\n * @param {Array} matchData The property names, values, and compare flags to match.\n * @param {Function} [customizer] The function to customize comparisons.\n * @returns {boolean} Returns `true` if `object` is a match, else `false`.\n */\nfunction baseIsMatch(object, source, matchData, customizer) {\n  var index = matchData.length,\n      length = index,\n      noCustomizer = !customizer;\n\n  if (object == null) {\n    return !length;\n  }\n  object = Object(object);\n  while (index--) {\n    var data = matchData[index];\n    if ((noCustomizer && data[2])\n          ? data[1] !== object[data[0]]\n          : !(data[0] in object)\n        ) {\n      return false;\n    }\n  }\n  while (++index < length) {\n    data = matchData[index];\n    var key = data[0],\n        objValue = object[key],\n        srcValue = data[1];\n\n    if (noCustomizer && data[2]) {\n      if (objValue === undefined && !(key in object)) {\n        return false;\n      }\n    } else {\n      var stack = new Stack;\n      if (customizer) {\n        var result = customizer(objValue, srcValue, key, object, source, stack);\n      }\n      if (!(result === undefined\n            ? baseIsEqual(srcValue, objValue, COMPARE_PARTIAL_FLAG | COMPARE_UNORDERED_FLAG, customizer, stack)\n            : result\n          )) {\n        return false;\n      }\n    }\n  }\n  return true;\n}\n\nmodule.exports = baseIsMatch;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getExtensionElements = require('./ExtensionElementsHelper').getExtensionElements;\n\nvar FormHelper = {};\n\nmodule.exports = FormHelper;\n\n/**\n * Return form data from business object or undefined if none exist\n *\n * @param  {djs.model.Base} element\n *\n * @return {ModdleElement|undefined} formData\n */\nFormHelper.getFormData = function(element) {\n  var bo = getBusinessObject(element);\n\n  var formData = getExtensionElements(bo, 'camunda:FormData');\n\n  if (typeof formData !== 'undefined') {\n    return formData[0];\n  }\n};\n\n\n/**\n * Return all form fields existing in the business object, and\n * an empty array if none exist.\n *\n * @param  {djs.model.Base} element\n *\n * @return {Array} a list of form field objects\n */\nFormHelper.getFormFields = function(element) {\n  var formData = this.getFormData(element);\n\n  if (typeof formData === 'undefined') {\n    return [];\n  }\n\n  return formData.fields || [];\n};\n\n\n/**\n * Get a form field from the business object at given index\n *\n * @param {djs.model.Base} element\n * @param {number} idx\n *\n * @return {ModdleElement} the form field\n */\nFormHelper.getFormField = function(element, idx) {\n\n  var formFields = this.getFormFields(element);\n\n  return formFields[idx];\n};\n\n\n/**\n * Get all constraints for a specific form field from the business object\n *\n * @param  {ModdleElement} formField\n *\n * @return {Array<ModdleElement>} a list of constraint objects\n */\nFormHelper.getConstraints = function(formField) {\n  if (formField && formField.validation && formField.validation.constraints) {\n    return formField.validation.constraints;\n  }\n  return [];\n};\n\n\n/**\n * Get all camunda:value objects for a specific form field from the business object\n *\n * @param  {ModdleElement} formField\n *\n * @return {Array<ModdleElement>} a list of camunda:value objects\n */\nFormHelper.getEnumValues = function(formField) {\n  if (formField && formField.values) {\n    return formField.values;\n  }\n  return [];\n};\n\n","var baseEach = require('./_baseEach'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * The base implementation of `_.map` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} iteratee The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n */\nfunction baseMap(collection, iteratee) {\n  var index = -1,\n      result = isArrayLike(collection) ? Array(collection.length) : [];\n\n  baseEach(collection, function(value, key, collection) {\n    result[++index] = iteratee(value, key, collection);\n  });\n  return result;\n}\n\nmodule.exports = baseMap;\n","var baseFlatten = require('./_baseFlatten');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Recursively flattens `array`.\n *\n * @static\n * @memberOf _\n * @since 3.0.0\n * @category Array\n * @param {Array} array The array to flatten.\n * @returns {Array} Returns the new flattened array.\n * @example\n *\n * _.flattenDeep([1, [2, [3, [4]], 5]]);\n * // => [1, 2, 3, 4, 5]\n */\nfunction flattenDeep(array) {\n  var length = array == null ? 0 : array.length;\n  return length ? baseFlatten(array, INFINITY) : [];\n}\n\nmodule.exports = flattenDeep;\n","/**\n * Creates a base function for methods like `_.forIn` and `_.forOwn`.\n *\n * @private\n * @param {boolean} [fromRight] Specify iterating from right to left.\n * @returns {Function} Returns the new base function.\n */\nfunction createBaseFor(fromRight) {\n  return function(object, iteratee, keysFunc) {\n    var index = -1,\n        iterable = Object(object),\n        props = keysFunc(object),\n        length = props.length;\n\n    while (length--) {\n      var key = props[fromRight ? length : ++index];\n      if (iteratee(iterable[key], key, iterable) === false) {\n        break;\n      }\n    }\n    return object;\n  };\n}\n\nmodule.exports = createBaseFor;\n","var freeGlobal = require('./_freeGlobal');\n\n/** Detect free variable `exports`. */\nvar freeExports = typeof exports == 'object' && exports && !exports.nodeType && exports;\n\n/** Detect free variable `module`. */\nvar freeModule = freeExports && typeof module == 'object' && module && !module.nodeType && module;\n\n/** Detect the popular CommonJS extension `module.exports`. */\nvar moduleExports = freeModule && freeModule.exports === freeExports;\n\n/** Detect free variable `process` from Node.js. */\nvar freeProcess = moduleExports && freeGlobal.process;\n\n/** Used to access faster Node.js helpers. */\nvar nodeUtil = (function() {\n  try {\n    // Use `util.types` for Node.js 10+.\n    var types = freeModule && freeModule.require && freeModule.require('util').types;\n\n    if (types) {\n      return types;\n    }\n\n    // Legacy `process.binding('util')` for Node.js < 10.\n    return freeProcess && freeProcess.binding && freeProcess.binding('util');\n  } catch (e) {}\n}());\n\nmodule.exports = nodeUtil;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getTemplate = require('../Helper').getTemplate,\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    elementHelper = require('../../../../helper/ElementHelper');\n\nvar findExtension = require('../Helper').findExtension,\n    findExtensions = require('../Helper').findExtensions,\n    findInputParameter = require('../Helper').findInputParameter,\n    findOutputParameter = require('../Helper').findOutputParameter,\n    findCamundaProperty = require('../Helper').findCamundaProperty,\n    findCamundaInOut = require('../Helper').findCamundaInOut;\n\nvar createCamundaProperty = require('../CreateHelper').createCamundaProperty,\n    createInputParameter = require('../CreateHelper').createInputParameter,\n    createOutputParameter = require('../CreateHelper').createOutputParameter,\n    createCamundaIn = require('../CreateHelper').createCamundaIn,\n    createCamundaOut = require('../CreateHelper').createCamundaOut,\n    createCamundaInWithBusinessKey = require('../CreateHelper').createCamundaInWithBusinessKey,\n    createCamundaFieldInjection = require('../CreateHelper').createCamundaFieldInjection;\n\nvar CAMUNDA_PROPERTY_TYPE = 'camunda:property',\n    CAMUNDA_INPUT_PARAMETER_TYPE = 'camunda:inputParameter',\n    CAMUNDA_OUTPUT_PARAMETER_TYPE = 'camunda:outputParameter',\n    CAMUNDA_IN_TYPE = 'camunda:in',\n    CAMUNDA_OUT_TYPE = 'camunda:out',\n    CAMUNDA_IN_BUSINESS_KEY_TYPE = 'camunda:in:businessKey',\n    CAMUNDA_EXECUTION_LISTENER_TYPE = 'camunda:executionListener',\n    CAMUNDA_FIELD = 'camunda:field';\n\nvar BASIC_MODDLE_TYPES = [\n  'Boolean',\n  'Integer',\n  'String'\n];\n\nvar EXTENSION_BINDING_TYPES = [\n  CAMUNDA_PROPERTY_TYPE,\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE,\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE,\n  CAMUNDA_FIELD\n];\n\nvar IO_BINDING_TYPES = [\n  CAMUNDA_INPUT_PARAMETER_TYPE,\n  CAMUNDA_OUTPUT_PARAMETER_TYPE\n];\n\nvar IN_OUT_BINDING_TYPES = [\n  CAMUNDA_IN_TYPE,\n  CAMUNDA_OUT_TYPE,\n  CAMUNDA_IN_BUSINESS_KEY_TYPE\n];\n\n/**\n * Injects custom properties into the given group.\n *\n * @param {djs.model.Base} element\n * @param {ElementTemplates} elementTemplates\n * @param {BpmnFactory} bpmnFactory\n * @param {Function} translate\n */\nmodule.exports = function(element, elementTemplates, bpmnFactory, translate) {\n\n  var template = getTemplate(element, elementTemplates);\n\n  if (!template) {\n    return [];\n  }\n\n  var renderCustomField = function(id, p, idx) {\n    var propertyType = p.type;\n\n    var entryOptions = {\n      id: id,\n      description: p.description,\n      label: p.label ? translate(p.label) : p.label,\n      modelProperty: id,\n      get: propertyGetter(id, p),\n      set: propertySetter(id, p, bpmnFactory),\n      validate: propertyValidator(id, p, translate)\n    };\n\n    var entry;\n\n    if (propertyType === 'Boolean') {\n      entry = entryFactory.checkbox(entryOptions);\n    }\n\n    if (propertyType === 'String') {\n      entry = entryFactory.textField(entryOptions);\n    }\n\n    if (propertyType === 'Text') {\n      entry = entryFactory.textBox(entryOptions);\n    }\n\n    if (propertyType === 'Dropdown') {\n      entryOptions.selectOptions = p.choices;\n\n      entry = entryFactory.selectBox(entryOptions);\n    }\n\n    return entry;\n  };\n\n  var groups = [];\n  var id, entry;\n\n  var customFieldsGroup = {\n    id: 'customField',\n    label: translate('Custom Fields'),\n    entries: []\n  };\n  template.properties.forEach(function(p, idx) {\n\n    id = 'custom-' + template.id + '-' + idx;\n\n    entry = renderCustomField(id, p, idx);\n    if (entry) {\n      customFieldsGroup.entries.push(entry);\n    }\n  });\n  if (customFieldsGroup.entries.length > 0) {\n    groups.push(customFieldsGroup);\n  }\n\n  if (template.scopes) {\n    for (var scopeName in template.scopes) {\n\n      var scope = template.scopes[scopeName];\n      var idScopeName = scopeName.replace(/:/g, '_');\n\n      var customScopeFieldsGroup = {\n        id: 'customField-' + idScopeName,\n        label: translate('Custom Fields for scope: ') + scopeName,\n        entries: []\n      };\n\n      scope.properties.forEach(function(p, idx) {\n\n        var propertyId = 'custom-' + template.id + '-' + idScopeName + '-' + idx;\n\n        var scopedProperty = propertyWithScope(p, scopeName);\n\n        entry = renderCustomField(propertyId, scopedProperty, idx);\n        if (entry) {\n          customScopeFieldsGroup.entries.push(entry);\n        }\n      });\n\n      if (customScopeFieldsGroup.entries.length > 0) {\n        groups.push(customScopeFieldsGroup);\n      }\n    }\n  }\n\n  return groups;\n};\n\n\n// getters, setters and validators ///////////////\n\n\n/**\n * Return a getter that retrieves the given property.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n *\n * @return {Function}\n */\nfunction propertyGetter(name, property) {\n\n  /* getter */\n  return function get(element) {\n    var value = getPropertyValue(element, property);\n\n    return objectWithKey(name, value);\n  };\n}\n\n/**\n * Return a setter that updates the given property.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {Function}\n */\nfunction propertySetter(name, property, bpmnFactory) {\n\n  /* setter */\n  return function set(element, values) {\n\n    var value = values[name];\n\n    return setPropertyValue(element, property, value, bpmnFactory);\n  };\n}\n\n/**\n * Return a validator that ensures the property is ok.\n *\n * @param {String} name\n * @param {PropertyDescriptor} property\n * @param {Function} translate\n *\n * @return {Function}\n */\nfunction propertyValidator(name, property, translate) {\n\n  /* validator */\n  return function validate(element, values) {\n    var value = values[name];\n\n    var error = validateValue(value, property, translate);\n\n    if (error) {\n      return objectWithKey(name, error);\n    }\n  };\n}\n\n\n// get, set and validate helpers ///////////////////\n\n/**\n * Return the value of the specified property descriptor,\n * on the passed diagram element.\n *\n * @param {djs.model.Base} element\n * @param {PropertyDescriptor} property\n *\n * @return {Any}\n */\nfunction getPropertyValue(element, property) {\n\n  var bo = getBusinessObject(element);\n\n  var binding = property.binding,\n      scope = property.scope;\n\n  var bindingType = binding.type,\n      bindingName = binding.name;\n\n  var propertyValue = property.value || '';\n\n  if (scope) {\n    bo = findExtension(bo, scope.name);\n    if (!bo) {\n      return propertyValue;\n    }\n  }\n\n  // property\n  if (bindingType === 'property') {\n\n    var value = bo.get(bindingName);\n\n    if (bindingName === 'conditionExpression') {\n      if (value) {\n        return value.body;\n      } else {\n        // return defined default\n        return propertyValue;\n      }\n    } else {\n      // return value; default to defined default\n      return typeof value !== 'undefined' ? value : propertyValue;\n    }\n  }\n\n  var camundaProperties,\n      camundaProperty;\n\n  if (bindingType === CAMUNDA_PROPERTY_TYPE) {\n    if (scope) {\n      camundaProperties = bo.get('properties');\n    } else {\n      camundaProperties = findExtension(bo, 'camunda:Properties');\n    }\n\n    if (camundaProperties) {\n      camundaProperty = findCamundaProperty(camundaProperties, binding);\n\n      if (camundaProperty) {\n        return camundaProperty.value;\n      }\n    }\n\n    return propertyValue;\n  }\n\n  var inputOutput,\n      ioParameter;\n\n  if (IO_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    if (scope) {\n      inputOutput = bo.get('inputOutput');\n    } else {\n      inputOutput = findExtension(bo, 'camunda:InputOutput');\n    }\n\n    if (!inputOutput) {\n      // ioParameter cannot exist yet, return property value\n      return propertyValue;\n    }\n  }\n\n  // camunda input parameter\n  if (bindingType === CAMUNDA_INPUT_PARAMETER_TYPE) {\n    ioParameter = findInputParameter(inputOutput, binding);\n\n    if (ioParameter) {\n      if (binding.scriptFormat) {\n        if (ioParameter.definition) {\n          return ioParameter.definition.value;\n        }\n      } else {\n        return ioParameter.value || '';\n      }\n    }\n\n    return propertyValue;\n  }\n\n  // camunda output parameter\n  if (binding.type === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n    ioParameter = findOutputParameter(inputOutput, binding);\n\n    if (ioParameter) {\n      return ioParameter.name;\n    }\n\n    return propertyValue;\n  }\n\n\n  var ioElement;\n\n  if (IN_OUT_BINDING_TYPES.indexOf(bindingType) != -1) {\n    ioElement = findCamundaInOut(bo, binding);\n\n    if (ioElement) {\n      if (bindingType === CAMUNDA_IN_BUSINESS_KEY_TYPE) {\n        return ioElement.businessKey;\n      } else\n      if (bindingType === CAMUNDA_OUT_TYPE) {\n        return ioElement.target;\n      } else\n      if (bindingType === CAMUNDA_IN_TYPE) {\n        return ioElement[binding.expression ? 'sourceExpression' : 'source'];\n      }\n    }\n\n    return propertyValue;\n  }\n\n  if (bindingType === CAMUNDA_EXECUTION_LISTENER_TYPE) {\n    var executionListener;\n    if (scope) {\n      executionListener = bo.get('executionListener');\n    } else {\n      executionListener = findExtension(bo, 'camunda:ExecutionListener');\n    }\n\n    return executionListener.script.value;\n  }\n\n  var fieldInjection;\n  if (CAMUNDA_FIELD === bindingType) {\n    var fieldInjections = findExtensions(bo, [ 'camunda:Field' ]);\n    fieldInjections.forEach(function(item) {\n      if (item.name === binding.name) {\n        fieldInjection = item;\n      }\n    });\n    if (fieldInjection) {\n      return fieldInjection.string || fieldInjection.expression;\n    } else {\n      return '';\n    }\n  }\n\n  throw unknownPropertyBinding(property);\n}\n\nmodule.exports.getPropertyValue = getPropertyValue;\n\n\n/**\n * Return an update operation that changes the diagram\n * element's custom property to the given value.\n *\n * The response of this method will be processed via\n * {@link PropertiesPanel#applyChanges}.\n *\n * @param {djs.model.Base} element\n * @param {PropertyDescriptor} property\n * @param {String} value\n * @param {BpmnFactory} bpmnFactory\n *\n * @return {Object|Array<Object>} results to be processed\n */\nfunction setPropertyValue(element, property, value, bpmnFactory) {\n  var bo = getBusinessObject(element);\n\n  var binding = property.binding,\n      scope = property.scope;\n\n  var bindingType = binding.type,\n      bindingName = binding.name;\n\n  var propertyValue;\n\n  var updates = [];\n\n  var extensionElements;\n\n  if (EXTENSION_BINDING_TYPES.indexOf(bindingType) !== -1) {\n    extensionElements = bo.get('extensionElements');\n\n    // create extension elements, if they do not exist (yet)\n    if (!extensionElements) {\n      extensionElements = elementHelper.createElement('bpmn:ExtensionElements', null, element, bpmnFactory);\n\n      updates.push(cmdHelper.updateBusinessObject(\n        element, bo, objectWithKey('extensionElements', extensionElements)\n      ));\n    }\n  }\n\n  if (scope) {\n    bo = findExtension(bo, scope.name);\n    if (!bo) {\n      bo = elementHelper.createElement(scope.name, null, element, bpmnFactory);\n\n      updates.push(cmdHelper.addElementsTolist(\n        bo, extensionElements, 'values', [ bo ]\n      ));\n    }\n  }\n\n  // property\n  if (bindingType === 'property') {\n\n    if (bindingName === 'conditionExpression') {\n\n      propertyValue = elementHelper.createElement('bpmn:FormalExpression', {\n        body: value,\n        language: binding.scriptFormat\n      }, bo, bpmnFactory);\n    } else {\n\n      var moddlePropertyDescriptor = bo.$descriptor.propertiesByName[bindingName];\n\n      var moddleType = moddlePropertyDescriptor.type;\n\n      // make sure we only update String, Integer, Real and\n      // Boolean properties (do not accidentally override complex objects...)\n      if (BASIC_MODDLE_TYPES.indexOf(moddleType) === -1) {\n        throw new Error('cannot set moddle type <' + moddleType + '>');\n      }\n\n      if (moddleType === 'Boolean') {\n        propertyValue = !!value;\n      } else\n      if (moddleType === 'Integer') {\n        propertyValue = parseInt(value, 10);\n\n        if (isNaN(propertyValue)) {\n          // do not write NaN value\n          propertyValue = undefined;\n        }\n      } else {\n        propertyValue = value;\n      }\n    }\n\n    if (propertyValue !== undefined) {\n      updates.push(cmdHelper.updateBusinessObject(\n        element, bo, objectWithKey(bindingName, propertyValue)\n      ));\n    }\n  }\n\n  // camunda:property\n  var camundaProperties,\n      existingCamundaProperty,\n      newCamundaProperty;\n\n  if (bindingType === CAMUNDA_PROPERTY_TYPE) {\n\n    if (scope) {\n      camundaProperties = bo.get('properties');\n    } else {\n      camundaProperties = findExtension(extensionElements, 'camunda:Properties');\n    }\n\n    if (!camundaProperties) {\n      camundaProperties = elementHelper.createElement('camunda:Properties', null, bo, bpmnFactory);\n\n      if (scope) {\n        updates.push(cmdHelper.updateBusinessObject(\n          element, bo, { properties: camundaProperties }\n        ));\n      }\n      else {\n        updates.push(cmdHelper.addElementsTolist(\n          element, extensionElements, 'values', [ camundaProperties ]\n        ));\n      }\n    }\n\n    existingCamundaProperty = findCamundaProperty(camundaProperties, binding);\n\n    newCamundaProperty = createCamundaProperty(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      camundaProperties,\n      'values',\n      null,\n      [ newCamundaProperty ],\n      existingCamundaProperty ? [ existingCamundaProperty ] : []\n    ));\n  }\n\n  // camunda:inputParameter\n  // camunda:outputParameter\n  var inputOutput,\n      existingIoParameter,\n      newIoParameter;\n\n  if (IO_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    if (scope) {\n      inputOutput = bo.get('inputOutput');\n    } else {\n      inputOutput = findExtension(extensionElements, 'camunda:InputOutput');\n    }\n\n    // create inputOutput element, if it do not exist (yet)\n    if (!inputOutput) {\n      inputOutput = elementHelper.createElement('camunda:InputOutput', null, bo, bpmnFactory);\n\n      if (scope) {\n        updates.push(cmdHelper.updateBusinessObject(\n          element, bo, { inputOutput: inputOutput }\n        ));\n      }\n      else {\n        updates.push(cmdHelper.addElementsTolist(\n          element, extensionElements, 'values', inputOutput\n        ));\n      }\n    }\n  }\n\n  if (bindingType === CAMUNDA_INPUT_PARAMETER_TYPE) {\n\n    existingIoParameter = findInputParameter(inputOutput, binding);\n\n    newIoParameter = createInputParameter(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      inputOutput,\n      'inputParameters',\n      null,\n      [ newIoParameter ],\n      existingIoParameter ? [ existingIoParameter ] : []\n    ));\n  }\n\n  if (bindingType === CAMUNDA_OUTPUT_PARAMETER_TYPE) {\n\n    existingIoParameter = findOutputParameter(inputOutput, binding);\n\n    newIoParameter = createOutputParameter(binding, value, bpmnFactory);\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      inputOutput,\n      'outputParameters',\n      null,\n      [ newIoParameter ],\n      existingIoParameter ? [ existingIoParameter ] : []\n    ));\n  }\n\n\n  // camunda:in\n  // camunda:out\n  // camunda:in:businessKey\n  var existingInOut,\n      newInOut;\n\n  if (IN_OUT_BINDING_TYPES.indexOf(bindingType) !== -1) {\n\n    existingInOut = findCamundaInOut(bo, binding);\n\n    if (bindingType === CAMUNDA_IN_TYPE) {\n      newInOut = createCamundaIn(binding, value, bpmnFactory);\n    } else\n    if (bindingType === CAMUNDA_OUT_TYPE) {\n      newInOut = createCamundaOut(binding, value, bpmnFactory);\n    } else {\n      newInOut = createCamundaInWithBusinessKey(binding, value, bpmnFactory);\n    }\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      null,\n      [ newInOut ],\n      existingInOut ? [ existingInOut ] : []\n    ));\n  }\n\n  if (bindingType === CAMUNDA_FIELD) {\n    var existingFieldInjections = findExtensions(bo, [ 'camunda:Field' ]);\n    var newFieldInjections = [];\n\n    if (existingFieldInjections.length > 0) {\n      existingFieldInjections.forEach(function(item) {\n        if (item.name === binding.name) {\n          newFieldInjections.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n        } else {\n          newFieldInjections.push(item);\n        }\n      });\n    } else {\n      newFieldInjections.push(createCamundaFieldInjection(binding, value, bpmnFactory));\n    }\n\n    updates.push(cmdHelper.addAndRemoveElementsFromList(\n      element,\n      extensionElements,\n      'values',\n      null,\n      newFieldInjections,\n      existingFieldInjections ? existingFieldInjections : []\n    ));\n  }\n\n  if (updates.length) {\n    return updates;\n  }\n\n  // quick warning for better debugging\n  console.warn('no update', element, property, value);\n}\n\nmodule.exports.setPropertyValue = setPropertyValue;\n\n/**\n * Validate value of a given property.\n *\n * @param {String} value\n * @param {PropertyDescriptor} property\n * @param {Function} translate\n *\n * @return {Object} with validation errors\n */\nfunction validateValue(value, property, translate) {\n\n  var constraints = property.constraints || {};\n\n  if (constraints.notEmpty && isEmpty(value)) {\n    return translate('Must not be empty');\n  }\n\n  if (constraints.maxLength && value.length > constraints.maxLength) {\n    return translate('Must have max length {length}', { length: constraints.maxLength });\n  }\n\n  if (constraints.minLength && value.length < constraints.minLength) {\n    return translate('Must have min length {length}', { length: constraints.minLength });\n  }\n\n  var pattern = constraints.pattern,\n      message;\n\n  if (pattern) {\n\n    if (typeof pattern !== 'string') {\n      message = pattern.message;\n      pattern = pattern.value;\n    }\n\n    if (!matchesPattern(value, pattern)) {\n      return message || translate('Must match pattern {pattern}', { pattern: pattern });\n    }\n  }\n}\n\n\n// misc helpers ///////////////////////////////\n\nfunction propertyWithScope(property, scopeName) {\n  if (!scopeName) {\n    return property;\n  }\n\n  return assign({}, property, {\n    scope: {\n      name: scopeName\n    }\n  });\n}\n\n/**\n * Return an object with a single key -> value association.\n *\n * @param {String} key\n * @param {Any} value\n *\n * @return {Object}\n */\nfunction objectWithKey(key, value) {\n  var obj = {};\n\n  obj[key] = value;\n\n  return obj;\n}\n\n/**\n * Does the given string match the specified pattern?\n *\n * @param {String} str\n * @param {String} pattern\n *\n * @return {Boolean}\n */\nfunction matchesPattern(str, pattern) {\n  var regexp = new RegExp(pattern);\n\n  return regexp.test(str);\n}\n\nfunction isEmpty(str) {\n  return !str || /^\\s*$/.test(str);\n}\n\n/**\n * Create a new {@link Error} indicating an unknown\n * property binding.\n *\n * @param {PropertyDescriptor} property\n *\n * @return {Error}\n */\nfunction unknownPropertyBinding(property) {\n  var binding = property.binding;\n\n  return new Error('unknown binding: <' + binding.type + '>');\n}\n","var eq = require('./eq'),\n    isArrayLike = require('./isArrayLike'),\n    isIndex = require('./_isIndex'),\n    isObject = require('./isObject');\n\n/**\n * Checks if the given arguments are from an iteratee call.\n *\n * @private\n * @param {*} value The potential iteratee value argument.\n * @param {*} index The potential iteratee index or key argument.\n * @param {*} object The potential iteratee object argument.\n * @returns {boolean} Returns `true` if the arguments are from an iteratee call,\n *  else `false`.\n */\nfunction isIterateeCall(value, index, object) {\n  if (!isObject(object)) {\n    return false;\n  }\n  var type = typeof index;\n  if (type == 'number'\n        ? (isArrayLike(object) && isIndex(index, object.length))\n        : (type == 'string' && index in object)\n      ) {\n    return eq(object[index], value);\n  }\n  return false;\n}\n\nmodule.exports = isIterateeCall;\n","var baseGet = require('./_baseGet');\n\n/**\n * Gets the value at `path` of `object`. If the resolved value is\n * `undefined`, the `defaultValue` is returned in its place.\n *\n * @static\n * @memberOf _\n * @since 3.7.0\n * @category Object\n * @param {Object} object The object to query.\n * @param {Array|string} path The path of the property to get.\n * @param {*} [defaultValue] The value returned for `undefined` resolved values.\n * @returns {*} Returns the resolved value.\n * @example\n *\n * var object = { 'a': [{ 'b': { 'c': 3 } }] };\n *\n * _.get(object, 'a[0].b.c');\n * // => 3\n *\n * _.get(object, ['a', '0', 'b', 'c']);\n * // => 3\n *\n * _.get(object, 'a.b.c', 'default');\n * // => 'default'\n */\nfunction get(object, path, defaultValue) {\n  var result = object == null ? undefined : baseGet(object, path);\n  return result === undefined ? defaultValue : result;\n}\n\nmodule.exports = get;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper');\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction getFailedJobRetryTimeCycle(bo) {\n  return asyncCapableHelper.getFailedJobRetryTimeCycle(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction createExtensionElements(parent, bpmnFactory) {\n  return elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, parent, bpmnFactory);\n}\n\nfunction createFailedJobRetryTimeCycle(parent, bpmnFactory, cycle) {\n  return elementHelper.createElement('camunda:FailedJobRetryTimeCycle', { body: cycle }, parent, bpmnFactory);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n  var retryTimeCycleEntry = entryFactory.textField({\n    id: idPrefix + 'retryTimeCycle',\n    label: labelPrefix + translate('Retry Time Cycle'),\n    modelProperty: 'cycle',\n\n    get: function(element, node) {\n      var retryTimeCycle = getFailedJobRetryTimeCycle(getBusinessObject(element));\n      var value = retryTimeCycle && retryTimeCycle.get('body');\n      return {\n        cycle: value\n      };\n    },\n\n    set: function(element, values, node) {\n      var newCycle = values.cycle;\n      var bo = getBusinessObject(element);\n\n      if (newCycle === '' || typeof newCycle === 'undefined') {\n        // remove retry time cycle element(s)\n        return removeFailedJobRetryTimeCycle(bo, element);\n      }\n\n      var retryTimeCycle = getFailedJobRetryTimeCycle(bo);\n\n      if (!retryTimeCycle) {\n        // add new retry time cycle element\n        var commands = [];\n\n        var extensionElements = bo.get('extensionElements');\n        if (!extensionElements) {\n          extensionElements = createExtensionElements(bo, bpmnFactory);\n          commands.push(cmdHelper.updateBusinessObject(element, bo, { extensionElements: extensionElements }));\n        }\n\n        retryTimeCycle = createFailedJobRetryTimeCycle(extensionElements, bpmnFactory, newCycle);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [ retryTimeCycle ],\n          []\n        ));\n\n        return commands;\n      }\n\n      // update existing retry time cycle element\n      return cmdHelper.updateBusinessObject(element, retryTimeCycle, { body: newCycle });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n\n      if (bo && (isAsyncBefore(bo) || isAsyncAfter(bo))) {\n        return false;\n      }\n\n      if (is(element, 'bpmn:Event')) {\n        return !eventDefinitionHelper.getTimerEventDefinition(element);\n      }\n\n      return true;\n    }\n\n  });\n\n  return [ retryTimeCycleEntry ];\n\n};\n","var root = require('./_root');\n\n/** Built-in value references. */\nvar Symbol = root.Symbol;\n\nmodule.exports = Symbol;\n","'use strict';\n\nvar utils = require('./utils');\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar defaults = {\n    allowDots: false,\n    allowPrototypes: false,\n    arrayLimit: 20,\n    decoder: utils.decode,\n    delimiter: '&',\n    depth: 5,\n    parameterLimit: 1000,\n    plainObjects: false,\n    strictNullHandling: false\n};\n\nvar parseValues = function parseQueryStringValues(str, options) {\n    var obj = {};\n    var cleanStr = options.ignoreQueryPrefix ? str.replace(/^\\?/, '') : str;\n    var limit = options.parameterLimit === Infinity ? undefined : options.parameterLimit;\n    var parts = cleanStr.split(options.delimiter, limit);\n\n    for (var i = 0; i < parts.length; ++i) {\n        var part = parts[i];\n\n        var bracketEqualsPos = part.indexOf(']=');\n        var pos = bracketEqualsPos === -1 ? part.indexOf('=') : bracketEqualsPos + 1;\n\n        var key, val;\n        if (pos === -1) {\n            key = options.decoder(part, defaults.decoder);\n            val = options.strictNullHandling ? null : '';\n        } else {\n            key = options.decoder(part.slice(0, pos), defaults.decoder);\n            val = options.decoder(part.slice(pos + 1), defaults.decoder);\n        }\n        if (has.call(obj, key)) {\n            obj[key] = [].concat(obj[key]).concat(val);\n        } else {\n            obj[key] = val;\n        }\n    }\n\n    return obj;\n};\n\nvar parseObject = function (chain, val, options) {\n    var leaf = val;\n\n    for (var i = chain.length - 1; i >= 0; --i) {\n        var obj;\n        var root = chain[i];\n\n        if (root === '[]') {\n            obj = [];\n            obj = obj.concat(leaf);\n        } else {\n            obj = options.plainObjects ? Object.create(null) : {};\n            var cleanRoot = root.charAt(0) === '[' && root.charAt(root.length - 1) === ']' ? root.slice(1, -1) : root;\n            var index = parseInt(cleanRoot, 10);\n            if (\n                !isNaN(index)\n                && root !== cleanRoot\n                && String(index) === cleanRoot\n                && index >= 0\n                && (options.parseArrays && index <= options.arrayLimit)\n            ) {\n                obj = [];\n                obj[index] = leaf;\n            } else {\n                obj[cleanRoot] = leaf;\n            }\n        }\n\n        leaf = obj;\n    }\n\n    return leaf;\n};\n\nvar parseKeys = function parseQueryStringKeys(givenKey, val, options) {\n    if (!givenKey) {\n        return;\n    }\n\n    // Transform dot notation to bracket notation\n    var key = options.allowDots ? givenKey.replace(/\\.([^.[]+)/g, '[$1]') : givenKey;\n\n    // The regex chunks\n\n    var brackets = /(\\[[^[\\]]*])/;\n    var child = /(\\[[^[\\]]*])/g;\n\n    // Get the parent\n\n    var segment = brackets.exec(key);\n    var parent = segment ? key.slice(0, segment.index) : key;\n\n    // Stash the parent if it exists\n\n    var keys = [];\n    if (parent) {\n        // If we aren't using plain objects, optionally prefix keys\n        // that would overwrite object prototype properties\n        if (!options.plainObjects && has.call(Object.prototype, parent)) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n\n        keys.push(parent);\n    }\n\n    // Loop through children appending to the array until we hit depth\n\n    var i = 0;\n    while ((segment = child.exec(key)) !== null && i < options.depth) {\n        i += 1;\n        if (!options.plainObjects && has.call(Object.prototype, segment[1].slice(1, -1))) {\n            if (!options.allowPrototypes) {\n                return;\n            }\n        }\n        keys.push(segment[1]);\n    }\n\n    // If there's a remainder, just add whatever is left\n\n    if (segment) {\n        keys.push('[' + key.slice(segment.index) + ']');\n    }\n\n    return parseObject(keys, val, options);\n};\n\nmodule.exports = function (str, opts) {\n    var options = opts ? utils.assign({}, opts) : {};\n\n    if (options.decoder !== null && options.decoder !== undefined && typeof options.decoder !== 'function') {\n        throw new TypeError('Decoder has to be a function.');\n    }\n\n    options.ignoreQueryPrefix = options.ignoreQueryPrefix === true;\n    options.delimiter = typeof options.delimiter === 'string' || utils.isRegExp(options.delimiter) ? options.delimiter : defaults.delimiter;\n    options.depth = typeof options.depth === 'number' ? options.depth : defaults.depth;\n    options.arrayLimit = typeof options.arrayLimit === 'number' ? options.arrayLimit : defaults.arrayLimit;\n    options.parseArrays = options.parseArrays !== false;\n    options.decoder = typeof options.decoder === 'function' ? options.decoder : defaults.decoder;\n    options.allowDots = typeof options.allowDots === 'boolean' ? options.allowDots : defaults.allowDots;\n    options.plainObjects = typeof options.plainObjects === 'boolean' ? options.plainObjects : defaults.plainObjects;\n    options.allowPrototypes = typeof options.allowPrototypes === 'boolean' ? options.allowPrototypes : defaults.allowPrototypes;\n    options.parameterLimit = typeof options.parameterLimit === 'number' ? options.parameterLimit : defaults.parameterLimit;\n    options.strictNullHandling = typeof options.strictNullHandling === 'boolean' ? options.strictNullHandling : defaults.strictNullHandling;\n\n    if (str === '' || str === null || typeof str === 'undefined') {\n        return options.plainObjects ? Object.create(null) : {};\n    }\n\n    var tempObj = typeof str === 'string' ? parseValues(str, options) : str;\n    var obj = options.plainObjects ? Object.create(null) : {};\n\n    // Iterate over the keys and setup the new object\n\n    var keys = Object.keys(tempObj);\n    for (var i = 0; i < keys.length; ++i) {\n        var key = keys[i];\n        var newObj = parseKeys(key, tempObj[key], options);\n        obj = utils.merge(obj, newObj, options);\n    }\n\n    return utils.compact(obj);\n};\n","var baseEach = require('./_baseEach');\n\n/**\n * The base implementation of `_.filter` without support for iteratee shorthands.\n *\n * @private\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} predicate The function invoked per iteration.\n * @returns {Array} Returns the new filtered array.\n */\nfunction baseFilter(collection, predicate) {\n  var result = [];\n  baseEach(collection, function(value, index, collection) {\n    if (predicate(value, index, collection)) {\n      result.push(value);\n    }\n  });\n  return result;\n}\n\nmodule.exports = baseFilter;\n","'use strict';\n\nvar domQuery = require('min-dom').query,\n    escapeHTML = require('../../../../Utils').escapeHTML,\n    utils = require('../../../../Utils');\n\n\nfunction getScriptType(node) {\n  return utils.selectedType('select[name=scriptType]', node.parentElement);\n}\n\n\nmodule.exports = function(scriptLanguagePropName, scriptValuePropName, isFormatRequired, translate) {\n\n  return {\n    template:\n    '<div class=\"bpp-row bpp-textfield\">' +\n      '<label for=\"cam-script-format\">' + escapeHTML(translate('Script Format')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\">' +\n        '<input id=\"cam-script-format\" type=\"text\" name=\"scriptFormat\" />' +\n        '<button class=\"clear\" data-action=\"script.clearScriptFormat\" data-show=\"script.canClearScriptFormat\">' +\n          '<span>X</span>' +\n        '</button>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row\">' +\n      '<label for=\"cam-script-type\">' + escapeHTML(translate('Script Type')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\">' +\n        '<select id=\"cam-script-type\" name=\"scriptType\" data-value>' +\n          '<option value=\"script\" selected>' + escapeHTML(translate('Inline Script')) + '</option>' +\n          '<option value=\"scriptResource\">' + escapeHTML(translate('External Resource')) + '</option>' +\n        '</select>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row bpp-textfield\">' +\n      '<label for=\"cam-script-resource-val\" data-show=\"script.isScriptResource\">' + escapeHTML(translate('Resource')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\" data-show=\"script.isScriptResource\">' +\n        '<input id=\"cam-script-resource-val\" type=\"text\" name=\"scriptResourceValue\" />' +\n        '<button class=\"clear\" data-action=\"script.clearScriptResource\" data-show=\"script.canClearScriptResource\">' +\n          '<span>X</span>' +\n        '</button>' +\n      '</div>' +\n    '</div>' +\n\n    '<div class=\"bpp-row\">' +\n      '<label for=\"cam-script-val\" data-show=\"script.isScript\">' + escapeHTML(translate('Script')) + '</label>' +\n      '<div class=\"bpp-field-wrapper\" data-show=\"script.isScript\">' +\n        '<textarea id=\"cam-script-val\" type=\"text\" name=\"scriptValue\"></textarea>' +\n      '</div>'+\n    '</div>',\n\n    get: function(element, bo) {\n      var values = {};\n\n      // read values from xml:\n      var boScriptResource = bo.get('camunda:resource'),\n          boScript = bo.get(scriptValuePropName),\n          boScriptFormat = bo.get(scriptLanguagePropName);\n\n      if (typeof boScriptResource !== 'undefined') {\n        values.scriptResourceValue = boScriptResource;\n        values.scriptType = 'scriptResource';\n      } else {\n        values.scriptValue = boScript;\n        values.scriptType = 'script';\n      }\n\n      values.scriptFormat = boScriptFormat;\n\n      return values;\n    },\n\n    set: function(element, values, containerElement) {\n      var scriptFormat = values.scriptFormat,\n          scriptType = values.scriptType,\n          scriptResourceValue = values.scriptResourceValue,\n          scriptValue = values.scriptValue;\n\n      // init update\n      var update = {\n        'camunda:resource': undefined\n      };\n      update[scriptValuePropName] = undefined;\n      update[scriptLanguagePropName] = undefined;\n\n      if (isFormatRequired) {\n        // always set language\n        update[scriptLanguagePropName] = scriptFormat || '';\n      } else\n      // set language only when scriptFormat has a value\n      if (scriptFormat !== '') {\n        update[scriptLanguagePropName] = scriptFormat;\n      }\n\n      // set either inline script or resource\n      if ('scriptResource' === scriptType) {\n        update['camunda:resource'] = scriptResourceValue || '';\n      } else {\n        update[scriptValuePropName] = scriptValue || '';\n      }\n\n      return update;\n    },\n\n    validate: function(element, values) {\n      var validationResult = {};\n\n      if (values.scriptType === 'script' && !values.scriptValue) {\n        validationResult.scriptValue = translate('Must provide a value');\n      }\n\n      if (values.scriptType === 'scriptResource' && !values.scriptResourceValue) {\n        validationResult.scriptResourceValue = translate('Must provide a value');\n      }\n\n      if (isFormatRequired && (!values.scriptFormat || values.scriptFormat.length === 0)) {\n        validationResult.scriptFormat = translate('Must provide a value');\n      }\n\n      return validationResult;\n    },\n\n    clearScriptFormat: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('input[name=scriptFormat]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScriptFormat: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('input[name=scriptFormat]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    clearScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('input[name=scriptResourceValue]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('input[name=scriptResourceValue]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    clearScript: function(element, inputNode, btnNode, scopeNode) {\n      domQuery('textarea[name=scriptValue]', scopeNode).value='';\n\n      return true;\n    },\n\n    canClearScript: function(element, inputNode, btnNode, scopeNode) {\n      var input = domQuery('textarea[name=scriptValue]', scopeNode);\n\n      return input.value !== '';\n    },\n\n    isScriptResource: function(element, inputNode, btnNode, scopeNode) {\n      var scriptType = getScriptType(scopeNode);\n      return scriptType === 'scriptResource';\n    },\n\n    isScript: function(element, inputNode, btnNode, scopeNode) {\n      var scriptType = getScriptType(scopeNode);\n      return scriptType === 'script';\n    }\n\n  };\n\n};\n","/**\n * A specialized version of `baseAggregator` for arrays.\n *\n * @private\n * @param {Array} [array] The array to iterate over.\n * @param {Function} setter The function to set `accumulator` values.\n * @param {Function} iteratee The iteratee to transform keys.\n * @param {Object} accumulator The initial aggregated object.\n * @returns {Function} Returns `accumulator`.\n */\nfunction arrayAggregator(array, setter, iteratee, accumulator) {\n  var index = -1,\n      length = array == null ? 0 : array.length;\n\n  while (++index < length) {\n    var value = array[index];\n    setter(accumulator, value, iteratee(value), array);\n  }\n  return accumulator;\n}\n\nmodule.exports = arrayAggregator;\n","const traverse = require('./traverse');\n\nclass Reporter {\n  constructor({ moddleRoot, rule }) {\n    this.rule = rule;\n    this.moddleRoot = moddleRoot;\n    this.messages = [];\n    this.report = this.report.bind(this);\n  }\n\n  report(id, message) {\n    this.messages.push({ id, message });\n  }\n}\n\nmodule.exports = function testRule({ moddleRoot, rule }) {\n  const reporter = new Reporter({ rule, moddleRoot });\n  traverse(moddleRoot, node => rule.check(node, reporter));\n  return reporter.messages;\n};\n","var SetCache = require('./_SetCache'),\n    arraySome = require('./_arraySome'),\n    cacheHas = require('./_cacheHas');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1,\n    COMPARE_UNORDERED_FLAG = 2;\n\n/**\n * A specialized version of `baseIsEqualDeep` for arrays with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Array} array The array to compare.\n * @param {Array} other The other array to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `array` and `other` objects.\n * @returns {boolean} Returns `true` if the arrays are equivalent, else `false`.\n */\nfunction equalArrays(array, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      arrLength = array.length,\n      othLength = other.length;\n\n  if (arrLength != othLength && !(isPartial && othLength > arrLength)) {\n    return false;\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(array);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var index = -1,\n      result = true,\n      seen = (bitmask & COMPARE_UNORDERED_FLAG) ? new SetCache : undefined;\n\n  stack.set(array, other);\n  stack.set(other, array);\n\n  // Ignore non-index properties.\n  while (++index < arrLength) {\n    var arrValue = array[index],\n        othValue = other[index];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, arrValue, index, other, array, stack)\n        : customizer(arrValue, othValue, index, array, other, stack);\n    }\n    if (compared !== undefined) {\n      if (compared) {\n        continue;\n      }\n      result = false;\n      break;\n    }\n    // Recursively compare arrays (susceptible to call stack limits).\n    if (seen) {\n      if (!arraySome(other, function(othValue, othIndex) {\n            if (!cacheHas(seen, othIndex) &&\n                (arrValue === othValue || equalFunc(arrValue, othValue, bitmask, customizer, stack))) {\n              return seen.push(othIndex);\n            }\n          })) {\n        result = false;\n        break;\n      }\n    } else if (!(\n          arrValue === othValue ||\n            equalFunc(arrValue, othValue, bitmask, customizer, stack)\n        )) {\n      result = false;\n      break;\n    }\n  }\n  stack['delete'](array);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalArrays;\n","var constant = require('./constant'),\n    defineProperty = require('./_defineProperty'),\n    identity = require('./identity');\n\n/**\n * The base implementation of `setToString` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar baseSetToString = !defineProperty ? identity : function(func, string) {\n  return defineProperty(func, 'toString', {\n    'configurable': true,\n    'enumerable': false,\n    'value': constant(string),\n    'writable': true\n  });\n};\n\nmodule.exports = baseSetToString;\n","var getMapData = require('./_getMapData');\n\n/**\n * Checks if a map value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf MapCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction mapCacheHas(key) {\n  return getMapData(this, key).has(key);\n}\n\nmodule.exports = mapCacheHas;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    utils = require('../../../../Utils');\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar forEach = require('lodash/forEach'),\n    find = require('lodash/find'),\n    filter = require('lodash/filter');\n\n\nfunction getContainedActivities(element) {\n  return getFlowElements(element, 'bpmn:Activity');\n}\n\nfunction getContainedBoundaryEvents(element) {\n  return getFlowElements(element, 'bpmn:BoundaryEvent');\n}\n\nfunction getFlowElements(element, type) {\n  return utils.filterElementsByType(element.flowElements, type);\n}\n\nfunction isCompensationEventAttachedToActivity(activity, boundaryEvents) {\n  var activityId = activity.id;\n  var boundaryEvent = find(boundaryEvents, function(boundaryEvent) {\n    var compensateEventDefinition = eventDefinitionHelper.getCompensateEventDefinition(boundaryEvent);\n    var attachedToRef = boundaryEvent.attachedToRef;\n    return compensateEventDefinition && attachedToRef && attachedToRef.id === activityId;\n  });\n  return !!boundaryEvent;\n}\n\n// subprocess: only when it is not triggeredByEvent\n// activity: only when it attach a compensation boundary event\n// callActivity: no limitation\nfunction canActivityBeCompensated(activity, boundaryEvents) {\n  return (is(activity, 'bpmn:SubProcess') && !activity.triggeredByEvent) ||\n          is(activity, 'bpmn:CallActivity') ||\n          isCompensationEventAttachedToActivity(activity, boundaryEvents);\n}\n\nfunction getActivitiesForCompensation(element) {\n  var boundaryEvents = getContainedBoundaryEvents(element);\n  return filter(getContainedActivities(element), function(activity) {\n    return canActivityBeCompensated(activity, boundaryEvents);\n  });\n}\n\nfunction getActivitiesForActivityRef(element) {\n  var bo = getBusinessObject(element);\n  var parent = bo.$parent;\n\n  var activitiesForActivityRef = getActivitiesForCompensation(parent);\n\n  // if throwing compensation event is in an event sub process:\n  // get also all activities outside of the event sub process\n  if (is(parent, 'bpmn:SubProcess') && parent.triggeredByEvent) {\n    parent = parent.$parent;\n    if (parent) {\n      activitiesForActivityRef = activitiesForActivityRef.concat(getActivitiesForCompensation(parent));\n    }\n\n  }\n\n  return activitiesForActivityRef;\n}\n\nfunction createActivityRefOptions(element) {\n  var options = [ { value: '' } ];\n\n  var activities = getActivitiesForActivityRef(element);\n  forEach(activities, function(activity) {\n    var activityId = activity.id;\n    var name = (activity.name ? (activity.name + ' ') : '') + '(id=' + activityId + ')';\n    options.push({ value: activityId, name: name });\n  });\n\n  return options;\n}\n\n\nmodule.exports = function(group, element, bpmnFactory, compensateEventDefinition, elementRegistry, translate) {\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'wait-for-completion',\n    label: translate('Wait for Completion'),\n    modelProperty: 'waitForCompletion',\n\n    get: function(element, node) {\n      return {\n        waitForCompletion: compensateEventDefinition.waitForCompletion\n      };\n    },\n\n    set: function(element, values) {\n      values.waitForCompletion = values.waitForCompletion || false;\n      return cmdHelper.updateBusinessObject(element, compensateEventDefinition, values);\n    }\n  }));\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'activity-ref',\n    label: translate('Activity Ref'),\n    selectOptions: createActivityRefOptions(element),\n    modelProperty: 'activityRef',\n\n    get: function(element, node) {\n      var activityRef = compensateEventDefinition.activityRef;\n      activityRef = activityRef && activityRef.id;\n      return {\n        activityRef: activityRef || ''\n      };\n    },\n\n    set: function(element, values) {\n      var activityRef = values.activityRef || undefined;\n      activityRef = activityRef && getBusinessObject(elementRegistry.get(activityRef));\n      return cmdHelper.updateBusinessObject(element, compensateEventDefinition, {\n        activityRef: activityRef\n      });\n    }\n  }));\n\n};\n","'use strict';\nvar fails = require('../internals/fails');\n\nmodule.exports = function (METHOD_NAME, argument) {\n  var method = [][METHOD_NAME];\n  return !!method && fails(function () {\n    // eslint-disable-next-line no-useless-call,no-throw-literal\n    method.call(null, argument || function () { throw 1; }, 1);\n  });\n};\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar DELEGATE_TYPES = [\n  'class',\n  'expression',\n  'delegateExpression'\n];\n\nvar PROPERTIES = {\n  class: 'camunda:class',\n  expression: 'camunda:expression',\n  delegateExpression: 'camunda:delegateExpression'\n};\n\nfunction isDelegate(type) {\n  return DELEGATE_TYPES.indexOf(type) !== -1;\n}\n\nfunction getAttribute(type) {\n  return PROPERTIES[type];\n}\n\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getImplementationType = options.getImplementationType,\n      getBusinessObject = options.getBusinessObject;\n\n  function getDelegationLabel(type) {\n    switch (type) {\n    case 'class':\n      return translate('Java Class');\n    case 'expression':\n      return translate('Expression');\n    case 'delegateExpression':\n      return translate('Delegate Expression');\n    default:\n      return '';\n    }\n  }\n\n  var delegateEntry = entryFactory.textField({\n    id: 'delegate',\n    label: translate('Value'),\n    dataValueLabel: 'delegationLabel',\n    modelProperty: 'delegate',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      var type = getImplementationType(element);\n      var attr = getAttribute(type);\n      var label = getDelegationLabel(type);\n      return {\n        delegate: bo.get(attr),\n        delegationLabel: label\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n      var type = getImplementationType(element);\n      var attr = getAttribute(type);\n      var prop = {};\n      prop[attr] = values.delegate || '';\n      return cmdHelper.updateBusinessObject(element, bo, prop);\n    },\n\n    validate: function(element, values, node) {\n      return isDelegate(getImplementationType(element)) && !values.delegate ? { delegate: translate('Must provide a value') } : {};\n    },\n\n    hidden: function(element, node) {\n      return !isDelegate(getImplementationType(element));\n    }\n\n  });\n\n  return [ delegateEntry ];\n\n};\n","var copyArray = require('./_copyArray'),\n    isIndex = require('./_isIndex');\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Reorder `array` according to the specified indexes where the element at\n * the first index is assigned as the first element, the element at\n * the second index is assigned as the second element, and so on.\n *\n * @private\n * @param {Array} array The array to reorder.\n * @param {Array} indexes The arranged array indexes.\n * @returns {Array} Returns `array`.\n */\nfunction reorder(array, indexes) {\n  var arrLength = array.length,\n      length = nativeMin(indexes.length, arrLength),\n      oldArray = copyArray(array);\n\n  while (length--) {\n    var index = indexes[length];\n    array[length] = isIndex(index, arrLength) ? oldArray[index] : undefined;\n  }\n  return array;\n}\n\nmodule.exports = reorder;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\n/**\n * Create an entry to modify a property of an element which\n * is referenced by a event definition.\n *\n * @param  {djs.model.Base} element\n * @param  {ModdleElement} definition\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.id the id of the entry\n * @param  {string} options.label the label of the entry\n * @param  {string} options.referenceProperty the name of referencing property\n * @param  {string} options.modelProperty the name of property to modify\n * @param  {string} options.shouldValidate a flag indicate whether to validate or not\n *\n * @return {Array<Object>} return an array containing the entries\n */\nmodule.exports = function(element, definition, bpmnFactory, options) {\n\n  var id = options.id || 'element-property';\n  var label = options.label;\n  var referenceProperty = options.referenceProperty;\n  var modelProperty = options.modelProperty || 'name';\n  var shouldValidate = options.shouldValidate || false;\n\n  var entry = entryFactory.textField({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n\n    get: function(element, node) {\n      var reference = definition.get(referenceProperty);\n      var props = {};\n      props[modelProperty] = reference && reference.get(modelProperty);\n      return props;\n    },\n\n    set: function(element, values, node) {\n      var reference = definition.get(referenceProperty);\n      var props = {};\n      props[modelProperty] = values[modelProperty] || undefined;\n      return cmdHelper.updateBusinessObject(element, reference, props);\n    },\n\n    hidden: function(element, node) {\n      return !definition.get(referenceProperty);\n    }\n  });\n\n  if (shouldValidate) {\n    entry.validate = function(element, values, node) {\n      var reference = definition.get(referenceProperty);\n      if (reference && !values[modelProperty]) {\n        var validationErrors = {};\n        validationErrors[modelProperty] = 'Must provide a value';\n        return validationErrors;\n      }\n    };\n  }\n\n  return [ entry ];\n};\n","var baseGetAllKeys = require('./_baseGetAllKeys'),\n    getSymbols = require('./_getSymbols'),\n    keys = require('./keys');\n\n/**\n * Creates an array of own enumerable property names and symbols of `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names and symbols.\n */\nfunction getAllKeys(object) {\n  return baseGetAllKeys(object, keys, getSymbols);\n}\n\nmodule.exports = getAllKeys;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar elementHelper = require('../../../../helper/ElementHelper'),\n    inputOutputHelper = require('../../../../helper/InputOutputHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper'),\n    utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    scriptImplementation = require('./Script');\n\n\nfunction createElement(type, parent, factory, properties) {\n  return elementHelper.createElement(type, properties, parent, factory);\n}\n\nfunction isScript(elem) {\n  return is(elem, 'camunda:Script');\n}\n\nfunction isList(elem) {\n  return is(elem, 'camunda:List');\n}\n\nfunction isMap(elem) {\n  return is(elem, 'camunda:Map');\n}\n\nfunction ensureInputOutputSupported(element, insideConnector) {\n  return inputOutputHelper.isInputOutputSupported(element, insideConnector);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var typeInfo = {\n    'camunda:Map': {\n      value: 'map',\n      label: translate('Map')\n    },\n    'camunda:List': {\n      value: 'list',\n      label: translate('List')\n    },\n    'camunda:Script': {\n      value: 'script',\n      label: translate('Script')\n    }\n  };\n\n  options = options || {};\n\n  var insideConnector = !!options.insideConnector,\n      idPrefix = options.idPrefix || '';\n\n  var getSelected = options.getSelectedParameter;\n\n  if (!ensureInputOutputSupported(element, insideConnector)) {\n    return [];\n  }\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelected(element, node);\n  };\n\n\n  // parameter name ////////////////////////////////////////////////////////\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: idPrefix + 'parameterName',\n    label: translate('Name'),\n    modelProperty: 'name',\n\n    getProperty: function(element, node) {\n      return (getSelected(element, node) || {}).name;\n    },\n\n    setProperty: function(element, values, node) {\n      var param = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, param, values);\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelected(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.name;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.name = translate('Name must not contain spaces');\n          }\n        } else {\n          validation.name = translate('Parameter must have a name');\n        }\n      }\n\n      return validation;\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n  }));\n\n\n  // parameter type //////////////////////////////////////////////////////\n\n  var selectOptions = [\n    { value: 'text', name: translate('Text') },\n    { value: 'script', name: translate('Script') },\n    { value: 'list', name: translate('List') },\n    { value: 'map', name: translate('Map') }\n  ];\n\n  entries.push(entryFactory.selectBox({\n    id : idPrefix + 'parameterType',\n    label: translate('Type'),\n    selectOptions: selectOptions,\n    modelProperty: 'parameterType',\n\n    get: function(element, node) {\n      var bo = getSelected(element, node);\n\n      var parameterType = 'text';\n\n      if (typeof bo !== 'undefined') {\n        var definition = bo.get('definition');\n        if (typeof definition !== 'undefined') {\n          var type = definition.$type;\n          parameterType = typeInfo[type].value;\n        }\n      }\n\n      return {\n        parameterType: parameterType\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelected(element, node);\n\n      var properties = {\n        value: undefined,\n        definition: undefined\n      };\n\n      var createParameterTypeElem = function(type) {\n        return createElement(type, bo, bpmnFactory);\n      };\n\n      var parameterType = values.parameterType;\n\n      if (parameterType === 'script') {\n        properties.definition = createParameterTypeElem('camunda:Script');\n      }\n      else if (parameterType === 'list') {\n        properties.definition = createParameterTypeElem('camunda:List');\n      }\n      else if (parameterType === 'map') {\n        properties.definition = createParameterTypeElem('camunda:Map');\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, properties);\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n\n  // parameter value (type = text) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.textBox({\n    id : idPrefix + 'parameterType-text',\n    label : translate('Value'),\n    modelProperty: 'value',\n    get: function(element, node) {\n      return {\n        value: (getSelected(element, node) || {}).value\n      };\n    },\n\n    set: function(element, values, node) {\n      var param = getSelected(element, node);\n      values.value = values.value || undefined;\n      return cmdHelper.updateBusinessObject(element, param, values);\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && !bo.definition;\n    }\n\n  }));\n\n\n  // parameter value (type = script) ///////////////////////////////////////////////////////\n  var script = scriptImplementation('scriptFormat', 'value', true, translate);\n  entries.push({\n    id: idPrefix + 'parameterType-script',\n    html: '<div data-show=\"isScript\">' +\n            script.template +\n          '</div>',\n    get: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition) ? script.get(element, bo.definition) : {};\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelected(element, node);\n      var update = script.set(element, values);\n      return cmdHelper.updateBusinessObject(element, bo.definition, update);\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition) ? script.validate(element, bo.definition) : {};\n    },\n\n    isScript: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && isScript(bo.definition);\n    },\n\n    script: script\n\n  });\n\n\n  // parameter value (type = list) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.table({\n    id: idPrefix + 'parameterType-list',\n    modelProperties: [ 'value' ],\n    labels: [ translate('Value') ],\n    addLabel: translate('Add Value'),\n\n    getElements: function(element, node) {\n      var bo = getSelected(element, node);\n\n      if (bo && isList(bo.definition)) {\n        return bo.definition.items;\n      }\n\n      return [];\n    },\n\n    updateElement: function(element, values, node, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n      return cmdHelper.updateBusinessObject(element, item, values);\n    },\n\n    addElement: function(element, node) {\n      var bo = getSelected(element, node);\n      var newValue = createElement('camunda:Value', bo.definition, bpmnFactory, { value: undefined });\n      return cmdHelper.addElementsTolist(element, bo.definition, 'items', [ newValue ]);\n    },\n\n    removeElement: function(element, node, idx) {\n      var bo = getSelected(element, node);\n      return cmdHelper.removeElementsFromList(element, bo.definition, 'items', null, [ bo.definition.items[idx] ]);\n    },\n\n    editable: function(element, node, prop, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n      return !isMap(item) && !isList(item) && !isScript(item);\n    },\n\n    setControlValue: function(element, node, input, prop, value, idx) {\n      var bo = getSelected(element, node);\n      var item = bo.definition.items[idx];\n\n      if (!isMap(item) && !isList(item) && !isScript(item)) {\n        input.value = value;\n      } else {\n        input.value = typeInfo[item.$type].label;\n      }\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && bo.definition && isList(bo.definition);\n    }\n\n  }));\n\n\n  // parameter value (type = map) ///////////////////////////////////////////////////////\n\n  entries.push(entryFactory.table({\n    id: idPrefix + 'parameterType-map',\n    modelProperties: [ 'key', 'value' ],\n    labels: [ translate('Key'), translate('Value') ],\n    addLabel: translate('Add Entry'),\n\n    getElements: function(element, node) {\n      var bo = getSelected(element, node);\n\n      if (bo && isMap(bo.definition)) {\n        return bo.definition.entries;\n      }\n\n      return [];\n    },\n\n    updateElement: function(element, values, node, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n\n      if (isMap(entry.definition) || isList(entry.definition) || isScript(entry.definition)) {\n        values = {\n          key: values.key\n        };\n      }\n\n      return cmdHelper.updateBusinessObject(element, entry, values);\n    },\n\n    addElement: function(element, node) {\n      var bo = getSelected(element, node);\n      var newEntry = createElement('camunda:Entry', bo.definition, bpmnFactory, { key: undefined, value: undefined });\n      return cmdHelper.addElementsTolist(element, bo.definition, 'entries', [ newEntry ]);\n    },\n\n    removeElement: function(element, node, idx) {\n      var bo = getSelected(element, node);\n      return cmdHelper.removeElementsFromList(element, bo.definition, 'entries', null, [ bo.definition.entries[idx] ]);\n    },\n\n    editable: function(element, node, prop, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n      return prop === 'key' || (!isMap(entry.definition) && !isList(entry.definition) && !isScript(entry.definition));\n    },\n\n    setControlValue: function(element, node, input, prop, value, idx) {\n      var bo = getSelected(element, node);\n      var entry = bo.definition.entries[idx];\n\n      if (prop === 'key' || (!isMap(entry.definition) && !isList(entry.definition) && !isScript(entry.definition))) {\n        input.value = value;\n      } else {\n        input.value = typeInfo[entry.definition.$type].label;\n      }\n    },\n\n    show: function(element, node) {\n      var bo = getSelected(element, node);\n      return bo && bo.definition && isMap(bo.definition);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar inputOutputParameter = require('./implementation/InputOutputParameter');\n\nvar assign = require('lodash/assign');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  group.entries = group.entries.concat(inputOutputParameter(element, bpmnFactory, assign({}, options), translate));\n\n};\n","var composeArgs = require('./_composeArgs'),\n    composeArgsRight = require('./_composeArgsRight'),\n    replaceHolders = require('./_replaceHolders');\n\n/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMin = Math.min;\n\n/**\n * Merges the function metadata of `source` into `data`.\n *\n * Merging metadata reduces the number of wrappers used to invoke a function.\n * This is possible because methods like `_.bind`, `_.curry`, and `_.partial`\n * may be applied regardless of execution order. Methods like `_.ary` and\n * `_.rearg` modify function arguments, making the order in which they are\n * executed important, preventing the merging of metadata. However, we make\n * an exception for a safe combined case where curried functions have `_.ary`\n * and or `_.rearg` applied.\n *\n * @private\n * @param {Array} data The destination metadata.\n * @param {Array} source The source metadata.\n * @returns {Array} Returns `data`.\n */\nfunction mergeData(data, source) {\n  var bitmask = data[1],\n      srcBitmask = source[1],\n      newBitmask = bitmask | srcBitmask,\n      isCommon = newBitmask < (WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG | WRAP_ARY_FLAG);\n\n  var isCombo =\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_CURRY_FLAG)) ||\n    ((srcBitmask == WRAP_ARY_FLAG) && (bitmask == WRAP_REARG_FLAG) && (data[7].length <= source[8])) ||\n    ((srcBitmask == (WRAP_ARY_FLAG | WRAP_REARG_FLAG)) && (source[7].length <= source[8]) && (bitmask == WRAP_CURRY_FLAG));\n\n  // Exit early if metadata can't be merged.\n  if (!(isCommon || isCombo)) {\n    return data;\n  }\n  // Use source `thisArg` if available.\n  if (srcBitmask & WRAP_BIND_FLAG) {\n    data[2] = source[2];\n    // Set when currying a bound function.\n    newBitmask |= bitmask & WRAP_BIND_FLAG ? 0 : WRAP_CURRY_BOUND_FLAG;\n  }\n  // Compose partial arguments.\n  var value = source[3];\n  if (value) {\n    var partials = data[3];\n    data[3] = partials ? composeArgs(partials, value, source[4]) : value;\n    data[4] = partials ? replaceHolders(data[3], PLACEHOLDER) : source[4];\n  }\n  // Compose partial right arguments.\n  value = source[5];\n  if (value) {\n    partials = data[5];\n    data[5] = partials ? composeArgsRight(partials, value, source[6]) : value;\n    data[6] = partials ? replaceHolders(data[5], PLACEHOLDER) : source[6];\n  }\n  // Use source `argPos` if available.\n  value = source[7];\n  if (value) {\n    data[7] = value;\n  }\n  // Use source `ary` if it's smaller.\n  if (srcBitmask & WRAP_ARY_FLAG) {\n    data[8] = data[8] == null ? source[8] : nativeMin(data[8], source[8]);\n  }\n  // Use source `arity` if one is not provided.\n  if (data[9] == null) {\n    data[9] = source[9];\n  }\n  // Use source `func` and merge bitmasks.\n  data[0] = source[0];\n  data[1] = newBitmask;\n\n  return data;\n}\n\nmodule.exports = mergeData;\n","/**\n * Converts `set` to an array of its values.\n *\n * @private\n * @param {Object} set The set to convert.\n * @returns {Array} Returns the values.\n */\nfunction setToArray(set) {\n  var index = -1,\n      result = Array(set.size);\n\n  set.forEach(function(value) {\n    result[++index] = value;\n  });\n  return result;\n}\n\nmodule.exports = setToArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is;\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject,\n      hideResultVariable = options.hideResultVariable,\n      id = options.id || 'resultVariable';\n\n\n  var resultVariableEntry = entryFactory.textField({\n    id: id,\n    label: translate('Result Variable'),\n    modelProperty: 'resultVariable',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { resultVariable: bo.get('camunda:resultVariable') };\n    },\n\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element);\n\n      var resultVariable = values.resultVariable || undefined;\n\n      var props = {\n        'camunda:resultVariable': resultVariable\n      };\n\n      if (is(bo, 'camunda:DmnCapable') && !resultVariable) {\n        props = assign({ 'camunda:mapDecisionResult': 'resultList' }, props);\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n    },\n\n    hidden: function(element, node) {\n      if (typeof hideResultVariable === 'function') {\n        return hideResultVariable.apply(resultVariableEntry, arguments);\n      }\n    }\n\n  });\n\n  return [ resultVariableEntry ];\n\n};\n","var DESCRIPTORS = require('../internals/descriptors');\nvar fails = require('../internals/fails');\nvar has = require('../internals/has');\n\nvar defineProperty = Object.defineProperty;\nvar cache = {};\n\nvar thrower = function (it) { throw it; };\n\nmodule.exports = function (METHOD_NAME, options) {\n  if (has(cache, METHOD_NAME)) return cache[METHOD_NAME];\n  if (!options) options = {};\n  var method = [][METHOD_NAME];\n  var ACCESSORS = has(options, 'ACCESSORS') ? options.ACCESSORS : false;\n  var argument0 = has(options, 0) ? options[0] : thrower;\n  var argument1 = has(options, 1) ? options[1] : undefined;\n\n  return cache[METHOD_NAME] = !!method && !fails(function () {\n    if (ACCESSORS && !DESCRIPTORS) return true;\n    var O = { length: -1 };\n\n    if (ACCESSORS) defineProperty(O, 1, { enumerable: true, get: thrower });\n    else O[1] = 1;\n\n    method.call(O, argument0, argument1);\n  });\n};\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'camunda:Initiator') && !is(element.parent, 'bpmn:SubProcess')) {\n    group.entries.push(entryFactory.textField({\n      id: 'initiator',\n      label: translate('Initiator'),\n      modelProperty: 'initiator'\n    }));\n  }\n};\n","/**\n * The base implementation of `_.unary` without support for storing metadata.\n *\n * @private\n * @param {Function} func The function to cap arguments for.\n * @returns {Function} Returns the new capped function.\n */\nfunction baseUnary(func) {\n  return function(value) {\n    return func(value);\n  };\n}\n\nmodule.exports = baseUnary;\n","var isObject = require('./isObject'),\n    now = require('./now'),\n    toNumber = require('./toNumber');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max,\n    nativeMin = Math.min;\n\n/**\n * Creates a debounced function that delays invoking `func` until after `wait`\n * milliseconds have elapsed since the last time the debounced function was\n * invoked. The debounced function comes with a `cancel` method to cancel\n * delayed `func` invocations and a `flush` method to immediately invoke them.\n * Provide `options` to indicate whether `func` should be invoked on the\n * leading and/or trailing edge of the `wait` timeout. The `func` is invoked\n * with the last arguments provided to the debounced function. Subsequent\n * calls to the debounced function return the result of the last `func`\n * invocation.\n *\n * **Note:** If `leading` and `trailing` options are `true`, `func` is\n * invoked on the trailing edge of the timeout only if the debounced function\n * is invoked more than once during the `wait` timeout.\n *\n * If `wait` is `0` and `leading` is `false`, `func` invocation is deferred\n * until to the next tick, similar to `setTimeout` with a timeout of `0`.\n *\n * See [David Corbacho's article](https://css-tricks.com/debouncing-throttling-explained-examples/)\n * for details over the differences between `_.debounce` and `_.throttle`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to debounce.\n * @param {number} [wait=0] The number of milliseconds to delay.\n * @param {Object} [options={}] The options object.\n * @param {boolean} [options.leading=false]\n *  Specify invoking on the leading edge of the timeout.\n * @param {number} [options.maxWait]\n *  The maximum time `func` is allowed to be delayed before it's invoked.\n * @param {boolean} [options.trailing=true]\n *  Specify invoking on the trailing edge of the timeout.\n * @returns {Function} Returns the new debounced function.\n * @example\n *\n * // Avoid costly calculations while the window size is in flux.\n * jQuery(window).on('resize', _.debounce(calculateLayout, 150));\n *\n * // Invoke `sendMail` when clicked, debouncing subsequent calls.\n * jQuery(element).on('click', _.debounce(sendMail, 300, {\n *   'leading': true,\n *   'trailing': false\n * }));\n *\n * // Ensure `batchLog` is invoked once after 1 second of debounced calls.\n * var debounced = _.debounce(batchLog, 250, { 'maxWait': 1000 });\n * var source = new EventSource('/stream');\n * jQuery(source).on('message', debounced);\n *\n * // Cancel the trailing debounced invocation.\n * jQuery(window).on('popstate', debounced.cancel);\n */\nfunction debounce(func, wait, options) {\n  var lastArgs,\n      lastThis,\n      maxWait,\n      result,\n      timerId,\n      lastCallTime,\n      lastInvokeTime = 0,\n      leading = false,\n      maxing = false,\n      trailing = true;\n\n  if (typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  wait = toNumber(wait) || 0;\n  if (isObject(options)) {\n    leading = !!options.leading;\n    maxing = 'maxWait' in options;\n    maxWait = maxing ? nativeMax(toNumber(options.maxWait) || 0, wait) : maxWait;\n    trailing = 'trailing' in options ? !!options.trailing : trailing;\n  }\n\n  function invokeFunc(time) {\n    var args = lastArgs,\n        thisArg = lastThis;\n\n    lastArgs = lastThis = undefined;\n    lastInvokeTime = time;\n    result = func.apply(thisArg, args);\n    return result;\n  }\n\n  function leadingEdge(time) {\n    // Reset any `maxWait` timer.\n    lastInvokeTime = time;\n    // Start the timer for the trailing edge.\n    timerId = setTimeout(timerExpired, wait);\n    // Invoke the leading edge.\n    return leading ? invokeFunc(time) : result;\n  }\n\n  function remainingWait(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime,\n        timeWaiting = wait - timeSinceLastCall;\n\n    return maxing\n      ? nativeMin(timeWaiting, maxWait - timeSinceLastInvoke)\n      : timeWaiting;\n  }\n\n  function shouldInvoke(time) {\n    var timeSinceLastCall = time - lastCallTime,\n        timeSinceLastInvoke = time - lastInvokeTime;\n\n    // Either this is the first call, activity has stopped and we're at the\n    // trailing edge, the system time has gone backwards and we're treating\n    // it as the trailing edge, or we've hit the `maxWait` limit.\n    return (lastCallTime === undefined || (timeSinceLastCall >= wait) ||\n      (timeSinceLastCall < 0) || (maxing && timeSinceLastInvoke >= maxWait));\n  }\n\n  function timerExpired() {\n    var time = now();\n    if (shouldInvoke(time)) {\n      return trailingEdge(time);\n    }\n    // Restart the timer.\n    timerId = setTimeout(timerExpired, remainingWait(time));\n  }\n\n  function trailingEdge(time) {\n    timerId = undefined;\n\n    // Only invoke if we have `lastArgs` which means `func` has been\n    // debounced at least once.\n    if (trailing && lastArgs) {\n      return invokeFunc(time);\n    }\n    lastArgs = lastThis = undefined;\n    return result;\n  }\n\n  function cancel() {\n    if (timerId !== undefined) {\n      clearTimeout(timerId);\n    }\n    lastInvokeTime = 0;\n    lastArgs = lastCallTime = lastThis = timerId = undefined;\n  }\n\n  function flush() {\n    return timerId === undefined ? result : trailingEdge(now());\n  }\n\n  function debounced() {\n    var time = now(),\n        isInvoking = shouldInvoke(time);\n\n    lastArgs = arguments;\n    lastThis = this;\n    lastCallTime = time;\n\n    if (isInvoking) {\n      if (timerId === undefined) {\n        return leadingEdge(lastCallTime);\n      }\n      if (maxing) {\n        // Handle invocations in a tight loop.\n        clearTimeout(timerId);\n        timerId = setTimeout(timerExpired, wait);\n        return invokeFunc(lastCallTime);\n      }\n    }\n    if (timerId === undefined) {\n      timerId = setTimeout(timerExpired, wait);\n    }\n    return result;\n  }\n  debounced.cancel = cancel;\n  debounced.flush = flush;\n  return debounced;\n}\n\nmodule.exports = debounce;\n","var getAllKeys = require('./_getAllKeys');\n\n/** Used to compose bitmasks for value comparisons. */\nvar COMPARE_PARTIAL_FLAG = 1;\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * A specialized version of `baseIsEqualDeep` for objects with support for\n * partial deep comparisons.\n *\n * @private\n * @param {Object} object The object to compare.\n * @param {Object} other The other object to compare.\n * @param {number} bitmask The bitmask flags. See `baseIsEqual` for more details.\n * @param {Function} customizer The function to customize comparisons.\n * @param {Function} equalFunc The function to determine equivalents of values.\n * @param {Object} stack Tracks traversed `object` and `other` objects.\n * @returns {boolean} Returns `true` if the objects are equivalent, else `false`.\n */\nfunction equalObjects(object, other, bitmask, customizer, equalFunc, stack) {\n  var isPartial = bitmask & COMPARE_PARTIAL_FLAG,\n      objProps = getAllKeys(object),\n      objLength = objProps.length,\n      othProps = getAllKeys(other),\n      othLength = othProps.length;\n\n  if (objLength != othLength && !isPartial) {\n    return false;\n  }\n  var index = objLength;\n  while (index--) {\n    var key = objProps[index];\n    if (!(isPartial ? key in other : hasOwnProperty.call(other, key))) {\n      return false;\n    }\n  }\n  // Assume cyclic values are equal.\n  var stacked = stack.get(object);\n  if (stacked && stack.get(other)) {\n    return stacked == other;\n  }\n  var result = true;\n  stack.set(object, other);\n  stack.set(other, object);\n\n  var skipCtor = isPartial;\n  while (++index < objLength) {\n    key = objProps[index];\n    var objValue = object[key],\n        othValue = other[key];\n\n    if (customizer) {\n      var compared = isPartial\n        ? customizer(othValue, objValue, key, other, object, stack)\n        : customizer(objValue, othValue, key, object, other, stack);\n    }\n    // Recursively compare objects (susceptible to call stack limits).\n    if (!(compared === undefined\n          ? (objValue === othValue || equalFunc(objValue, othValue, bitmask, customizer, stack))\n          : compared\n        )) {\n      result = false;\n      break;\n    }\n    skipCtor || (skipCtor = key == 'constructor');\n  }\n  if (result && !skipCtor) {\n    var objCtor = object.constructor,\n        othCtor = other.constructor;\n\n    // Non `Object` object instances with different constructors are not equal.\n    if (objCtor != othCtor &&\n        ('constructor' in object && 'constructor' in other) &&\n        !(typeof objCtor == 'function' && objCtor instanceof objCtor &&\n          typeof othCtor == 'function' && othCtor instanceof othCtor)) {\n      result = false;\n    }\n  }\n  stack['delete'](object);\n  stack['delete'](other);\n  return result;\n}\n\nmodule.exports = equalObjects;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper'),\n    error = require('./implementation/ErrorEventDefinition');\n\nvar forEach = require('lodash/forEach');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var errorEvents = [\n    'bpmn:StartEvent',\n    'bpmn:BoundaryEvent',\n    'bpmn:EndEvent'\n  ];\n\n  forEach(errorEvents, function(event) {\n    if (is(element, event)) {\n\n      var errorEventDefinition = eventDefinitionHelper.getErrorEventDefinition(element);\n\n      if (errorEventDefinition) {\n        var isCatchingErrorEvent = is(element, 'bpmn:StartEvent') || is (element, 'bpmn:BoundaryEvent');\n\n        var showErrorCodeVariable = isCatchingErrorEvent,\n            showErrorMessageVariable = isCatchingErrorEvent;\n\n        error(\n          group,\n          element,\n          bpmnFactory,\n          errorEventDefinition,\n          showErrorCodeVariable,\n          showErrorMessageVariable,\n          translate);\n      }\n    }\n  });\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/**\n * Checks if `value` is a valid array-like length.\n *\n * **Note:** This method is loosely based on\n * [`ToLength`](http://ecma-international.org/ecma-262/7.0/#sec-tolength).\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a valid length, else `false`.\n * @example\n *\n * _.isLength(3);\n * // => true\n *\n * _.isLength(Number.MIN_VALUE);\n * // => false\n *\n * _.isLength(Infinity);\n * // => false\n *\n * _.isLength('3');\n * // => false\n */\nfunction isLength(value) {\n  return typeof value == 'number' &&\n    value > -1 && value % 1 == 0 && value <= MAX_SAFE_INTEGER;\n}\n\nmodule.exports = isLength;\n","'use strict';\n\nvar replace = String.prototype.replace;\nvar percentTwenties = /%20/g;\n\nmodule.exports = {\n    'default': 'RFC3986',\n    formatters: {\n        RFC1738: function (value) {\n            return replace.call(value, percentTwenties, '+');\n        },\n        RFC3986: function (value) {\n            return value;\n        }\n    },\n    RFC1738: 'RFC1738',\n    RFC3986: 'RFC3986'\n};\n","var identity = require('./identity'),\n    metaMap = require('./_metaMap');\n\n/**\n * The base implementation of `setData` without support for hot loop shorting.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar baseSetData = !metaMap ? identity : function(func, data) {\n  metaMap.set(func, data);\n  return func;\n};\n\nmodule.exports = baseSetData;\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks that no implicit split is modeled\n * starting from a task.\n *\n * users should model the parallel splitting gateway\n * explicitly instead.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Event'\n    ])) {\n      return;\n    }\n\n    const outgoing = node.outgoing || [];\n\n    const outgoingWithoutCondition = outgoing.filter((flow) => {\n      return !hasCondition(flow) && !isDefaultFlow(node, flow);\n    });\n\n    if (outgoingWithoutCondition.length > 1) {\n      reporter.report(node.id, 'Flow splits implicitly');\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n\n\n// helpers /////////////////////////////\n\nfunction hasCondition(flow) {\n  return !!flow.conditionExpression;\n}\n\nfunction isDefaultFlow(node, flow) {\n  return node['default'] === flow;\n}","var isObject = require('./isObject'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar NAN = 0 / 0;\n\n/** Used to match leading and trailing whitespace. */\nvar reTrim = /^\\s+|\\s+$/g;\n\n/** Used to detect bad signed hexadecimal string values. */\nvar reIsBadHex = /^[-+]0x[0-9a-f]+$/i;\n\n/** Used to detect binary string values. */\nvar reIsBinary = /^0b[01]+$/i;\n\n/** Used to detect octal string values. */\nvar reIsOctal = /^0o[0-7]+$/i;\n\n/** Built-in method references without a dependency on `root`. */\nvar freeParseInt = parseInt;\n\n/**\n * Converts `value` to a number.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to process.\n * @returns {number} Returns the number.\n * @example\n *\n * _.toNumber(3.2);\n * // => 3.2\n *\n * _.toNumber(Number.MIN_VALUE);\n * // => 5e-324\n *\n * _.toNumber(Infinity);\n * // => Infinity\n *\n * _.toNumber('3.2');\n * // => 3.2\n */\nfunction toNumber(value) {\n  if (typeof value == 'number') {\n    return value;\n  }\n  if (isSymbol(value)) {\n    return NAN;\n  }\n  if (isObject(value)) {\n    var other = typeof value.valueOf == 'function' ? value.valueOf() : value;\n    value = isObject(other) ? (other + '') : other;\n  }\n  if (typeof value != 'string') {\n    return value === 0 ? value : +value;\n  }\n  value = value.replace(reTrim, '');\n  var isBinary = reIsBinary.test(value);\n  return (isBinary || reIsOctal.test(value))\n    ? freeParseInt(value.slice(2), isBinary ? 2 : 8)\n    : (reIsBadHex.test(value) ? NAN : +value);\n}\n\nmodule.exports = toNumber;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Gets the list cache value for `key`.\n *\n * @private\n * @name get\n * @memberOf ListCache\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction listCacheGet(key) {\n  var data = this.__data__,\n      index = assocIndexOf(data, key);\n\n  return index < 0 ? undefined : data[index][1];\n}\n\nmodule.exports = listCacheGet;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar DataView = getNative(root, 'DataView');\n\nmodule.exports = DataView;\n","var bind = require('../internals/function-bind-context');\nvar IndexedObject = require('../internals/indexed-object');\nvar toObject = require('../internals/to-object');\nvar toLength = require('../internals/to-length');\nvar arraySpeciesCreate = require('../internals/array-species-create');\n\nvar push = [].push;\n\n// `Array.prototype.{ forEach, map, filter, some, every, find, findIndex }` methods implementation\nvar createMethod = function (TYPE) {\n  var IS_MAP = TYPE == 1;\n  var IS_FILTER = TYPE == 2;\n  var IS_SOME = TYPE == 3;\n  var IS_EVERY = TYPE == 4;\n  var IS_FIND_INDEX = TYPE == 6;\n  var NO_HOLES = TYPE == 5 || IS_FIND_INDEX;\n  return function ($this, callbackfn, that, specificCreate) {\n    var O = toObject($this);\n    var self = IndexedObject(O);\n    var boundFunction = bind(callbackfn, that, 3);\n    var length = toLength(self.length);\n    var index = 0;\n    var create = specificCreate || arraySpeciesCreate;\n    var target = IS_MAP ? create($this, length) : IS_FILTER ? create($this, 0) : undefined;\n    var value, result;\n    for (;length > index; index++) if (NO_HOLES || index in self) {\n      value = self[index];\n      result = boundFunction(value, index, O);\n      if (TYPE) {\n        if (IS_MAP) target[index] = result; // map\n        else if (result) switch (TYPE) {\n          case 3: return true;              // some\n          case 5: return value;             // find\n          case 6: return index;             // findIndex\n          case 2: push.call(target, value); // filter\n        } else if (IS_EVERY) return false;  // every\n      }\n    }\n    return IS_FIND_INDEX ? -1 : IS_SOME || IS_EVERY ? IS_EVERY : target;\n  };\n};\n\nmodule.exports = {\n  // `Array.prototype.forEach` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.foreach\n  forEach: createMethod(0),\n  // `Array.prototype.map` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.map\n  map: createMethod(1),\n  // `Array.prototype.filter` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.filter\n  filter: createMethod(2),\n  // `Array.prototype.some` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.some\n  some: createMethod(3),\n  // `Array.prototype.every` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.every\n  every: createMethod(4),\n  // `Array.prototype.find` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.find\n  find: createMethod(5),\n  // `Array.prototype.findIndex` method\n  // https://tc39.github.io/ecma262/#sec-array.prototype.findIndex\n  findIndex: createMethod(6)\n};\n","/**\n * Gets the number of `placeholder` occurrences in `array`.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} placeholder The placeholder to search for.\n * @returns {number} Returns the placeholder count.\n */\nfunction countHolders(array, placeholder) {\n  var length = array.length,\n      result = 0;\n\n  while (length--) {\n    if (array[length] === placeholder) {\n      ++result;\n    }\n  }\n  return result;\n}\n\nmodule.exports = countHolders;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'bpmn:Process') || is(element, 'bpmn:Participant') && bo.get('processRef')) {\n    var versionTagEntry = entryFactory.textField({\n      id: 'versionTag',\n      label: translate('Version Tag'),\n      modelProperty: 'versionTag'\n    });\n\n    // in participants we have to change the default behavior of set and get\n    if (is(element, 'bpmn:Participant')) {\n      versionTagEntry.get = function(element) {\n        var processBo = bo.get('processRef');\n\n        return {\n          versionTag: processBo.get('camunda:versionTag')\n        };\n      };\n\n      versionTagEntry.set = function(element, values) {\n        var processBo = bo.get('processRef');\n\n        return cmdHelper.updateBusinessObject(element, processBo, {\n          'camunda:versionTag': values.versionTag || undefined\n        });\n      };\n    }\n\n    group.entries.push(versionTagEntry);\n\n  }\n};\n","'use strict';\n\nvar DEFAULT_PRIORITY = 1000;\n\n\n/**\n * A component that decides upon the visibility / editable\n * state of properties in the properties panel.\n *\n * Implementors must subclass this component and override\n * {@link PropertiesActivator#isEntryVisible} and\n * {@link PropertiesActivator#isPropertyEditable} to provide\n * custom behavior.\n *\n * @class\n * @constructor\n *\n * @param {EventBus} eventBus\n * @param {Number} [priority] at which priority to hook into the activation\n */\nfunction PropertiesActivator(eventBus, priority) {\n  var self = this;\n\n  priority = priority || DEFAULT_PRIORITY;\n\n  eventBus.on('propertiesPanel.isEntryVisible', priority, function(e) {\n    return self.isEntryVisible(e.entry, e.element);\n  });\n\n  eventBus.on('propertiesPanel.isPropertyEditable', priority, function(e) {\n    return self.isPropertyEditable(e.entry, e.propertyName, e.element);\n  });\n}\n\nPropertiesActivator.$inject = [ 'eventBus' ];\n\nmodule.exports = PropertiesActivator;\n\n\n/**\n * Should the given entry be visible for the specified element.\n *\n * @method  PropertiesActivator#isEntryVisible\n *\n * @param {EntryDescriptor} entry\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isEntryVisible = function(entry, element) {\n  return true;\n};\n\n/**\n * Should the given property be editable for the specified element\n *\n * @method  PropertiesActivator#isPropertyEditable\n *\n * @param {EntryDescriptor} entry\n * @param {String} propertyName\n * @param {ModdleElement} element\n *\n * @returns {Boolean}\n */\nPropertiesActivator.prototype.isPropertyEditable = function(entry, propertyName, element) {\n  return true;\n};","'use strict';\n\nvar properties = require('./implementation/Properties'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var propertiesEntry = properties(element, bpmnFactory, {\n    id: 'properties',\n    modelProperties: [ 'name', 'value' ],\n    labels: [ translate('Name'), translate('Value') ],\n\n    getParent: function(element, node, bo) {\n      return bo.extensionElements;\n    },\n\n    createParent: function(element, bo) {\n      var parent = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n      var cmd = cmdHelper.updateBusinessObject(element, bo, { extensionElements: parent });\n      return {\n        cmd: cmd,\n        parent: parent\n      };\n    }\n  }, translate);\n\n  if (propertiesEntry) {\n    group.entries.push(propertiesEntry);\n  }\n\n};\n","/** Used to match wrap detail comments. */\nvar reWrapDetails = /\\{\\n\\/\\* \\[wrapped with (.+)\\] \\*/,\n    reSplitDetails = /,? & /;\n\n/**\n * Extracts wrapper details from the `source` body comment.\n *\n * @private\n * @param {string} source The source to inspect.\n * @returns {Array} Returns the wrapper details.\n */\nfunction getWrapDetails(source) {\n  var match = source.match(reWrapDetails);\n  return match ? match[1].split(reSplitDetails) : [];\n}\n\nmodule.exports = getWrapDetails;\n","var baseMatches = require('./_baseMatches'),\n    baseMatchesProperty = require('./_baseMatchesProperty'),\n    identity = require('./identity'),\n    isArray = require('./isArray'),\n    property = require('./property');\n\n/**\n * The base implementation of `_.iteratee`.\n *\n * @private\n * @param {*} [value=_.identity] The value to convert to an iteratee.\n * @returns {Function} Returns the iteratee.\n */\nfunction baseIteratee(value) {\n  // Don't store the `typeof` result in a variable to avoid a JIT bug in Safari 9.\n  // See https://bugs.webkit.org/show_bug.cgi?id=156034 for more details.\n  if (typeof value == 'function') {\n    return value;\n  }\n  if (value == null) {\n    return identity;\n  }\n  if (typeof value == 'object') {\n    return isArray(value)\n      ? baseMatchesProperty(value[0], value[1])\n      : baseMatches(value);\n  }\n  return property(value);\n}\n\nmodule.exports = baseIteratee;\n","var nativeCreate = require('./_nativeCreate');\n\n/** Used to stand-in for `undefined` hash values. */\nvar HASH_UNDEFINED = '__lodash_hash_undefined__';\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Gets the hash value for `key`.\n *\n * @private\n * @name get\n * @memberOf Hash\n * @param {string} key The key of the value to get.\n * @returns {*} Returns the entry value.\n */\nfunction hashGet(key) {\n  var data = this.__data__;\n  if (nativeCreate) {\n    var result = data[key];\n    return result === HASH_UNDEFINED ? undefined : result;\n  }\n  return hasOwnProperty.call(data, key) ? data[key] : undefined;\n}\n\nmodule.exports = hashGet;\n","/**\n * This method returns `undefined`.\n *\n * @static\n * @memberOf _\n * @since 2.3.0\n * @category Util\n * @example\n *\n * _.times(2, _.noop);\n * // => [undefined, undefined]\n */\nfunction noop() {\n  // No operation performed.\n}\n\nmodule.exports = noop;\n","const disallowNodeType = require('./helper').disallowNodeType;\n\nmodule.exports = disallowNodeType('bpmn:ComplexGateway');","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var externalTaskPriorityEntry = entryFactory.textField({\n    id: 'externalTaskPriority',\n    label: translate('Task Priority'),\n    modelProperty: 'taskPriority',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        taskPriority: bo.get('camunda:taskPriority')\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, {\n        'camunda:taskPriority': values.taskPriority || undefined\n      });\n    }\n\n  });\n\n  return [ externalTaskPriorityEntry ];\n\n};\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domQuery = require('min-dom').query;\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar textField = function(options, defaultParameters) {\n\n  // Default action for the button next to the input-field\n  var defaultButtonAction = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n    input.value = '';\n\n    return true;\n  };\n\n  // default method to determine if the button should be visible\n  var defaultButtonShow = function(element, inputNode) {\n    var input = domQuery('input[name=\"' + options.modelProperty + '\"]', inputNode);\n\n    return input.value !== '';\n  };\n\n\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      dataValueLabel = options.dataValueLabel,\n      buttonLabel = (options.buttonLabel || 'X'),\n      actionName = (typeof options.buttonAction != 'undefined') ? options.buttonAction.name : 'clear',\n      actionMethod = (typeof options.buttonAction != 'undefined') ? options.buttonAction.method : defaultButtonAction,\n      showName = (typeof options.buttonShow != 'undefined') ? options.buttonShow.name : 'canClear',\n      showMethod = (typeof options.buttonShow != 'undefined') ? options.buttonShow.method : defaultButtonShow,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\" ' +\n      (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n      (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n      (dataValueLabel ? 'data-value=\"' + escapeHTML(dataValueLabel) + '\"' : '') + '>'+ escapeHTML(label) +'</label>' +\n    '<div class=\"bpp-field-wrapper\" ' +\n      (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n      (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n      '>' +\n      '<input id=\"camunda-' + escapeHTML(resource.id) + '\" type=\"text\" name=\"' + escapeHTML(options.modelProperty) + '\" ' +\n        (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n        (canBeHidden ? 'data-show=\"isHidden\"' : '') +\n        ' />' +\n      '<button class=\"' + escapeHTML(actionName) + '\" data-action=\"' + escapeHTML(actionName) + '\" data-show=\"' + escapeHTML(showName) + '\" ' +\n        (canBeDisabled ? 'data-disable=\"isDisabled\"' : '') +\n        (canBeHidden ? ' data-show=\"isHidden\"' : '') + '>' +\n        '<span>' + escapeHTML(buttonLabel) + '</span>' +\n      '</button>' +\n    '</div>';\n\n  // add description below text input entry field\n  if (description) {\n    resource.html += entryFieldDescription(description);\n  }\n\n  resource[actionName] = actionMethod;\n  resource[showName] = showMethod;\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-textfield'];\n\n  return resource;\n};\n\nmodule.exports = textField;\n","'use strict';\n\nvar entryFactory = require('../../../factory/EntryFactory'),\n    cmdHelper = require('../../../helper/CmdHelper');\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var getValue = function(businessObject) {\n    return function(element) {\n      var documentations = businessObject && businessObject.get('documentation'),\n          text = (documentations && documentations.length > 0) ? documentations[0].text : '';\n\n      return { documentation: text };\n    };\n  };\n\n  var setValue = function(businessObject) {\n    return function(element, values) {\n      var newObjectList = [];\n\n      if (typeof values.documentation !== 'undefined' && values.documentation !== '') {\n        newObjectList.push(bpmnFactory.create('bpmn:Documentation', {\n          text: values.documentation\n        }));\n      }\n\n      return cmdHelper.setList(element, businessObject, 'documentation', newObjectList);\n    };\n  };\n\n  // Element Documentation\n  var elementDocuEntry = entryFactory.textBox({\n    id: 'documentation',\n    label: translate('Element Documentation'),\n    modelProperty: 'documentation'\n  });\n\n  elementDocuEntry.set = setValue(getBusinessObject(element));\n\n  elementDocuEntry.get = getValue(getBusinessObject(element));\n\n  group.entries.push(elementDocuEntry);\n\n\n  var processRef;\n\n  // Process Documentation when having a Collaboration Diagram\n  if (is(element, 'bpmn:Participant')) {\n\n    processRef = getBusinessObject(element).processRef;\n\n    // do not show for collapsed Pools/Participants\n    if (processRef) {\n      var processDocuEntry = entryFactory.textBox({\n        id: 'process-documentation',\n        label: translate('Process Documentation'),\n        modelProperty: 'documentation'\n      });\n\n      processDocuEntry.set = setValue(processRef);\n\n      processDocuEntry.get = getValue(processRef);\n\n      group.entries.push(processDocuEntry);\n    }\n  }\n\n};\n","var baseIsEqualDeep = require('./_baseIsEqualDeep'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * The base implementation of `_.isEqual` which supports partial comparisons\n * and tracks traversed objects.\n *\n * @private\n * @param {*} value The value to compare.\n * @param {*} other The other value to compare.\n * @param {boolean} bitmask The bitmask flags.\n *  1 - Unordered comparison\n *  2 - Partial comparison\n * @param {Function} [customizer] The function to customize comparisons.\n * @param {Object} [stack] Tracks traversed `value` and `other` objects.\n * @returns {boolean} Returns `true` if the values are equivalent, else `false`.\n */\nfunction baseIsEqual(value, other, bitmask, customizer, stack) {\n  if (value === other) {\n    return true;\n  }\n  if (value == null || other == null || (!isObjectLike(value) && !isObjectLike(other))) {\n    return value !== value && other !== other;\n  }\n  return baseIsEqualDeep(value, other, bitmask, customizer, baseIsEqual, stack);\n}\n\nmodule.exports = baseIsEqual;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isEventSubProcess = require('bpmn-js/lib/util/DiUtil').isEventSubProcess;\n\nmodule.exports = function(group, element, bpmnFactory, conditionalEventDefinition, elementRegistry, translate) {\n\n  var getValue = function(modelProperty) {\n    return function(element) {\n      var modelPropertyValue = conditionalEventDefinition.get('camunda:' + modelProperty);\n      var value = {};\n\n      value[modelProperty] = modelPropertyValue;\n      return value;\n    };\n  };\n\n  var setValue = function(modelProperty) {\n    return function(element, values) {\n      var props = {};\n\n      props['camunda:' + modelProperty] = values[modelProperty] || undefined;\n\n      return cmdHelper.updateBusinessObject(element, conditionalEventDefinition, props);\n    };\n  };\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableName',\n    label: translate('Variable Name'),\n    modelProperty : 'variableName',\n\n    get: getValue('variableName'),\n    set: setValue('variableName')\n  }));\n\n  var isConditionalStartEvent =\n    is(element, 'bpmn:StartEvent') && !isEventSubProcess(element.parent);\n\n  if (!isConditionalStartEvent) {\n    group.entries.push(entryFactory.textField({\n      id: 'variableEvent',\n      label: translate('Variable Event'),\n      description: translate('Specify more than one variable change event as a comma separated list.'),\n      modelProperty : 'variableEvent',\n\n      get: getValue('variableEvent'),\n      set: setValue('variableEvent')\n    }));\n  }\n};\n","/** Used as references for various `Number` constants. */\nvar MAX_SAFE_INTEGER = 9007199254740991;\n\n/** Used to detect unsigned integer values. */\nvar reIsUint = /^(?:0|[1-9]\\d*)$/;\n\n/**\n * Checks if `value` is a valid array-like index.\n *\n * @private\n * @param {*} value The value to check.\n * @param {number} [length=MAX_SAFE_INTEGER] The upper bounds of a valid index.\n * @returns {boolean} Returns `true` if `value` is a valid index, else `false`.\n */\nfunction isIndex(value, length) {\n  var type = typeof value;\n  length = length == null ? MAX_SAFE_INTEGER : length;\n\n  return !!length &&\n    (type == 'number' ||\n      (type != 'symbol' && reIsUint.test(value))) &&\n        (value > -1 && value % 1 == 0 && value < length);\n}\n\nmodule.exports = isIndex;\n","var render = function () {var _vm=this;var _h=_vm.$createElement;var _c=_vm._self._c||_h;return _c('div',{staticClass:\"search\"},[_c('el-autocomplete',{staticClass:\"inputBox\",attrs:{\"fetch-suggestions\":_vm.querySearchAsync,\"placeholder\":\"请输入内容\",\"trigger-on-focus\":false},on:{\"select\":_vm.handleSelect},nativeOn:{\"keyup\":function($event){if(!$event.type.indexOf('key')&&_vm._k($event.keyCode,\"enter\",13,$event.key,\"Enter\")){ return null; }return _vm.search($event)}},scopedSlots:_vm._u([{key:\"default\",fn:function(ref){\nvar item = ref.item;\nreturn [_c('div',[_c('div',{staticClass:\"name\"},[_c('span',[_vm._v(_vm._s(item.value))])]),_c('div',{staticClass:\"addr\"},[_c('span',[_vm._v(_vm._s(item.address))])])])]}}]),model:{value:(_vm.state),callback:function ($$v) {_vm.state=$$v},expression:\"state\"}}),_c('el-button',{attrs:{\"type\":\"primary\"},on:{\"click\":_vm.search}},[_vm._v(\"确定\")])],1)}\nvar staticRenderFns = []\n\nexport { render, staticRenderFns }","<template>\r\n    <div class=\"search\">\r\n        <el-autocomplete class=\"inputBox\"\r\n                         v-model=\"state\"\r\n                         :fetch-suggestions=\"querySearchAsync\"\r\n                         placeholder=\"请输入内容\"\r\n                         :trigger-on-focus=\"false\"\r\n                         @select=\"handleSelect\"\r\n                         @keyup.enter.native=\"search\">\r\n            <template slot-scope=\"{ item }\">\r\n                <div>\r\n                    <div class=\"name\"><span>{{ item.value }}</span></div>\r\n                    <div class=\"addr\"><span>{{ item.address }}</span></div>\r\n                </div>\r\n\r\n\r\n            </template>\r\n        </el-autocomplete>\r\n        <el-button type=\"primary\" @click=\"search\">确定</el-button>\r\n\r\n    </div>\r\n</template>\r\n\r\n<script>\r\n    export default {\r\n        data() {\r\n            return {\r\n                restaurants: [],\r\n                state: ''\r\n            };\r\n        },\r\n        methods: {\r\n            search(){\r\n                console.log(\"search\")\r\n            },\r\n            querySearchAsync(queryString, cb) {\r\n                var restaurants = this.restaurants;\r\n                var results = queryString ? restaurants.filter(this.createFilter(queryString)) : restaurants;\r\n                // 调用 callback 返回建议列表的数据\r\n                //cb(results);\r\n                clearTimeout(this.timeout);\r\n                this.timeout = setTimeout(() => {\r\n                    cb(results);\r\n                }, 3000 * Math.random());\r\n            },\r\n            createFilter(queryString) {\r\n                return (restaurant) => {\r\n                    return (restaurant.value.toLowerCase().indexOf(queryString.toLowerCase()) !== -1);\r\n                };\r\n            },\r\n            loadAll() {\r\n                return [\r\n                    { \"value\": \"三全鲜食（北新泾店）\", \"address\": \"长宁区新渔路144号\" },\r\n                    { \"value\": \"Hot honey 首尔炸鸡（仙霞路）\", \"address\": \"上海市长宁区淞虹路661号\" },\r\n                    { \"value\": \"新旺角茶餐厅\", \"address\": \"上海市普陀区真北路988号创邑金沙谷6号楼113\" },\r\n                    { \"value\": \"泷千家(天山西路店)\", \"address\": \"天山西路438号\" },\r\n                    { \"value\": \"胖仙女纸杯蛋糕（上海凌空店）\", \"address\": \"上海市长宁区金钟路968号1幢18号楼一层商铺18-101\" },\r\n                    { \"value\": \"贡茶\", \"address\": \"上海市长宁区金钟路633号\" },\r\n                    { \"value\": \"豪大大香鸡排超级奶爸\", \"address\": \"上海市嘉定区曹安公路曹安路1685号\" },\r\n                    { \"value\": \"茶芝兰（奶茶，手抓饼）\", \"address\": \"上海市普陀区同普路1435号\" },\r\n                    { \"value\": \"十二泷町\", \"address\": \"上海市北翟路1444弄81号B幢-107\" },\r\n                    { \"value\": \"星移浓缩咖啡\", \"address\": \"上海市嘉定区新郁路817号\" },\r\n                    { \"value\": \"阿姨奶茶/豪大大\", \"address\": \"嘉定区曹安路1611号\" },\r\n                    { \"value\": \"新麦甜四季甜品炸鸡\", \"address\": \"嘉定区曹安公路2383弄55号\" },\r\n                    { \"value\": \"Monica摩托主题咖啡店\", \"address\": \"嘉定区江桥镇曹安公路2409号1F，2383弄62号1F\" },\r\n                    { \"value\": \"浮生若茶（凌空soho店）\", \"address\": \"上海长宁区金钟路968号9号楼地下一层\" },\r\n                    { \"value\": \"NONO JUICE  鲜榨果汁\", \"address\": \"上海市长宁区天山西路119号\" },\r\n                    { \"value\": \"CoCo都可(北新泾店）\", \"address\": \"上海市长宁区仙霞西路\" },\r\n                    { \"value\": \"快乐柠檬（神州智慧店）\", \"address\": \"上海市长宁区天山西路567号1层R117号店铺\" },\r\n                    { \"value\": \"Merci Paul cafe\", \"address\": \"上海市普陀区光复西路丹巴路28弄6号楼819\" },\r\n                    { \"value\": \"猫山王（西郊百联店）\", \"address\": \"上海市长宁区仙霞西路88号第一层G05-F01-1-306\" },\r\n                    { \"value\": \"枪会山\", \"address\": \"上海市普陀区棕榈路\" },\r\n                    { \"value\": \"纵食\", \"address\": \"元丰天山花园(东门) 双流路267号\" },\r\n                    { \"value\": \"钱记\", \"address\": \"上海市长宁区天山西路\" },\r\n                    { \"value\": \"壹杯加\", \"address\": \"上海市长宁区通协路\" },\r\n                    { \"value\": \"唦哇嘀咖\", \"address\": \"上海市长宁区新泾镇金钟路999号2幢（B幢）第01层第1-02A单元\" },\r\n                    { \"value\": \"爱茜茜里(西郊百联)\", \"address\": \"长宁区仙霞西路88号1305室\" },\r\n                    { \"value\": \"爱茜茜里(近铁广场)\", \"address\": \"上海市普陀区真北路818号近铁城市广场北区地下二楼N-B2-O2-C商铺\" },\r\n                    { \"value\": \"鲜果榨汁（金沙江路和美广店）\", \"address\": \"普陀区金沙江路2239号金沙和美广场B1-10-6\" },\r\n                    { \"value\": \"开心丽果（缤谷店）\", \"address\": \"上海市长宁区威宁路天山路341号\" },\r\n                    { \"value\": \"超级鸡车（丰庄路店）\", \"address\": \"上海市嘉定区丰庄路240号\" },\r\n                    { \"value\": \"妙生活果园（北新泾店）\", \"address\": \"长宁区新渔路144号\" },\r\n                    { \"value\": \"香宜度麻辣香锅\", \"address\": \"长宁区淞虹路148号\" },\r\n                    { \"value\": \"凡仔汉堡（老真北路店）\", \"address\": \"上海市普陀区老真北路160号\" },\r\n                    { \"value\": \"港式小铺\", \"address\": \"上海市长宁区金钟路968号15楼15-105室\" },\r\n                    { \"value\": \"蜀香源麻辣香锅（剑河路店）\", \"address\": \"剑河路443-1\" },\r\n                    { \"value\": \"北京饺子馆\", \"address\": \"长宁区北新泾街道天山西路490-1号\" },\r\n                    { \"value\": \"饭典*新简餐（凌空SOHO店）\", \"address\": \"上海市长宁区金钟路968号9号楼地下一层9-83室\" },\r\n                    { \"value\": \"焦耳·川式快餐（金钟路店）\", \"address\": \"上海市金钟路633号地下一层甲部\" },\r\n                    { \"value\": \"动力鸡车\", \"address\": \"长宁区仙霞西路299弄3号101B\" },\r\n                    { \"value\": \"浏阳蒸菜\", \"address\": \"天山西路430号\" },\r\n                    { \"value\": \"四海游龙（天山西路店）\", \"address\": \"上海市长宁区天山西路\" },\r\n                    { \"value\": \"樱花食堂（凌空店）\", \"address\": \"上海市长宁区金钟路968号15楼15-105室\" },\r\n                    { \"value\": \"壹分米客家传统调制米粉(天山店)\", \"address\": \"天山西路428号\" },\r\n                    { \"value\": \"福荣祥烧腊（平溪路店）\", \"address\": \"上海市长宁区协和路福泉路255弄57-73号\" },\r\n                    { \"value\": \"速记黄焖鸡米饭\", \"address\": \"上海市长宁区北新泾街道金钟路180号1层01号摊位\" },\r\n                    { \"value\": \"红辣椒麻辣烫\", \"address\": \"上海市长宁区天山西路492号\" },\r\n                    { \"value\": \"(小杨生煎)西郊百联餐厅\", \"address\": \"长宁区仙霞西路88号百联2楼\" },\r\n                    { \"value\": \"阳阳麻辣烫\", \"address\": \"天山西路389号\" },\r\n                    { \"value\": \"南拳妈妈龙虾盖浇饭\", \"address\": \"普陀区金沙江路1699号鑫乐惠美食广场A13\" }\r\n                ];\r\n            },\r\n            handleSelect(item) {\r\n                console.log(item);\r\n            },\r\n        },\r\n        mounted() {\r\n            this.restaurants = this.loadAll();\r\n        }\r\n    }\r\n</script>\r\n\r\n<style>\r\n\r\n    .name {\r\n        text-overflow: ellipsis;\r\n        overflow: hidden;\r\n        float: left;\r\n    }\r\n    .addr {\r\n        font-size: 12px;\r\n        color: red;\r\n        text-align:right;\r\n        float: right;\r\n    }\r\n    .inputBox{\r\n        width:400px\r\n    }\r\n    .search{\r\n        position: fixed;\r\n        border-radius: 0.25rem;\r\n        left: 50%;\r\n        top: 50%;\r\n        transform: translate(-50%, -50%);\r\n        z-index: 1000;\r\n    }\r\n</style>\r\n","import mod from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../node_modules/cache-loader/dist/cjs.js??ref--12-0!../../node_modules/thread-loader/dist/cjs.js!../../node_modules/babel-loader/lib/index.js!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./Search.vue?vue&type=script&lang=js&\"","import { render, staticRenderFns } from \"./Search.vue?vue&type=template&id=f648602e&\"\nimport script from \"./Search.vue?vue&type=script&lang=js&\"\nexport * from \"./Search.vue?vue&type=script&lang=js&\"\nimport style0 from \"./Search.vue?vue&type=style&index=0&lang=css&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  null,\n  null\n  \n)\n\nexport default component.exports","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * Create a checker that disallows the given element type.\n *\n * @param {String} type\n *\n * @return {Function} ruleImpl\n */\nfunction disallowNodeType(type) {\n\n  return function() {\n\n    function check(node, reporter) {\n\n      if (is(node, type)) {\n        reporter.report(node.id, 'Element has disallowed type <' + type + '>');\n      }\n    }\n\n    return {\n      check\n    };\n\n  };\n\n}\n\nmodule.exports.disallowNodeType = disallowNodeType;","'use strict';\n\nvar elementHelper = require('../helper/ElementHelper');\n\n/**\n * A handler capable of creating a new element under a provided parent\n * and updating / creating a reference to it in one atomic action.\n *\n * @class\n * @constructor\n */\nfunction CreateAndReferenceElementHandler(elementRegistry, bpmnFactory) {\n  this._elementRegistry = elementRegistry;\n  this._bpmnFactory = bpmnFactory;\n}\n\nCreateAndReferenceElementHandler.$inject = [ 'elementRegistry', 'bpmnFactory' ];\n\nmodule.exports = CreateAndReferenceElementHandler;\n\n\n// api ////////////////////\n\n/**\n * Creates a new element under a provided parent and updates / creates a reference to it in\n * one atomic action.\n *\n * @method  CreateAndReferenceElementHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element which is the context for the reference\n * @param {moddle.referencingObject} context.referencingObject the object which creates the reference\n * @param {String} context.referenceProperty the property of the referencingObject which makes the reference\n * @param {moddle.newObject} context.newObject the new object to add\n * @param {moddle.newObjectContainer} context.newObjectContainer the container for the new object\n *\n * @returns {Array<djs.mode.Base>} the updated element\n */\nCreateAndReferenceElementHandler.prototype.execute = function(context) {\n\n  var referencingObject = ensureNotNull(context.referencingObject, 'referencingObject'),\n      referenceProperty = ensureNotNull(context.referenceProperty, 'referenceProperty'),\n      newObject = ensureNotNull(context.newObject, 'newObject'),\n      newObjectContainer = ensureNotNull(context.newObjectContainer, 'newObjectContainer'),\n      newObjectParent = ensureNotNull(context.newObjectParent, 'newObjectParent'),\n      changed = [ context.element ]; // this will not change any diagram-js elements\n\n  // create new object\n  var referencedObject = elementHelper\n    .createElement(newObject.type, newObject.properties, newObjectParent, this._bpmnFactory);\n  context.referencedObject = referencedObject;\n\n  // add to containing list\n  newObjectContainer.push(referencedObject);\n\n  // adjust reference attribute\n  context.previousReference = referencingObject[referenceProperty];\n  referencingObject[referenceProperty] = referencedObject;\n\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  CreateAndReferenceElementHandler#revert\n *\n * @param {Object} context\n *\n * @returns {djs.mode.Base} the updated element\n */\nCreateAndReferenceElementHandler.prototype.revert = function(context) {\n\n  var referencingObject = context.referencingObject,\n      referenceProperty = context.referenceProperty,\n      previousReference = context.previousReference,\n      referencedObject = context.referencedObject,\n      newObjectContainer = context.newObjectContainer;\n\n  // reset reference\n  referencingObject.set(referenceProperty, previousReference);\n\n  // remove new element\n  newObjectContainer.splice(newObjectContainer.indexOf(referencedObject), 1);\n\n  return context.changed;\n};\n\n\n\n// helpers //////////////\n\nfunction ensureNotNull(prop, name) {\n  if (!prop) {\n    throw new Error(name + ' required');\n  }\n  return prop;\n}\n","const {\n  is\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks whether not more than one blank start event\n * exists per scope.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!is(node, 'bpmn:FlowElementsContainer')) {\n      return;\n    }\n\n    const flowElements = node.flowElements || [];\n\n    const blankStartEvents = flowElements.filter(function(flowElement) {\n\n      if (!is(flowElement, 'bpmn:StartEvent')) {\n        return false;\n      }\n\n      const eventDefinitions = flowElement.eventDefinitions || [];\n\n      return eventDefinitions.length === 0;\n    });\n\n    if (blankStartEvents.length > 1) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' has multiple blank start events');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","var baseSetToString = require('./_baseSetToString'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets the `toString` method of `func` to return `string`.\n *\n * @private\n * @param {Function} func The function to modify.\n * @param {Function} string The `toString` result.\n * @returns {Function} Returns `func`.\n */\nvar setToString = shortOut(baseSetToString);\n\nmodule.exports = setToString;\n","\nvar cache = {};\n\n/**\n * A resolver that caches rules and configuration as part of the bundle,\n * making them accessible in the browser.\n *\n * @param {Object} cache\n */\nfunction Resolver() {}\n\nResolver.prototype.resolveRule = function(pkg, ruleName) {\n\n  const rule = cache[pkg + '/' + ruleName];\n\n  if (!rule) {\n    throw new Error('cannot resolve rule <' + pkg + '/' + ruleName + '>');\n  }\n\n  return rule;\n};\n\nResolver.prototype.resolveConfig = function(pkg, configName) {\n  throw new Error(\n    'cannot resolve config <' + configName + '> in <' + pkg +'>'\n  );\n};\n\nvar resolver = new Resolver();\n\nvar rules = {\n  \"conditional-flows\": \"error\",\n  \"end-event-required\": \"error\",\n  \"event-sub-process-typed-start-event\": \"error\",\n  \"fake-join\": \"warn\",\n  \"label-required\": \"error\",\n  \"no-complex-gateway\": \"error\",\n  \"no-disconnected\": \"error\",\n  \"no-duplicate-sequence-flows\": \"error\",\n  \"no-gateway-join-fork\": \"error\",\n  \"no-implicit-split\": \"error\",\n  \"no-inclusive-gateway\": \"error\",\n  \"single-blank-start-event\": \"error\",\n  \"single-event-definition\": \"error\",\n  \"start-event-required\": \"error\",\n  \"sub-process-blank-start-event\": \"error\"\n};\n\nvar config = {\n  rules: rules\n};\n\nvar bundle = {\n  resolver: resolver,\n  config: config\n};\n\nexport { resolver, config };\n\nexport default bundle;\n\n\n\nimport rule_0 from 'bpmnlint/rules/conditional-flows';\ncache['bpmnlint/conditional-flows'] = rule_0;\n\nimport rule_1 from 'bpmnlint/rules/end-event-required';\ncache['bpmnlint/end-event-required'] = rule_1;\n\nimport rule_2 from 'bpmnlint/rules/event-sub-process-typed-start-event';\ncache['bpmnlint/event-sub-process-typed-start-event'] = rule_2;\n\nimport rule_3 from 'bpmnlint/rules/fake-join';\ncache['bpmnlint/fake-join'] = rule_3;\n\nimport rule_4 from 'bpmnlint/rules/label-required';\ncache['bpmnlint/label-required'] = rule_4;\n\nimport rule_5 from 'bpmnlint/rules/no-complex-gateway';\ncache['bpmnlint/no-complex-gateway'] = rule_5;\n\nimport rule_6 from 'bpmnlint/rules/no-disconnected';\ncache['bpmnlint/no-disconnected'] = rule_6;\n\nimport rule_7 from 'bpmnlint/rules/no-duplicate-sequence-flows';\ncache['bpmnlint/no-duplicate-sequence-flows'] = rule_7;\n\nimport rule_8 from 'bpmnlint/rules/no-gateway-join-fork';\ncache['bpmnlint/no-gateway-join-fork'] = rule_8;\n\nimport rule_9 from 'bpmnlint/rules/no-implicit-split';\ncache['bpmnlint/no-implicit-split'] = rule_9;\n\nimport rule_10 from 'bpmnlint/rules/no-inclusive-gateway';\ncache['bpmnlint/no-inclusive-gateway'] = rule_10;\n\nimport rule_11 from 'bpmnlint/rules/single-blank-start-event';\ncache['bpmnlint/single-blank-start-event'] = rule_11;\n\nimport rule_12 from 'bpmnlint/rules/single-event-definition';\ncache['bpmnlint/single-event-definition'] = rule_12;\n\nimport rule_13 from 'bpmnlint/rules/start-event-required';\ncache['bpmnlint/start-event-required'] = rule_13;\n\nimport rule_14 from 'bpmnlint/rules/sub-process-blank-start-event';\ncache['bpmnlint/sub-process-blank-start-event'] = rule_14;","var LazyWrapper = require('./_LazyWrapper'),\n    LodashWrapper = require('./_LodashWrapper'),\n    copyArray = require('./_copyArray');\n\n/**\n * Creates a clone of `wrapper`.\n *\n * @private\n * @param {Object} wrapper The wrapper to clone.\n * @returns {Object} Returns the cloned wrapper.\n */\nfunction wrapperClone(wrapper) {\n  if (wrapper instanceof LazyWrapper) {\n    return wrapper.clone();\n  }\n  var result = new LodashWrapper(wrapper.__wrapped__, wrapper.__chain__);\n  result.__actions__ = copyArray(wrapper.__actions__);\n  result.__index__  = wrapper.__index__;\n  result.__values__ = wrapper.__values__;\n  return result;\n}\n\nmodule.exports = wrapperClone;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar filter = require('lodash/filter');\n\nvar extensionElementsHelper = require('../../../helper/ExtensionElementsHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    eventDefinitionHelper = require('../../../helper/EventDefinitionHelper');\n\nvar extensionElementsEntry = require('./implementation/ExtensionElements');\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  */\nfunction getCamundaInOutMappings(element, type) {\n  var bo = getBusinessObject(element);\n\n  var signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(bo);\n\n  return extensionElementsHelper.getExtensionElements(signalEventDefinition || bo, type) || [];\n}\n\n/**\n  * return depend on parameter 'type' camunda:in or camunda:out extension elements\n  * with source or sourceExpression attribute\n  */\nfunction getVariableMappings(element, type) {\n  var camundaMappings = getCamundaInOutMappings(element, type);\n\n  return filter(camundaMappings, function(mapping) {\n    return !mapping.businessKey;\n  });\n}\n\nfunction getInOutType(mapping) {\n  var inOutType = 'source';\n\n  if (mapping.variables === 'all') {\n    inOutType = 'variables';\n  }\n  else if (typeof mapping.source !== 'undefined') {\n    inOutType = 'source';\n  }\n  else if (typeof mapping.sourceExpression !== 'undefined') {\n    inOutType = 'sourceExpression';\n  }\n\n  return inOutType;\n}\n\nvar CAMUNDA_IN_EXTENSION_ELEMENT = 'camunda:In',\n    CAMUNDA_OUT_EXTENSION_ELEMENT = 'camunda:Out';\n\nvar WHITESPACE_REGEX = /\\s/;\n\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  var inOutTypeOptions = [\n    {\n      name: translate('Source'),\n      value: 'source'\n    },\n    {\n      name: translate('Source Expression'),\n      value: 'sourceExpression'\n    },\n    {\n      name: translate('All'),\n      value: 'variables'\n    }\n  ];\n\n  var signalEventDefinition = eventDefinitionHelper.getSignalEventDefinition(element);\n\n  if (!is(element, 'camunda:CallActivity') && !signalEventDefinition) {\n    return;\n  }\n\n  if (signalEventDefinition && !(isAny(element, [\n    'bpmn:IntermediateThrowEvent',\n    'bpmn:EndEvent'\n  ]))) {\n    return;\n  }\n\n  var isSelected = function(element, node) {\n    return !!getSelected(element, node);\n  };\n\n  var getSelected = function(element, node) {\n    var parentNode = node.parentNode;\n    var selection = inEntry.getSelected(element, parentNode);\n\n    var parameter = getVariableMappings(element, CAMUNDA_IN_EXTENSION_ELEMENT)[selection.idx];\n\n    if (!parameter && outEntry) {\n      selection = outEntry.getSelected(element, parentNode);\n      parameter = getVariableMappings(element, CAMUNDA_OUT_EXTENSION_ELEMENT)[selection.idx];\n    }\n\n    return parameter;\n  };\n\n  var setOptionLabelValue = function(type) {\n    return function(element, node, option, property, value, idx) {\n      var variableMappings = getVariableMappings(element, type);\n      var mappingValue = variableMappings[idx];\n      var label = (mappingValue.target || '<undefined>') + ' := ';\n      var mappingType = getInOutType(mappingValue);\n\n      if (mappingType === 'variables') {\n        label = 'all';\n      }\n      else if (mappingType === 'source') {\n        label = label + (mappingValue.source || '<empty>');\n      }\n      else if (mappingType === 'sourceExpression') {\n        label = label + (mappingValue.sourceExpression || '<empty>');\n      } else {\n        label = label + '<empty>';\n      }\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function(type) {\n    return function(element, extensionElements, value) {\n      var newElem = elementHelper.createElement(type, { source: '' }, extensionElements, bpmnFactory);\n\n      return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newElem ]);\n    };\n  };\n\n  var removeElement = function(type) {\n    return function(element, extensionElements, value, idx) {\n      var variablesMappings= getVariableMappings(element, type);\n      var mapping = variablesMappings[idx];\n\n      if (mapping) {\n        return extensionElementsHelper\n          .removeEntry(signalEventDefinition || getBusinessObject(element), element, mapping);\n      }\n    };\n  };\n\n  // in mapping for source and sourceExpression ///////////////////////////////////////////////////////////////\n\n  var inEntry = extensionElementsEntry(element, bpmnFactory, {\n    id: 'variableMapping-in',\n    label: translate('In Mapping'),\n    modelProperty: 'source',\n    prefix: 'In',\n    idGeneration: false,\n    resizable: true,\n    businessObject: signalEventDefinition || getBusinessObject(element),\n\n    createExtensionElement: newElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n    removeExtensionElement: removeElement(CAMUNDA_IN_EXTENSION_ELEMENT),\n\n    getExtensionElements: function(element) {\n      return getVariableMappings(element, CAMUNDA_IN_EXTENSION_ELEMENT);\n    },\n\n    onSelectionChange: function(element, node, event, scope) {\n      outEntry && outEntry.deselect(element, node.parentNode);\n    },\n\n    setOptionLabelValue: setOptionLabelValue(CAMUNDA_IN_EXTENSION_ELEMENT)\n  });\n  group.entries.push(inEntry);\n\n  // out mapping for source and sourceExpression ///////////////////////////////////////////////////////\n\n  if (!signalEventDefinition) {\n    var outEntry = extensionElementsEntry(element, bpmnFactory, {\n      id: 'variableMapping-out',\n      label: translate('Out Mapping'),\n      modelProperty: 'source',\n      prefix: 'Out',\n      idGeneration: false,\n      resizable: true,\n\n      createExtensionElement: newElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n      removeExtensionElement: removeElement(CAMUNDA_OUT_EXTENSION_ELEMENT),\n\n      getExtensionElements: function(element) {\n        return getVariableMappings(element, CAMUNDA_OUT_EXTENSION_ELEMENT);\n      },\n\n      onSelectionChange: function(element, node, event, scope) {\n        inEntry.deselect(element, node.parentNode);\n      },\n\n      setOptionLabelValue: setOptionLabelValue(CAMUNDA_OUT_EXTENSION_ELEMENT)\n    });\n    group.entries.push(outEntry);\n  }\n\n  // label for selected mapping ///////////////////////////////////////////////////////\n\n  group.entries.push(entryFactory.label({\n    id: 'variableMapping-typeLabel',\n    get: function(element, node) {\n      var mapping = getSelected(element, node);\n\n      var value = '';\n      if (is(mapping, CAMUNDA_IN_EXTENSION_ELEMENT)) {\n        value = translate('In Mapping');\n      }\n      else if (is(mapping, CAMUNDA_OUT_EXTENSION_ELEMENT)) {\n        value = translate('Out Mapping');\n      }\n\n      return {\n        label: value\n      };\n    },\n\n    showLabel: function(element, node) {\n      return isSelected(element, node);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.selectBox({\n    id: 'variableMapping-inOutType',\n    label: translate('Type'),\n    selectOptions: inOutTypeOptions,\n    modelProperty: 'inOutType',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n      return {\n        inOutType: getInOutType(mapping)\n      };\n    },\n    set: function(element, values, node) {\n      var inOutType = values.inOutType;\n\n      var props = {\n        'source' : undefined,\n        'sourceExpression' : undefined,\n        'variables' : undefined\n      };\n\n      if (inOutType === 'source') {\n        props.source = '';\n      }\n      else if (inOutType === 'sourceExpression') {\n        props.sourceExpression = '';\n      }\n      else if (inOutType === 'variables') {\n        props.variables = 'all';\n        props.target = undefined;\n      }\n\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-source',\n    dataValueLabel: 'sourceLabel',\n    modelProperty: 'source',\n    get: function(element, node) {\n      var mapping = getSelected(element, node) || {};\n\n      var label = '';\n      var inOutType = getInOutType(mapping);\n      if (inOutType === 'source') {\n        label = translate('Source');\n      }\n      else if (inOutType === 'sourceExpression') {\n        label = translate('Source Expression');\n      }\n\n      return {\n        source: mapping[inOutType],\n        sourceLabel: label\n      };\n    },\n    set: function(element, values, node) {\n      values.source = values.source || undefined;\n\n      var mapping = getSelected(element, node);\n      var inOutType = getInOutType(mapping);\n\n      var props = {};\n      props[inOutType] = values.source || '';\n\n      return cmdHelper.updateBusinessObject(element, mapping, props);\n    },\n    // one of both (source or sourceExpression) must have a value to make\n    // the configuration easier and more understandable\n    // it is not engine conform\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        if (!values.source) {\n          validation.source =\n          validation.source = values.sourceLabel ?\n            translate('Mapping must have a {value}', { value: values.sourceLabel.toLowerCase() }) :\n            translate('Mapping must have a value');\n        }\n\n        var inOutType = getInOutType(mapping);\n\n        if (WHITESPACE_REGEX.test(values.source) && inOutType !== 'sourceExpression') {\n          validation.source = translate('{label} must not contain whitespace', { label: values.sourceLabel });\n        }\n      }\n\n      return validation;\n    },\n    hidden: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.textField({\n    id: 'variableMapping-target',\n    label: translate('Target'),\n    modelProperty: 'target',\n    get: function(element, node) {\n      return {\n        target: (getSelected(element, node) || {}).target\n      };\n    },\n    set: function(element, values, node) {\n      values.target = values.target || undefined;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    validate: function(element, values, node) {\n      var mapping = getSelected(element, node);\n\n      var validation = {};\n      if (mapping) {\n        var mappingType = getInOutType(mapping);\n\n        if (!values.target && mappingType !== 'variables') {\n          validation.target = translate('Mapping must have a target');\n        }\n\n        if (values.target\n          && WHITESPACE_REGEX.test(values.target)\n          && mappingType !== 'variables') {\n          validation.target = translate('Target must not contain whitespace');\n        }\n      }\n\n      return validation;\n    },\n    hidden: function(element, node) {\n      var selectedMapping = getSelected(element, node);\n      return !selectedMapping || (selectedMapping && selectedMapping.variables);\n    }\n  }));\n\n\n  group.entries.push(entryFactory.checkbox({\n    id: 'variableMapping-local',\n    label: translate('Local'),\n    modelProperty: 'local',\n    get: function(element, node) {\n      return {\n        local: (getSelected(element, node) || {}).local\n      };\n    },\n    set: function(element, values, node) {\n      values.local = values.local || false;\n      var mapping = getSelected(element, node);\n      return cmdHelper.updateBusinessObject(element, mapping, values);\n    },\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n  }));\n\n};\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that verifies that there exists no disconnected\n * flow elements, i.e. elements without incoming\n * _or_ outgoing sequence flows\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Gateway',\n      'bpmn:SubProcess',\n      'bpmn:Event'\n    ]) || node.triggeredByEvent) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n    const outgoing = node.outgoing || [];\n\n    if (!incoming.length && !outgoing.length) {\n      reporter.report(node.id, 'Element is not connected');\n    }\n  }\n\n  return {\n    check\n  };\n\n};\n","/**\n * Checks if a `cache` value for `key` exists.\n *\n * @private\n * @param {Object} cache The cache to query.\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction cacheHas(cache, key) {\n  return cache.has(key);\n}\n\nmodule.exports = cacheHas;\n","var getNative = require('./_getNative'),\n    root = require('./_root');\n\n/* Built-in method references that are verified to be native. */\nvar Set = getNative(root, 'Set');\n\nmodule.exports = Set;\n","/*! Hammer.JS - v2.0.7 - 2016-04-22\n * http://hammerjs.github.io/\n *\n * Copyright (c) 2016 Jorik Tangelder;\n * Licensed under the MIT license */\n(function(window, document, exportName, undefined) {\n  'use strict';\n\nvar VENDOR_PREFIXES = ['', 'webkit', 'Moz', 'MS', 'ms', 'o'];\nvar TEST_ELEMENT = document.createElement('div');\n\nvar TYPE_FUNCTION = 'function';\n\nvar round = Math.round;\nvar abs = Math.abs;\nvar now = Date.now;\n\n/**\n * set a timeout with a given scope\n * @param {Function} fn\n * @param {Number} timeout\n * @param {Object} context\n * @returns {number}\n */\nfunction setTimeoutContext(fn, timeout, context) {\n    return setTimeout(bindFn(fn, context), timeout);\n}\n\n/**\n * if the argument is an array, we want to execute the fn on each entry\n * if it aint an array we don't want to do a thing.\n * this is used by all the methods that accept a single and array argument.\n * @param {*|Array} arg\n * @param {String} fn\n * @param {Object} [context]\n * @returns {Boolean}\n */\nfunction invokeArrayArg(arg, fn, context) {\n    if (Array.isArray(arg)) {\n        each(arg, context[fn], context);\n        return true;\n    }\n    return false;\n}\n\n/**\n * walk objects and arrays\n * @param {Object} obj\n * @param {Function} iterator\n * @param {Object} context\n */\nfunction each(obj, iterator, context) {\n    var i;\n\n    if (!obj) {\n        return;\n    }\n\n    if (obj.forEach) {\n        obj.forEach(iterator, context);\n    } else if (obj.length !== undefined) {\n        i = 0;\n        while (i < obj.length) {\n            iterator.call(context, obj[i], i, obj);\n            i++;\n        }\n    } else {\n        for (i in obj) {\n            obj.hasOwnProperty(i) && iterator.call(context, obj[i], i, obj);\n        }\n    }\n}\n\n/**\n * wrap a method with a deprecation warning and stack trace\n * @param {Function} method\n * @param {String} name\n * @param {String} message\n * @returns {Function} A new function wrapping the supplied method.\n */\nfunction deprecate(method, name, message) {\n    var deprecationMessage = 'DEPRECATED METHOD: ' + name + '\\n' + message + ' AT \\n';\n    return function() {\n        var e = new Error('get-stack-trace');\n        var stack = e && e.stack ? e.stack.replace(/^[^\\(]+?[\\n$]/gm, '')\n            .replace(/^\\s+at\\s+/gm, '')\n            .replace(/^Object.<anonymous>\\s*\\(/gm, '{anonymous}()@') : 'Unknown Stack Trace';\n\n        var log = window.console && (window.console.warn || window.console.log);\n        if (log) {\n            log.call(window.console, deprecationMessage, stack);\n        }\n        return method.apply(this, arguments);\n    };\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} target\n * @param {...Object} objects_to_assign\n * @returns {Object} target\n */\nvar assign;\nif (typeof Object.assign !== 'function') {\n    assign = function assign(target) {\n        if (target === undefined || target === null) {\n            throw new TypeError('Cannot convert undefined or null to object');\n        }\n\n        var output = Object(target);\n        for (var index = 1; index < arguments.length; index++) {\n            var source = arguments[index];\n            if (source !== undefined && source !== null) {\n                for (var nextKey in source) {\n                    if (source.hasOwnProperty(nextKey)) {\n                        output[nextKey] = source[nextKey];\n                    }\n                }\n            }\n        }\n        return output;\n    };\n} else {\n    assign = Object.assign;\n}\n\n/**\n * extend object.\n * means that properties in dest will be overwritten by the ones in src.\n * @param {Object} dest\n * @param {Object} src\n * @param {Boolean} [merge=false]\n * @returns {Object} dest\n */\nvar extend = deprecate(function extend(dest, src, merge) {\n    var keys = Object.keys(src);\n    var i = 0;\n    while (i < keys.length) {\n        if (!merge || (merge && dest[keys[i]] === undefined)) {\n            dest[keys[i]] = src[keys[i]];\n        }\n        i++;\n    }\n    return dest;\n}, 'extend', 'Use `assign`.');\n\n/**\n * merge the values from src in the dest.\n * means that properties that exist in dest will not be overwritten by src\n * @param {Object} dest\n * @param {Object} src\n * @returns {Object} dest\n */\nvar merge = deprecate(function merge(dest, src) {\n    return extend(dest, src, true);\n}, 'merge', 'Use `assign`.');\n\n/**\n * simple class inheritance\n * @param {Function} child\n * @param {Function} base\n * @param {Object} [properties]\n */\nfunction inherit(child, base, properties) {\n    var baseP = base.prototype,\n        childP;\n\n    childP = child.prototype = Object.create(baseP);\n    childP.constructor = child;\n    childP._super = baseP;\n\n    if (properties) {\n        assign(childP, properties);\n    }\n}\n\n/**\n * simple function bind\n * @param {Function} fn\n * @param {Object} context\n * @returns {Function}\n */\nfunction bindFn(fn, context) {\n    return function boundFn() {\n        return fn.apply(context, arguments);\n    };\n}\n\n/**\n * let a boolean value also be a function that must return a boolean\n * this first item in args will be used as the context\n * @param {Boolean|Function} val\n * @param {Array} [args]\n * @returns {Boolean}\n */\nfunction boolOrFn(val, args) {\n    if (typeof val == TYPE_FUNCTION) {\n        return val.apply(args ? args[0] || undefined : undefined, args);\n    }\n    return val;\n}\n\n/**\n * use the val2 when val1 is undefined\n * @param {*} val1\n * @param {*} val2\n * @returns {*}\n */\nfunction ifUndefined(val1, val2) {\n    return (val1 === undefined) ? val2 : val1;\n}\n\n/**\n * addEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction addEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.addEventListener(type, handler, false);\n    });\n}\n\n/**\n * removeEventListener with multiple events at once\n * @param {EventTarget} target\n * @param {String} types\n * @param {Function} handler\n */\nfunction removeEventListeners(target, types, handler) {\n    each(splitStr(types), function(type) {\n        target.removeEventListener(type, handler, false);\n    });\n}\n\n/**\n * find if a node is in the given parent\n * @method hasParent\n * @param {HTMLElement} node\n * @param {HTMLElement} parent\n * @return {Boolean} found\n */\nfunction hasParent(node, parent) {\n    while (node) {\n        if (node == parent) {\n            return true;\n        }\n        node = node.parentNode;\n    }\n    return false;\n}\n\n/**\n * small indexOf wrapper\n * @param {String} str\n * @param {String} find\n * @returns {Boolean} found\n */\nfunction inStr(str, find) {\n    return str.indexOf(find) > -1;\n}\n\n/**\n * split string on whitespace\n * @param {String} str\n * @returns {Array} words\n */\nfunction splitStr(str) {\n    return str.trim().split(/\\s+/g);\n}\n\n/**\n * find if a array contains the object using indexOf or a simple polyFill\n * @param {Array} src\n * @param {String} find\n * @param {String} [findByKey]\n * @return {Boolean|Number} false when not found, or the index\n */\nfunction inArray(src, find, findByKey) {\n    if (src.indexOf && !findByKey) {\n        return src.indexOf(find);\n    } else {\n        var i = 0;\n        while (i < src.length) {\n            if ((findByKey && src[i][findByKey] == find) || (!findByKey && src[i] === find)) {\n                return i;\n            }\n            i++;\n        }\n        return -1;\n    }\n}\n\n/**\n * convert array-like objects to real arrays\n * @param {Object} obj\n * @returns {Array}\n */\nfunction toArray(obj) {\n    return Array.prototype.slice.call(obj, 0);\n}\n\n/**\n * unique array with objects based on a key (like 'id') or just by the array's value\n * @param {Array} src [{id:1},{id:2},{id:1}]\n * @param {String} [key]\n * @param {Boolean} [sort=False]\n * @returns {Array} [{id:1},{id:2}]\n */\nfunction uniqueArray(src, key, sort) {\n    var results = [];\n    var values = [];\n    var i = 0;\n\n    while (i < src.length) {\n        var val = key ? src[i][key] : src[i];\n        if (inArray(values, val) < 0) {\n            results.push(src[i]);\n        }\n        values[i] = val;\n        i++;\n    }\n\n    if (sort) {\n        if (!key) {\n            results = results.sort();\n        } else {\n            results = results.sort(function sortUniqueArray(a, b) {\n                return a[key] > b[key];\n            });\n        }\n    }\n\n    return results;\n}\n\n/**\n * get the prefixed property\n * @param {Object} obj\n * @param {String} property\n * @returns {String|Undefined} prefixed\n */\nfunction prefixed(obj, property) {\n    var prefix, prop;\n    var camelProp = property[0].toUpperCase() + property.slice(1);\n\n    var i = 0;\n    while (i < VENDOR_PREFIXES.length) {\n        prefix = VENDOR_PREFIXES[i];\n        prop = (prefix) ? prefix + camelProp : property;\n\n        if (prop in obj) {\n            return prop;\n        }\n        i++;\n    }\n    return undefined;\n}\n\n/**\n * get a unique id\n * @returns {number} uniqueId\n */\nvar _uniqueId = 1;\nfunction uniqueId() {\n    return _uniqueId++;\n}\n\n/**\n * get the window object of an element\n * @param {HTMLElement} element\n * @returns {DocumentView|Window}\n */\nfunction getWindowForElement(element) {\n    var doc = element.ownerDocument || element;\n    return (doc.defaultView || doc.parentWindow || window);\n}\n\nvar MOBILE_REGEX = /mobile|tablet|ip(ad|hone|od)|android/i;\n\nvar SUPPORT_TOUCH = ('ontouchstart' in window);\nvar SUPPORT_POINTER_EVENTS = prefixed(window, 'PointerEvent') !== undefined;\nvar SUPPORT_ONLY_TOUCH = SUPPORT_TOUCH && MOBILE_REGEX.test(navigator.userAgent);\n\nvar INPUT_TYPE_TOUCH = 'touch';\nvar INPUT_TYPE_PEN = 'pen';\nvar INPUT_TYPE_MOUSE = 'mouse';\nvar INPUT_TYPE_KINECT = 'kinect';\n\nvar COMPUTE_INTERVAL = 25;\n\nvar INPUT_START = 1;\nvar INPUT_MOVE = 2;\nvar INPUT_END = 4;\nvar INPUT_CANCEL = 8;\n\nvar DIRECTION_NONE = 1;\nvar DIRECTION_LEFT = 2;\nvar DIRECTION_RIGHT = 4;\nvar DIRECTION_UP = 8;\nvar DIRECTION_DOWN = 16;\n\nvar DIRECTION_HORIZONTAL = DIRECTION_LEFT | DIRECTION_RIGHT;\nvar DIRECTION_VERTICAL = DIRECTION_UP | DIRECTION_DOWN;\nvar DIRECTION_ALL = DIRECTION_HORIZONTAL | DIRECTION_VERTICAL;\n\nvar PROPS_XY = ['x', 'y'];\nvar PROPS_CLIENT_XY = ['clientX', 'clientY'];\n\n/**\n * create new input type manager\n * @param {Manager} manager\n * @param {Function} callback\n * @returns {Input}\n * @constructor\n */\nfunction Input(manager, callback) {\n    var self = this;\n    this.manager = manager;\n    this.callback = callback;\n    this.element = manager.element;\n    this.target = manager.options.inputTarget;\n\n    // smaller wrapper around the handler, for the scope and the enabled state of the manager,\n    // so when disabled the input events are completely bypassed.\n    this.domHandler = function(ev) {\n        if (boolOrFn(manager.options.enable, [manager])) {\n            self.handler(ev);\n        }\n    };\n\n    this.init();\n\n}\n\nInput.prototype = {\n    /**\n     * should handle the inputEvent data and trigger the callback\n     * @virtual\n     */\n    handler: function() { },\n\n    /**\n     * bind the events\n     */\n    init: function() {\n        this.evEl && addEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && addEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && addEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    },\n\n    /**\n     * unbind the events\n     */\n    destroy: function() {\n        this.evEl && removeEventListeners(this.element, this.evEl, this.domHandler);\n        this.evTarget && removeEventListeners(this.target, this.evTarget, this.domHandler);\n        this.evWin && removeEventListeners(getWindowForElement(this.element), this.evWin, this.domHandler);\n    }\n};\n\n/**\n * create new input type manager\n * called by the Manager constructor\n * @param {Hammer} manager\n * @returns {Input}\n */\nfunction createInputInstance(manager) {\n    var Type;\n    var inputClass = manager.options.inputClass;\n\n    if (inputClass) {\n        Type = inputClass;\n    } else if (SUPPORT_POINTER_EVENTS) {\n        Type = PointerEventInput;\n    } else if (SUPPORT_ONLY_TOUCH) {\n        Type = TouchInput;\n    } else if (!SUPPORT_TOUCH) {\n        Type = MouseInput;\n    } else {\n        Type = TouchMouseInput;\n    }\n    return new (Type)(manager, inputHandler);\n}\n\n/**\n * handle input events\n * @param {Manager} manager\n * @param {String} eventType\n * @param {Object} input\n */\nfunction inputHandler(manager, eventType, input) {\n    var pointersLen = input.pointers.length;\n    var changedPointersLen = input.changedPointers.length;\n    var isFirst = (eventType & INPUT_START && (pointersLen - changedPointersLen === 0));\n    var isFinal = (eventType & (INPUT_END | INPUT_CANCEL) && (pointersLen - changedPointersLen === 0));\n\n    input.isFirst = !!isFirst;\n    input.isFinal = !!isFinal;\n\n    if (isFirst) {\n        manager.session = {};\n    }\n\n    // source event is the normalized value of the domEvents\n    // like 'touchstart, mouseup, pointerdown'\n    input.eventType = eventType;\n\n    // compute scale, rotation etc\n    computeInputData(manager, input);\n\n    // emit secret event\n    manager.emit('hammer.input', input);\n\n    manager.recognize(input);\n    manager.session.prevInput = input;\n}\n\n/**\n * extend the data with some usable properties like scale, rotate, velocity etc\n * @param {Object} manager\n * @param {Object} input\n */\nfunction computeInputData(manager, input) {\n    var session = manager.session;\n    var pointers = input.pointers;\n    var pointersLength = pointers.length;\n\n    // store the first input to calculate the distance and direction\n    if (!session.firstInput) {\n        session.firstInput = simpleCloneInputData(input);\n    }\n\n    // to compute scale and rotation we need to store the multiple touches\n    if (pointersLength > 1 && !session.firstMultiple) {\n        session.firstMultiple = simpleCloneInputData(input);\n    } else if (pointersLength === 1) {\n        session.firstMultiple = false;\n    }\n\n    var firstInput = session.firstInput;\n    var firstMultiple = session.firstMultiple;\n    var offsetCenter = firstMultiple ? firstMultiple.center : firstInput.center;\n\n    var center = input.center = getCenter(pointers);\n    input.timeStamp = now();\n    input.deltaTime = input.timeStamp - firstInput.timeStamp;\n\n    input.angle = getAngle(offsetCenter, center);\n    input.distance = getDistance(offsetCenter, center);\n\n    computeDeltaXY(session, input);\n    input.offsetDirection = getDirection(input.deltaX, input.deltaY);\n\n    var overallVelocity = getVelocity(input.deltaTime, input.deltaX, input.deltaY);\n    input.overallVelocityX = overallVelocity.x;\n    input.overallVelocityY = overallVelocity.y;\n    input.overallVelocity = (abs(overallVelocity.x) > abs(overallVelocity.y)) ? overallVelocity.x : overallVelocity.y;\n\n    input.scale = firstMultiple ? getScale(firstMultiple.pointers, pointers) : 1;\n    input.rotation = firstMultiple ? getRotation(firstMultiple.pointers, pointers) : 0;\n\n    input.maxPointers = !session.prevInput ? input.pointers.length : ((input.pointers.length >\n        session.prevInput.maxPointers) ? input.pointers.length : session.prevInput.maxPointers);\n\n    computeIntervalInputData(session, input);\n\n    // find the correct target\n    var target = manager.element;\n    if (hasParent(input.srcEvent.target, target)) {\n        target = input.srcEvent.target;\n    }\n    input.target = target;\n}\n\nfunction computeDeltaXY(session, input) {\n    var center = input.center;\n    var offset = session.offsetDelta || {};\n    var prevDelta = session.prevDelta || {};\n    var prevInput = session.prevInput || {};\n\n    if (input.eventType === INPUT_START || prevInput.eventType === INPUT_END) {\n        prevDelta = session.prevDelta = {\n            x: prevInput.deltaX || 0,\n            y: prevInput.deltaY || 0\n        };\n\n        offset = session.offsetDelta = {\n            x: center.x,\n            y: center.y\n        };\n    }\n\n    input.deltaX = prevDelta.x + (center.x - offset.x);\n    input.deltaY = prevDelta.y + (center.y - offset.y);\n}\n\n/**\n * velocity is calculated every x ms\n * @param {Object} session\n * @param {Object} input\n */\nfunction computeIntervalInputData(session, input) {\n    var last = session.lastInterval || input,\n        deltaTime = input.timeStamp - last.timeStamp,\n        velocity, velocityX, velocityY, direction;\n\n    if (input.eventType != INPUT_CANCEL && (deltaTime > COMPUTE_INTERVAL || last.velocity === undefined)) {\n        var deltaX = input.deltaX - last.deltaX;\n        var deltaY = input.deltaY - last.deltaY;\n\n        var v = getVelocity(deltaTime, deltaX, deltaY);\n        velocityX = v.x;\n        velocityY = v.y;\n        velocity = (abs(v.x) > abs(v.y)) ? v.x : v.y;\n        direction = getDirection(deltaX, deltaY);\n\n        session.lastInterval = input;\n    } else {\n        // use latest velocity info if it doesn't overtake a minimum period\n        velocity = last.velocity;\n        velocityX = last.velocityX;\n        velocityY = last.velocityY;\n        direction = last.direction;\n    }\n\n    input.velocity = velocity;\n    input.velocityX = velocityX;\n    input.velocityY = velocityY;\n    input.direction = direction;\n}\n\n/**\n * create a simple clone from the input used for storage of firstInput and firstMultiple\n * @param {Object} input\n * @returns {Object} clonedInputData\n */\nfunction simpleCloneInputData(input) {\n    // make a simple copy of the pointers because we will get a reference if we don't\n    // we only need clientXY for the calculations\n    var pointers = [];\n    var i = 0;\n    while (i < input.pointers.length) {\n        pointers[i] = {\n            clientX: round(input.pointers[i].clientX),\n            clientY: round(input.pointers[i].clientY)\n        };\n        i++;\n    }\n\n    return {\n        timeStamp: now(),\n        pointers: pointers,\n        center: getCenter(pointers),\n        deltaX: input.deltaX,\n        deltaY: input.deltaY\n    };\n}\n\n/**\n * get the center of all the pointers\n * @param {Array} pointers\n * @return {Object} center contains `x` and `y` properties\n */\nfunction getCenter(pointers) {\n    var pointersLength = pointers.length;\n\n    // no need to loop when only one touch\n    if (pointersLength === 1) {\n        return {\n            x: round(pointers[0].clientX),\n            y: round(pointers[0].clientY)\n        };\n    }\n\n    var x = 0, y = 0, i = 0;\n    while (i < pointersLength) {\n        x += pointers[i].clientX;\n        y += pointers[i].clientY;\n        i++;\n    }\n\n    return {\n        x: round(x / pointersLength),\n        y: round(y / pointersLength)\n    };\n}\n\n/**\n * calculate the velocity between two points. unit is in px per ms.\n * @param {Number} deltaTime\n * @param {Number} x\n * @param {Number} y\n * @return {Object} velocity `x` and `y`\n */\nfunction getVelocity(deltaTime, x, y) {\n    return {\n        x: x / deltaTime || 0,\n        y: y / deltaTime || 0\n    };\n}\n\n/**\n * get the direction between two points\n * @param {Number} x\n * @param {Number} y\n * @return {Number} direction\n */\nfunction getDirection(x, y) {\n    if (x === y) {\n        return DIRECTION_NONE;\n    }\n\n    if (abs(x) >= abs(y)) {\n        return x < 0 ? DIRECTION_LEFT : DIRECTION_RIGHT;\n    }\n    return y < 0 ? DIRECTION_UP : DIRECTION_DOWN;\n}\n\n/**\n * calculate the absolute distance between two points\n * @param {Object} p1 {x, y}\n * @param {Object} p2 {x, y}\n * @param {Array} [props] containing x and y keys\n * @return {Number} distance\n */\nfunction getDistance(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n\n    return Math.sqrt((x * x) + (y * y));\n}\n\n/**\n * calculate the angle between two coordinates\n * @param {Object} p1\n * @param {Object} p2\n * @param {Array} [props] containing x and y keys\n * @return {Number} angle\n */\nfunction getAngle(p1, p2, props) {\n    if (!props) {\n        props = PROPS_XY;\n    }\n    var x = p2[props[0]] - p1[props[0]],\n        y = p2[props[1]] - p1[props[1]];\n    return Math.atan2(y, x) * 180 / Math.PI;\n}\n\n/**\n * calculate the rotation degrees between two pointersets\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} rotation\n */\nfunction getRotation(start, end) {\n    return getAngle(end[1], end[0], PROPS_CLIENT_XY) + getAngle(start[1], start[0], PROPS_CLIENT_XY);\n}\n\n/**\n * calculate the scale factor between two pointersets\n * no scale is 1, and goes down to 0 when pinched together, and bigger when pinched out\n * @param {Array} start array of pointers\n * @param {Array} end array of pointers\n * @return {Number} scale\n */\nfunction getScale(start, end) {\n    return getDistance(end[0], end[1], PROPS_CLIENT_XY) / getDistance(start[0], start[1], PROPS_CLIENT_XY);\n}\n\nvar MOUSE_INPUT_MAP = {\n    mousedown: INPUT_START,\n    mousemove: INPUT_MOVE,\n    mouseup: INPUT_END\n};\n\nvar MOUSE_ELEMENT_EVENTS = 'mousedown';\nvar MOUSE_WINDOW_EVENTS = 'mousemove mouseup';\n\n/**\n * Mouse events input\n * @constructor\n * @extends Input\n */\nfunction MouseInput() {\n    this.evEl = MOUSE_ELEMENT_EVENTS;\n    this.evWin = MOUSE_WINDOW_EVENTS;\n\n    this.pressed = false; // mousedown state\n\n    Input.apply(this, arguments);\n}\n\ninherit(MouseInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function MEhandler(ev) {\n        var eventType = MOUSE_INPUT_MAP[ev.type];\n\n        // on start we want to have the left mouse button down\n        if (eventType & INPUT_START && ev.button === 0) {\n            this.pressed = true;\n        }\n\n        if (eventType & INPUT_MOVE && ev.which !== 1) {\n            eventType = INPUT_END;\n        }\n\n        // mouse must be down\n        if (!this.pressed) {\n            return;\n        }\n\n        if (eventType & INPUT_END) {\n            this.pressed = false;\n        }\n\n        this.callback(this.manager, eventType, {\n            pointers: [ev],\n            changedPointers: [ev],\n            pointerType: INPUT_TYPE_MOUSE,\n            srcEvent: ev\n        });\n    }\n});\n\nvar POINTER_INPUT_MAP = {\n    pointerdown: INPUT_START,\n    pointermove: INPUT_MOVE,\n    pointerup: INPUT_END,\n    pointercancel: INPUT_CANCEL,\n    pointerout: INPUT_CANCEL\n};\n\n// in IE10 the pointer types is defined as an enum\nvar IE10_POINTER_TYPE_ENUM = {\n    2: INPUT_TYPE_TOUCH,\n    3: INPUT_TYPE_PEN,\n    4: INPUT_TYPE_MOUSE,\n    5: INPUT_TYPE_KINECT // see https://twitter.com/jacobrossi/status/480596438489890816\n};\n\nvar POINTER_ELEMENT_EVENTS = 'pointerdown';\nvar POINTER_WINDOW_EVENTS = 'pointermove pointerup pointercancel';\n\n// IE10 has prefixed support, and case-sensitive\nif (window.MSPointerEvent && !window.PointerEvent) {\n    POINTER_ELEMENT_EVENTS = 'MSPointerDown';\n    POINTER_WINDOW_EVENTS = 'MSPointerMove MSPointerUp MSPointerCancel';\n}\n\n/**\n * Pointer events input\n * @constructor\n * @extends Input\n */\nfunction PointerEventInput() {\n    this.evEl = POINTER_ELEMENT_EVENTS;\n    this.evWin = POINTER_WINDOW_EVENTS;\n\n    Input.apply(this, arguments);\n\n    this.store = (this.manager.session.pointerEvents = []);\n}\n\ninherit(PointerEventInput, Input, {\n    /**\n     * handle mouse events\n     * @param {Object} ev\n     */\n    handler: function PEhandler(ev) {\n        var store = this.store;\n        var removePointer = false;\n\n        var eventTypeNormalized = ev.type.toLowerCase().replace('ms', '');\n        var eventType = POINTER_INPUT_MAP[eventTypeNormalized];\n        var pointerType = IE10_POINTER_TYPE_ENUM[ev.pointerType] || ev.pointerType;\n\n        var isTouch = (pointerType == INPUT_TYPE_TOUCH);\n\n        // get index of the event in the store\n        var storeIndex = inArray(store, ev.pointerId, 'pointerId');\n\n        // start and mouse must be down\n        if (eventType & INPUT_START && (ev.button === 0 || isTouch)) {\n            if (storeIndex < 0) {\n                store.push(ev);\n                storeIndex = store.length - 1;\n            }\n        } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n            removePointer = true;\n        }\n\n        // it not found, so the pointer hasn't been down (so it's probably a hover)\n        if (storeIndex < 0) {\n            return;\n        }\n\n        // update the event in the store\n        store[storeIndex] = ev;\n\n        this.callback(this.manager, eventType, {\n            pointers: store,\n            changedPointers: [ev],\n            pointerType: pointerType,\n            srcEvent: ev\n        });\n\n        if (removePointer) {\n            // remove from the store\n            store.splice(storeIndex, 1);\n        }\n    }\n});\n\nvar SINGLE_TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar SINGLE_TOUCH_TARGET_EVENTS = 'touchstart';\nvar SINGLE_TOUCH_WINDOW_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Touch events input\n * @constructor\n * @extends Input\n */\nfunction SingleTouchInput() {\n    this.evTarget = SINGLE_TOUCH_TARGET_EVENTS;\n    this.evWin = SINGLE_TOUCH_WINDOW_EVENTS;\n    this.started = false;\n\n    Input.apply(this, arguments);\n}\n\ninherit(SingleTouchInput, Input, {\n    handler: function TEhandler(ev) {\n        var type = SINGLE_TOUCH_INPUT_MAP[ev.type];\n\n        // should we handle the touch events?\n        if (type === INPUT_START) {\n            this.started = true;\n        }\n\n        if (!this.started) {\n            return;\n        }\n\n        var touches = normalizeSingleTouches.call(this, ev, type);\n\n        // when done, reset the started state\n        if (type & (INPUT_END | INPUT_CANCEL) && touches[0].length - touches[1].length === 0) {\n            this.started = false;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction normalizeSingleTouches(ev, type) {\n    var all = toArray(ev.touches);\n    var changed = toArray(ev.changedTouches);\n\n    if (type & (INPUT_END | INPUT_CANCEL)) {\n        all = uniqueArray(all.concat(changed), 'identifier', true);\n    }\n\n    return [all, changed];\n}\n\nvar TOUCH_INPUT_MAP = {\n    touchstart: INPUT_START,\n    touchmove: INPUT_MOVE,\n    touchend: INPUT_END,\n    touchcancel: INPUT_CANCEL\n};\n\nvar TOUCH_TARGET_EVENTS = 'touchstart touchmove touchend touchcancel';\n\n/**\n * Multi-user touch events input\n * @constructor\n * @extends Input\n */\nfunction TouchInput() {\n    this.evTarget = TOUCH_TARGET_EVENTS;\n    this.targetIds = {};\n\n    Input.apply(this, arguments);\n}\n\ninherit(TouchInput, Input, {\n    handler: function MTEhandler(ev) {\n        var type = TOUCH_INPUT_MAP[ev.type];\n        var touches = getTouches.call(this, ev, type);\n        if (!touches) {\n            return;\n        }\n\n        this.callback(this.manager, type, {\n            pointers: touches[0],\n            changedPointers: touches[1],\n            pointerType: INPUT_TYPE_TOUCH,\n            srcEvent: ev\n        });\n    }\n});\n\n/**\n * @this {TouchInput}\n * @param {Object} ev\n * @param {Number} type flag\n * @returns {undefined|Array} [all, changed]\n */\nfunction getTouches(ev, type) {\n    var allTouches = toArray(ev.touches);\n    var targetIds = this.targetIds;\n\n    // when there is only one touch, the process can be simplified\n    if (type & (INPUT_START | INPUT_MOVE) && allTouches.length === 1) {\n        targetIds[allTouches[0].identifier] = true;\n        return [allTouches, allTouches];\n    }\n\n    var i,\n        targetTouches,\n        changedTouches = toArray(ev.changedTouches),\n        changedTargetTouches = [],\n        target = this.target;\n\n    // get target touches from touches\n    targetTouches = allTouches.filter(function(touch) {\n        return hasParent(touch.target, target);\n    });\n\n    // collect touches\n    if (type === INPUT_START) {\n        i = 0;\n        while (i < targetTouches.length) {\n            targetIds[targetTouches[i].identifier] = true;\n            i++;\n        }\n    }\n\n    // filter changed touches to only contain touches that exist in the collected target ids\n    i = 0;\n    while (i < changedTouches.length) {\n        if (targetIds[changedTouches[i].identifier]) {\n            changedTargetTouches.push(changedTouches[i]);\n        }\n\n        // cleanup removed touches\n        if (type & (INPUT_END | INPUT_CANCEL)) {\n            delete targetIds[changedTouches[i].identifier];\n        }\n        i++;\n    }\n\n    if (!changedTargetTouches.length) {\n        return;\n    }\n\n    return [\n        // merge targetTouches with changedTargetTouches so it contains ALL touches, including 'end' and 'cancel'\n        uniqueArray(targetTouches.concat(changedTargetTouches), 'identifier', true),\n        changedTargetTouches\n    ];\n}\n\n/**\n * Combined touch and mouse input\n *\n * Touch has a higher priority then mouse, and while touching no mouse events are allowed.\n * This because touch devices also emit mouse events while doing a touch.\n *\n * @constructor\n * @extends Input\n */\n\nvar DEDUP_TIMEOUT = 2500;\nvar DEDUP_DISTANCE = 25;\n\nfunction TouchMouseInput() {\n    Input.apply(this, arguments);\n\n    var handler = bindFn(this.handler, this);\n    this.touch = new TouchInput(this.manager, handler);\n    this.mouse = new MouseInput(this.manager, handler);\n\n    this.primaryTouch = null;\n    this.lastTouches = [];\n}\n\ninherit(TouchMouseInput, Input, {\n    /**\n     * handle mouse and touch events\n     * @param {Hammer} manager\n     * @param {String} inputEvent\n     * @param {Object} inputData\n     */\n    handler: function TMEhandler(manager, inputEvent, inputData) {\n        var isTouch = (inputData.pointerType == INPUT_TYPE_TOUCH),\n            isMouse = (inputData.pointerType == INPUT_TYPE_MOUSE);\n\n        if (isMouse && inputData.sourceCapabilities && inputData.sourceCapabilities.firesTouchEvents) {\n            return;\n        }\n\n        // when we're in a touch event, record touches to  de-dupe synthetic mouse event\n        if (isTouch) {\n            recordTouches.call(this, inputEvent, inputData);\n        } else if (isMouse && isSyntheticEvent.call(this, inputData)) {\n            return;\n        }\n\n        this.callback(manager, inputEvent, inputData);\n    },\n\n    /**\n     * remove the event listeners\n     */\n    destroy: function destroy() {\n        this.touch.destroy();\n        this.mouse.destroy();\n    }\n});\n\nfunction recordTouches(eventType, eventData) {\n    if (eventType & INPUT_START) {\n        this.primaryTouch = eventData.changedPointers[0].identifier;\n        setLastTouch.call(this, eventData);\n    } else if (eventType & (INPUT_END | INPUT_CANCEL)) {\n        setLastTouch.call(this, eventData);\n    }\n}\n\nfunction setLastTouch(eventData) {\n    var touch = eventData.changedPointers[0];\n\n    if (touch.identifier === this.primaryTouch) {\n        var lastTouch = {x: touch.clientX, y: touch.clientY};\n        this.lastTouches.push(lastTouch);\n        var lts = this.lastTouches;\n        var removeLastTouch = function() {\n            var i = lts.indexOf(lastTouch);\n            if (i > -1) {\n                lts.splice(i, 1);\n            }\n        };\n        setTimeout(removeLastTouch, DEDUP_TIMEOUT);\n    }\n}\n\nfunction isSyntheticEvent(eventData) {\n    var x = eventData.srcEvent.clientX, y = eventData.srcEvent.clientY;\n    for (var i = 0; i < this.lastTouches.length; i++) {\n        var t = this.lastTouches[i];\n        var dx = Math.abs(x - t.x), dy = Math.abs(y - t.y);\n        if (dx <= DEDUP_DISTANCE && dy <= DEDUP_DISTANCE) {\n            return true;\n        }\n    }\n    return false;\n}\n\nvar PREFIXED_TOUCH_ACTION = prefixed(TEST_ELEMENT.style, 'touchAction');\nvar NATIVE_TOUCH_ACTION = PREFIXED_TOUCH_ACTION !== undefined;\n\n// magical touchAction value\nvar TOUCH_ACTION_COMPUTE = 'compute';\nvar TOUCH_ACTION_AUTO = 'auto';\nvar TOUCH_ACTION_MANIPULATION = 'manipulation'; // not implemented\nvar TOUCH_ACTION_NONE = 'none';\nvar TOUCH_ACTION_PAN_X = 'pan-x';\nvar TOUCH_ACTION_PAN_Y = 'pan-y';\nvar TOUCH_ACTION_MAP = getTouchActionProps();\n\n/**\n * Touch Action\n * sets the touchAction property or uses the js alternative\n * @param {Manager} manager\n * @param {String} value\n * @constructor\n */\nfunction TouchAction(manager, value) {\n    this.manager = manager;\n    this.set(value);\n}\n\nTouchAction.prototype = {\n    /**\n     * set the touchAction value on the element or enable the polyfill\n     * @param {String} value\n     */\n    set: function(value) {\n        // find out the touch-action by the event handlers\n        if (value == TOUCH_ACTION_COMPUTE) {\n            value = this.compute();\n        }\n\n        if (NATIVE_TOUCH_ACTION && this.manager.element.style && TOUCH_ACTION_MAP[value]) {\n            this.manager.element.style[PREFIXED_TOUCH_ACTION] = value;\n        }\n        this.actions = value.toLowerCase().trim();\n    },\n\n    /**\n     * just re-set the touchAction value\n     */\n    update: function() {\n        this.set(this.manager.options.touchAction);\n    },\n\n    /**\n     * compute the value for the touchAction property based on the recognizer's settings\n     * @returns {String} value\n     */\n    compute: function() {\n        var actions = [];\n        each(this.manager.recognizers, function(recognizer) {\n            if (boolOrFn(recognizer.options.enable, [recognizer])) {\n                actions = actions.concat(recognizer.getTouchAction());\n            }\n        });\n        return cleanTouchActions(actions.join(' '));\n    },\n\n    /**\n     * this method is called on each input cycle and provides the preventing of the browser behavior\n     * @param {Object} input\n     */\n    preventDefaults: function(input) {\n        var srcEvent = input.srcEvent;\n        var direction = input.offsetDirection;\n\n        // if the touch action did prevented once this session\n        if (this.manager.session.prevented) {\n            srcEvent.preventDefault();\n            return;\n        }\n\n        var actions = this.actions;\n        var hasNone = inStr(actions, TOUCH_ACTION_NONE) && !TOUCH_ACTION_MAP[TOUCH_ACTION_NONE];\n        var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_Y];\n        var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X) && !TOUCH_ACTION_MAP[TOUCH_ACTION_PAN_X];\n\n        if (hasNone) {\n            //do not prevent defaults if this is a tap gesture\n\n            var isTapPointer = input.pointers.length === 1;\n            var isTapMovement = input.distance < 2;\n            var isTapTouchTime = input.deltaTime < 250;\n\n            if (isTapPointer && isTapMovement && isTapTouchTime) {\n                return;\n            }\n        }\n\n        if (hasPanX && hasPanY) {\n            // `pan-x pan-y` means browser handles all scrolling/panning, do not prevent\n            return;\n        }\n\n        if (hasNone ||\n            (hasPanY && direction & DIRECTION_HORIZONTAL) ||\n            (hasPanX && direction & DIRECTION_VERTICAL)) {\n            return this.preventSrc(srcEvent);\n        }\n    },\n\n    /**\n     * call preventDefault to prevent the browser's default behavior (scrolling in most cases)\n     * @param {Object} srcEvent\n     */\n    preventSrc: function(srcEvent) {\n        this.manager.session.prevented = true;\n        srcEvent.preventDefault();\n    }\n};\n\n/**\n * when the touchActions are collected they are not a valid value, so we need to clean things up. *\n * @param {String} actions\n * @returns {*}\n */\nfunction cleanTouchActions(actions) {\n    // none\n    if (inStr(actions, TOUCH_ACTION_NONE)) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    var hasPanX = inStr(actions, TOUCH_ACTION_PAN_X);\n    var hasPanY = inStr(actions, TOUCH_ACTION_PAN_Y);\n\n    // if both pan-x and pan-y are set (different recognizers\n    // for different directions, e.g. horizontal pan but vertical swipe?)\n    // we need none (as otherwise with pan-x pan-y combined none of these\n    // recognizers will work, since the browser would handle all panning\n    if (hasPanX && hasPanY) {\n        return TOUCH_ACTION_NONE;\n    }\n\n    // pan-x OR pan-y\n    if (hasPanX || hasPanY) {\n        return hasPanX ? TOUCH_ACTION_PAN_X : TOUCH_ACTION_PAN_Y;\n    }\n\n    // manipulation\n    if (inStr(actions, TOUCH_ACTION_MANIPULATION)) {\n        return TOUCH_ACTION_MANIPULATION;\n    }\n\n    return TOUCH_ACTION_AUTO;\n}\n\nfunction getTouchActionProps() {\n    if (!NATIVE_TOUCH_ACTION) {\n        return false;\n    }\n    var touchMap = {};\n    var cssSupports = window.CSS && window.CSS.supports;\n    ['auto', 'manipulation', 'pan-y', 'pan-x', 'pan-x pan-y', 'none'].forEach(function(val) {\n\n        // If css.supports is not supported but there is native touch-action assume it supports\n        // all values. This is the case for IE 10 and 11.\n        touchMap[val] = cssSupports ? window.CSS.supports('touch-action', val) : true;\n    });\n    return touchMap;\n}\n\n/**\n * Recognizer flow explained; *\n * All recognizers have the initial state of POSSIBLE when a input session starts.\n * The definition of a input session is from the first input until the last input, with all it's movement in it. *\n * Example session for mouse-input: mousedown -> mousemove -> mouseup\n *\n * On each recognizing cycle (see Manager.recognize) the .recognize() method is executed\n * which determines with state it should be.\n *\n * If the recognizer has the state FAILED, CANCELLED or RECOGNIZED (equals ENDED), it is reset to\n * POSSIBLE to give it another change on the next cycle.\n *\n *               Possible\n *                  |\n *            +-----+---------------+\n *            |                     |\n *      +-----+-----+               |\n *      |           |               |\n *   Failed      Cancelled          |\n *                          +-------+------+\n *                          |              |\n *                      Recognized       Began\n *                                         |\n *                                      Changed\n *                                         |\n *                                  Ended/Recognized\n */\nvar STATE_POSSIBLE = 1;\nvar STATE_BEGAN = 2;\nvar STATE_CHANGED = 4;\nvar STATE_ENDED = 8;\nvar STATE_RECOGNIZED = STATE_ENDED;\nvar STATE_CANCELLED = 16;\nvar STATE_FAILED = 32;\n\n/**\n * Recognizer\n * Every recognizer needs to extend from this class.\n * @constructor\n * @param {Object} options\n */\nfunction Recognizer(options) {\n    this.options = assign({}, this.defaults, options || {});\n\n    this.id = uniqueId();\n\n    this.manager = null;\n\n    // default is enable true\n    this.options.enable = ifUndefined(this.options.enable, true);\n\n    this.state = STATE_POSSIBLE;\n\n    this.simultaneous = {};\n    this.requireFail = [];\n}\n\nRecognizer.prototype = {\n    /**\n     * @virtual\n     * @type {Object}\n     */\n    defaults: {},\n\n    /**\n     * set options\n     * @param {Object} options\n     * @return {Recognizer}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // also update the touchAction, in case something changed about the directions/enabled state\n        this.manager && this.manager.touchAction.update();\n        return this;\n    },\n\n    /**\n     * recognize simultaneous with an other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    recognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'recognizeWith', this)) {\n            return this;\n        }\n\n        var simultaneous = this.simultaneous;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (!simultaneous[otherRecognizer.id]) {\n            simultaneous[otherRecognizer.id] = otherRecognizer;\n            otherRecognizer.recognizeWith(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the simultaneous link. it doesnt remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRecognizeWith: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRecognizeWith', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        delete this.simultaneous[otherRecognizer.id];\n        return this;\n    },\n\n    /**\n     * recognizer can only run when an other is failing\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    requireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'requireFailure', this)) {\n            return this;\n        }\n\n        var requireFail = this.requireFail;\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        if (inArray(requireFail, otherRecognizer) === -1) {\n            requireFail.push(otherRecognizer);\n            otherRecognizer.requireFailure(this);\n        }\n        return this;\n    },\n\n    /**\n     * drop the requireFailure link. it does not remove the link on the other recognizer.\n     * @param {Recognizer} otherRecognizer\n     * @returns {Recognizer} this\n     */\n    dropRequireFailure: function(otherRecognizer) {\n        if (invokeArrayArg(otherRecognizer, 'dropRequireFailure', this)) {\n            return this;\n        }\n\n        otherRecognizer = getRecognizerByNameIfManager(otherRecognizer, this);\n        var index = inArray(this.requireFail, otherRecognizer);\n        if (index > -1) {\n            this.requireFail.splice(index, 1);\n        }\n        return this;\n    },\n\n    /**\n     * has require failures boolean\n     * @returns {boolean}\n     */\n    hasRequireFailures: function() {\n        return this.requireFail.length > 0;\n    },\n\n    /**\n     * if the recognizer can recognize simultaneous with an other recognizer\n     * @param {Recognizer} otherRecognizer\n     * @returns {Boolean}\n     */\n    canRecognizeWith: function(otherRecognizer) {\n        return !!this.simultaneous[otherRecognizer.id];\n    },\n\n    /**\n     * You should use `tryEmit` instead of `emit` directly to check\n     * that all the needed recognizers has failed before emitting.\n     * @param {Object} input\n     */\n    emit: function(input) {\n        var self = this;\n        var state = this.state;\n\n        function emit(event) {\n            self.manager.emit(event, input);\n        }\n\n        // 'panstart' and 'panmove'\n        if (state < STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n\n        emit(self.options.event); // simple 'eventName' events\n\n        if (input.additionalEvent) { // additional event(panleft, panright, pinchin, pinchout...)\n            emit(input.additionalEvent);\n        }\n\n        // panend and pancancel\n        if (state >= STATE_ENDED) {\n            emit(self.options.event + stateStr(state));\n        }\n    },\n\n    /**\n     * Check that all the require failure recognizers has failed,\n     * if true, it emits a gesture event,\n     * otherwise, setup the state to FAILED.\n     * @param {Object} input\n     */\n    tryEmit: function(input) {\n        if (this.canEmit()) {\n            return this.emit(input);\n        }\n        // it's failing anyway\n        this.state = STATE_FAILED;\n    },\n\n    /**\n     * can we emit?\n     * @returns {boolean}\n     */\n    canEmit: function() {\n        var i = 0;\n        while (i < this.requireFail.length) {\n            if (!(this.requireFail[i].state & (STATE_FAILED | STATE_POSSIBLE))) {\n                return false;\n            }\n            i++;\n        }\n        return true;\n    },\n\n    /**\n     * update the recognizer\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        // make a new copy of the inputData\n        // so we can change the inputData without messing up the other recognizers\n        var inputDataClone = assign({}, inputData);\n\n        // is is enabled and allow recognizing?\n        if (!boolOrFn(this.options.enable, [this, inputDataClone])) {\n            this.reset();\n            this.state = STATE_FAILED;\n            return;\n        }\n\n        // reset when we've reached the end\n        if (this.state & (STATE_RECOGNIZED | STATE_CANCELLED | STATE_FAILED)) {\n            this.state = STATE_POSSIBLE;\n        }\n\n        this.state = this.process(inputDataClone);\n\n        // the recognizer has recognized a gesture\n        // so trigger an event\n        if (this.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED | STATE_CANCELLED)) {\n            this.tryEmit(inputDataClone);\n        }\n    },\n\n    /**\n     * return the state of the recognizer\n     * the actual recognizing happens in this method\n     * @virtual\n     * @param {Object} inputData\n     * @returns {Const} STATE\n     */\n    process: function(inputData) { }, // jshint ignore:line\n\n    /**\n     * return the preferred touch-action\n     * @virtual\n     * @returns {Array}\n     */\n    getTouchAction: function() { },\n\n    /**\n     * called when the gesture isn't allowed to recognize\n     * like when another is being recognized or it is disabled\n     * @virtual\n     */\n    reset: function() { }\n};\n\n/**\n * get a usable string, used as event postfix\n * @param {Const} state\n * @returns {String} state\n */\nfunction stateStr(state) {\n    if (state & STATE_CANCELLED) {\n        return 'cancel';\n    } else if (state & STATE_ENDED) {\n        return 'end';\n    } else if (state & STATE_CHANGED) {\n        return 'move';\n    } else if (state & STATE_BEGAN) {\n        return 'start';\n    }\n    return '';\n}\n\n/**\n * direction cons to string\n * @param {Const} direction\n * @returns {String}\n */\nfunction directionStr(direction) {\n    if (direction == DIRECTION_DOWN) {\n        return 'down';\n    } else if (direction == DIRECTION_UP) {\n        return 'up';\n    } else if (direction == DIRECTION_LEFT) {\n        return 'left';\n    } else if (direction == DIRECTION_RIGHT) {\n        return 'right';\n    }\n    return '';\n}\n\n/**\n * get a recognizer by name if it is bound to a manager\n * @param {Recognizer|String} otherRecognizer\n * @param {Recognizer} recognizer\n * @returns {Recognizer}\n */\nfunction getRecognizerByNameIfManager(otherRecognizer, recognizer) {\n    var manager = recognizer.manager;\n    if (manager) {\n        return manager.get(otherRecognizer);\n    }\n    return otherRecognizer;\n}\n\n/**\n * This recognizer is just used as a base for the simple attribute recognizers.\n * @constructor\n * @extends Recognizer\n */\nfunction AttrRecognizer() {\n    Recognizer.apply(this, arguments);\n}\n\ninherit(AttrRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof AttrRecognizer\n     */\n    defaults: {\n        /**\n         * @type {Number}\n         * @default 1\n         */\n        pointers: 1\n    },\n\n    /**\n     * Used to check if it the recognizer receives valid input, like input.distance > 10.\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {Boolean} recognized\n     */\n    attrTest: function(input) {\n        var optionPointers = this.options.pointers;\n        return optionPointers === 0 || input.pointers.length === optionPointers;\n    },\n\n    /**\n     * Process the input and return the state for the recognizer\n     * @memberof AttrRecognizer\n     * @param {Object} input\n     * @returns {*} State\n     */\n    process: function(input) {\n        var state = this.state;\n        var eventType = input.eventType;\n\n        var isRecognized = state & (STATE_BEGAN | STATE_CHANGED);\n        var isValid = this.attrTest(input);\n\n        // on cancel input and we've recognized before, return STATE_CANCELLED\n        if (isRecognized && (eventType & INPUT_CANCEL || !isValid)) {\n            return state | STATE_CANCELLED;\n        } else if (isRecognized || isValid) {\n            if (eventType & INPUT_END) {\n                return state | STATE_ENDED;\n            } else if (!(state & STATE_BEGAN)) {\n                return STATE_BEGAN;\n            }\n            return state | STATE_CHANGED;\n        }\n        return STATE_FAILED;\n    }\n});\n\n/**\n * Pan\n * Recognized when the pointer is down and moved in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PanRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n\n    this.pX = null;\n    this.pY = null;\n}\n\ninherit(PanRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PanRecognizer\n     */\n    defaults: {\n        event: 'pan',\n        threshold: 10,\n        pointers: 1,\n        direction: DIRECTION_ALL\n    },\n\n    getTouchAction: function() {\n        var direction = this.options.direction;\n        var actions = [];\n        if (direction & DIRECTION_HORIZONTAL) {\n            actions.push(TOUCH_ACTION_PAN_Y);\n        }\n        if (direction & DIRECTION_VERTICAL) {\n            actions.push(TOUCH_ACTION_PAN_X);\n        }\n        return actions;\n    },\n\n    directionTest: function(input) {\n        var options = this.options;\n        var hasMoved = true;\n        var distance = input.distance;\n        var direction = input.direction;\n        var x = input.deltaX;\n        var y = input.deltaY;\n\n        // lock to axis?\n        if (!(direction & options.direction)) {\n            if (options.direction & DIRECTION_HORIZONTAL) {\n                direction = (x === 0) ? DIRECTION_NONE : (x < 0) ? DIRECTION_LEFT : DIRECTION_RIGHT;\n                hasMoved = x != this.pX;\n                distance = Math.abs(input.deltaX);\n            } else {\n                direction = (y === 0) ? DIRECTION_NONE : (y < 0) ? DIRECTION_UP : DIRECTION_DOWN;\n                hasMoved = y != this.pY;\n                distance = Math.abs(input.deltaY);\n            }\n        }\n        input.direction = direction;\n        return hasMoved && distance > options.threshold && direction & options.direction;\n    },\n\n    attrTest: function(input) {\n        return AttrRecognizer.prototype.attrTest.call(this, input) &&\n            (this.state & STATE_BEGAN || (!(this.state & STATE_BEGAN) && this.directionTest(input)));\n    },\n\n    emit: function(input) {\n\n        this.pX = input.deltaX;\n        this.pY = input.deltaY;\n\n        var direction = directionStr(input.direction);\n\n        if (direction) {\n            input.additionalEvent = this.options.event + direction;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Pinch\n * Recognized when two or more pointers are moving toward (zoom-in) or away from each other (zoom-out).\n * @constructor\n * @extends AttrRecognizer\n */\nfunction PinchRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(PinchRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'pinch',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.scale - 1) > this.options.threshold || this.state & STATE_BEGAN);\n    },\n\n    emit: function(input) {\n        if (input.scale !== 1) {\n            var inOut = input.scale < 1 ? 'in' : 'out';\n            input.additionalEvent = this.options.event + inOut;\n        }\n        this._super.emit.call(this, input);\n    }\n});\n\n/**\n * Press\n * Recognized when the pointer is down for x ms without any movement.\n * @constructor\n * @extends Recognizer\n */\nfunction PressRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    this._timer = null;\n    this._input = null;\n}\n\ninherit(PressRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PressRecognizer\n     */\n    defaults: {\n        event: 'press',\n        pointers: 1,\n        time: 251, // minimal time of the pointer to be pressed\n        threshold: 9 // a minimal movement is ok, but keep it low\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_AUTO];\n    },\n\n    process: function(input) {\n        var options = this.options;\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTime = input.deltaTime > options.time;\n\n        this._input = input;\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (!validMovement || !validPointers || (input.eventType & (INPUT_END | INPUT_CANCEL) && !validTime)) {\n            this.reset();\n        } else if (input.eventType & INPUT_START) {\n            this.reset();\n            this._timer = setTimeoutContext(function() {\n                this.state = STATE_RECOGNIZED;\n                this.tryEmit();\n            }, options.time, this);\n        } else if (input.eventType & INPUT_END) {\n            return STATE_RECOGNIZED;\n        }\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function(input) {\n        if (this.state !== STATE_RECOGNIZED) {\n            return;\n        }\n\n        if (input && (input.eventType & INPUT_END)) {\n            this.manager.emit(this.options.event + 'up', input);\n        } else {\n            this._input.timeStamp = now();\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Rotate\n * Recognized when two or more pointer are moving in a circular motion.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction RotateRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(RotateRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof RotateRecognizer\n     */\n    defaults: {\n        event: 'rotate',\n        threshold: 0,\n        pointers: 2\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_NONE];\n    },\n\n    attrTest: function(input) {\n        return this._super.attrTest.call(this, input) &&\n            (Math.abs(input.rotation) > this.options.threshold || this.state & STATE_BEGAN);\n    }\n});\n\n/**\n * Swipe\n * Recognized when the pointer is moving fast (velocity), with enough distance in the allowed direction.\n * @constructor\n * @extends AttrRecognizer\n */\nfunction SwipeRecognizer() {\n    AttrRecognizer.apply(this, arguments);\n}\n\ninherit(SwipeRecognizer, AttrRecognizer, {\n    /**\n     * @namespace\n     * @memberof SwipeRecognizer\n     */\n    defaults: {\n        event: 'swipe',\n        threshold: 10,\n        velocity: 0.3,\n        direction: DIRECTION_HORIZONTAL | DIRECTION_VERTICAL,\n        pointers: 1\n    },\n\n    getTouchAction: function() {\n        return PanRecognizer.prototype.getTouchAction.call(this);\n    },\n\n    attrTest: function(input) {\n        var direction = this.options.direction;\n        var velocity;\n\n        if (direction & (DIRECTION_HORIZONTAL | DIRECTION_VERTICAL)) {\n            velocity = input.overallVelocity;\n        } else if (direction & DIRECTION_HORIZONTAL) {\n            velocity = input.overallVelocityX;\n        } else if (direction & DIRECTION_VERTICAL) {\n            velocity = input.overallVelocityY;\n        }\n\n        return this._super.attrTest.call(this, input) &&\n            direction & input.offsetDirection &&\n            input.distance > this.options.threshold &&\n            input.maxPointers == this.options.pointers &&\n            abs(velocity) > this.options.velocity && input.eventType & INPUT_END;\n    },\n\n    emit: function(input) {\n        var direction = directionStr(input.offsetDirection);\n        if (direction) {\n            this.manager.emit(this.options.event + direction, input);\n        }\n\n        this.manager.emit(this.options.event, input);\n    }\n});\n\n/**\n * A tap is ecognized when the pointer is doing a small tap/click. Multiple taps are recognized if they occur\n * between the given interval and position. The delay option can be used to recognize multi-taps without firing\n * a single tap.\n *\n * The eventData from the emitted event contains the property `tapCount`, which contains the amount of\n * multi-taps being recognized.\n * @constructor\n * @extends Recognizer\n */\nfunction TapRecognizer() {\n    Recognizer.apply(this, arguments);\n\n    // previous time and center,\n    // used for tap counting\n    this.pTime = false;\n    this.pCenter = false;\n\n    this._timer = null;\n    this._input = null;\n    this.count = 0;\n}\n\ninherit(TapRecognizer, Recognizer, {\n    /**\n     * @namespace\n     * @memberof PinchRecognizer\n     */\n    defaults: {\n        event: 'tap',\n        pointers: 1,\n        taps: 1,\n        interval: 300, // max time between the multi-tap taps\n        time: 250, // max time of the pointer to be down (like finger on the screen)\n        threshold: 9, // a minimal movement is ok, but keep it low\n        posThreshold: 10 // a multi-tap can be a bit off the initial position\n    },\n\n    getTouchAction: function() {\n        return [TOUCH_ACTION_MANIPULATION];\n    },\n\n    process: function(input) {\n        var options = this.options;\n\n        var validPointers = input.pointers.length === options.pointers;\n        var validMovement = input.distance < options.threshold;\n        var validTouchTime = input.deltaTime < options.time;\n\n        this.reset();\n\n        if ((input.eventType & INPUT_START) && (this.count === 0)) {\n            return this.failTimeout();\n        }\n\n        // we only allow little movement\n        // and we've reached an end event, so a tap is possible\n        if (validMovement && validTouchTime && validPointers) {\n            if (input.eventType != INPUT_END) {\n                return this.failTimeout();\n            }\n\n            var validInterval = this.pTime ? (input.timeStamp - this.pTime < options.interval) : true;\n            var validMultiTap = !this.pCenter || getDistance(this.pCenter, input.center) < options.posThreshold;\n\n            this.pTime = input.timeStamp;\n            this.pCenter = input.center;\n\n            if (!validMultiTap || !validInterval) {\n                this.count = 1;\n            } else {\n                this.count += 1;\n            }\n\n            this._input = input;\n\n            // if tap count matches we have recognized it,\n            // else it has began recognizing...\n            var tapCount = this.count % options.taps;\n            if (tapCount === 0) {\n                // no failing requirements, immediately trigger the tap event\n                // or wait as long as the multitap interval to trigger\n                if (!this.hasRequireFailures()) {\n                    return STATE_RECOGNIZED;\n                } else {\n                    this._timer = setTimeoutContext(function() {\n                        this.state = STATE_RECOGNIZED;\n                        this.tryEmit();\n                    }, options.interval, this);\n                    return STATE_BEGAN;\n                }\n            }\n        }\n        return STATE_FAILED;\n    },\n\n    failTimeout: function() {\n        this._timer = setTimeoutContext(function() {\n            this.state = STATE_FAILED;\n        }, this.options.interval, this);\n        return STATE_FAILED;\n    },\n\n    reset: function() {\n        clearTimeout(this._timer);\n    },\n\n    emit: function() {\n        if (this.state == STATE_RECOGNIZED) {\n            this._input.tapCount = this.count;\n            this.manager.emit(this.options.event, this._input);\n        }\n    }\n});\n\n/**\n * Simple way to create a manager with a default set of recognizers.\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Hammer(element, options) {\n    options = options || {};\n    options.recognizers = ifUndefined(options.recognizers, Hammer.defaults.preset);\n    return new Manager(element, options);\n}\n\n/**\n * @const {string}\n */\nHammer.VERSION = '2.0.7';\n\n/**\n * default settings\n * @namespace\n */\nHammer.defaults = {\n    /**\n     * set if DOM events are being triggered.\n     * But this is slower and unused by simple implementations, so disabled by default.\n     * @type {Boolean}\n     * @default false\n     */\n    domEvents: false,\n\n    /**\n     * The value for the touchAction property/fallback.\n     * When set to `compute` it will magically set the correct value based on the added recognizers.\n     * @type {String}\n     * @default compute\n     */\n    touchAction: TOUCH_ACTION_COMPUTE,\n\n    /**\n     * @type {Boolean}\n     * @default true\n     */\n    enable: true,\n\n    /**\n     * EXPERIMENTAL FEATURE -- can be removed/changed\n     * Change the parent input target element.\n     * If Null, then it is being set the to main element.\n     * @type {Null|EventTarget}\n     * @default null\n     */\n    inputTarget: null,\n\n    /**\n     * force an input class\n     * @type {Null|Function}\n     * @default null\n     */\n    inputClass: null,\n\n    /**\n     * Default recognizer setup when calling `Hammer()`\n     * When creating a new Manager these will be skipped.\n     * @type {Array}\n     */\n    preset: [\n        // RecognizerClass, options, [recognizeWith, ...], [requireFailure, ...]\n        [RotateRecognizer, {enable: false}],\n        [PinchRecognizer, {enable: false}, ['rotate']],\n        [SwipeRecognizer, {direction: DIRECTION_HORIZONTAL}],\n        [PanRecognizer, {direction: DIRECTION_HORIZONTAL}, ['swipe']],\n        [TapRecognizer],\n        [TapRecognizer, {event: 'doubletap', taps: 2}, ['tap']],\n        [PressRecognizer]\n    ],\n\n    /**\n     * Some CSS properties can be used to improve the working of Hammer.\n     * Add them to this method and they will be set when creating a new Manager.\n     * @namespace\n     */\n    cssProps: {\n        /**\n         * Disables text selection to improve the dragging gesture. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userSelect: 'none',\n\n        /**\n         * Disable the Windows Phone grippers when pressing an element.\n         * @type {String}\n         * @default 'none'\n         */\n        touchSelect: 'none',\n\n        /**\n         * Disables the default callout shown when you touch and hold a touch target.\n         * On iOS, when you touch and hold a touch target such as a link, Safari displays\n         * a callout containing information about the link. This property allows you to disable that callout.\n         * @type {String}\n         * @default 'none'\n         */\n        touchCallout: 'none',\n\n        /**\n         * Specifies whether zooming is enabled. Used by IE10>\n         * @type {String}\n         * @default 'none'\n         */\n        contentZooming: 'none',\n\n        /**\n         * Specifies that an entire element should be draggable instead of its contents. Mainly for desktop browsers.\n         * @type {String}\n         * @default 'none'\n         */\n        userDrag: 'none',\n\n        /**\n         * Overrides the highlight color shown when the user taps a link or a JavaScript\n         * clickable element in iOS. This property obeys the alpha value, if specified.\n         * @type {String}\n         * @default 'rgba(0,0,0,0)'\n         */\n        tapHighlightColor: 'rgba(0,0,0,0)'\n    }\n};\n\nvar STOP = 1;\nvar FORCED_STOP = 2;\n\n/**\n * Manager\n * @param {HTMLElement} element\n * @param {Object} [options]\n * @constructor\n */\nfunction Manager(element, options) {\n    this.options = assign({}, Hammer.defaults, options || {});\n\n    this.options.inputTarget = this.options.inputTarget || element;\n\n    this.handlers = {};\n    this.session = {};\n    this.recognizers = [];\n    this.oldCssProps = {};\n\n    this.element = element;\n    this.input = createInputInstance(this);\n    this.touchAction = new TouchAction(this, this.options.touchAction);\n\n    toggleCssProps(this, true);\n\n    each(this.options.recognizers, function(item) {\n        var recognizer = this.add(new (item[0])(item[1]));\n        item[2] && recognizer.recognizeWith(item[2]);\n        item[3] && recognizer.requireFailure(item[3]);\n    }, this);\n}\n\nManager.prototype = {\n    /**\n     * set options\n     * @param {Object} options\n     * @returns {Manager}\n     */\n    set: function(options) {\n        assign(this.options, options);\n\n        // Options that need a little more setup\n        if (options.touchAction) {\n            this.touchAction.update();\n        }\n        if (options.inputTarget) {\n            // Clean up existing event listeners and reinitialize\n            this.input.destroy();\n            this.input.target = options.inputTarget;\n            this.input.init();\n        }\n        return this;\n    },\n\n    /**\n     * stop recognizing for this session.\n     * This session will be discarded, when a new [input]start event is fired.\n     * When forced, the recognizer cycle is stopped immediately.\n     * @param {Boolean} [force]\n     */\n    stop: function(force) {\n        this.session.stopped = force ? FORCED_STOP : STOP;\n    },\n\n    /**\n     * run the recognizers!\n     * called by the inputHandler function on every movement of the pointers (touches)\n     * it walks through all the recognizers and tries to detect the gesture that is being made\n     * @param {Object} inputData\n     */\n    recognize: function(inputData) {\n        var session = this.session;\n        if (session.stopped) {\n            return;\n        }\n\n        // run the touch-action polyfill\n        this.touchAction.preventDefaults(inputData);\n\n        var recognizer;\n        var recognizers = this.recognizers;\n\n        // this holds the recognizer that is being recognized.\n        // so the recognizer's state needs to be BEGAN, CHANGED, ENDED or RECOGNIZED\n        // if no recognizer is detecting a thing, it is set to `null`\n        var curRecognizer = session.curRecognizer;\n\n        // reset when the last recognizer is recognized\n        // or when we're in a new session\n        if (!curRecognizer || (curRecognizer && curRecognizer.state & STATE_RECOGNIZED)) {\n            curRecognizer = session.curRecognizer = null;\n        }\n\n        var i = 0;\n        while (i < recognizers.length) {\n            recognizer = recognizers[i];\n\n            // find out if we are allowed try to recognize the input for this one.\n            // 1.   allow if the session is NOT forced stopped (see the .stop() method)\n            // 2.   allow if we still haven't recognized a gesture in this session, or the this recognizer is the one\n            //      that is being recognized.\n            // 3.   allow if the recognizer is allowed to run simultaneous with the current recognized recognizer.\n            //      this can be setup with the `recognizeWith()` method on the recognizer.\n            if (session.stopped !== FORCED_STOP && ( // 1\n                    !curRecognizer || recognizer == curRecognizer || // 2\n                    recognizer.canRecognizeWith(curRecognizer))) { // 3\n                recognizer.recognize(inputData);\n            } else {\n                recognizer.reset();\n            }\n\n            // if the recognizer has been recognizing the input as a valid gesture, we want to store this one as the\n            // current active recognizer. but only if we don't already have an active recognizer\n            if (!curRecognizer && recognizer.state & (STATE_BEGAN | STATE_CHANGED | STATE_ENDED)) {\n                curRecognizer = session.curRecognizer = recognizer;\n            }\n            i++;\n        }\n    },\n\n    /**\n     * get a recognizer by its event name.\n     * @param {Recognizer|String} recognizer\n     * @returns {Recognizer|Null}\n     */\n    get: function(recognizer) {\n        if (recognizer instanceof Recognizer) {\n            return recognizer;\n        }\n\n        var recognizers = this.recognizers;\n        for (var i = 0; i < recognizers.length; i++) {\n            if (recognizers[i].options.event == recognizer) {\n                return recognizers[i];\n            }\n        }\n        return null;\n    },\n\n    /**\n     * add a recognizer to the manager\n     * existing recognizers with the same event name will be removed\n     * @param {Recognizer} recognizer\n     * @returns {Recognizer|Manager}\n     */\n    add: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'add', this)) {\n            return this;\n        }\n\n        // remove existing\n        var existing = this.get(recognizer.options.event);\n        if (existing) {\n            this.remove(existing);\n        }\n\n        this.recognizers.push(recognizer);\n        recognizer.manager = this;\n\n        this.touchAction.update();\n        return recognizer;\n    },\n\n    /**\n     * remove a recognizer by name or instance\n     * @param {Recognizer|String} recognizer\n     * @returns {Manager}\n     */\n    remove: function(recognizer) {\n        if (invokeArrayArg(recognizer, 'remove', this)) {\n            return this;\n        }\n\n        recognizer = this.get(recognizer);\n\n        // let's make sure this recognizer exists\n        if (recognizer) {\n            var recognizers = this.recognizers;\n            var index = inArray(recognizers, recognizer);\n\n            if (index !== -1) {\n                recognizers.splice(index, 1);\n                this.touchAction.update();\n            }\n        }\n\n        return this;\n    },\n\n    /**\n     * bind event\n     * @param {String} events\n     * @param {Function} handler\n     * @returns {EventEmitter} this\n     */\n    on: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n        if (handler === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            handlers[event] = handlers[event] || [];\n            handlers[event].push(handler);\n        });\n        return this;\n    },\n\n    /**\n     * unbind event, leave emit blank to remove all handlers\n     * @param {String} events\n     * @param {Function} [handler]\n     * @returns {EventEmitter} this\n     */\n    off: function(events, handler) {\n        if (events === undefined) {\n            return;\n        }\n\n        var handlers = this.handlers;\n        each(splitStr(events), function(event) {\n            if (!handler) {\n                delete handlers[event];\n            } else {\n                handlers[event] && handlers[event].splice(inArray(handlers[event], handler), 1);\n            }\n        });\n        return this;\n    },\n\n    /**\n     * emit event to the listeners\n     * @param {String} event\n     * @param {Object} data\n     */\n    emit: function(event, data) {\n        // we also want to trigger dom events\n        if (this.options.domEvents) {\n            triggerDomEvent(event, data);\n        }\n\n        // no handlers, so skip it all\n        var handlers = this.handlers[event] && this.handlers[event].slice();\n        if (!handlers || !handlers.length) {\n            return;\n        }\n\n        data.type = event;\n        data.preventDefault = function() {\n            data.srcEvent.preventDefault();\n        };\n\n        var i = 0;\n        while (i < handlers.length) {\n            handlers[i](data);\n            i++;\n        }\n    },\n\n    /**\n     * destroy the manager and unbinds all events\n     * it doesn't unbind dom events, that is the user own responsibility\n     */\n    destroy: function() {\n        this.element && toggleCssProps(this, false);\n\n        this.handlers = {};\n        this.session = {};\n        this.input.destroy();\n        this.element = null;\n    }\n};\n\n/**\n * add/remove the css properties as defined in manager.options.cssProps\n * @param {Manager} manager\n * @param {Boolean} add\n */\nfunction toggleCssProps(manager, add) {\n    var element = manager.element;\n    if (!element.style) {\n        return;\n    }\n    var prop;\n    each(manager.options.cssProps, function(value, name) {\n        prop = prefixed(element.style, name);\n        if (add) {\n            manager.oldCssProps[prop] = element.style[prop];\n            element.style[prop] = value;\n        } else {\n            element.style[prop] = manager.oldCssProps[prop] || '';\n        }\n    });\n    if (!add) {\n        manager.oldCssProps = {};\n    }\n}\n\n/**\n * trigger dom event\n * @param {String} event\n * @param {Object} data\n */\nfunction triggerDomEvent(event, data) {\n    var gestureEvent = document.createEvent('Event');\n    gestureEvent.initEvent(event, true, true);\n    gestureEvent.gesture = data;\n    data.target.dispatchEvent(gestureEvent);\n}\n\nassign(Hammer, {\n    INPUT_START: INPUT_START,\n    INPUT_MOVE: INPUT_MOVE,\n    INPUT_END: INPUT_END,\n    INPUT_CANCEL: INPUT_CANCEL,\n\n    STATE_POSSIBLE: STATE_POSSIBLE,\n    STATE_BEGAN: STATE_BEGAN,\n    STATE_CHANGED: STATE_CHANGED,\n    STATE_ENDED: STATE_ENDED,\n    STATE_RECOGNIZED: STATE_RECOGNIZED,\n    STATE_CANCELLED: STATE_CANCELLED,\n    STATE_FAILED: STATE_FAILED,\n\n    DIRECTION_NONE: DIRECTION_NONE,\n    DIRECTION_LEFT: DIRECTION_LEFT,\n    DIRECTION_RIGHT: DIRECTION_RIGHT,\n    DIRECTION_UP: DIRECTION_UP,\n    DIRECTION_DOWN: DIRECTION_DOWN,\n    DIRECTION_HORIZONTAL: DIRECTION_HORIZONTAL,\n    DIRECTION_VERTICAL: DIRECTION_VERTICAL,\n    DIRECTION_ALL: DIRECTION_ALL,\n\n    Manager: Manager,\n    Input: Input,\n    TouchAction: TouchAction,\n\n    TouchInput: TouchInput,\n    MouseInput: MouseInput,\n    PointerEventInput: PointerEventInput,\n    TouchMouseInput: TouchMouseInput,\n    SingleTouchInput: SingleTouchInput,\n\n    Recognizer: Recognizer,\n    AttrRecognizer: AttrRecognizer,\n    Tap: TapRecognizer,\n    Pan: PanRecognizer,\n    Swipe: SwipeRecognizer,\n    Pinch: PinchRecognizer,\n    Rotate: RotateRecognizer,\n    Press: PressRecognizer,\n\n    on: addEventListeners,\n    off: removeEventListeners,\n    each: each,\n    merge: merge,\n    extend: extend,\n    assign: assign,\n    inherit: inherit,\n    bindFn: bindFn,\n    prefixed: prefixed\n});\n\n// this prevents errors when Hammer is loaded in the presence of an AMD\n//  style loader but by script tag, not by the loader.\nvar freeGlobal = (typeof window !== 'undefined' ? window : (typeof self !== 'undefined' ? self : {})); // jshint ignore:line\nfreeGlobal.Hammer = Hammer;\n\nif (typeof define === 'function' && define.amd) {\n    define(function() {\n        return Hammer;\n    });\n} else if (typeof module != 'undefined' && module.exports) {\n    module.exports = Hammer;\n} else {\n    window[exportName] = Hammer;\n}\n\n})(window, document, 'Hammer');\n","'use strict';\nvar $ = require('../internals/export');\nvar $indexOf = require('../internals/array-includes').indexOf;\nvar arrayMethodIsStrict = require('../internals/array-method-is-strict');\nvar arrayMethodUsesToLength = require('../internals/array-method-uses-to-length');\n\nvar nativeIndexOf = [].indexOf;\n\nvar NEGATIVE_ZERO = !!nativeIndexOf && 1 / [1].indexOf(1, -0) < 0;\nvar STRICT_METHOD = arrayMethodIsStrict('indexOf');\nvar USES_TO_LENGTH = arrayMethodUsesToLength('indexOf', { ACCESSORS: true, 1: 0 });\n\n// `Array.prototype.indexOf` method\n// https://tc39.github.io/ecma262/#sec-array.prototype.indexof\n$({ target: 'Array', proto: true, forced: NEGATIVE_ZERO || !STRICT_METHOD || !USES_TO_LENGTH }, {\n  indexOf: function indexOf(searchElement /* , fromIndex = 0 */) {\n    return NEGATIVE_ZERO\n      // convert -0 to +0\n      ? nativeIndexOf.apply(this, arguments) || 0\n      : $indexOf(this, searchElement, arguments.length > 1 ? arguments[1] : undefined);\n  }\n});\n","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks the presence of a label.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (isAny(node, [\n      'bpmn:ParallelGateway',\n      'bpmn:EventBasedGateway'\n    ])) {\n      return;\n    }\n\n    // ignore joining gateways\n    if (is(node, 'bpmn:Gateway') && !isForking(node)) {\n      return;\n    }\n\n    if (is(node, 'bpmn:BoundaryEvent')) {\n      return;\n    }\n\n    // ignore sub-processes\n    if (is(node, 'bpmn:SubProcess')) {\n      // TODO(nikku): better ignore expanded sub-processes only\n      return;\n    }\n\n    // ignore sequence flow without condition\n    if (is(node, 'bpmn:SequenceFlow') && !hasCondition(node)) {\n      return;\n    }\n\n    // ignore data objects and artifacts for now\n    if (isAny(node, [\n      'bpmn:FlowNode',\n      'bpmn:SequenceFlow',\n      'bpmn:Participant',\n      'bpmn:Lane'\n    ])) {\n\n      const name = (node.name || '').trim();\n\n      if (name.length === 0) {\n        reporter.report(node.id, 'Element is missing label/name');\n      }\n    }\n  }\n\n  return { check };\n};\n\n\n// helpers ////////////////////////\n\nfunction isForking(node) {\n  const outgoing = node.outgoing || [];\n\n  return outgoing.length > 1;\n}\n\nfunction hasCondition(node) {\n  return node.conditionExpression;\n}","var eq = require('./eq');\n\n/**\n * Gets the index at which the `key` is found in `array` of key-value pairs.\n *\n * @private\n * @param {Array} array The array to inspect.\n * @param {*} key The key to search for.\n * @returns {number} Returns the index of the matched value, else `-1`.\n */\nfunction assocIndexOf(array, key) {\n  var length = array.length;\n  while (length--) {\n    if (eq(array[length][0], key)) {\n      return length;\n    }\n  }\n  return -1;\n}\n\nmodule.exports = assocIndexOf;\n","/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates an array that is the composition of partially applied arguments,\n * placeholders, and provided arguments into a single array of arguments.\n *\n * @private\n * @param {Array} args The provided arguments.\n * @param {Array} partials The arguments to prepend to those provided.\n * @param {Array} holders The `partials` placeholder indexes.\n * @params {boolean} [isCurried] Specify composing for a curried function.\n * @returns {Array} Returns the new array of composed arguments.\n */\nfunction composeArgs(args, partials, holders, isCurried) {\n  var argsIndex = -1,\n      argsLength = args.length,\n      holdersLength = holders.length,\n      leftIndex = -1,\n      leftLength = partials.length,\n      rangeLength = nativeMax(argsLength - holdersLength, 0),\n      result = Array(leftLength + rangeLength),\n      isUncurried = !isCurried;\n\n  while (++leftIndex < leftLength) {\n    result[leftIndex] = partials[leftIndex];\n  }\n  while (++argsIndex < holdersLength) {\n    if (isUncurried || argsIndex < argsLength) {\n      result[holders[argsIndex]] = args[argsIndex];\n    }\n  }\n  while (rangeLength--) {\n    result[leftIndex++] = args[argsIndex++];\n  }\n  return result;\n}\n\nmodule.exports = composeArgs;\n","/**\n * This method returns the first argument it receives.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Util\n * @param {*} value Any value.\n * @returns {*} Returns `value`.\n * @example\n *\n * var object = { 'a': 1 };\n *\n * console.log(_.identity(object) === object);\n * // => true\n */\nfunction identity(value) {\n  return value;\n}\n\nmodule.exports = identity;\n","var Symbol = require('./_Symbol'),\n    arrayMap = require('./_arrayMap'),\n    isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/** Used to convert symbols to primitives and strings. */\nvar symbolProto = Symbol ? Symbol.prototype : undefined,\n    symbolToString = symbolProto ? symbolProto.toString : undefined;\n\n/**\n * The base implementation of `_.toString` which doesn't convert nullish\n * values to empty strings.\n *\n * @private\n * @param {*} value The value to process.\n * @returns {string} Returns the string.\n */\nfunction baseToString(value) {\n  // Exit early for strings to avoid a performance hit in some environments.\n  if (typeof value == 'string') {\n    return value;\n  }\n  if (isArray(value)) {\n    // Recursively convert values (susceptible to call stack limits).\n    return arrayMap(value, baseToString) + '';\n  }\n  if (isSymbol(value)) {\n    return symbolToString ? symbolToString.call(value) : '';\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = baseToString;\n","var apply = require('./_apply'),\n    createCtor = require('./_createCtor'),\n    root = require('./_root');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1;\n\n/**\n * Creates a function that wraps `func` to invoke it with the `this` binding\n * of `thisArg` and `partials` prepended to the arguments it receives.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {*} thisArg The `this` binding of `func`.\n * @param {Array} partials The arguments to prepend to those provided to\n *  the new function.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createPartial(func, bitmask, thisArg, partials) {\n  var isBind = bitmask & WRAP_BIND_FLAG,\n      Ctor = createCtor(func);\n\n  function wrapper() {\n    var argsIndex = -1,\n        argsLength = arguments.length,\n        leftIndex = -1,\n        leftLength = partials.length,\n        args = Array(leftLength + argsLength),\n        fn = (this && this !== root && this instanceof wrapper) ? Ctor : func;\n\n    while (++leftIndex < leftLength) {\n      args[leftIndex] = partials[leftIndex];\n    }\n    while (argsLength--) {\n      args[leftIndex++] = arguments[++argsIndex];\n    }\n    return apply(fn, isBind ? thisArg : this, args);\n  }\n  return wrapper;\n}\n\nmodule.exports = createPartial;\n","var ListCache = require('./_ListCache'),\n    Map = require('./_Map'),\n    MapCache = require('./_MapCache');\n\n/** Used as the size to enable large array optimizations. */\nvar LARGE_ARRAY_SIZE = 200;\n\n/**\n * Sets the stack `key` to `value`.\n *\n * @private\n * @name set\n * @memberOf Stack\n * @param {string} key The key of the value to set.\n * @param {*} value The value to set.\n * @returns {Object} Returns the stack cache instance.\n */\nfunction stackSet(key, value) {\n  var data = this.__data__;\n  if (data instanceof ListCache) {\n    var pairs = data.__data__;\n    if (!Map || (pairs.length < LARGE_ARRAY_SIZE - 1)) {\n      pairs.push([key, value]);\n      this.size = ++data.size;\n      return this;\n    }\n    data = this.__data__ = new MapCache(pairs);\n  }\n  data.set(key, value);\n  this.size = data.size;\n  return this;\n}\n\nmodule.exports = stackSet;\n","'use strict';\n\nvar escapeHTML = require('./Utils').escapeHTML;\n\nvar domify = require('min-dom').domify,\n    domQuery = require('min-dom').query,\n    domQueryAll = require('min-dom').queryAll,\n    domRemove = require('min-dom').remove,\n    domClasses = require('min-dom').classes,\n    domClosest = require('min-dom').closest,\n    domAttr = require('min-dom').attr,\n    domDelegate = require('min-dom').delegate,\n    domMatches = require('min-dom').matches;\n\nvar forEach = require('lodash/forEach'),\n    filter = require('lodash/filter'),\n    get = require('lodash/get'),\n    keys = require('lodash/keys'),\n    isEmpty = require('lodash/isEmpty'),\n    isArray = require('lodash/isArray'),\n    xor = require('lodash/xor'),\n    debounce = require('lodash/debounce');\n\nvar updateSelection = require('selection-update');\n\nvar scrollTabs = require('scroll-tabs').default;\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar HIDE_CLASS = 'bpp-hidden';\nvar DEBOUNCE_DELAY = 300;\n\n\nfunction isToggle(node) {\n  return node.type === 'checkbox' || node.type === 'radio';\n}\n\nfunction isSelect(node) {\n  return node.type === 'select-one';\n}\n\nfunction isContentEditable(node) {\n  return domAttr(node, 'contenteditable');\n}\n\nfunction getPropertyPlaceholders(node) {\n  var selector = 'input[name], textarea[name], [data-value], [contenteditable]';\n  var placeholders = domQueryAll(selector, node);\n  if ((!placeholders || !placeholders.length) && domMatches(node, selector)) {\n    placeholders = [ node ];\n  }\n  return placeholders;\n}\n\n/**\n * Return all active form controls.\n * This excludes the invisible controls unless all is true\n *\n * @param {Element} node\n * @param {Boolean} [all=false]\n */\nfunction getFormControls(node, all) {\n  var controls = domQueryAll('input[name], textarea[name], select[name], [contenteditable]', node);\n\n  if (!controls || !controls.length) {\n    controls = domMatches(node, 'option') ? [ node ] : controls;\n  }\n\n  if (!all) {\n    controls = filter(controls, function(node) {\n      return !domClosest(node, '.' + HIDE_CLASS);\n    });\n  }\n\n  return controls;\n}\n\nfunction getFormControlValuesInScope(entryNode) {\n  var values = {};\n\n  var controlNodes = getFormControls(entryNode);\n\n  forEach(controlNodes, function(controlNode) {\n    var value = controlNode.value;\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    // take toggle state into account for radio / checkboxes\n    if (isToggle(controlNode)) {\n      if (controlNode.checked) {\n        if (!domAttr(controlNode, 'value')) {\n          value = true;\n        } else {\n          value = controlNode.value;\n        }\n      } else {\n        value = null;\n      }\n    } else\n    if (isContentEditable(controlNode)) {\n      value = controlNode.innerText;\n    }\n\n    if (value !== null) {\n      // return the actual value\n      // handle serialization in entry provider\n      // (ie. if empty string should be serialized or not)\n      values[name] = value;\n    }\n  });\n\n  return values;\n\n}\n\n/**\n * Extract input values from entry node\n *\n * @param  {DOMElement} entryNode\n * @returns {Object}\n */\nfunction getFormControlValues(entryNode) {\n\n  var values;\n\n  var listContainer = domQuery('[data-list-entry-container]', entryNode);\n  if (listContainer) {\n    values = [];\n    var listNodes = listContainer.children || [];\n    forEach(listNodes, function(listNode) {\n      values.push(getFormControlValuesInScope(listNode));\n    });\n  } else {\n    values = getFormControlValuesInScope(entryNode);\n  }\n\n  return values;\n}\n\n/**\n * Return true if the given form extracted value equals\n * to an old cached version.\n *\n * @param {Object} value\n * @param {Object} oldValue\n * @return {Boolean}\n */\nfunction valueEqual(value, oldValue) {\n\n  if (value && !oldValue) {\n    return false;\n  }\n\n  var allKeys = keys(value).concat(keys(oldValue));\n\n  return allKeys.every(function(key) {\n    return value[key] === oldValue[key];\n  });\n}\n\n/**\n * Return true if the given form extracted value(s)\n * equal an old cached version.\n *\n * @param {Array<Object>|Object} values\n * @param {Array<Object>|Object} oldValues\n * @return {Boolean}\n */\nfunction valuesEqual(values, oldValues) {\n\n  if (isArray(values)) {\n\n    if (values.length !== oldValues.length) {\n      return false;\n    }\n\n    return values.every(function(v, idx) {\n      return valueEqual(v, oldValues[idx]);\n    });\n  }\n\n  return valueEqual(values, oldValues);\n}\n\n/**\n * Return a mapping of { id: entry } for all entries in the given groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractEntries(tabs) {\n  return keyBy(flattenDeep(map(flattenDeep(map(tabs, 'groups')), 'entries')), 'id');\n}\n\n/**\n * Return a mapping of { id: group } for all groups in the given tabs.\n *\n * @param {Object} tabs\n * @return {Object}\n */\nfunction extractGroups(tabs) {\n  return keyBy(flattenDeep(map(tabs, 'groups')), 'id');\n}\n\n/**\n * A properties panel implementation.\n *\n * To use it provide a `propertiesProvider` component that knows\n * about which properties to display.\n *\n * Properties edit state / visibility can be intercepted\n * via a custom {@link PropertiesActivator}.\n *\n * @class\n * @constructor\n *\n * @param {Object} config\n * @param {EventBus} eventBus\n * @param {Modeling} modeling\n * @param {PropertiesProvider} propertiesProvider\n * @param {Canvas} canvas\n * @param {CommandStack} commandStack\n */\nfunction PropertiesPanel(config, eventBus, modeling, propertiesProvider, commandStack, canvas) {\n\n  this._eventBus = eventBus;\n  this._modeling = modeling;\n  this._commandStack = commandStack;\n  this._canvas = canvas;\n  this._propertiesProvider = propertiesProvider;\n\n  this._init(config);\n}\n\nPropertiesPanel.$inject = [\n  'config.propertiesPanel',\n  'eventBus',\n  'modeling',\n  'propertiesProvider',\n  'commandStack',\n  'canvas'\n];\n\nmodule.exports = PropertiesPanel;\n\n\nPropertiesPanel.prototype._init = function(config) {\n\n  var canvas = this._canvas,\n      eventBus = this._eventBus;\n\n  var self = this;\n\n  /**\n   * Select the root element once it is added to the canvas\n   */\n  eventBus.on('root.added', function(e) {\n    var element = e.element;\n\n    if (isImplicitRoot(element)) {\n      return;\n    }\n\n    self.update(element);\n  });\n\n  eventBus.on('selection.changed', function(e) {\n    var newElement = e.newSelection[0];\n\n    var rootElement = canvas.getRootElement();\n\n    if (isImplicitRoot(rootElement)) {\n      return;\n    }\n\n    self.update(newElement);\n  });\n\n  // add / update tab-bar scrolling\n  eventBus.on([\n    'propertiesPanel.changed',\n    'propertiesPanel.resized'\n  ], function(event) {\n\n    var tabBarNode = domQuery('.bpp-properties-tab-bar', self._container);\n\n    if (!tabBarNode) {\n      return;\n    }\n\n    var scroller = scrollTabs.get(tabBarNode);\n\n    if (!scroller) {\n\n      // we did not initialize yet, do that\n      // now and make sure we select the active\n      // tab on scroll update\n      scroller = scrollTabs(tabBarNode, {\n        selectors: {\n          tabsContainer: '.bpp-properties-tabs-links',\n          tab: '.bpp-properties-tabs-links li',\n          ignore: '.bpp-hidden',\n          active: '.bpp-active'\n        }\n      });\n\n\n      scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n\n        var linkNode = domQuery('[data-tab-target]', newActiveNode);\n\n        var tabId = domAttr(linkNode, 'data-tab-target');\n\n        self.activateTab(tabId);\n      });\n    }\n\n    // react on tab changes and or tabContainer resize\n    // and make sure the active tab is shown completely\n    scroller.update();\n  });\n\n  eventBus.on('elements.changed', function(e) {\n\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      if (e.elements.indexOf(element) !== -1) {\n        self.update(element);\n      }\n    }\n  });\n\n  eventBus.on('elementTemplates.changed', function() {\n    var current = self._current;\n    var element = current && current.element;\n\n    if (element) {\n      self.update(element);\n    }\n  });\n\n  eventBus.on('diagram.destroy', function() {\n    self.detach();\n  });\n\n  this._container = domify('<div class=\"bpp-properties-panel\"></div>');\n\n  this._bindListeners(this._container);\n\n  if (config && config.parent) {\n    this.attachTo(config.parent);\n  }\n};\n\n\nPropertiesPanel.prototype.attachTo = function(parentNode) {\n\n  if (!parentNode) {\n    throw new Error('parentNode required');\n  }\n\n  // ensure we detach from the\n  // previous, old parent\n  this.detach();\n\n  // unwrap jQuery if provided\n  if (parentNode.get && parentNode.constructor.prototype.jquery) {\n    parentNode = parentNode.get(0);\n  }\n\n  if (typeof parentNode === 'string') {\n    parentNode = domQuery(parentNode);\n  }\n\n  var container = this._container;\n\n  parentNode.appendChild(container);\n\n  this._emit('attach');\n};\n\nPropertiesPanel.prototype.detach = function() {\n\n  var container = this._container,\n      parentNode = container.parentNode;\n\n  if (!parentNode) {\n    return;\n  }\n\n  this._emit('detach');\n\n  parentNode.removeChild(container);\n};\n\n\n/**\n * Select the given tab within the properties panel.\n *\n * @param {Object|String} tab\n */\nPropertiesPanel.prototype.activateTab = function(tab) {\n\n  var tabId = typeof tab === 'string' ? tab : tab.id;\n\n  var current = this._current;\n\n  var panelNode = current.panel;\n\n  var allTabNodes = domQueryAll('.bpp-properties-tab', panelNode),\n      allTabLinkNodes = domQueryAll('.bpp-properties-tab-link', panelNode);\n\n  forEach(allTabNodes, function(tabNode) {\n\n    var currentTabId = domAttr(tabNode, 'data-tab');\n\n    domClasses(tabNode).toggle('bpp-active', tabId === currentTabId);\n  });\n\n  forEach(allTabLinkNodes, function(tabLinkNode) {\n\n    var tabLink = domQuery('[data-tab-target]', tabLinkNode),\n        currentTabId = domAttr(tabLink, 'data-tab-target');\n\n    domClasses(tabLinkNode).toggle('bpp-active', tabId === currentTabId);\n  });\n};\n\n/**\n * Update the DOM representation of the properties panel\n */\nPropertiesPanel.prototype.update = function(element) {\n  var current = this._current;\n\n  // no actual selection change\n  var needsCreate = true;\n\n  if (typeof element === 'undefined') {\n\n    // use RootElement of BPMN diagram to generate properties panel if no element is selected\n    element = this._canvas.getRootElement();\n  }\n\n  var newTabs = this._propertiesProvider.getTabs(element);\n\n  if (current && current.element === element) {\n    // see if we can reuse the existing panel\n\n    needsCreate = this._entriesChanged(current, newTabs);\n  }\n\n  if (needsCreate) {\n\n    if (current) {\n\n      // get active tab from the existing panel before remove it\n      var activeTabNode = domQuery('.bpp-properties-tab.bpp-active', current.panel);\n\n      var activeTabId;\n      if (activeTabNode) {\n        activeTabId = domAttr(activeTabNode, 'data-tab');\n      }\n\n      // remove old panel\n      domRemove(current.panel);\n    }\n\n    this._current = this._create(element, newTabs);\n\n    // activate the saved active tab from the remove panel or the first tab\n    (activeTabId) ? this.activateTab(activeTabId) : this.activateTab(this._current.tabs[0]);\n\n  }\n\n  if (this._current) {\n    // make sure correct tab contents are visible\n    this._updateActivation(this._current);\n\n  }\n\n  this._emit('changed');\n};\n\n\n/**\n * Returns true if one of two groups has different entries than the other.\n *\n * @param  {Object} current\n * @param  {Object} newTabs\n * @return {Boolean}\n */\nPropertiesPanel.prototype._entriesChanged = function(current, newTabs) {\n\n  var oldEntryIds = keys(current.entries),\n      newEntryIds = keys(extractEntries(newTabs));\n\n  return !isEmpty(xor(oldEntryIds, newEntryIds));\n};\n\nPropertiesPanel.prototype._emit = function(event) {\n  this._eventBus.fire('propertiesPanel.' + event, { panel: this, current: this._current });\n};\n\nPropertiesPanel.prototype._bindListeners = function(container) {\n\n  var self = this;\n\n  // handles a change for a given event\n  var handleChange = function handleChange(event) {\n\n    // see if we handle a change inside a [data-entry] element.\n    // if not, drop out\n    var inputNode = event.delegateTarget,\n        entryNode = domClosest(inputNode, '[data-entry]'),\n        entryId, entry;\n\n    // change from outside a [data-entry] element, simply ignore\n    if (!entryNode) {\n      return;\n    }\n\n    entryId = domAttr(entryNode, 'data-entry');\n    entry = self.getEntry(entryId);\n\n    var values = getFormControlValues(entryNode);\n\n    if (event.type === 'change') {\n\n      // - if the \"data-on-change\" attribute is present and a value is changed,\n      //   then the associated action is performed.\n      // - if the associated action returns \"true\" then an update to the business\n      //   object is done\n      // - if it does not return \"true\", then only the DOM content is updated\n      var onChangeAction = domAttr(inputNode, 'data-on-change');\n\n      if (onChangeAction) {\n        var isEntryDirty = self.executeAction(entry, entryNode, onChangeAction, event);\n\n        if (!isEntryDirty) {\n          return self.update(self._current.element);\n        }\n      }\n    }\n    self.applyChanges(entry, values, entryNode);\n    self.updateState(entry, entryNode);\n  };\n\n  // debounce update only elements that are target of key events,\n  // i.e. INPUT and TEXTAREA. SELECTs will trigger an immediate update anyway.\n  domDelegate.bind(container, 'input, textarea, [contenteditable]', 'input', debounce(handleChange, DEBOUNCE_DELAY));\n  domDelegate.bind(container, 'input, textarea, select, [contenteditable]', 'change', handleChange);\n\n  // paste as plain text only\n  domDelegate.bind(container, '[contenteditable]', 'paste', handlePaste);\n\n  function handlePaste(event) {\n    var text = (event.clipboardData || window.clipboardData).getData('text');\n    document.execCommand('insertText', false, text);\n\n    event.preventDefault();\n  }\n\n  // handle key events\n  domDelegate.bind(container, 'select', 'keydown', function(e) {\n\n    // DEL\n    if (e.keyCode === 46) {\n      e.stopPropagation();\n      e.preventDefault();\n    }\n  });\n\n  domDelegate.bind(container, '[data-action]', 'click', function onClick(event) {\n\n    // triggers on all inputs\n    var inputNode = event.delegateTarget,\n        entryNode = domClosest(inputNode, '[data-entry]');\n\n    var actionId = domAttr(inputNode, 'data-action'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, actionId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  });\n\n  function handleInput(event, element) {\n    // triggers on all inputs\n    var inputNode = event.delegateTarget;\n\n    var entryNode = domClosest(inputNode, '[data-entry]');\n\n    // only work on data entries\n    if (!entryNode) {\n      return;\n    }\n\n    var eventHandlerId = domAttr(inputNode, 'data-blur'),\n        entryId = domAttr(entryNode, 'data-entry');\n\n    var entry = self.getEntry(entryId);\n\n    var isEntryDirty = self.executeAction(entry, entryNode, eventHandlerId, event);\n\n    if (isEntryDirty) {\n      var values = getFormControlValues(entryNode);\n\n      self.applyChanges(entry, values, entryNode);\n    }\n\n    self.updateState(entry, entryNode);\n  }\n\n  domDelegate.bind(container, '[data-blur]', 'blur', handleInput, true);\n\n  // make tab links interactive\n  domDelegate.bind(container, '.bpp-properties-tabs-links [data-tab-target]', 'click', function(event) {\n    event.preventDefault();\n\n    var delegateTarget = event.delegateTarget;\n\n    var tabId = domAttr(delegateTarget, 'data-tab-target');\n\n    // activate tab on link click\n    self.activateTab(tabId);\n  });\n\n};\n\nPropertiesPanel.prototype.updateState = function(entry, entryNode) {\n  this.updateShow(entry, entryNode);\n  this.updateDisable(entry, entryNode);\n};\n\n/**\n * Update the visibility of the entry node in the DOM\n */\nPropertiesPanel.prototype.updateShow = function(entry, node) {\n\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var showNodes = domQueryAll('[data-show]', node) || [];\n\n  forEach(showNodes, function(showNode) {\n\n    var expr = domAttr(showNode, 'data-show');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(showNode, '[data-scope]') || node;\n      var shouldShow = fn(current.element, node, showNode, scope) || false;\n      if (shouldShow) {\n        domClasses(showNode).remove(HIDE_CLASS);\n      } else {\n        domClasses(showNode).add(HIDE_CLASS);\n      }\n    }\n  });\n};\n\n/**\n * Evaluates a given function. If it returns true, then the\n * node is marked as \"disabled\".\n */\nPropertiesPanel.prototype.updateDisable = function(entry, node) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var nodes = domQueryAll('[data-disable]', node) || [];\n\n  forEach(nodes, function(currentNode) {\n    var expr = domAttr(currentNode, 'data-disable');\n    var fn = get(entry, expr);\n    if (fn) {\n      var scope = domClosest(currentNode, '[data-scope]') || node;\n      var shouldDisable = fn(current.element, node, currentNode, scope) || false;\n      domAttr(currentNode, 'disabled', shouldDisable ? '' : null);\n    }\n  });\n};\n\nPropertiesPanel.prototype.executeAction = function(entry, entryNode, actionId, event) {\n  var current = this._current;\n\n  if (!current) {\n    return;\n  }\n\n  var fn = get(entry, actionId);\n  if (fn) {\n    var scopeNode = domClosest(event.target, '[data-scope]') || entryNode;\n    return fn.apply(entry, [ current.element, entryNode, event, scopeNode ]);\n  }\n};\n\n/**\n * Apply changes to the business object by executing a command\n */\nPropertiesPanel.prototype.applyChanges = function(entry, values, containerElement) {\n\n  var element = this._current.element;\n\n  // ensure we only update the model if we got dirty changes\n  if (valuesEqual(values, entry.oldValues)) {\n    return;\n  }\n\n  var command = entry.set(element, values, containerElement);\n\n  var commandToExecute;\n\n  if (isArray(command)) {\n    if (command.length) {\n      commandToExecute = {\n        cmd: 'properties-panel.multi-command-executor',\n        context: flattenDeep(command)\n      };\n    }\n  } else {\n    commandToExecute = command;\n  }\n\n  if (commandToExecute) {\n    this._commandStack.execute(commandToExecute.cmd, commandToExecute.context || { element : element });\n  } else {\n    this.update(element);\n  }\n};\n\n\n/**\n * apply validation errors in the DOM and show or remove an error message near the entry node.\n */\nPropertiesPanel.prototype.applyValidationErrors = function(validationErrors, entryNode) {\n\n  var valid = true;\n\n  var controlNodes = getFormControls(entryNode, true);\n\n  forEach(controlNodes, function(controlNode) {\n\n    var name = domAttr(controlNode, 'name') || domAttr(controlNode, 'data-name');\n\n    var error = validationErrors && validationErrors[name];\n\n    var errorMessageNode = domQuery('.bpp-error-message', controlNode.parentNode);\n\n    if (error) {\n      valid = false;\n\n      if (!errorMessageNode) {\n        errorMessageNode = domify('<div></div>');\n\n        domClasses(errorMessageNode).add('bpp-error-message');\n\n        // insert errorMessageNode after controlNode\n        controlNode.parentNode.insertBefore(errorMessageNode, controlNode.nextSibling);\n      }\n\n      errorMessageNode.textContent = error;\n\n      domClasses(controlNode).add('invalid');\n    } else {\n      domClasses(controlNode).remove('invalid');\n\n      if (errorMessageNode) {\n        controlNode.parentNode.removeChild(errorMessageNode);\n      }\n    }\n  });\n\n  return valid;\n};\n\n\n/**\n * Check if the entry contains valid input\n */\nPropertiesPanel.prototype.validate = function(entry, values, entryNode) {\n  var self = this;\n\n  var current = this._current;\n\n  var valid = true;\n\n  entryNode = entryNode || domQuery('[data-entry=\"' + entry.id + '\"]', current.panel);\n\n  if (values instanceof Array) {\n    var listContainer = domQuery('[data-list-entry-container]', entryNode),\n        listEntryNodes = listContainer.children || [];\n\n    // create new elements\n    for (var i = 0; i < values.length; i++) {\n      var listValue = values[i];\n\n      if (entry.validateListItem) {\n\n        var validationErrors = entry.validateListItem(current.element, listValue, entryNode, i),\n            listEntryNode = listEntryNodes[i];\n\n        valid = self.applyValidationErrors(validationErrors, listEntryNode) && valid;\n      }\n    }\n  } else {\n    if (entry.validate) {\n      this.validationErrors = entry.validate(current.element, values, entryNode);\n\n      valid = self.applyValidationErrors(this.validationErrors, entryNode) && valid;\n    }\n  }\n\n  return valid;\n};\n\nPropertiesPanel.prototype.getEntry = function(id) {\n  return this._current && this._current.entries[id];\n};\n\nvar flattenDeep = require('lodash/flattenDeep'),\n    keyBy = require('lodash/keyBy'),\n    map = require('lodash/map');\n\nPropertiesPanel.prototype._create = function(element, tabs) {\n\n  if (!element) {\n    return null;\n  }\n\n  var containerNode = this._container;\n\n  var panelNode = this._createPanel(element, tabs);\n\n  containerNode.appendChild(panelNode);\n\n  var entries = extractEntries(tabs);\n  var groups = extractGroups(tabs);\n\n  return {\n    tabs: tabs,\n    groups: groups,\n    entries: entries,\n    element: element,\n    panel: panelNode\n  };\n};\n\n/**\n * Update variable parts of the entry node on element changes.\n *\n * @param {djs.model.Base} element\n * @param {EntryDescriptor} entry\n * @param {Object} values\n * @param {HTMLElement} entryNode\n * @param {Number} idx\n */\nPropertiesPanel.prototype._bindTemplate = function(element, entry, values, entryNode, idx) {\n\n  var eventBus = this._eventBus;\n\n  function isPropertyEditable(entry, propertyName) {\n    return eventBus.fire('propertiesPanel.isPropertyEditable', {\n      entry: entry,\n      propertyName: propertyName,\n      element: element\n    });\n  }\n\n  var inputNodes = getPropertyPlaceholders(entryNode);\n\n  forEach(inputNodes, function(node) {\n\n    var name,\n        newValue,\n        editable;\n\n    // we deal with an input element\n    if ('value' in node || isContentEditable(node) === 'true') {\n      name = domAttr(node, 'name') || domAttr(node, 'data-name');\n      newValue = values[name];\n\n      editable = isPropertyEditable(entry, name);\n      if (editable && entry.editable) {\n        editable = entry.editable(element, entryNode, node, name, newValue, idx);\n      }\n\n      domAttr(node, 'readonly', editable ? null : '');\n      domAttr(node, 'disabled', editable ? null : '');\n\n      // take full control over setting the value\n      // and possibly updating the input in entry#setControlValue\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else if (isToggle(node)) {\n        setToggleValue(node, newValue);\n      } else if (isSelect(node)) {\n        setSelectValue(node, newValue);\n      } else {\n        setInputValue(node, newValue);\n      }\n    }\n\n    // we deal with some non-editable html element\n    else {\n      name = domAttr(node, 'data-value');\n      newValue = values[name];\n      if (entry.setControlValue) {\n        entry.setControlValue(element, entryNode, node, name, newValue, idx);\n      } else {\n        setTextValue(node, newValue);\n      }\n    }\n  });\n};\n\n// TODO(nikku): WTF freaking name? Change / clarify.\nPropertiesPanel.prototype._updateActivation = function(current) {\n  var self = this;\n\n  var eventBus = this._eventBus;\n\n  var element = current.element;\n\n  function isEntryVisible(entry) {\n    return eventBus.fire('propertiesPanel.isEntryVisible', {\n      entry: entry,\n      element: element\n    });\n  }\n\n  function isGroupVisible(group, element, groupNode) {\n    if (typeof group.enabled === 'function') {\n      return group.enabled(element, groupNode);\n    } else {\n      return true;\n    }\n  }\n\n  function isTabVisible(tab, element) {\n    if (typeof tab.enabled === 'function') {\n      return tab.enabled(element);\n    } else {\n      return true;\n    }\n  }\n\n  function toggleVisible(node, visible) {\n    domClasses(node).toggle(HIDE_CLASS, !visible);\n  }\n\n  // check whether the active tab is visible\n  // if not: set the first tab as active tab\n  function checkActiveTabVisibility(node, visible) {\n    var isActive = domClasses(node).has('bpp-active');\n    if (!visible && isActive) {\n      self.activateTab(current.tabs[0]);\n    }\n  }\n\n  function updateLabel(element, selector, text) {\n    var labelNode = domQuery(selector, element);\n\n    if (!labelNode) {\n      return;\n    }\n\n    labelNode.textContent = text;\n  }\n\n  var panelNode = current.panel;\n\n  forEach(current.tabs, function(tab) {\n\n    var tabNode = domQuery('[data-tab=' + tab.id + ']', panelNode);\n    var tabLinkNode = domQuery('[data-tab-target=' + tab.id + ']', panelNode).parentNode;\n\n    var tabVisible = false;\n\n    forEach(tab.groups, function(group) {\n\n      var groupVisible = false;\n\n      var groupNode = domQuery('[data-group=' + group.id + ']', tabNode);\n\n      forEach(group.entries, function(entry) {\n\n        var entryNode = domQuery('[data-entry=\"' + entry.id + '\"]', groupNode);\n\n        var entryVisible = isEntryVisible(entry);\n\n        groupVisible = groupVisible || entryVisible;\n\n        toggleVisible(entryNode, entryVisible);\n\n        var values = 'get' in entry ? entry.get(element, entryNode) : {};\n\n        if (values instanceof Array) {\n          var listEntryContainer = domQuery('[data-list-entry-container]', entryNode);\n          var existingElements = listEntryContainer.children || [];\n\n          for (var i = 0; i < values.length; i++) {\n            var listValue = values[i];\n            var listItemNode = existingElements[i];\n            if (!listItemNode) {\n              listItemNode = domify(entry.createListEntryTemplate(listValue, i, listEntryContainer));\n              listEntryContainer.appendChild(listItemNode);\n            }\n            domAttr(listItemNode, 'data-index', i);\n\n            self._bindTemplate(element, entry, listValue, listItemNode, i);\n          }\n\n          var entriesToRemove = existingElements.length - values.length;\n\n          for (var j = 0; j < entriesToRemove; j++) {\n            // remove orphaned element\n            listEntryContainer.removeChild(listEntryContainer.lastChild);\n          }\n\n        } else {\n          self._bindTemplate(element, entry, values, entryNode);\n        }\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n        self.validate(entry, values, entryNode);\n\n        // remember initial state for later dirty checking\n        entry.oldValues = getFormControlValues(entryNode);\n      });\n\n      if (typeof group.label === 'function') {\n        updateLabel(groupNode, '.group-label', group.label(element, groupNode));\n      }\n\n      groupVisible = groupVisible && isGroupVisible(group, element, groupNode);\n\n      tabVisible = tabVisible || groupVisible;\n\n      toggleVisible(groupNode, groupVisible);\n    });\n\n    tabVisible = tabVisible && isTabVisible(tab, element);\n\n    toggleVisible(tabNode, tabVisible);\n    toggleVisible(tabLinkNode, tabVisible);\n\n    checkActiveTabVisibility(tabNode, tabVisible);\n  });\n\n  // inject elements id into header\n  updateLabel(panelNode, '[data-label-id]', getBusinessObject(element).id || '');\n};\n\nPropertiesPanel.prototype._createPanel = function(element, tabs) {\n  var self = this;\n\n  var panelNode = domify('<div class=\"bpp-properties\"></div>'),\n      headerNode = domify('<div class=\"bpp-properties-header\">' +\n        '<div class=\"label\" data-label-id></div>' +\n        '<div class=\"search\">' +\n          '<input type=\"search\" placeholder=\"Search for property\" />' +\n          '<button><span>Search</span></button>' +\n        '</div>' +\n      '</div>'),\n      tabBarNode = domify('<div class=\"bpp-properties-tab-bar\"></div>'),\n      tabLinksNode = domify('<ul class=\"bpp-properties-tabs-links\"></ul>'),\n      tabContainerNode = domify('<div class=\"bpp-properties-tabs-container\"></div>');\n\n  panelNode.appendChild(headerNode);\n\n  forEach(tabs, function(tab, tabIndex) {\n\n    if (!tab.id) {\n      throw new Error('tab must have an id');\n    }\n\n    var tabNode = domify('<div class=\"bpp-properties-tab\" data-tab=\"' + escapeHTML(tab.id) + '\"></div>'),\n        tabLinkNode = domify('<li class=\"bpp-properties-tab-link\">' +\n          '<a href data-tab-target=\"' + escapeHTML(tab.id) + '\">' + escapeHTML(tab.label) + '</a>' +\n        '</li>');\n\n    var groups = tab.groups;\n\n    forEach(groups, function(group) {\n\n      if (!group.id) {\n        throw new Error('group must have an id');\n      }\n\n      var groupNode = domify('<div class=\"bpp-properties-group\" data-group=\"' + escapeHTML(group.id) + '\">' +\n          '<span class=\"group-toggle\"></span>' +\n          '<span class=\"group-label\">' + escapeHTML(group.label) + '</span>' +\n        '</div>');\n\n      // TODO(nre): use event delegation to handle that...\n      groupNode.querySelector('.group-toggle').addEventListener('click', function(evt) {\n        domClasses(groupNode).toggle('group-closed');\n        evt.preventDefault();\n        evt.stopPropagation();\n      });\n      groupNode.addEventListener('click', function(evt) {\n        if (!evt.defaultPrevented && domClasses(groupNode).has('group-closed')) {\n          domClasses(groupNode).remove('group-closed');\n        }\n      });\n\n      forEach(group.entries, function(entry) {\n\n        if (!entry.id) {\n          throw new Error('entry must have an id');\n        }\n\n        var html = entry.html;\n\n        if (typeof html === 'string') {\n          html = domify(html);\n        }\n\n        // unwrap jquery\n        if (html.get && html.constructor.prototype.jquery) {\n          html = html.get(0);\n        }\n\n        var entryNode = domify('<div class=\"bpp-properties-entry\" data-entry=\"' + escapeHTML(entry.id) + '\"></div>');\n\n        forEach(entry.cssClasses || [], function(cssClass) {\n          domClasses(entryNode).add(cssClass);\n        });\n\n        entryNode.appendChild(html);\n\n        groupNode.appendChild(entryNode);\n\n        // update conditionally visible elements\n        self.updateState(entry, entryNode);\n      });\n\n      tabNode.appendChild(groupNode);\n    });\n\n    tabLinksNode.appendChild(tabLinkNode);\n    tabContainerNode.appendChild(tabNode);\n  });\n\n  tabBarNode.appendChild(tabLinksNode);\n\n  panelNode.appendChild(tabBarNode);\n  panelNode.appendChild(tabContainerNode);\n\n  return panelNode;\n};\n\n\n\nfunction setInputValue(node, value) {\n\n  var contentEditable = isContentEditable(node);\n\n  var oldValue = contentEditable ? node.innerText : node.value;\n\n  var selection;\n\n  // prevents input fields from having the value 'undefined'\n  if (value === undefined) {\n    value = '';\n  }\n\n  if (oldValue === value) {\n    return;\n  }\n\n  // update selection on undo/redo\n  if (document.activeElement === node) {\n    selection = updateSelection(getSelection(node), oldValue, value);\n  }\n\n  if (contentEditable) {\n    node.innerText = value;\n  } else {\n    node.value = value;\n  }\n\n  if (selection) {\n    setSelection(node, selection);\n  }\n}\n\nfunction setSelectValue(node, value) {\n  if (value !== undefined) {\n    node.value = value;\n  }\n}\n\nfunction setToggleValue(node, value) {\n  var nodeValue = node.value;\n\n  node.checked = (value === nodeValue) || (!domAttr(node, 'value') && value);\n}\n\nfunction setTextValue(node, value) {\n  node.textContent = value;\n}\n\nfunction getSelection(node) {\n\n  return isContentEditable(node) ? getContentEditableSelection(node) : {\n    start: node.selectionStart,\n    end: node.selectionEnd\n  };\n}\n\nfunction getContentEditableSelection(node) {\n\n  var selection = window.getSelection();\n\n  var focusNode = selection.focusNode,\n      focusOffset = selection.focusOffset,\n      anchorOffset = selection.anchorOffset;\n\n  if (!focusNode) {\n    throw new Error('not selected');\n  }\n\n  // verify we have selection on the current element\n  if (!node.contains(focusNode)) {\n    throw new Error('not selected');\n  }\n\n  return {\n    start: Math.min(focusOffset, anchorOffset),\n    end: Math.max(focusOffset, anchorOffset)\n  };\n}\n\nfunction setSelection(node, selection) {\n\n  if (isContentEditable(node)) {\n    setContentEditableSelection(node, selection);\n  } else {\n    node.selectionStart = selection.start;\n    node.selectionEnd = selection.end;\n  }\n}\n\nfunction setContentEditableSelection(node, selection) {\n\n  var focusNode,\n      domRange,\n      domSelection;\n\n  focusNode = node.firstChild || node,\n  domRange = document.createRange();\n  domRange.setStart(focusNode, selection.start);\n  domRange.setEnd(focusNode, selection.end);\n\n  domSelection = window.getSelection();\n  domSelection.removeAllRanges();\n  domSelection.addRange(domRange);\n}\n\nfunction isImplicitRoot(element) {\n  return element.id === '__implicitroot';\n}\n","'use strict';\n\nvar has = Object.prototype.hasOwnProperty;\n\nvar hexTable = (function () {\n    var array = [];\n    for (var i = 0; i < 256; ++i) {\n        array.push('%' + ((i < 16 ? '0' : '') + i.toString(16)).toUpperCase());\n    }\n\n    return array;\n}());\n\nvar compactQueue = function compactQueue(queue) {\n    var obj;\n\n    while (queue.length) {\n        var item = queue.pop();\n        obj = item.obj[item.prop];\n\n        if (Array.isArray(obj)) {\n            var compacted = [];\n\n            for (var j = 0; j < obj.length; ++j) {\n                if (typeof obj[j] !== 'undefined') {\n                    compacted.push(obj[j]);\n                }\n            }\n\n            item.obj[item.prop] = compacted;\n        }\n    }\n\n    return obj;\n};\n\nvar arrayToObject = function arrayToObject(source, options) {\n    var obj = options && options.plainObjects ? Object.create(null) : {};\n    for (var i = 0; i < source.length; ++i) {\n        if (typeof source[i] !== 'undefined') {\n            obj[i] = source[i];\n        }\n    }\n\n    return obj;\n};\n\nvar merge = function merge(target, source, options) {\n    if (!source) {\n        return target;\n    }\n\n    if (typeof source !== 'object') {\n        if (Array.isArray(target)) {\n            target.push(source);\n        } else if (typeof target === 'object') {\n            if (options.plainObjects || options.allowPrototypes || !has.call(Object.prototype, source)) {\n                target[source] = true;\n            }\n        } else {\n            return [target, source];\n        }\n\n        return target;\n    }\n\n    if (typeof target !== 'object') {\n        return [target].concat(source);\n    }\n\n    var mergeTarget = target;\n    if (Array.isArray(target) && !Array.isArray(source)) {\n        mergeTarget = arrayToObject(target, options);\n    }\n\n    if (Array.isArray(target) && Array.isArray(source)) {\n        source.forEach(function (item, i) {\n            if (has.call(target, i)) {\n                if (target[i] && typeof target[i] === 'object') {\n                    target[i] = merge(target[i], item, options);\n                } else {\n                    target.push(item);\n                }\n            } else {\n                target[i] = item;\n            }\n        });\n        return target;\n    }\n\n    return Object.keys(source).reduce(function (acc, key) {\n        var value = source[key];\n\n        if (has.call(acc, key)) {\n            acc[key] = merge(acc[key], value, options);\n        } else {\n            acc[key] = value;\n        }\n        return acc;\n    }, mergeTarget);\n};\n\nvar assign = function assignSingleSource(target, source) {\n    return Object.keys(source).reduce(function (acc, key) {\n        acc[key] = source[key];\n        return acc;\n    }, target);\n};\n\nvar decode = function (str) {\n    try {\n        return decodeURIComponent(str.replace(/\\+/g, ' '));\n    } catch (e) {\n        return str;\n    }\n};\n\nvar encode = function encode(str) {\n    // This code was originally written by Brian White (mscdex) for the io.js core querystring library.\n    // It has been adapted here for stricter adherence to RFC 3986\n    if (str.length === 0) {\n        return str;\n    }\n\n    var string = typeof str === 'string' ? str : String(str);\n\n    var out = '';\n    for (var i = 0; i < string.length; ++i) {\n        var c = string.charCodeAt(i);\n\n        if (\n            c === 0x2D // -\n            || c === 0x2E // .\n            || c === 0x5F // _\n            || c === 0x7E // ~\n            || (c >= 0x30 && c <= 0x39) // 0-9\n            || (c >= 0x41 && c <= 0x5A) // a-z\n            || (c >= 0x61 && c <= 0x7A) // A-Z\n        ) {\n            out += string.charAt(i);\n            continue;\n        }\n\n        if (c < 0x80) {\n            out = out + hexTable[c];\n            continue;\n        }\n\n        if (c < 0x800) {\n            out = out + (hexTable[0xC0 | (c >> 6)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        if (c < 0xD800 || c >= 0xE000) {\n            out = out + (hexTable[0xE0 | (c >> 12)] + hexTable[0x80 | ((c >> 6) & 0x3F)] + hexTable[0x80 | (c & 0x3F)]);\n            continue;\n        }\n\n        i += 1;\n        c = 0x10000 + (((c & 0x3FF) << 10) | (string.charCodeAt(i) & 0x3FF));\n        out += hexTable[0xF0 | (c >> 18)]\n            + hexTable[0x80 | ((c >> 12) & 0x3F)]\n            + hexTable[0x80 | ((c >> 6) & 0x3F)]\n            + hexTable[0x80 | (c & 0x3F)];\n    }\n\n    return out;\n};\n\nvar compact = function compact(value) {\n    var queue = [{ obj: { o: value }, prop: 'o' }];\n    var refs = [];\n\n    for (var i = 0; i < queue.length; ++i) {\n        var item = queue[i];\n        var obj = item.obj[item.prop];\n\n        var keys = Object.keys(obj);\n        for (var j = 0; j < keys.length; ++j) {\n            var key = keys[j];\n            var val = obj[key];\n            if (typeof val === 'object' && val !== null && refs.indexOf(val) === -1) {\n                queue.push({ obj: obj, prop: key });\n                refs.push(val);\n            }\n        }\n    }\n\n    return compactQueue(queue);\n};\n\nvar isRegExp = function isRegExp(obj) {\n    return Object.prototype.toString.call(obj) === '[object RegExp]';\n};\n\nvar isBuffer = function isBuffer(obj) {\n    if (obj === null || typeof obj === 'undefined') {\n        return false;\n    }\n\n    return !!(obj.constructor && obj.constructor.isBuffer && obj.constructor.isBuffer(obj));\n};\n\nmodule.exports = {\n    arrayToObject: arrayToObject,\n    assign: assign,\n    compact: compact,\n    decode: decode,\n    encode: encode,\n    isBuffer: isBuffer,\n    isRegExp: isRegExp,\n    merge: merge\n};\n","/**\n * This method returns a new empty array.\n *\n * @static\n * @memberOf _\n * @since 4.13.0\n * @category Util\n * @returns {Array} Returns the new empty array.\n * @example\n *\n * var arrays = _.times(2, _.stubArray);\n *\n * console.log(arrays);\n * // => [[], []]\n *\n * console.log(arrays[0] === arrays[1]);\n * // => false\n */\nfunction stubArray() {\n  return [];\n}\n\nmodule.exports = stubArray;\n","var baseIsArguments = require('./_baseIsArguments'),\n    isObjectLike = require('./isObjectLike');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/** Built-in value references. */\nvar propertyIsEnumerable = objectProto.propertyIsEnumerable;\n\n/**\n * Checks if `value` is likely an `arguments` object.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an `arguments` object,\n *  else `false`.\n * @example\n *\n * _.isArguments(function() { return arguments; }());\n * // => true\n *\n * _.isArguments([1, 2, 3]);\n * // => false\n */\nvar isArguments = baseIsArguments(function() { return arguments; }()) ? baseIsArguments : function(value) {\n  return isObjectLike(value) && hasOwnProperty.call(value, 'callee') &&\n    !propertyIsEnumerable.call(value, 'callee');\n};\n\nmodule.exports = isArguments;\n","const disallowNodeType = require('./helper').disallowNodeType;\n\nmodule.exports = disallowNodeType('bpmn:InclusiveGateway');","'use strict';\n\nvar forEach = require('lodash/forEach');\n\n/**\n * A handler that combines and executes multiple commands.\n *\n * All updates are bundled on the command stack and executed in one step.\n * This also makes it possible to revert the changes in one step.\n *\n * Example use case: remove the camunda:formKey attribute and in addition\n * add all form fields needed for the camunda:formData property.\n *\n * @class\n * @constructor\n */\nfunction MultiCommandHandler(commandStack) {\n  this._commandStack = commandStack;\n}\n\nMultiCommandHandler.$inject = [ 'commandStack' ];\n\nmodule.exports = MultiCommandHandler;\n\nMultiCommandHandler.prototype.preExecute = function(context) {\n\n  var commandStack = this._commandStack;\n\n  forEach(context, function(command) {\n    commandStack.execute(command.cmd, command.context);\n  });\n};","const {\n  is,\n  isAny\n} = require('bpmnlint-utils');\n\n\n/**\n * A rule that checks for the presence of a start event per scope.\n */\nmodule.exports = function() {\n\n  function hasStartEvent(node) {\n    const flowElements = node.flowElements || [];\n\n    return (\n      flowElements.some(node => is(node, 'bpmn:StartEvent'))\n    );\n  }\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Process',\n      'bpmn:SubProcess'\n    ])) {\n      return;\n    }\n\n    if (!hasStartEvent(node)) {\n      const type = is(node, 'bpmn:SubProcess') ? 'Sub process' : 'Process';\n\n      reporter.report(node.id, type + ' is missing start event');\n    }\n  }\n\n  return { check };\n};\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    forEach = require('lodash/forEach');\n\nvar EventDefinitionHelper = {};\n\nmodule.exports = EventDefinitionHelper;\n\nEventDefinitionHelper.getEventDefinition = function(element, eventType) {\n\n  var bo = getBusinessObject(element),\n      eventDefinition = null;\n\n  if (bo.eventDefinitions) {\n    forEach(bo.eventDefinitions, function(event) {\n      if (is(event, eventType)) {\n        eventDefinition = event;\n      }\n    });\n  }\n\n  return eventDefinition;\n};\n\nEventDefinitionHelper.getTimerEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:TimerEventDefinition');\n};\n\nEventDefinitionHelper.getMessageEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:MessageEventDefinition');\n};\n\nEventDefinitionHelper.getSignalEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:SignalEventDefinition');\n};\n\nEventDefinitionHelper.getErrorEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:ErrorEventDefinition');\n};\n\nEventDefinitionHelper.getEscalationEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:EscalationEventDefinition');\n};\n\nEventDefinitionHelper.getCompensateEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:CompensateEventDefinition');\n};\n\nEventDefinitionHelper.getLinkEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:LinkEventDefinition');\n};\n\nEventDefinitionHelper.getConditionalEventDefinition = function(element) {\n  return this.getEventDefinition(element, 'bpmn:ConditionalEventDefinition');\n};\n","var MapCache = require('./_MapCache'),\n    setCacheAdd = require('./_setCacheAdd'),\n    setCacheHas = require('./_setCacheHas');\n\n/**\n *\n * Creates an array cache object to store unique values.\n *\n * @private\n * @constructor\n * @param {Array} [values] The values to cache.\n */\nfunction SetCache(values) {\n  var index = -1,\n      length = values == null ? 0 : values.length;\n\n  this.__data__ = new MapCache;\n  while (++index < length) {\n    this.add(values[index]);\n  }\n}\n\n// Add methods to `SetCache`.\nSetCache.prototype.add = SetCache.prototype.push = setCacheAdd;\nSetCache.prototype.has = setCacheHas;\n\nmodule.exports = SetCache;\n","/**\n * The base implementation of `_.isNaN` without support for number objects.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is `NaN`, else `false`.\n */\nfunction baseIsNaN(value) {\n  return value !== value;\n}\n\nmodule.exports = baseIsNaN;\n","var root = require('./_root');\n\n/** Used to detect overreaching core-js shims. */\nvar coreJsData = root['__core-js_shared__'];\n\nmodule.exports = coreJsData;\n","/** Used to match wrap detail comments. */\nvar reWrapComment = /\\{(?:\\n\\/\\* \\[wrapped with .+\\] \\*\\/)?\\n?/;\n\n/**\n * Inserts wrapper `details` in a comment at the top of the `source` body.\n *\n * @private\n * @param {string} source The source to modify.\n * @returns {Array} details The details to insert.\n * @returns {string} Returns the modified source.\n */\nfunction insertWrapDetails(source, details) {\n  var length = details.length;\n  if (!length) {\n    return source;\n  }\n  var lastIndex = length - 1;\n  details[lastIndex] = (length > 1 ? '& ' : '') + details[lastIndex];\n  details = details.join(length > 2 ? ', ' : ' ');\n  return source.replace(reWrapComment, '{\\n/* [wrapped with ' + details + '] */\\n');\n}\n\nmodule.exports = insertWrapDetails;\n","/**\n * Checks if `value` is in the array cache.\n *\n * @private\n * @name has\n * @memberOf SetCache\n * @param {*} value The value to search for.\n * @returns {number} Returns `true` if `value` is found, else `false`.\n */\nfunction setCacheHas(value) {\n  return this.__data__.has(value);\n}\n\nmodule.exports = setCacheHas;\n","/** Used for built-in method references. */\nvar funcProto = Function.prototype;\n\n/** Used to resolve the decompiled source of functions. */\nvar funcToString = funcProto.toString;\n\n/**\n * Converts `func` to its source code.\n *\n * @private\n * @param {Function} func The function to convert.\n * @returns {string} Returns the source code.\n */\nfunction toSource(func) {\n  if (func != null) {\n    try {\n      return funcToString.call(func);\n    } catch (e) {}\n    try {\n      return (func + '');\n    } catch (e) {}\n  }\n  return '';\n}\n\nmodule.exports = toSource;\n","var isArrayLike = require('./isArrayLike'),\n    isObjectLike = require('./isObjectLike');\n\n/**\n * This method is like `_.isArrayLike` except that it also checks if `value`\n * is an object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is an array-like object,\n *  else `false`.\n * @example\n *\n * _.isArrayLikeObject([1, 2, 3]);\n * // => true\n *\n * _.isArrayLikeObject(document.body.children);\n * // => true\n *\n * _.isArrayLikeObject('abc');\n * // => false\n *\n * _.isArrayLikeObject(_.noop);\n * // => false\n */\nfunction isArrayLikeObject(value) {\n  return isObjectLike(value) && isArrayLike(value);\n}\n\nmodule.exports = isArrayLikeObject;\n","var assignValue = require('./_assignValue'),\n    copyObject = require('./_copyObject'),\n    createAssigner = require('./_createAssigner'),\n    isArrayLike = require('./isArrayLike'),\n    isPrototype = require('./_isPrototype'),\n    keys = require('./keys');\n\n/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/** Used to check objects for own properties. */\nvar hasOwnProperty = objectProto.hasOwnProperty;\n\n/**\n * Assigns own enumerable string keyed properties of source objects to the\n * destination object. Source objects are applied from left to right.\n * Subsequent sources overwrite property assignments of previous sources.\n *\n * **Note:** This method mutates `object` and is loosely based on\n * [`Object.assign`](https://mdn.io/Object/assign).\n *\n * @static\n * @memberOf _\n * @since 0.10.0\n * @category Object\n * @param {Object} object The destination object.\n * @param {...Object} [sources] The source objects.\n * @returns {Object} Returns `object`.\n * @see _.assignIn\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n * }\n *\n * function Bar() {\n *   this.c = 3;\n * }\n *\n * Foo.prototype.b = 2;\n * Bar.prototype.d = 4;\n *\n * _.assign({ 'a': 0 }, new Foo, new Bar);\n * // => { 'a': 1, 'c': 3 }\n */\nvar assign = createAssigner(function(object, source) {\n  if (isPrototype(source) || isArrayLike(source)) {\n    copyObject(source, keys(source), object);\n    return;\n  }\n  for (var key in source) {\n    if (hasOwnProperty.call(source, key)) {\n      assignValue(object, key, source[key]);\n    }\n  }\n});\n\nmodule.exports = assign;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    cmdHelper = require('./CmdHelper');\n\n\nvar ParticipantHelper = {};\n\nmodule.exports = ParticipantHelper;\n\nParticipantHelper.modifyProcessBusinessObject = function(element, property, values) {\n  if (!is(element, 'bpmn:Participant')) {\n    return {};\n  }\n\n  var bo = getBusinessObject(element).get('processRef'),\n      properties = {};\n\n  properties[property] = values[property];\n\n  return cmdHelper.updateBusinessObject(element, bo, properties);\n};\n\nParticipantHelper.getProcessBusinessObject = function(element, propertyName) {\n  if (!is(element, 'bpmn:Participant')) {\n    return {};\n  }\n\n  var bo = getBusinessObject(element).get('processRef'),\n      properties = {};\n\n  properties[propertyName] = bo.get(propertyName);\n\n  return properties;\n};","var arrayMap = require('./_arrayMap'),\n    baseIteratee = require('./_baseIteratee'),\n    baseMap = require('./_baseMap'),\n    isArray = require('./isArray');\n\n/**\n * Creates an array of values by running each element in `collection` thru\n * `iteratee`. The iteratee is invoked with three arguments:\n * (value, index|key, collection).\n *\n * Many lodash methods are guarded to work as iteratees for methods like\n * `_.every`, `_.filter`, `_.map`, `_.mapValues`, `_.reject`, and `_.some`.\n *\n * The guarded methods are:\n * `ary`, `chunk`, `curry`, `curryRight`, `drop`, `dropRight`, `every`,\n * `fill`, `invert`, `parseInt`, `random`, `range`, `rangeRight`, `repeat`,\n * `sampleSize`, `slice`, `some`, `sortBy`, `split`, `take`, `takeRight`,\n * `template`, `trim`, `trimEnd`, `trimStart`, and `words`\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Collection\n * @param {Array|Object} collection The collection to iterate over.\n * @param {Function} [iteratee=_.identity] The function invoked per iteration.\n * @returns {Array} Returns the new mapped array.\n * @example\n *\n * function square(n) {\n *   return n * n;\n * }\n *\n * _.map([4, 8], square);\n * // => [16, 64]\n *\n * _.map({ 'a': 4, 'b': 8 }, square);\n * // => [16, 64] (iteration order is not guaranteed)\n *\n * var users = [\n *   { 'user': 'barney' },\n *   { 'user': 'fred' }\n * ];\n *\n * // The `_.property` iteratee shorthand.\n * _.map(users, 'user');\n * // => ['barney', 'fred']\n */\nfunction map(collection, iteratee) {\n  var func = isArray(collection) ? arrayMap : baseMap;\n  return func(collection, baseIteratee(iteratee, 3));\n}\n\nmodule.exports = map;\n","'use strict';\n\nvar escapeHTML = require('../Utils').escapeHTML;\n\nvar domify = require('min-dom').domify;\n\nvar forEach = require('lodash/forEach');\n\nvar entryFieldDescription = require('./EntryFieldDescription');\n\n\nvar isList = function(list) {\n  return !(!list || Object.prototype.toString.call(list) !== '[object Array]');\n};\n\nvar addEmptyParameter = function(list) {\n  return list.concat([ { name: '', value: '' } ]);\n};\n\nvar createOption = function(option) {\n  return '<option value=\"' + option.value + '\">' + option.name + '</option>';\n};\n\n/**\n * @param  {Object} options\n * @param  {string} options.id\n * @param  {string} [options.label]\n * @param  {Array<Object>} options.selectOptions\n * @param  {string} options.modelProperty\n * @param  {boolean} options.emptyParameter\n * @param  {function} options.disabled\n * @param  {function} options.hidden\n * @param  {Object} defaultParameters\n *\n * @return {Object}\n */\nvar selectbox = function(options, defaultParameters) {\n  var resource = defaultParameters,\n      label = options.label || resource.id,\n      selectOptions = options.selectOptions || [ { name: '', value: '' } ],\n      modelProperty = options.modelProperty,\n      emptyParameter = options.emptyParameter,\n      canBeDisabled = !!options.disabled && typeof options.disabled === 'function',\n      canBeHidden = !!options.hidden && typeof options.hidden === 'function',\n      description = options.description;\n\n\n  if (emptyParameter) {\n    selectOptions = addEmptyParameter(selectOptions);\n  }\n\n\n  resource.html =\n    '<label for=\"camunda-' + escapeHTML(resource.id) + '\"' +\n    (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n    (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n    '>' + escapeHTML(label) + '</label>' +\n    '<select id=\"camunda-' + escapeHTML(resource.id) + '-select\" name=\"' +\n    escapeHTML(modelProperty) + '\"' +\n    (canBeDisabled ? 'data-disable=\"isDisabled\" ' : '') +\n    (canBeHidden ? 'data-show=\"isHidden\" ' : '') +\n    ' data-value>';\n\n  if (isList(selectOptions)) {\n    forEach(selectOptions, function(option) {\n      resource.html += '<option value=\"' + escapeHTML(option.value) + '\">' +\n      (option.name ? escapeHTML(option.name) : '') + '</option>';\n    });\n  }\n\n  resource.html += '</select>';\n\n  // add description below select box entry field\n  if (description && typeof options.showCustomInput !== 'function') {\n    resource.html += entryFieldDescription(description);\n  }\n\n  /**\n   * Fill the select box options dynamically.\n   *\n   * Calls the defined function #selectOptions in the entry to get the\n   * values for the options and set the value to the inputNode.\n   *\n   * @param {djs.model.Base} element\n   * @param {HTMLElement} entryNode\n   * @param {EntryDescriptor} inputNode\n   * @param {Object} inputName\n   * @param {Object} newValue\n   */\n  resource.setControlValue = function(element, entryNode, inputNode, inputName, newValue) {\n    if (typeof selectOptions === 'function') {\n\n      var options = selectOptions(element, inputNode);\n\n      if (options) {\n\n        // remove existing options\n        while (inputNode.firstChild) {\n          inputNode.removeChild(inputNode.firstChild);\n        }\n\n        // add options\n        forEach(options, function(option) {\n          var template = domify(createOption(option));\n\n          inputNode.appendChild(template);\n        });\n\n\n      }\n    }\n\n    // set select value\n    if (newValue !== undefined) {\n      inputNode.value = newValue;\n    }\n\n  };\n\n  if (canBeDisabled) {\n    resource.isDisabled = function() {\n      return options.disabled.apply(resource, arguments);\n    };\n  }\n\n  if (canBeHidden) {\n    resource.isHidden = function() {\n      return !options.hidden.apply(resource, arguments);\n    };\n  }\n\n  resource.cssClasses = ['bpp-dropdown'];\n\n  return resource;\n};\n\nmodule.exports = selectbox;\n","'use strict';\n\nvar reduce = require('lodash/transform'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    keys = require('lodash/keys'),\n    forEach = require('lodash/forEach');\n\n/**\n * A handler that implements a BPMN 2.0 property update\n * for business objects which are not represented in the\n * diagram.\n *\n * This is useful in the context of the properties panel in\n * order to update child elements of elements visible in\n * the diagram.\n *\n * Example: perform an update of a specific event definition\n * of an intermediate event.\n *\n * @class\n * @constructor\n */\nfunction UpdateBusinessObjectHandler(elementRegistry) {\n  this._elementRegistry = elementRegistry;\n}\n\nUpdateBusinessObjectHandler.$inject = [ 'elementRegistry' ];\n\nmodule.exports = UpdateBusinessObjectHandler;\n\n/**\n * returns the root element\n */\nfunction getRoot(businessObject) {\n  var parent = businessObject;\n  while (parent.$parent) {\n    parent = parent.$parent;\n  }\n  return parent;\n}\n\nfunction getProperties(businessObject, propertyNames) {\n  return reduce(propertyNames, function(result, key) {\n    result[key] = businessObject.get(key);\n    return result;\n  }, {});\n}\n\n\nfunction setProperties(businessObject, properties) {\n  forEach(properties, function(value, key) {\n    businessObject.set(key, value);\n  });\n}\n\n\n// api /////////////////////////////////////////////\n\n/**\n * Updates a business object with a list of new properties\n *\n * @method  UpdateBusinessObjectHandler#execute\n *\n * @param {Object} context\n * @param {djs.model.Base} context.element the element which has a child business object updated\n * @param {moddle.businessObject} context.businessObject the businessObject to update\n * @param {Object} context.properties a list of properties to set on the businessObject\n *\n * @return {Array<djs.mode.Base>} the updated element\n */\nUpdateBusinessObjectHandler.prototype.execute = function(context) {\n\n  var element = context.element,\n      businessObject = context.businessObject,\n      rootElements = getRoot(businessObject).rootElements,\n      referenceType = context.referenceType,\n      referenceProperty = context.referenceProperty,\n      changed = [ element ]; // this will not change any diagram-js elements\n\n  if (!element) {\n    throw new Error('element required');\n  }\n\n  if (!businessObject) {\n    throw new Error('businessObject required');\n  }\n\n  var properties = context.properties,\n      oldProperties = context.oldProperties || getProperties(businessObject, keys(properties));\n\n  // check if there the update needs an external element for reference\n  if (typeof referenceType !== 'undefined' && typeof referenceProperty !== 'undefined') {\n    forEach(rootElements, function(rootElement) {\n      if (is(rootElement, referenceType)) {\n        if (rootElement.id === properties[referenceProperty]) {\n          properties[referenceProperty] = rootElement;\n        }\n      }\n    });\n  }\n\n  // update properties\n  setProperties(businessObject, properties);\n\n  // store old values\n  context.oldProperties = oldProperties;\n  context.changed = changed;\n\n  // indicate changed on objects affected by the update\n  return changed;\n};\n\n/**\n * Reverts the update\n *\n * @method  UpdateBusinessObjectHandler#revert\n *\n * @param {Object} context\n *\n * @return {djs.mode.Base} the updated element\n */\nUpdateBusinessObjectHandler.prototype.revert = function(context) {\n\n  var oldProperties = context.oldProperties,\n      businessObject = context.businessObject;\n\n  // update properties\n  setProperties(businessObject, oldProperties);\n\n  return context.changed;\n};\n","'use strict';\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    is = ModelUtil.is,\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar eventDefinitionHelper = require('./EventDefinitionHelper');\nvar extensionsElementHelper = require('./ExtensionElementsHelper');\n\nvar ImplementationTypeHelper = {};\n\nmodule.exports = ImplementationTypeHelper;\n\n/**\n * Returns 'true' if the given element is 'camunda:ServiceTaskLike'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isServiceTaskLike = function(element) {\n  return is(element, 'camunda:ServiceTaskLike');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:DmnCapable'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isDmnCapable = function(element) {\n  return is(element, 'camunda:DmnCapable');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExternalCapable'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isExternalCapable = function(element) {\n  return is(element, 'camunda:ExternalCapable');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:TaskListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isTaskListener = function(element) {\n  return is(element, 'camunda:TaskListener');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExecutionListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isExecutionListener = function(element) {\n  return is(element, 'camunda:ExecutionListener');\n};\n\n/**\n * Returns 'true' if the given element is 'camunda:ExecutionListener' or\n * 'camunda:TaskListener'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isListener = function(element) {\n  return this.isTaskListener(element) || this.isExecutionListener(element);\n};\n\n/**\n * Returns 'true' if the given element is 'bpmn:SequenceFlow'\n *\n * @param {djs.model.Base} element\n *\n * @return {boolean} a boolean value\n */\nImplementationTypeHelper.isSequenceFlow = function(element) {\n  return is(element, 'bpmn:SequenceFlow');\n};\n\n/**\n * Get a 'camunda:ServiceTaskLike' business object.\n *\n * If the given element is not a 'camunda:ServiceTaskLike', then 'false'\n * is returned.\n *\n * @param {djs.model.Base} element\n *\n * @return {ModdleElement} the 'camunda:ServiceTaskLike' business object\n */\nImplementationTypeHelper.getServiceTaskLikeBusinessObject = function(element) {\n\n  if (is(element, 'bpmn:IntermediateThrowEvent') || is(element, 'bpmn:EndEvent')) {\n\n    // change business object to 'messageEventDefinition' when\n    // the element is a message intermediate throw event or message end event\n    // because the camunda extensions (e.g. camunda:class) are in the message\n    // event definition tag and not in the intermediate throw event or end event tag\n    var messageEventDefinition = eventDefinitionHelper.getMessageEventDefinition(element);\n    if (messageEventDefinition) {\n      element = messageEventDefinition;\n    }\n  }\n\n  return this.isServiceTaskLike(element) && getBusinessObject(element);\n\n};\n\n/**\n * Returns the implementation type of the given element.\n *\n * Possible implementation types are:\n * - dmn\n * - connector\n * - external\n * - class\n * - expression\n * - delegateExpression\n * - script\n * - or undefined, when no matching implementation type is found\n *\n * @param  {djs.model.Base} element\n *\n * @return {String} the implementation type\n */\nImplementationTypeHelper.getImplementationType = function(element) {\n\n  var bo = this.getServiceTaskLikeBusinessObject(element);\n\n  if (!bo) {\n    if (this.isListener(element)) {\n      bo = element;\n    } else {\n      return;\n    }\n  }\n\n  if (this.isDmnCapable(bo)) {\n    var decisionRef = bo.get('camunda:decisionRef');\n    if (typeof decisionRef !== 'undefined') {\n      return 'dmn';\n    }\n  }\n\n  if (this.isServiceTaskLike(bo)) {\n    var connectors = extensionsElementHelper.getExtensionElements(bo, 'camunda:Connector');\n    if (typeof connectors !== 'undefined') {\n      return 'connector';\n    }\n  }\n\n  if (this.isExternalCapable(bo)) {\n    var type = bo.get('camunda:type');\n    if (type === 'external') {\n      return 'external';\n    }\n  }\n\n  var cls = bo.get('camunda:class');\n  if (typeof cls !== 'undefined') {\n    return 'class';\n  }\n\n  var expression = bo.get('camunda:expression');\n  if (typeof expression !== 'undefined') {\n    return 'expression';\n  }\n\n  var delegateExpression = bo.get('camunda:delegateExpression');\n  if (typeof delegateExpression !== 'undefined') {\n    return 'delegateExpression';\n  }\n\n  if (this.isListener(bo)) {\n    var script = bo.get('script');\n    if (typeof script !== 'undefined') {\n      return 'script';\n    }\n  }\n\n};\n","var hashClear = require('./_hashClear'),\n    hashDelete = require('./_hashDelete'),\n    hashGet = require('./_hashGet'),\n    hashHas = require('./_hashHas'),\n    hashSet = require('./_hashSet');\n\n/**\n * Creates a hash object.\n *\n * @private\n * @constructor\n * @param {Array} [entries] The key-value pairs to cache.\n */\nfunction Hash(entries) {\n  var index = -1,\n      length = entries == null ? 0 : entries.length;\n\n  this.clear();\n  while (++index < length) {\n    var entry = entries[index];\n    this.set(entry[0], entry[1]);\n  }\n}\n\n// Add methods to `Hash`.\nHash.prototype.clear = hashClear;\nHash.prototype['delete'] = hashDelete;\nHash.prototype.get = hashGet;\nHash.prototype.has = hashHas;\nHash.prototype.set = hashSet;\n\nmodule.exports = Hash;\n","var castPath = require('./_castPath'),\n    isArguments = require('./isArguments'),\n    isArray = require('./isArray'),\n    isIndex = require('./_isIndex'),\n    isLength = require('./isLength'),\n    toKey = require('./_toKey');\n\n/**\n * Checks if `path` exists on `object`.\n *\n * @private\n * @param {Object} object The object to query.\n * @param {Array|string} path The path to check.\n * @param {Function} hasFunc The function to check properties.\n * @returns {boolean} Returns `true` if `path` exists, else `false`.\n */\nfunction hasPath(object, path, hasFunc) {\n  path = castPath(path, object);\n\n  var index = -1,\n      length = path.length,\n      result = false;\n\n  while (++index < length) {\n    var key = toKey(path[index]);\n    if (!(result = object != null && hasFunc(object, key))) {\n      break;\n    }\n    object = object[key];\n  }\n  if (result || ++index != length) {\n    return result;\n  }\n  length = object == null ? 0 : object.length;\n  return !!length && isLength(length) && isIndex(key, length) &&\n    (isArray(object) || isArguments(object));\n}\n\nmodule.exports = hasPath;\n","var isArray = require('./isArray'),\n    isKey = require('./_isKey'),\n    stringToPath = require('./_stringToPath'),\n    toString = require('./toString');\n\n/**\n * Casts `value` to a path array if it's not one.\n *\n * @private\n * @param {*} value The value to inspect.\n * @param {Object} [object] The object to query keys on.\n * @returns {Array} Returns the cast property path array.\n */\nfunction castPath(value, object) {\n  if (isArray(value)) {\n    return value;\n  }\n  return isKey(value, object) ? [value] : stringToPath(toString(value));\n}\n\nmodule.exports = castPath;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar asyncCapableHelper = require('../../../../helper/AsyncCapableHelper'),\n    eventDefinitionHelper = require('../../../../helper/EventDefinitionHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nfunction isAsyncBefore(bo) {\n  return asyncCapableHelper.isAsyncBefore(bo);\n}\n\nfunction isAsyncAfter(bo) {\n  return asyncCapableHelper.isAsyncAfter(bo);\n}\n\nfunction isExclusive(bo) {\n  return asyncCapableHelper.isExclusive(bo);\n}\n\nfunction removeFailedJobRetryTimeCycle(bo, element) {\n  return asyncCapableHelper.removeFailedJobRetryTimeCycle(bo, element);\n}\n\nfunction canRemoveFailedJobRetryTimeCycle(element) {\n  return !eventDefinitionHelper.getTimerEventDefinition(element);\n}\n\nmodule.exports = function(element, bpmnFactory, options, translate) {\n\n  var getBusinessObject = options.getBusinessObject;\n\n  var idPrefix = options.idPrefix || '',\n      labelPrefix = options.labelPrefix || '';\n\n\n  var asyncBeforeEntry = entryFactory.checkbox({\n    id: idPrefix + 'asyncBefore',\n    label: labelPrefix + translate('Asynchronous Before'),\n    modelProperty: 'asyncBefore',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        asyncBefore: isAsyncBefore(bo)\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      var asyncBefore = !!values.asyncBefore;\n\n      var props = {\n        'camunda:asyncBefore': asyncBefore,\n        'camunda:async': false\n      };\n\n      var commands = [];\n      if (!isAsyncAfter(bo) && !asyncBefore) {\n        props = assign({ 'camunda:exclusive' : true }, props);\n        if (canRemoveFailedJobRetryTimeCycle(element)) {\n          commands.push(removeFailedJobRetryTimeCycle(bo, element));\n        }\n      }\n\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n      return commands;\n    }\n  });\n\n\n  var asyncAfterEntry = entryFactory.checkbox({\n    id: idPrefix + 'asyncAfter',\n    label: labelPrefix + translate('Asynchronous After'),\n    modelProperty: 'asyncAfter',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return {\n        asyncAfter: isAsyncAfter(bo)\n      };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      var asyncAfter = !!values.asyncAfter;\n\n      var props = {\n        'camunda:asyncAfter': asyncAfter\n      };\n\n      var commands = [];\n      if (!isAsyncBefore(bo) && !asyncAfter) {\n        props = assign({ 'camunda:exclusive' : true }, props);\n        if (canRemoveFailedJobRetryTimeCycle(element)) {\n          commands.push(removeFailedJobRetryTimeCycle(bo, element));\n        }\n      }\n\n      commands.push(cmdHelper.updateBusinessObject(element, bo, props));\n      return commands;\n    }\n  });\n\n\n  var exclusiveEntry = entryFactory.checkbox({\n    id: idPrefix + 'exclusive',\n    label: labelPrefix + translate('Exclusive'),\n    modelProperty: 'exclusive',\n\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n      return { exclusive: isExclusive(bo) };\n    },\n\n    set: function(element, values) {\n      var bo = getBusinessObject(element);\n      return cmdHelper.updateBusinessObject(element, bo, { 'camunda:exclusive': !!values.exclusive });\n    },\n\n    hidden: function(element) {\n      var bo = getBusinessObject(element);\n      return bo && !isAsyncAfter(bo) && !isAsyncBefore(bo);\n    }\n  });\n\n  return [ asyncBeforeEntry, asyncAfterEntry, exclusiveEntry ];\n};\n","const Linter = require('./linter');\n\nmodule.exports = {\n  Linter\n};","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    isAny = require('bpmn-js/lib/features/modeling/util/ModelingUtil').isAny;\n\nvar find = require('lodash/find');\n\n\nvar TEMPLATE_ATTR = 'camunda:modelerTemplate';\n\n/**\n * The BPMN 2.0 extension attribute name under\n * which the element template is stored.\n *\n * @type {String}\n */\nmodule.exports.TEMPLATE_ATTR = TEMPLATE_ATTR;\n\n\n/**\n * Get template id for a given diagram element.\n *\n * @param {djs.model.Base} element\n *\n * @return {String}\n */\nfunction getTemplateId(element) {\n\n  var bo = getBusinessObject(element);\n\n  if (bo) {\n    return bo.get(TEMPLATE_ATTR);\n  }\n}\n\nmodule.exports.getTemplateId = getTemplateId;\n\n\n/**\n * Get template of a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getTemplate(element, elementTemplates) {\n  var id = getTemplateId(element);\n\n  return id && elementTemplates.get(id);\n}\n\nmodule.exports.getTemplate = getTemplate;\n\n/**\n * Get default template for a given element.\n *\n * @param {Element} element\n * @param {ElementTemplates} elementTemplates\n *\n * @return {TemplateDefinition}\n */\nfunction getDefaultTemplate(element, elementTemplates) {\n\n  // return first default template, if any exists\n  return (\n    elementTemplates.getAll().filter(function(t) {\n      return isAny(element, t.appliesTo) && t.isDefault;\n    })\n  )[0];\n}\n\nmodule.exports.getDefaultTemplate = getDefaultTemplate;\n\n\n/**\n * Find extension with given type in\n * BPMN element, diagram element or ExtensionElement.\n *\n * @param {ModdleElement|djs.model.Base} element\n * @param {String} type\n *\n * @return {ModdleElement} the extension\n */\nfunction findExtension(element, type) {\n  var bo = getBusinessObject(element);\n\n  var extensionElements;\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    extensionElements = bo;\n  } else {\n    extensionElements = bo.extensionElements;\n  }\n\n  if (!extensionElements) {\n    return null;\n  }\n\n  return find(extensionElements.get('values'), function(e) {\n    return is(e, type);\n  });\n}\n\nmodule.exports.findExtension = findExtension;\n\n\nfunction findExtensions(element, types) {\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return [];\n  }\n\n  return extensionElements.get('values').filter(function(e) {\n    return isAny(e, types);\n  });\n}\n\nmodule.exports.findExtensions = findExtensions;\n\n\nfunction findCamundaInOut(element, binding) {\n\n  var extensionElements = getExtensionElements(element);\n\n  if (!extensionElements) {\n    return;\n  }\n\n  var matcher;\n\n  if (binding.type === 'camunda:in') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:out') {\n    matcher = function(e) {\n      return is(e, 'camunda:Out') && isInOut(e, binding);\n    };\n  } else\n  if (binding.type === 'camunda:in:businessKey') {\n    matcher = function(e) {\n      return is(e, 'camunda:In') && 'businessKey' in e;\n    };\n  }\n\n  return find(extensionElements.get('values'), matcher);\n}\n\nmodule.exports.findCamundaInOut = findCamundaInOut;\n\nfunction findCamundaProperty(camundaProperties, binding) {\n  return find(camundaProperties.get('values'), function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findCamundaProperty = findCamundaProperty;\n\n\nfunction findInputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('inputParameters');\n\n  return find(parameters, function(p) {\n    return p.name === binding.name;\n  });\n}\n\nmodule.exports.findInputParameter = findInputParameter;\n\n\nfunction findOutputParameter(inputOutput, binding) {\n  var parameters = inputOutput.get('outputParameters');\n\n  return find(parameters, function(p) {\n    var value = p.value;\n\n    if (!binding.scriptFormat) {\n      return value === binding.source;\n    }\n\n    var definition = p.definition;\n\n    if (!definition || binding.scriptFormat !== definition.scriptFormat) {\n      return false;\n    }\n\n    return definition.value === binding.source;\n  });\n}\n\nmodule.exports.findOutputParameter = findOutputParameter;\n\n\n\n// helpers /////////////////////////////////\n\nfunction getExtensionElements(element) {\n  var bo = getBusinessObject(element);\n\n  if (is(bo, 'bpmn:ExtensionElements')) {\n    return bo;\n  } else {\n    return bo.extensionElements;\n  }\n}\n\n\nfunction isInOut(element, binding) {\n\n  if (binding.type === 'camunda:in') {\n    // find based on target attribute\n    if (binding.target) {\n      return element.target === binding.target;\n    }\n  }\n\n  if (binding.type === 'camunda:out') {\n    // find based on source / sourceExpression\n    if (binding.source) {\n      return element.source === binding.source;\n    }\n\n    if (binding.sourceExpression) {\n      return element.sourceExpression === binding.sourceExpression;\n    }\n  }\n\n  // find based variables / local combination\n  if (binding.variables) {\n    return element.variables === 'all' && (\n      binding.variables !== 'local' || element.local\n    );\n  }\n}\n","var MapCache = require('./_MapCache');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/**\n * Creates a function that memoizes the result of `func`. If `resolver` is\n * provided, it determines the cache key for storing the result based on the\n * arguments provided to the memoized function. By default, the first argument\n * provided to the memoized function is used as the map cache key. The `func`\n * is invoked with the `this` binding of the memoized function.\n *\n * **Note:** The cache is exposed as the `cache` property on the memoized\n * function. Its creation may be customized by replacing the `_.memoize.Cache`\n * constructor with one whose instances implement the\n * [`Map`](http://ecma-international.org/ecma-262/7.0/#sec-properties-of-the-map-prototype-object)\n * method interface of `clear`, `delete`, `get`, `has`, and `set`.\n *\n * @static\n * @memberOf _\n * @since 0.1.0\n * @category Function\n * @param {Function} func The function to have its output memoized.\n * @param {Function} [resolver] The function to resolve the cache key.\n * @returns {Function} Returns the new memoized function.\n * @example\n *\n * var object = { 'a': 1, 'b': 2 };\n * var other = { 'c': 3, 'd': 4 };\n *\n * var values = _.memoize(_.values);\n * values(object);\n * // => [1, 2]\n *\n * values(other);\n * // => [3, 4]\n *\n * object.a = 2;\n * values(object);\n * // => [1, 2]\n *\n * // Modify the result cache.\n * values.cache.set(object, ['a', 'b']);\n * values(object);\n * // => ['a', 'b']\n *\n * // Replace `_.memoize.Cache`.\n * _.memoize.Cache = WeakMap;\n */\nfunction memoize(func, resolver) {\n  if (typeof func != 'function' || (resolver != null && typeof resolver != 'function')) {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var memoized = function() {\n    var args = arguments,\n        key = resolver ? resolver.apply(this, args) : args[0],\n        cache = memoized.cache;\n\n    if (cache.has(key)) {\n      return cache.get(key);\n    }\n    var result = func.apply(this, args);\n    memoized.cache = cache.set(key, result) || cache;\n    return result;\n  };\n  memoized.cache = new (memoize.Cache || MapCache);\n  return memoized;\n}\n\n// Expose `MapCache`.\nmemoize.Cache = MapCache;\n\nmodule.exports = memoize;\n","var baseGet = require('./_baseGet');\n\n/**\n * A specialized version of `baseProperty` which supports deep paths.\n *\n * @private\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction basePropertyDeep(path) {\n  return function(object) {\n    return baseGet(object, path);\n  };\n}\n\nmodule.exports = basePropertyDeep;\n","export {\n  default as escapeCSS\n} from 'css.escape';\n\nvar HTML_ESCAPE_MAP = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  '\\'': '&#39;'\n};\n\nexport function escapeHTML(str) {\n  str = '' + str;\n\n  return str && str.replace(/[&<>\"']/g, function(match) {\n    return HTML_ESCAPE_MAP[match];\n  });\n}\n","import { Linter } from 'bpmnlint';\nimport { reduce, groupBy, assign } from 'min-dash';\nimport { domify } from 'min-dom';\nimport { escapeHTML } from 'diagram-js/lib/util/EscapeUtil';\n\nfunction EditorActions(injector, linting) {\n  var editorActions = injector.get('editorActions', false);\n\n  editorActions && editorActions.register({\n    toggleLinting: function() {\n      linting.toggle();\n    }\n  });\n}\n\nEditorActions.$inject = [\n  'injector',\n  'linting'\n];\n\nvar ErrorSvg = \"<svg width=\\\"12\\\" height=\\\"12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 352 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M242.72 256l100.07-100.07c12.28-12.28 12.28-32.19 0-44.48l-22.24-22.24c-12.28-12.28-32.19-12.28-44.48 0L176 189.28 75.93 89.21c-12.28-12.28-32.19-12.28-44.48 0L9.21 111.45c-12.28 12.28-12.28 32.19 0 44.48L109.28 256 9.21 356.07c-12.28 12.28-12.28 32.19 0 44.48l22.24 22.24c12.28 12.28 32.2 12.28 44.48 0L176 322.72l100.07 100.07c12.28 12.28 32.2 12.28 44.48 0l22.24-22.24c12.28-12.28 12.28-32.19 0-44.48L242.72 256z\\\"></path></svg>\";\n\nvar WarningSvg = \"<svg xmlns=\\\"http://www.w3.org/2000/svg\\\" width=\\\"12\\\" height=\\\"12\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M288 328.83c-45.518 0-82.419 34.576-82.419 77.229 0 42.652 36.9 77.229 82.419 77.229 45.518 0 82.419-34.577 82.419-77.23 0-42.652-36.9-77.229-82.419-77.229zM207.439 57.034l11.61 204.348c.544 9.334 8.78 16.64 18.755 16.64h100.392c9.975 0 18.211-7.306 18.754-16.64l11.611-204.348c.587-10.082-7.98-18.56-18.754-18.56H226.192c-10.775 0-19.34 8.478-18.753 18.56z\\\"/></svg>\";\n\nvar SuccessSvg = \"<svg width=\\\"12\\\" height=\\\"12\\\" xmlns=\\\"http://www.w3.org/2000/svg\\\" viewBox=\\\"0 0 512 512\\\"><path fill=\\\"currentColor\\\" d=\\\"M173.898 439.404l-166.4-166.4c-9.997-9.997-9.997-26.206 0-36.204l36.203-36.204c9.997-9.998 26.207-9.998 36.204 0L192 312.69 432.095 72.596c9.997-9.997 26.207-9.997 36.204 0l36.203 36.204c9.997 9.997 9.997 26.206 0 36.204l-294.4 294.401c-9.998 9.997-26.207 9.997-36.204-.001z\\\"></path></svg>\";\n\nvar OFFSET_TOP = -7,\r\n    OFFSET_RIGHT = -7;\r\n\r\nvar LOW_PRIORITY = 500;\r\n\r\nvar emptyConfig = {\r\n  resolver: {\r\n    resolveRule: function() {\r\n      return null;\r\n    }\r\n  },\r\n  config: {}\r\n};\r\n\r\nvar stateToIcon = {\r\n  error: ErrorSvg,\r\n  warning: WarningSvg,\r\n  success: SuccessSvg,\r\n  inactive: SuccessSvg\r\n};\r\n\r\nfunction Linting(\r\n    bpmnjs,\r\n    canvas,\r\n    config,\r\n    elementRegistry,\r\n    eventBus,\r\n    overlays,\r\n    translate\r\n) {\r\n  this._bpmnjs = bpmnjs;\r\n  this._canvas = canvas;\r\n  this._elementRegistry = elementRegistry;\r\n  this._eventBus = eventBus;\r\n  this._overlays = overlays;\r\n  this._translate = translate;\r\n\r\n  this._issues = {};\r\n\r\n  this._active = config && config.active || false;\r\n  this._linterConfig = emptyConfig;\r\n\r\n  this._overlayIds = {};\r\n\r\n  var self = this;\r\n\r\n  eventBus.on([\r\n    'import.done',\r\n    'elements.changed',\r\n    'linting.configChanged',\r\n    'linting.toggle'\r\n  ], LOW_PRIORITY, function(e) {\r\n    if (self.isActive()) {\r\n      self.update();\r\n    }\r\n  });\r\n\r\n  eventBus.on('linting.toggle', function(event) {\r\n\r\n    const active = event.active;\r\n\r\n    if (!active) {\r\n      self._clearIssues();\r\n      self._updateButton();\r\n    }\r\n  });\r\n\r\n  eventBus.on('diagram.clear', function() {\r\n    self._clearIssues();\r\n  });\r\n\r\n  var linterConfig = config && config.bpmnlint;\r\n\r\n  linterConfig && eventBus.once('diagram.init', function() {\r\n\r\n    // bail out if config was already provided\r\n    // during initialization of other modules\r\n    if (self.getLinterConfig() !== emptyConfig) {\r\n      return;\r\n    }\r\n\r\n    try {\r\n      self.setLinterConfig(linterConfig);\r\n    } catch (err) {\r\n      console.error(\r\n        '[bpmn-js-bpmnlint] Invalid lint rules configured. ' +\r\n        'Please doublecheck your linting.bpmnlint configuration, ' +\r\n        'cf. https://github.com/bpmn-io/bpmn-js-bpmnlint#configure-lint-rules'\r\n      );\r\n    }\r\n  });\r\n\r\n  this._init();\r\n}\r\n\r\nLinting.prototype.setLinterConfig = function(linterConfig) {\r\n\r\n  if (!linterConfig.config || !linterConfig.resolver) {\r\n    throw new Error('Expected linterConfig = { config, resolver }');\r\n  }\r\n\r\n  this._linterConfig = linterConfig;\r\n\r\n  this._eventBus.fire('linting.configChanged');\r\n};\r\n\r\nLinting.prototype.getLinterConfig = function() {\r\n  return this._linterConfig;\r\n};\r\n\r\nLinting.prototype._init = function() {\r\n  this._createButton();\r\n\r\n  this._updateButton();\r\n};\r\n\r\nLinting.prototype.isActive = function() {\r\n  return this._active;\r\n};\r\n\r\nLinting.prototype._formatIssues = function(issues) {\r\n\r\n  const reports = reduce(issues, function(reports, ruleReports, rule) {\r\n\r\n    return reports.concat(ruleReports.map(function(report) {\r\n      report.rule = rule;\r\n\r\n      return report;\r\n    }));\r\n\r\n  }, []);\r\n\r\n  return groupBy(reports, function(report) {\r\n    return report.id;\r\n  });\r\n};\r\n\r\n/**\r\n * Toggle linting on or off.\r\n *\r\n * @param {boolean} [newActive]\r\n *\r\n * @return {boolean} the new active state\r\n */\r\nLinting.prototype.toggle = function(newActive) {\r\n\r\n  newActive = typeof newActive === 'undefined' ? !this.isActive() : newActive;\r\n\r\n  this._setActive(newActive);\r\n\r\n  return newActive;\r\n};\r\n\r\nLinting.prototype._setActive = function(active) {\r\n\r\n  if (this._active === active) {\r\n    return;\r\n  }\r\n\r\n  this._active = active;\r\n\r\n  this._eventBus.fire('linting.toggle', { active: active });\r\n};\r\n\r\n/**\r\n * Update overlays. Always lint and check wether overlays need update or not.\r\n */\r\nLinting.prototype.update = function() {\r\n  var self = this;\r\n\r\n  var definitions = this._bpmnjs.getDefinitions();\r\n\r\n  if (!definitions) {\r\n    return;\r\n  }\r\n\r\n  var lintStart = this._lintStart = Math.random();\r\n\r\n  this.lint().then(function(newIssues) {\r\n\r\n    if (self._lintStart !== lintStart) {\r\n      return;\r\n    }\r\n\r\n    newIssues = self._formatIssues(newIssues);\r\n\r\n    var remove = {},\r\n        update = {},\r\n        add = {};\r\n\r\n    for (var id1 in self._issues) {\r\n      if (!newIssues[id1]) {\r\n        remove[id1] = self._issues[id1];\r\n      }\r\n    }\r\n\r\n    for (var id2 in newIssues) {\r\n      if (!self._issues[id2]) {\r\n        add[id2] = newIssues[id2];\r\n      } else {\r\n        if (newIssues[id2] !== self._issues[id2]) {\r\n          update[id2] = newIssues[id2];\r\n        }\r\n      }\r\n    }\r\n\r\n    remove = assign(remove, update);\r\n    add = assign(add, update);\r\n\r\n    self._clearOverlays();\r\n    self._createIssues(add);\r\n\r\n    self._issues = newIssues;\r\n\r\n    self._updateButton();\r\n\r\n    self._fireComplete(newIssues);\r\n  });\r\n};\r\n\r\nLinting.prototype._fireComplete = function(issues) {\r\n  this._eventBus.fire('linting.completed', { issues: issues });\r\n};\r\n\r\nLinting.prototype._createIssues = function(issues) {\r\n  for (var id in issues) {\r\n    this._createElementIssues(id, issues[id]);\r\n  }\r\n};\r\n\r\n/**\r\n * Create overlays for an elements issues.\r\n *\r\n * @param {string} elementId - Elements ID.\r\n * @param {Array} elementIssues - All element issues including warnings and errors.\r\n */\r\nLinting.prototype._createElementIssues = function(elementId, elementIssues) {\r\n  var element = this._elementRegistry.get(elementId);\r\n\r\n  if (!element) {\r\n    return;\r\n  }\r\n\r\n  var menuPosition;\r\n  var position;\r\n\r\n  if (element === this._canvas.getRootElement()) {\r\n    menuPosition = 'bottom-right';\r\n\r\n    position = {\r\n      top: 20,\r\n      left: 150\r\n    };\r\n  } else {\r\n    menuPosition = 'top-right';\r\n\r\n    position = {\r\n      top: OFFSET_TOP,\r\n      left: OFFSET_RIGHT\r\n    };\r\n  }\r\n\r\n  var issuesByType = groupBy(elementIssues, function(elementIssue) {\r\n    return elementIssue.category;\r\n  });\r\n\r\n  var errors = issuesByType.error,\r\n      warnings = issuesByType.warn;\r\n\r\n  if (!errors && !warnings) {\r\n    return;\r\n  }\r\n\r\n  var $html = domify(\r\n    '<div class=\"bjsl-overlay bjsl-issues-' + menuPosition + '\"></div>'\r\n  );\r\n\r\n  var $icon = errors\r\n    ? domify('<div class=\"bjsl-icon bjsl-icon-error\">' + ErrorSvg + '</div>')\r\n    : domify('<div class=\"bjsl-icon bjsl-icon-warning\">' + WarningSvg + '</div>');\r\n\r\n  var $dropdown = domify('<div class=\"bjsl-dropdown\"></div>');\r\n  var $dropdownContent = domify('<div class=\"bjsl-dropdown-content\"></div>');\r\n  var $issues = domify('<div class=\"bjsl-issues\"></div>');\r\n  var $issueList = domify('<ul></ul>');\r\n\r\n  $html.appendChild($icon);\r\n  $html.appendChild($dropdown);\r\n\r\n  $dropdown.appendChild($dropdownContent);\r\n  $dropdownContent.appendChild($issues);\r\n\r\n  $issues.appendChild($issueList);\r\n\r\n  if (errors) {\r\n    this._addErrors($issueList, errors);\r\n  }\r\n\r\n  if (warnings) {\r\n    this._addWarnings($issueList, warnings);\r\n  }\r\n\r\n  this._overlayIds[elementId] = this._overlays.add(element, 'linting', {\r\n    position: position,\r\n    html: $html,\r\n    scale: {\r\n      min: .9\r\n    }\r\n  });\r\n};\r\n\r\nLinting.prototype._addErrors = function($ul, errors) {\r\n\r\n  var self = this;\r\n\r\n  errors.forEach(function(error) {\r\n    self._addEntry($ul, 'error', error);\r\n  });\r\n};\r\n\r\nLinting.prototype._addWarnings = function($ul, warnings) {\r\n\r\n  var self = this;\r\n\r\n  warnings.forEach(function(error) {\r\n    self._addEntry($ul, 'warning', error);\r\n  });\r\n};\r\n\r\nLinting.prototype._addEntry = function($ul, state, entry) {\r\n\r\n  var rule = entry.rule,\r\n      message = this._translate(entry.message);\r\n\r\n  var icon = stateToIcon[state];\r\n\r\n  var $entry = domify(\r\n    '<li class=\"' + state + '\">' +\r\n      icon +\r\n      '<a title=\"' + escapeHTML(rule) + ': ' + escapeHTML(message) + '\" ' +\r\n         'data-rule=\"' + escapeHTML(rule) + '\" ' +\r\n         'data-message=\"' + escapeHTML(message) + '\"' +\r\n      '>' +\r\n        escapeHTML(message) +\r\n      '</a>' +\r\n    '</li>'\r\n  );\r\n\r\n  $ul.appendChild($entry);\r\n};\r\n\r\nLinting.prototype._clearOverlays = function() {\r\n  this._overlays.remove({ type: 'linting' });\r\n\r\n  this._overlayIds = {};\r\n};\r\n\r\nLinting.prototype._clearIssues = function() {\r\n  this._issues = {};\r\n\r\n  this._clearOverlays();\r\n};\r\n\r\nLinting.prototype._setButtonState = function(state, errors, warnings) {\r\n  var button = this._button;\r\n\r\n  var icon = stateToIcon[state];\r\n\r\n  var html = icon + '<span>' + this._translate('{errors} Errors, {warnings} Warnings', { errors: errors.toString(), warnings: warnings.toString() }) + '</span>';\r\n\r\n  [\r\n    'error',\r\n    'inactive',\r\n    'success',\r\n    'warning'\r\n  ].forEach(function(s) {\r\n    if (state === s) {\r\n      button.classList.add('bjsl-button-' + s);\r\n    } else {\r\n      button.classList.remove('bjsl-button-' + s);\r\n    }\r\n  });\r\n\r\n  button.innerHTML = html;\r\n};\r\n\r\nLinting.prototype._updateButton = function() {\r\n\r\n  if (!this.isActive()) {\r\n    this._setButtonState('inactive', 0, 0);\r\n\r\n    return;\r\n  }\r\n\r\n  var errors = 0,\r\n      warnings = 0;\r\n\r\n  for (var id in this._issues) {\r\n    this._issues[id].forEach(function(issue) {\r\n      if (issue.category === 'error') {\r\n        errors++;\r\n      } else if (issue.category === 'warn') {\r\n        warnings++;\r\n      }\r\n    });\r\n  }\r\n\r\n  var state = (errors && 'error') || (warnings && 'warning') || 'success';\r\n\r\n  this._setButtonState(state, errors, warnings);\r\n};\r\n\r\nLinting.prototype._createButton = function() {\r\n\r\n  var self = this;\r\n\r\n  this._button = domify(\r\n    '<button class=\"bjsl-button bjsl-button-inactive\" title=\"' + this._translate('Toggle linting') + '\"></button>'\r\n  );\r\n\r\n  this._button.addEventListener('click', function() {\r\n    self.toggle();\r\n  });\r\n\r\n  this._canvas.getContainer().appendChild(this._button);\r\n};\r\n\r\nLinting.prototype.lint = function() {\r\n  var definitions = this._bpmnjs.getDefinitions();\r\n\r\n  var linter = new Linter(this._linterConfig);\r\n\r\n  return linter.lint(definitions);\r\n};\r\n\r\nLinting.$inject = [\r\n  'bpmnjs',\r\n  'canvas',\r\n  'config.linting',\r\n  'elementRegistry',\r\n  'eventBus',\r\n  'overlays',\r\n  'translate'\r\n];\n\nvar index = {\r\n  __init__: [ 'linting', 'lintingEditorActions' ],\r\n  linting: [ 'type', Linting ],\r\n  lintingEditorActions: ['type', EditorActions ]\r\n};\n\nexport default index;\n//# sourceMappingURL=index.esm.js.map\n","var isLaziable = require('./_isLaziable'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_BOUND_FLAG = 4,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/**\n * Creates a function that wraps `func` to continue currying.\n *\n * @private\n * @param {Function} func The function to wrap.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @param {Function} wrapFunc The function to create the `func` wrapper.\n * @param {*} placeholder The placeholder value.\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to prepend to those provided to\n *  the new function.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createRecurry(func, bitmask, wrapFunc, placeholder, thisArg, partials, holders, argPos, ary, arity) {\n  var isCurry = bitmask & WRAP_CURRY_FLAG,\n      newHolders = isCurry ? holders : undefined,\n      newHoldersRight = isCurry ? undefined : holders,\n      newPartials = isCurry ? partials : undefined,\n      newPartialsRight = isCurry ? undefined : partials;\n\n  bitmask |= (isCurry ? WRAP_PARTIAL_FLAG : WRAP_PARTIAL_RIGHT_FLAG);\n  bitmask &= ~(isCurry ? WRAP_PARTIAL_RIGHT_FLAG : WRAP_PARTIAL_FLAG);\n\n  if (!(bitmask & WRAP_CURRY_BOUND_FLAG)) {\n    bitmask &= ~(WRAP_BIND_FLAG | WRAP_BIND_KEY_FLAG);\n  }\n  var newData = [\n    func, bitmask, thisArg, newPartials, newHolders, newPartialsRight,\n    newHoldersRight, argPos, ary, arity\n  ];\n\n  var result = wrapFunc.apply(undefined, newData);\n  if (isLaziable(func)) {\n    setData(result, newData);\n  }\n  result.placeholder = placeholder;\n  return setWrapToString(result, func, bitmask);\n}\n\nmodule.exports = createRecurry;\n","/*! https://mths.be/cssescape v1.5.1 by @mathias | MIT license */\n;(function(root, factory) {\n\t// https://github.com/umdjs/umd/blob/master/returnExports.js\n\tif (typeof exports == 'object') {\n\t\t// For Node.js.\n\t\tmodule.exports = factory(root);\n\t} else if (typeof define == 'function' && define.amd) {\n\t\t// For AMD. Register as an anonymous module.\n\t\tdefine([], factory.bind(root, root));\n\t} else {\n\t\t// For browser globals (not exposing the function separately).\n\t\tfactory(root);\n\t}\n}(typeof global != 'undefined' ? global : this, function(root) {\n\n\tif (root.CSS && root.CSS.escape) {\n\t\treturn root.CSS.escape;\n\t}\n\n\t// https://drafts.csswg.org/cssom/#serialize-an-identifier\n\tvar cssEscape = function(value) {\n\t\tif (arguments.length == 0) {\n\t\t\tthrow new TypeError('`CSS.escape` requires an argument.');\n\t\t}\n\t\tvar string = String(value);\n\t\tvar length = string.length;\n\t\tvar index = -1;\n\t\tvar codeUnit;\n\t\tvar result = '';\n\t\tvar firstCodeUnit = string.charCodeAt(0);\n\t\twhile (++index < length) {\n\t\t\tcodeUnit = string.charCodeAt(index);\n\t\t\t// Note: there’s no need to special-case astral symbols, surrogate\n\t\t\t// pairs, or lone surrogates.\n\n\t\t\t// If the character is NULL (U+0000), then the REPLACEMENT CHARACTER\n\t\t\t// (U+FFFD).\n\t\t\tif (codeUnit == 0x0000) {\n\t\t\t\tresult += '\\uFFFD';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is in the range [\\1-\\1F] (U+0001 to U+001F) or is\n\t\t\t\t// U+007F, […]\n\t\t\t\t(codeUnit >= 0x0001 && codeUnit <= 0x001F) || codeUnit == 0x007F ||\n\t\t\t\t// If the character is the first character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039), […]\n\t\t\t\t(index == 0 && codeUnit >= 0x0030 && codeUnit <= 0x0039) ||\n\t\t\t\t// If the character is the second character and is in the range [0-9]\n\t\t\t\t// (U+0030 to U+0039) and the first character is a `-` (U+002D), […]\n\t\t\t\t(\n\t\t\t\t\tindex == 1 &&\n\t\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 &&\n\t\t\t\t\tfirstCodeUnit == 0x002D\n\t\t\t\t)\n\t\t\t) {\n\t\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character-as-code-point\n\t\t\t\tresult += '\\\\' + codeUnit.toString(16) + ' ';\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\tif (\n\t\t\t\t// If the character is the first character and is a `-` (U+002D), and\n\t\t\t\t// there is no second character, […]\n\t\t\t\tindex == 0 &&\n\t\t\t\tlength == 1 &&\n\t\t\t\tcodeUnit == 0x002D\n\t\t\t) {\n\t\t\t\tresult += '\\\\' + string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// If the character is not handled by one of the above rules and is\n\t\t\t// greater than or equal to U+0080, is `-` (U+002D) or `_` (U+005F), or\n\t\t\t// is in one of the ranges [0-9] (U+0030 to U+0039), [A-Z] (U+0041 to\n\t\t\t// U+005A), or [a-z] (U+0061 to U+007A), […]\n\t\t\tif (\n\t\t\t\tcodeUnit >= 0x0080 ||\n\t\t\t\tcodeUnit == 0x002D ||\n\t\t\t\tcodeUnit == 0x005F ||\n\t\t\t\tcodeUnit >= 0x0030 && codeUnit <= 0x0039 ||\n\t\t\t\tcodeUnit >= 0x0041 && codeUnit <= 0x005A ||\n\t\t\t\tcodeUnit >= 0x0061 && codeUnit <= 0x007A\n\t\t\t) {\n\t\t\t\t// the character itself\n\t\t\t\tresult += string.charAt(index);\n\t\t\t\tcontinue;\n\t\t\t}\n\n\t\t\t// Otherwise, the escaped character.\n\t\t\t// https://drafts.csswg.org/cssom/#escape-a-character\n\t\t\tresult += '\\\\' + string.charAt(index);\n\n\t\t}\n\t\treturn result;\n\t};\n\n\tif (!root.CSS) {\n\t\troot.CSS = {};\n\t}\n\n\troot.CSS.escape = cssEscape;\n\treturn cssEscape;\n\n}));\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\n// input entities\nvar textInputField = require('./TextInputEntryFactory'),\n    checkboxField = require('./CheckboxEntryFactory'),\n    selectBoxField = require('./SelectEntryFactory'),\n    comboBoxField = require('./ComboEntryFactory'),\n    textBoxField = require('./TextBoxEntryFactory'),\n    validationAwareTextInputField = require('./ValidationAwareTextInput'),\n    tableField = require('./TableEntryFactory'),\n    labelEntry = require('./LabelFactory'),\n    link = require('./LinkEntryFactory');\n\nvar cmdHelper = require('../helper/CmdHelper');\n\n// helpers ////////////////////////////////////////\n\nfunction ensureNotNull(prop) {\n  if (!prop) {\n    throw new Error(prop + ' must be set.');\n  }\n\n  return prop;\n}\n\n/**\n * sets the default parameters which are needed to create an entry\n *\n * @param options\n * @returns {{id: *, description: (*|string), get: (*|Function), set: (*|Function),\n *            validate: (*|Function), html: string}}\n */\nvar setDefaultParameters = function(options) {\n\n  // default method to fetch the current value of the input field\n  var defaultGet = function(element) {\n    var bo = getBusinessObject(element),\n        res = {},\n        prop = ensureNotNull(options.modelProperty);\n    res[prop] = bo.get(prop);\n\n    return res;\n  };\n\n  // default method to set a new value to the input field\n  var defaultSet = function(element, values) {\n    var res = {},\n        prop = ensureNotNull(options.modelProperty);\n    if (values[prop] !== '') {\n      res[prop] = values[prop];\n    } else {\n      res[prop] = undefined;\n    }\n\n    return cmdHelper.updateProperties(element, res);\n  };\n\n  // default validation method\n  var defaultValidate = function() {\n    return {};\n  };\n\n  return {\n    id : options.id,\n    description : (options.description || ''),\n    get : (options.get || defaultGet),\n    set : (options.set || defaultSet),\n    validate : (options.validate || defaultValidate),\n    html: ''\n  };\n};\n\nfunction EntryFactory() {\n\n}\n\n/**\n * Generates an text input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation mehtod - Function\n *\n * - modelProperty: name of the model property - String\n *\n * - buttonAction: Object which contains the following properties: - Object\n * ---- name: name of the [data-action] callback - String\n * ---- method: callback function for [data-action] - Function\n *\n * - buttonShow: Object which contains the following properties: - Object\n * ---- name: name of the [data-show] callback - String\n * ---- method: callback function for [data-show] - Function\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.textField = function(options) {\n  return textInputField(options, setDefaultParameters(options));\n};\n\nEntryFactory.validationAwareTextField = function(options) {\n  return validationAwareTextInputField(options, setDefaultParameters(options));\n};\n\n/**\n * Generates a checkbox input entry object for a property panel.\n * options are:\n * - id: id of the entry - String\n *\n * - description: description of the property - String\n *\n * - label: label for the input field - String\n *\n * - set: setter method - Function\n *\n * - get: getter method - Function\n *\n * - validate: validation method - Function\n *\n * - modelProperty: name of the model property - String\n *\n * @param options\n * @returns the propertyPanel entry resource object\n */\nEntryFactory.checkbox = function(options) {\n  return checkboxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.textBox = function(options) {\n  return textBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.selectBox = function(options) {\n  return selectBoxField(options, setDefaultParameters(options));\n};\n\nEntryFactory.comboBox = function(options) {\n  return comboBoxField(options);\n};\n\nEntryFactory.table = function(options) {\n  return tableField(options);\n};\n\nEntryFactory.label = function(options) {\n  return labelEntry(options);\n};\n\nEntryFactory.link = function(options) {\n  return link(options);\n};\n\nmodule.exports = EntryFactory;\n","/** Used as the internal argument placeholder. */\nvar PLACEHOLDER = '__lodash_placeholder__';\n\n/**\n * Replaces all `placeholder` elements in `array` with an internal placeholder\n * and returns an array of their indexes.\n *\n * @private\n * @param {Array} array The array to modify.\n * @param {*} placeholder The placeholder to replace.\n * @returns {Array} Returns the new array of placeholder indexes.\n */\nfunction replaceHolders(array, placeholder) {\n  var index = -1,\n      length = array.length,\n      resIndex = 0,\n      result = [];\n\n  while (++index < length) {\n    var value = array[index];\n    if (value === placeholder || value === PLACEHOLDER) {\n      array[index] = PLACEHOLDER;\n      result[resIndex++] = index;\n    }\n  }\n  return result;\n}\n\nmodule.exports = replaceHolders;\n","var classof = require('../internals/classof-raw');\n\n// `IsArray` abstract operation\n// https://tc39.github.io/ecma262/#sec-isarray\nmodule.exports = Array.isArray || function isArray(arg) {\n  return classof(arg) == 'Array';\n};\n","var baseSetData = require('./_baseSetData'),\n    createBind = require('./_createBind'),\n    createCurry = require('./_createCurry'),\n    createHybrid = require('./_createHybrid'),\n    createPartial = require('./_createPartial'),\n    getData = require('./_getData'),\n    mergeData = require('./_mergeData'),\n    setData = require('./_setData'),\n    setWrapToString = require('./_setWrapToString'),\n    toInteger = require('./toInteger');\n\n/** Error message constants. */\nvar FUNC_ERROR_TEXT = 'Expected a function';\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeMax = Math.max;\n\n/**\n * Creates a function that either curries or invokes `func` with optional\n * `this` binding and partially applied arguments.\n *\n * @private\n * @param {Function|string} func The function or method name to wrap.\n * @param {number} bitmask The bitmask flags.\n *    1 - `_.bind`\n *    2 - `_.bindKey`\n *    4 - `_.curry` or `_.curryRight` of a bound function\n *    8 - `_.curry`\n *   16 - `_.curryRight`\n *   32 - `_.partial`\n *   64 - `_.partialRight`\n *  128 - `_.rearg`\n *  256 - `_.ary`\n *  512 - `_.flip`\n * @param {*} [thisArg] The `this` binding of `func`.\n * @param {Array} [partials] The arguments to be partially applied.\n * @param {Array} [holders] The `partials` placeholder indexes.\n * @param {Array} [argPos] The argument positions of the new function.\n * @param {number} [ary] The arity cap of `func`.\n * @param {number} [arity] The arity of `func`.\n * @returns {Function} Returns the new wrapped function.\n */\nfunction createWrap(func, bitmask, thisArg, partials, holders, argPos, ary, arity) {\n  var isBindKey = bitmask & WRAP_BIND_KEY_FLAG;\n  if (!isBindKey && typeof func != 'function') {\n    throw new TypeError(FUNC_ERROR_TEXT);\n  }\n  var length = partials ? partials.length : 0;\n  if (!length) {\n    bitmask &= ~(WRAP_PARTIAL_FLAG | WRAP_PARTIAL_RIGHT_FLAG);\n    partials = holders = undefined;\n  }\n  ary = ary === undefined ? ary : nativeMax(toInteger(ary), 0);\n  arity = arity === undefined ? arity : toInteger(arity);\n  length -= holders ? holders.length : 0;\n\n  if (bitmask & WRAP_PARTIAL_RIGHT_FLAG) {\n    var partialsRight = partials,\n        holdersRight = holders;\n\n    partials = holders = undefined;\n  }\n  var data = isBindKey ? undefined : getData(func);\n\n  var newData = [\n    func, bitmask, thisArg, partials, holders, partialsRight, holdersRight,\n    argPos, ary, arity\n  ];\n\n  if (data) {\n    mergeData(newData, data);\n  }\n  func = newData[0];\n  bitmask = newData[1];\n  thisArg = newData[2];\n  partials = newData[3];\n  holders = newData[4];\n  arity = newData[9] = newData[9] === undefined\n    ? (isBindKey ? 0 : func.length)\n    : nativeMax(newData[9] - length, 0);\n\n  if (!arity && bitmask & (WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG)) {\n    bitmask &= ~(WRAP_CURRY_FLAG | WRAP_CURRY_RIGHT_FLAG);\n  }\n  if (!bitmask || bitmask == WRAP_BIND_FLAG) {\n    var result = createBind(func, bitmask, thisArg);\n  } else if (bitmask == WRAP_CURRY_FLAG || bitmask == WRAP_CURRY_RIGHT_FLAG) {\n    result = createCurry(func, bitmask, arity);\n  } else if ((bitmask == WRAP_PARTIAL_FLAG || bitmask == (WRAP_BIND_FLAG | WRAP_PARTIAL_FLAG)) && !holders.length) {\n    result = createPartial(func, bitmask, thisArg, partials);\n  } else {\n    result = createHybrid.apply(undefined, newData);\n  }\n  var setter = data ? baseSetData : setData;\n  return setWrapToString(setter(result, newData), func, bitmask);\n}\n\nmodule.exports = createWrap;\n","'use strict';\n\nvar assign = require('lodash/assign');\n\nvar inputOutputParameter = require('./implementation/InputOutputParameter');\n\nmodule.exports = function(group, element, bpmnFactory, options, translate) {\n\n  options = assign({\n    idPrefix: 'connector-',\n    insideConnector: true\n  }, options);\n\n  group.entries = group.entries.concat(inputOutputParameter(element, bpmnFactory, options, translate));\n\n};\n","var baseCreate = require('./_baseCreate'),\n    baseLodash = require('./_baseLodash');\n\n/**\n * The base constructor for creating `lodash` wrapper objects.\n *\n * @private\n * @param {*} value The value to wrap.\n * @param {boolean} [chainAll] Enable explicit method chain sequences.\n */\nfunction LodashWrapper(value, chainAll) {\n  this.__wrapped__ = value;\n  this.__actions__ = [];\n  this.__chain__ = !!chainAll;\n  this.__index__ = 0;\n  this.__values__ = undefined;\n}\n\nLodashWrapper.prototype = baseCreate(baseLodash.prototype);\nLodashWrapper.prototype.constructor = LodashWrapper;\n\nmodule.exports = LodashWrapper;\n","/** Used for built-in method references. */\nvar objectProto = Object.prototype;\n\n/**\n * Checks if `value` is likely a prototype object.\n *\n * @private\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a prototype, else `false`.\n */\nfunction isPrototype(value) {\n  var Ctor = value && value.constructor,\n      proto = (typeof Ctor == 'function' && Ctor.prototype) || objectProto;\n\n  return value === proto;\n}\n\nmodule.exports = isPrototype;\n","var arrayLikeKeys = require('./_arrayLikeKeys'),\n    baseKeys = require('./_baseKeys'),\n    isArrayLike = require('./isArrayLike');\n\n/**\n * Creates an array of the own enumerable property names of `object`.\n *\n * **Note:** Non-object values are coerced to objects. See the\n * [ES spec](http://ecma-international.org/ecma-262/7.0/#sec-object.keys)\n * for more details.\n *\n * @static\n * @since 0.1.0\n * @memberOf _\n * @category Object\n * @param {Object} object The object to query.\n * @returns {Array} Returns the array of property names.\n * @example\n *\n * function Foo() {\n *   this.a = 1;\n *   this.b = 2;\n * }\n *\n * Foo.prototype.c = 3;\n *\n * _.keys(new Foo);\n * // => ['a', 'b'] (iteration order is not guaranteed)\n *\n * _.keys('hi');\n * // => ['0', '1']\n */\nfunction keys(object) {\n  return isArrayLike(object) ? arrayLikeKeys(object) : baseKeys(object);\n}\n\nmodule.exports = keys;\n","var baseDifference = require('./_baseDifference'),\n    baseFlatten = require('./_baseFlatten'),\n    baseUniq = require('./_baseUniq');\n\n/**\n * The base implementation of methods like `_.xor`, without support for\n * iteratee shorthands, that accepts an array of arrays to inspect.\n *\n * @private\n * @param {Array} arrays The arrays to inspect.\n * @param {Function} [iteratee] The iteratee invoked per element.\n * @param {Function} [comparator] The comparator invoked per element.\n * @returns {Array} Returns the new array of values.\n */\nfunction baseXor(arrays, iteratee, comparator) {\n  var length = arrays.length;\n  if (length < 2) {\n    return length ? baseUniq(arrays[0]) : [];\n  }\n  var index = -1,\n      result = Array(length);\n\n  while (++index < length) {\n    var array = arrays[index],\n        othIndex = -1;\n\n    while (++othIndex < length) {\n      if (othIndex != index) {\n        result[index] = baseDifference(result[index] || array, arrays[othIndex], iteratee, comparator);\n      }\n    }\n  }\n  return baseUniq(baseFlatten(result, 1), iteratee, comparator);\n}\n\nmodule.exports = baseXor;\n","/**\n * Converts `map` to its key-value pairs.\n *\n * @private\n * @param {Object} map The map to convert.\n * @returns {Array} Returns the key-value pairs.\n */\nfunction mapToArray(map) {\n  var index = -1,\n      result = Array(map.size);\n\n  map.forEach(function(value, key) {\n    result[++index] = [key, value];\n  });\n  return result;\n}\n\nmodule.exports = mapToArray;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar candidateStarter = require('./implementation/CandidateStarter');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:Process') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(candidateStarter(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n\n  }\n};\n","/**\n * The base implementation of `_.property` without support for deep paths.\n *\n * @private\n * @param {string} key The key of the property to get.\n * @returns {Function} Returns the new accessor function.\n */\nfunction baseProperty(key) {\n  return function(object) {\n    return object == null ? undefined : object[key];\n  };\n}\n\nmodule.exports = baseProperty;\n","var ListCache = require('./_ListCache');\n\n/**\n * Removes all key-value entries from the stack.\n *\n * @private\n * @name clear\n * @memberOf Stack\n */\nfunction stackClear() {\n  this.__data__ = new ListCache;\n  this.size = 0;\n}\n\nmodule.exports = stackClear;\n","'use strict';\n\nvar getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject,\n    getExtensionElements = require('../../../helper/ExtensionElementsHelper').getExtensionElements,\n    removeEntry = require('../../../helper/ExtensionElementsHelper').removeEntry,\n    extensionElements = require('./implementation/ExtensionElements'),\n    properties = require('./implementation/Properties'),\n    entryFactory = require('../../../factory/EntryFactory'),\n    elementHelper = require('../../../helper/ElementHelper'),\n    cmdHelper = require('../../../helper/CmdHelper'),\n    formHelper = require('../../../helper/FormHelper'),\n    utils = require('../../../Utils'),\n    is = require('bpmn-js/lib/util/ModelUtil').is,\n    find = require('lodash/find'),\n    each = require('lodash/forEach');\n\nfunction generateValueId() {\n  return utils.nextId('Value_');\n}\n\n/**\n * Generate a form field specific textField using entryFactory.\n *\n * @param  {string} options.id\n * @param  {string} options.label\n * @param  {string} options.modelProperty\n * @param  {function} options.validate\n *\n * @return {Object} an entryFactory.textField object\n */\nfunction formFieldTextField(options, getSelectedFormField) {\n\n  var id = options.id,\n      label = options.label,\n      modelProperty = options.modelProperty,\n      validate = options.validate;\n\n  return entryFactory.textField({\n    id: id,\n    label: label,\n    modelProperty: modelProperty,\n    get: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node) || {},\n          values = {};\n\n      values[modelProperty] = selectedFormField[modelProperty];\n\n      return values;\n    },\n\n    set: function(element, values, node) {\n      var commands = [];\n\n      if (typeof options.set === 'function') {\n        var cmd = options.set(element, values, node);\n\n        if (cmd) {\n          commands.push(cmd);\n        }\n      }\n\n      var formField = getSelectedFormField(element, node),\n          properties = {};\n\n      properties[modelProperty] = values[modelProperty] || undefined;\n\n      commands.push(cmdHelper.updateBusinessObject(element, formField, properties));\n\n      return commands;\n    },\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    },\n    validate: validate\n  });\n}\n\nfunction ensureFormKeyAndDataSupported(element) {\n  return (\n    is(element, 'bpmn:StartEvent') && !is(element.parent, 'bpmn:SubProcess')\n  ) || is(element, 'bpmn:UserTask');\n}\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n\n  if (!ensureFormKeyAndDataSupported(element)) {\n    return;\n  }\n\n\n  /**\n   * Return the currently selected form field querying the form field select box\n   * from the DOM.\n   *\n   * @param  {djs.model.Base} element\n   * @param  {DOMElement} node - DOM element of any form field text input\n   *\n   * @return {ModdleElement} the currently selected form field\n   */\n  function getSelectedFormField(element, node) {\n    var selected = formFieldsEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    return formHelper.getFormField(element, selected.idx);\n  }\n\n  // [FormKey] form key text input field\n  group.entries.push(entryFactory.textField({\n    id : 'form-key',\n    label : translate('Form Key'),\n    modelProperty: 'formKey',\n    get: function(element, node) {\n      var bo = getBusinessObject(element);\n\n      return {\n        formKey: bo.get('camunda:formKey')\n      };\n    },\n    set: function(element, values, node) {\n      var bo = getBusinessObject(element),\n          formKey = values.formKey || undefined;\n\n      return cmdHelper.updateBusinessObject(element, bo, { 'camunda:formKey': formKey });\n    }\n  }));\n\n  // [FormData] form field select box\n  var formFieldsEntry = extensionElements(element, bpmnFactory, {\n    id: 'form-fields',\n    label: translate('Form Fields'),\n    modelProperty: 'id',\n    prefix: 'FormField',\n    createExtensionElement: function(element, extensionElements, value) {\n      var bo = getBusinessObject(element), commands = [];\n\n      if (!extensionElements) {\n        extensionElements = elementHelper.createElement('bpmn:ExtensionElements', { values: [] }, bo, bpmnFactory);\n        commands.push(cmdHelper.updateProperties(element, { extensionElements: extensionElements }));\n      }\n\n      var formData = formHelper.getFormData(element);\n\n      if (!formData) {\n        formData = elementHelper.createElement('camunda:FormData', { fields: [] }, extensionElements, bpmnFactory);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(\n          element,\n          extensionElements,\n          'values',\n          'extensionElements',\n          [formData],\n          []\n        ));\n      }\n\n      var field = elementHelper.createElement('camunda:FormField', { id: value }, formData, bpmnFactory);\n      if (typeof formData.fields !== 'undefined') {\n        commands.push(cmdHelper.addElementsTolist(element, formData, 'fields', [ field ]));\n      } else {\n        commands.push(cmdHelper.updateBusinessObject(element, formData, {\n          fields: [ field ]\n        }));\n      }\n      return commands;\n    },\n    removeExtensionElement: function(element, extensionElements, value, idx) {\n      var formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0],\n          entry = formData.fields[idx],\n          commands = [];\n\n      if (formData.fields.length < 2) {\n        commands.push(removeEntry(getBusinessObject(element), element, formData));\n      } else {\n        commands.push(cmdHelper.removeElementsFromList(element, formData, 'fields', null, [entry]));\n\n        if (entry.id === formData.get('businessKey')) {\n          commands.push(cmdHelper.updateBusinessObject(element, formData, { 'businessKey': undefined }));\n        }\n      }\n\n      return commands;\n    },\n    getExtensionElements: function(element) {\n      return formHelper.getFormFields(element);\n    },\n    hideExtensionElements: function(element, node) {\n      return false;\n    }\n  });\n  group.entries.push(formFieldsEntry);\n\n  // [FormData] business key form field select box\n  var formBusinessKeyFormFieldEntry = entryFactory.selectBox({\n    id: 'form-business-key',\n    label: translate('Business Key'),\n    modelProperty: 'businessKey',\n    selectOptions: function(element, inputNode) {\n      var selectOptions = [{ name: '', value: '' }];\n      var formFields = formHelper.getFormFields(element);\n      each(formFields, function(field) {\n        if (field.type !== 'boolean') {\n          selectOptions.push({ name: field.id, value: field.id });\n        }\n      });\n      return selectOptions;\n    },\n    get: function(element, node) {\n      var result = { businessKey: '' };\n      var bo = getBusinessObject(element);\n      var formDataExtension = getExtensionElements(bo, 'camunda:FormData');\n      if (formDataExtension) {\n        var formData = formDataExtension[0];\n        var storedValue = formData.get('businessKey');\n        result = { businessKey: storedValue };\n      }\n      return result;\n    },\n    set: function(element, values, node) {\n      var formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0];\n      return cmdHelper.updateBusinessObject(element, formData, { 'businessKey': values.businessKey || undefined });\n    },\n    hidden: function(element, node) {\n      var isStartEvent = is(element,'bpmn:StartEvent');\n      return !(isStartEvent && formHelper.getFormFields(element).length > 0);\n    }\n  });\n  group.entries.push(formBusinessKeyFormFieldEntry);\n\n  // [FormData] Form Field label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-header',\n    labelText: translate('Form Field'),\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field id text input field\n  group.entries.push(entryFactory.validationAwareTextField({\n    id: 'form-field-id',\n    label: translate('ID'),\n    modelProperty: 'id',\n\n    getProperty: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node) || {};\n\n      return selectedFormField.id;\n    },\n\n    setProperty: function(element, properties, node) {\n      var formField = getSelectedFormField(element, node);\n\n      return cmdHelper.updateBusinessObject(element, formField, properties);\n    },\n\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    },\n\n    validate: function(element, values, node) {\n\n      var formField = getSelectedFormField(element, node);\n\n      if (formField) {\n\n        var idValue = values.id;\n\n        if (!idValue || idValue.trim() === '') {\n          return { id: 'Form field id must not be empty' };\n        }\n\n        var formFields = formHelper.getFormFields(element);\n\n        var existingFormField = find(formFields, function(f) {\n          return f !== formField && f.id === idValue;\n        });\n\n        if (existingFormField) {\n          return { id: 'Form field id already used in form data.' };\n        }\n      }\n    }\n  }));\n\n  // [FormData] form field type combo box\n  group.entries.push(entryFactory.comboBox({\n    id: 'form-field-type',\n    label: translate('Type'),\n    selectOptions: [\n      { name: 'string', value: 'string' },\n      { name: 'long', value: 'long' },\n      { name: 'boolean', value: 'boolean' },\n      { name: 'date', value: 'date' },\n      { name: 'enum', value: 'enum' }\n    ],\n    modelProperty: 'type',\n    emptyParameter: true,\n\n    get: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      if (selectedFormField) {\n        return { type: selectedFormField.type };\n      } else {\n        return {};\n      }\n    },\n    set: function(element, values, node) {\n      var selectedFormField = getSelectedFormField(element, node),\n          formData = getExtensionElements(getBusinessObject(element), 'camunda:FormData')[0],\n          commands = [];\n\n      if (selectedFormField.type === 'enum' && values.type !== 'enum') {\n        // delete camunda:value objects from formField.values when switching from type enum\n        commands.push(cmdHelper.updateBusinessObject(element, selectedFormField, { values: undefined }));\n      }\n      if (values.type === 'boolean' && selectedFormField.get('id') === formData.get('businessKey')) {\n        commands.push(cmdHelper.updateBusinessObject(element, formData, { 'businessKey': undefined }));\n      }\n      commands.push(cmdHelper.updateBusinessObject(element, selectedFormField, values));\n\n      return commands;\n    },\n    hidden: function(element, node) {\n      return !getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field label text input field\n  group.entries.push(formFieldTextField({\n    id: 'form-field-label',\n    label: translate('Label'),\n    modelProperty: 'label'\n  }, getSelectedFormField));\n\n  // [FormData] form field defaultValue text input field\n  group.entries.push(formFieldTextField({\n    id: 'form-field-defaultValue',\n    label: translate('Default Value'),\n    modelProperty: 'defaultValue'\n  }, getSelectedFormField));\n\n\n  // [FormData] form field enum values label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-enum-values-header',\n    labelText: translate('Values'),\n    divider: true,\n    showLabel: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return selectedFormField && selectedFormField.type === 'enum';\n    }\n  }));\n\n  // [FormData] form field enum values table\n  group.entries.push(entryFactory.table({\n    id: 'form-field-enum-values',\n    labels: [ translate('Id'), translate('Name') ],\n    modelProperties: [ 'id', 'name' ],\n    show: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return selectedFormField && selectedFormField.type === 'enum';\n    },\n    getElements: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node);\n\n      return formHelper.getEnumValues(selectedFormField);\n    },\n    addElement: function(element, node) {\n      var selectedFormField = getSelectedFormField(element, node),\n          id = generateValueId();\n\n      var enumValue = elementHelper.createElement(\n        'camunda:Value',\n        { id: id, name: undefined },\n        getBusinessObject(element),\n        bpmnFactory\n      );\n\n      return cmdHelper.addElementsTolist(element, selectedFormField, 'values', [enumValue]);\n    },\n    removeElement: function(element, node, idx) {\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      return cmdHelper.removeElementsFromList(element, selectedFormField, 'values', null, [enumValue]);\n    },\n    updateElement: function(element, value, node, idx) {\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      value.name = value.name || undefined;\n      return cmdHelper.updateBusinessObject(element, enumValue, value);\n    },\n    validate: function(element, value, node, idx) {\n\n      var selectedFormField = getSelectedFormField(element, node),\n          enumValue = selectedFormField.values[idx];\n\n      if (enumValue) {\n        // check if id is valid\n        var validationError = utils.isIdValid(enumValue, value.id, translate);\n\n        if (validationError) {\n          return { id: validationError };\n        }\n      }\n    }\n  }));\n\n  // [FormData] Validation label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-validation-header',\n    labelText: translate('Validation'),\n    divider: true,\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] form field constraints table\n  group.entries.push(entryFactory.table({\n    id: 'constraints-list',\n    modelProperties: [ 'name', 'config' ],\n    labels: [ translate('Name'), translate('Config') ],\n    addLabel: translate('Add Constraint'),\n    getElements: function(element, node) {\n      var formField = getSelectedFormField(element, node);\n\n      return formHelper.getConstraints(formField);\n    },\n    addElement: function(element, node) {\n\n      var commands = [],\n          formField = getSelectedFormField(element, node),\n          validation = formField.validation;\n\n      if (!validation) {\n        // create validation business object and add it to form data, if it doesn't exist\n        validation = elementHelper.createElement('camunda:Validation', {}, getBusinessObject(element), bpmnFactory);\n\n        commands.push(cmdHelper.updateBusinessObject(element, formField, { 'validation': validation }));\n      }\n\n      var newConstraint = elementHelper.createElement(\n        'camunda:Constraint',\n        { name: undefined, config: undefined },\n        validation,\n        bpmnFactory\n      );\n\n      commands.push(cmdHelper.addElementsTolist(element, validation, 'constraints', [ newConstraint ]));\n\n      return commands;\n    },\n    updateElement: function(element, value, node, idx) {\n      var formField = getSelectedFormField(element, node),\n          constraint = formHelper.getConstraints(formField)[idx];\n\n      value.name = value.name || undefined;\n      value.config = value.config || undefined;\n\n      return cmdHelper.updateBusinessObject(element, constraint, value);\n    },\n    removeElement: function(element, node, idx) {\n      var commands = [],\n          formField = getSelectedFormField(element, node),\n          constraints = formHelper.getConstraints(formField),\n          currentConstraint = constraints[idx];\n\n      commands.push(cmdHelper.removeElementsFromList(\n        element,\n        formField.validation,\n        'constraints',\n        null,\n        [ currentConstraint ]\n      ));\n\n      if (constraints.length === 1) {\n        // remove camunda:validation if the last existing constraint has been removed\n        commands.push(cmdHelper.updateBusinessObject(element, formField, { validation: undefined }));\n      }\n\n      return commands;\n    },\n    show: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] Properties label\n  group.entries.push(entryFactory.label({\n    id: 'form-field-properties-header',\n    labelText: translate('Properties'),\n    divider: true,\n    showLabel: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }));\n\n  // [FormData] camunda:properties table\n  group.entries.push(properties(element, bpmnFactory, {\n    id: 'form-field-properties',\n    modelProperties: [ 'id', 'value' ],\n    labels: [ translate('Id'), translate('Value') ],\n    getParent: function(element, node) {\n      return getSelectedFormField(element, node);\n    },\n    show: function(element, node) {\n      return !!getSelectedFormField(element, node);\n    }\n  }, translate));\n};\n","'use strict';\r\n\r\nvar entryFactory = require('../../../../factory/EntryFactory');\r\n\r\nvar cmdHelper = require('../../../../helper/CmdHelper');\r\n\r\nmodule.exports = function(element, bpmnFactory, options, translate) {\r\n\r\n  var getBusinessObject = options.getBusinessObject;\r\n\r\n  var isStartableInTasklistEntry = entryFactory.checkbox({\r\n    id: 'isStartableInTasklist',\r\n    label: translate('Startable'),\r\n    modelProperty: 'isStartableInTasklist',\r\n\r\n    get: function(element, node) {\r\n      var bo = getBusinessObject(element);\r\n      var isStartableInTasklist = bo.get('camunda:isStartableInTasklist');\r\n\r\n      return {\r\n        isStartableInTasklist: isStartableInTasklist ? isStartableInTasklist : ''\r\n      };\r\n    },\r\n\r\n    set: function(element, values) {\r\n      var bo = getBusinessObject(element);\r\n      return cmdHelper.updateBusinessObject(element, bo, {\r\n        'camunda:isStartableInTasklist': !!values.isStartableInTasklist\r\n      });\r\n    }\r\n\r\n  });\r\n\r\n  return [\r\n    isStartableInTasklistEntry\r\n  ];\r\n};\r\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar entryFactory = require('../../../factory/EntryFactory');\n\nvar participantHelper = require('../../../helper/ParticipantHelper');\n\nmodule.exports = function(group, element, translate) {\n\n  var bo = getBusinessObject(element);\n\n  if (!bo) {\n    return;\n  }\n\n  if (is(element, 'bpmn:Process') || (is(element, 'bpmn:Participant') && bo.get('processRef'))) {\n\n    var executableEntry = entryFactory.checkbox({\n      id: 'process-is-executable',\n      label: translate('Executable'),\n      modelProperty: 'isExecutable'\n    });\n\n    // in participants we have to change the default behavior of set and get\n    if (is(element, 'bpmn:Participant')) {\n      executableEntry.get = function(element) {\n        return participantHelper.getProcessBusinessObject(element, 'isExecutable');\n      };\n\n      executableEntry.set = function(element, values) {\n        return participantHelper.modifyProcessBusinessObject(element, 'isExecutable', values);\n      };\n    }\n\n    group.entries.push(executableEntry);\n  }\n\n};\n","/** Used to detect hot functions by number of calls within a span of milliseconds. */\nvar HOT_COUNT = 800,\n    HOT_SPAN = 16;\n\n/* Built-in method references for those with the same name as other `lodash` methods. */\nvar nativeNow = Date.now;\n\n/**\n * Creates a function that'll short out and invoke `identity` instead\n * of `func` when it's called `HOT_COUNT` or more times in `HOT_SPAN`\n * milliseconds.\n *\n * @private\n * @param {Function} func The function to restrict.\n * @returns {Function} Returns the new shortable function.\n */\nfunction shortOut(func) {\n  var count = 0,\n      lastCalled = 0;\n\n  return function() {\n    var stamp = nativeNow(),\n        remaining = HOT_SPAN - (stamp - lastCalled);\n\n    lastCalled = stamp;\n    if (remaining > 0) {\n      if (++count >= HOT_COUNT) {\n        return arguments[0];\n      }\n    } else {\n      count = 0;\n    }\n    return func.apply(undefined, arguments);\n  };\n}\n\nmodule.exports = shortOut;\n","var isSymbol = require('./isSymbol');\n\n/** Used as references for various `Number` constants. */\nvar INFINITY = 1 / 0;\n\n/**\n * Converts `value` to a string key if it's not a string or symbol.\n *\n * @private\n * @param {*} value The value to inspect.\n * @returns {string|symbol} Returns the key.\n */\nfunction toKey(value) {\n  if (typeof value == 'string' || isSymbol(value)) {\n    return value;\n  }\n  var result = (value + '');\n  return (result == '0' && (1 / value) == -INFINITY) ? '-0' : result;\n}\n\nmodule.exports = toKey;\n","'use strict';\n\nvar entryFactory = require('../../../../factory/EntryFactory'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, escalationEventDefinition, showEscalationCodeVariable, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, escalationEventDefinition, bpmnFactory, {\n    label: translate('Escalation'),\n    elementName: 'escalation',\n    elementType: 'bpmn:Escalation',\n    referenceProperty: 'escalationRef',\n    newElementIdPrefix: 'Escalation_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, escalationEventDefinition, bpmnFactory, {\n    id: 'escalation-element-name',\n    label: translate('Escalation Name'),\n    referenceProperty: 'escalationRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, escalationEventDefinition, bpmnFactory, {\n    id: 'escalation-element-code',\n    label: translate('Escalation Code'),\n    referenceProperty: 'escalationRef',\n    modelProperty: 'escalationCode'\n  }));\n\n\n  if (showEscalationCodeVariable) {\n    group.entries.push(entryFactory.textField({\n      id : 'escalationCodeVariable',\n      label : translate('Escalation Code Variable'),\n      modelProperty : 'escalationCodeVariable',\n\n      get: function(element) {\n        var codeVariable = escalationEventDefinition.get('camunda:escalationCodeVariable');\n        return {\n          escalationCodeVariable: codeVariable\n        };\n      },\n\n      set: function(element, values) {\n        return cmdHelper.updateBusinessObject(element, escalationEventDefinition, {\n          'camunda:escalationCodeVariable': values.escalationCodeVariable || undefined\n        });\n      }\n    }));\n  }\n};\n","var isArray = require('./isArray'),\n    isSymbol = require('./isSymbol');\n\n/** Used to match property names within property paths. */\nvar reIsDeepProp = /\\.|\\[(?:[^[\\]]*|([\"'])(?:(?!\\1)[^\\\\]|\\\\.)*?\\1)\\]/,\n    reIsPlainProp = /^\\w*$/;\n\n/**\n * Checks if `value` is a property name and not a property path.\n *\n * @private\n * @param {*} value The value to check.\n * @param {Object} [object] The object to query keys on.\n * @returns {boolean} Returns `true` if `value` is a property name, else `false`.\n */\nfunction isKey(value, object) {\n  if (isArray(value)) {\n    return false;\n  }\n  var type = typeof value;\n  if (type == 'number' || type == 'symbol' || type == 'boolean' ||\n      value == null || isSymbol(value)) {\n    return true;\n  }\n  return reIsPlainProp.test(value) || !reIsDeepProp.test(value) ||\n    (object != null && value in Object(object));\n}\n\nmodule.exports = isKey;\n","var baseSetData = require('./_baseSetData'),\n    shortOut = require('./_shortOut');\n\n/**\n * Sets metadata for `func`.\n *\n * **Note:** If this function becomes hot, i.e. is invoked a lot in a short\n * period of time, it will trip its breaker and transition to an identity\n * function to avoid garbage collection pauses in V8. See\n * [V8 issue 2070](https://bugs.chromium.org/p/v8/issues/detail?id=2070)\n * for more details.\n *\n * @private\n * @param {Function} func The function to associate metadata with.\n * @param {*} data The metadata.\n * @returns {Function} Returns `func`.\n */\nvar setData = shortOut(baseSetData);\n\nmodule.exports = setData;\n","'use strict';\n\nvar cmdHelper = require('../../../../helper/CmdHelper');\n\nvar domQuery = require('min-dom').query,\n    domify = require('min-dom').domify,\n    domAttr = require('min-dom').attr;\n\nvar forEach = require('lodash/forEach'),\n    find = require('lodash/find');\n\nvar elementHelper = require('../../../../helper/ElementHelper');\nvar utils = require('../../../../Utils'),\n    escapeHTML = utils.escapeHTML;\n\nvar selector = 'select[name=selectedElement]';\n\n/**\n * Get select box containing all elements.\n *\n * @param {DOMElement} node\n *\n * @return {DOMElement} the select box\n */\nfunction getSelectBox(node) {\n  return domQuery(selector, node.parentElement);\n}\n\n/**\n * Find element by given id.\n *\n * @param {ModdleElement} eventDefinition\n *\n * @return {ModdleElement} an element\n */\nfunction findElementById(eventDefinition, type, id) {\n  var elements = utils.findRootElementsByType(eventDefinition, type);\n  return find(elements, function(element) {\n    return element.id === id;\n  });\n}\n\n/**\n * Create an entry to modify the reference to an element from an\n * event definition.\n *\n * @param  {djs.model.Base} element\n * @param  {ModdleElement} definition\n * @param  {BpmnFactory} bpmnFactory\n * @param  {Object} options\n * @param  {string} options.label the label of the entry\n * @param  {string} options.description the description of the entry\n * @param  {string} options.elementName the name of the element\n * @param  {string} options.elementType the type of the element\n * @param  {string} options.referenceProperty the name of referencing property\n * @param  {string} options.newElementIdPrefix the prefix of a new created element\n *\n * @return {Array<Object>} return an array containing the entries\n */\nmodule.exports = function(element, definition, bpmnFactory, options) {\n\n  var elementName = options.elementName || '',\n      elementType = options.elementType,\n      referenceProperty = options.referenceProperty;\n\n  var newElementIdPrefix = options.newElementIdPrefix || 'elem_';\n\n  var label = options.label || '',\n      description = options.description || '';\n\n  var entries = [];\n\n  entries.push({\n\n    id: 'event-definitions-' + elementName,\n    description: description,\n    html: '<div class=\"bpp-row bpp-select\">' +\n             '<label for=\"camunda-' + escapeHTML(elementName) + '\">' + escapeHTML(label) + '</label>' +\n             '<div class=\"bpp-field-wrapper\">' +\n               '<select id=\"camunda-' + escapeHTML(elementName) + '\" name=\"selectedElement\" data-value>' +\n               '</select>' +\n               '<button class=\"add\" id=\"addElement\" data-action=\"addElement\"><span>+</span></button>' +\n             '</div>' +\n          '</div>',\n\n    get: function(element, entryNode) {\n      utils.updateOptionsDropDown(selector, definition, elementType, entryNode);\n      var reference = definition.get(referenceProperty);\n      return {\n        selectedElement: (reference && reference.id) || ''\n      };\n    },\n\n    set: function(element, values) {\n      var selection = values.selectedElement;\n\n      var props = {};\n\n      if (!selection || typeof selection === 'undefined') {\n        // remove reference to element\n        props[referenceProperty] = undefined;\n        return cmdHelper.updateBusinessObject(element, definition, props);\n      }\n\n      var commands = [];\n\n      var selectedElement = findElementById(definition, elementType, selection);\n      if (!selectedElement) {\n        var root = utils.getRoot(definition);\n\n        // create a new element\n        selectedElement = elementHelper.createElement(elementType, { name: selection }, root, bpmnFactory);\n        commands.push(cmdHelper.addAndRemoveElementsFromList(element, root, 'rootElements', null, [ selectedElement ]));\n      }\n\n      // update reference to element\n      props[referenceProperty] = selectedElement;\n      commands.push(cmdHelper.updateBusinessObject(element, definition, props));\n\n      return commands;\n    },\n\n    addElement: function(element, inputNode) {\n      // note: this generated id will be used as name\n      // of the element and not as id\n      var id = utils.nextId(newElementIdPrefix);\n\n      var optionTemplate = domify('<option value=\"' + escapeHTML(id) + '\"> (id='+escapeHTML(id)+')' + '</option>');\n\n      // add new option\n      var selectBox = getSelectBox(inputNode);\n      selectBox.insertBefore(optionTemplate, selectBox.firstChild);\n\n      // select new element in the select box\n      forEach(selectBox, function(option) {\n        if (option.value === id) {\n          domAttr(option, 'selected', 'selected');\n        } else {\n          domAttr(option, 'selected', null);\n        }\n      });\n\n      return true;\n    }\n\n  });\n\n  return entries;\n\n};\n","'use strict';\n\nvar eventDefinitionReference = require('./EventDefinitionReference'),\n    elementReferenceProperty = require('./ElementReferenceProperty');\n\n\nmodule.exports = function(group, element, bpmnFactory, messageEventDefinition, translate) {\n\n  group.entries = group.entries.concat(eventDefinitionReference(element, messageEventDefinition, bpmnFactory, {\n    label: translate('Message'),\n    elementName: 'message',\n    elementType: 'bpmn:Message',\n    referenceProperty: 'messageRef',\n    newElementIdPrefix: 'Message_'\n  }));\n\n\n  group.entries = group.entries.concat(elementReferenceProperty(element, messageEventDefinition, bpmnFactory, {\n    id: 'message-element-name',\n    label: translate('Message Name'),\n    referenceProperty: 'messageRef',\n    modelProperty: 'name',\n    shouldValidate: true\n  }));\n\n};\n","var baseProperty = require('./_baseProperty'),\n    basePropertyDeep = require('./_basePropertyDeep'),\n    isKey = require('./_isKey'),\n    toKey = require('./_toKey');\n\n/**\n * Creates a function that returns the value at `path` of a given object.\n *\n * @static\n * @memberOf _\n * @since 2.4.0\n * @category Util\n * @param {Array|string} path The path of the property to get.\n * @returns {Function} Returns the new accessor function.\n * @example\n *\n * var objects = [\n *   { 'a': { 'b': 2 } },\n *   { 'a': { 'b': 1 } }\n * ];\n *\n * _.map(objects, _.property('a.b'));\n * // => [2, 1]\n *\n * _.map(_.sortBy(objects, _.property(['a', 'b'])), 'a.b');\n * // => [1, 2]\n */\nfunction property(path) {\n  return isKey(path) ? baseProperty(toKey(path)) : basePropertyDeep(path);\n}\n\nmodule.exports = property;\n","'use strict';\n\nvar is = require('bpmn-js/lib/util/ModelUtil').is,\n    getBusinessObject = require('bpmn-js/lib/util/ModelUtil').getBusinessObject;\n\nvar jobPriority = require('./implementation/JobPriority'),\n    jobRetryTimeCycle = require('./implementation/JobRetryTimeCycle');\n\nmodule.exports = function(group, element, bpmnFactory, translate) {\n  var businessObject = getBusinessObject(element);\n\n  if (is(element, 'camunda:JobPriorized') ||\n      is(element, 'bpmn:Participant') && businessObject.get('processRef')) {\n\n    group.entries = group.entries.concat(jobPriority(element, bpmnFactory, {\n      getBusinessObject: function(element) {\n        var bo = getBusinessObject(element);\n\n        if (!is(bo, 'bpmn:Participant')) {\n          return bo;\n        }\n\n        return bo.get('processRef');\n      }\n    }, translate));\n  }\n\n  if (is(element, 'camunda:AsyncCapable')) {\n    group.entries = group.entries.concat(jobRetryTimeCycle(element, bpmnFactory, {\n      getBusinessObject: getBusinessObject\n    }, translate));\n  }\n\n};\n","'use strict';\n\nvar extensionElementsHelper = require('../../../../helper/ExtensionElementsHelper'),\n    elementHelper = require('../../../../helper/ElementHelper'),\n    cmdHelper = require('../../../../helper/CmdHelper');\n\nvar utils = require('../../../../Utils');\n\nvar entryFactory = require('../../../../factory/EntryFactory');\n\nvar extensionElementsEntry = require('./ExtensionElements');\n\nvar ModelUtil = require('bpmn-js/lib/util/ModelUtil'),\n    getBusinessObject = ModelUtil.getBusinessObject;\n\nvar assign = require('lodash/assign');\n\n\nvar DEFAULT_PROPS = {\n  'stringValue': undefined,\n  'string': undefined,\n  'expression': undefined\n};\n\nvar CAMUNDA_FIELD_EXTENSION_ELEMENT = 'camunda:Field';\n\nmodule.exports = function(element, bpmnFactory, translate, options) {\n\n  options = options || {};\n\n  var insideListener = !!options.insideListener,\n      idPrefix = options.idPrefix || '',\n      getSelectedListener = options.getSelectedListener,\n      businessObject = options.businessObject || getBusinessObject(element);\n\n  var entries = [];\n\n  var isSelected = function(element, node) {\n    return getSelectedField(element, node);\n  };\n\n  function getSelectedField(element, node) {\n    var selected = fieldEntry.getSelected(element, node.parentNode);\n\n    if (selected.idx === -1) {\n      return;\n    }\n\n    var fields = getCamundaFields(element, node);\n\n    return fields[selected.idx];\n  }\n\n  function getCamundaFields(element, node) {\n    if (!insideListener) {\n      return (\n        businessObject &&\n        extensionElementsHelper.getExtensionElements(businessObject, CAMUNDA_FIELD_EXTENSION_ELEMENT)\n      ) || [];\n    }\n    return getCamundaListenerFields(element, node);\n  }\n\n  function getCamundaListenerFields(element, node) {\n    var selectedListener = getSelectedListener(element, node);\n    return selectedListener && selectedListener.fields || [];\n  }\n\n  function getFieldType(bo) {\n    var fieldType = 'string';\n\n    var expressionValue = bo && bo.expression;\n    var stringValue = bo && (bo.string || bo.stringValue);\n\n    if (typeof stringValue !== 'undefined') {\n      fieldType = 'string';\n    } else if (typeof expressionValue !== 'undefined') {\n      fieldType = 'expression';\n    }\n\n    return fieldType;\n  }\n\n  var setOptionLabelValue = function() {\n    return function(element, node, option, property, value, idx) {\n      var camundaFields = getCamundaFields(element, node);\n      var field = camundaFields[idx];\n\n      value = (field.name) ? field.name : '<empty>';\n\n      var label = idx + ' : ' + value;\n\n      option.text = label;\n    };\n  };\n\n  var newElement = function() {\n    return function(element, extensionElements, value, node) {\n\n      var props = {\n        name: '',\n        string: ''\n      };\n\n      var newFieldElem;\n\n      if (!insideListener) {\n\n        newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, extensionElements, bpmnFactory);\n        return cmdHelper.addElementsTolist(element, extensionElements, 'values', [ newFieldElem ]);\n\n      } else {\n\n        var selectedListener = getSelectedListener(element, node);\n        newFieldElem = elementHelper.createElement(CAMUNDA_FIELD_EXTENSION_ELEMENT, props, selectedListener, bpmnFactory);\n        return cmdHelper.addElementsTolist(element, selectedListener, 'fields', [ newFieldElem ]);\n\n      }\n\n    };\n  };\n\n  var removeElement = function() {\n    return function(element, extensionElements, value, idx, node) {\n      var camundaFields= getCamundaFields(element, node);\n      var field = camundaFields[idx];\n      if (field) {\n        if (!insideListener) {\n          return extensionElementsHelper.removeEntry(businessObject, element, field);\n        }\n        var selectedListener = getSelectedListener(element, node);\n        return cmdHelper.removeElementsFromList(element, selectedListener, 'fields', null, [ field ]);\n      }\n    };\n  };\n\n\n  var fieldEntry = extensionElementsEntry(element, bpmnFactory, {\n    id : idPrefix + 'fields',\n    label : translate('Fields'),\n    modelProperty: 'fieldName',\n    idGeneration: 'false',\n\n    businessObject: businessObject,\n\n    createExtensionElement: newElement(),\n    removeExtensionElement: removeElement(),\n\n    getExtensionElements: function(element, node) {\n      return getCamundaFields(element, node);\n    },\n\n    setOptionLabelValue: setOptionLabelValue()\n\n  });\n  entries.push(fieldEntry);\n\n\n  entries.push(entryFactory.validationAwareTextField({\n    id: idPrefix + 'field-name',\n    label: translate('Name'),\n    modelProperty: 'fieldName',\n\n    getProperty: function(element, node) {\n      return (getSelectedField(element, node) || {}).name;\n    },\n\n    setProperty: function(element, values, node) {\n      var selectedField = getSelectedField(element, node);\n      return cmdHelper.updateBusinessObject(element, selectedField, { name : values.fieldName });\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        var nameValue = values.fieldName;\n\n        if (nameValue) {\n          if (utils.containsSpace(nameValue)) {\n            validation.fieldName = translate('Name must not contain spaces');\n          }\n        } else {\n          validation.fieldName = translate('Parameter must have a name');\n        }\n      }\n\n      return validation;\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n  var fieldTypeOptions = [\n    {\n      name: translate('String'),\n      value: 'string'\n    },\n    {\n      name: translate('Expression'),\n      value: 'expression'\n    }\n  ];\n\n  entries.push(entryFactory.selectBox({\n    id: idPrefix + 'field-type',\n    label: translate('Type'),\n    selectOptions: fieldTypeOptions,\n    modelProperty: 'fieldType',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n\n      var fieldType = getFieldType(bo);\n\n      return {\n        fieldType: fieldType\n      };\n    },\n\n    set: function(element, values, node) {\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldType = values.fieldType;\n\n      if (fieldType === 'string') {\n        props.string = '';\n      }\n      else if (fieldType === 'expression') {\n        props.expression = '';\n      }\n\n      return cmdHelper.updateBusinessObject(element, getSelectedField(element, node), props);\n    },\n\n    hidden: function(element, node) {\n      return !isSelected(element, node);\n    }\n\n  }));\n\n\n  entries.push(entryFactory.textBox({\n    id: idPrefix + 'field-value',\n    label: translate('Value'),\n    modelProperty: 'fieldValue',\n\n    get: function(element, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var fieldValue;\n\n      if (fieldType === 'string') {\n        fieldValue = bo && (bo.string || bo.stringValue);\n      }\n      else if (fieldType === 'expression') {\n        fieldValue = bo && bo.expression;\n      }\n\n      return {\n        fieldValue: fieldValue\n      };\n    },\n\n    set: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n      var fieldType = getFieldType(bo);\n\n      var props = assign({}, DEFAULT_PROPS);\n\n      var fieldValue = values.fieldValue || undefined;\n\n      if (fieldType === 'string') {\n        props.string = fieldValue;\n      }\n      else if (fieldType === 'expression') {\n        props.expression = fieldValue;\n      }\n\n      return cmdHelper.updateBusinessObject(element, bo, props);\n\n    },\n\n    validate: function(element, values, node) {\n      var bo = getSelectedField(element, node);\n\n      var validation = {};\n      if (bo) {\n        if (!values.fieldValue) {\n          validation.fieldValue = translate('Must provide a value');\n        }\n      }\n\n      return validation;\n    },\n\n    show: function(element, node) {\n      return isSelected(element, node);\n    }\n\n  }));\n\n  return entries;\n\n};\n","'use strict';\n\nvar textField = require('./TextInputEntryFactory');\n\n/**\n * This function is a wrapper around TextInputEntryFactory.\n * It adds functionality to cache an invalid value entered in the\n * text input, instead of setting it on the business object.\n */\nvar validationAwareTextField = function(options, defaultParameters) {\n\n  var modelProperty = options.modelProperty;\n\n  defaultParameters.get = function(element, node) {\n    var value = this.__lastInvalidValue;\n\n    delete this.__lastInvalidValue;\n\n    var properties = {};\n\n    properties[modelProperty] = value !== undefined ? value : options.getProperty(element, node);\n\n    return properties;\n  };\n\n  defaultParameters.set = function(element, values, node) {\n    var validationErrors = validate.apply(this, [ element, values, node ]),\n        propertyValue = values[modelProperty];\n\n    // make sure we do not update the id\n    if (validationErrors && validationErrors[modelProperty]) {\n      this.__lastInvalidValue = propertyValue;\n\n      return options.setProperty(element, {}, node);\n    } else {\n      var properties = {};\n\n      properties[modelProperty] = propertyValue;\n\n      return options.setProperty(element, properties, node);\n    }\n  };\n\n  var validate = defaultParameters.validate = function(element, values, node) {\n    var value = values[modelProperty] || this.__lastInvalidValue;\n\n    var property = {};\n    property[modelProperty] = value;\n\n    return options.validate(element, property, node);\n  };\n\n  return textField(options, defaultParameters);\n};\n\nmodule.exports = validationAwareTextField;\n","var assocIndexOf = require('./_assocIndexOf');\n\n/**\n * Checks if a list cache value for `key` exists.\n *\n * @private\n * @name has\n * @memberOf ListCache\n * @param {string} key The key of the entry to check.\n * @returns {boolean} Returns `true` if an entry for `key` exists, else `false`.\n */\nfunction listCacheHas(key) {\n  return assocIndexOf(this.__data__, key) > -1;\n}\n\nmodule.exports = listCacheHas;\n","import mod from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=style&index=0&id=8d3627ba&scoped=true&lang=css&\"; export default mod; export * from \"-!../../node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../node_modules/css-loader/dist/cjs.js??ref--6-oneOf-1-1!../../node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-2!../../node_modules/cache-loader/dist/cjs.js??ref--0-0!../../node_modules/vue-loader/lib/index.js??vue-loader-options!./FileUpload.vue?vue&type=style&index=0&id=8d3627ba&scoped=true&lang=css&\"","var arrayEach = require('./_arrayEach'),\n    arrayIncludes = require('./_arrayIncludes');\n\n/** Used to compose bitmasks for function metadata. */\nvar WRAP_BIND_FLAG = 1,\n    WRAP_BIND_KEY_FLAG = 2,\n    WRAP_CURRY_FLAG = 8,\n    WRAP_CURRY_RIGHT_FLAG = 16,\n    WRAP_PARTIAL_FLAG = 32,\n    WRAP_PARTIAL_RIGHT_FLAG = 64,\n    WRAP_ARY_FLAG = 128,\n    WRAP_REARG_FLAG = 256,\n    WRAP_FLIP_FLAG = 512;\n\n/** Used to associate wrap methods with their bit flags. */\nvar wrapFlags = [\n  ['ary', WRAP_ARY_FLAG],\n  ['bind', WRAP_BIND_FLAG],\n  ['bindKey', WRAP_BIND_KEY_FLAG],\n  ['curry', WRAP_CURRY_FLAG],\n  ['curryRight', WRAP_CURRY_RIGHT_FLAG],\n  ['flip', WRAP_FLIP_FLAG],\n  ['partial', WRAP_PARTIAL_FLAG],\n  ['partialRight', WRAP_PARTIAL_RIGHT_FLAG],\n  ['rearg', WRAP_REARG_FLAG]\n];\n\n/**\n * Updates wrapper `details` based on `bitmask` flags.\n *\n * @private\n * @returns {Array} details The details to modify.\n * @param {number} bitmask The bitmask flags. See `createWrap` for more details.\n * @returns {Array} Returns `details`.\n */\nfunction updateWrapDetails(details, bitmask) {\n  arrayEach(wrapFlags, function(pair) {\n    var value = '_.' + pair[0];\n    if ((bitmask & pair[1]) && !arrayIncludes(details, value)) {\n      details.push(value);\n    }\n  });\n  return details.sort();\n}\n\nmodule.exports = updateWrapDetails;\n","const {\n  isAny\n} = require('bpmnlint-utils');\n\n/**\n * A rule that checks that no fake join is modeled by attempting\n * to give a task or event join semantics.\n *\n * Users should model a parallel joining gateway\n * to achieve the desired behavior.\n */\nmodule.exports = function() {\n\n  function check(node, reporter) {\n\n    if (!isAny(node, [\n      'bpmn:Task',\n      'bpmn:Event'\n    ])) {\n      return;\n    }\n\n    const incoming = node.incoming || [];\n\n    if (incoming.length > 1) {\n      reporter.report(node.id, 'Incoming flows do not join');\n    }\n  }\n\n  return {\n    check\n  };\n\n};","//      \n// An event handler can take an optional event argument\n// and should not return a value\n                                          \n                                                               \n\n// An array of all currently registered event handlers for a type\n                                            \n                                                            \n// A map of event types and their corresponding event handlers.\n                        \n                                 \n                                   \n  \n\n/** Mitt: Tiny (~200b) functional event emitter / pubsub.\n *  @name mitt\n *  @returns {Mitt}\n */\nfunction mitt(all                 ) {\n\tall = all || Object.create(null);\n\n\treturn {\n\t\t/**\n\t\t * Register an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to listen for, or `\"*\"` for all events\n\t\t * @param  {Function} handler Function to call in response to given event\n\t\t * @memberOf mitt\n\t\t */\n\t\ton: function on(type        , handler              ) {\n\t\t\t(all[type] || (all[type] = [])).push(handler);\n\t\t},\n\n\t\t/**\n\t\t * Remove an event handler for the given type.\n\t\t *\n\t\t * @param  {String} type\tType of event to unregister `handler` from, or `\"*\"`\n\t\t * @param  {Function} handler Handler function to remove\n\t\t * @memberOf mitt\n\t\t */\n\t\toff: function off(type        , handler              ) {\n\t\t\tif (all[type]) {\n\t\t\t\tall[type].splice(all[type].indexOf(handler) >>> 0, 1);\n\t\t\t}\n\t\t},\n\n\t\t/**\n\t\t * Invoke all handlers for the given type.\n\t\t * If present, `\"*\"` handlers are invoked after type-matched handlers.\n\t\t *\n\t\t * @param {String} type  The event type to invoke\n\t\t * @param {Any} [evt]  Any value (object is recommended and powerful), passed to each handler\n\t\t * @memberOf mitt\n\t\t */\n\t\temit: function emit(type        , evt     ) {\n\t\t\t(all[type] || []).slice().map(function (handler) { handler(evt); });\n\t\t\t(all['*'] || []).slice().map(function (handler) { handler(type, evt); });\n\t\t}\n\t};\n}\n\nexport default mitt;\n//# sourceMappingURL=mitt.es.js.map\n","import {\n  domify,\n  classes as domClasses,\n  matches as domMatches,\n  delegate as domDelegate,\n  query as domQuery,\n  queryAll as domQueryAll,\n  event as domEvent,\n  attr as domAttr\n} from 'min-dom';\n\nimport {\n  filter,\n  assign\n} from 'min-dash';\n\nimport createEmitter from 'mitt';\n\nvar DEFAULT_OPTIONS = {\n  scrollSymbolLeft: '‹',\n  scrollSymbolRight: '›'\n};\n\n\n/**\n * This component adds the functionality to scroll over a list of tabs.\n *\n * It adds scroll buttons on the left and right side of the tabs container\n * if not all tabs are visible. It also adds a mouse wheel listener on the\n * container.\n *\n * If either a button is clicked or the mouse wheel is used over the tabs,\n * a 'scroll' event is being fired. This event contains the node elements\n * of the new and old active tab, and the direction in which the tab has\n * changed relative to the old active tab.\n *\n * @example:\n * (1) provide a tabs-container:\n *\n * var $el = (\n *   <div>\n *     <!-- button added by scrollTabs -->\n *     <span class=\"scroll-tabs-button scroll-tabs-left\"></span>\n *     <ul class=\"my-tabs-container\">\n *       <li class=\"my-tab i-am-active\"></li>\n *       <li class=\"my-tab\"></li>\n *       <li class=\"my-tab ignore-me\"></li>\n *     </ul>\n *     <!-- button added by scrollTabs -->\n *     <span class=\"scroll-tabs-button scroll-tabs-right\"></span>\n *   </div>\n * );\n *\n *\n * (2) initialize scrollTabs:\n *\n *  var scroller = scrollTabs(tabBarNode, {\n *    selectors: {\n *      tabsContainer: '.my-tabs-container',\n *      tab: '.my-tab',\n *      ignore: '.ignore-me',\n *      active: '.i-am-active'\n *    }\n *  });\n *\n *\n * (3) listen to the scroll event:\n *\n * scroller.on('scroll', function(newActiveNode, oldActiveNode, direction) {\n *   // direction is any of (-1: left, 1: right)\n *   // activate the new active tab\n * });\n *\n *\n * (4) update the scroller if tabs change and or the tab container resizes:\n *\n * scroller.update();\n *\n *\n * @param  {DOMElement} el\n * @param  {Object} options\n * @param  {Object} options.selectors\n * @param  {String} options.selectors.tabsContainer the container all tabs are contained in\n * @param  {String} options.selectors.tab a single tab inside the tab container\n * @param  {String} options.selectors.ignore tabs that should be ignored during scroll left/right\n * @param  {String} options.selectors.active selector for the current active tab\n * @param  {String} [options.scrollSymbolLeft]\n * @param  {String} [options.scrollSymbolRight]\n */\nfunction ScrollTabs($el, options) {\n\n  // we are an event emitter\n  assign(this, createEmitter());\n\n  this.options = options = assign({}, DEFAULT_OPTIONS, options);\n  this.container = $el;\n\n  this._createScrollButtons($el, options);\n\n  this._bindEvents($el);\n}\n\n\n/**\n * Create a clickable scroll button\n *\n * @param {Object} options\n * @param {String} options.className\n * @param {String} options.label\n * @param {Number} options.direction\n *\n * @return {DOMElement} The created scroll button node\n */\nScrollTabs.prototype._createButton = function(parentNode, options) {\n\n  var className = options.className,\n      direction = options.direction;\n\n\n  var button = domQuery('.' + className, parentNode);\n\n  if (!button) {\n    button = domify('<span class=\"scroll-tabs-button ' + className + '\">' +\n                                options.label +\n                              '</span>');\n\n    parentNode.insertBefore(button, parentNode.childNodes[0]);\n  }\n\n  domAttr(button, 'data-direction', direction);\n\n  return button;\n};\n\n/**\n * Create both scroll buttons\n *\n * @param  {DOMElement} parentNode\n * @param  {Object} options\n * @param  {String} options.scrollSymbolLeft\n * @param  {String} options.scrollSymbolRight\n */\nScrollTabs.prototype._createScrollButtons = function(parentNode, options) {\n\n  // Create a button that scrolls to the tab left to the currently active tab\n  this._createButton(parentNode, {\n    className: 'scroll-tabs-left',\n    label: options.scrollSymbolLeft,\n    direction: -1\n  });\n\n  // Create a button that scrolls to the tab right to the currently active tab\n  this._createButton(parentNode, {\n    className: 'scroll-tabs-right',\n    label: options.scrollSymbolRight,\n    direction: 1\n  });\n};\n\n/**\n * Get the current active tab\n *\n * @return {DOMElement}\n */\nScrollTabs.prototype.getActiveTabNode = function() {\n  return domQuery(this.options.selectors.active, this.container);\n};\n\n\n/**\n * Get the container all tabs are contained in\n *\n * @return {DOMElement}\n */\nScrollTabs.prototype.getTabsContainerNode = function() {\n  return domQuery(this.options.selectors.tabsContainer, this.container);\n};\n\n\n/**\n * Get all tabs (visible and invisible ones)\n *\n * @return {Array<DOMElement>}\n */\nScrollTabs.prototype.getAllTabNodes = function() {\n  return domQueryAll(this.options.selectors.tab, this.container);\n};\n\n\n/**\n * Gets all tabs that don't have the ignore class set\n *\n * @return {Array<DOMElement>}\n */\nScrollTabs.prototype.getVisibleTabs = function() {\n  var allTabs = this.getAllTabNodes();\n\n  var ignore = this.options.selectors.ignore;\n\n  return filter(allTabs, function(tabNode) {\n    return !domMatches(tabNode, ignore);\n  });\n};\n\n\n/**\n * Get a tab relative to a reference tab.\n *\n * @param  {DOMElement} referenceTabNode\n * @param  {Number} n gets the nth tab next or previous to the reference tab\n *\n * @return {DOMElement}\n *\n * @example:\n * Visible tabs: [ A | B | C | D | E ]\n * Assume tab 'C' is the reference tab:\n * If direction === -1, it returns tab 'B',\n * if direction ===  2, it returns tab 'E'\n */\nScrollTabs.prototype.getAdjacentTab = function(referenceTabNode, n) {\n  var visibleTabs = this.getVisibleTabs();\n\n  var index = visibleTabs.indexOf(referenceTabNode);\n\n  return visibleTabs[index + n];\n};\n\nScrollTabs.prototype._bindEvents = function(node) {\n  this._bindWheelEvent(node);\n  this._bindTabClickEvents(node);\n  this._bindScrollButtonEvents(node);\n};\n\n/**\n *  Bind a click listener to a DOM node.\n *  Make sure a tab link is entirely visible after onClick.\n *\n * @param {DOMElement} node\n */\nScrollTabs.prototype._bindTabClickEvents = function(node) {\n  var selector = this.options.selectors.tab;\n\n  var self = this;\n\n  domDelegate.bind(node, selector, 'click', function onClick(event) {\n    self.scrollToTabNode(event.delegateTarget);\n  });\n};\n\n\n/**\n * Bind the wheel event listener to a DOM node\n *\n * @param {DOMElement} node\n */\nScrollTabs.prototype._bindWheelEvent = function(node) {\n  var self = this;\n\n  domEvent.bind(node, 'wheel', function(e) {\n\n    // scroll direction (-1: left, 1: right)\n    var direction = Math.sign(e.deltaY);\n\n    var oldActiveTab = self.getActiveTabNode();\n\n    var newActiveTab = self.getAdjacentTab(oldActiveTab, direction);\n\n    if (newActiveTab) {\n      self.scrollToTabNode(newActiveTab);\n      self.emit('scroll', newActiveTab, oldActiveTab, direction);\n    }\n\n    e.preventDefault();\n  });\n};\n\n/**\n * Bind scroll button events to a DOM node\n *\n * @param  {DOMElement} node\n */\nScrollTabs.prototype._bindScrollButtonEvents = function(node) {\n\n  var self = this;\n\n  domDelegate.bind(node, '.scroll-tabs-button', 'click', function(event) {\n\n    var target = event.delegateTarget;\n\n    // data-direction is either -1 or 1\n    var direction = parseInt(domAttr(target, 'data-direction'), 10);\n\n    var oldActiveTabNode = self.getActiveTabNode();\n\n    var newActiveTabNode = self.getAdjacentTab(oldActiveTabNode, direction);\n\n    if (newActiveTabNode) {\n      self.scrollToTabNode(newActiveTabNode);\n      self.emit('scroll', newActiveTabNode, oldActiveTabNode, direction);\n    }\n\n    event.preventDefault();\n  });\n};\n\n\n/**\n* Scroll to a tab if it is not entirely visible\n*\n* @param  {DOMElement} tabNode tab node to scroll to\n*/\nScrollTabs.prototype.scrollToTabNode = function(tabNode) {\n  if (!tabNode) {\n    return;\n  }\n\n  var tabsContainerNode = tabNode.parentNode;\n\n  var tabWidth = tabNode.offsetWidth,\n      tabOffsetLeft = tabNode.offsetLeft,\n      tabOffsetRight = tabOffsetLeft + tabWidth,\n      containerWidth = tabsContainerNode.offsetWidth,\n      containerScrollLeft = tabsContainerNode.scrollLeft;\n\n  if (containerScrollLeft > tabOffsetLeft) {\n    // scroll to the left, if the tab is overflowing on the left side\n    tabsContainerNode.scrollLeft = 0;\n  } else if (tabOffsetRight > containerWidth) {\n    // scroll to the right, if the tab is overflowing on the right side\n    tabsContainerNode.scrollLeft = tabOffsetRight - containerWidth;\n  }\n};\n\n\n/**\n * React on tab changes from outside (resize/show/hide/add/remove),\n * update scroll button visibility.\n */\nScrollTabs.prototype.update = function() {\n\n  var tabsContainerNode = this.getTabsContainerNode();\n\n  // check if tabs fit in container\n  var overflow = tabsContainerNode.scrollWidth > tabsContainerNode.offsetWidth;\n\n  // TODO(nikku): distinguish overflow left / overflow right?\n  var overflowClass = 'scroll-tabs-overflow';\n\n  domClasses(this.container).toggle(overflowClass, overflow);\n\n  if (overflow) {\n    // make sure the current active tab is always visible\n    this.scrollToTabNode(this.getActiveTabNode());\n  }\n};\n\n\n// exports ////////////////\n\n/**\n * Create a scrollTabs instance on the given element.\n *\n * @param {DOMElement} $el\n * @param {Object} options\n *\n * @return {ScrollTabs}\n */\nexport default function create($el, options) {\n\n  var scrollTabs = get($el);\n\n  if (!scrollTabs) {\n    scrollTabs = new ScrollTabs($el, options);\n\n    $el.__scrollTabs = scrollTabs;\n  }\n\n  return scrollTabs;\n}\n\n\n/**\n * Return the scrollTabs instance that has been previously\n * initialized on the element.\n *\n * @param {DOMElement} $el\n * @return {ScrollTabs}\n */\nfunction get($el) {\n  return $el.__scrollTabs;\n}\n\ncreate.get = get;","var baseGetTag = require('./_baseGetTag'),\n    isObjectLike = require('./isObjectLike');\n\n/** `Object#toString` result references. */\nvar symbolTag = '[object Symbol]';\n\n/**\n * Checks if `value` is classified as a `Symbol` primitive or object.\n *\n * @static\n * @memberOf _\n * @since 4.0.0\n * @category Lang\n * @param {*} value The value to check.\n * @returns {boolean} Returns `true` if `value` is a symbol, else `false`.\n * @example\n *\n * _.isSymbol(Symbol.iterator);\n * // => true\n *\n * _.isSymbol('abc');\n * // => false\n */\nfunction isSymbol(value) {\n  return typeof value == 'symbol' ||\n    (isObjectLike(value) && baseGetTag(value) == symbolTag);\n}\n\nmodule.exports = isSymbol;\n"],"sourceRoot":""}